 I
中文摘要 
再生能源應用在現今溫室效應造成環境氣候變化的嚴重衝擊
下，益發突顯其重要性，尤其能源多元化已成為世界各國能源政策努
力的目標。近年來，小型分散式發電系統已廣泛設置利用，且數量逐
年成長，例如，電力儲能設備、太陽能電力系統與風力發電系統均已
有效與市電系統併聯運轉。 
本計畫旨在設計、模擬與研製一多重再生能源發電系統與市電並
聯之整合系統，其中多重再生能源發電系統包括太陽能與風力發電系
統，係利用多重輸入直流轉換器與最大功率追蹤器將能源儲存於蓄電
池中，並藉由循環式充放電控制系統控制蓄電池動作切換，以維持電
池供電之穩定與壽命之延長；此外亦研製多重再生能源發電變流器，
並且配合研製孤島監測系統完成與市電並聯，以達成系統之整合。 
由於太陽能與風力發電系統存在著非線性特性，因此如何有效達
成多重再生能源發電系統之最大功率輸出乃計畫內首要工作。本計畫
以傳統擾動觀察法及所提之最佳點近似估測法、三點權位比較法與模
糊自適應共振理論類神經網路演算法等四種追蹤技術，藉由改變直流
轉換器閘流體之導通角度以執行最大功率追蹤。另外，透過庫倫量測
方法來估測蓄電池殘電量，以提供循環式充放電控制系統之依據。再
者，本計畫研製一電流控制電壓源變流器，並配合採用本計畫提出之
電壓差分相關性擾動法(Differential Voltage Correlation Method, DVC)
建立一孤島監測系統，以達與市電同步並聯及孤島運轉現象之偵測。 
為驗證所提計畫各階段執行成效與技術之可行性，本計畫實際使
用 400W 風力渦輪機與永磁式同步發電機組合為風力發電系統，以及
一 1kW 太陽光電能發電系統進行實際運轉模擬測試，並且使用數位
信號處理器(TMS320LF2407)與混合信號微處理控制器(C8051F124)
作為系統之控制核心，以減低電路設計及控制之複雜度。 
為有效達成多重再生能源發電系統與市電並聯之整合，並達到最
 III
ABSTRACT 
Renewable energy has been drawing more attention since the advent 
of global warming effects. In particular, multiple-energy sources have 
currently become one of the goals for energy policy of the developed 
countries around the world. Over the last decades, an increased 
percentage of dispersed mall-scaled generators, such as battery energy 
storage systems, photovoltaic systems, wind generation, and cogeneration, 
has been operated effectively in parallel with utility networks. 
The project aims at designing, simulating and implementing a system 
integrating the utilities with multi-renewable energies, including solar and 
wind power systems. Through multi-input DC converter and maximum 
power tracker, the energy was stored in the storage battery. The system 
exchanges the storage battery with the circulating charge- and 
discharge-control systems to maintain the stability of power supply and 
extend the life of battery. Then, the integrated system was completed 
through the current-controlled voltage source inverter for grid-connected 
system outfitted with an islanding-detection scheme. 
The renewable energies of solar- and wind-power exhibit nonlinear 
characteristics. How to track the maximum power points for the 
renewable energy systems is a most important issue to conquer. The 
project presents four maximum power point tracking (MPPT) techniques, 
i.e., the existing perturb-and-observe (PAO) method and the proposed 
optimal-point approximate estimation (OPAE), three-point 
weighting-comparison (TPWC), and fuzzy adaptive resonance theory 
neural network (FARTNN) methods. Based on the MPPT techniques, 
changing duty ratios of the converter was used for the maximum-power 
tracking. Besides, through the coulomb-measuring approach, storage 
status of the batteries is provided for circulating charge- and 
discharge-control systems. Finally, an algorithm based on differential 
 V
detect systems. Finally, comparisons and analyses of the 
simulation and experimental results obtained from the existing 
and proposed methods were given. 
Keywords: Renewable Energy, Maximum Power Point Tracking, 
Grid-Connected Operation, Differential Voltage Correlation Method  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 VII
2.2.2 電量檢測方法 .....................................................................15 
2.2.2.1 開路電壓法 ................................................................15 
2.2.2.2 比重計法 ....................................................................17 
2.2.2.3 內阻測定法 ................................................................18 
2.2.2.4 庫倫量測法 .................................................................18 
2.2.3 綜合結論 .............................................................................19 
2.3 孤島偵測方法..............................................................................20 
2.3.1 相位偏移檢測技術 .............................................................20 
2.3.2 自動頻率漂移技術 ..............................................................22 
2.3.3 滑差式頻率位移技術 ..........................................................25 
2.3.4 電壓脈波擾動技術 ..............................................................28 
2.3.5 電壓差分相關性擾動法 ......................................................30 
2.3.6 綜合結論 .............................................................................34 
2.4 多重再生能源發電與市電並聯系統...........................................34 
2.4.1 硬體電路架構 .....................................................................35 
2.4.1.1 直流充電系統架構 .....................................................35 
2.4.1.2 循環充放電系統架構 .................................................43 
2.4.1.3 市電並聯系統 ............................................................45 
2.4.2 軟體程式架構 .....................................................................58 
2.4.3 綜合結論 .............................................................................66 
參、計畫成果與結論 ..............................................................................67 
3.1 第一年度......................................................................................67 
3.1.1 多重直流充電系統架構 .....................................................67 
3.1.2 最大功率追蹤器之控制架構與演算法.............................69 
3.1.2.1 擾動與觀察法(Perturb-and-Observe method)...........69 
 IX
圖 目 錄 
圖 2.1 最大功率追蹤器控制方塊圖 ...................................................5 
圖 2.2 再生能源發電系統之功率曲線圖 ............................................7 
圖 2.3 再生能源發電系統功率曲線圖 ...............................................8 
圖 2.4 三點權位功率型態圖................................................................9 
圖 2.5 三點權位功率型態圖..............................................................10 
圖 2.6 自適應共振理論類神經網路演算法之控制方塊圖 .............10 
圖 2.7 模糊自適應共振理論之網路架構圖 .....................................11 
圖 2.8 分散式發電系統與市電併聯運轉架構圖 .............................21 
圖 2.9 鎖相迴路示意圖......................................................................21 
圖 2.10 發生孤島相位瞬間變化情形 ...............................................22 
圖 2.11 自動頻率飄移示意圖............................................................23 
圖 2.12 自動頻率漂移與穩態操作點 ................................................25 
圖 2.13 滑差式頻率位移法輸出電流與電壓波形 ............................26 
圖 2.14 滑差式頻率位移技術動作示意圖 ........................................27 
圖 2.15 滑差式頻率位移法之穩態操作點 ........................................27 
圖 2.16 分散式電源與市電併聯系統架構圖 ...................................28 
圖 2.17 反流器輸出擾動電壓............................................................29 
圖 2.18 多重再生能源發電系統與市電網路併聯示意圖 ...............30 
圖 2.19 孤島現象偵測法流程圖 .......................................................33 
圖 2.20 多重直流充電系統架構圖 ...................................................35 
圖 2.21 三相全橋式整流器................................................................36 
圖 2.22 具固定直流電流負載之三相整流器 ...................................37 
圖 2.23 固定直流電流負載之三相整流器電路波形 .......................39 
圖 2.24 具固定直流電流之理想三相整流器之線電流 ...................39 
 XI
圖 3.4 再生能源發電系統之功率曲線圖 .........................................72 
圖 3.5 再生能源發電系統功率曲線圖 .............................................73 
圖 3.6 三點權位功率型態圖..............................................................75 
圖 3.7 三點權位功率型態圖..............................................................75 
圖 3.8 三點權位比較法控制流程圖 ..................................................76 
圖 3.9 自適應共振理論類神經網路演算法之控制方塊圖 .............77 
圖 3.10 模糊自適應共振理論之網路架構圖 ...................................78 
圖 3.11 風力發電機在各風速下之特性曲線 ...................................81 
圖 3.12 不同日照量下，太陽能電池 I-V 曲線................................82 
圖 3.13 不同日照量下，太陽能電池 P-V 曲線 ...............................82 
圖 3.14 不同溫度下，太陽能電池 I-V 曲線 ....................................82 
圖 3.15 不同溫度下，太陽能電池 P-V 曲線 ...................................83 
圖 3.16 某日(雨天)，太陽能電池 I-P-V 曲線..................................83 
圖 3.17 某日(晴天)，太陽能電池 I-P-V 曲線..................................83 
圖 3.18 風力機實際輸出功率比較圖 ...............................................85 
圖 3.19 某日太陽電池實際輸出功率比較圖 ...................................86 
圖 3.20 循環充放電控制與孤島監測模擬系統 ...............................87 
圖 3.21 現有孤島現象偵測法電感性負載測試 ................................89 
圖 3.22 電壓差分相關性法電感性負載測試 ....................................90 
圖 3.23 孤島效應監測指標值............................................................93 
圖 3.24 反流器輸出脈波擾動與電壓驟降同步 ...............................95 
圖 3.25 孤島運轉監測系統決策流程圖 ............................................96 
圖 3.26 太陽能電池陣列實體圖 .......................................................98 
圖 3.27 風力發電機與工業用風扇實體圖 .......................................98 
圖 3.29 太陽能發電系統操作在最大功率追蹤時之輸入電壓 Vpv 、
輸入電流 Ipv、輸入功率 Ppv之波形圖 ....................................100 
 XIII
表 目 錄 
表 2.1 變流器系統參數 ........................................................................48 
表 3-1 負載與電力參數 ........................................................................88 
表 3-2 反流器輸出脈波擾動與電壓驟降同步第一視窗計算之孤島效
應偵測指標值 ................................................................................94 
表 3-3 反流器輸出脈波擾動與電壓驟降同步第二視窗計算之孤島效
應偵測指標值 ................................................................................94 
表 3-4 再生能源裝置之規格表.............................................................99 
表 3-5 多重輸入轉換器與全橋變流器之元件表................................99 
 2
[2]。 
由於石化能源日漸減少，且環保議題逐漸受到重視，使裝置容
量超過 500MW之大型集中式發電機組的增設日益困難，小型分散式
發電機已成為電源開發的新途徑。而太陽能與風力發電正是分散式
發電的主流，因此，太陽能與風力發電複合系統的開發已成為電力
工程中極為重要的課題。 
由於單一再生能源往往容易受到季節、氣候環境等自然因素影
響，使得系統之供電連續性不佳，因而缺乏實用性。目前再生能源
之運用可分為獨立型系統與市電並聯型系統兩大運用方式。兩運用
方式均受到再生能源不穩定與間歇性之特性，而導致系統使用率降
低並相對提高系統成本。結合太陽能與風力發電之多重再生能源系
統，利用兩系統彼此的互補性及調度之便利，進而實施能源管理控
制，以達供電之連續性、穩定性與提高供電品質與效率。 
如前所述，太陽能之電能大小會因氣候環境變化而影響輸出功
率，如同週遭環境溫度與日照強度等。相同地，風力發電機亦受到
風速快速變化的影響，其輸出功率也勢必跟著受到影響而偏離了最
佳的運轉點，使所得到的風能無法有效地轉化為電能輸出。由於上
述因素皆是隨著大自然氣候而變動的，故如何控制太陽能發電系統
與風力發電機組的轉速，使其在不同的環境因素之下，皆能得到最
大的輸出功率，為本計畫探討的目標。 
此外，多重再生能源發電儲能系統的效率與壽命關係供電連續
性與穩定性，因此，完善的儲能充、放電控制系統，其中包括蓄電
池殘電量檢測與控制，亦是本計畫重要研究項目之一。 
以往於分散式發電系統與市電的並聯控制，仍存在同步化問題
與孤島現象兩項主要問題需解決。因此於本計畫內多重再生能源系
統與市電並聯之控制上亦納入考量上述兩問題，以避免系統發生不
 4
號。使同步信號控制變流器的輸出電流與市電系統之電壓同步。 
本計畫孤島現象偵測法中提出主動式電流控制脈波擾動法，輸出
之電流為一具週期性之擾動訊號，將負載峰值電壓變動特徵值與反流
器輸出電流脈波擾動信號作一數學相關性（Correlation）計算，可得
一孤島效應偵測指標。配合以此電壓差分相關性擾動技術為基準的孤
島現象偵測電路，本系統具有零敏的孤島現象偵測與解聯能力。 
基於考量訊號取樣時脈與回授訊號彼此之間的干擾，再加上硬體
輸入輸出連結埠數量之限制，本計畫以德州儀器之數位信號處理器
TMS320LF2407 與 Cygnal 公司之混合訊號微處理控制器 C8051F124
作為控制核心[55，56]，TMS320LF2407 是一顆 16 位元定點式整數運
算之數位訊號處理晶片，主要應用於電力電子與電機機械的數位控
制。其內建之周邊功能非常適合升降壓式直流轉換器與變流器之控制
需求。C8051F124 是一顆擁有 12-bits 且每秒可達 100,000 次的速度
擷取和轉換類比訊號的類比數位轉換器，以及 8 對 1 的多工器，以增
加切換彈性，故對本計畫而言，可有效擷取回授訊號之數值以及進行
執行蓄電池殘電量之運算程式。 
由於本系統兼具最大功率追蹤、多重輸入直流/直流轉換器控制
與市電並聯等功能，其中電壓、電流信號之取樣與控制器之運算量較
大，採用數位信號處理器 TMS320LF2407 可大幅簡化控制電路、降
低成本及增加系統可靠度。 
本計畫完成的多重再生能源發電系統，實際測試於各種負載以及
各種不同的日照度、溫度與風速狀態，以驗證其實用性。由於本系統
使用電壓源變流器，除了可得更佳的同步化並聯特性外，而且由於採
用脈寬調變方式響應快速，更可提高供電品質，不受負載特性之影
響，運轉於更寬廣的負載與環境變化範圍。 
 6
小，以改變再生能源發電系統的輸出電壓與輸出功率，並觀察與比較
負載變動前後輸出電壓與功率的大小，以決定下一次的增減載的動
作。擾動觀察法已普遍地應用於太陽能發電系統的最大功率追蹤，因
此，本計畫使用擾動與觀察法於所提多重再生能源發電系統之最大功
率追蹤，其中包括太陽能與風力發電系統，並且予以分析比較。判斷
規則如下所述： 
(1) 輸出功率較變動前大→負載繼續朝同一方向變動； 
(2) 輸出功率較變動前小→負載改變方向變動。 
2.1.2 最佳點近似估測法  (Optimal-Point Approximate 
Estimation method) 
本計畫所提出之最佳點近似估測法係根據太陽能發電系統(風力
發電機)在各日照量(風速)下，將實際運轉的情形加以測量記錄，以得
到各風速下之最大功率點；當下次太陽能發電系統(風力發電機)在各
日照量(風速)運轉時，則可依據之前的測量記錄，直接給予昇降壓電
路最佳的責任週期信號，使太陽能發電系統(風力發電機)在最大功率
點下運轉。 
本方法係將功率作為數位信號處理器之輸入參數，如圖 2.2 所
示，當日照量(風速)接近日照量 1(風速 1)時，若所測得的功率大小，
落在 P1'與 P1"之間，則將責任週期設定為 D1，使輸出功率接近最大
功率點 P1；當日照量(風速)上升至日照量 2(風速 2)附近時，此時的功
率將落在 P2'與 P2"之間，則數位信號處理器將依紀錄的規定，將責任
週期更新為 D2，使輸出功率逼近最大功率 P2。此外 P1'、P1"、P2'、
P2"的設定，亦為經驗上主觀的決定。 
倘若日照量(風速)由日照量 1(風速 1)，上升至日照量 1(風速 1)
與日照量 2(風速 2)之間，且此時的功率點落在 P1'至 P2"的範圍中，系
 8
 
圖 2.3 再生能源發電系統功率曲線圖 
2.1.3 三點權位比較法(Three-Point Weighting-Comparison 
method) 
一般而言，太陽日照並不會快速變化，若因人為或自然因素干擾
(如：烏雲短時間的遮蔽)，使得在快速的擾動下，將造成功率上的損
失。此外風力發電系統亦受到風速快速變化的影響，其輸出功率也勢
必跟著受到影響而偏離了最佳的運轉點，使所得到的風能無法有效地
轉化為電能輸出。 
三點權位比較法可以降低傳統擾動與觀察法於功率短暫性變化
時，因錯誤的擾動造成功率的損失。因此，過去使用於太陽能發電系
統最大功率追蹤之三點權位比較法，除了應用於本計畫所提多重再生
能源發電系統中，太陽能發電系統之最大功率追蹤，本計畫將更進一
步建立於風力發電系統上，以提高整體運轉效能，並進行分析與比較。 
三點權位比較法[10]的基本原理與擾動觀察法類似，其中擾動與
 10
 
圖 2.5 三點權位功率型態圖 
D
 
圖 2.6 自適應共振理論類神經網路演算法之控制方塊圖 
2.1.4 模糊自適應共振理論類神經網路演算法 (Fuzzy 
adaptive resonance theory neural network, FARTNN) 
本計畫分析一模糊自適應共振理論類神經網路演算法[12]，其結
合類神經網路與模糊邏輯，以達到量測信號之訓練、分類與控制。為
避免多變的實際量測信號資料於類神經網路歷史訓練資料中並未完
全考量，此演算法利用結合監督式與非監督式模糊自適應共振理論，
透過線上信號量測與處理，以達到模糊歸屬函數的修正。 
圖 2.6 為本計畫所提模糊自適應共振理論類神經網路演算法之控
制方塊圖，其中包括有：多重再生能源實際發電系統與模擬系統、類
神經網路、模糊邏輯控制等。細部控制方法詳述如后： 
 
 12
學習速率值，β； 
警戒值，ρ； 
其中，i 為第 i 個神經元；j 為輸入向量之維度。 
(2) 讀入一個新的輸入向量 I； 
(3) 計算每一個輸出節點之選擇函數 Tj； 
 
j
j
j w
wI
T +
∧= α  (2-2) 
其中，∧為模糊邏輯運算元，其定義為 ),min( ii yxyx =∧ 。 
(4) 選擇優勝單元； 
 { }jjwin TT max=  (2-3) 
(5) 共振測試(比較新舊神經元之相似度)，判斷下列式子是否符合，
若符合則跳至步驟(7)； 
 ρ≥∧
I
wI win  (2-4) 
(6) 重置未被選擇之單元，跳至步驟(4)； 
(7) 調整優勝單元之權重值； 
 oldwinoldwinnewwin wwIw )1()( ββ −+∧=  (2-5) 
重複步驟，跳回步驟(2)。 
2.1.4.1 模糊控制器 
此模糊控制器所接收的信號分有：再生能源之信號量測數值、自
適應共振理論類神經網路訓練之權值與分類結果修正信號與決策邏
輯修正數值。於網路訓練期間，模糊控制器則持續對新的取樣信號進
行分類，得知新樣本信號的類別，進而給予相對應的輸出控制信號至
 14
因為定電流充電不管電池的充電狀況如何，仍一直會對電池供電，所
以在電池充滿電時若不馬上關掉或切換為定電壓充電模式，電池則容
易受損。 
定電壓充電法[21]則是以固定電壓模式對電池供電，於此模式
下，較不需擔心電池損壞，因為電池會依據所剩下容量自我調整電
流。但是於電池完全充滿後，必須把電壓移除，否則會以浮充方式補
充電量以免電池損壞，也因而易造成電能的損失。 
2.2.1.2 混合定電流定電壓充電法 
混合定電流定電壓充電法[22]為彌補定電流與定電壓充電方式的
缺失，以綜合上述兩種充電方法之優點。雖然混合型的方法可以減少
充電的時間，但也因其自我調節電流的功能不明顯，所以會提高造成
電池永久損壞的機會。 
2.2.1.3 脈衝充電法 
脈衝充電法[23]，其方法為對電池提供一個週期性的脈衝電流，
可以於充電過程中提供電池休息時間，做為緩和電化學反應，並且可
以適當的調節脈衝電流大小，以達到快速充電的目的。但是脈衝電流
值、脈衝週期與充電責任週期都是重要的參數，所以必須經由多次實
驗求出最佳參數設定。 
2.2.1.4 ReflexTM 充電法 
ReflexTM 充電法[24]則是在每個充電脈波後加一個負的電流脈
波，其電流值大小是充電電流的 2.5 倍，這個負脈波有下列好處：(1)
把充電過程中極板上的氣泡移走；(2)幫助負極板上氧的融合作用;(3)
減少電池充電時溫度，壓力及阻抗;(4)使外加能量完全轉換成電池能
量而非壓力及溫度(5)增加充電效率以進行高電流的快速充電。 
 16
況下，而在預測電池初始電容量方面，開路電壓法具有極高的準確
度。電池在放電時，接近極板的濃度較低；在充電時，極板附近的濃
度較高。電池於完成充電或放電的動作時，需靜置一段時間，待電解
質濃度分布均勻，所測量之電池端電壓才能反應電池內部的電量。此
外，不同的充放電率，其濃度分布所需的時間不同，若只利用此方式
來估計電池的電量，會有所誤差。為縮短等待所需要的時間，可利用
迴歸曲線方式，可以在較短的時間內得到修正開路電壓值，以決定電
池的電量。由於電池充、放電行為停止後，電池端電壓會隨時間而下
降、上升，因此開路電壓法在進行偵測前，待測電池需等待一段較長
時間的靜止穩定週期。鉛酸電池約需靜置 1~2 小時，而鋰離子電池約
需 30 分鐘。 
由於開路電壓法是量測電池在無負載狀態下的開路電壓，所以開
路電壓法主要用於估計電池的初始電量，並無法在放電過程中量測準
電池電量。根據實驗可知，電池可輸出電容量會受溫度、輸出電流大
小等因素的影響，但開路電壓無法修正這些因素，因為開路電壓只能
估計初始電容量，而無法預測電池接下來的放電過程，故開路電壓法
須搭配其他方法使用，而無法單獨存在。 
開路電壓法在實現上，須先建立電池開路電壓與電容量的關係，
形式可為查詢表或關係函數。在檢測過程中，待電池電壓平穩後，以
A/D 電路量測電池的開路電壓，經過適當的濾波電路，將訊號送進主
控電路，主控電路經由先前的查詢表或關係函數計算出電池的電容量
值。 
開路電壓法適用於工作電壓範圍廣的電池。以鋰離子電池為例，
當運用於行動電話時，其開路電壓可工作範圍約為 700mV(4.2V~3.5 
V)，鋰離子電池相當適合使用開路電壓法，因鋰離子電池的可工作範
圍廣，於 A/D 電路上無太嚴苛的要求，在檢測技術實現上有較高的
可能性。 
 18
閉式構造。而密閉式電池不容易安裝比重計，故比重計法不適合應用
於密閉式電池上，且在量測電池電解液比重的過程中，信號處理、轉
移並不容易，依目前電池構造趨勢來說，比重計法已不甚適用於電池
電量檢測。 
2.2.2.3 內阻測定法 
內阻測定法[30-33]顧名思義是利用電池放電時內電阻的改變來
估測電池的電容量，根據內阻測定法，電壓變化量越大，也就是電量
越少時，電池的內電阻值會越大，因此電量大致上與內電阻呈現反比
的關係。但內阻測定法不像開路電壓法以及比重計法與電池容量有著
線性的關係，且在量測電阻時是對電池加入一交流訊號，較不方便。 
另外，在計算殘電量時，必須根據實驗來記錄電池的內電阻參數
變化，並進行記錄與比較，但是內電阻值通常會隨著電池新舊老化程
度而有所不同，因此用內阻測定法來判斷殘電量，勢必還要再加入其
他參考因素，才能增加其準確度。 
欲實現上述利用內電阻進行電容量檢測，第一步先量測電池的內
電阻值，而後直接將該內電阻值套於事先建立的查詢表或對應函數
中，即可得到對應的可輸出電容量值 
2.2.2.4 庫倫量測法 
庫倫量測法[29]是目前較為可行、準確度較高的電容量檢測法，
它可以應用於電池之充放電過程，以監控電池防止電池過度充電或放
電。電池的容量一般是以安培小時(Ah)表示，也就是以時間對電流積
分。當電池在進行充電動作時，可以由初始之電池電量進行庫倫量測
法累加，獲得任何充電時刻電池之電量。而當電池放電時，亦可由電
池之初始電量進行庫倫量測法遞減。電池電量如（2-6）所示 
 ( ) ( ) ( )∫−= ttitCtC n δ0  (2-6) 
 20
正因素來綜合判斷殘電容量，而修正因素像是有電池放電電流的加成
(increment)效應與電池老化因素及容量調整等。 
加成效應係指對於電池容量而言，電流與時間似乎存在著比例關
係，但是實際上則不一定，因此根據廠商提供之電池資料表(電池容
量相對於放電電流)，可計算加成效應電流與真實電流的關係，進而
提高蓄電池殘電容量估算的準確性。另外，老化因素係指電池會因使
用次數的增加，而使電池逐漸老化，也就是指電池容量的減少，所以
於蓄電池殘電容量估算時，亦必須考慮電池老化的影響。 
2.3 孤島偵測方法 
本監測系統模擬現有孤島偵測方法並且根據現有電壓脈波擾動
技術衍生電壓差分相關性擾動法（DVC）以進行模擬與比較。本計畫
完成模擬之現有孤島偵測法包括相位偏移檢測技術、自動頻率漂移技
術、滑差式頻率位移技術與電壓脈波擾動技術。各孤島偵測技術將於
後續加以說明。 
2.3.1 相位偏移檢測技術 
相位偏移檢測法為監控分散式電源反流器端電壓與輸出電流間
相角偏移差量。如圖 2.8 所示，若考慮反流器之輸出電流訊號操作在
非單位功因之條件下，利用鎖相迴路偵測電壓訊號正零點或負零點交
越方式，使反流器達到輸出電流信號與市電端電壓訊號同步，達成市
電併聯之目的。在圖 2.9 中，輸入訊號為圖 2.8 節點 a 之電壓訊號( a 
V )；輸入濾波器將高階諧波及雜訊濾除，經由適當地調整相位比較
器之輸出振幅與相位誤差訊號作比較；相位誤差訊號是由相位誤差比
較器之輸出經由迴路濾波器濾除交流成分後輸入至電壓控制震盪器
(VCO)，而反流器輸出電流之頻率及相位，即是藉由 VCO 所控制；
一般大多數的鎖相迴路是由量測兩個訊號彼此間的零點交越之相位
差，並達到反流器輸出電流與市電電壓同步之目的。 
 22
 
圖 2.10 發生孤島相位瞬間變化情形 
若簡化對相位偏移檢測動作的分析，可以寫成如式（2-7）所示 
 ( ){ }11arg −− −+ LjCjR ωω  (2-7) 
其中ω為 aV 的頻率， thφ 為相位門檻值，若得到的相位φ大於 thφ ，
則表示為發生孤島運轉，其分析方法與 OFR、UFR 類似。 
相位偏移檢測法為監控分散式電源反流器端電壓與輸出電流間
瞬間的相角偏移差量。此法具有相當的敏感性及容易實現之優點，但
事實上當反流器操作在單位功因條件下運作時，則與保護電驛有相同
的無法偵測區域，且無法偵測區域隨著操作在不同功因下有不同的無
法偵測區域；相位門檻值 thφ 的設定亦是一個問題，不宜太高或是太
低，尤其若負載含有馬達等機械負載時應格外謹慎設定其門檻值，以
避免發生誤動作或是偵測失敗的情況。 
2.3.2 自動頻率漂移技術 
由於分散式發電系統與市電並聯時，鎖相迴路經由市電端持續得
到同步訊號，使得 aV 上的頻率不會改變；且反流器輸出電流之頻率藉
 24
由圖 2.10 市電電壓及反流器輸出電流波形在第一個半週中可以
發現, invIT ,  較 GridT 短，直到電壓的第二個半週開始，反流器輸出電流才
會跟著開始，當反流器輸出電流又再度達到零時，將會維持到市電電
壓在零點交越的瞬間才使變流器將電流輸出，此後又開始重複上述動
作；此失真之電流波形主要產生連續使頻率飄移之動作，如圖 2.11 所
示[35,37]。 
當市電發生故障跳脫後，由於分散式發電系統反流器輸出電流與
其負載端電壓之間的相位變化將由負載特性決定，如圖 2.12 所示，
其中相位角變化大小隨著系統頻率變動而改變。 
在此偵測方法中，反流器輸出電流與負載端電壓相位角差值之變
動被視為偵測孤島效應一重要指標，如式(2-9)所示 
 ⎟⎟⎠
⎞
⎜⎜⎝
⎛
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−=Δ −
fL
fCR ππϕ 2
12tan 1  (2-9) 
在與市電解聯後藉由 ϕΔ 改變影響反流器輸出電流頻率訊號的改
變而觸發過/欠頻率保護電驛的啟動。在(2-9)中 ϕΔ 大於零，即表示反
流器輸出電流相位落後負載端電壓，即反流器輸出電流頻率不變但負
載端電壓頻率卻變大，使得電流頻率小於電壓頻率。此時，因為鎖相
迴路中的迴授控制作用，自動頻率漂移法會將反流器輸出電流的頻率
提升欲使電壓相位與電流相位相同。然而，負載端電壓相位仍領先反
流器輸出電流，卻因輸出電流的頻率已因為分散式發電系統與市電解
聯電壓與電流之間的相位差由負載特性呈現，經由鎖相迴路的控制，
電流頻率追隨電壓頻率改變，此時，負載端電壓頻率昇高、週期變短，
使得端電壓的頻率上昇。如此不斷正迴授的結果將迫使端電壓的頻率
不斷上昇，一旦超出正常的頻率範圍則可確定市電端發生故障，表示
分散式發電系統解聯，並且立即將停止發電機對負載端功率輸出。反
之，若 ϕΔ 為負值，其結果將會是負載端電壓頻率降低，超出某一正
常臨界範圍，啟動欠頻率保護電驛防範孤島運轉造成的危害。 
 26
[37]，相角變化的時間點在於電壓訊號發生零交越點且斜率為正時，
如圖 2.13 所示。 
反流器輸出電流訊號之起始相位角將根據前一電壓頻率的大小
決定，相角增量大小如式(2-10)所示， mθ 為最大偏移量，一般最大值
皆設為 10， )1( −kf 為上個電壓週期之頻率，單位為赫茲， mf 為最大
相位移發生頻率，一般設定在 63 赫茲， rf 為市電端穩態時之系統頻
率；本文中為 60 赫茲，因此當量測到 )1( −kf 為 60 赫茲時，輸出電流
並不會有相位角的偏移，而當 )1( −kf 為 63 赫茲時，將會得到最大的
相位角偏移量 mθ 。 
 ⎟⎟⎠
⎞
⎜⎜⎝
⎛
−
−−⋅=
rm
r
m ff
fkfk )1(
2
sin)( πθθ  (2-10) 
當市電脫離時節點 a 上的頻率會隨著不同負載產生頻率上的偏
移，此時採用滑差式頻率位移技術亦會隨著不同負載產生不同的相位
位移結果，如圖 2.14。 
 
0 0 .01 0 .0 2 0 .03 0 .04 0 .05 0 .06 0 .0 7
-200
-150
-100
-50
0
50
100
150
200
 
圖 2.13 滑差式頻率位移法輸出電流與電壓波形 
 
 28
載特性在發生孤島後持續將頻率飄移。 
滑差式頻率位移技術在理論及實驗上有不錯的表現；然而當特定
負載的負載曲線在共振頻率點附近若其斜率大於或是等於相角增加
量時則會失效，如圖 2.15 所示，滑差式頻率位移技術對於特定負載
仍舊有一無法偵測區域。 
2.3.4 電壓脈波擾動技術 
電壓脈波擾動技術系統架構圖如圖 2.16 所示[41-42]。於分散式
發電系統中通常由電能轉換器將直流電力訊號轉換成交流訊號，於正
常操作情況下與市電端處於併聯。正常操作情況下 )(teg 與 )(ter 分別代
表反流器輸出端開迴路電壓與負載端電壓； )(0 te 為市電端開路電壓，
市電頻率則以 0f 表示之； gZ 為分散式發電系統之內部阻抗，而 LZ 與 0Z
為負載組抗值與市電端傳輸線網路組抗。依照系統架構所示，則反流
器輸出端開迴路電壓與負載端電壓可被表示成(2-11)式與(2-12)式。 
 )2cos()()( 0 ggg tftEte θπ +⋅=  (2-11) 
 )2cos()()( 0 rrr tftEte θπ +⋅=  (2-12) 
其中，參數 )(tEg 與 )(tEr 為 )(teg 與 )(ter 振幅大小，參數 gθ 與 rθ 為 )(teg 與
)(ter 相角，參數 0f 則代表市電端電壓頻率值。 
)(teg )(tel )(tel)(teu )(teu)(teg
 
圖 2.16 分散式電源與市電併聯系統架構圖 
 30
CB
Zg Zu
ZL)(tig )(tel )(teu)(tiu
多重再生能
源發電系統 市電網路
 
(a) 市電併聯運轉 
)(tel )(teu)(tig
 
(b)孤島運轉 
圖 2.18 多重再生能源發電系統與市電網路併聯示意圖 
)(tEgΔ 波形圖，其中 )(tEgΔ 為一週期性方波函數。一旦負載端電壓受
)(tEgΔ 影響電壓大小超出一般班正常範圍值，則可判定此為市電端發
生故障斷電產生孤島運轉現象[41]。 
2.3.5 電壓差分相關性擾動法 
(1) 系統架構運轉說明 
此偵測法與上述電壓脈波擾動法運用之觀念類似，擾動成分也是
由反流器輸出產生，但不同的是擾動對象改為輸出電流，如此一來輸
出電流信號振幅會有如脈波般上下變動，同時也觀察負載端電壓擾動
變化情形，探索其反流器輸出電流與負載端電壓之關聯性，以利發生
孤島現象判斷。如等效系統架構圖 2.18 多重再生能源發電系統與市
 32
脈波，每振幅脈波持續固定週期， )(tI gΔ 輸出變化為正負兩極改變，
使得反流器輸出電流包落線有週期性下上擾動的現象。 
經由上述系統架構說明後，系統兩種操作狀態將分別敘述。探討
多重再生能源發電系統與市電發生併聯運轉與孤島效應情形下，電力
訊號波形受擾動改變情形。 
(2) 電壓差分演算法與孤島效應偵測指標 
根據前述電壓脈波擾動法之分析，純粹以電壓峰值曲線做為判斷
依據，並不足以代表偵測孤島現象發生電力訊號變動差值。故本計畫
將透過電壓差分數值與輸出電流擾動量之相關性作為判斷孤島偵測
指標，此方法稱之為電壓差分相關性擾動法(DVC)，原理將於後說明。 
電壓差分值萃取方式為將特徵擷取負載端電壓之包絡線上第 k
點電壓峰值減去前四個週期峰值電壓，如方程式(2-19)所示： 
 )4()()( maxmaxmax −−=Δ kEkEkE lll  (2-19) 
其中， )(max kEl 為峰值電壓。 
利用反流器輸出擾動電流變化週期為八個電壓訊號之週期時
間，其中擾動電流訊號為每四週期振幅上下改變，所以將第k 點峰值
電壓 )(max kEl 減去前四個週期峰值電壓 )4(max −kEl 將可顯示出電壓擾動
之差量。 
    方程式定義如下： 
 ∑+ Δ⋅Δ= Nj
j
gli kIkEN
D )()(1 max  (2-20) 
其中， iD 為孤島現象偵測指標，N 為視窗寬度之週期數。 
在正常運轉強況下，多重再生能源發電系統與市電端處於併聯狀
態，負載端電壓大小變化受到市電電壓牽制，電壓量變動程度極小，
 34
2.3.6 綜合結論 
本節係敘述說明現有被動式與主動式孤島現象偵測技術，並且針
對各方法之優缺點加以討論。以傳統被動式偵測法為例，其作法為持
續監控所選定欲其監測之電力參數，例如，電壓、頻率或者其它電力
特徵值訊號，此訊號一旦發生暫態擾動現象或者超出正常範圍值，將
可判定此系統處於孤島運轉狀態。但其缺點為，分散式電源與負載達
到平衡時，電壓與頻率之變動量於可容許範圍內，則將不會觸發系統
線路上之保護電驛裝置，以致偵測失敗。 
至於，孤島現象主動式偵測法則是輸出一擾動信號於市電端，並
且監控其頻率、電壓是否維持穩定，假若輸出微小之擾動量能夠造成
所監測之電力參數變動並且超出其所設定之合理範圍，則孤島現象監
測系統將停止反流器電能輸出。不過，經由文獻測試結果報告顯示，
上述方法對於某些特定負載仍然存在「孤島現象不可偵測區域」。 
2.4 多重再生能源發電與市電並聯系統 
太陽能與風能由於易受環境因素的影響，無法長時間輸出穩定能
量供給負載端，所以在應用上通常會選擇外加輔助電源(如蓄電池
組、互補性再生能源)來穩定提供負載端所需功率，減緩因日夜變動、
季節、氣候造成的影響。本計畫完成太陽能與風力之多重再生能源發
電系統之直流充電系統架構如圖 2.22 所示，係由：(1)太陽能光電板、
(2)風力渦輪機、(3)永磁式同步發電機、(4)三相全橋式整流器、(5)多
重輸入直流轉換器、(6)蓄電池所組成。分為硬體與軟體架構二部分，
以下為各部分架構詳述如下： 
 36
本計畫所使用之太陽能光電板輸出電壓高於蓄電池電壓，且變化
較為穩定，故其選擇降壓型轉換器；風力發電機輸出功率主要取決於
風速大小，且在風速變化時，其輸出電壓與電流會隨之變化，進而風
力發電機的輸出功率亦隨之變動。針對實際風力發電機組而言，由於
電壓變化幅度較大，故選擇升降壓型轉換器。本系統的閘流體開關驅
動電路是採用光耦合器 TLP559 做為隔離元件，以確保控制信號與雜
訊之隔離。 
然而此轉換器於穩態下之輸出電壓與輸入電壓關係可由電感伏
特-秒平衡原理推導得之為： 
 PVWindout Vd
dV
d
dV
1
2
2
1
11 −+−=  (2.21) 
(2) 三相全橋式整流器 
一般工業用電為三相，採用三相整流電路要較簡單整流電路理
想，因其具有較低的漣波及較高之功率處理能力。一般常用的三相整
流電路為如圖 2.21 所示之三相全橋式整流器[50,51]。 
 
圖 2.21 三相全橋式整流器 
 38
 NnPnd vvv −=  (2.22) 
由於 vd在每個週期中包含了六個區間(如圖 2.23(b)所示)，因此三
相全橋式整流器又稱為六脈波(six-pulse)整流器。此六個區間分別對
應到六個線電壓組合，每種電壓組合下二極體之導通情形如圖 2.23(c)
所示。以 a 相電流波形來說： 
 
均截止及當
導通當
導通當
41
4
1
:
:
:
0 DD
D
D
I
I
i d
d
a ⎪⎩
⎪⎨
⎧
−=  (2.23) 
由於 Ls=0，電流換相是瞬時的。二極體導通順序之安排，如圖
2.23(c)所示為：1、2、3、4、5、6、1、2、3……。 
由於對稱之故，直流輸出之平均電壓可以利用六個區間其中之一
來計算便可。以圖 2.23(a)中 t=0 開始之區間來看， 
 6/6/ ，cos2 πωπ <<−== tωt(ωt)Vvv LLabd  (2.24) 
其中 VLL為線電壓之均方根值。Vab對此區間積分之面積 A 為 
 LLLL VttdVA 2)(cos2
6/
6/
== ∫− ωωππ  (2.25) 
將 A 除以區間長度 π/3，可得 vd之平均值 
 LLLLLLdo VVttdVV 35.12
3)(cos2
3
1 6/
6/
=== ∫− πωωπ
π
π  (2.26) 
此處下標 o 用以表示 Ls=0 之情況。 
其中一相的相電壓與相電流（以 vs及 is表示）重繪於圖 2.23(a)，
利用均方根值之定義可得 is之均方根值為 
 dds III 816.032 ==  (2.27) 
is之基本波 is1可利用傅立葉分析求得，其均方根值為 
 40
 
圖 2.25 三相全橋式整流器電路圖 
 dds III 78.06
1
1 == π  (2.28) 
而各諧波成份以基本波來表示則為 
 
h
II ssh 1=  (2.29) 
其中 h=5、7、11、13、….，偶次諧波為 0，諧波頻譜如圖 2.24(b)
所示。由於 is1與 vs同相 
 
955.03PF
0.1DPF
==
=
π
 (2.30) 
如以電阻 Rload 來取代圖 2.22(a)中之電流源 Id，電壓波形仍然相
同，導通電流之區間亦同，差別只在於電流波形並非如圖 2.23 中大
小等於 Id之方波，而是與 vd同相之漣波。 
永磁式同步發電機輸出的三相電壓，經由三相全橋式整流器轉換
為直流電壓。雖然三相全橋式整流器輸出的直流鏈電壓無法控制，且
電壓大小會隨永磁式同步發電機輸出而改變，並不適合直接輸出至變
流器的直流端，但因本系統規劃在整流器的後極加設升降壓式直流轉
 42
M
1SR 1SD
1SC
 
圖 2-26 緩衝電路 
 211 2
1
DSSCS VCW =  (2-30) 
當開關截止時，集極電流 id呈 di/dt 的定值衰減，而電流會經由
二極體 DS1 流進電容 CS1 中，在 Δt 等於電流下降時間 tf 時，其能
量表示為： 
 f
DSD tVItpE ××=Δ×=
22  (2-31) 
其中 p：表示平均功率。由(2-30)與(2-32)式，可得電容值為 
 
bus
fO
DS
fD
S V
tI
V
tI
C ×
×=×=
221  (2-32) 
 44
控制的判斷規則如下： 
(1) 蓄電池於允許操作溫度： 
z 蓄電池(I)已充電飽和而蓄電池(II)未完全放電； 
z 蓄電池(I)未充電飽和而蓄電池(II)已完全放電； 
蓄電池(I)未完全放電而蓄電池(II)已充電飽和； 
z 蓄電池(I)已完全放電而蓄電池(II)未充電飽和。 
(2) 蓄電池於危險操作溫度： 
z 蓄電池(I)於過溫度操作而由蓄電池(II)實施單一充放電控制； 
z 蓄電池(II)於過溫度操作而由蓄電池(I)實施單一充放電控制； 
z 蓄電池(I)、(II)於過溫度操作而暫時停止充電與供電運轉。 
 
 46
 
圖 2.29 多重再生能源發電系統之變流器與市電並聯系統架構圖 
+BT+AT
−AT −BT
dV
sV
 
圖 2.30 並聯運轉系統等效電路圖 
(1) 電壓源變流器 
本計畫系統採用之變流器為電壓源變流器，於變流器的直流部分
並聯一個循環式蓄電池，提供儲存之直流電源。其等效電路如圖 2.30
所示，主要是由直流電源、全橋式閘流體開關電路和濾波電路組成。
其中，L 為電感， r 為電感 L 的等效電阻，Vs為電壓 110Vrms 及頻
率 60Hz 的市電電壓，Vd為經推挽式轉換器所輸出的電壓，為使變流
器之輸出電壓能追隨計算出的參考電壓，本計畫採用正弦式脈波寬度
調變（Sinusoidal Pulse Width Modulation，SPWM）[52-54]控制方法，
使各臂之開關元件自動切換至所需的開關狀態。並採用單電壓極性切
換模式以減少漣波與諧波成分。 
 48
 
P
rsL +
1+
-+
+ ⊗⊗⊗ oirefI
sV
pwmk
 
圖 2.33 電流控制之控制方塊圖 
表 2.1 變流器系統參數 
Vd 170 V Iref 2 A 
L 4 mH Io 2 A 
R 0.23 kp 2.3 
VS 110 Vrms C 1 uF 
圖 2.33 電流控制之控制方塊圖，在並聯模式下電流控制變流器
與市電並聯運轉為了更瞭解系統運作情況及穩定度，所以根據所推得
的小訊號模型與表 2.1 系統參數進行模擬。由於此轉換器為一交流系
統，所以我們除了考慮輸出電流的大小之外，還必須考慮其相位的問
題，此電流控制器採用比例控制器(PController) 增加系統靈敏度及精確
度，再使用一參考電流作為前饋補償迴路，以得到快速的電流響應。 
 (2) 濾波電路 
濾波電路是以電感及電容所組成之低通濾波器，主要目的是將橋
式功率級之輸出電壓的高頻諧波成份濾除，以得到低頻率的 60HZ 基
頻交流正弦波。由於愈高頻之諧波容易濾除，因此以濾波功能觀點而
言，調變頻率愈高愈好，然而開關元件之切換損失卻與切換頻率成正
比，故以損失來看，調變頻率卻是愈低愈好，所以正確的選擇電感和
電容是相當重要的[56,57]。 
輸出濾波器電感及電容兩元件之選擇與變流器之切換頻率、輸出
基本波之頻率及輸出電壓之諧波失真有關。較小的電感值電感與較大
的電容值電容會產生較低的諧波阻抗值。  
 50
使用之推挽式轉換器的輸入將是一直流 12 伏特的低輸入直流電
壓，故應用在此相當的合適。 
2. 雖然使用兩個功率電晶體，不過由於其驅動電路之負端相連通，
並免了共地之問題，因此驅動電路的設計較為簡單。 
3. 推挽式轉換器的缺點為：變壓器鐵心飽和(saturation)的問題。在
所有工作情況與溫度下，功率電晶體的飽和與轉換特性必須是一
樣的；如果其特性不相同，將使得鐵心趨於飽和。鐵心的飽和會
使得其中一個功率電晶體的集極有高的電流波尖產生。 
4. 由於輸出之電壓與電流波形其頻率變為原來之兩倍；因此，輸出
電感與輸出電容之元件值可以減少。 
5. 由於鐵心之磁通密度在推挽式結構中可以在正負週期中變化，因
此變壓器之利用率較高。 
推挽式轉換器電路架構一次側為低電壓高電流特別適合應用於
升壓電路至於變壓器鐵心飽和的問題可藉由緩衝電路、良好的驅動電
路和變壓器設計來改善。 
(4) 變壓器 
一般變壓器的操作其效率都非常高，不管是提高或降低輸出電壓
都與圈數比成比例變化也就是變壓器的初級圈與次級圈的變壓比與
圈數之間成正比如下式所示[61]： 
 
S
P
S
P
V
V
N
N =  (2-36) 
變壓器具有重要且有用的特性就是一次側級與二次測間電氣隔
離，由基本變壓器磁性關係 
 52
操作電流密度 D 的大小是由繞線執照廠商所提供而且都以每安
培 1000 圓密爾作基底單位然而在實際設計上所使用的電流密度都於
低值全依應用上與繞組圈數而定一般使用的電流密度值低於 200 是
較安全的。若對高功率以上設計我們使用 EE、EI 的鐵心。在此本文
所使用的鐵心規格為 42mm EE core 而一次側匝數為 20，二次側匝數
為 280。 
(5) 正弦式脈波寬度調變 
調變工作原理主要是將控制訊號與三角波訊號做一比較，以產生
脈波寬度調變訊號，因其中之控制訊號為正弦波訊號，故稱為正弦脈
波寬度調變[9-11]。由於三角波與正弦波的比較方式不同，有兩種脈
波寬度調變的切換技巧，我們將以脈波寬度調變技術應用於反流器之
控制。以下說明脈波寬度調變切換技術。 
定義振幅調變指數 am 為 
 
tri
control
a V
Vm ˆ
ˆ=  (2-43) 
式中 controlVˆ 為正弦波控制信號之大小， triVˆ 為載波之峰值。 
 
1f
fm sf =  (2-44) 
而頻率調變指數為式中 1f 為基本波頻率，亦稱為調變頻率， sf 為
切換頻率，亦稱為載波頻率。 
全橋式反流器採用正弦脈寬調變原理其輸出電壓極性可正可
負，因此依比較方式之不同，有單電壓極性切換與雙電壓極性切換兩
種脈寬調變切換技巧，如圖 2.34 及圖 2.35 所示。 
反流器之開關經由正弦脈波寬度調變切換後可將直流電壓轉換
 54
V dA NV
B NV
t r iV c o n t r o l
V
V d
- V d
t
t
t
t
)( B NVA NV
oV
−=
 
圖 2.35 雙極性正弦脈波寬度調變訊號 
(6) 市電並聯系統 
回授信號量測介面的功能為將變流器所輸出之電壓與電流經過
隔離轉換成可供輸入之類比信號，再透過數位信號處理器內建的 10
位元類比/數位轉換器，將類比信號轉換成數位信號以供數位信號處
理器內部計算用，而本計畫市電並聯系統中所使用之相關硬體電路詳
述如后。 
功率電晶體驅動電路 
驅動電路之目的乃在於隔離並放大由數位訊號處理器
(TMS320F2407)所產生的正弦脈波寬度調變信號，除了讓此控制訊號
足夠驅動功率電晶體正確的導通與截止外，並利用光耦合積體電路來
達到將電力訊號與控制訊號隔離。此驅動電路是使用 TLP250 光耦合
器來完成此項工作，其完整電路圖，如圖 2.36 所示。TLP250 具有快
速響應及高抗雜訊的功能，使用它來隔離功率元件在高電壓、大電流
情況下高頻切換所造成的干擾訊號，並可以使控制電路與驅動電路做
電氣隔離，以保護控制電路的正常操作。 
 56
位轉換的準確度，故需考慮輸入電壓大小，以求得分壓電阻值的比
例，且此分壓電阻值要大，使電阻不因消耗大量功率而發熱。 
電流回授信號量測 
電流偵測電路主要是利用霍爾元件(Hall Element)型號 HY-5P 來
完成。由於 TMS320F240 的 A/D 輸入為單電源(0~5V)，但霍爾元件
的輸出信號為雙電源信號，因此送到 DSP 做 A/D 轉換前，必須將霍
爾元件輸出信號作準位提昇的動作，此一動作是利用運算放大器來完
成。一般電流訊號的擷取較不容易，以往電流信號擷取方法，因阻抗
為被動元件會消耗功率，且也會有不同參考地點不同問題，所以比較
不實際，本論文採用 HY-5P 霍爾元件來檢測電流信號將電流信號輸
入霍爾元件經內部的霍爾效應，將電流信號轉換成電壓信號然後經積
體電路(TL074)放大器將信號放大，最後送到 DSP。其電路如圖 2.38
所示，另外霍爾元件可能會產生直流偏移(DC offset)問題，故必須加
一直流準位來調整直流偏移量。此種電流擷取方式將電力電路和控制
電路完全隔離，不會有共地問題亦可以降低功率消耗，改善傳統的電
流擷取方式。 
 
圖 2.38 電流迴授電路圖 
 58
 
圖 2.40 鎖相迴路示意圖 
在圖 2.40 中，輸入濾波器將高階諧波及雜訊濾除，經由適當地
調整相位比較器之輸出振幅與相位誤差訊號作比較；相位誤差訊號是
由相位誤差比較器之輸出經由迴路濾波器濾除交流成分後輸入至電
壓控制震盪器(VCO)，而反流器輸出電流之頻率及相位，即是藉由
VCO 所控制；一般大多數的鎖相迴路是由量測兩個訊號彼此間的零
點交越之相位差，並達到反流器輸出電流與市電電壓同步之目的。 
2.4.2 軟體程式架構 
為確保有效獲取本計畫所提多重再生能源發電系統之輸出功
率，本計畫各項軟體程式詳述如后。 
最大功率追蹤控制程式 
最大功率追蹤器系統的控制程式，就整個軟體程式而言，可分成
A/D 資料輸入取樣及轉換副程式、最大功率追蹤副程式及 PWM 控制
信號輸出副程式三個部份： 
(1)  A/D 資料輸入取樣及轉換副程式  
升降壓式直流轉換器輸出電流 Idc，需經 A/D 轉換為數位信號輸
入數位信號處理器，以計算同步發電機輸出功率。程式中規劃以副程
 60
市電並聯主程式 
圖 2.42 所示並聯模式主程式流程圖，本系統主程式主要執行周
邊暫存器的初始設定以及變數宣告。其中除了變數宣告外，周邊暫存
器的初始設定包括：PWM 輸出模式、計數器之計數模式、計數週期
中斷的時間、切換頻率的設定和捕捉器模式設定等相關參數設定。 
而主程式內有兩個副程式分別為零點交越中斷副程式及計時器
中斷副程式。計時器中斷副程式其中斷方式是藉由計數器至一個週期
時來觸發產生中斷要求，是屬於事件中斷而此副程式包括電流控制
器，中斷頻率 4.5KHZ； 
另一中斷副程式為零點交越中斷副程式是藉由市電電壓零點交
越偵測電路產生正緣觸發到數位訊號處理器裡，在市電正常時期中斷
頻率為市電頻率，此種中斷方式為外部中斷。 
(1)  零點交越中斷程式 
圖 2.43(a)所示為零點交越中斷程式流程圖，藉由零點偵測電路所產生
的方波訊號為一由負到正的正緣訊號時將啟動此一外部中斷程式將
其正弦參考電流訊號表的指標清除為零，此訊號使訊號處理器去重置
計數器值，再藉由讀取計數器數值，計算出市電電源之週期，而可作
為變流器輸出電壓頻率之依據，藉達成輸出電流相位追隨市電電壓相
位的要求。 
(2)  計時器中斷副程式 
圖 2.43(b)所示為計時器中斷程式流程圖，計時器中斷副程式啟動
A/D 轉換將所得到之變流器的輸出電流需經 A/D 轉換為數位信號輸
入數位信號處理器，根據正弦訊號參考表得到變流器輸出參考電流，
得出電流誤差信號，利用比例控制器，則計算出命令電流訊號，以得
到 SPWM 責任週期。程式中規劃以副程式週期性方式取樣讀取類比
 62
 
圖 2.43 副程式流程圖：(a)零點交越中斷副程式；(b)計時器中斷副程
式 
本 計 畫 之 控 制 核 心 採 用 德 州 儀 器 公 司 （ TI ） 生 產 之
TMS320LF2407 數位信號處理器，具有 30MIPS 運算速度，而且幾乎
所有指令都在單一指令週期（50ns）內完成，因此各種複雜的控制理
論，皆可以即時的方式實現。除了快速運算能力之外，強健的 I/O 及
周邊設備都是必要的。TMS320LF2407 擁有事件管理者（Event 
Manager），事件管理者包含了特殊的脈波寬度調變（PWM）功能，
如可程式規劃的截止時間（Programmable Dead Time）及使功率電晶
體切換達最大效率的空間向量脈波寬度調變（Space Vector PWM）產
 64
z 一個有 16bit 位址匯流排、16bit 資料匯流排及軟體等待（Wait 
State）產生器各一的外部記憶體界面模組 
C. 事件處理者（Event Manager） 
z 12 組比較/脈波寬度調變（PWM） 
z 4 組 GP 計時器/脈波寬度調變（PWM） 
z 6 組捕捉單元（Capture） 
D. 程式控制 
z 4 層的 pipeline 操作 
z 8 層的硬體推疊 
z 6 個外部中斷 
E. 一組 16 個 10 位元 A/D 轉換器 
F. 41 個獨立、多工及可程式規劃之 I/O pin 
G. 具有鎖相迴路（PLL-based）之時脈模組 
H. 具有即時中斷功能之看門狗計時器（Watchdog Timer） 
I. 串列通訊介面（SCI）模組 
J. 串列週邊介面（SPI）模組 
 66
2.4.3 綜合結論 
本章討論應用 TMS320F2407 數位訊號處理器之週邊應用與程式
軟體規劃，可以作為零點偵測電路控制和電流迴路控制。其中零點偵
測電路控制主要是藉由鎖定市電相位與頻率產生參考的正弦訊號，以
作為變流器和市電並聯的控制訊號。而電流回授控制將所得的電流訊
號加一偏移量 2.5V 後，在與程式內部參考電流表做比較，如此訊號
輸入到 DSP 控制在 0~5V，如此可避免上述相位以及正負半週判斷錯
誤問題。在對電流控制變流器與市電並聯而言，零點偵測電路所產生
的的正弦命令，可以當作參考訊號，使變流器可以追隨參考訊號。 
在系統中，為了精確達到與市電同步，即控制變流器輸出相位與
頻率，而同頻控制方法就是將變流器輸出頻率設定與市電同頻率即可
達到與市電頻率相同。同相控制方法就是市電電壓與變流器輸出電流
零電交越點時間差求得相位差，在市電電壓零點交越時，補償參考正
弦表的指標值來達成，所以在系統上利用此兩種方法達到與市電同步
的穩定性更好。 
 
 
 
 
 
 
 
 
 
 
 
 
 68
於風速大小，且在風速變化時，其輸出電壓與電流會隨之變化，進而
風力發電機的輸出功率亦隨之變動。針對實際風力發電機組而言，由
於電壓變化幅度較大，故選擇升降壓型轉換器。 
本年度計畫完成太陽能與風力之多重再生能源發電系統之直流
充電系統架構如圖 3.1 所示，係由：(1)太陽能光電板、(2)風力渦輪機、
(3)永磁式同步發電機、(4)三相全橋式整流器、(5)多重輸入直流轉換
器、(6)蓄電池所組成。其基本電路原理可依循[65]，適當的結合 PWM
轉換器，即可衍生不同之多重輸入直流轉換器。 
然而此轉換器於穩態下之輸出電壓與輸入電壓關係可由電感伏
特-秒平衡原理推導得之為： 
 PVWindout Vd
dV
d
dV
1
2
2
1
11 −+−=  (3-1) 
 
圖 3.1 太陽能與風力多重發電系統之直流充電系統架構圖 
 70
率追蹤，其中包括太陽能與風力發電系統，並且予以分析比較。判斷
規則如下所述： 
(1) 輸出功率較變動前大→負載繼續朝同一方向變動； 
(2) 輸出功率較變動前小→負載改變方向變動。 
太陽能與風力發電系統最大功率追蹤的控制流程圖則如圖 3.3。
就整個軟體程式而言，大致可分成三個部份：(1)A/D 資料輸入取樣及
轉換副程式(信號擷取)，(2)控制方法副程式，(3)PWM 控制信號副程
式。 
  A/D 資料輸入取樣及轉換副程式 
    太陽能光電板輸出直流電壓 VPV與電流 IPV、三相全橋式整流器
輸出的直流電壓 VWind 與電流 IWind 以及多重輸入直流轉換器輸出電
壓 Vout，皆需經 A/D 轉換為數位信號輸入數位信號處理器，以計算
各再生能源輸出功率。程式中規劃以副程式週期性方式取樣讀取類
比電壓信號，再做 A/D 轉換，所得的數位資料定期輸入主程式，進
行輸出功率計算。 
  擾動與觀察法副程式 
    主程式定期輸入 A/D 副程式轉換的數位信號，經計算出太陽能
光電板輸出功率後與太陽能光電板的輸出電壓同時輸入擾動與觀
察法副程式比較後，可決定新的新的週期比信號，以調整 PWM 控
制信號。 
  PWM 控制信號輸出副程式 
    PWM 控制信號副程式的作用是，由週期比信號與一個三角波
電壓信號作比較，產生多重輸入直流轉換器的閘流體閘極觸發控制
信號，以驅動閘流體功率電路。 
 72
電機)在各日照量(風速)下，將實際運轉的情形加以測量記錄，以得到
各風速下之最大功率點；當下次太陽能發電系統(風力發電機)在各日
照量(風速)運轉時，則可依據之前的測量記錄，直接給予昇降壓電路
最佳的責任週期信號，使太陽能發電系統(風力發電機)在最大功率點
下運轉。 
本方法係將功率作為數位信號處理器之輸入參數，如圖 3.4 所
示，當日照量(風速)接近日照量 1(風速 1)時，若所測得的功率大小，
落在 P1'與 P1"之間，則將責任週期設定為 D1，使輸出功率接近最大
功率點 P1；當日照量(風速)上升至日照量 2(風速 2)附近時，此時的功
率將落在 P2'與 P2"之間，則數位信號處理器將依紀錄的規定，將責任
週期更新為 D2，使輸出功率逼近最大功率 P2。此外 P1'、P1"、P2'、
P2"的設定，亦為經驗上主觀的決定。 
負
載
輸
出
功
率
P o
ut
（
）
 
瓦
 
文
字
 
圖 3.4 再生能源發電系統之功率曲線圖 
 
 74
3.1.2.3 三點權位比較法(Three-Point Weighting-Comparison 
method) 
一般而言，太陽日照並不會快速變化，若因人為或自然因素干擾
(如：烏雲短時間的遮蔽)，使得在快速的擾動下，將造成功率上的損
失。此外風力發電系統亦受到風速快速變化的影響，其輸出功率也勢
必跟著受到影響而偏離了最佳的運轉點，使所得到的風能無法有效地
轉化為電能輸出。 
三點權位比較法可以降低傳統擾動與觀察法於功率短暫性變化
時，因錯誤的擾動造成功率的損失。因此，過去使用於太陽能發電系
統最大功率追蹤之三點權位比較法，除了應用於本計畫所提多重再生
能源發電系統中，太陽能發電系統之最大功率追蹤，本計畫將更進一
步建立於風力發電系統上，以提高整體運轉效能，並進行分析與比較。 
三點權位比較法[74]的基本原理與擾動觀察法類似，其中擾動與
觀察法係以擾動前與擾動後兩點的輸出功率作比較；三點權位比較法
係以偵測三點輸出功率進行比較判斷。三點權位功率型態圖如圖 3.6
所示，連續偵測三點的功率值並比較其大小在計算出權位值，經由權
位值可判定立足點要往 C 點移動、A 點移動、或不移動。權位的設定
與比較規則描述如後： 
1. 權位設定： 
C 點與 B 點比較，若 C 點大於或等於 B 點權位 W1設定為正
號，反之则設定為負號權位；A 點與 B 點比較，若 A 點大於或
等於 B 點權位 W2設定為負號權位，反之则設定為正號權位。 
2. 比較規則： 
z 0& 21 >WW ：正斜率，責任週期 D 往右移動，如圖 3.6(1)與(4)。 
z 0& 21 <WW ：負斜率，責任週期 D 往左移動，如圖 3.6(3)與(6)。 
 76
應的功率值 Pa、Pb、Pc，如圖 3.8(a)所示。 
三點權位比較程式 
比較三點功率大小計算出權位值，經由權位值來判定立足點要
往 A 點移動、C 點移動或不移動，如圖 3.8(b)所示。 
開始
輸出責任週期 Db
讀取 Vb 與 Ib
Dc= Db+dD
讀取 Vc 與 Ic
Da= Db-dD
讀取 Va 與 Ia
計算 Pa、Pb、Pc
Pc>=Pb ?
Pb>Pa ?
W1&W2>0?
Db=Db
Db=Dc
Db=Da
返回
權位值歸零
是
否
三點權位
比較程式
三點權位
比較程式
：權位 W1<0
：權位 W1>0
：權位 W2>0
：權位 W2<0
是
否
W1&W2<0
是
否
否
是
(b)(a)  
圖 3.8 三點權位比較法控制流程圖 
 78
與相對應之責任週期控制信號；風力發電系統：線上輸入向量為風
速，離線輸入向量則為風速與相對應之責任週期控制信號。第二層為
特徵表現層，主要工作係接受輸入層的輸入與樣本信號做比對。最上
一層為分類表示層，又稱為贏者全拿層，此層的每個神經元都代表者
一種分類，它們彼此競爭，以爭取與輸入信號進行比對的機會，若最
後的相似度比對成功，則此神經元便將此輸入視為它所代表的信號之
一，然後進行鏈結值的修正。 
圖 3.10 中，有兩組鏈結值 hjw 與 jhwˆ ， jhwˆ 是負責將特徵表現層的
信號往上傳遞，以便讓位於分類表示層的神經元彼此競爭； hjw 則是
負責將得勝的神經元所儲存的樣本送至特徵表現層做比對。此外，增
益控制單元係提供控制信號至特徵表現層，以便區別輸入與樣本信
號；重置單元則係辨別輸入信號與樣本空間的相似度是否已超過警戒
參數，若未超過，則允許下個樣本進行比對，或要求一個尚未被使用
過的神經元來記憶此未處理過的輸入。 
}{ hjw }ˆ{ jhw
 
圖 3.10 模糊自適應共振理論之網路架構圖 
 80
 
⎩⎨
⎧= 其他
歸屬於類別群集
             0
   /
)( max
ckrr
w kkcμ  (3-4) 
其中， kr 為群集 k 的半徑， maxr 為群集中最大群集的半徑。 
接下來考量樣本信號與群集的距離，可由下式的加權歐幾里德距
離計算得知。 
 mkiik wxxd −=)(  (3-5) 
其中，參數 m 表示距離歸屬值的加權量。因此，利用重疊原理可得
)( kc wμ 的正規化函數式，如下式所示： 
 
( )∑
∑
=
=
−
−= K
k
m
ki
k
K
k
m
ki
kc
ic
wx
rr
wx
w
x
1
max
1
1/
1)(
)(
μ
μ  (3-6) 
因此，根據歸屬函數值最高者，歸類樣本信號於所屬類別。 
3.1.3 結果比較與討論 
本年度計畫目標於多重再生能源發電系統中，於數位信號處理器
(TMS320LF2407)[78]上，設計並分析以傳統擾動觀察法及所提之最佳
點近似估測法、三點權位比較法與模糊自適應共振理論類神經網路演
算法等四種追蹤技術，藉由改變直流轉換器閘流體之導通角度以執行
最大功率追蹤，以有效達成多重再生能源發電系統之最大功率輸出。 
本計畫採用本系現有之美國西南風力公司(Southwest Windpower)
製造之 400W 風力渦輪機與永磁式同步發電機組合；以及目前中原大
學電機系於能源委員會及本校資助下，已成功建構一套 10kW 的太陽
光電能發電系統，故本計畫將部份太陽能板改裝為獨立型式(約
1kW)，而其太陽能光電板乃採用西門子太陽光電模組(SP75)，SP75
是由 36 個單結晶矽太陽光電池所構成，單一 SP75 額定功率為 75 瓦。 
 82
 
圖 3.12 不同日照量下，太陽能電池 I-V 曲線 
 
圖 3.13 不同日照量下，太陽能電池 P-V 曲線 
 
圖 3.14 不同溫度下，太陽能電池 I-V 曲線 
 84
本計畫將傳統擾動觀察法、最佳點近似估測法、三點權位法與模
糊自適應共振理論類神經網路演算法四種最大功率追蹤控制方法應
用於實際發電系統，以觀察其實際效能，如圖 3.18 與圖 3.19 所示。
圖 3.18 為風力機實際輸出功率；圖 3.19 為太陽能電池實際輸出功率。
由實驗結果可知，上述四種控制理論皆具使系統追蹤至最大功率點之
能力，而風力發電機平均則以模糊自適應類神經網路所控制的輸出功
率較高(風速：19.15，功率約有 87.8543W)；太陽能電池則以三點權
位法於某日中午 1 點 30 時，所得輸出功率較佳，約有 616.1142W。
以下將針對各追蹤方法於最大功率點後運轉效能之差異加以討論： 
(1) 擾動觀察法 
擾動觀察法，因程式簡單，只有變數大小的判斷，而無任何計算
式，因此其追蹤最大功率的速度較快，且有不錯效果；但在追蹤的過
程中，責任週期並不是一直往理想的方向增加，卻有時會往功率減少
的方向擾動，而增加追蹤的時間。這種判斷錯誤的情況，可能是因為
電流檢測電路輸出電流訊號不穩定所造成；由示波器觀查追蹤過程
中，輸出至 DSP 之電流值大小，會有些微的前後震盪的雜訊產生，
此時將影響程式中電流值之大小判斷。 
此外責任週期擾動大小之決定，若是擾動過大，則可能會追超過
最大功率點過多，因功率特性曲線的右半面較陡峭，將使功率急速下
降；若是擾動太小，則 DSP 可能因功率的變化太小，而讀不到電流
之變化值。在本實測結果中，擾動觀察法使系統追至最大功率點後，
其輸出功率將持續地在最大功率點附近擾動。 
(2) 最佳點近似估測法 
最佳點近似估測法為本計畫在四種控制理論實驗中，最大功率追
蹤速度最快、最穩定者。此法依據風力發電機與太陽能電池的特性曲
線作為經驗，在控制程式中根據所測得的風速、日照、功率與電流等
 86
0
100
200
300
400
500
600
700
03
:30
04
:30
05
:30
06
:30
07
:30
08
:30
09
:30
10
:30
11
:30
12
:30
13
:30
14
:30
15
:30
16
:30
17
:30
18
:30
19
:30
20
:30
時間
功
率
(W
)
預期功率
擾動觀察
最佳點估測近似
三點權位法
模糊自適應類神經網路
 
圖 3.19 某日太陽電池實際輸出功率比較圖 
 
3.2 第二年度 
本計畫第二年度為利用蓄電池殘電量估測與充、放電控制規則，
建立循環式充、放電控制系統；另外，透過電腦建立完成市電併聯模
擬系統，以進行現有孤島偵測方法與本計畫所提電壓差分相關性擾動
法(Differential Voltage Correlation Method, DVC)之模擬分析與比較，
作為本計畫所建構系統效能評估與實際研製之依據。 
3.2.1 循環充放電控制系統 
本計畫於循環充放電系統之控制核心採用 Cygnal 生產之
C8051F124 混合訊號微控制處理器，具有 50MIPS 運算速度，除了快
速運算能力之外，強健的 I/O 及周邊設備皆為系統所需。C8051F124
擁有 12-bits 且每秒可達 100,000 次的速度擷取和轉換類比訊號的類
比數位轉換器，以及 8 對 1 的多工器，以增加切換彈性，故對本計畫
而言，可有效擷取回授訊號之數值。另外，其亦有 128k bytes 的可程
式規劃之撰寫空間與 8448 bytes 的資料存取空間，更有利於運算程式
之撰寫與擷取資料的存放。C8051F124 內部諸元可參照文獻[85]。 
 88
用之負載參數。 
3.2.2.1 電感性負載測試 
此案例以負載 A 為測試對象，假設於 0.3 秒分散式發電系統發生
孤島運轉現象，峰值電壓由 155.7 伏特下降至 153 伏特，如圖 3.21(a)
所示。因電壓變動之範圍未超出欠電壓與過電壓保護電驛跳脫臨界
值，所以在此案例以電壓變動觀點來偵測孤島運轉現象發生與否將無
法成功。 
另一方面，若採以頻率保護方式來防止孤島現象發生仍然無法正
確有效偵察，如圖 3.21(b)負載 A 發生孤島現象前後之頻率變動圖；
相同情況，於 0.3 秒發生孤島運轉現象，由於頻率變化量極小無法觸
發欠/過頻率保護電驛動作。主動式頻率飄移法在此案例也無法正確
偵測出孤島現象發生時間。因負載 A 之共振頻率為 60.4Hz，此時，
輸出頻率將不再變動停止於穩態操作點，無法啟動過頻率保護電驛防
止多重再生能源發電系統電能輸出。發生孤島現象前後所計算出之偵
測指標值大小明顯不同。上述所計算出孤島效應偵測指標值也說明電
壓差分相關性擾動法可以克服傳統被動式偵測法之缺失與縮小孤島
現象無法偵測之區域。 
表 3-1 負載與電力參數 
負載參數 
 負載 A 負載 B 負載 C 
電阻 17Ω  17Ω  13Ω  
電感 29 mH 29mH 29mH 
電容 220 Fμ  268.9 Fμ  239.4 Fμ  
電力參數 
電壓 110V（rms） 
頻率 60Hz 
 
 
 90
 
0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8
1 3 0
1 3 5
1 4 0
1 4 5
1 5 0
1 5 5
1 6 0
1 6 5
1 7 0
1 7 5
1 8 0
 
(a)負載電壓包絡訊號 
 
0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8
- 3 0
- 2 0
- 1 0
0
1 0
2 0
3 0
 
(b)差分電壓與電流輸出擾動脈波訊號 
圖 3.22 電壓差分相關性法電感性負載測試 
以相同負載案例作測試，偵測法改以本計畫所提電壓差分相關性
擾動技術，測試結果如圖 3.32 所示，圖 3.32(a)中電壓峰值在 0.3 秒發
生孤島運轉後因反流器輸出電流擾動致使電壓也產生波動的現象；經
由差分電壓計算後明顯觀察於孤島運轉前後峰值電壓變化之不同，圖
3.32(b)為差分電壓與電流擾動脈波訊號；於正常運轉情況下，多重再
生能源發電系統發生孤島運轉前之偵測指標 ibD =0；發生孤島運轉
後，孤島現象偵測指標 iaD =1.575。 
 92
發生 20％電壓突昇現象並且持續 7 個電力週期。 
(iii) 孤島運轉與電力諧波干擾 
本測試係在模擬電力孤島運轉前有諧波干擾的加入，以觀察該諧
波現象是否影響孤島現象之偵測。在此試驗中，諧波成分包含第 3、
5、7、11 及 13 次諧波，且各階諧波成分分別為基頻之 10％、7％、5
％、3％及 1％。 
(iv) 孤島運轉與電壓閃爍干擾 
本測試係模擬在電力孤島運轉前有電壓閃爍擾動的加入。模擬之
電壓閃爍訊號係由一標準市電電壓訊號與低頻電壓源來代表閃爍電
壓，以本例而言，以 10Hz 及 18Hz 的閃爍電壓與標準電壓 60Hz 作合
成。 
(v) 孤島運轉與雜訊干擾測試 
為測試孤島效應監測系統受訊號雜訊（Noise）干擾的影響。其
中，電力訊號雜訊波動干擾係利用外加一平均值為零標準偏差為三之
白色高斯雜訊於正常電壓訊號中，其訊號雜訊比（Signal to Noise Ratio, 
SNR）為 29.8dB。 
(vi) 風速遽變 
本測試係模擬風速瞬間變化對於孤島效應監測系統準確性之衝
擊。藉由模擬風速驟增改變風力機輸出功率增加 70％，視孤島監測
系是否發生誤判情形。 
(vii) 負載驟變 
此測試係模擬用戶端負載變動時監測系統對於孤島現象診斷之
穩定性探討。係改變用戶端負載由 0.53KW 提昇至 0.89KW。 
 94
(iv) 電壓驟降維持 0.067 秒。 
(v) 電壓驟降時間與反流器輸出脈波同步。 
 
表 3-2 反流器輸出脈波擾動與電壓驟降同步第一視窗計算之孤島效
應偵測指標值 
電壓驟降週期數 視窗寬度 
（週期） 
1 2 3 4 5 6 7 8 9 10 
4 0.93 1.87 2.81 3.75 3.75 3.75 3.75 3.75 3.75 3.75 
5 1.50 2.25 3.00 3.75 3.00 3.00 3.00 3.00 3.00 3.00 
6 1.25 2.50 3.12 3.75 3.12 2.50 2.50 2.50 2.50 2.50 
7 1.07 2.14 3.21 3.75 3.21 2.67 2.14 2.14 2.14 2.14 
8 0.93 1.87 2.81 3.75 3.28 2.81 2.34 1.87 1.87 1.87 
9 0.83 1.66 2.50 3.33 2.50 2.08 1.20 1.20 1.66 1.66 
10 0.75 1.50 2.25 3.00 2.25 1.50 0.75 0.75 1.12 1.50 
11 0.68 1.36 2.04 2.72 2.04 1.36 0.68 0.34 0.68 1.02 
12 0.31 0.62 0.94 1.25 0.94 0.62 0.31 0 0.15 0.31 
註： 表其值大於孤島運轉偵測指標閥值。 
 
表 3-3 反流器輸出脈波擾動與電壓驟降同步第二視窗計算之孤島效
應偵測指標值 
電壓驟降週期數 視窗寬度 
（週期） 
1 2 3 4 5 6 7 8 9 10 
4 0.93 1.87 2.81 3.75 2.81 1.87 0.93 0 0 0 
5 0 0.75 1.50 2.25 1.5 0 -0.75 -1.5 -0.75 0 
6 0 0 0.62 1.25 0.62 0 -1.25 -2.5 -1.87 -1.25 
7 0 0 0 0.53 0 -0.53 -1.07 -2.14 -1.07 0 
8 0 0 0 0 -0.47 -0.93 -1.40 -1.87 -0.93 0 
9 0 0 0 0 0 -0.41 -0.83 -1.25 -0.83 0 
10 0 0 0 0 0 0 -0.37 -0.75 -0.37 0 
11 0 0 0 0 0 0 0 -0.34 0 0.34 
12 0 0 0 0 0 0 0 0 0.15 0.31 
註： 表其值大於孤島運轉偵測指標閥值。 
 96
期數與脈波電流同步情況，可透過表 3-2 分析瞭解。所以無論發生電
壓驟降持續幾個期數，只要與電壓驟降訊號起始時間點與電流脈波擾
動訊號達成同步孤島監測系統就有可能發生誤判的情形。 
孤島現象監測指標值之運算週期為大於四個週期，倘若在第一視
窗計算週期內，是由於電壓驟降等事件造成所計算出之偵測指標值超
過門檻值，代表此電壓驟降訊號與反流器輸出脈波有其正相關性，但
於下一個視窗週期內則電壓驟降訊號與電流脈波訊號將不存在有任
何相關性，由表 3-3 統計數據可瞭解，本文在此設定視窗寬度所計算
之週期數為 8 個電力週期，圖 3.25 為孤島運轉監測系統決策流程圖。
因此，將孤島運轉監測系統之判斷決策修改為連續兩筆孤島運轉監測
指標大於所設定之門檻值，可解決系統發生孤島運轉誤判之情況。 
iD
>
 
圖 3.25 孤島運轉監測系統決策流程圖 
 98
式變流器之元件表，功率電晶體 M1與 M2為太陽能電池與風力發電機
之雙輸入轉換器功率開關元件。兩再生能源輸入端濾波電容 Cpv與 Cw
之功能為穩定再生能源裝置的輸出電流，電感 Lpv、Lw 則為雙輸入轉
換器之儲能電感，而直流側電容 Cdc 則具有能量暫存之功能，電感 Lf 
與電容 Cf 則為全橋式變流器輸出二階低通濾波器。 
 
圖 3.26 太陽能電池陣列實體圖 
 
 
   圖 3.27 風力發電機與工業用風扇實體圖 
 
 100
3.3.2 最大功率追蹤與市電並聯控制 
藉由數位訊號處理器控制太陽能板輸出電流的方式，使太陽能板
之輸出功率往最大功率點移動。由於採用第一年度計畫所提追蹤法
則，當追蹤到最大功率點時會有擾動產生，使用較大的電流擾動量或
擾動頻率可以加快最大功率追蹤的響應速度，但是會造成系統在最大
功率點附近產生震盪的情況而造成功率損耗，所以擾動參數的選擇是
需依照太陽能板的電器特性決定。由圖 5-4 中可得知多重輸入轉換器
之太陽能發電系統能確實追隨到額定的最大功率約在 500W 上下，驗
證了此最大功率追蹤方法的可行性與正確性。 
div/)s(時間
)
(
PVP
輸
出
功
率
)
(
PVI
輸
出
電
流
)
(
PVV
輸
出
電
壓
 
圖 3.29 太陽能發電系統操作在最大功率追蹤時之輸入電壓 Vpv 、輸
入電流 Ipv、輸入功率 Ppv之波形圖 
 102
後續分別為市電並聯系統硬體控制電路之訊號波形，其中圖 3.31
為變流器功率電晶體開關同一臂上下開關的驅動訊號，圖 3.32 為零點
偵測電路輸出之波形。當市電電壓為負半周轉為正半周之零點時，零
點偵測電路送出正緣觸發脈衝訊號，圖 3.33 為系統加入零點偵測使變
流器輸出電壓與市電電壓達到同相位。圖 3.34 為市電並聯之波形。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 3.31 變流器功率電晶體開關同一臂上下開關的驅動訊號 
 
TA+開關切換驅
動訊號 
TA-開關切換驅
動訊號 
   (a)         (10V/div，400us) 
TB+開關切換 
驅動訊號 
TB-開關切換 
驅動訊號 
(b)        (10V/div，400us)
 104
 
 
 
 
 
 
 
圖 3.34 市電並聯模式下輸出電流為 1.1A 輸出電壓與電流之波形 
 
 
 
 
 
 
 
 
圖 3.35 電阻性負載，當孤島效應發生時偵測之情況 
3.3.3 孤島偵測系統 
為驗證本計畫第二年度所提主動式電壓差分相關性擾動法之可
行性，本計畫實際測試系統操作在並聯市電情況下，當市電發生解聯
停止供電，此系統能偵測出發生孤島效應，而使產生觸發訊號使電驛
跳脫停止變流器輸出供電。圖 3.35 為系統操作市電並聯情況時，此時
市電電壓 Vs
變流器輸出電流
Iinv 
Vs(100V/div，10ms) 
Iinv(1A/div，10ms) 
Vload(100V/div，40ms) 
Vtrig(5V/div，40ms)  
負載端電壓 
Vload 
觸發訊號 
Vtrig 
孤島發生點 
0.25s 
孤島偵測 
 106
圖 3.37 測試之負載為電感性負載(40W電阻性負載加上 20mH電
感)，當在市電並聯情況下，此時將負載切離，偵測電驛是否有誤判
現象，根據此圖顯示，電驛不會有誤判現象。圖 3.38 測試之負載為
電容性負載(40W 電阻性負載加上 80uF 電容)，當在市電並聯情況下，
此時將負載切離，判斷是否有誤判現象，根據此圖顯示，電驛不會有
誤判現象。 
 
 
 
 
 
 
 
圖 3.37 電感性負載，在市電並聯之情況負載切離 
 
 
 
 
 
 
 
 
圖 3.38 電容性負載，在市電並聯之情況負載切離 
Iload(0.5A/div，40ms) 
Vtrig(5V/div，40ms) 
負載端電流
Iload
觸發訊號
Vtrig
Iload(0.5A/div，40ms) 
Vtrig(5V/div，40ms) 
負載端電流
Iload
觸發訊號
Vtrig
 108
3.3.3 結果比較與討論 
本計畫完成實際多重再生能源發電系統之市電並聯運轉系統，在
實驗過程中，遇到突波問題，當 Vce 端電壓為 50V 實則突波達到
200V，所以利用緩衝電路來將突波能量釋放，而 RC 值與模擬值差距
很多，可能未精確考慮系統參數值，以導致要 try and error 來取得 RC
值。而在變流器輸出電流波形失真很嚴重，是因為本系統採用 C 語言
而因計算速度關係，正弦電壓取樣點只取 75 點，而 LC 濾波電路，
濾波電感是自己繞所需要電感值，也因繞的不夠密可能造成漏電感使
輸出電流無法達到系統所需電流波形，以上兩點造成電流波形失真的
重要原因。 
在孤島偵測方面，根據工業標準建議，分散式發電系統造成的孤
島效應，必須在 0.5 秒以內也就是 30 週期被偵測出並停止，而本系統
孤島偵測因連續判斷孤島指標 Dx兩次，所以至少 15 週期，因只判斷
一次 Dx 誤判機率很高，在並聯市電那一時間與加載或減載時，因電
壓變動而此時造成 Dx 大於設定閥值，而造成誤判為孤島效應。雖連
續判斷兩次 Dx，時間多 6 週期，但是達到高偵測穩定度。 
 
 
 
 
 
 110
[9] 陳家宏，太陽能電池最大功率點追蹤之設計與製作，淡江大學，電機工程
研究所，碩士論文，民國 90 年 6 月。擾動 
[10] 于俊傑，風力發電最大功率追蹤技術之研究，中原大學，電機工程研究所，  
碩士論文，民國 93 年 7 月。最佳 
[11] 陳家宏，太陽能電池最大功率點追蹤之設計與製作，淡江大學，電機工程
研究所，碩士論文，民國 90 年 6 月。三點 
[12] S. Vasilic and M. Kezunovic, “Fuzzy ART Neural Network Algorithm for 
Classifying the Power System Faults,” IEEE Transactions on Power Delivery, 
2004.模糊 
[13] K. L. Butler, J. A. Momoh, and D. J. Sobajic, “Field studies using a 
neural-net-based approach for fault diagnosis in distribution networks,” in Proc. 
Inst. Elec. Eng., Gen. Transm. Distrib., Vol. 144, pp. 429-436, Sept. 1997.模糊 
[14] T. M. Cover and P. E. Hart, “Nearest neighbor pattern classification,” IEEE 
Trans. Inform. Theory, vol. IT-13, pp. 21–27, Jan. 1967.模糊 
[15] M. Veerachary, T. Senjyu, and K. Uezato, “Feedforward maximum power point 
tracking of PV systems using fuzzy controller,” IEEE Transactions on 
Aerospace and Electronic Systems, Vol. 38, No. 3, pp. 969-981, July 2002.模糊 
[16]  A. D. M. Torres, F. L. M. Antunes, and F. S. D. Reis, “An artificial neural 
network-based real time maximum power tracking controller for connecting a 
PV system to the grid,” IEEE, 1998.模糊 
[17]  T. Hiyama, S. Kouzuma, T. Imakubo, and T. H. Ortmeyer, “Evaluation of 
neural network based real time maximum power tracking controller for PV 
system,” IEEE Transactions on Energy Conversion, Vol. 10, No. 3, pp. 543-548, 
Sep. 1995.模糊 
[18]  M. Veerachary, T. Senjyu, and K. Uezato, “Neural-network-based 
maximum-power-point tracking of coupled-inductor 
interleaved-boost-converter-supplied PV system using fuzzy controller,” IEEE 
Transactions on Industrial Electronics, Vol. 50, No. 4, pp.749-757, August 
2003.模糊 
 112
Lead-Acid Batteries used for Electric vehicles,” 29th Power Electronics 
Specialists Conference(PESC), IEEE, pp. 583-587. 
[31] T. Takasaki, K. Takano, and M. Ichimura, “Deterioration Measuring Method of 
VRLA Battery Used in UPS Systems,” IEEE, pp. 799-804, 1996. 
[32] S. Sato and A. Kawamura, “A New Estimation Method of State of Charge using 
Terminal Voltage and Internal Resistance for Lead Acid Battery,” IEEE, 
pp.565-570, 2002. 
[33] T. Yanagihara and A. Kawamura, “Residual Capacity Estimation of Sealed 
Lead-Acid Batteries for Electric Vehicles,” Ias Power Conversion Conference, 
IEEE Power Engineering, pp. 943-946, 1997. 
[34] Cygnal Integrated Products. Inc. 
http://www.silabs.com/tgwWebApp/appmanager/tgw/tgwHome 
[35] M. E. Ropp, “Design Issues for Grid-Connected Photovoltaic Systems,”Ph.D. 
dissertation, Georgia Institute of Technology, Atlanta, GA, 1998. 
[36] G. A. Smith, P. A. Onions, and D.G. Infield, “Predicting Islanding Operation of 
Grid Connected PV Inverters,” IEE Proceedings-Electrical Power Applications, 
Vol. 147, No. 1, pp. 1-6, Jan. 2000. 
[37] M. E. Roop, M. Begovic and A. Rohatgi, “Analysis and Performance 
Assessment of the Active Frequency Drift Method of Islanding Prevention,” 
IEEE Transactions on Energy Conversion, Vol. 14, No. 3, pp.810-816, Sept. 
1999. 
[38] A. Worte,  R. Belmans, K. U. Leuven, and J. Nijs, ”Islanding of Grid 
Connected  Ac Module Inverter,” IEEE Photovoltaic specialists Conf, pp. 
1683-1686, 2000. 
[39] mith, P. A. Onions, and D.G. Infield, “Predicting Islanding Operation of Grid 
Connected PV Inverters,” IEE Proceedings-Electrical Power Applications, Vol. 
147, No. 1, pp. 1-6, Jan. 2000. 
[40] G. A. S Michael Ropp, “Evaluation of Islanding Detection Methods for 
Photovoltaic Utility Interactive Power Systems, “ Report IEA PVPS, T5-09, 
2002. 
[41] O. Tsukamoto, and K. Yamagishi, “Detection of Islanding of Multiple 
Dispersed Photovoltaic,“ In Proceeding of ICEE, pp. 526-529, 1997. 
 114
[55] 李思賢，數位式單相低功率太陽光電能轉換系統，國立中山大學，電機工
程研究所碩士論文，民國九十一年六月。 
[56] P. A. Dahono, A. Purwadi and Qamaruzzaman,” An LC Filter Design Method 
for Single-Phase PWM Inverter,” IEEE Power Electronics and Drive systems, 
pp. 571 -576,1995 
[57] 楊志祥，以 80196MC 微控制器為基礎之換流器研製，國立中正大學電機工
程研究所碩士論文，民國八十九年。K. H. Liu and F. C. Lee, “Topological 
Constrains on Basic PWM Converters,” IEEE PESC, pp. 164-172, 1988. 
[58] M.A. Redfern, J. Barrett, O. Usta, “A New Microprocessor Based Islanding 
Protection Algorithm for Dispersed Storage and Generation Units,” IEEE 
Transactions on Power Delivery, Vol. 10, No. 3, July 1995. 
[59] J. D. Chryssis, High-Frequency switching Power Supplies, McGraw-Hill,Inc. 
1984. 
[60] 鄭培璿，電力電子分析與模擬，全華科技圖書股份有限公司，民國九十一
年四月。 
[61] 梁適安，高頻交換式電源供應器原理與設計，全華出版社，民國八十四年。 
[62] S. Vasilic and M. Kezunovic, “Fuzzy ART Neural Network Algorithm for 
Classifying the Power System Faults,” IEEE Transactions on Power Delivery, 
2004. 
[63] 董勝源編譯，DSP TMS320LF2407 與 C 語言控制實習，長高企業公司，民
國 93 年。 
[64] S. Vasilic and M. Kezunovic, “Fuzzy ART Neural Network Algorithm for 
Classifying the Power System Faults,” IEEE Transactions on Power Delivery, 
2004. 
[65] K. H. Liu and F. C. Lee, “Topological Constrains on Basic PWM Converters,” 
IEEE PESC, pp. 164-172, 1988. 
 
[66] E. Koutroulis, K. Kalaitzakis and N.C. Voulgaris, “Development of a 
microcontroller-based photovoltaic maximum power point tracking control 
system,” IEEE Transactions on Power Electronics, Vol. 16, No. 1, pp. 46-54, 
Jan. 2001. 
[67] K.H. Hussein, I. Muta, T. Hoshino and M. Osakada, “Maximum photovoltaic 
power tracking: an algorithm for rapidly changing atmospheric condition,” IEE 
 116
42, No. 1, pp. 58-62, Feb. 1995. 
[82] M. E. Ropp, “Design Issues for Grid-Connected Photovoltaic Systems,”Ph.D. 
dissertation, Georgia Institute of Technology, Atlanta, GA, 1998. 
[83] G. A. Smith, P. A. Onions, and D.G. Infield, “Predicting Islanding Operation of 
Grid Connected PV Inverters,” IEE Proceedings-Electrical Power Applications, 
Vol. 147, No. 1, pp. 1-6, Jan. 2000. 
[84] O. Tsukamoto, and K. Yamagishi, “Detection of Islanding of Multiple 
Dispersed Photovoltaic,“ In Proceeding of ICEE, pp. 526-529, 1997. 
[85] Cygnal Integrated Products. Inc. 
http://www.silabs.com/tgwWebApp/appmanager/tgw/tgwHome 
 
伍、計畫成果自評 
本計畫於第一年度執行期限內，採用再生能源發電系統架構整體
規劃，其中分為軟體和硬體兩部分相互配合進行，並依照計畫訂定目
標循序執行，進而順利達成計畫預定之目標。 
本計畫中，設計與執行分析四個不同之最大功率追蹤程式於數位
信號處理器，包括有傳統擾動觀察法、最佳點近似估測法、三點權位
比較法與模糊自適應共振理論類神經網路演算法等四種追蹤技術，藉
由改變直流轉換器閘流體之導通角度以執行最大功率追蹤。 
參與本計畫第一年度之研究人員，對硬體電路的設計、數位信號
處理器、程式語言撰寫、硬體之控制及神經網路相關知識能力提升均
頗有助益，奠定往後研究人員往後從事相關工作的基礎。 
此外，於本計畫第二年度之執行期限內，採用再生能源發電系統
架構整體規劃，其中分為軟體和硬體兩部分相互配合進行，並依照計
畫訂定目標循序執行，進而順利達成計畫預定之目標。本計畫中，設
計與執行分析循環式充放電控制系統、市電併聯與孤島監測模擬系
