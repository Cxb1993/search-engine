  1
摘要 
以自激式感應發電機發電時最重要問題莫過於隨機
改變的負載所引起的電壓及頻率之變動。傳統上，電力系
統匯流排電壓的調整可藉由靜態同步補償器來達成，但是
當其應用於自激式感應發電機時，由於系統頻率容易隨著
負載而變動，所以靜態同步補償器很容易失去同步的能
力，進而無法有效改善對系統的激磁特性。本計畫提出相
對旋轉速度理論：一方面用以改善靜態同步補償器之同步
能力，使其在時變的系統頻率下仍然具有動態的激磁能
力，另一方面亦解決了頻率變動的問題。由實驗及模擬結
果發現，所提出的控制器確實可以有效改善獨立感應發電
機的輸出電壓及頻率。 
 
關鍵詞：頻率控制，自激式感應發電機，靜態同步補償器，
電壓控制，電壓源型變流器。 
 
Abstract-- Voltage and frequency fluctuations due to random 
load variation are the most important power quality problem in a 
self-excited induction generator (SEIG) system. Traditionally, 
instantaneous voltage regulation can be achieved by using static 
synchronous compensators (STATCOMs) to condition the 
reactive power flow in power distribution system, but their 
widespread might be limited by temporary loss of 
synchronization owing to system frequency fluctuation. In this 
work, an advanced, laboratory STATCOM was constructed 
based on relative rotating speed theory which is essential to 
estimate the frequency deviation and to assist the STATCOM in 
synchronism with system frequency. As a result, the stator 
voltage fluctuation due to random load variation can be 
eliminated and the generator speed as well as mechanical power 
can be more effectively controlled by the frequency controller. 
Both simulation and experimental results are in agreement with 
the proposed controller which leads to the conclusion that the 
simultaneous voltage and frequency control could be feasible for 
a self-excited induction generation system. 
 
Key words: Frequency control, self-excited induction generators 
(SEIG), static synchronous compensator (STATCOM), voltage 
control, voltage-sourced inverter (VSI). 
NOMENCLATURE 
A. General 
v ,V, V voltage in instantaneous, magnitude and vector 
notation 
e  inverter output voltage in instantaneous notation
i  current in instantaneous notation 
θ relative angular displacement for a specific 
vector, where −π < θ ≦ π 
Θ absolute angular displacement for a specific 
vector 
ω angular frequency (angular speed) 
φ flux linkage 
X, r reactance and resistance 
Pm, Pg input mechanical power and output active power 
for the IG 
Te , Tm electrical and mechanical torques 
x  state vector 
y output vector 
u input vector 
Ks, Ko state and output feedback gain matrices 
0 zero matrix 
I identity matrix 
B. Subscripts 
d, q quantities in d-axis and q-axis 
s, r stator and rotor 
dc DC link 
L load 
b base quantity 
FC fixed shunt capacitor 
f coupling transformer and filter for the 
STATCOM 
a vector or matrix for the augmented system 
0 initial operating point 
REF reference value 
C. Superscripts 
T matrix transpose operator 
行政院國家科學委員會 
九十五年度專題研究計畫成果報告 
 
用以改善獨立感應發電機系統動態激磁特性之新型靜態同步補償器設計 
Design of an advanced static synchronous compensator to improve dynamic 
excitation performance of an isolated induction generator system 
計畫編號： NSC 96－2218－E－182－001 
執行期間： 96 年 1 月 1 日  至  96 年 7 月 31 日 
計畫主持人： 陳偉倫 長庚大學電機工程學系(所) 
 許源浴 國立台灣大學電機工程研究所 
計畫參與人員： 林永祥  
 
  3
   e ds qs qs dsT i iφ φ= − .                                 (5) 
The corresponding torque balance equation is given by 
( )u ur m e T r
T
1 T T D
2H
ω ω
•
= − −                         (6) 
where Tm is the per unit mechanical torque, and HT and DT are 
the equivalent inertia constant and the equivalent damping 
constant of the isolated induction generator system, 
respectively. 
B. STATCOM Model 
For a balanced three-phase system, the STATCOM model 
can be described in per unit using the variables in d- and 
q-axes synchronous reference frame as [9],[10]: 
( )b f bde de REF qe dL d
f f
r
i i i v e
X X
ω ωω• = − + ⋅ + −             (7) 
( )b f bqe qe REF de qL q
f f
r
i i i v e
X X
ω ωω• = − − ⋅ + −  .          (8) 
 In Fig. 1, the instantaneous powers at the AC- and 
DC-sides of the voltage-sourced inverter are equal, giving the 
following power balance equation: 
dc dc d de q qev i e i e i= +  .                            (9) 
The per unit DC-side circuit equation is 
dc
dc dc
dc dc
v1v i
C r
• ⎛ ⎞= −⎜ ⎟⎝ ⎠
                            (10) 
where rdc is used to represent the inverter switching loss. 
The per unit equations of the fixed shunt capacitor and 
local load are given in the Appendix. 
III. STEADY STATE ANALYSIS OF AN SEIG WITH CONSTANT 
STATOR VOLTAGE 
For a rotating machine, in order that an electric current can 
be produced in stator conductors, an electric field must be built 
in it. The mechanical power can be therefore converted to 
electrical power while the electric field is elevated by way of 
machine excitation. The isolated IG differs greatly from the 
grid-connected IG in steady-state characteristic due to the 
diverse processes of the machine excitation. For a 
grid-connected IG, a synchronous rotating field will be 
produced by the stator winding excited from the grid utility, 
thus the rotor current is then induced at slip frequency by the 
relative motion of the stator flux and the rotor conductor. 
When the rotor is driven to a speed higher than that of the 
stator rotating field, the mechanical power can be transferred 
across the air gap to the stator in electrical form. In contrast to 
the grid-connected IG, the isolated IG excited from the 
residual magnetism of the iron core will induce a rotating field 
in the stator windings at the frequency which depends on the 
rotor speed and stator voltage. This has led to an interaction 
problem of great complexity between the active power and 
reactive power while studying the steady-state performance of 
the isolated IG. One effective and reasonable way to simplify 
the steady-state analysis is to decouple the active power and 
reactive power through the assumption of constant stator 
voltage since the STATCOM, employed in this system, is 
capable of dynamic voltage regulation. 
-1.5 -1 -0.5 0 0.5 1 1.5
800
1000
1200
1400
1600
1800
2000
2200
2400
ge
ne
ra
to
r s
pe
ed
 (r
pm
)
50Hz
active output power (pu)
motor region generator region
70Hz
65Hz
55Hz
60Hz
 
Fig. 2 Dependence of generator speed of an SEIG on active output power 
with stator frequency as a parameter. 
 
40 45 50 55 60 65 70 75 80
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
Stator frequency (Hz)
A
ct
iv
e 
po
w
er
 g
en
er
at
io
n 
(p
.u
.)
rL=0.8 p.u.
rL=1.2 p.u.
rL=1.0 p.u.
rL=1.8 p.u.
rL=1.6 p.u.
rL=1.4 p.u.
rL=2.0 p.u.
(a)  
40 45 50 55 60 65 70 75 80
0.4
0.5
0.6
0.7
0.8
0.9
1
Stator frequency (Hz)
R
ea
ct
iv
e 
po
w
er
 c
on
su
m
pt
io
n 
(p
.u
.)
rL=0.8 p.u.
rL=1.4 p.u.
rL=1.6 p.u.
rL=1.8 p.u.
rL=2.0 p.u.
rL=1.2 p.u.
rL=1.0 p.u.
(b)
 
Fig. 3 Dependence of (a) active power and (b) reactive power of an SEIG on 
stator frequency with terminal load, rL, as a parameter. 
Fig. 2 and Fig. 3 present the results of steady-state analysis 
of the constant-voltage IG. As shown in Fig. 2, the generator 
speed ωr is proportional to the stator frequency under a 
specific load. Thus, stator frequency can be regulated through 
IG speed control when the stator voltage is kept constant by 
  5
e qL de dL qeQ v i v i= − .                          (14b) 
To decouple the STATCOM active and reactive power 
control loops, a new reference frame which uses the vector for 
load bus voltage VL as the new d-axis (denoted as d'-axis) is 
defined in Fig. 4. Using the d-q quantities v'dL (which is equal 
to VL), i'de, and i'qe in the new reference frame, the active and 
reactive powers in (14) can be written as 
e dL deP v' i'=                                 (15a) 
e dL qeQ v' i'= −  .                            (15b) 
As (15) shows, the d'-axis current component, i'de, 
accounts for the instantaneous active power and the q'-axis 
current component, i'qe, is the instantaneous reactive current. 
Thus, STATCOM control design is simplified to a great extent 
with this new reference frame since the load bus voltage 
regulation is achievable through the control of the reactive 
power Qe which only related to the q'-axis current i'qe.  
To ensure zero steady-state errors for load bus voltage VL 
and DC capacitor voltage vdc, two integral terms∫ΔVLdt and
∫Δvdcdt are required in addition to the system state variables. 
Furthermore, the operating point of the IG changes with wind 
speed and load and various reference values for Δi'qe and Δi'de 
may be required by the STATCOM to achieve good regulation 
of load bus voltage VL and DC capacitor voltage vdc. With the 
collection of the four integral terms∫ΔVLdt,∫Δvdcdt, ∬
ΔVLdt, and ∬Δvdcdt as the additional state vector (Δz), the 
augmented state equations can be represented as follows: 
a a a a
a a a
Δ Δ Δ
Δ Δ
• = ⋅ + ⋅
= ⋅
x A x B u
y C x
                      (16) 
, where 
u
a dL qL dL qL r dc qr dr
TT
ds qs dTL qTL de qe
TTu
a L dc r de qe
v v i i v
i i i i
V v i' i'
Δ Δ Δ Δ Δ Δω Δ Δφ Δφ
Δφ Δφ Δ Δ Δ Δ Δ
Δ Δ Δ Δω Δ Δ Δ
⎡= ⎣
⎤⎦
⎡ ⎤= ⎣ ⎦
x
z
y z
.                    
Thus, the control inputs for the state equations in (16) are 
T
d q CVe' e' TΔ Δ Δ Δ⎡ ⎤= ⎣ ⎦u                           (17) 
Note that the mechanical power can be conditioned by a 
small signal torque command ΔTCV in (17) through a controller 
with IG speed error Δωru as the primary stabilizing signal in 
the output vector in (16).  
For the linear system described in (16), the linear quadratic 
state feedback control Δu which minimizes the performance 
index 
( )T Ta a
0
1J dt
2
Δ Δ Δ Δ
∞
= +∫ x Q x u R u                 (18) 
where Q is the weighting matrix of the state variable variations 
and R that of the control effort, is given by [15] 
 s aΔ Δ= − ⋅u K x .                            (19) 
To determine the state feedback gain matrix Ks for the 
linear quadratic control in (19), a set of weights qij(0) were 
chosen for the weighting matrix Q in (18) based on physical 
reasoning and past experience. In the present work, a diagonal 
weighting matrix with the diagonal elements 10, 0, 0, 1, 100, 
100, 1 and 1 corresponding to the state variables Δvdc, Δide, Δiqe, 
Δωru,∫ΔVLdt,∫Δvdcdt,∬ΔVLdt, and ∬Δvdcdt, respectively, is 
selected as the initial weighting matrix.  
Then the output feedback control Δu is given by  
 o aΔ Δ= − ⋅u K y                             (20) 
where the output feedback gain matrix Ko can be derived using 
Ks and Ca through the pseudo-inverse [13], [16] technique as 
follows: 
          ( ) 1T To s a a a −= ⋅K K C C C .                   (21) 
After the control design, the open-loop and the closed-loop 
eigenvalues for the isolated IG system are given in Table I. It is 
clear that a poorly damped STATCOM mode –61.74±j372.27 
presented in the open-loop response can be shifted by the 
output feedback controller to the new 
locations –199.17±j357.85. Moreover, a moderately damped 
eigenvalue pair –10.51±j10.14 corresponding to the 
closed-loop electromechanical dynamics can be also reached 
by means of the proposed controller. Fig. 6 gives the root loci 
for the electromechanical mode and STATCOM current mode 
as the load power factor is varied from 0.1 lagging to 0.98 
lagging. As the illustrations shows, all eigenvalues are moving 
to left with the increase of power factor. In addition, to ensure 
that load power variations would not adversely affect the 
closed-loop system dynamics, additional root loci over the load 
power range of PL=0.1 to 1.0 p.u. are performed in Fig. 6. 
 
TABLE I 
SUMMARY OF SYSTEM EIGENVALUES 
Open-loop eigenvalues Closed-loop eigenvalues State feedback              Output feedback 
Generator Dynamics 
–90.95± j830.23 
–15.69± j4.43* 
–34.016 
STATCOM Dynamics 
–61.74± j372.27@ 
–0.455 
Controller Dynamics 
0 
0 
0 
0 
Generator Dynamics                  
–183.69± j842.5 –130.57± j841.32 
–11.83± j12.41* –10.51± j10.14* 
–41.05+ j2.23 –42.27 
STATCOM Dynamics 
–79.89± j374.21@ –199.17± j357.85@ 
–3.18 –2.96 
Controller Dynamics 
–0.10005 -0.10003 
-0.1 -0.099 
–41.05-j2.23 
–18.60 –20.36± j19.84  
*electromechanical mode;  
@ AC current mode of STATCOM 
 
  7
ωr
idc 
+
vdc
CdcServo-Motor
Load
Xf
SEIG
i e
STATCOM
Coupling 
transformer and 
filter
V∞ rTL    XTL
rL , XL
Xc
Mechanical power command
 vabcL
HCPL4503
(Photocoupler)
CPLD 
chip
Switching pattern 
command
iabce 
iabce  vabcL
-
vdc
saup, 
sadn
sbup, 
sbdn
scup, 
scdn
digital signals converted from analog 
signals
DSP chip 
& multi-channel
data acquisition system 
digital signals
external
digital commands
digital I/O
Industrial
Computer
Ko Δyau
u0
Σ
Frequency 
Controller 
ΘREF
vdL
vqL
e'd
e'q
TCFΔ
Tm
T
(ed ,eq)rf
(a) 
(b) 
 
Fig. 7 Scheme of the experimental bench. 
 
B. Performance test for the isolated IG operated at different 
stator frequency setting 
Employing the proposed simultaneous voltage and 
frequency controller, the isolated IG can be controlled to 
operate at arbitrary stator frequency setting under constant 
stator voltage. To evaluate this, additional experiment was 
conducted through a 10-Hz step change in stator frequency 
setting (fREF is reduced from 60Hz to 50Hz).  
It is observed in Fig. 11 that, immediately following the 
step change, the frequency controller detected the sudden 
change in the relative angular displacement θ and generated a 
torque command to reduce the mechanical power input to the 
IG. As a result, causing a decrease in the kinetic energy and 
rotating speed of the IG. In addition, the frequency-depended 
constant load impedance would consume more power from the 
isolated IG while the system frequency was reduced. The 
increased load power and the decreased mechanical power 
during the transient period would deteriorate the stator voltage 
response, as illustrated in Fig. 11(a). Meanwhile, starting with 
the reactive current control, tight stator voltage regulation 
under the synchronous frequency of 50 Hz was achieved (Fig. 
11(c)).  
Fig. 12(a) and Fig. 12(b) depict the steady-state stator 
voltage and current waveforms recorded from the oscilloscope 
before and after the step change in the reference frequency 
setting fREF, respectively. It is observed from Figs. 12 that the 
stator frequency f follows the reference frequency setting fREF 
very closely in both cases. This experiment validated that both 
constant voltage and constant frequency control can be 
reached for the isolated IG under different reference frequency 
setting. 
VII. CONCLUSION 
A method that enables the operation of the STATCOM in 
variable-frequency system is presented. Constant voltage and 
frequency for an SEIG system is thus promised under various 
load conditions. Major features of the proposed controller are 
summarized as follows: 
1) An important conclusion obtained from steady-state 
analysis results for an SEIG is that the stator frequency 
is proportional to the rotating speed at constant stator 
voltage. The advantage is that, through the action of the 
speed governor, the stator frequency can be regulated 
precisely. 
2) The relative rotating speed theory leads directly to a rule 
that will provide effective frequency control. 
3) The measurement of the relative angular displacement 
θL(t) is effective for the advanced STATCOM in 
capturing synchronism at various load conditions. As a 
result, constant voltage can be attained by the advanced 
STATCOM when system frequency is apt to change. 
4) In order to make the controller more robust, the root 
locus technique is employed to investigate closed-loop 
performances of the IG system under various load 
conditions. 
5) Experimental results on a laboratory machine agree 
quite well with the proposed theory and indicate that an 
SEIG is a viable option for interfacing the diesel engine 
system to standby generation applications. 
  9
0.5 1 1.5 2 2.5 3
0.4
0.6
0.8
1
0.5 1 1.5 2 2.5 3
-1
0
1
0.5 1 1.5 2 2.5 3
-1
0
1
(c)
(b)
(a)
i'
de
(pu)
i'
qe
(pu)
V
L
(pu)
Time (sec)
Time (sec)
Time (sec)
0.5 1 1.5 2 2.5 3
0.4
0.6
0.8
1
0.5 1 1.5 2 2.5 3
-1
0
1
0.5 1 1.5 2 2.5 3
-1
0
1
(c)
(b)
(a)
i'
de
(pu)
i'
qe
(pu)
V
L
(pu)
Time (sec)
Time (sec)
Time (sec)  
0.5 1 1.5 2 2.5 3
40
60
80
0.5 1 1.5 2 2.5 3
-4
-2
0
2
0.5 1 1.5 2 2.5 3
1750
1800
1850
1900
ω
r
(rpm)
(f)
(e)
(Hz)
f
o
θ
L
(rad)
(d)
t1
Time (sec)
Time (sec)
Time (sec)
0.5 1 1.5 2 2.5 3
40
60
80
0.5 1 1.5 2 2.5 3
-2
0
2
4
0.5 1 1.5 2 2.5 3
1750
1800
1850
1900
ω
r
(rpm)
(f)
(e)
(Hz)
f
o
θ
L
(rad)
(d)
t1
Time (sec)
Time (sec)
Time (sec)  
Measured Simulated 
Fig. 8 Dynamic responses of the isolated IG system following a sudden removal of load (from 0.386pu, pf=0.798 lagging to 0.0pu). 
 
0.5 1 1.5 2 2.5 3
0.6
0.8
1
0.5 1 1.5 2 2.5 3
-1
0
1
0.5 1 1.5 2 2.5 3
-1
0
1
(c)
(b)
(a)
i'
de
(pu)
i'
qe
(pu)
V
L
(pu)
Time (sec)
Time (sec)
Time (sec)  
0.5 1 1.5 2 2.5 3
0.4
0.6
0.8
1
0.5 1 1.5 2 2.5 3
-1
0
1
0.5 1 1.5 2 2.5 3
-1
0
1
(c)
(b)
(a)
i'
de
(pu)
i'
qe
(pu)
V
L
(pu)
Time (sec)
Time (sec)
Time (sec)  
0.5 1 1.5 2 2.5 3
40
60
80
0.5 1 1.5 2 2.5 3
-3
-2
-1
0
0.5 1 1.5 2 2.5 3
1800
1850
1900
ω
r
(rpm)
(f)
(e)
(Hz)
f
o
θL
(rad)
(d)
t1
Time (sec)
Time (sec)
Time (sec)  
0.5 1 1.5 2 2.5 3
40
60
80
0.5 1 1.5 2 2.5 3
-2
-1
0
1
0.5 1 1.5 2 2.5 3
1800
1850
1900
ωr
(rpm)
(f)
(e)
(Hz)
f
o
θL
(rad)
(d)
t
1
Time (sec)
Time (sec)
Time (sec)  
Measured Simulated 
Fig. 9 Dynamic responses of the isolated IG system following a step increase in load demand (from 0.386pu, pf=0.798 lagging to 0.535pu, pf=0.807 lagging). 
TAES-200501747 1
  
Abstract—A unified voltage and pitch angle controller (UVPC) 
for a wind-driven induction generator system is presented to 
reach effective voltage control and to stabilize generator speed 
and system frequency. The proposed UVPC comprises a linear 
optimal controller, a supplementary voltage regulator (SVR), and 
a supplementary pitch angle controller (SPC). An AC voltage 
regulator and a DC voltage regulator are designed in the SVR to 
generate the desired voltage magnitude and phase angle for the 
voltage-sourced inverter. On the other hand, the SPC is designed 
based on fuzzy logic inference rules in order to generate the 
desired pitch angle command for the variable blade pitch such 
that the mechanical power can be controlled in a very efficient 
manner. When the system is operated in the islanding condition, 
an approach based on the concept of relative rotating speed has 
been developed for the measurement of system frequency 
deviation. Simulation and experimental results reveal that both 
bus voltage and mechanical power can be effectively controlled by 
the proposed UVPC for the WECS either connected with or 
disconnected from the power grid when there is sufficient wind 
energy. 
 
Index Terms—Induction generator (IG), voltage regulation, 
voltage-sourced inverter (VSI), wind energy conversion system 
(WECS), wind turbine. 
NOMENCLATURE 
A. General 
v , V voltage in instantaneous and vector notation 
e , E inverter output voltage in instantaneous and vector 
notation 
i , I current in instantaneous and vector notation 
|‧| magnitude of a vector 
Θ absolute angular displacement for a specific vector, 
where 0 ≦Θ≦ ∞ 
θ relative angular displacement for a specific vector, 
where −π < θ ≦ π 
ω angular frequency (angular speed) 
β pitch angle of the wind turbine 
 
Manuscript received December 3, 2005; revised July 31, 2006. Financial 
support given to this work by the National Science Council of the Republic of 
China under contract number NSC-94-2213-E-002-118 is appreciated. 
W.L. Chen is with the Department of Electrical Engineering, Chang Gung 
University, Tao-Yuan, Taiwan, R.O.C. (e-mail: wlchen@mail.cgu.edu.tw). 
Y.Y. Hsu is with the Department of Electrical Engineering, National Taiwan 
University, Taipei, Taiwan, R.O.C. (e-mail: yyhsu@cc.ee.ntu.edu.tw). 
 
B. Subscripts 
d, q quantities in d-axis and q-axis 
s, r stator and rotor 
0 initial operating point 
C. Superscripts 
a, b, c quantities in phases a, b, and c 
SPC control command generated by the supplementary 
pitch angle controller 
LOC control command using linear optimal control 
technique 
* reference value 
I. INTRODUCTION 
HE objective of the wind energy conversion system 
(WECS) is to supply consumers with a carbon-free electric 
energy. In the operation of a WECS, the unbalance in active 
power and reactive power among the wind turbine, the 
generator, and the load due to the wind gust and load 
fluctuation may have adverse impacts on system frequency and 
voltage [1-3].  
Traditionally, voltage regulation can be achieved by 
regulating the field voltage, and frequency regulation can be 
reached by the speed governor for a synchronous generator 
[3-5]. However, for the WECS, induction generator is 
preferable due to its intrinsically rigid and simpler structure. 
The voltage regulation for a squirrel-rotor induction generator 
(IG) is usually achieved by external shunt capacitors since the 
rotor is short of field coils. In addition, for a WECS connected 
with a power grid, the output frequency of the IG is always 
determined by grid frequency, but once the IG is disconnected 
from the power grid, causing islanding operation, the output 
frequency of the IG depends on generator parameters and 
loading conditions [6].  
To reach constant system frequency independent of the 
generator speed, the three-phase generator output can be 
rectified into DC and then interfaced with the three-phase load 
by means of a switch-mode converter [7]. In addition, an 
electric load governor (ELG) was proposed in [1,8-10], using 
the impedance controller at generator terminals to consume the 
surplus power in the generating system, so that the load 
impedance seen by the induction generator at its terminals is 
always the same. Although both the double stage power 
conversion and the ELG can provide good regulation in load 
voltage and frequency, it is not preferable in the high power 
level conversion since their installed capacities are comparable 
to that of the induction generator and consequently confining 
A Unified Voltage and Pitch Angle Controller for 
a Wind-Driven Induction Generator System 
W. L. Chen, Member, IEEE and Y.Y. Hsu, Senior Member, IEEE 
T
TAES-200501747 3
( )ds b dL s ds s qsv r iφ ω ω φ= + + ⋅i                           (1) 
   ( )qs b qL s qs s dsv r iφ ω ω φ= + − ⋅i                           (2) 
   ( ) ( )dr b dr r dr s r qrv r iφ ω ω ω φ= − + −i                       (3) 
  ( ) ( )qr b qr r qr s r drv r iφ ω ω ω φ= − − −i                       (4) 
,where a synchronous reference frame rotating at the electrical 
angular speed corresponding to the fundamental frequency of 
the grid voltage, herein denoted as ωs, is adopted. 
The electromechanical torque in per unit can be written in 
terms of stator flux linkages and currents as 
   e ds qs qs dsT i iφ φ= −                              (5) 
The rotor acceleration is given by 
( )br m e T r
T
T T D
2H
ωω ω= − −i                         (6) 
where Tm is the per unit mechanical torque of the wind turbine, 
and HT and DT are the equivalent inertia constant and the 
equivalent damping constant of the wind turbine-induction 
generator system, respectively. 
B. Wind turbine model 
The mechanical power output of a wind turbine can be 
written as [14] 
3
m p w
1P A C V
2
ρ= ⋅ ⋅ ⋅                             (7) 
where ρ is the air mass density, Vw is the wind speed, A is the 
rotor swept area, and Cp is a power coefficient representing the 
fraction of power extracted from the aerodynamic power in the 
wind by a practical wind turbine. 
The power coefficient, Cp, varies with the wind speed, the 
rotational speed of the turbine, and the turbine blade parameters. 
The MOD-2 wind turbine model [12,13] with the following 
closed-form approximate relationship for Cp is used: 
0.17 R
2
p
1 RC 0.022 5.6 e
2
γβγ
−⎛ ⎞= − − ⋅⎜ ⎟⎝ ⎠
            (8) 
The tip speed ratio γ is defined as 
T
w
R
V
ωγ ⋅=                                    (9) 
where ωT is the rotating speed of the wind turbine as shown in 
Fig. 1. 
vdL ,vqL ,vdc
ωr
Δβ LOC
|ELOC|
θL
Fast 
Subplant
(VSI)
Slow
Subplant
(WECS)
Linear Optimal
Controller
Supplementary
Voltage
Regulator
(SVR)
θL
(ed*,eq*)
Augmented system
Voltage 
control loop
Pitch angle 
control loop
dt
d
dt
d
βMAX
βMIN
Supplementary
Pitch Angle 
Controller
(SPC) β
Δβ SPC
ωr
*
β0
Σ
ΣΔ|E
LOC|
|E0LOC|
E*
+
+ +
+
+
Fig. 2 Block diagram of the proposed unified voltage and pitch angle controller 
It is observed from (7), (8), and (9) that the mechanical 
power output of a wind turbine is related to the turbine speed ωT, 
wind speed Vw , and the pitch angle β. An increase in pitch 
angle β, which results in a decrease in the power coefficient Cp, 
is efficient to control the mechanical power of the wind turbine 
when Pm continues to increase with increasing wind speed.  
In this work, the initial pitch angle (β0) is chosen to be 13.29 
degrees such that the wind turbine delivers a mechanical power 
of 0.81 pu for a 30 miles/hr (mph) wind at hub height. 
C. VSI model 
For a balanced three-phase system, the inverter model can be 
described in per unit d- and q-axes synchronous reference 
frame as: 
( )b f bde de s qe dL d
f f
r
i i i v e
X X
ω ωω= − + ⋅ + −i                   (10) 
( )b f bqe qe s de qL q
f f
r
i i i v e
X X
ω ωω= − − ⋅ + −i                   (11) 
The instantaneous powers at the AC- and DC-sides of the 
inverter are equal, giving the following power balance 
equation: 
dc dc d de q qev i e i e i= +                                   (12) 
The per unit DC-side circuit equation is 
dc
dc dc
dc dc
v1v i
C r
⎛ ⎞= −⎜ ⎟⎝ ⎠
i
                              (13) 
where the DC resistor with resistance rdc, in parallel with the 
DC capacitor, is used to represent the inverter switching loss.  
The per unit equations of the fixed shunt capacitor, 
transmission line and local load models are shown in the 
Appendix. 
III. CONTROL DESIGN 
As shown in Fig. 2, a unified control scheme comprising a 
linear optimal controller (LOC), a supplementary voltage 
regulator (SVR), and a supplementary pitch angle controller 
(SPC) is proposed for the unified voltage and pitch angle 
controller. In this work, the feedback gain matrix from the 
linear optimal controller is designed based on an augmented 
system including the plant model and the SVR. The main 
objective of the linear optimal controller is to provide the 
desired VSI output voltage magnitude |ELOC| and an 
incremental change in pitch angle, ΔβLOC, around a specific 
operating point under small disturbance conditions. The 
supplementary pitch angle controller is required when the 
WECS is subjected to a major disturbance, causing severe 
fluctuations in generator speed and active power output. A 
hydraulic pitch angle actuator with a rate limit of ±10o/s and a 
transport delay of 50ms [12,13] is used in this paper. In addition, 
a supplementary voltage regulator is needed to determine 
proper magnitude |E*| and relative angular displacement θe* for 
inverter output voltage when there is a change in load bus 
voltage or system frequency caused by islanding operation. 
A. Relative rotating speed theory 
For a balanced three-phase system, the three-phase load bus 
TAES-200501747 5
C. Linear optimal controller (LOC)  
As mentioned earlier, the main function of the linear 
optimal controller [22] is to achieve fast regulation of 
mechanical power and voltage in case of small disturbances. 
The nonlinear dynamic system equations are linearized around 
a nominal operating point as 
a a a a a d w
a a a
VΔ Δ Δ Δ
Δ Δ
= ⋅ + ⋅ + ⋅
= ⋅
i
x A x B u B
y C x
                     (23) 
, where 
a dL qL dL qL r dc qr drv v i i vΔ Δ Δ Δ Δ Δω Δ Δφ Δφ⎡= ⎣x
T
ds qs dTL qTL qe de L dci i i i dt v dtφ φ ⎤Δ Δ Δ Δ Δ Δ ∫ Δ ∫ Δ ⎦V  
is the augmented state vector, 
TLOC
a | |Δ Δβ Δ⎡ ⎤= ⎣ ⎦u E  
is the augmented control vector, and 
T
a L dL qL r dc L dcv v v dt v dtΔ Δ Δ Δ Δω Δ Δ Δ⎡ ⎤= ∫ ∫⎣ ⎦y V V  
is the augmented output vector. 
In (23), ΔVw is the wind speed variation, and the states of the 
supplementary voltage regulator are also included in the state 
vector and output vector. Therefore, not only zero steady-state 
errors in |VL| and vdc can be attained, but the PI gains in SVR 
can be refined by the LOC. In addition, since it is difficult to 
measure all state variables, the state observer using a Kalman 
filter [22], as shown in Fig. 5, is employed to observe the state 
variables from output variables. Note that the Kalman gain Ko is 
derived by using the MATLAB® software. 
The objective of linear optimal controller is to determine the 
control input Δua(t) in order to minimize a quadratic 
performance index of the form 
( )T Ta a a a
0
1min J dt
2
Δ Δ Δ Δ
∞
= +∫ x Q x u R u                   (24) 
where Q is the weighting matrix of the state variable variations 
and R that of the control effort. The elements in the weighting 
matrix corresponding to Δωr, Δvdc,∫Δ|VL| dt and∫Δvdc dt are 
chosen as 500, 20000, 10 and 10, respectively. Note that a 
higher weight is placed on Δvdc in order to achieve constant DC 
capacitor voltage. It is well known that the optimal control is 
given by 
 a s aΔ Δ= − ⋅u K x                                  (25) 
where                       1 Ts a
−=K R B M                                    (26) 
and M is the solution of the Riccati equation 
T 1 T
a a a a
−+ + − =A M MA Q MB R B M 0                    (27) 
Table I summarizes the open-loop and closed-loop 
eigenvalues for the system operated under grid-connection and 
islanding conditions. These eigenvalues are computed using 
(23) and (25). Note that the load, the wind speed, and the 
frequency for the two cases are the same. In grid-connection 
operation, a poorly damped VSI mode characterized by the pair 
of eigenvalues -47.209±j376.8 are observed for the open-loop 
system. This mode can be effectively shifted by the LOC to 
new locations -228.1±j442.1. Moreover, the LOC will also give 
satisfactory damping effect for the electromechanical mode by  
SVR f (x, u, t, Vw)ua
ua0
ya0
Δya-Δua
Vw
ΔVw
Kalman observer 
(Ko)
Ks
yaed
*,eq*
Δxa
fa(xa, ua, t, Vw)
 
Fig. 5 Block diagram of linear optimal controller. 
 
TABLE I 
SUMMARY OF SYSTEM EIGENVALUES 
Case Open-loop eigenvalues Closed-loop eigenvalues 
Grid- 
connection 
Generator Dynamics 
–84.8 + j 2998.3 
–74.0 + j 3936.9 
– 4.3 ± j    7.1* 
– 8.9 
VSI 
–47.209 ± j 376.8@ 
– 0.02 
Network 
–1404.4 ± j 376.8 
–  74.1 – j 3273.2 
–  73.1 – j 4027.1 
–  33.1 ± j 376.4#   
Supplementary VR 
0 
0 
Generator Dynamics 
–  201.3 + j 2049.9 
–  387.2 + j 3142.7 
–    8.1 ± j   9.7* 
–   54.1 
VSI 
–  228.1 ± j 442.1@ 
–    2.1 + j  3.1 
Network 
– 1443.0 ± j  384.5 
–  201.3 – j 2049.9 
–  387.2 – j 3142.7 
–   33.7 ± j 376.5# 
Supplementary VR 
–6.6 
–2.1 – j 3.1  
Islanding Generator Dynamics 
–87.2 + j 2855.7 
–85.8 + j 3609.5 
– 2.9 ± j   6.3* 
– 6.1 
VSI 
–43.7 ± j 376.4@ 
– 0.02 
Network 
–1380.4 ± j 376.8 
–  87.2 – j 2855.7 
–  85.8 – j 3609.5 
Supplementary VR 
0 
0 
Generator Dynamics 
– 201.3 + j 2046.4 
– 393.1 + j 2640.8 
–  11.6 ± j  11.5* 
–   47.4 
VSI 
–172.0 ± j 414.4@ 
–  1.9 + j  4.3 
Network 
– 1421.3 ± j  389.4  
–  201.3 – j 2046.4 
–  393.1 – j 2640.8 
Supplementary VR 
 –5.9  
 –1.9 – j 4.3  
@ AC current mode of VSI 
* electromechanical mode  
# AC transmission line mode 
 
shifting the associated eigenvalues from -4.3±j7.1 to -8.1±j9.7. 
As far as islanding operation is concerned, the damping for the 
VSI mode is also improved to a great extent by the LOC.  In 
addition, for the induction generator operated under islanding 
condition, the damping for the electromechanical mode is also 
improved by the LOC. 
D. Supplementary pitch angle controller (SPC) 
When the WECS is disconnected from the grid, system 
frequency may deviate from synchronous frequency (ωs) and 
generator rotor accelerates or decelerates due to the unbalance 
between the mechanical power and electrical power. In this 
case, a supplementary pitch angle controller is needed to 
regulate system frequency and achieve active power balance. 
As shown in Fig. 2, the supplementary pitch angle 
controller employs the rate of change in relative angular 
displacement (dθL/dt) and rotor acceleration (dωr/dt) as its 
TAES-200501747 7
0 1 2 3 4 5 6 7 8 9 10
0.997
0.998
0.999
1
1.001
0 1 2 3 4 5 6 7 8 9 10
0.8
1
1.2
1.4
1.6
(a)
(b)
time,s
vdc
t
1
t
3
t
2
t
3
t
2
t
1
Pg
time,s
(pu)
(pu)
0 1 2 3 4 5 6 7 8 9 10
377.9
378
378.1
378.2
378.3
0 1 2 3 4 5 6 7 8 9 10
30
35
40
45
50
0 1 2 3 4 5 6 7 8 9 10
-10
0
10
20
30 β*
ΔβSPC
ΔβLOC
(c)
time,s
ωr
β
Vw
(e)
(d)
t
3
t
3
t
1
t
1
t
2
t
2
t
1
time,s
time,s
(rad/s)
(degree)
(mph)
 
Fig. 7 Dynamic responses for the WECS operated in grid-connection condition. 
(Wind gust began at t1=0.188s.) 
(Wind gust ended at t2=3.0s.) 
(A step load change of 83% (0.5 pu) began at t3=5.0s.) 
0 0.5 1 1.5 2 2.5 3 3.5 4
0.995
1
1.005
time,s
t
2
t
1
|V  |L
(pu)
 
Fig. 8 Voltage response for the WECS operated in grid-connection condition 
(wind gust situation). 
(Wind gust began at t1=0.188s.) 
(Wind gust ended at t2=3.0s.) 
4.99 4.995 5 5.005 5.01 5.015 5.02
0.9
1
1.1
time,s
t
3
|V  |L
(pu)
 
Fig. 9 Voltage response for the WECS operated in grid-connection condition 
(step load change situation).  
(A step load change of 83% (0.5 pu) began at t3=5.0s.) 
 
B. Dynamic performance for the WECS operated under 
islanding condition 
Successive disturbances (a grid-disconnection event, a step 
change in load power and a gust change in wind speed) 
Self-excitation can occur if the WECS loses its connection 
to the grid. Unstable voltage and frequency may be observed 
during self-excitation [18,19]. In the first simulated event, the 
WECS lost its connection to the grid at t1=0.188s and remained 
islanding thereafter. The WECS delivered 0.21pu of electrical 
power to the grid through the transmission line before the 
grid-disconnection event. It is observed from Figs. 10(c) and 
10(d) that the relative angular displacement (θL) and generator  
0 1 2 3 4 5 6 7 8 9 10
0.4
0.6
0.8
1
0 1 2 3 4 5 6 7 8 9 10
0.996
0.998
1
1.002
UVPC
UVPC w/o SVR
(b)
vdc
time,s
t
1
t
3t2
t
1
t
3t2
Pg
(a)
time,s
(pu)
(pu)
overcharged for case without SVR
0 1 2 3 4 5 6 7 8 9 10
-0.5
0
0.5
1
0 1 2 3 4 5 6 7 8 9 10
377
378
379
380
0 1 2 3 4 5 6 7 8 9 10
0
10
20
30
40
UVPC
UVPC w/o SPC
β*
ΔβSPC
ΔβLOC
(c)
(d)
time,s
ωr
β
t
1 t3
t
2
t
1 t3
t
2
θL
(e)
t
3
t
2t1
time,s
time,s
(rad)
(rad/s)
(degree)
 
0 1 2 3 4 5 6 7 8 9 10
30
35
40
45
50
time,s
t3
(f)
(mph)
Vw
 
Fig. 10 Dynamic responses for the WECS operated in islanding condition. 
(Grid-disconnection began at t1=0.188s.) 
(A step load change of 83% (0.5 pu) began at t2=2.5s.) 
(Wind gust began at t3=6.0s.) 
0.16 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32
0.9
0.95
1
1.05
1.1
time,s
|V  |
t
1
L
(pu)
 
Fig. 11 Voltage response for the WECS operated in islanding condition. 
(Grid-disconnection began at t1=0.188s.) 
 
2.45 2.46 2.47 2.48 2.49 2.5 2.51 2.52 2.53 2.54 2.55
0.9
0.95
1
1.05
1.1
time,s
|V  |
t
2
L
(pu)
 
Fig. 12 Voltage response for the WECS operated in islanding condition. 
(A step load change of 83% (0.5 pu) began at t2=2.5s.) 
 
speed (ωr) remained steady before the grid-disconnection event. 
When the WECS was disconnected from the grid, generator 
speed accelerated indefinitely and failed to settle down to a 
steady value if the SPC was not used. However, both θL and ωr 
settled down to steady values when the SPC was added. Note 
that the steady angular displacement θL in this case indicates 
that the WECS is operated under synchronous frequency ωs, as 
described in (19). The stabilizing function of the SPC can be 
explained by the pitch angle command β* in Fig. 10(e). When 
TAES-200501747 9
capable of stabilizing generator speed under step load 
change disturbance for the WECS operated under both 
grid-connection and islanding conditions. 
4) The SPC designed based on the concept of relative rotating 
speed can be applied not only to make the induction 
generator operated at a specific frequency under islanding 
condition but also to reach in-phase control between the 
generator output voltage and the grid voltage which is 
necessary for successful reclosing. 
5) As shown in Fig. 5, the SVR has been merged to the 
system model in the design of the feedback gain matrix of 
the linear optimal controller in order to reach a controller 
which could give satisfactory performance under 
disturbance conditions. 
 
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
0.5
1
1.5
2
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
0.9
0.95
1
1.05
1.1
(b)
(a)
vdc
(pu)
(pu)
time ,s
time ,s
L|V  |
UVPC w/o SPC UVPC with SPC
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
40
50
60
70
80
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
-10
-5
0
5
10
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
1500
1600
1700
1800
1900
ωr
(rpm)
(e)
(d)
(Hz)
fo
θL
(rad)
(c)
t1 t2
time ,s
time ,s
time ,s  
 
Fig. 14 Experimental results. 
(Grid-disconnection began at t1=1.2s.) 
(The action of SPC began at t2=4.02s.) 
APPENDIX [20] 
A. Fixed Shunt Capacitor Model 
dL s qL b c dFCv v X iω ω= ⋅ +
i
 
qL s dL b c qFCv v X iω ω= − ⋅ +
i
 
B. Transmission Line Model 
( )b TL bdTL dTL s qTL dL d
TL TL
r
i i i v v
X X
ω ωω ∞= − + ⋅ + −
i
 
( )b TL bqTL qTL s dTL qL q
TL TL
r
i i i v v
X X
ω ωω ∞= − − ⋅ + −
i
 
C. Load Model 
b L b
dL dL s qL dL
L L
r
i i i v
X X
ω ωω= − + ⋅ +i  
b L b
qL qL s dL qL
L L
r
i i i v
X X
ω ωω= − − ⋅ +i  
D. Simulation Parameters 
Induction Generator  (2.5MW, 4 poles, 4.16kV, 60Hz ) 
Stator resistance rs 0.0042 pu 
Rotor resistance rr 0.0032 pu 
Stator leakage reactance Xs 0.0326 pu 
Rotor leakage reactance Xr 0.0326 pu 
Mutual reactance Xm 1.8838 pu 
Fixed shunt capacitor reactance Xc 3.0 pu 
Voltage-Sourced Inverter (1.125MVA) 
Series line resistance rf 0.02 pu 
Series line reactance Xf 0.14 pu 
DC-link capacitance Cdc 6800 μF 
Switching loss resistance rdc 500 pu 
Transmission Line 
Line resistance rTL 0.015 pu 
Line reactance XTL 0.15 pu 
Infinite-bus voltage V∞ 1∠0° pu 
Load Model 
Nominal power at nominal voltage PL / QL 0.6 pu / 0.15 pu 
Wind Turbine  [12,13] 
Equivalent inertia constant HT 18.711 s 
Equivalent damping constant DT 0.010125 pu 
Rotor radius (A=π R2) R 150 ft 
Gear ratio GR 102.56 
System Base Setting 
Base MVA Sb 2.5MVA 
Induction generator voltage base VACb √(2/3)×4.16kV 
Inverter DC-link voltage base VDCb 2×VACb 
E. Experimental Parameters 
Induction Generator  (3kW, 4 poles, 220V, 60Hz ) 
Stator resistance rs 0.0551 pu 
Rotor resistance rr 0.0349 pu 
Stator leakage reactance Xs 0.0788 pu 
Rotor leakage reactance Xr 0.0788 pu 
Mutual reactance Xm 2.5712 pu 
System Base Setting 
Base MVA Sb 500VA 
Induction generator voltage base VACb √(2/3)×55.0V 
Inverter DC-link voltage base VDCb 250V 
REFERENCES 
[1] E.G. Marra, and J.A. Pomilio, “Induction-generator-based system 
providing regulated voltage with constant frequency,” IEEE Trans. on 
Industrial Electronics, , vol. 47, no. 4, pp. 908-914, 2000. 
[2] E. Suarez, and G. Bortolotto, “Voltage-frequency control of a self-excited 
induction generator,” IEEE Trans. on Energy Conversion, vol. 14, no.3, 
pp. 394-400, 1999. 
[3] Y.Y. Hsu and W.C. Chan, “Coordinated frequency and voltage control of 
synchronous generators, “ IEEE Trans. on Aerospace and electronic 
systems, vol. 23, no. 1, pp. 2-10, 1987. 
[4] C.H. Cheng and Y.Y. Hsu, “Excitation control of a synchronous machine 
using look-up table,”  IEEE Trans. on Aerospace and electronic systems, 
vol. 27, no. 2, pp. 247-254, 1991. 
[5] Y.Y. Hsu and C.L. Chen, “Design of SIMO excitation controllers for 
synchronous generators,” IEEE Trans. on Aerospace and Electronic 
Systems, vol. 23, no. 4, pp. 465-472, 1987. 
[6] S.S. Murthy, O.P. Malik and A.K. Tandon, “Analysis of self-excited 
induction generators,” IEE Proceedings-C, vol.129, no. 6, pp. 260-265, 
1982. 
中華民國第二十七屆電力工程研討會 
台灣  新竹  2006 年 12 月 22-23 日 
獨立感應發電機之電壓及頻率控制 
Voltage and Frequency Control of an Isolated Induction Generator 
 
陳偉倫 許源浴 林永祥 
Woei-Luen Chen Yuan-Yih Hsu Yung-Hsiang Lin 
長庚大學 電機工程學系 國立台灣大學 電機工程學系 長庚大學 電機工程學系 
台灣   桃園縣 台灣   台北市 台灣   桃園縣 
Department of Electrical Engineering Department of Electrical Engineering Department of Electrical Engineering
Chang Gung University National Taiwan University Chang Gung University 
Tao-Yuan, TAIWAN. Taipei, TAIWAN. Tao-Yuan, TAIWAN. 
wlchen@mail.cgu.edu.tw yyhsu@cc.ee.ntu.edu.tw m9521057@stmail.cgu.edu.tw
 
 
 
摘要 
本論文提出一個新的方法設計獨立感應發電機系
統之電壓及頻率調整器。所提的方法主要藉由調速機控
制發電機的動能來達到發電機定頻控制的目標，而發電
機定電壓的控制則藉由控制靜態同步補償器的輸出無
效功率來完成。為了有效控制靜態同步補償器及調速
機，本論文採用輸出迴授型線性二次式理論來進行控制
器設計。此外，由獨立感應發電機的定電壓穩態分析結
果得到一個重要的結論：在固定發電機端電壓時，發電
機的定子頻率與轉速成正比。此結論將有助於使用調速
機來精確控制發電機的輸出頻率。由實驗結果發現，所
提出的控制器確實可以有效改善獨立感應發電機的輸
出電壓及頻率。 
 
關鍵詞：感應發電機，電壓控制，頻率控制，靜態同步
補償器。 
Abstract 
 This paper presents a new approach for the voltage and 
frequency control of an isolated induction generator (IG). 
In the developed approach, constant frequency control is 
achieved through kinetic energy control by a speed 
governor while constant voltage control is reached through 
reactive power control by a STATCOM. An output 
feedback linear quadratic controller is designed for the 
STATCOM and the speed governor in order to reach the 
voltage and mechanical power control. An important 
conclusion obtained from steady-state analysis results for 
an isolated induction generator is that the stator frequency 
is proportional to the rotating speed at constant stator 
voltage. The advantage is that, through the action of the 
speed governor, the stator frequency can be regulated 
precisely. The experimental results show that satisfactory 
dynamic performance of the isolated IG can be achieved by 
the proposed frequency controller and voltage controller. 
 
Keywords: Induction generator (IG), voltage control, 
frequency control, static synchronous compensator 
(STATCOM). 
I. 前言 
由於近年來台灣工商業的蓬勃發展，使得每年電力
的平均負載量均以倍數的成長，為了彌補發電量不足及
傳統石化燃料發電方式所衍生的環保問題，積極推動再
生能源的開發及利用已成為政府能源科技政策的主要
方針。感應發電機的結構單純且堅固耐用，所以普遍應
用於再生能源發電系統上；然而，礙於其轉子結構缺乏
磁場線圈，因此必須藉由外部激磁裝置來進行電壓調
整。 
為了改善感應機發電系統的動態電壓響應，常採用
各式用以調整匯流排電壓之並聯補償設備，包括固定式
並聯電容器[1-6]、結合了固定電容器與閘控電抗器
(Thyristor-Controlled Reactor, TCR)的靜態虛功補償器
(Static Var Compensator, SVC)[7]以及採用電壓源型變流
器(Voltage-Sourced Inverter, VSI)為主要元件的靜態同步
虛 功 補 償 器 (Static Synchronous Compensator, 
STATCOM)[8]。在這些並聯補償設備中，傳統固定式並
聯電容器通常用於穩態電壓調整與虛功補償，其缺點是
當匯流排電壓下降時，其補償能力亦隨之下降。Bim 等
人提出了長-並聯(long shunt)固定電容架構[16]，並根據
感應發電機之磁化曲線特性計算並聯電容及串聯電容
之容值，此架構的優點在於當負載增加時雖會造成電壓
降而導致並聯電容的補償能力下降，但是串聯電容的補
償能力卻反而因增加的負載電流而提升，所以只要串聯
及並聯電容值計算得當，對於負載變動型的擾動具有相
當不錯的補償能力。Wang 等人進而以實驗及特徵值分
析的方式比較長-並聯及短-並聯(short shunt)固定電容架
構[4]，發現短-並聯架構有較佳的電壓動態響應；然而，
即使感應發電機定子及轉子間存在的轉差可類比於質
量系統中的扭轉阻尼(torsional damping)[9]，不似同步發
電機所類比於質量系統中的扭轉彈簧(torsional spring)容
易引起低頻震盪之現象，但不當的電容值設計及串聯電
容結構是否引起次同步共振，則是此架構的潛在危險。
因此，若欲應付感應發電機系統中各式各樣的擾動以獲
得較佳的動態電壓響應，SVC 與 STATCOM 將是系統規
劃者較佳之選擇。 
 
STATCOM
vL IG
rL  
iL 
e
rf          +
 
Xf
ie
vdcCdc
idc
Switching patterns input
Primer
Mechanical 
power input
Load
 
圖 1 獨立感應發電機電壓及頻率控制示意圖 
 
中華民國第二十七屆電力工程研討會 
台灣  新竹  2006 年 12 月 22-23 日 
III. 控制器設計 
 
結合感應發電機、STATCOM 及負載動態模型之系
統線性化動態方程式可以用下式描述 
 
Δ
⎤⎦
Δ
Δ Δ
Δ Δ
• = ⋅ + ⋅
= ⋅
x A x B u
y C x
            (1) 
在(1)式之控制器輸出向量Δu含有STATCOM在d′- 
q′軸的輸出電壓(Δe′d, Δe′q)及機械功率控制命令Δβ： 
T
d qe' e'Δ Δ Δ Δβ⎡= ⎣u             (2) 
此外，系統可量測的輸出向量Δy包含發電機端電壓之大
小 ΔVL 、發電機轉速 Δωru 、直流電容電壓 Δvdc 及
STATCOM在d′- q′軸的電流(Δi’de, Δi’qe)等： 
u
L dc de qe r
T
L dc L dc
V v i' i'
V dt v dt V dt v dt
Δ Δ Δ Δ Δ Δω
Δ Δ Δ Δ
⎡= ⎣
⎤∫ ∫ ∫ ∫ ∫ ∫ = ⋅⎦
y
C x
 
考慮一個表為線性二次式(linear quadratic form)的
性能指數 J，其可透過全狀態迴授控制 Δu加以極小化，
如下式： 
( )T T
0
1min. J dt
2
Δ Δ Δ Δ∞= +∫ x Q x u R u    (3) 
其中，Q為狀態變數變動量的加權矩陣，R為控制器輸
出變動量之加權，控制器輸出變動量可表為 
sΔ = − ⋅u K Δx
Δ
Δ
s
               (4) 
因此，配合可極小化(3)及(4)之最佳控制 Δu，(1)式
的閉迴路控制系統可表示為 
sΔ
• = ⋅x A x                (5) 
其中 
 　 　       　   (6) 
s s
1 T
1 T
s
−
−
= − = −
=
=
A A BK A SM
S BR B
K R B M
且Ms為下式(algebraic Riccati equation (ARE))的半
正定解(positive semi-definite solution) (M=Ms)。 
T + + − =A M MA Q MSM 0          (7) 
依據(6)計算狀態迴授增益矩陣Ks前，必須根據經驗
及物理意義設定加權矩陣Q及R的初值，再根據(7)解
ARE求得一個半正定解，以極小化(3)式之性能指數J。
另外，本論文亦根據Medanic等人於 1988 年提出之極點
指定法[13]，引入一個相對穩定度變數(relative stability 
variable) χ進入性能指數J，重新設計線性二次式控制中
的加權矩陣。 
輸出迴授控制 Δu可表示為 
oΔ = − ⋅u K y               (8) 
其中，Ko為輸出迴授增益矩陣，其與狀態迴授增益矩陣
Ks的關係如下： 
                       (9) o ⋅ =K C K
由於輸出矩陣C之反矩陣不存在，所以一般均以
pseudo-inverse的方法來獲得Ko： 
o s
ˆ= ⋅K K C                (10) 
其中             ( ) 1T Tˆ −= ⋅ ⋅C C C C
由於實作時，旋轉機械的轉動慣量很小，不若再生
能源諸如風力發電機之大直徑葉片具有高慣量，所以在
設計控制器時必須考慮盡量使用較低增益之迴授矩
陣，以免受到雜訊之影響。在選擇機電振盪模式之極點
偏移量 χ 時，本論文以輸出迴授矩陣之範數(Frobenius 
norm)為主要依據，以避免計算出高增益的迴授矩陣
[14]。由圖 4 發現，χ 由-5 變化至 0.2 時，迴授矩陣之
範數幾乎呈固定斜率的直線上升且變化量很小；但一旦
χ 超過 0.2 時範數的斜率將大幅提昇。因此，在本實驗
中，選擇 χ=0.2 當作機電振盪模式之極點偏移量，而此
點亦是機電振盪頻率變化最小的地方。再者，由圖 5
可發現，χ=0.2 時阻尼比相當接近臨界阻尼。 
表 1 為系統特徵值在加入控制器後的變化情形，在
加入輸出迴授控制器後，STATCOM 交流側電流模式之
極點可以由-61.74±j372.27 左移至-199.08±j357.53，若將
機電振盪模式之極點偏移量 χ=0.2 加入控制器設計後，
可再將極點左移至-199.17±j357.85。此外，STATCOM
直流電壓模式之極點，在經過控制器設計後，亦可由
-0.45 改善至-2.96。 
-5 -4 -3 -2 -1 0 1 2 3 4 5
5
10
15
20
Im(λ)
χ
X
norm
15
10
20
5
x10
norm
Im(λ)
 
  圖 4 極點偏移量對輸出增益矩陣範數及特徵值虛
部之影響 
-5 -4 -3 -2 -1 0 1 2 3 4 5
0.5
0.55
0.6
0.65
0.7
0.75
ζ
χ
X0.71966
 
圖 5 選擇極點偏移量對應之阻尼比 
 
表 1 系統主要特徵值整理  
閉迴路特徵值 開迴路特徵值 狀態迴授 輸出迴授 
-61.74±j372.27a -79.88±j374.21a -199.17±j357.85a
-0.45b -3.18b -2.96b
-15.69±j4.43c -11.83±j12.41c -10.51±j10.14c
a STATCOM之交流電流模式 
b STATCOM之直流電壓模式 
c 機電震盪模式 
中華民國第二十七屆電力工程研討會 
台灣  新竹  2006 年 12 月 22-23 日 
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
0.5
1
1.5
2
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
-1
0
1
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
-1
0
1
(c)
(b)
(a)
i'
de
(pu)
i'
qe
(pu)
V
L
(pu)
Time (sec)
Time (sec)
Time (sec)
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
40
60
80
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
-10
0
10
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6
1500
1600
1700
1800
1900
ω
r
(rpm)
(f)
(e)
(Hz)
f
o
θ
L
(rad)
(d)
t
1 t
2
Time (sec)
Time (sec)
Time (sec)  
圖 8 互聯輸電線切離時系統的動態響應(實驗波形) 
(a)發電機端電壓 (b)STATCOM 直軸電流 
(c)STATCOM 交軸電流 (d)發電機輸出頻率 
(e)發電機端電壓之相對相位角 (f)發電機轉速 
t1:互聯輸電線切離台電 
t2:頻率調整器及輸出迴授控制器開始動作 
 
V. 實驗結果 
 
實驗的操作程序首先將感應發電機與無限匯流排
並聯運轉，在時間=t1時將感應發電機脫離無限匯流
排，開始進行獨立運轉，接著在時間=t2時加入輸出迴
授及頻率控制器。 
由圖 8(a)可發現，感應機端電壓在時間= t1時被一個
僅含有簡單的相位及電壓大小控制器[16]之STATCOM
控制得相當穩定，並無過激或欠激的現象。但由於未施
予頻率調整，所以，感應發電機原先供應無限匯流排的
實功率將使轉子加速，並造成頻率上升，如圖 8(e)及圖
8(d)所示；頻率的變化量亦可由圖 8(e)中發電機端電壓
的相位變化率求得，其上升幅度約 2Hz。 
由於獨立運轉的感應發電機，其電壓及頻率十分容
易受到負載變動所影響，所以，所設計的控制器必須能
夠在頻率或電壓偏離設定值之情況下，將其調回設定
值，為了測試頻率調整器及輸出迴授控制器，在頻率嚴
重地偏離原先所設計的工作點下，是否仍能正常工作，
在時間=t2時，將輸出迴授控制器及頻率調整器加入運
轉。 
如圖 8(d)-(e)所示，將輸出迴授控制器及頻率調整
器加入運轉後，在 0.25 秒之內即可將系統頻率調整至
設定值。但由於轉子具有慣性，其轉速在 0.5 秒內才達
到穩定。此外，由於系統工作點偏移，對甫切入運轉之
輸出迴授控制器將造成短暫的擾動現象。由圖 8(c)可
知，受擾動的 STATCOM 之 q-軸電流將造成短暫的端
電壓突升(圖 8(a))，但由於控制器具有積分迴授的功
能，其端電壓的誤差信號在很短的時間內，將迫使系統
回到原來的工作點(假設系統架構不變時)，或在滿足電
壓及頻率設定的條件下，適應新的工作點(假設系統架
構改變時)。 
VI. 結論 
 
本論文主要以系統式方法設計 STATCOM 控制器
以有效改善獨立感應發電機系統的動態電壓響應；此
外，本論文亦利用相對旋轉速度理論，藉由發電機旋轉
質量之動能控制的觀念實現即時且連續的頻率調整及
偵測。由實驗結果顯示所提出的方法確實可以有效調整
獨立感應發電機系統的電壓及頻率。 
 
參考文獻 
[1] L. Tang and R. Zavadil, “Shunt capacitor failures due to windfarm 
induction generator self-excitation phenomenon,” IEEE Trans. on 
Energy Conversion, vol. 8, no. 3, pp. 513-519, 1993. 
[2] L. Wang and C.H. Lee, “Long-shunt and short-shunt connections 
on dynamic performance of a SEIG feeding an induction motor 
load,” IEEE Trans. on Energy Conversion, vol. 15, no. 1, pp. 1-7, 
2000. 
[3] L. Shridhar, B. Singh and C.S. Jha, “Transient performance of the 
self regulated short shunt self excited induction generator,” IEEE 
Trans. on Energy Conversion, vol. 10, no. 2, pp. 261-267, 1995. 
[4] E. Bim, J. Szajner and Y. Burian, “Voltage compensation of an 
induction generator with long-shunt connection,” IEEE Trans. on 
Energy Conversion, vol. 4, no. 3, pp. 526-530, 1989. 
[5] L. Wang and C.H. Lee, ”A novel analysis on the performance of an 
isolated self-excited induction generator,” IEEE Trans. on Energy 
Conversion, vol. 12, no. 2, pp. 109-117, 1997. 
[6] T.F. Chan, ”Capacitance requirements of self-excited induction 
generators,” IEEE Trans. on Energy Conversion, vol. 8, no. 2, pp. 
304-311, 1993. 
[7] L. Gyugyi, “Reactive power generation and control by thyristor 
circuit,” IEEE Trans. on Industry Applications, vol. 15, no. 5, pp. 
521-532, 1979. 
[8] 張權德，「用以改善動態特性之靜態同步補償器與整合型電力
潮流控制器之設計」，台灣大學電機所博士論文，2002。 
[9] Erich Hau, Windturbines, Springer-Verlag Berlin Heidelberg, 2000. 
[10] S.S. Murthy, O.P. Malik, A.K. Tandon and M. Tech, “Analysis of 
self-excited induction generators,” IEE Proceedings-C, vol. 129, no. 
6, pp. 260-265, 1982. 
[11] B. Bonert and S. Rajakaruna, “Self-excited induction generator 
with excellent voltage and frequency control,” IEE Proc.-Gener. 
Transm. Distrib., vol. 145, no. 1, pp. 33-39, 1998. 
[12] B. Singh, S.S. Murthy and S. Gupta, “Analysis and implementation 
of an electric load controller for a self-excited induction generator,” 
IEE Proc.-Gener. Transm. Distrib., vol. 151, no. 1, pp. 51-60, 
2004. 
[13] J. Medanic, H.S. Tharp and W.R. Perkins, “Pole placement by 
performance criterion modification,” IEEE Trans. on Automatic 
Control, vol. 33, no. 5, pp. 469-472, 1988. 
[14] J.W. Choi, “A simultaneous assignment methodology of right/left 
eigenstructures,” IEEE Trans. on Aerospace and Electronic 
Systems, vol. 34, no. 2, pp. 625-634, 1998. 
[15] 陳偉倫，「風力-感應發電機系統之電壓及頻率調整器設計」，
台灣大學電機所博士論文，2006。 
[16] W.L. Chen and Y.Y. Hsu, “Experimental evaluation of an isolated 
induction generator with voltage and frequency control,” IEEE 
International Symposium on Power Electronics, Electrical Drives, 
Automation and Motion, 2006. 
 
II. CONTROLLER DESIGN 
The Park’s transformation is a well known three-axis to 
two-axis transformation in a balanced three phase system. 
The transformation equation is of the form: 
fdq0=P‧fabc                                 (1) 
where the transformation matrix is defined as 
2 2cos( ) cos( ) cos( )
3 3
2 2 2sin( ) sin( ) sin( )
3 3 3
1 1 1
2 2 2
t t t
t t t
π π
ω θ ω θ ω θ
π π
ω θ ω θ ω θ
 
+ + − + +   
= − + − + − − + +     
P  
 
and  fqd0=[fq  fd  f0]T, fabc=[fa  fb  fc]T. 
 
For a balanced set of three-phase functions given by  
 
0cos( )af f tω θ= +                              
 0
2cos( )
3b
f f t πω θ= + −                     (2) 
0
2cos( )
3c
f f t πω θ= + + .                   
The transformation of (1) yields 
0cos( )df f θ θ= −                            (3) 
0sin( )qf f θ θ= − .                           (4) 
Under steady-state balanced three phase conditions, the 
total three phase active power and reactive power may be 
expressed in terms of d-q quantities as (5) and (6), where the 
v  and i are the peak values of phase voltage and phase 
current, respectively, and θv andθi are the phase angles for 
phase voltage va and phase current ia , respectively. 
3 cos( )
2 v i
P v i θ θ= −  
3 ( )
2 q q d d
v i v i= +                             (5) 
3 sin( )
2 v i
Q v i θ θ= −  
3 ( )
2 q d d q
v i v i= −                             (6) 
To facilitate the control design, it is convenient to 
introduce the power flow between the load bus and 
STATCOM bus as depicted in Fig. 2. It is obvious that the 
STATCOM input power (Pi*+jQi*) must be equal to the sum 
of the power consumed by the filter (Pf*+jQf*+jQc*) and the 
power delivered to VSI (Pe*+jQe*). In other words, we have 
the following power balance equations 
* * *
i f eP P P= +                                  (7) 
* * * *
i c f eQ Q Q Q= + +                          (8) 
where the inverter input active power and reactive power 
can be obtained by utilizing the power expression in (5) and 
(6), yields 
* * * * *3 ( )
2e d de q qe
P e i e i= +                         (9) 
e
STATCOM
bus
rf           
Load 
bus
Xf
vL
ie
Cc
ifc
ii
Pi, Qi
Qc Pf, Qf
Pe, QeDistribution
system
 
 Figure 2. Power flow control between load bus and STATCOM bus. 
 
∆vdc
∆
s
Ki2Kp2+
s
Ki1Kp1+
Xf
Qi* iqe
*
ed*
eq*
Qf*+Qe*
Qc*
ide*
rf
rf
Xf
|vL|
ß
ß
VSI output voltage calculatorAC voltage regulator
DC voltage regulator
Pf*+Pe*
ß=
|vL|
1
3
2
|vL|
 
Figure 3. Block diagram of the proposed controller. 
* * * * *3 ( )
2e q de d qe
Q e i e i= − .                     (10) 
Similar expressions for the input power of the STATCOM 
can be written as  
( )* * * * *3
2i f e dL de qL qe
P P P v i v i= + = +                      (11) 
( )* * * * * * *3
2i c f e c qL de dL qe
Q Q Q Q Q v i v i= + + = + − .   (12) 
In addition, with the synchronous reference frame defined 
and the phase locked loop (PLL) circuit employed, the load 
voltage is entirely d-axis and can now be expressed as 
dL Lv v=                                    (13) 
0qLv = .                                     (14) 
Substitution of (13) and (14) into (11) and (12) yields  
* * * *3 3
2 2f e dL de L de
P P v i v i+ = =                     (15) 
* * * *3 3
2 2f e dL qe L qe
Q Q v i v i+ = − = −               (16) 
The power consumed by coupling transformer and line filter 
is given by 
* *2 *2 *23 3 ( )
2 2f e f de qe f
P i r i i r= = +                  (17) 
* *2 *2 *23 3 ( )
2 2f e f de qe f
Q i X i i X= = + .            (18) 
Substitution of (9), (10), (17), and (18) into (15) and (16) 
yields the commands of VSI output voltage as 
* * * *
d f de f qe Le r i X i v= − + +                   (19) 
* * * *
q f qe f dee r i X i= − − .                          (20) 
Fig. 3 shows the block diagram of the proposed 
controller in which the VSI output voltage calculator is 
realized by (19) and (20). It should be mentioned that the 
current commands, ide* and iqe* in VSI output voltage 
calculator can be directly obtained from (15) and (16), 
respectively. In other words, the d-axis current component, 
ide*, accounts for the instantaneous active power and the q-
Fig. 5(d) depicts that the STATCOM current changes 
phase with respect to the sudden increase in load capacitor. 
It is apparent that two-cycle transient time is needed to 
control the STATCOM current from leading mode to 
lagging mode. 
IV. CONCLUSION 
In this paper, a STATCOM controller incorporating an 
AC and DC voltage regulator as well as a VSI output 
voltage calculator has been developed and investigated. 
Experimental results show that fast response for a change 
between the leading and lagging power compensation can be 
achieved by the proposed controller. In addition, due to the 
decoupled control between active power and reactive power 
of the STATCOM, the independent selection of controller 
gains for the AC voltage regulator and DC voltage regulator 
is achievable. 
ACKNOWLEDGMENT 
Financial support given to this work by the National 
Science Council of the Republic of China under contract 
number NSC-96-2218-E-182-001 is appreciated. 
APPENDIX 
System parameters 
Source Impedance 
Supply line resistance rTL 0.055pu 
Supply line inductance XTL 0.145pu 
VSI 
Series filter reactance Xf 0.238pu 
Series filter resistance rf 0.011pu 
Shunt filter capacitance Xc 7.27pu 
DC-link capacitor Cdc 6800 µF 
Load Model 
Load impedance   1.033 + j0.729 pu 
Load capacitor (∆-connected)  100 µF 
System Base Setting 
Base MVA Sb 500VA 
Induction generator voltage base VACb 78.0V 
Inverter DC-link voltage base VDCb 200V 
Control Parameters 
AC voltage regulator Kp1 20.0 
 Ki1 10/ 100/1000 
DC voltage regulator Kp2 20.0 
 Ki2 10.0 
 
REFERENCES 
[1] C. Schauder and H. Mehta, “Vector analysis and control of advanced 
static var compensators,” IEE Proceedings-C, vol. 140, no. 4, pp. 
299-306, 1993. 
[2] G. Joos, L. Moran and P.Ziogas, “Performance analysis of a pwm 
inverter var compensator,” IEEE Trans. on Power Electronics, vol. 6, 
no. 3, pp. 380-391, 1991. 
[3] L. Moran, P. Ziogas and G. Joos, “Analysis and design of a three-
phase synchronous solid-state var compensator,” IEEE Trans. on 
Industry Applications, vol. 25, no. 4, pp. 598-608, 1989. 
[4] W.L. Chen and Y.Y. Hsu, “Controller design for an induction 
generator driven by a variable-speed wind turbine,” IEEE Trans. on 
Energy Conversion, vol. 21, no. 3, pp. 625-635, 2006. 
[5] G.W. Moon, “Predictive current control of the distribution static 
compensator for reactive power compensation,” IEE Proc.-Gener. 
Transm. Distrib., vol. 146, no. 5, pp. 515-520, 1999. 
[6] C.K. Sao, P.W. Lehn, M.R. Iravani, and J.A. Martinez, “A benchmark 
system for digital time-domain simulation of a pulse-width-modulated 
D-STATCOM,” IEEE Trans. on Power Delivery, vol. 17, no. 4, pp. 
1113-1120, 2002. 
[7] P.S. Sensarma, K.R. Padiyar and V. Ramanarayanan, “Analysis and 
performance evaluation of a distribution STATCOM for 
compensating voltage fluctuations,” IEEE Trans. on Power Delivery, 
vol. 16, no. 2, pp. 259-264, 2001. 
[8] L. Xu, V.G. Agelidis and E. Acha, “Development considerations of 
DSP-controlled PWM VSC-based STATCOM,” IEE Proc.-Electr. 
Power Appl., vol. 148, no. 5, pp. 449-455, 2001. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 





