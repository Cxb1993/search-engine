2一、前言與研究目的
分析一個國家的股市資料前必需要先判斷其股票市場的效率性。而所謂市場的效率性即
是指，投資者在買賣股票時會迅速有效地利用各種可能的信息，根據所有已呈現之影響股票
因素與反映出之股票價格可判斷其市場的效率性，主要分為弱勢效率市場、半強勢效率市場、
強勢效率市場[2]。
預測股票市場(stock market)漲跌的方法，一般來說常常都是透過許多前人設計出來的指
數、公司的財務報表、財經新聞等，從中分析出每個數值的利益來判定此股票是屬於多頭或
空頭，然而時常發現在當時世界的經濟狀況下許多指數資料，其參考性不是非常的高，因此
許多專家在分析股市時都會加入歷史資料來比對，根據目前股市的情形尋找出相似的歷史情
形來，再判斷目前股市應有的價值。
目前經濟環境的迅速變動與網際網路的發達，導致影響股票市場漲跌因素錯綜複雜，所
以大部份的分析人員皆是透過自己比較熟悉的指數和財務資料來做分析與預測，然而分析人
員所使用的參考資料往往不夠完整。近年來，隨著知識的累積、科技的進步與計算能力的提
升，跨學門的綜合研究不斷產生，使用電腦來分析預測股市的參考價值已經漸漸受到重視。
[28]案例式推論系統(case-based reasoning, CBR)是藉由回憶（recall）與在使用(reuse)特定
經驗來解決問題。其所使用的方法就類似投顧公司的分析員經由比對歷史情形來判斷現在股
市的趨勢。而人工類神經網路(artificial neural network, ANN)是一種模擬生物神經網路運作方
式的一種計算系統，使用大量的人工神經元互相連接來模擬生物神經網路運作模式，透過平
行式的運算處理來仿效生物神經網路的記憶與學習能力[24]。此特性就像股票分析員透過接
收到的各種訊息從中判斷股票之漲跌程度。此外，模糊理論是針對一些無法使用傳統邏輯來
判斷之事物而發明的技術[6]。而在股票市場預測中，股票分析員要決定買進、持有不動和賣
出之策略時，在股價漲跌的某些階段中往往是重疊的，因為所有的投資者在購買股票時皆要
繳交相關的手續費，股價漲跌的%數需要到一定的程度才可以引發投資者的購買慾望，因此
透過模糊裡論可以計算出投資者在每個區段的購買慾望，再從中設定買進、賣出之時機和決
定做空、持股不動以及做多之策略。
本研究主要透過結合案例式推論和類神經網路來模擬股市分析員，配合模糊理論來界定
股票漲跌程度，並從中設定合適的臨界點判斷股價的趨勢。
二、文獻探討
預測股票漲跌的方法雖然有許多，但與本研究探討的”使用案例式推論以及類神經網路
預測股票漲跌”的相關研究，主要為三個方法：k 鄰居案例推論法[18]、基因式 k 鄰居案例推
論法[18]和類神經預測法[24]。
k 鄰居案例推論法
在 2008 年[18]，Ahn 和 Kim 提出結合案例式推論與 k 鄰居近似法，使用股票技術指標預
測韓國綜合指數(Korea composite stock price index, KOSPI)之漲或跌，主要是從歷史案例中挑
選 k 個最接近待預測案例的案例，並根據此 k 個案例之漲跌結果決定現在案例的結果，其中
k 值介於 1 到 10 之間且漲跌預測結果之決定方式採投票制。
該報告中指出當 k 值過大時將會造成系統效能嚴重降低，因此該研究中又進一步提出結
合基因演算法可獲得較佳的 k 值並提高預測準確度。此方法之優點乃速度快和易於實作，但
有準確度較低和預測方式不符合實際情形(只有預測漲跌，沒有預測持股不動)之缺點。
4圖 一、系統架構圖
圖 二、案例產生子系統
案例產
輸入因
特徵值選
案例式擷
取系統
歷史案例
資料庫
案例擷
類神經網路
分析系統
案例產生
案例分
糢糊理論
決策器
測試案
案例決
開
始
決策
建立歸屬函
測試案例歷史案例
產業因素 市場因素 公司因素
輸入股市資料
產生特徵值
擷取產業股市
案例產生器
歷史股市資料
6案例決策子系統
在本系統中決定策略是使用模糊推論系統，主要利用投資者的損益程度決定模糊推論系
統的歸屬函數並根據測試案例的歸屬度決定股市買賣策略，其系統架構如圖五所示。
圖 五、案例決策子系統
決定策略主要是利用設計的歸屬函數來推論測試案例的策略，其策略推論方式如下：
先判斷 fu(x), fm(x), fd(x)何者最大
如果 fu(x)最大，則策略決定為做多
如果 fm(x)最大，則策略決定為持股不動
四、實驗結果
本研究採用台灣證卷交易所電腦週邊業 19 家股票資料，根據 7 個技術指標和 8 個財務危
機因素之分析，共 22 個特徵值作為輸入變數，以建立買賣策略的網路模型，透過類神經網路
的訓練後，能提供策略給投資人對於買賣此 19 家股票的適當時機。研究期間為 2001 年 1 月
1 日至 2005 年 12 月 31 日的股票資料，在實驗中顯示研究樣本期間以及特徵值數量過大將會
影響系統效能，因此將研究期間設定為 2002 年 1 月 1 日至 2004 年 12 月 31 日，其中 2002
年 1 月 1 日至 2003 年 12 月 31 日之資料為歷史案例資料庫，2004 年 1 月 1 日至 2004 年 12
月 31 日之股票資料為預測資料，並且根據數值過小以及無法百分比正規化從 22 個特徵值中
刪除 7 個特徵值 20 日移動平均線、MACD 之 EMA 值、MACD 之 DIF 值、威廉指標、心理
線、固定資產成長率以及短期借款率至 15 個特徵值。
我們嘗試結合基因演算法與類神經網路做為第四種方法並與其他方法比較，根據表一和
圖六之實驗結果顯示，第四種方法其平均預測準確度(37.5%)反而比類神經案例推論(38.35%)
低 0.8%，比基因式案例推論(41.01%)低 3.5%。其中平均預測準確度最高的方法為基因式 k
鄰居案例推論，而由於在股票預測中穩定度比平均準確度的還重要，本研究採用標準差的方
式比較各方法的穩定度，標準差值越小則越穩定，反之越大則越不穩定，從實驗結果可看出
本研究所提出的類神經式案例推論以及 k 鄰居案例推論法相近(2.68%, 2.68%)，且高出基因式
案例推論 1.35%，然而當我們將特徵值由 15 個增加 7 個特徵值：20 日移動平均線、MACD
建立歸屬函數
模糊推論
決定策略
測試案例
類神經網路
8圖 六、各方法預測準確度比較圖
表 二、增加特徵值的各方法預測準確度比較表
準確度(%)
(代號)股票名稱
k 鄰居案例推論基因式 k 鄰居案例推論 類神經式案例推論基因式類神經案例推論
(2324)仁寶 36.00 39.60 39.20 40.16
(2352)佳士達 39 41.60 35.60 36
(2353)宏碁 34.00 38.40 34.80 33
(2357)華碩 34.80 33.60 44.18 33.60
平均準確度 36.00 38.30 38.45 37.50
標準差 1.60 2.35 3.25 2.44
五、結論
本研究根據三種預測方法，k 鄰居案例推論、基因式 k 鄰居案例推論和本研究所提出的
類神經式案例推論之實驗結果顯示，基因式案例推論法之預測準確度較不穩定，而本研究提
出的類神經案例推論在特徵值為 22 個時，其預測準確度明顯比 k 鄰居案例推論改善，可達到
較佳的預測效果，並且從實驗效能中顯示，類神經案例推論訓練樣本(單隻股票一季資料)較
基因式案例推論以及 k 鄰居案例推論訓練樣本(整個歷史資料庫)小，執行速度較快，因此可
知本研究提出的類神經式案例推論方法將可輔助投資人決定較佳股票買賣策略。
本研究中所使用的輸入變數均為可量化的資料，後續研究則建議加上會影響股市漲跌之
非量化變動因素，如公司發佈之新聞。由於股票之漲跌程度往往會受到公司發佈之新聞所影
響，因此可利用相關之資訊擷取(Information Retrieval)技術，擷取公司發佈之新聞資料，判斷
該新聞對於股票之影響屬於利多或利空，並給予相對應的數值當特徵值。
10
[26] Ombuki, B.-M. & Ventresca, M. (2004). Local search genetic algorithm for the job shop
scheduling problem. Applied Intelligence, 21, 99-109.
[27] Roger Schank, Dynamic Memory: A Theory of Learning in Computers and People (New York:
Cambridge University Press, 1982).
[28] Shin, K.-S., & Han, I. (1999). Case-based reasoning supported by genetic algorithms for
corporate bond rating. Expert Systems with Applications, 16, 85–95.
[29] Wang, Y., & Ishii, N. (1997). A method of similarity metrics for structured representations.
Expert Systems with Applications, 12, 89–100.
[30] Yin, W. J., Liu, M., & Wu, C. (2002). A genetic learning approach with case-based memory
for job-shop scheduling problems. In Proceedings of the first international conference on
machine learning and cybernetics, pp. 1683–1687.
98年度專題研究計畫研究成果彙整表 
計畫主持人：林葭華 計畫編號：98-2221-E-110-069- 
計畫名稱：應用案例式推論與類神經網路建立智慧型股票買賣策略預測系統 - 以台灣電子股為例 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
