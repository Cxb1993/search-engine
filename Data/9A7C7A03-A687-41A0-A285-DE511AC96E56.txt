 1
國科會補助提升產業技術及人才培育研究計畫成果精簡報告 
學門領域：生產自動化技術 
計畫名稱：訂單分配策略之研發  
The Development of Order Assignment Policies 
計畫編號：NSC 94-2622-E-033-010-CC3 
執行期間：94 年 05 月 01 日至 95 年 04 月 30 日 
執行單位：中原大學工業工程學系 
主 持 人：陳建良 副教授 
參與學生：吳政俊、吳漢斌、呂祐騏 
合作企業簡介 
合作企業名稱：勁碩資訊股份有限公司 
計畫聯絡人：張進群 
資本額：新台幣 1000 萬元 
產品簡介：網路（Internet）作業系統的專案設計與開發、Application 
Service Provider (ASP) 的提供 
網址： www.usales.com.tw            電話：02-82584671 
人才培育成果說明：本計劃可訓練電子產業生產管理方面之人才，以配合國家經濟發
展之人力需求。 
技術研發成果說明：本計劃所發展之訂單分配策略可協助電子產業快速且準確的求解
訂單分配問題，有效平衡各廠的負荷，以達到資源的最佳分配。 
技術特點說明：本計劃考慮電子產業其多廠之機台製程規格能力限制，發展一套適用
於一般電子產業之訂單分配策略。 
可利用之產業及可開發之產品：電子相關產業之訂單分配軟體。 
推廣及運用的價值：協助電子相關產業提昇在生產管理上之效率與效能。 
 
 
一、中文摘要 
為了快速回應客戶與滿足訂單交
期，訂單分配對多廠之企業而言，可
說是非常重要的。企業通常擁有多個
工廠，其分別具有不同產能限制與製
程規格能力。合理的訂單分配策略可
有效利用工廠的產能與平衡工廠之負
荷，並可縮短生產前置時間、提高達
交率及降低在製品。 
本計劃根據過去執行之無限產能
規劃與有限產能規劃之國科會計畫，
 3
 
 
 
圖一 產能負荷與訂單分配 
 
本計畫與勁碩資訊股份有限公司
合作，針對電子產業進行多廠訂單分
配策略之研發，期望此研究成果可作
為開發訂單分配軟體之參考基礎，並
進一步延伸應用至電子產業。本計劃
的研究成果可協助產業界能更迅速有
效分配訂單，以滿足訂單交期並提升
設備使用率。 
電子產業在多變的競爭環境中，
為了強化競爭力，滿足客戶訂單交期
並提高產能使用率，已成為大多數工
廠經營者的管理績效指標。過去在訂
單分配的研究多偏重在單廠的探討，
隨著電子產業擴充產能及國際化的演
變，跨廠區性的議題也隨之浮上台
面，使得原本簡單的訂單管理問題，
從單廠衍生到複雜的多廠規劃問題。 
有效的訂單分配策略，在公司接
到訂單後，必須有計畫的將訂單分配
到所屬各個工廠並且能夠達到資源的
最佳分配，可使後續的投線策略及派
工策略容易規劃。反之，若訂單分配
不均造成部分工廠產能過剩或產能不
足，且影響公司整體績效甚鉅並導致
各工廠後續之投線及派工執行成效受
限。但現行的訂單分派模組多是高階
或資深主管的經驗，根據工廠現有產
能和業務員的接單做區域性的分配，
再依照各廠本身的製程能力來分配訂
單，往往無法有效地善用資源，將訂
單正確地分配到合適的工廠進行生
產，而造成資源的浪費。且目前業界
應用在工廠所使用之產能規劃軟體，
其功能雖然強大，但導入系統需要輸
入大量的資料，且一個模組售價動輒
數百萬，對中小型企業來說實為一大
負擔。 
因此，如何將訂單妥善分派至各
工廠中，使各個工廠達到最有效的利
用，達到高生產率以及高達交率，即
為多廠訂單分配所關注的問題。有鑑
 
公司
工廠 
‧
‧
‧
‧
SMT 生產線
DIP 生產線
SMT 生產線
DIP 生產線
‧
‧
‧
SMT 生產線
DIP 生產線
SMT 生產線
DIP 生產線
‧
‧
‧
SMT 生產線
DIP 生產線
SMT 生產線
DIP 生產線
‧
‧
‧
第一階段 第三階段  第二階段 
 5
3.1 訂單分配演算法 
步驟一 輸入 MPSp(t)，其中 MPSp(t)為
主生產排程計劃在時間 t 需要
產品 p 之數量 
步驟二 在製品指派模組：在製品指派
模組由製程之末端開始拉引
在製品以滿足 MPSp(t)，若在
製品滿足 MPSp(t)之需求時則
進行步驟七。 
步驟三 投料模組：若在製品無法滿足
MPSp(t)之需求時，投料模組則
進行投料。 
步驟四 計算滿足 MPSp(t)的投料訂單
之最晚投料日（Latest Release 
Time, LRT）。 
步驟五 若批量 w 在時間 t 投料，計算
產品 p之批量w所在瓶頸設備
k 之工作負荷(Lf,k(t))。在此步
驟中包括以下二個兩個方案。 
方案一  訂單分配策略為 Path Load
時，若訂單在製造廠 f 投料且
投料時間為 t 時，則需按照產
品p之製程計算所有在製品w
之負荷比率 (TLRw,t,f)。 
ftvaluethreshold
AC
sPSTL
p fpw
fp
Bs sEsPST
wsEf ∀∀⎟⎟⎠
⎞
⎜⎜⎝
⎛ −= ∑
∈
 , 
))((
TLR
)(),(
)(,
ft,w,
,
,
，其中 Bp 為需於瓶頸站進行
加工之產品製程，Ep,f(s)為製
造廠 f 中可以進行產品 p 之製
程 s 之設備，PSTw(s)為在製
品 w 製程 s 之預定開始時間，
最後 ACd,k為設備 k 在第 d 天
之可用產能。 
方案二 訂單分配策略為 Shop Load
時，若訂單在製造廠 f 投料且
投料時間為 t 時，則製造廠中
所有設備（m=1,2,…,M）於整
個規劃期間（t=1,2,…, T）之
負荷均需被考慮。 
fvaluethreshold
AC
sPSTL
sEsPST
wsEf
fpw
fp ∀⎟⎟⎠
⎞
⎜⎜⎝
⎛ −= ∑∑
= =
 , 
))((
TLR
T
1t
M
1m )(),(
)(,
fLRT,w,
,
,
 
步驟六 達到最小之 TLRw,t,f 之時間 t
及製造廠 f 即為此一新批量 w
之投料時間與製造廠別。 
步驟七 於負荷堆疊模組中，將在製品
w 所需之產能堆疊至相對應的
時間、製造廠以及設備之負
荷。 
步驟八 如果有未滿足之主生產排程
需求時，則返回步驟二。 
步驟九 計算出各廠各設備於各時間
之負荷。 
 
3.2 實例說明 
3.2.1 在製品指派模組 
在製品的分佈與數量為本研究之
輸入項目。欲收集這項資訊，可藉由
現 場 監 控 系 統 、 製 造 執 行 系 統
（Manufacturing Executive System）得
知在製品的狀況。在製品為正在加工
或尚未加工完畢之批量。在製品為訂
單分配的對象，可分為目前在製品
（Current WIP）及未來在製品（Future 
WIP）。所謂目前在製品指的是於選擇
訂單分配策略前的即時在製品分佈、
狀況及數量；而未來在製品即指計劃
範圍內的未來投料的動作所產生的在
製品，亦可稱之為投料在製品（Release 
WIP）。訂單分配的目的即在於預測這
些在製品佔用設備產能或其他生產資
源的情形，並且推估未來在製品可能
的分佈及狀況。及時化生產之拉引
（Pull）觀念乃由後製程的加工需求拉
引前製程進行生產或投料動作，目的
在於最小化工廠內的半成品及存貨。 
本研究之在製品指派採用拉引之
觀念。依據各日生產計劃之需求，將
產品製程展開為一直線，由製程末端
開始逐一拉引目前線上之在製品以滿
足主生產計劃之需求。待線上在製品
皆指派完畢後，即有投料動作之發
生。圖二說明了拉引在製品的觀念。
假設產品p於day t1有20個批量之需求 
(MPSp(t1))，必須由此產品的最後一個
加工步驟（Step 300）逐一往第一個加
 7
如圖三所示，假設產品 p 之 WIP A
目前於製造廠 f 之步驟 s，步驟 s、s+1
及 s+2 之加工設備分別為 M1、M2 及
M3，各步驟之計劃開始加工時間
（PSTA(s)、PSTA(s+1)及 PSTA(s+2)），
可由產品 p於製造廠 f各加工步驟之步
驟週期時間（SCTp,f(s)、SCTp,f(s+1)及
SCTp,f(s+2)）求得，並將負荷堆疊至相
對應設備及時點，其中 BM3 表示設備
M3（批次機台）之加工批量。 
 
 
0 hr 24 hr
day tTime 
now 24 hr
M1 at 
Module f
Load 
threshold
day t
M3 at 
Module f
day t+1
Step cycle time
Step processing time
M2 at 
Module f
day t
 
PSTA(s)
day t+1
SCTp,f(s+1)
SPTp,f(s)*SizeA
Load 
threshold
Load 
threshold
SPTp,f(s+1)*SizeA
⎡ ⎤3/ MA BSize
SPTp,f(s+2)*
SCTp,f(s)
SCTp,f(s+2)
PSTA(s+1) PSTA(s+2)
 
圖三 負荷堆疊模組示意圖 
 
3.2.3 投料模組 
於在製品指派模組中，倘若對於
某一產品的日需求而言，此產品目前
的線上在製品皆已指派完畢時，則必
須經由對此產品的進行投料動作以滿
足當日及後續生產計劃要求。投料模
組用以決定投料時點及投料之製造
廠。投料模組演算法乃基於後推排程
（Backward Scheduling）及生產線負荷
平衡（Line Balancing）的觀念而發展。 
太早的投料會造成現場的過多的
在製品並進一步地增加訂單於各站的
等候時間，終將使得產品的週期時間
增加。有鑑於此，可由後推排程及產
品週期時間的資訊決定投料的最晚投
入時點。但訂單於此最晚時間點投
入，卻可能造成未來生產線負荷的不
平衡、設備的未來負荷過高、計劃時
間範圍內各天的負荷不平衡等現象。
這是因為基於無限產能的假設，以產
品的週期時間進行後推排程時，並未
考慮設備未來的負荷狀況。遵照交期
不可延遲的限制，由最晚投入日往現
在所處時間點（Time Now）的方向考
慮 可 投 入 的 日 程 ， 以 負 荷 預 堆
（Workload Pre-Accumulation）的方
式，選擇對未來設備負荷平衡最有利
的日程及製造廠以進行投料動作。其
目標乃平衡各製造廠各日間的負荷並
減少發生瓶頸設備的機會。 
圖四為 Path Load 和 Shop Load 之
示意圖並且說明此兩種模式有何不同
 9
四、結論與成果 
本計劃經由模擬所得之結果，透
過Duncan’s Test分析如表二所示，於訂
單分配策略因子中，所有績效指標均
為Path Load表現得最好。Path Load與
Shop Load均優於Random，且Path Load
亦均較Shop Load來得佳。以上結果顯
示考慮設備負荷可有效平衡各設備各
日之負荷。而Path Load精確地考量在
製品對應之設備及時點，則可達到明
顯優於Shop Load負荷平衡效果。 
圖五至圖九顯示訂單分配策略之
影響。於不同之MPS變動頻率及MPS
變動幅度下，Path Load均有最佳之表
現，且Shop Load均較Random為佳。 
以上結果顯示使用Path Load之訂
單分配策略可有效平衡各製造廠各設
備各日之負荷。 
本計劃考慮多製造廠的設備產能
與製程規格能力發展訂單分配策略，
在拉式生產系統與無限產能規劃的理
論下，決定各訂單之投料時點及投入
之製造廠。模擬的結果顯示出使用Path 
Load之訂單分配策略可有效平衡各製
造廠各設備各日之負荷。 
 
 
表二 所有績效指標之Duncan’s test 
設備日使用率超過
90%總次數 
設備日使用率超過
90%的超額量加總
值 
所有設備日使用率
標準差 
廠間設備日使用率
差異標準差平均值 
各設備日使用率標
準差平均值 訂單分配
策略 
Mean 
(amount) 
Duncan’s 
ranking 
(grouping) 
Mean 
(number) 
Duncan’s 
ranking 
(grouping)
Mean 
Duncan’s 
ranking 
(grouping)
Mean 
Duncan’s 
ranking 
(grouping) 
Mean 
Duncan’s 
ranking 
(grouping)
Path Load 1341 1 (1) 333.9 1 (1) 0.3720 1 (1) 0.1393 1 (1) 0.1248 1 (1) 
Shop Load 1554 2 (2) 422.6 2 (2) 0.3882 2 (2) 0.1727 2 (2) 0.1484 2 (2) 
Random 1632 3 (3) 705.9 3 (3) 0.4534 3 (3) 0.2546 3 (3) 0.1876 3 (3) 
 
1100
1200
1300
1400
1500
1600
1700
1800
none 1w_10 1w_20 2w_10 2w_20
Random
Shop Load
Path Load
 
圖五 訂單分配策略對設備日使用率超過90%總次數之折線圖 
200
300
400
500
600
700
800
900
none 1w_10 1w_20 2w_10 2w_20
Random
Shop Load
Path Load
 
圖六 訂單分配策略對設備日使用率超過90%的超額量加總值之折線圖 
 
0
0
