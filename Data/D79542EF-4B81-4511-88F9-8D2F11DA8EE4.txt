 1
 
中文摘要 
 
本研究計畫中，我們探討安全的群體通訊協定(secure group communication protocol)的設
計問題。在群體通訊的環境裡，使用少許的計算資源就可以同時將資料傳送到接收端，但
是應如何設計有效率的存取協定，讓合法的接收端接收廣播資訊，是這一類通訊協定的主
要挑戰。因為在廣播通訊過程當中，不是合法的接收端很有可能也會收到傳輸資料，傳送
端應該要設法保護廣播訊息的機密性。 
我們可以直接使用 IPsec (IP security)、SSL (Secure Sockets Layer),或者 TSL (Transport 
Layer Security)來對收送雙方的連線做加密的動作，但是應用這些協定需要收送雙方兩兩個
別建立安全連線，在群體通訊的環境當中，通訊的複雜度(complexity of communications)將
會隨著使用者增加呈現線性的成長( linear complexity)，系統的擴充性(scalability)會大幅度
受到限制。 
應用對稱式加密的機制，送方與收方會使用同一個金鑰來加密明文與解開密文，在群
體通訊系統理，對於確認送方身分方面，會有很大的應用限制，因為可能有許多成員擁有
同一把金鑰。如果使用類似 RSA公開金鑰加密系統來處理，會遭受到計算量太大的質疑，
針對這個問題，橢圓曲線上的公開金鑰加密系統應該會比較有實用性，而雙線性配對更是
這幾年來一個極為重要議題。 
本研究植基於雙線性配對的技術，設計了一個實用的安全廣播技術，本協定會降低公
開金鑰的憑證儲存空間，而且也會將傳輸的複雜度由線性成長降低到對數的成長。經由安
全性分析，我們所提的協定可以達到一定程度的安全水準。 
 
關鍵詞：群體通訊，雙線性配對，加密 
 
 3
 
Contents 
1. Introduction. Today server computers are capable of providing many different services for 
end users due to the vast improvement in speed and reliability of information technology. 
Broadcast service is one popular applications on Internet [10][13][16][17][20][23]. Examples of 
popular broadcast services include daily news feeds, live multi-party conferencing, video 
transmissions, and online video games. Millions of broadcast messages are transmitted to end 
users every day. Recently, users have been given the ability to upload their self made digital 
videos to servers such as YouTube and share their creations with others. If some end users are not 
authorized to access particular messages, senders should protect the confidentiality of what they 
are broadcasting. Therefore, providing an efficient method for controlling authorized access is a 
major security challenge for broadcast services. 
 
2. Purpose of the Project. Currently, the scalability of many broadcast systems will be 
degenerate as the number of end users increases. Particularly when communicating via wireless 
mediums, the scalability problem will become more serious since the available bandwidth in a 
wireless environment is much less than in a wired one. Therefore, an efficient scheme must be 
developed to improve the scalability of the system when broadcasting messages securely over 
Internet. 
Based on Boneh’s identification-based encryption from the Weil pairing [1][14], an 
innovative access protocol for secure broadcasting is investigated in this project. Bilinear pairing 
technology is used to decrease the storage of certifications and a tree structure-based encryption 
is designed to enhance the communication performance. Through a comparison made between 
the currently available encryption schemes and our proposed protocol, it will be evident that our 
proposal is more efficient and practical. 
 
3. The Related Works. Appling the available security services such as IPsec (IP security) 
[12], SSL (Secure Sockets Layer) [8], or TLS (Transport Layer Security) [5] to secure packets, 
the system can achieve the privacy requirements when transmitting messages. In the TCP/IP 
model, IPsec protocol operates at the network layer (relative to layer 3 of the OSI model) and 
SSL or TLS operates from the transport layer up to the application layer (relative to layer 4 to 7 
 5
implies that if P is a generator of G1 then ),(ˆ PPe  is a generator of G2. 
3. Computable: For all 1, GQP ∈ , the bilinear map ),(ˆ QPe  is efficiently computable. 
BDH Parameter Generator: A randomized algorithm IG is a BDH parameter generator if (1) 
IG takes a security parameter +∈Zk , (2) IG runs in polynomial time in k, and (3) IG outputs a 
prime number q, the description of two groups G1, G2 of order q, and the description of an 
admissible bilinear pairing  211:ˆ GGGe →×  described in Definition 1. 
BDH Assumption: An algorithm A has advantage )(kε  in solving the BDH problem for IG if 
for sufficiently large k: 
[ ] ).(),(ˆ),,,,ˆ,,(Pr)(Adv 21 kPPecPbPaPPeGGAA abc ε>==  
If any randomized polynomial time algorithm A solves the BDH problem with a negligible 
advantage, namely at most )(1 kf  for any polynomial [ ]xZf ∈  [6], we say that IG satisfies the 
BDH assumption and then BDH problem is difficult to solve in groups generated by IG. 
4.2. Platform Setup. The Group Controller (GC) needs to estimate the number of users in 
advance. According to the total population in some regions or the computing capability of system, 
it is reasonable to suppose the GC is able to estimate a reasonable number of participants in 
advance. Suppose the size of users is n and n is 2 to the power of some integer. As illustrated in 
Figure 1, the GC constructs a corresponding logical full binary key tree with n leaf nodes to 
manage key-encryption-keys (KEKs) for each user. 
On input a security parameter +∈ Zk , the GC runs IG to generate a prime q, two groups G1, 
G2, of order q, and an admissible bilinear pairing 211:ˆ GGGe →× . Then the GC chooses a 
random generator 1 GP∈ , picks a random number *qZs∈ , and set sPPpub = . The value of s is 
GC’s master key and it should be kept secret from others. The GC announces the system 
parameters 2121 ,,,,,ˆ,,, HHPPneGGqparams pub=  in which H1 and H2 are cryptographic hash 
functions where { } *1*1 1,0: GH →  and { }wGH 1,0: 22 →  for some w. 
 
 7
ID2.0 ID 2.1 
ID0.0 
ID1.0 
ID3.0 
ID1.1
M1 M2 
ID3.1 
ID2.2 ID2.3 
ID3.2 
M4 
ID3.3
M5 M6 M7 M8M3 
ID3.4 ID3.5 ID3.6 ID3.7 
M9 M10 M12 M13 M14 M15 M16 M11
message comes from the claimed source. After passing the verification of signature, the GC 
performs the following operations  
k
gHgHk
PMHeHgHk
sPMHeHgHk
PMHeHgHk
rPMsHeHgHk
r
M
r
M
r
pubi
r
M
r
i
r
M
sr
i
r
M
i
r
M
ii
i
i
i
i
=
⊕⊕=
⊕⊕=
⊕⊕=
⊕⊕=
⊕⊕
)()(
))),((ˆ()(
))),((ˆ()(
))),((ˆ()(
))),((ˆ()(
22
122
122
122
122
 
to obtain the secure session key k and outputs message m by decrypting )(mEk  using the k. 
The GC then stores the digital creations produced by users to its multimedia database. As 
depicted in Table 1, the GC records each member’s digital creations and the related subscribers. 
Each member can choose the creations he likes and subscribes them to the GC. For lower storage 
requirements, Table 1 should be normalized to three smaller tables to reduce the redundancy 
problem as depicted in Figure 3. With these normalized tables, the GC can perform the 
corresponding join operations to reconstruct Table 1. 
 
 
 
FIGURE 2. A key tree T with height equal to four for managing sixteen members 
 
 
 9
Members’ digital creations and their subscriptions are listed in Table 2. With the structure of key 
trees, the computational complexity and the bandwidth needed for transmission decreases 
dramatically at the same time. 
 
TABLE 2. Digital creations and the related subscribers in a sixteen-member group 
Members Digital Creations Subscribers 
C1,1 { M1, M2, M3, M4, M5, M6, M7 } 
M1 
C1,2 { M1, M2, M3, M4, M5, M6, M11, M12, M16 } 
M4 C4,1 { M2, M4, M5, M6, M7, M9, M10, M11, M12 } 
M6 C6,1 { M9, M11 } 
M7 C7,1 { M5, M6, M7, M8 } 
M8 C8,1 { M1, M3, M9, M10, M11, M12 } 
M9 C9,1 { M1, M2, M3, M4 } 
M10 C10,1 { M5, M7, M8, M13, M14, M15 } 
C11,1 { M1, M2, M5, M6, M11, M12 } 
M11 
C11,2 { M1, M2, M5, M6, M11, M12, M13, M14, M15} 
M12 C12,1 { M1, M3, M4,M6, M13, M14, M15, M16 } 
C16,1 { M1, M2, M3, M4, M5, M6, M7, M8 } 
C16,2 
{ M1, M2, M3, M4, M5, M6, M7, M8, M13, M14, M15, 
M16 } 
M16 
C16,3 { M1, M2, M3, M7, M8, M13, M14, M15 } 
 
For a given set R of receivers in a secure distribution, the GC should encrypt each digital 
creation to prevent unauthorized access. First, the GC chooses a random number *qZr ∈ . The 
revoked users, denoted by R , should not be allowed to recover the encrypted message. 
According to [15], we redesign a revocation scheme which is tailor-made to the proposed 
distribution scheme by using bilinear pairing. Let the notation T indicate the key tree we have 
constructed in the Platform Setup section and the notation RT  indicate the minimal subtree of 
the tree T that connects all the leaves in R . The GC encrypts session key k with the 
corresponding public keys and sends the message 
SigmEgHkgHkrPjiji k
r
Sid
r
Sidww wjwiji
),()],(,),(,[),,(,),,(
.1.1 2211
⊕⊕ KK  (1)
 11
encryption operations again.  
Upon receiving the message (2), the users }7,,2,1|{ K=iMi  are legal receivers in this 
transmission. According to Figure 2, the users },,,{ 4321 MMMM  can find the index of their 
public key Sid2.0 belongs to receiver indices { }7),2,3(),0,2( M . Then they extract the 
corresponding private key )( 0.21 SidsH  and compute  
k
gHgHk
PSidHeHgHk
sPSidHeHgHk
PSidHeHgHk
rPSidsHeHgHk
r
Sid
r
Sid
r
pub
r
Sid
rr
Sid
srr
Sid
r
Sid
=
⊕⊕=
⊕⊕=
⊕⊕=
⊕⊕=
⊕⊕
)()(
))),((ˆ()(
))),((ˆ()(
))),((ˆ()(
))),((ˆ()(
0.20.2
0.2
0.2
0.2
0.2
22
0.2122
0.2122
0.2122
0.2122
 
to obtain the secure session key k and output the message m by decrypting )(mEk  using the 
k. Similarly, the user M7 can find the index of the key M7 in his KEKs belongs to 
{ }7),2,3(),0,2( M , then M7 extracts the corresponding key )( 71 MsH  and computes 
))),((ˆ()( 7122 7 rPMsHeHgHk
r
M ⊕⊕  to obtain the secure session key k and outputs message m 
by decrypting )(mEk  using the k. The users M5 and M6 use the key )( 2.31 SidsH  extracted from 
their KEKs to decrypt the session key k and recover the encrypted message broadcasted from the 
GC. During this session, the revoked users }16,,9,8|{ K== jMR j  cannot decrypt the 
message from the GC since the index in their KEKs does not include any one of the receiver 
indices, { }7),2,3(),0,2( M . 
For the content 2,16C , the receivers set is }16~13,8~1|{ == iMR i  and the revocation set 
}12~9|{ == jMR j . Figure 5 shows that 0.1Sid and 3.2Sid  are all the root nodes of the subtrees 
in }\{ RTT  whose roots are adjacent to nodes of outdegree 1 in RT . The GC uses the public key 
of },{ 3.20.1 SidSid  to encrypt the session key k and then transmits the message to receivers 
SigmEgHkgHkrP k
r
Sid
r
Sid ),()],(),(,[)],3,2(),0,1[( 3,20.1 22 ⊕⊕  
(3)
who request to download the digital content 2,16C . Only the valid receivers 
}16~13,8~1|{ =iMi  can recover the encrypted content properly since they have the related 
private key )( 0.11 SidsH  or )( 3.21 SidsH . 
 13
5.2. Guessing the Private Key Used in Bilinear Pairing. In mathematics, the bilinear pairing 
can be constructed by means of functions on an elliptic curve [3][9][14]. Compared to other 
public key cryptosystems such as RSA algorithm [18] or Elgamal algorithm [7], the elliptic curve 
cryptography (ECC) requires less storage, less power, and less bandwidth. National Institute of 
Standards and Technology (NIST) guidelines state that ECC keys should be twice the length of 
equivalent strength symmetric key algorithms. Using a 256-bit ECC key has the roughly same 
strength as a 128-bit AES key [25]. 
5.3. Users’ Collusions. Malicious or compromised users may share their secret KEKs with others 
and cooperate to determine all the KEKs used for the system. If the adversary deduces all the 
secret node keys, he can easily recover the corresponding session key for each broadcast.  Since 
the GC does not change any KEKs after the system setup phase is done, our scheme may not be 
secure against colluding attacks. There are two solutions to this problem. In the system setup 
phase, the GC can store the corresponding subset of KEKs into a tamper-proof device like the 
smart card and give the device to each user. By means of this tamper-proof device, adversaries 
will not know any its stored secrets. Another solution is to employ the “Tracing Traitor” 
technique [4][11][19]. The GC can trace the malicious or compromised members and then revoke 
the traitors’ access right in future broadcasts. 
 
6. Discussions (Our Contributions). Compared with other tree-based communication 
schemes, Wong et al.’s LHK (Logical Key Hierarchy) scheme [24] and Canetti et al.’s OFC 
(One-way Function Chain) scheme [2] , our proposal has better performance when group 
members are added or deleted by the GC. In LHK and OFC, whenever a member leaves or joins, 
the current private KEKs which he shares with other members need to be updated for security 
concerns. The computation cost is )(log2 nO  since they need )(log2 nO  KEKs to encrypt the 
new secure session key. With our proposed scheme, group members can be easily added or 
deleted by the system. As mentioned in the system setup phase of our proposal, the GC needs to 
estimate the number of users in advance. The estimated number should be sufficiently large to 
allow for the addition of new users. Suppose that the maximum number of users is estimated to 
be n. Since the value of n may not be exactly 2 to the power of some integer, the GC should 
construct a full binary tree with a depth equal to ⎡ ⎤)log2 n  . The present users are associated with 
the leaf nodes starting from the far left side of the key tree. After the system setup phase is 
completed, a new user can be easily added to our scheme. The GC just selects a leaf node which 
is not owned by any present users and assigns a corresponding subset of KEKS to the new user. 
Therefore, the computation overhead of user addition is O(1). 
 15
References 
 
[1] D. Boneh and M. Franklin, Identity based encryption from the Weil pairing, SIAM Journal 
on Computing, vol.32, no.3, pp.586-615, 2003. 
[2] R. Canetti, J. Garay, G. Itkis, D. Micciancio, M. Naor and B. Pinkas, Multicast security: a 
taxonomy and some efficient constructions, Proc. of INFOCOM ’99, vol.2, pp.708-716, 
1999. 
[3] Y. J. Choie and E. Lee, Implementation of Tate pairing on hyperelliptic curves of Genus 2, 
Lecture Notes in Computer Science, vol.2971, pp.97-111, 2004. 
[4] B. Chor, A. Fiat, M. Naor and B. Pinkas, Tracing traitors, IEEE Transactions on Information 
Theory, vol.46, iss.3, pp.893-910, 2000. 
[5] T. Dierks and C. Allen, The TLS Protocol Version 1.0, IETF RFC 2246, January 1999. 
[6] X. J. Du, Y. Wang, J. H. Ge and Y. M. Wang, An id-based broadcast encryption scheme for 
key distribution, IEEE Transactions on Broadcasting, vol.51, no.2, pp.264-266, 2005. 
[7] T. Elgamal, A public key cryptosystem and a signature scheme based on discrete logarithms, 
IEEE Transactions on Information Theory, vol.31, iss.4, pp.473-481, 1985. 
[8] A. O. Freier, P. Karlton and P. C. Kocher, The SSL Protocol Version 3.0, IETF Internet Draft, 
March 1996. 
[9] S. D. Galbraith, K. Harrison, and D. Soldera, Implementing the Tate pairing, Lecture Notes 
in Computer Science, vol.2369, pp.324-337, 2002. 
[10] S. Hirakawa, N. Sato and H. Kikuchi, Broadcasting satellite services for mobile reception, 
Proc. of the IEEE, vol.94, iss.1, pp.327-332, 2006. 
[11] H. X. Jin, J. Lotspiech and S. Nusser, Traitor tracing for prerecorded and recordable media, 
Proc. of the 4th ACM Workshop on Digital Rights Management, pp.83-90, 2004. 
[12] S. Kent and K. Seo, Security Architecture for the Internet Protocol, IETF RFC 4301, 
December 2005. 
[13] W. K. Lai, C. S. Shieh and Y. C. Kuo, Reliable broadcasting in ad hoc wireless networks 
with MAC mini-slots and directional antennas, International Journal of Innovative 
Computing, Information and Control, vol.3, no.6(A), pp.1487-1500, 2007.  
[14] V. S. Miller, The Weil pairing and its efficient calculation, Journal of Cryptology, vol.7, no.4, 
pp.235-261, 2004. 
[15] D. Naor, M. Naor and J. Lotspiech, Revocation and tracing schemes for stateless receivers, 
Advances in Cryptology-CRYPTO 2001, pp.41-62, 2001. 
[16] Y. Nishimoto, A. Baba, T. Kurioka and S. Namba, A digital rights management system for 
digital broadcasting based on home servers, IEEE Transactions on Broadcasting, vol.52, 
iss.2, pp.167-172, 2006. 
[17] S. Rafaeli and D. Hutchison, A survey of key management for secure group communication, 
ACM Computing Surveys, vol.35, iss.3, pp.309-329, 2003. 
[18] R. Rivest, A. Shamir, and L. Adleman, A method for obtaining digital signatures and public 
key cryptosystems, Communications of the ACM, vol.26, iss.1, pp.96-99, 1983. 
[19] R. Safavi-Naini and Y. J. Wang, Sequential traitor tracing, IEEE Transactions on 
 17
計畫成果自評 
The project has investigated some papers about the topics on secure group communications. We 
have proposed a new tree-based access scheme for secure distributing digital content in this 
project. By employing the bilinear mapping functions, the proposed protocol reduces the storage 
requirements of certificates in the public key infrastructure (PKI). Also, the computation and 
communication overhead are decreased dramatically by using a full-binary-tree keying technique. 
Since the storage, computation, and communication complexity are improved as compared with 
the available encryption protocols, our proposal is effective and practical for real-life 
applications. 
 
Publications: 
1. R.H. Lin and J.K. Jan, Broadcast Yourself Securely: Enhanced Transmission Scheme for 
Sharing Digital Creations, International Journal of Innovative Computing, Information and 
Control, Vol.5, No.5, 2009, PP.1379-1394. [SCI] 
2. R.H. Lin and J.K. Jan, An Innovative Revocation Scheme for One-to-many E-services, 
Electronic Commerce Research and Applications, Vol.6, Iss.3, 2007, PP.358-363. [SCI]  
3. R.H. Lin and J.K. Jan, A Tree-Based Scheme for Security of Many-to-Many Communications, 
Journal of High Speed Networks, Vol.16, No.1, 2007, PP.69-79. [SCI] 
 
〈三〉 會議論文集由 IEEE 出版社出版，其中優秀論文將被推薦到 SCI 或 EI 檢索的國
際期刊發表。 
〈四〉 整個會議主題是資訊安全,所有講者所專長者卻又呈現理論或應用面之多樣性,
確實有互相交流之實際性。 
 
對專題演講之心得簡述如下： 目前資訊安全系統之研究涵蓋範圍已然無遠弗屆;
第一位來自美國的 Marios M. Polycarpou 教授以其在 KIOS Research Center for Intelligent 
Systems & Networks 之研究績效出發,闡明如何將攸關人類社會生活必需之電力系統、交
通系統、水利系統與資訊網路安全聯結以達實用性。要言之,如何在系統越來越異質化
與分散式化困難中,有效偵測資訊安全之問題,並且隔絕與辨認之,並有效給予處理。第二
位來自新加坡大學的 Shuzhi Sam Ge 教授也就”自適應控制系統”之研發給予詳實之引介,
與第一位講者之論點有相當關連性。我國的資訊安全學界名師張真誠教授亦在 invited 
speakers 之列,張教授主講”A New Classification Mechanism for Retinal Images”, 對視網
膜之辨識,張教授新近有獨到之見解;他應用 PCA(Principle Component Analysis)正規化
retinal images 而取得高效率辨識(97.52%)之成效。與會者對此研究相當有興趣,因此發問
相當踴躍。 
本人發表的研究報告是『對於類似 Bit-Torrent 之 P2P 系統重新設計以符實用性之
數位產權管理機制』(A Feasible DRM Mechanism for BT-like P2P System),此新協定設計由
A Feasible DRM Mechanism for BT-like P2P System  
 
Yu-Yi Chen 
Department of Management 
Information Systems 
National Chung Hsing Uni-
versity 
Taichung, Taiwan 
chenyuyi@nchu.edu.tw 
Jinn-Ke Jan 
Department of Computer Sci-
ence and Engineering 
National Chung Hsing Uni-
versity 
Taichung, Taiwan 
jkjan@cs.nchu.edu.tw 
Yo-Yu Chi 
Department of Computer Sci-
ence and Engineering 
National Chung Hsing Uni-
versity 
Taichung, Taiwan 
s9256006@nchu.edu.tw 
Meng-Lin Tsai 
Department of Computer Sci-
ence and Engineering 
National Chung Hsing Uni-
versity 
Taichung, Taiwan 
s9656046@nchu.edu.tw
  
Abstract—Bit-Torrent is the most popular peer-to-peer software 
because of its efficiency for distributing files. However, Bit-Torrent 
file sharing is infamous for copyright infringement, making the estab-
lishment of rights management technologies an urgent need. In this 
paper, we propose a Digital Rights Management (DRM) mechanism 
to protect the copyright in Bit-Torrent. It will be a novel business 
model of DRM system. It enables large-scale distribution of copy-
righted digital content in P2P network. Anyone can be the content 
provider to distribute his creation efficiently and securely. 
Keywords—Digital Rights Management; P2P; Bit-Torrent; 
Copyright; Security 
Introduction  
There are many researches [3,4,5,7,8,9,10] about DRM sys-
tems applicable to P2P content delivery. It is an interesting 
research to enable DRM mechanism on a P2P network. In 
many P2P file-sharing mechanisms, Bit-Torrent(BT) [2] is one 
of scalability and efficiency for content distribution to attract 
millions of users. As reported in June 2004 [6], P2P traffic 
makes up 80% traffic on the Internet, in which the share of BT 
is 53%. However, existing BT-like systems do not provide 
copyright protected mechanisms. In 2008, Zhang et al. [10] 
proposed a Bit-Torrent based DRM system. Any peer can take 
part in the content distribution while only legitimate peers can 
access the plaintext of content. 
As we know, an object file will be divided into many pieces 
before distributing in Bit-Torrent. Then object owner makes a 
seed (torrent file) that contains information about the object 
file (file name, length, etc.), hash values of all pieces, and 
tracker sites’ URLs. This seed will indicate how to download 
the content by the assistant of tracker sites. Tracker sites re-
spond with a list of active peers where pieces of the file are 
available. According to the list, peers can exchange their 
pieces in parallel by themselves. Therefore, Bit-Torrent sys-
tems are scalable and efficient for Internet content distribution. 
With Zhang’s scheme, the content via BT can be securely pro-
tected. However, there are two disadvantages in Zhang’s de-
sign as follows. 
 The peers cannot exchange their pieces in parallel only 
by themselves. The tracker site is involved in each ex-
change, and it is responsible to generate the 
re-encryption [1] key to make a piece be transferred 
from 
 
a peer to another peer securely. However, the loading 
of a peer to re-encryption key’s generation will make 
the tracker site to be the bottleneck. The result shows 
that their scheme cannot efficiently enforce copyright 
protection with reasonable performance overhead. 
 Since the tracker site is involved in each exchange, it is 
responsible maintains a lot of parameters. It will re-
strict the service scale of the tracker site. 
In this paper, we redesign the Zhang’s mechanism to avoid the 
above problems. Additional, we extend Zhang’s design into a 
new business model of DRM system. To design a secure DRM 
system in BT environment, it should be considered that any 
communication transmitted between uploading and 
downloading parties should be protected. Also, it needs to 
avoid a compromised peer or the collusion among peers 
threatening the entire system. In order to satisfy the above 
demands, we need to achieve the following five goals: 
 Confidentiality of data communication: During the 
communication between any two peers, the plain piece 
of the content should be protected to prevent from 
eavesdropping through the communication channels. 
 End-to-end content secrecy: Whatever a cipher block is 
distributed from one peer to another peer, the cipher 
block only can be decrypted by the legal buyer. 
 Immune from passive attacks with intercepted message: 
The communication between peers and the tracker site 
should be secure. Any middle node cannot derive any 
plain piece from the communication. 
 Immune from compromised peers: By compromising a 
peer, an attacker can get this peer’s license information 
Step2: The tracker site should provide the list of all peers 
which hold some blocks of the content. 
Step3: Suppose the peer SN  is selected, it is requested to 
provide the bth block. 
Step4: The peer SN  just needs to forward the copy of the bth 
cipher block bC  to the peer RN . 
Purchase Phase 
After downloading all cipher blocks, the download peer must 
get the corresponding license from the original peer. There is a 
trust C2C payment gateway(CPG) involved in the following 
trading process. As the CPG confirms the payment from the 
download peer, it will acknowledge the original peer to release 
corresponding license. Then the download peer can use this 
license to decrypt the cipher blocks. The procedure of this 
phase is shown in figure2. 
Figure 2.   Content Blocks Distribution Phase 
Step1: As the download peer RN  has got all cipher blocks of 
a content which’s serial number is SN , it should pro-
vide the message ), , , ,( RRO YNNSN  to the origi-
nal peer ON  for purchasing the content with price 
 . The payment of this purchase is supposed to be 
confirmed by the CPG. Therefore, the above purchase 
message should be sent to the CPG firstly. 
Step2: According to the price  , the CPG deducts the amount 
from the account of the peer RN . Then the CPG for-
wards the message ), , , ,( RRO YNNSN  to the 
original peer ON . 
Step3: According to the serial number SN , the corresponding 
random number z  will be retrieved. Then the origi-
nal peer can generate the following two values R  
and  . 
 pYY zO
z
RR   )( / )( mod 　 　　　 
 pg z  mod  　 　　　 
The values R  and   will be involved in the li-
cense for the peer RN . The license is provided to the 
CPG firstly. 
Step4: As the CPG receives the license, it forwards the license 
to the peer RN  and disburses the payment to the ac-
count of the peer ON . 
Content Decryption Phase 
After the download peer paid for getting the license, it get the 
corresponding R  and  . With the correct private key RX  
of the peer's DRM-enabled application, the content decryption 
key K  can be derived as follows. 
Then the peer's DRM-enabled application can use the content 
decryption key K  to decrypt all cipher blocks bC ( nb ~1 ) 
as follows. 
The DRM-enabled application is supposed to be tamper-proof, 
it cannot be supposed to be compromised to get its private key. 
Therefore, the license can be only used by the download peer’s 
DRM-enabled application for deriving the content decryption 
key to decrypt the cipher blocks. 
Analysis 
In this section, we demonstrate our scheme achieves the secu-
rity properties mentioned in section 1. 
 Confidentiality of data communication: In step 4 of the 
content blocks distribution phase, the content is pro-
tected during the communication between any peers. 
The cipher block bC  cannot be decrypted without the 
corresponding R ,  , and RX . Even if the values 
R  and   are just attached in the license such that 
anyone can intercept these values in step 3 of the pur-
chase phase. The attacker cannot take advantage of the 
communication without knowing the correct private 
key RX  of the peer's DRM-enabled application. 
Therefore, during the communication between any two 
peers, the eavesdropping is useless in our scheme. 
fluenced by securely distributing the content in our system. In 
addition, we expand Zhang’s design into a novel model of 
DRM. It enables large-scale distribution of copyrighted digital 
content in P2P network. Anyone can be the content provider to 
distribute his creation efficiently and securely. 
References 
[1] G. Ateniese and S. Hohenberger, “Proxy Re-Signatures: 
New Definitions, Algorithms, and Applications”, The 
12th ACM Conference on Computer and 
Communications Security (ACM CCS’2005), 2005, pp. 
310-319. 
[2] B. Cohen, “Incentives Build Robustness in BitTorrent”,  
Proceeding of the 1st Workshop on Economics of 
Peer-to-Peer Systems, 
http://www.bittorrent.com/bittorrentecon.pdf (2003) 
[3] T. Iwata, T. Abe, K. Ueda, and H. Sunaga, “A DRM 
System suitable for P2P Content Delivery and The Study 
on Its Implementation”, The 9th Asia-Pacific Conference 
on Communications (APCC 2003), 2003, vol. 2, pp. 
806-811. 
[4] T. Kalker, D. H. J. Epema, P. H. Hartel, R. L. Lagendijk, 
and M. Van Steen, “Music2Share-Copyright-Compliant 
Music Sharing in P2P System”, Proceedings of the IEEE, 
2004, vol. 92, no. 6, pp. 961-970. 
[5] X. Lou, K. Hwang, and R. Zhou, “Integrated Copyright 
Protection in Peer-to-Peer Networks”, 27th International 
Conference on Distributed Computing Systems 
Workshops (ICDCSW’07), 2007, pp. 28. 
[6] A. Parker, “The True Picture of Peer-to-peer Filesharing”,  
CacheLogic, 2004, http://www. cachelogic.com. 
[7] A. Sui, Y. Wang, R. Lu, and C. Yang, “A Trust Model 
based DRM Technology on Distributed P2P and IPv6 
Networks”, IEEE Swarm Intelligence Symposium (SIS 
2007), 2007, pp. 366-370. 
[8] J. Y. Sung, J. Y. Jeong, and K. S. Yoon, “DRM Enabled 
P2P Architecture”, The 8th International Conference on 
Advanced Communication Technology (ICACT 2006), 
2006, pp. 487-490. 
[9] S. Xiao, Z. Lu, and H. Ling, “A Trust Scheme Based 
DRM Model for P2P System”, Wuhan University Journal 
of Natural Sciences, 2006, vol. 11, no. 5, pp. 1373-1377. 
[10] X. Zhang, D. Liu, S. Chen, Z. Zhang, and R. Sandhu, 
“Towards Digital Rights Protection in BitTorrent-like P2P 
Systems” The 15th SPIE/ACM Multimedia Computing 
and Networking (MMCN’08), San Jose, CA USA, 2008. 
