Fourier transforms 
and Gabor filters have been proposed. This project 
have developed a quaternion Gabor filter combined to 
the BEMD of color image can be applied to the  
color image segmentation.   
 
英文關鍵詞： Bidimensional Empirical Mode Decomposition、 Color 
Image Empirical Mode Decomposition、 Quaternion Gabor 
Filter、Quaternion Analytic Signal、 
 
I. 中英文摘要
中文摘要
在本計畫我們發展了複數訊號之二為經驗模式分解，該方法可用來針對彩色影像與核磁共振信
號進行經驗模式分解。而所發展的方法已證實可應用在彩色影像的各種分析應用上。
除了彩色影像的經驗模式分解外，我們還利用二維經驗模式分解與四元數賈柏濾波器進行
彩色影像材質分割。選用此二個工具的原因主要在於利用二維經驗模式分解具用將影像分解為
局部窄帶的能力，以及四元數賈柏濾波器能直接使用色彩資訊，而能得到較好的材質分割結
果。
四元數應用於彩色影像處理已有相當長的一段歷史，各種四元數傅立葉轉換與四元數賈伯
濾波器圴已陸續開發完成。本計畫發展出一種適用於彩色影像分割之四元數賈柏濾波器，並結
合彩色影像經驗模式分解對彩色材質影像進行分割。
Abstract
In this project, we have developed the bidimensional empirical mode decomposition (BEMD)
for the complex signal. The method can be applied to the color images and 2D NMR signals.
It has been proved that the developed method can be applied to the various analysis methods of
color images.
Besides the development of empirical mode decomposition of color image, we has also
applied the developed method and the quaternion Gabor filter for the segmentation of textures of
color images. Since the Gabor filters can solve the interference of various frequencies in images,
these two signal processing tools could be used to have better results for texture segmentation.
i
II. 關鍵詞
中文關鍵詞
二維經驗模式分解、彩色影像經驗值分解、四元數賈柏濾波器、四元數解析信號、材質分割
Keywords
Bidimensional Empirical Mode Decomposition、Color Image Empirical Mode Decomposi-
tion、Quaternion Gabor Filter、Quaternion Analytic Signal、texture Segmentation
iii
2. 研究目的
本研究計畫之研究目的主要有三
1. 發展彩色影像之經驗模式分解，以為後續之各種影像分析應用。
2. 發展出四元數賈柏濾波器，以進行彩色影像紋理分割。
3. 結合彩色影像經驗分解與四元數賈柏濾波器，提出具有較佳效果之紋理分割技術。
3. 文獻探討
中研院黃鍔院士(1998)提出了以經驗模態分解法(Empirical Mode Decomposition, EMD) 為
基礎的希爾柏特─黃轉換(Hilbert-Huang Transform, HHT)[1]經驗模式分解(Empirical Mode
Decomposition ,EMD)[1]是一種新穎的時頻分析工具，其分解完全由數據驅動，可以自適應
地通過篩選過程(sifting)將信號分解成局部窄帶的各個內蘊模式函數(Intrinsic Mode Function
,IMF)。EMD分解對於非線性和非平穩信號的處理有獨特的優勢，已經在一維信號慮理中得到
了廣泛的應用。
希爾柏特-黃轉換已成功地應用在地震工程、醫學工程氣象科學等許多問題上，許多
希爾柏特-黃轉換的應用陸續被開發出來。而二維訊號經驗模式分解通常被稱為BEMD
(Bidimensional Empirical Mode Decomposition)。在2003 年Nunes 將提出BEMD 的構想，
使EMD在影像處理上的應用向前邁進了一步[2]。
BEMD的實現關鍵同樣在於極值點的獲取和包絡曲面(envelope surface)的擬合方式。基於
三角形剖分插值方法[3]和基於徑向基底函數插值(radial basis function interpolation)[2]方法
是目前研究人員常用的兩種二維插值方法。關於這兩種插值方式我們做一簡單說明
三角形剖分插值： 三角形剖分插值是將研究區域分割成簡單的小三角形區域，稱
2
4. 研究方法
本計劃主要分成兩部分：
1. 彩色影像之經驗模式分解
2. 四元數賈柏濾波器之彩色影像材質分割。
在底下的章節中我們將先介紹彩色影像的經驗模式分解，然後介紹四元數賈柏濾波器之彩
色影像材質分割。
4.1 彩色影像的經驗模式分解
關於彩色影像表示方式中，最常使用的即為RGB座標
i(x, y) =

r(x, y)
g(x, y)
b(x, y)

其中r(x, y)，g(x, y)與b(x, y)分別代表影像在(x, y)畫素位置的RGB值。然色彩色影像除
了RGB外，常見的方式尚有IHS、YUV,HSV、HSL。CIE-La∗b∗等色彩表示法。雖然表示法
眾多，最主要仍以RGB、IHS與CIE-La∗b∗為主。
RGB色彩座標 將彩色影像中的每一個像素的紅、綠、藍成份，分別用一個二維矩陣表示。
IHS色彩座標 依照人眼視覺系統，將彩色影像分解成灰階成分(luminance)與色彩成分(chrominance)[19]。

l
u
v
 =

1
3
1
3
1
3
− 1√
6
− 1√
6
2√
6
1√
2
− 1√
2
0


r
g
b
 (1)
4
i(x, y)
RGB → IHS
c(x, y)l(x, y)
BEMD Complex-BEMD
l(k)(x, y) c
(k)
1 (x, y), . . . , c
(k)
4 (x, y)
(a)BEMD for color images
l(k)(x, y) c
(k)
1 (x, y), . . . , c
(k)
4 (x, y)
Inverse BEMD
Inverse complex-
BEMD
c(x, y)l(x, y)
IHS → RGB
i(x, y)
(b)inverse BEMD for color images
Figure 2: The block diagrams for the BEMD and inverse BEMD of color images
4.1 .1 複數BEMD
在[6]中，我們利用二維信號的完全希爾伯特轉換total 2D Hilbert transform與部分希爾伯特轉換(partial
2D Hilbert transforms)[?]，將二維複數分前成四個解析信號(analytic signals)，分別對應到正
負頻率四個象限。在[6]中，我們更進一步將四個象限的複數解析信號，取實部或虛部而得
到四個二維實數信號，而此四個實數信號即可完美重建回到原本的二維複數信號，証明詳
見[6]。對於此四個二維實數信號，我們可採用傳統的BEMD方法而得到四組IMF與residue，
即已達成複數之BEMD。圖3即說明了complex BEMD的方法。
二維複數EMD分解其詳細演算法如Algorithm 1所列。演算法中的FQO(First quadrant
operation)為一個取得頻譜中第一象限及其相鄰座標軸之運算子。該運算可用空間域之部分與
完全希爾伯特轉換，或頻率上乘上遮罩而完成。圖??中的2D Hilbert transform實乃包括完全
與部份希爾伯特轉換，亦即執行演算法1中，頻域上之遮罩A。
圖4所示為前面之青椒影像灰階部分進行傳統BEMD所得到的IMF與residue結果；圖5所
顯示為四組IMF合併而得到色彩成分的IMF 與色彩成分的residue。可清楚地觀察圖5就如同
圖4灰階的IMF是由高頻漸次到達低頻，而最後的residue則顯示出整個影像改變的趨勢。
6
c(x, y)
2D Hilbert
transforms
q4(x, y)
q3(x, y)
q2(x, y)
q1(x, y)
real(·)
imag(·)
imag(·)
real(·)
BEMD
BEMD
BEMD
BEMD IMF1
IMF2
IMF3
IMF4
四實數分解
Figure 3: Complex BEMD之方塊圖
4.2 彩色影像紋理分割
關於彩色影像材質分割採用的方法乃參考論，底下步驟進行彩色影像材質分割
步驟1： 將彩色材質影像做color BEMD分解，取得其IMF1影像
步驟2： 將原彩色影像減掉IMF1
步驟3： 決定四元數Gabor濾波器參數，而得到濾波器組
步驟4： 將步驟2所得結果進行Gabor濾波組濾波
步驟5： 計算各個像素的對賈伯濾波器組濾波結果所得之norm
步驟6： 計算各個像素之sigmodal函數。
步驟7： 將濾波結果進行高斯視窗平滑化
步驟8： K-mean cluster分群
處理方法方塊圖參見6
8
(a)IMF 1 (b)IMF 2 (c)IMF 3
(d)IMF 4 (e)IMF 5 (f)IMF 6
(g)IMF 7 (h)Residue
Figure 5: The IMFs and residue for the chrominance of Pepper image
10
其傅立葉轉換為
Ψ(ω) = e−
σ21
2
(ω1−u0)2−σ
2
2
2
ω22 + e−
σ21
2
(ω1+u0)2−σ
2
2
2
ω22
雙變異數高斯、單複指數調變 在[12]使用底下定義
ψ(x) =
1
2piσ1σ2
e
− 1
2
[(
x1
σ1
)2
+
(
x2
σ2
)2]
ej2piu0x1 (19)
其傅立葉轉換
Ψ(ω) = e−
σ21
2
(ω1−u0)2−σ
2
2
2
ω22
此定義類似於A.K. Jain所定義，但濾波器本身為複數濾波器
單變異數+比例高斯 [21]
ψ(x, y) = exp
(
−x
′2 + γ2y′2
2σ2
)
cos
(
2pi
x′
λ
+ φ
)
其中(x′, y′) = (x cos θ + y sin θ,−x sin θ + y cos θ)為(x, y)經過旋轉後之座標。
• γ: 為x-y方向比例。
• σ為高斯視窗g(x, y)的寬窄度，
• θ: 方向
• λ為波長，f = 1
λ
為Gabor filter的頻率中心
• φ: phase shift
12
其中µ為pure quaternion[13]
本計畫不採用現有四元數賈柏濾波器之定義，而綜合式子19[12]與20[15]所設計的另一種四元
數賈柏濾波器。
ψq(x, σ1, σ2) = e
µu0x1e
− 1
2
[(
x1
σ1
)2
+
(
x2
σ2
)2]
(21)
其中µ = 1√
3
(i+ j + k)。利用調整改變調變頻率u0與對賈柏濾波器進行旋轉兩個動作，可產生
賈柏濾波器組。
我們採用式子(21)作為我們選定的賈伯四元數濾波器的原因有
1. 賈柏濾波器在影像分割與分類的應用上，多採用單一方向進行調變。至於另一方向的頻
率變化可透過將濾波器旋轉完成。這樣的設計對頻率選定較為簡單。
2. 此方法所使用的計算軸µ = 1√
3
(i + j + k)，為彩色影像灰階成分。透過四元數傅立葉轉
換性質[17][18]，可將其分割成兩個複數賈柏濾波器。
在圖6中，我們使用了兩個複數賈柏濾波器來完成四元數濾波器
4.2 .2 參數設定
當我們利用Gabor濾波器進行影像材質分析時，必須將Gabor濾波器中的參數做設定，現有論
文中對參數設定方式可直接用於四元數Gabor濾波器。在此我們頻率選擇目前主要有兩種方法
採用[24]的方法
FL(i) = 0.25− 2i−0.5/N
FH(i) = 0.25 + 2
i−0.5/N
14
4.2 .4 K-mean影像分群
分群乃按照資料之間的差異性，將資料分組。一筆資料只屬於某一組，相似資料歸類於同一
組。每一組稱作一個「群集」。當我們抽取完彩色影像特徵後必須對影像進行分群，判斷哪些
影像像素係屬於同一區塊。
在文獻上可使用的分群方法有許多[26]。K−mean 分群方法是一種常見的資料分群方
法[27]。其步驟略述如下
1. 設定群集數量為k ，隨機散佈k 個點作為群集中心（常用既有的點）。
2. 每一點分類到距離最近的群集中心（常用直線距離）。
3. 重新計算每一個群集中心（常用平均值）。
4. 重複二與三，直到群集不變、群集中心不動為止。最後形成Voronoi Diagram。
在圖6的最後一個步驟，特徵抽取結果透過k-mean clustering的協助，而影像分割完成。
5. 結果與討論
5.1 彩色影像二維經驗模式分解
圖4所示為前面之青椒影像灰階部分進行傳統BEMD 所得到的IMF 與residue 結果；圖5所
顯示為四組IMF合併而得到色彩成分的IMF 與色彩成分的residue。可清楚地觀察圖5就如同
圖4灰階的IMF是由高頻漸次到達低頻，而最後的residue 則顯示出整個影像改變的趨勢。
在[6][28]中我們將所提出的彩色影像分析方法成功地應用在另一個應用彩色影像融合上。結果
參見圖7。
16
圖8與9顯示了不同方法所得之材質分割結果。使用了經驗模式分解與賈柏四元數濾波器的
效果最好。但由於測試影像的分割難度有點高，所得結果仍有改進空間。
5.3 討論
本計畫之第一部分：彩色影像的經驗模式分解，乃是開發了複數二為信號的經驗模式分解。此
方法不僅可適用於彩色影像之分析，尚可利用於任何二維複數信號(如：NMR)之分析。當我們
應用所提出的方法進行彩色影像分析時，所得到色彩成分的IMF與色彩成分的residue就如同
灰階的IMF是由展現出高頻漸次到達低頻之現象，而最後的residue則顯示出整個影像改變的
趨勢。在[6][28]中我們將所提出的彩色影像分析方法成功地應用在另一個應用彩色影像融合
上。
色彩資訊為重要特徵，未使用色彩特徵無法得到滿意的分割效果。從我們實驗中可清楚看
出加入色彩資訊可得到較滿意的分割結果。
在本計畫之結果所得之結果會出現紋理中間的不連續部分常會成獨立區塊之現象，在此我
們作一討論。本計畫利用賈柏濾波器進行紋理分割屬於非監督式(unspervised)之方法，亦即未
先對訓練即進行影像分割。如此所得到的結果通常較監督式(先進行影像分割訓練)者為差。在
賈柏濾波器的使用上，最困難的當屬濾波器中的參數設定。因不同的設定常會導致完全不一樣
的結果。我們亦曾使用[11]中頻帶參數的設定，但發現到其設定方式所得之分割結果，常會得
到變形的區塊。
從圖9與10的結果中，我們必須承認關於賈柏濾波器參數設定方法，仍有努力之空間。而我
們目前所使用的k-mean分類法只是一個簡單的分類器，未來將嘗試使用更好之分類器來提升
影像分割效果。
18
(a)影像1 (b)影像2 (c)影像3
(d)影像1方法(iii)結果 (e)影像2方法(iii)結果 (f)影像3方法(iii)結果
(g)影像1方法(iv)結果 (h)影像2方法(iv)結果 (i)影像3方法(iv)結果
Figure 9: 圖(a)-(c) Preague 系統所產生的三張待分割之材質影像；圖(d)-(f)為使用方法(iii)之
結果；圖(g)-(iv)為使用方法(ii)之結果;
20
6. 參考文獻
References
[1] N. E. Huang, Z. Shen, S. R. Long, M. C. Wu, H. H. Shih, Q. Zheng, N. C. Yen, C. C. Tung,
and H. H. Liu, “The empirical mode decomposition and the Hilbert spectrum for nonlinear
and non-stationary time series analysis,” Proceedings of the Royal Society London, Part
A, vol. 454, pp. 903–995, 1998.
[2] J. C. Nunes, Y. Bouaoune, E. Delecheslle, O. Niang, and P. Bunel, “Image analysis by
bidimensional empirical mode decomposition,” Image and Vision Computing, vol. 21,
pp. 1019–1026, Nov. 2003.
[3] C. Damerval, S. Meignen, and V. Perrier, “A fast algorithm for bidimensional EMD,” IEEE
Signal Processing Letters, vol. 12, pp. 701–704, Oct. 2005.
[4] S. M. A. Bhuiyan, N. O. Attoh-Okine, K. E. Barner, A. Y. Ayenu-Prah, and R. R. Adhami,
“Bidimensional empirical mode decomposition using various interpolation techniques,”
Advances in Adaptive Data Analysis, vol. 1, no. 2, pp. 309–338, 2009.
[5] S. M. A. Bhuiyan, R. R. Adhami, and J. F. Khan, “Fast and adaptive bidimensional empiri-
cal mode decomposition using order-statistics filter based envelope estimation,” EURASIP
Journal on Advances in Signal Processing, 2008. Article ID 728356.
[6] M. H. Yeh, “The complex bidimensional empirical mode decomosition,” Signal Process-
ing, vol. 92, pp. 523–541, Feb. 2012.
22
[16] A. Jain and G. Healey, “A multiscale representation including opponent color features for
texture recognition,” IEEE Transactions on Image Processing, vol. 7, pp. 124–128, Jan.
1998.
[17] S. C. Pei, J. J. Ding, and J. H. Chang, “Efficient implementation of Quaternion Fourier
transform, convolution, and correlated by 2-D complex FFT,” IEEE Transactions on Sig-
nal Processing, vol. 49, pp. 2783–2797, Nov. 2001.
[18] T. A. Ell and S. J. Sangwine, “Hypercomplex Fourier transforms of color images,” IEEE
Transactions on Image Processing, vol. 16, pp. 22–35, Jan. 2007.
[19] W. K. Pratt, Digital Image Processing. Wiley-Interscience, 4th ed., 2007.
[20] J. G. Daugman, “Complete discrete 2-D Gabor transforms by neural networks for image
analysis and compression,” IEEE Transactions on Acoustics, Speech, and Signal Process-
ing, vol. 36, pp. 1169–1179, July 1988.
[21] N. Petkov, “Biologically motivated computationally intensive approaches to image pattern
recognition,” Future Generation Computer Systems, vol. 11, pp. 451–465, 1995.
[22] T. Bu¨low and G. Sommer, “Quaternionic Gabor filters for local structure classification,”
in Proceedings of the 14th International Conference on Pattern Recognition, pp. 808–810,
1998.
[23] M. Bahri, E. S. M. Hitzer, R. Ashino, and R. V. d, “Windowed Fourier transform of two-
dimensional quaternionic signals,” Application Math and Computation, vol. 216, no. 8,
pp. 2366–2379, 2010.
[24] J. G. Zhang, T. Tan, and L. Ma, “Invariant texture segmentation via circular Gabor filter,”
in Proceedings of 16th IAPR International Conference on Pattern Recognition, vol. II,
pp. 901–904, 2002.
24
This article appeared in a journal published by Elsevier. The attached
copy is furnished to the author for internal non-commercial research
and education use, including for instruction at the authors institution
and sharing with colleagues.
Other uses, including reproduction and distribution, or selling or
licensing copies, or posting to personal, institutional or third party
websites are prohibited.
In most cases authors are permitted to post their version of the
article (e.g. in Word or Tex form) to their personal website or
institutional repository. Authors requiring further information
regarding Elsevier’s archiving and manuscript policies are
encouraged to visit:
http://www.elsevier.com/copyright
Author's personal copy
EMD for complex signals is the bivariate-EMD method,
which is proposed in [11] based on the idea of replacing
the oscillation notion in EMD by a notion of rotation. This
method considers that the bivariate signal can be described
as the sum of a fast rotation component superimposed on a
slower rotation. The bivariate-EMD algorithm consists in
projecting the complex signal on a set of directions and
then applying the sifting process of the standard EMD on
the projected components. Besides the bivariate-EMD, the
extensions to trivariate and multivariate works have also
been developed and applied successfully [12–14].
The bidimensional empirical mode decomposition
(BEMD) is the 2D extension of the empirical mode decom-
position (EMD) [15]. Many applications based upon BEMD
have been successful, such as image segmentation [16,17],
image fusion [18], edge detection [19], noise reduction [20],
texture synthesis [21], image compression [22] and image
watermarking [23,24]. Besides the applications of BEMD,
several modiﬁcations and improvements of BEMD have
been developed in order to make the BEMD efﬁcient or
solve the drawback in BEMD. In EMD or BEMD, extraction
of each IMF requires several iterations. Hence extrema
detection and interpolation at each iteration make the
process complicated and time consuming. Various types
of radial basis functions (RBF) [15,16], multilevel B-spline
[16], Delaunay triangulation [25], ﬁnite-element method
[26], order statistics ﬁlters [27] and so on have been used
for 2D scattered interpolation. In [28], a detailed compar-
ison for the various interpolation schemes was given.
Besides the interpolation methods, the determination of
2D extrema in BEMD is also an open problem. The struc-
tural extrema-based BEMD for speciﬁc extrema [17], and
watershed method [29,16] give the alternative tools for
determination of 2D extrema. In [30], a BEMD method in
the spirit of image compression was proposed by using
local minimum and maximum. Since both the interpola-
tion and extrema detection are time consuming, the ideas
for processing only local neighborhood pixels in BEMD have
been proposed [16,31]. The use of local neighborhood
window can reduce the computation loads for interpolation
and extrema detection. The directional EMD [32] is
employed to handle the images with strong directional
features, which performs multiple 1D EMD along several
directions. Beside the various schemes for 2D interpolation
and extrema detection, there are still other problems, such
as the boundary effect, determination of sifting number and
solving mode mixing, to be solved. As for the mode mixing,
it is still existed in the BEMD. Similar to the EEMD for 1D
EMD, the noise-assisted methods are still the major solu-
tions for the mode mixing of BEMD up to now [33,34]. The
computation loads for the noise-assisted are heavy, espe-
cially for the 2D case.
The 2D complex signals have found applications in NMR-
spectroscopy [35], geophysics [36] and image processing. Up
to now, the BEMDmethod can be used only upon the real 2D
signals, such as grey-level images. The purpose of this paper
is to propose a complex-BEMD algorithm, which is suitable to
2D complex signals. This paper is organized as follows: In
Section 2, we give a brief introductions to the EMD, BEMD
and 2D Hilbert transforms. Then the complex-BEMD is
proposed in Section 3. In Section 4, the chrominance of color
image is dealt with complex-BEMD, and BEMD for color
images is proposed. For demonstrating the potential of
complex-BEMD, a simple color image fusion algorithm is
also developed in Section 4. By the proposed complex-BEMD
and developed image fusion algorithm, the well-fused result
can be obtained, if the mode mixing problem of BEMD is
alleviated. Finally, conclusion remarks are given is Section 5.
2. Preliminary
2.1. EMD and BEMD
Empirical mode decomposition (EMD) is a data driven
time-frequency technology which adaptively decomposes a
signal, by means of a processing called the sifting process, into
a ﬁnite set of modulated components [1]. These components,
called ‘‘intrinsic mode functions’’ (IMFs), represent the oscil-
lation modes embedded in the data. Each IMF satisﬁes the
two following constraints:
(i) The number of extrema and the number of zero
crossings are identical or differ at most by one.
(ii) The mean value between the upper and the lower
envelope is equal to zero at any time.
The EMD algorithm decomposes the signal x(t) as [1]
xðtÞ ¼
XM
k ¼ 1
xðkÞðtÞþrðtÞ ð1Þ
where xðkÞðtÞ, j¼ 1;2, . . . ,M, are the IMFs and r(t) is the
residue. The procedure used for extraction of an IMF from
signal x(t) is given in Algorithm 1:
Algorithm 1. EMD.
1: Find the locations of all the extrema of x(t).
2: Interpolate between minima (respectively maxima) to obtain the
signal envelope passing through emin(t) (respectively emax(t)).
3: Compute the local mean mðtÞ ¼ ðeminðtÞþemaxðtÞÞ=2.
4: Subtract the mean from the original signal to obtain the
oscillating signal sðtÞ ¼ xðtÞmðtÞ.
5: If the resulting signal s(t) obeys the stopping criterion, dðtÞ ¼ sðtÞ
becomes an IMF; otherwise set xðtÞ ¼ sðtÞ and repeat the processes
from Step 1.
The stop criterion used in the ﬁnal step is originally
based on the normalization squared difference between two
successive sifting iteration can be found in [1]. A more
robust criterion, based upon the original deﬁnition of IMF,
stop the sifting process only after the condition on the
extrema of an IMF is met for S consecutive iterations [37].
Upon obtaining an IMF, the next IMF is extracted by
applying the same procedure to the residual signal
rðtÞ ¼ xðtÞdðtÞ. The process is repeated until all the IMFs
are extracted and the remaining signal carries no more
oscillations, characterized by an inadequate number of
extrema. The number of IMFs will be adaptively deter-
mined by the signal, sifting processing and stop criterion.
Bidimensional empirical mode decomposition (BEMD) is
the 2D extension of EMD. The same algorithm applies for
BEMD as well, where extrema detection and interpolation
are carried out using 2D versions of the corresponding
M.-H. Yeh / Signal Processing 92 (2012) 523–541524
Author's personal copy
where f1ðx,yÞ is the ﬁrst quadrant spectrum of signal f ðx,yÞ.
fxðx,yÞ and fyðx,yÞ are the partial Hilbert transforms of f ðx,yÞ
along x and y directions, respectively. fbðx,yÞ is the total Hilbert
transform of the2D signal f ðx,yÞ.
The operation in Eq. (13) is called ﬁrst quadrant
operation (FQO) in this paper. It will be very useful for
the further development.
The sign function, sgn(x), is ordinary with value 1 for
x40, and equals to 1 for xo0. As for the discrete Hilbert
transform, the sgn is deﬁned as Eq. (14) for frequency masks
in discrete Hilbert transform computation [39–42]:
dsgnðxÞ ¼
1, 0oxop
0, x¼ 0 or x¼ p
1, poxo0
8><
>: ð14Þ
dsgnðÞ indicates the sign function for the frequency spectrum
of discrete-time signals. Thus the frequency masks for the
computing discrete 2D partial and total Hilbert transforms
are also deﬁned in [39], and they are illustrated in Fig. 1. The
shaded regions are with the marked values, and the non-
shaded regions are with zero value.
The deﬁnitions of 2D Hilbert transforms used in this
paper are the conventional and well-known ones. In the
literature, some modiﬁcations and extensions of 2D Hilbert
transforms have been discussed and proposed [43–46]. In
order to make the deﬁnition simple and popular, only the
conventional 2D Hilbert transform is used in this paper. The
extension and modiﬁed methods of 2D Hilbert transform
can provide further researches. Besides the complex-valued
transform results, several 2D Hilbert transforms based upon
quaternion algebra have been proposed [47,48] for obtain-
ing 2D analytic signals. Since the quaternion signals should
not be the solutions of complex-BEMD, these methods are
not adopted in our developments of complex-BEMD.
3. Complex bidimensional empirical
mode decomposition
3.1. Decomposition and reconstruction for 2D signals
In order to have a detailed discussion for boundary
conditions in spectrum, the notations of discrete-time 2D
signal f ðx,yÞ and its spectrum Fðeju,ejvÞ will be used in this
section. A signal whose spectrum located in the ﬁrst quad-
rant and its boundaries is considered, and its spectrum is
sketched as the shaded region in Fig. 2. The considered
signal is an analogue of the single orthant signal discussed
in [38] for the 2D discrete-time case. The region III in Fig. 2
is just the ﬁrst quadrant without boundaries. And the
Fig. 1. The frequency masks for 2D discrete Hilbert transforms. (a) Partial Hilbert transform along x direction. (b) Partial Hilbert transform along y
direction. (c) Total Hilbert transform.
M.-H. Yeh / Signal Processing 92 (2012) 523–541526
Author's personal copy
F3ðeju,ejvÞ ¼ 12G3ðeju,ejvÞ
F4ðeju,ejvÞ ¼ 12G4ðeju,ejvÞ ð21Þ
Since the signal gqðx,yÞ is the reﬂected version of fqðx,yÞ to
the ﬁrst quadrant, the spectrum Gqðeju,ejvÞ will be all
located in the ﬁrst quadrant and its boundaries. Now,
we will discuss the various regions for Fðeju,ejvÞ.
 The real parts of reconstructed spectrum in the four
boundary points ðu,vÞ ¼ ð0;0Þ, ð0,pÞ, ðp,0Þ, ðp,pÞ are
considered by Proposition 2.
G^1,Rðeju,ejvÞ ¼ 14 Re½G1ðeju,ejvÞ ¼ 12Re½F1ðeju,ejvÞ
G^4,Rðeju,ejvÞ ¼ 14 Re½G4ðeju,ejvÞ ¼ 12Re½F4ðeju,ejvÞ ð22Þ
Due to the periodic property in discrete-time Fourier
transform, the above two values are identical and
equal to the values 12Re½Fðeju,ejvÞ. So the summation of
G^1,Rðeju,ejvÞ and G^4,Rðeju,ejvÞ in Eq. (20) is equal to
Re½Fðeju,ejvÞ. Similarly, the imaginary parts of the recon-
structed values in the four boundary points are the
summation of 12 j Im½F2ðeju,ejvÞ and 12 j Im½F3ðeju,ejvÞ,
and they equal to j Im½Fðeju,ejvÞ. Thus Eq. (20) for the
four boundary points is proved.
 As for the spectrum region 0ouop and v¼0,
belonging to region II in Fig. 2, the following two
values in Eq. (20) are considered by the region II case
in Propositions 2 and 3.
G^1,Rðeju,ejvÞ ¼ 14 G1ðeju,ejvÞ ¼ 12F1ðeju,ejvÞ
jG^3,Iðeju,ejvÞ ¼ 14 G3ðeju,ejvÞ ¼ 12F3ðeju,ejvÞ
The above two values are identical and both equal
to 12 Fðeju,ejvÞ by the periodicity in Fourier transform. As
for the other two terms in Eq. (20), jG^2,Iðeju,ejvÞ and
G^4,Rðeju,ejvÞ will be zero, since they are not located in
the ﬁrst quadrant and its boundaries. Thus the summa-
tion in Eq. (20) will equal Fðeju,ejvÞ. Moreover, it could be
observed that the spectrum in the boundaries of two
quadrants are reconstructed and determined by the
adjacent quadrant components.
 As for the ﬁrst quadrant spectrum, 0ouop and
0ovop, only the term G^1,Rðeju,ejvÞ in Eq. (20) is
nonzero, which is attained by Proposition 2. Thus
the reconstructed spectrum values in Eq. (20) are
1
2G1ðeju,ejvÞ ¼ F1ðeju,ejvÞ ¼ Fðeju,ejvÞ
The cases in the other three quadrants can be attained
similarly.
All the spectrum regions have been considered and
proved, so Eq. (20) has been proved. &
Fig. 3 gives a detailed illustration for the spectrum
reconstruction of the 2D signal f ðx,yÞ. The notation in the
spatial domain is as follows:
f ðx,yÞ ¼ g^1,Rðx,yÞþ jg^2,Iðx,yÞþ jg^3,Iðx,yÞþ g^4,Rðx,yÞ
ð23Þ
where g^1,Rðx,yÞ and g^4,Rðx,yÞ are with the spectrum G^1,R
ðeju,ejvÞ and G^4,Rðeju,ejvÞ, respectively, where g^2,Iðx,yÞ and
g^3,Iðx,yÞ are with the spectrum G^2,Iðeju,ejvÞ and G^3,Iðeju,ejvÞ,
respectively.
3.2. The complex-BEMD algorithm
The developed complex-BEMD is based upon the
perfect reconstruction in Proposition 4. A 2D complex
signal f ðx,yÞ is decomposed as the summation of the four
quadrant spectra. Then the standard BEMD is performed
for the four quadrant spectra, respectively.
All the signals, such as fqðx,yÞ, gqðx,yÞ and g^1,Rðx,yÞ,
are deﬁned as the above subsection. A new set of real 2D
signals gqðx,yÞ obtained by real or imaginary part of g^ðx,yÞ
is introduced for simpliﬁcation. The standard BEMD can
be applied for ﬁnding its IMFs and residue:
g^1,Rðx,yÞ ¼ g1ðx,yÞ ¼
XN1
k ¼ 1
g ðkÞ1 ðx,yÞþr1ðx,yÞ ð24Þ
g^2,Iðx,yÞ ¼ g2ðx,yÞ ¼
XN2
k ¼ 1
g ðkÞ2 ðx,yÞþr2ðx,yÞ ð25Þ
g^3,Iðx,yÞ ¼ g3ðx,yÞ ¼
XN3
k ¼ 1
g ðkÞ3 ðx,yÞþr3ðx,yÞ ð26Þ
g^4,Rðx,yÞ ¼ g4ðx,yÞ ¼
XN4
k ¼ 1
g ðkÞ4 ðx,yÞþr4ðx,yÞ ð27Þ
where g ðkÞq is the k-th IMF for the real 2D signal gqðx,yÞ,
q¼1,2,3, and 4. rqðx,yÞ is the residue of gqðx,yÞ. Nq is the
number of IMF for gqðx,yÞ, which is the number of IMF for
the q-th quadrant spectrum. The complex-value IMFs are
obtained by the FQO for g ðkÞq ðx,yÞ:
gðkÞq ðx,yÞ ¼ FQOðg ðkÞq ðx,yÞÞ ð28Þ
Fig. 3. Perfect reconstruction of signal spectrum for Proposition 4.
M.-H. Yeh / Signal Processing 92 (2012) 523–541528
Author's personal copy
IMFs for the four quadrant spectra are 5, 5, 4 and 4,
respectively. It indicates that there are total 19 IMFs for this
test signal.
The complex-BEMD is computed through the BEMD of
four 2D real signals corresponding to the four quadrants.
Thus the number of IMFs may be unequal for the four qua-
drants. The above 2D NMR experiment is as an example. In
order to have simpliﬁcation in showing results, the resulting
IMFs of four quadrants could be combined as follows:
f ðkÞðx,yÞ ¼ gðkÞ1 ðx,yÞþ jg
ðkÞ
2 ðx,yÞþ jgðkÞ3 ðx,yÞgðkÞ4 ðx,yÞ ð43Þ
The four IMF gðkÞq (for q¼1,2,3,4) in Eq. (43) may not be
located in the same frequency scales. Eq. (43) provides only a
simpliﬁcation for showing our results.
Fig. 5. The real and imaginary parts of the ﬁrst IMF for the 2D NMR example in [50].
Fig. 6. The real and imaginary parts of the second IMF for the 2D NMR example in [50].
M.-H. Yeh / Signal Processing 92 (2012) 523–541530
Author's personal copy
Eqs. (4) and (5) are for computing the analytic signal
and the IMF of complex signal. And its resulting spectrum
is only located in the positive frequency. For the BEMD,
the FQO in complex-BEMD performs analogue task, which
makes the spectrum of signal be located in the ﬁrst
quadrant.
The bivariate-EMD is another import tools for the
EMD analysis. When Algorithm 3 is examined, it can be
evidently observed that K-times interpolations must be
performed. The computation load will become serious for
the 2D case, since K-times 2D interpolation are required
for ﬁnding the 2D envelope surfaces. For the bivariate-
EMD, the correlations between the real and imaginary
parts of complex signals are not considered specially. It
deals with the complex signals as the ordinary bivariate
signals, whose two components may be correlated or
uncorrelated.
4. The application to color image analysis
4.1. BEMD for color images
In our algorithm, the color processed image iðx,yÞ ¼
frðx,yÞ,gðx,yÞ,bðx,yÞg will be converted to the IHS color
space [51]. The conversion of RGB to IHS color space is
shown as follows:
l
v1
v2
2
64
3
75¼
1
3
1
3
1
3
 1ﬃﬃ
6
p  1ﬃﬃ
6
p 2ﬃﬃ
6
p
1ﬃﬃ
2
p  1ﬃﬃ
2
p 0
2
6664
3
7775
r
g
b
2
64
3
75 ð47Þ
The inverse conversion from IHS to RGB color space is as
follows:
r
g
b
2
64
3
75¼
1  1ﬃﬃ
6
p 1ﬃﬃ
2
p
1  1ﬃﬃ
6
p  1ﬃﬃ
2
p
1 2ﬃﬃ
6
p 0
2
6664
3
7775
l
v1
v2
2
64
3
75 ð48Þ
The IHS color coordinate has been used within the image
processing community as a quantitative means of specifying
the intensity, hue and saturation of a color. The hue and
saturation components of a color are evaluated as follows:
H¼ tan1 v2
v1
 
ð49Þ
S¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
v21þv22
q
ð50Þ
The luminance of color is just the l component in Eq. (47).
The chrominance v1 and v2 can be organized by Eq. (51) as a
2D complex signal cðx,yÞ [52], and we will have the
complex-BEMD for it:
cðx,yÞ ¼ v1ðx,yÞþ jv2ðx,yÞ ð51Þ
The luminance lðx,yÞ is a real 2D signal; the standard
BEMD can be used for ﬁnding its IMFs. The chrominance
cðx,yÞ is a 2D complex signal; the proposed complex-BEMD
in the previous section will be applied. The k-th IMF of
chrominance is the combination of the four IMFs for
simpliﬁcation can be combined by Eq. (43). The residue of
chrominance is also the combination of the four residues by
Eq. (44). The proposed BEMD algorithm for color image is
described in Algorithm 5, and it is also illustrated in
Fig. 9(a). One set of IMFs for luminance and four sets of
IMFs for chrominance are obtained. The residues of BEMD
Fig. 8. The magnitudes of 2D discrete Fourier transform for the real and imaginary parts of tested 2D NMR signal.
M.-H. Yeh / Signal Processing 92 (2012) 523–541532
Author's personal copy
multi-focus image fusion [57]. In this paper, we will develop
a simple color image fusion based on the complex-BEMD in
order to demonstrate the potential of complex-BEMD. The
idea for our developed algorithm is based upon that of [18],
which uses the 1D bivariate EMD for grey image fusion.
Although several color image fusion method can be found in
the literature [53], we believe that the color image fusion
methods by BEMD sill are worthy of further researches.
Algorithm 6. A simple color image fusion algorithm.
1: Compute the color image BEMD for the two images A and B. The
resulting IMFs for luminance are lðkÞA and l
ðkÞ
B . And the four sets of
resulting IMFs for chrominance are cA,q and cB,q , where q¼1,2,3,4.
2: If the numbers of IMFs from the two source images A and B are
not equal, the source image with more IMFs, corresponding to low
resolution, should carry on a merge to its residue. It causes the
number of IMFs from each source to be equal:
]ðlF Þ ¼minf]ðlAÞ,]ðlBÞg ð52Þ
]ðcF ,qÞ ¼minf]ðcA,qÞ,]ðcB,qÞg ð53Þ
where q¼1,2,3,4, the function ]ðÞ denotes the total number of actual
IMF plus one for the residue. The merge for extra IMF of luminance is
performed as
lð]ðlF ÞÞA ðx,yÞ ¼
X]ðlA Þ
k ¼ ]ðlF Þ
lðkÞA ðx,yÞ ð54Þ
lð]ðlF ÞÞB ðx,yÞ ¼
X]ðlB Þ
k ¼ ]ðlF Þ
lðkÞB ðx,yÞ ð55Þ
where lðkÞA and l
ðkÞ
B indicate the k-th IMF of luminance for the images A
and B. The merge for extra IMF of chrominance is performed as
c
ð]ðcF,q ÞÞ
A,q ðx,yÞ ¼
X]ðcF,q Þ
k ¼ ]ðcF,q Þ
cðkÞA,qðx,yÞ ð56Þ
c
ð]ðcF,q ÞÞ
B,q ðx,yÞ ¼
X]ðcF,q Þ
k ¼ ]ðcF,q Þ
cðkÞB,qðx,yÞ ð57Þ
where q¼1,2,3,4. cðkÞA,q and cðkÞB,q indicate the k-th IMF of chrominance
for the images A and B.
Fig. 12. The ﬁrst and second IMFs and residues (by classical BEMD) for the luminance of partially defocused images. (a) IMF 1, foreground focus. (b) IMF
1, background focus. (c) IMF 2, foreground focus. (d) IMF 2, background focus. (e) Residue, foreground focus. (f) Residue, background focus.
M.-H. Yeh / Signal Processing 92 (2012) 523–541534
Author's personal copy
Then the inverse BEMD for color images is performed to
obtain the fused image.
After the color image fusion algorithm being devel-
oped, two partial focused images shown in Fig. 11 are
applied as our test images. Due to the limited depth of
focus of optical lens, cameras cannot be focused simulta-
neously on all objects at different distances. That is the
reason why the images in Fig. 11 are defocused. For the
step 1 in Algorithm 6, the BEMD for luminance and
complex-BEMD for chrominance are simultaneously per-
formed for the two images. And their resulting IMFs for
luminance are 7 and IMFs for the four quadrants of
chrominance are all 5 in our experiment. Because the
luminance is more sensitive to human eyes, we adjust the
parameters in the EMD and BEMD to achieve the more
numbers of luminance IMFs. With the additional residue,
]ðlAÞ ¼ ]ðlBÞ ¼ 8 and ]ðcA,qÞ ¼ ]ðcB,qÞ ¼ 6, for q¼1,2,3,4. The
ﬁrst two IMFs and residues for the two partial focused
images are shown in Figs. 12 and 13, for luminance and
chrominance, respectively. The results shown in Fig. 13 is
a combination of the four quadrant components, which is
obtained by Eqs. (43) and (44). From the results shown
in Fig. 13, we can observe that the ﬁrst IMF contain the
highest local frequency of oscillation, and the residue
contain the trend of the color image.
The window size w for determining the local signiﬁ-
cance of each IMF is set to be 5 in our experiment. After
the signiﬁcance of each IMF being obtained, the fused
image can be obtained by the inverse color BEMD, whose
block diagram is shown in Fig. 9(b). Fig. 14 shows the
fused image by Algorithm 6 with various threshold x. The
threshold x is set to be 0.2 for the result shown in
Fig. 14(a). It is too large to cause most of the weighting
values aðkÞ in Eq. (59) to be 0.5. Thus the resulted fusion
image will be near to the average of the two source image
and blurred as shown Fig. 14(a). If the threshold x is set to
be 0.005, a corrupted output for the fusion algorithm
shown in Fig. 14(b) will be obtained. The choices of
threshold x between 0.005 and 0.2 have been tried, but
the blur or corruption are still existed. After examining
the IMFs of the two source image, the mode mixing is
existed. Thus a further experiment with the BEMD, which
can reduce the mode mixing, should be made to verify our
observation.
The main idea of Algorithm 6 is based upon the fusion
method in [18], which used the bivariate 1D-EMD as a
tool for making the same frequency components of the
two source images be located in the same mode. The real
and imaginary parts of complex signals are used to
indicate the two source images. However, the complex
signals are used for representing the two chrominance
components of color images in Algorithm 6. So the mode
mixing is without being solved, and it will still be existed
in our experiment. In order to relieve the mode mixing,
the listed Matlab code in [33] is used as the BEMD tool for
the further experiment. In our further experiment, 100
ensemble samples for each defocused image obtained
by added Gaussian noises with variance 0.2 are as our
test data. The Gaussian noises are added to the luminance
and the four real 2D signals corresponding to the four
quadrants of chrominance. Similarly, we compute seven
IMFs for luminance and ﬁve IMFs for each quadrant of the
chrominance. The ﬁrst two IMFs and residues for the two
defocused images are shown in Figs. 15 and 16, for the
luminance and chrominance, respectively. The result
shown in Fig. 16 are again with the help of Eqs. (43)
and (44). From the results shown in Figs. 15 and 16, it can
be observed that the mode mixing is alleviated. A smaller
threshold x¼ 0:005, which makes the corrupted fused
image by classical BEMD, is as a test. The fused result is
shown in Fig. 17, and it is neither blurred nor corrupted.
4.3. Discussion
In the previous two subsections, the proposed com-
plex-BEMD has been applied to color image processing.
The chrominance component is treated as the 2D complex
signal, and it is processed by complex-BEMD. From our
simulation results, it can be observed that the IMFs of
chrominance computed by complex-BEMD reveal fast to
slow oscillations in chrominance. The residue can reveal
the trend of color image.
The image fusion method in [18] is based upon 1D
bivariate-EMD for grey-scale images only. Up to now,
other proposed methods based on BEMD for image fusion
are all only suitable to grey-scale images [58–60]. In the
previous subsection, the developed simple color image
fusion algorithm is based on BEMD and complex-BEMD,
Fig. 14. The fused images by classical BEMD. (a) x¼ 0:2. (b) x¼ 0:005.
M.-H. Yeh / Signal Processing 92 (2012) 523–541536
Author's personal copy
complex-BEMD have the following advantages. First, the
resulting IMFs match the spirits of conventional BEMD.
The ﬁrst IMF contains the highest local frequency of
oscillation, and the ﬁnal IMF contains the lowest local
frequency of oscillation. Second, the proposed-BEMD is
potentially in color image processing. The color image fusion
based upon the BEMD and complex-BEMD can be success-
fully fused. Third, any new improvement for the BEMD can
be applied to our complex-BEMD, since the proposed
complex-BEMD is based upon the classical BEMD.
Appendix A
To begin with, the proof of Proposition 2 will be stated.
gRðx,yÞ is the real part of gðx,yÞ, so it can be represented as
Fig. 16. The ﬁrst and second IMFs and residues (by [33]) for the chrominance of partially defocused images. (a) IMF 1, foreground focus. (b) IMF 1,
background focus. (c) IMF 2, foreground focus. (d) IMF 2, background focus. (e) Residue, foreground focus. (f) Residue, background focus.
Fig. 17. The fused image by [33], x¼ 0:005.
M.-H. Yeh / Signal Processing 92 (2012) 523–541538
Author's personal copy
[2] N.E. Huang, S.S. Shen, The Hilbert-Huang Transform and its Appli-
cations, World Scientiﬁc, 2005.
[3] T.M. Rutkowski, D.P. Mandic, A. Cichocki, A.W. Przybyszewski, EMD
approach to multichannel EEG data—the amplitude and phase
components clustering analysis, Journal of Circuits Systems and
Computers 19 (1) (2010) 215–229.
[4] H.H.J. Pan, Speech pitch determination based on Hilbert–Huang
transform, Signal Processing 86 (2006) 792–803.
[5] Y. Huang, F.G. Schmitt, Z. Lu, Y. Liu, Analysis of daily river ﬂow
ﬂuctuations using empirical mode decomposition and arbitrary
order Hilbert spectral analysis, Journal of Hydrology 373 (1–2)
(2009) 103–111.
[6] J.F. Khan, K. Barner, R. Adhami, Feature point detection utilizing the
empirical mode decomposition, EURASIP Journal on Advances in
Signal Processing (2008). doi:10.1155/2008/287061.
[7] Z. Yang, Z. Yang, L. Yang, Iris recognition based on Hilbert–Huang
transform, Advances in Adaptive Data Analysis 1 (4) (2009)
623–641.
[8] N.E. Huang, Z. Shen, S.R. Long, A new view of nonlinear water
waves: the Hilbert spectrum, Annual Review of Fluid Mechanics
31 (1999) 417–457.
[9] Z. Wu, N.E. Huang, Ensemble empirical mode decomposition: a
noise-assisted data analysis method, Advances in Adaptive Data
Analysis 1 (1) (2009) 1–41.
[10] T. Tanaka, D.P. Mandic, Complex empirical mode decomposition,
IEEE Signal Processing Letters 14 (February) (2007) 101–104.
[11] G. Rilling, P. Flandrin, P. Goncalves, J.M. Lilly, Bivariate empirical
mode decomposition, IEEE Signal Processing Letters 14 (December)
(2007) 936–939.
[12] N. Rehman, D.P. Mandic, Empirical mode decomposition for tri-
variate signals, IEEE Transactions on Signal Processing 58 (March)
(2010) 1059–1068.
[13] N. Rehman, D.P. Mandic, Multivariate empirical mode decomposi-
tion, Proceedings of the Royal Society, A 466 (2009) 1291–1302.
[14] J. Fleureau, A. Kachenoura, L. Albera, J.C. Nunes, L. Senhadji, Multi-
variate empirical mode decomposition and application to multi-
channel ﬁltering, Signal Processing 91 (2011) 2783–2792.
[15] J.C. Nunes, Y. Bouaoune, E. Delecheslle, O. Niang, P. Bunel, Image
analysis by bidimensional empirical mode decomposition, Image
and Vision Computing 21 (November) (2003) 1019–1026.
[16] J.C. Nunes, S. Guyot, E. Delechelle, Texture analysis based on local
analysis of the bidimensional empirical mode decomposition,
Machine Vision and Applications 16 (3) (2005) 177–188.
[17] G.L. Xu, X.T. Wang, X.G. Xu, Improved bi-dimensional EMD and
Hilbert spectrum for the analysis of textures, Pattern Recognition
42 (May) (2009) 718–734.
[18] D. Looney, D.P. Mandic, Multiscale image fusion using complex
extensions of EMD, IEEE Transactions on Signal Processing 57
(April) (2009) 1626–1630.
[19] L.F. Liang, Z.L. Ping, An edge detection algorithm of image based on
empirical mode decomposition, in: Second International Sympo-
sium on Intelligent Information Technology Application, Shanghai,
China, vol. 1, 2008, pp. 128–132.
[20] M.B. Bernini, A. Federico, G.H. Kaufmann, Noise reduction in
digital speckle pattern interferometry using bidimensional
empirical mode decomposition, Applied Optics 47 (14) (2008)
2592–2598.
[21] Z.X. Liu, S.L. Peng, Boundary processing of bidimensional EMD
using texture synthesis, IEEE Signal Processing Letters 12 (January)
(2005) 33–36.
[22] A. Linderhed, Compression by image empirical mode decomposi-
tion, in: Proceedings of the IEEE International Conference on Image
Processing, Genoa, Italy, vol. 1, 2005, pp. 553–556.
[23] J. Taghia, M. A. Doostari, J. Taghia, An image watermarking method
based on bidimensional empirical mode decomposition, in: 2008
Congress on Image and Signal Processing, Sanya, Hainan, China, vol.
5, 2008, pp. 674–678.
[24] Y. Lee, J. Nah, J. Kim, Digital image watermarking using bidimen-
sional empirical mode decomposition in wavelet domain, in:
Proceedings of the 11th IEEE International Symposium on Multi-
media, San Diego, CA, USA, 2009, pp. 583–588.
[25] C. Damerval, S. Meignen, V. Perrier, A fast algorithm for bidimen-
sional EMD, IEEE Signal Processing Letters 12 (October) (2005)
701–704.
[26] Y. Xu, B. Liu, J. Liu, S. Riemenschneider, Two-dimensional empirical
mode decomposition by ﬁnite elements, Proceedings of the Royal
Society, Part A 462 (2006) 3081–3096.
[27] S.M.A. Bhuiyan, R.R. Adhami, J.F. Khan, Fast and adaptive bidimen-
sional empirical mode decomposition using order-statistics ﬁlter
based envelope estimation, EURASIP Journal on Advances in Signal
Processing (2008). doi:10.1155/2008/728356.
[28] S.M.A. Bhuiyan, N.O. Attoh-Okine, K.E. Barner, A.Y. Ayenu-Prah,
R.R. Adhami, Bidimensional empirical mode decomposition using
various interpolation techniques, Advances in Adaptive Data Ana-
lysis 1 (2) (2009) 309–338.
[29] J.C. Nunes, O. Niang, Y. Bouaoune, E. Delechelle, P. Bunel, Texture
analysis based on the bidimensional empirical mode decomposi-
tion with gray-level co-occurrence models, in: Proceedings of the
7th International Symposium on Signal Processing and its Applica-
tions, Paris, France, vol. 2, 2005, pp. 633–655.
[30] A. Linderhed, 2-D empirical mode decompositions—in the spirit of
image compression, Proceeding of SPIE, vol. 4738, 2002.
[31] G.L. Xu, X.T. Wang, X.G. Xu, Neighborhood limited empirical mode
decomposition and application in image processing, in: Proceed-
ings of the Fourth International Conference on Image and Graphics,
Chengdu, China, 2007, pp. 149–154.
[32] Z.X. Liu, H.J. Wang, S.L. Peng, Texture segmentation using direc-
tional empirical mode decomposition, in: Proceedings of the IEEE
International Conference on Image Processing, Singapore, vol. 1,
2004, pp. 279–282.
[33] Z. Wu, N.E. Huang, X. Chen, The multi-dimensional ensemble
empirical mode decomposition method, Advances in Adaptive Data
Analysis 1 (3) (2009) 339–372.
[34] G.L. Xu, X.T. Wang, X.G. Xu, Improved bi-dimensional empirical
mode decomposition based on 2D-assisted signals: analysis and
application, IET Image Processing 5 (3) (2011) 205–221.
[35] W.R. Croasmun, R.M.K. Carlson (Eds.), Two-Dimensional NMR
Spectroscopy: Applications for Chemists and Biochemists, 2nd ed.,
Wiley, 1994.
[36] M.N. Nabighian, The analytic signal of two-dimensional magnetic
bodies with polygonal cross-section: its properties and use for
automated anomaly interpretation, Geophys 37 (3) (1972)
507–517.
[37] N.E. Huang, M.C. Wu, S.R. Long, S.S. Shen, W. Qu, P. Gloersen,
K.L. Fan, A conﬁdence limit for the empirical mode decomposition
and Hilbert spectral analysis, Proceedings of the Royal Society, A
459 (2003) 2317–2345.
[38] S.L. Hahn, Multidimensional complex signals with single-orthant
spectra, Proceedings of the IEEE 80 (August) (1992) 1287–1300.
[39] S.L. Hahn, Hilbert Transforms in Signal Processing, Artech House,
1996.
[40] V. Cˇizˇek, Discrete Hilbert transform, IEEE Transactions on Audio
and Electroacoustics 18 (December) (1970) 340–343.
[41] F.E. Burris, Matrix formulation of the discrete Hilbert transform,
IEEE Transactions on Circuits and Systems 22 (October) (1975)
836–838.
[42] S.C. Pei, M.H. Yeh, Discrete fractional Hilbert transform, IEEE
Transactions on Circuits and Systems II 47 (November) (2000)
1307–1311.
[43] J.P. Havlicek, J.W. Havlicek, N.D. Mamuya, A.C. Bovik, Skewed 2D
Hilbert transforms and computed AM-FM models, in: Proceedings
of the IEEE International Conference on Image Processing, Chicago,
USA, vol. 1, 1998, pp. 602–606.
[44] S.C. Pei, J.J. Ding, The generalized radial Hilbert transform and its
applications to 2-D edge detection (any direction or speciﬁed
directions), in: Proceeding of the IEEE International Conference on
Acoustics, Speech and Signal Processing, Hongkong, China, vol. 3,
2003, pp. 357–360.
[45] G.L. Xu, X.T. Wang, X.G. Xu, Generalized Hilbert transform and its
properties in 2D LCT domain, Signal Processing 89 (2009) 1395–1402.
[46] G.L. Xu, X.T. Wang, X.G. Xu, Extended Hilbert transform for the
multidimensional signals, in: Proceedings of the 5-th Visual Infor-
mation Engineering, Xian, China, 2008, pp. 292–297.
[47] T. Bu¨low, G. Sommer, Hypercomplex signals—a novel extension of
the analytic signal to the multidimensional case, IEEE Transactions
on Signal Processing 49 (November) (2001) 2844–2852.
[48] M. Felsberg, G. Sommer, The monogenic signal, IEEE Transactions
on Signal Processing 49 (December) (2001) 3136–3144.
[49] J.S. Lim, Two-Dimensional Signal and Image Processing, Prentice-
Hall, 1990.
[50] J. van Beek, matNMR: a ﬂexible toolbox for processing, analyzing
and visualizing magnetic resonance data in Matlab, Journal of
Magnetic Resonance 187 (July) (2007) 19–26.
[51] W.K. Pratt, Digital Image Processing, 4th ed., Wiley-Interscience,
2007.
[52] A. McCabe, T. Caelli, G. West, A. Reeves, Theory of spatiochromatic
image encoding and feature extraction, Journal of the Optical
Society America A 17 (October) (2000) 1744–1754.
M.-H. Yeh / Signal Processing 92 (2012) 523–541540
MULTI-FOCUS COLOR IMAGE FUSION BASED ON BIVARIATE AND COMPLEX
BIDIMENSIONAL EMPIRICAL MODE DECOMPOSITIONS
Min-Hung Yeh
Department of Electronic Engineering, National Ilan University, Ilan, Taiwan
ABSTRACT
Although the empirical mode decomposition has been suc-
cessfully applied to signal analysis, and the fusion applica-
tions, there is currently no efficient solution for color images
fusion. This paper proposes a method based upon the com-
bination of the bivariate and the complex bidimensional em-
pirical mode decomposition for color image fusion. The pro-
posed method can have good fusion result and is efficient in
computation.
Index Terms— Color Image fusion, empirical mode de-
composition, color image decomposition, bivariate decompo-
sition.
1. INTRODUCTION
The empirical mode decomposition (EMD) provides a poten-
tial tool for signal analysis[1]. Unlike Fourier analysis and
wavelet analysis, which have predefined bases, EMD only use
the original signal. Moreover, the EMD has been extended to
the 2D case, and it is called bidimensional empirical mode
decomposition (BEMD)[2]. Many applications based upon
BEMD have been developed. No matter of EMD or BEMD,
the sifting decomposes a signal into its IMFs and a residue
based basically on the local frequency or oscillation informa-
tion. Besides the BEMD, the EMD is with many extensions
for various types of signals[3][4][5].
Image fusion is essentially a problem of combining
chaotic signals in an automatic, data-driven way, which
emphasizes the important information from all sides. Tra-
ditionally, image fusion is done with the help of either the
Principal Analysis(PCA), wavelets, Gaussian pyramid of
pixel averaging[6], Recently, it was proposed that the empir-
ical mode decomposition (EMD) and its complex/bivariate
extensions can be used for image fusion. Prior works relied
either on 1D bivariate EMD[7], bivariate BEMD[8] or on the
univariate BEMD [5][9]. For the 1D bivariate EMD case, the
limitations arise from the fact that two dimensional data are
vectorized, and this causes loss of the spatial information of
the image. As to the bivariate BEMD case, only the gray-scale
image could be processed. In the univariate BEMD fusion
This work was supported by the National Science Council of Taiwan,
R.O.C. under Contract NSC-99-2221-E-197-004-MY2
case, two images are decomposed separately via BEMD.
However, the major drawback of EMD and BEMD, mode
mixing, will be occurred[10]. Mode mixing is defined as
either a single IMF (intrinsic mode functions) consisting of
components of wide disparate scale, or a component of a
similar residing in different IMF. Although a color fusion
method based on BEMD has been proposed in [5], the en-
semble method is used for solving the mode mixing problem.
Its computation is too heavy to have a practical application.
The purpose of this paper is to develop an efficient color
image fusion algorithm based on the empirical mode decom-
position. The extended bivariate BEMD and recently pro-
posed complex BEMD will be used as tools for our method.
2. EMPIRICAL MODE DECOMPOSITION
2.1. EMD and BEMD
Empirical mode decomposition (EMD) is a data driven time-
frequency technology which adaptively decomposes a signal,
by means of a processing called the sifting process, into a
finite set of modulated components [1]. These components,
called “intrinsic mode functions” (IMFs), represent the os-
cillation modes embedded in the data. The EMD algorithm
decomposes the signal x(t) as [1]:
x(t) =
M∑
k=1
x(k)(t) + r(t) (1)
where x(k)(t), j = 1, 2, . . . ,M , are the IMFs and r(t) is the
residue. The procedure used for extraction of an IMF from
signal x(t) is given in Algorithm 1,
Bidimensional empirical mode decomposition (BEMD) is
the 2D extension of EMD. The same algorithm applies for
BEMD as well, where extrema detection and interpolation
are carried out using 2D versions of the corresponding 1D
method. In BEMD, various types of 2D interpolation meth-
ods has been used and developed, such as radial basis function
[2] and Delaunay triangulation [11].
2.2. Complex and Bivariate EMD
Several extensions of EMD have been proposed to make it
suitable for the operation on complex signals. The complex-
f1(x, y) =
1
4
[f(x, y)− fb(x, y) + j(fx(x, y) + fy(x, y))] (11)
the x axis. In this way the hue (H) and saturation (S) can be
represented by:
H = tan−1
{ v
u
}
(13)
S =
√
u2 + v2 (14)
The two chrominance components u and v can be regarded
as a complex signal since they are located in the chrominance
plane.
3.2. BEMD for color images
In [5], a RGB color image is converted to the IHS color space.
Then the conventional BEMD and complex-BEMD are ap-
plied to compute the BEMD for color images. Fig. 1 shows
the method for BEMD and inverse BEMD for color image. In
Fig. 1, the two chrominance components u and v are regarded
as a 2D signals. From Fig.1, it can be known that five sets of
IMFs are obtained. One is for the luminance component, and
the other four are for the chrominance components.
3.3. Fusion Algorithm
Based upon, the BEMD of color image, a color fusion algo-
rithm has been developed in [5]. The method in [5] processes
the fusion on the five sets of IMFs of two images direct. It will
make the image corrupted if the mode mixing is not solved.
In [5], it used 100 ensemble samples for reducing the mode
mixing.
The bivariate EMD can have decomposition for the two
channel signals simultaneously. In [14], it has been shown
that multivariate EMD better aligns the corresponding IMFs
from different channels across the same frequency range. So
it is used as a tool for alleviating the mode mixing. Moreover,
the bivariate BEMD is a more efficient tool than the empirical
method. Thus we replace the two univariate BEMD by the
bivariate BEMD in fusion process. Since there are five sets of
IMFs for color image, we will have five bivariate BEMDs in
our new proposed fusion algorithm.
The fusion algorithm is shown in Algorithm 3. The four
2D real signal decomposition in step 2 is as shown in Algo-
rithm 2. The four 2D real signal reconstructions are as that in
complex BEMD.
Figure 2 gives an illustration of block diagram for our fu-
sion algorithm. The fusion by variance block adopted here is
the same as that in [5]. The local windows are adopted, and
a variance threshold η must be set in order to have a criterion
for having the average of two IMFs or use the image with
significant content as the fused result.
i(x, y)
RGB → IHS
c(x, y)l(x, y)
BEMD Complex-BEMD
l(k)(x, y) c
(k)
1 (x, y), . . . , c
(k)
4 (x, y)
(a) BEMD for color images
l(k)(x, y) c
(k)
1 (x, y), . . . , c
(k)
4 (x, y)
Inverse BEMD
Inverse complex-
BEMD
c(x, y)l(x, y)
IHS → RGB
i(x, y)
(b) inverse BEMD for color images
Fig. 1. The block diagrams for the BEMD and inverse BEMD
of color images
4. EXPERIMENT RESULTS
After the color image fusion algorithm being developed, two
sets of partial focused images shown in Figures 3 and 4 are
applied as our test images. Due to the limited depth of focus
of optical lens, cameras cannot be focused simultaneously on
all objects at different distances. That is the reason why the
images in Figures 3 and 4 are defocused.
Two fusion experiments by the two sets of defocused im-
ages will be made in this paper. The sizes of two doll im-
ages in Figure 3 are both 248 × 368. And the sizes of two
calendar+book images in Figure 4 are both 160 × 224. Our
simulation work is on a computer with Intel Core-2 Quad as
its CPU. And the simulation program is written with Mat-
lab language. In our experiment, the interpolation is based
upon the Delaunay triangulation [11]. Eight IMFs are com-
(a) Calendar+Book: foreground focused
(b) Calendar+Book: background focused
Fig. 4. The partially defocused images: Calendar+Book
puted for the bivariate BEMD, and 8 directions are used for
the bivariate BEMD computation. The choice of η is 0.0015.
Figure 5 shows the fusion results of the two set images. It
can be observed that the fused result can make the foreground
and background of images clear. Table 1 illustrates the com-
putation time for the proposed algorithm and the ensemble
method. There are 100 ensemble samples used in our experi-
ments.
Algorithm 3 the ensemble tests
Doll 613.97 12814.38
Calendar+Book 239.36 4858.90
Table 1. A comparison of the computation time for Algorithm
3 and the ensemble method
5. DISCUSSION AND CONCLUSION
The proposed method can reduce the computation load for
color image fusion algorithm. In computing BEMD, the 2D
interpolation is the most time-consuming task. So we will
compare the computation load upon the total number of 2D
interpolations for the color image fusion methods.
For the 2D color image fusion by the ensemble method[5],
(a) Doll
(b) Calendar+Book
Fig. 5. Fused Result by the proposed algorithm
the number of 2D interpolations is equal to:
](ensemble)× 2× 5× ](IMF)× 2 (15)
The symbol ] indicates the number of operations. The first
constant 2 in eq.(15) is for the two original images. The con-
stant 5 is to indicate four chrominance real signals and one
luminance component. The last constant 2 is for the maxi-
mum and minimum envelopes. As for the propose method,
the number of 2D interpolations is equal to:
5× ](projection directions)× 2× ](IMF)× 2 (16)
The first constant 2 in eq.(16) is for the factor of com-
plex number interpolation, which includes the real and
imaginary parts. The last constant 2 is also for the max-
imum and minimum envelopes. Here we show a reason-
able choice for parameters to have a comparison of the
computation load. ](ensemble) = 100, ](IMF) = 5,
](projection directions) = 8. Thus the ensemble method
will require 10000 2D interpolations. Our proposed method
only needs 800 2D interpolations. The proposed method
is with more efficient computation, and it can reduce the
mode-mixing.
6. REFERENCES
[1] N. E. Huang, Z. Shen, S. R. Long, M. C. Wu, H. H. Shih,
Q. Zheng, N. C. Yen, C C. Tung, and H. H. Liu, “The
國科會補助計畫衍生研發成果推廣資料表
日期:2013/01/30
國科會補助計畫
計畫名稱: 利用經驗模式分解與四元數賈柏濾波器之影像材質分割技術
計畫主持人: 葉敏宏
計畫編號: 99-2221-E-197-004-MY2 學門領域: 訊號處理
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
