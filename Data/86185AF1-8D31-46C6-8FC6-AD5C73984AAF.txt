中文摘要 
 
本研究希望利用乳房組織顯微鏡切片影像，透過影像處理技術的應用，分析與
乳癌發生之可能相關組織型態及各種與腫瘤相關之特徵參數，藉以提供臨床醫師
在乳癌診斷時之輔助，並應用於乳癌篩檢上。 
研究過程中使用乳房組織切片之 CCD 數位影像作分析，透過影像分割的技術，
包括色彩模型的轉換、臨界值的決定、影像型態學處理、相鄰元素標記法等影像
處理步驟，分割出乳房導管，並取得導管輪廓及乳房導管之內、外緣區域影像，
透過乳房導管特徵參數的擷取，計算影像中乳房導管比例、最大導管面積、乳房
導管厚度、乳房導管內、外緣區域個數以及乳房導管分割影像紋理參數，並將其
導入貝式網路中，藉此分析判斷組織切片影像是否有癌化的情況，提供病理醫師
乳癌組織之形態分析與初步診斷。 
 
關鍵詞：組織學、乳癌、影像型態學、紋理分析、貝式網路。 
 
 
 
 
 
 
一、緣由與目的 
 
1.1  緣由 
在傳統的組織切片的檢查中，都是以粗針抽取或是醫師開刀切取部份組織細
胞，經由染色固定後製成乳房組織切片，再置於顯微鏡下目視觀察，醫師藉著判
斷切片上是否發生組織病變的資訊來做為診斷的依據，但常因為不同切片品質以
及醫師個人主觀判斷和判讀經驗的差異，使得影像判斷的結果會有差異，造成實
際在臨床診斷上的困擾。此種肉眼觀察對於處理檢體時所需耗費相關多的人力，
尤其對於龐大資料量時需耗費更多的判讀時間。 
 
1.2 目的 
本研究的主要目的在於如何利用影像處理與辨識的方法，建立一套電腦輔助
診斷系統，分析乳房切片影像中乳導管之大小、個數、比例及形態，然後利用影
像識別(pattern recognition)的方式找出病灶特徵與乳癌形成之關係，協助醫師
在臨床診斷時，分辨出組織病灶及乳癌嚴重性。 
    因此在本研究中，我們希望利用乳房切片影像，透過影像處理技術的應用，
分析會與乳癌發生率有關之切片細胞型態及各種特徵參數，提供一個以組織切片
及細胞組織學原理為基礎的偵測癌變細胞的方法，提供各種判讀資訊，增加乳癌
黃金標準判斷的準確性，減輕醫師在傳統檢查切片影像判讀上所花費的時間及人
力物力。 
二、研究材料與實驗方法 
 
2.1 研究材料 
本研究中所使用乳癌切片細胞組織影像資料來自於彰化基督教醫院病理科醫
師，在 100 倍光學顯微鏡下，透過 CCD(Charge Coupled Device)成像，取得研究
所需之乳癌組織切片影像，每一影像之解析度大小為 1524x1012 像素大小。 
經由病理科醫師的協助分類，實驗所收集的影像包括：Normal 影像 36 張及
Malignancy 影像 36，總共 72 張影像。 
 
2.2 實驗方法 
本研究主要分為下列步驟：影像分析及前處理、乳房導管分割、導管特徵參
數及紋理分析、貝式網路與系統測試。 
 
2.2.1 影像分析及前處理 
    根據醫師分析一般切片影像包含二個部份，如圖 2.1 所示並說明如下： 
（一）乳房導管與細胞核：乳導管即乳腺管，為導管細胞所形成的封閉管腺，周
圍圍著一圈基底膜，中間所包含的管腔，亦是乳汁分泌的管道。 
（二）間質細胞與脂肪：位於導管細胞周圍的其他組織細胞即為間質，包含血管、
間質細胞以及膠原纖維。 
如溫度、薄切技術和醫師染色技巧等人為因素，也使得組織切片影像上產生染色
不均等情況發生。 
為方便實驗處理與進行，在影像分割處理之前，我們針對每張 M*N 大小的切
片影像 O(x,y)，取得影像中每點像素包含紅、綠、藍頻譜的色彩像素值，分別為
R(x,y)、G(x,y)及 B(x,y)，為減少影像運算量，以及明顯表示出所欲分割的區域，
我們利用下述公式將原始影像轉換為灰階影像。 
),(114.0),(587.0),(299.0),( yxByxGyxRyxA ×+×+×= ………………(2-1) 
再藉由 3×3 大小的平均值濾波器(average filter)，將整張影像平滑化，去除不
必要的雜訊，也可方便接下來的分割步驟的實行。 
 
2.2.2 乳房導管分割 
 
根據上述影像亮度與色彩分析，我們可將乳房組織切片影像分成二群，第一
群為乳房導管和間質細胞核的像素，第二群為間質細胞和脂肪的像素。 
為了有效分割出乳房導管與細胞核，我們採用分群最小變異值(Minimum group 
variance)的 Otsu 演算法，其目的在於找尋一最佳的臨界值 T，使得群集內的變異
數和(Within-class Variance)為最小，群集間的變異數(Between-class Variance)
為最大。一旦對乳房組織切片影像分別執行臨界值分群後，我們即可取得一臨界
值 T，透過此臨界值即可將分群後的各群資料以二值化儲存，藉由臨界值分割出乳
房組織切片影像的導管及間質兩群，如圖 2.2 顯示，我們可以看到所分割出來的
乳導管與間質細胞核。 
 (c) 
圖 2.3、(a)正常切片影像；(b)初步分割結果；(c)去除紅血球細胞後結果。 
 
接下來我們將不屬於乳導管細胞，也就是間質細胞核的區域濾除。首先我們
使用相鄰元素標記法(connected component labeling)，將分割結果中所包含的
物件做標記(Labeling)的動作， 藉由執行上述遞迴步驟後，我們可得到分割影像
中的物件個數，以及每個物件所包含的像素數目。為了有效分辨出細胞核，在與
病理醫生討論後，我們訂出濾除細胞核所需要的閥值 cellT ，實驗中所訂定的閥值 cellT
為 500 個像素，將 RiP 小於 cellT 的物件(細胞核)濾除，如此即可將我們實際所需之
乳房組織中屬於導管的部份分割出來，其結果會如圖 2.4 所示： 
 
 
(a)                           (b) 
圖 2.4、(a)初始影像，(b)間值細胞核移除後結果 
 圖2.6、乳房導管邊緣
 
    接著我們同樣使用相鄰元素標記法將導管內緣取出，得到如圖 2.7 影像，在
此所設的臨界值為 ductT (實驗中所定為 50000 像素)，同時可得到導管內緣的個數
innerN 。 
 
圖2.7、乳房導管內緣區域
 
接著如圖 2.8 所示，將圖 2.7 所取得的內緣區域填回圖 2.6 的乳導管影像而得到
外緣影像，同時藉由相同的方法得到導管外緣的個數 outterN 。 
 
 (a)                            (b) 
 
(c)                           (d) 
圖 2.9、(a)正常切片影像；(b)圖 a 之分割結果； 
(c)異常切片影像，(d)圖 c 之分割結果 
 
(3) 導管厚度：如圖 2.10 所示，若導管發生不正常增生的情況，其面積會比正常
導管大上數倍，而導管管壁的厚度也相對增加。本研究中在取得內緣影像後，會
針對每個導管內緣進行運算。找出任一導管 ，其內緣的重心座標位置為KR
),( yxOk ，其公式表示如下： 
∑
∑
=
=
=
=
KR
K
KR
K
P
j
jK
R
K
P
j
jK
R
K
yP
P
y
xP
P
x
1
1
)(1
)(1
………………………………(2-4) 
KR 為乳導管的編號， )()( jKjK yPxP 、 表在第 K個乳導管內任一像素的 x、y座標值。 
∑
=
=
360
08
1_
θ
θKK DmeanD …………………………………(2-6) 
}..,,.........,,{_ ,,3,2,1 meanNmeanmeanmean RDDDDMaxdisMax = ………………(2-7) 
上式中，dis 代表任兩點的歐基里德距離， meanDK _ 為平均厚度， disMax _ 為從
所 有 導 管 平 均 厚 度 中 找 出 的 最 大 平 均 導 管 厚 度 ， θ
,180,135,90,45,0 ooooo= ooo 315,270,225 。              
 
 
圖2.12、導管厚度搜尋示意圖
 
(4) 內緣管腔數目：乳導管是由一層乳導管細胞所構成，結構上導管會形成一個
封閉對稱的環型，若因導管內細胞不當增生，而將原始管腔分隔成數個不同的小
管腔，會使得內緣管腔的數目不正常的增加。如圖 2.13(a)所示為一癌化之切片影
像，圖中左下方紅色框所圈選之乳導管已增生為原正常乳導管的數倍之大，同時
在圖 2.13(c)中觀察到，癌化乳導管的內緣管腔已被破壞，原本單一的管腔被增生
的乳導管細胞所區隔成多個細小的內緣管腔，在此我們擷取在取出導管內緣區域
時，計算所得到的內緣數目 innerN ，來做為判斷的標準之一，即可判斷出異常與否。 
 
 (a)                                (b) 
圖2.14、導管被破壞成碎裂狀態，(a)癌化破碎影像，(b)圖a之分割結果
 
    在取出上述各項特徵後，經過與醫師討論，針對癌化切片影像的特性，訂定
出如下各特徵判斷標準的臨界值，包括乳房導管比例：
rateDuct
T 、最大導管面積：
MAXR
T 、導管厚度： disMaxT _ 、內緣管腔數目： innerNT 及外緣管腔數目： outterNT 。 
除了上述幾項評估準則外，再根據影像分割時所獲得的二元影像，求出其距
離為 1，角度為 45 度角的二維灰度伴隨矩陣， 
∑∑
= =
=
M
l
N
k
dd kljiW
1 1
,45, ),(),( θδ …………………………………………………………(2-8
) 
⎩⎨
⎧ =++==
otherwise
jklIiklIif
kld 0
)1,1(,),(   1
),(45,δ ………………………………………(2-9) 
∑∑−
=
−
=
= 1 1
0
45,
45,
),(
),(
],[ L
oi
L
j
d
d
jiW
jiW
jiP
…………………………………………………………(2-10) 
接著將結果導入下述之公式，計算出影像之熵值(Entropy)、對比度
(Contrast)、能量值(Energy)及均勻度(Homogeneity)等紋理特徵， 
比對結果顯示，影像之特徵參數明顯大於我們所設定之臨界值時，即為異常的影
像，若無異常顯示時，再導入貝式網路的分類階段。 
貝氏網路分析
異常組織影像
⇒
⇒
>>>>>
   
    _     _
otherwise
TNorTNorTdisMaxorTRorTDuctIf
outterinnerMAXrate NouttrtNinnerdisMaxRMAXDuctrate
 
…………………………………(2-15) 
尤其在以貝式網路進行乳癌分類時，我們須計算影像所含熵值(Entropy)、對
比度(Contrast)、能量值(Energy)及均勻度(Homogeneity)等紋理特徵值，利用訓
練樣本訓練所得之參數，得到各項特徵所代表之正常與異常機率值，並將所得之
機率值導入 3.32 式中，計算出樣本在各項特徵下屬於異常影像或正常影像之機率
值： 
∏
=
=
N
k
i
k
i
N
i HePHPeeHP
1
1 )|()(),....|( α ………………………(2-16) 
接著比較正常與異常機率值，並將結果做正常或異常乳房組織影像的分類。 
 
2.4 系統評估方式 
 
一旦經由系統分析細胞參數後，我們可以透過診斷的準確率進行系統效能評
估。其中，所測試的參數包含了內、外緣導管數目、乳房導管比例等等，不過為
了實際運用於臨床上，開發出具有良好的運算能力及高準確的診斷能力是一穩定
系統必要的要求。在本研究中我們以辯識正常組織切片影像與異常組織切片影像
的準確性做效能的評估，基本上本研究將以臨床醫師的診斷結果與本系統之準確
 三、實驗結果與討論 
 
接下來我們將依據第二章所述之灰階轉換、影像分割、特徵擷取等方法，實
作在不同影像上，並將結果一一呈現。 
    首先，在灰階轉換步驟時，我們依照使用者需求之特徵，將彩色 RGB 影像做
灰階轉換，強調出使用者所需之乳房導管部位；在影像分割步驟時，由於影像分
割目的是將從背景中強調出之導管細胞，我們透過影像分割演算法，將所感興趣
的特徵部位從背景中擷取或分離出來。最後透過系統計算功能，針對分割後之各
細胞進行各種特徵擷取，當所有特徵參數擷取完成後，最後將這些特徵參數導入
貝式網路中，做為判斷出影像之異常與否之依據，以下列出部份影像處理結果，
並針對結果予以討論或描述。 
 
3.1 灰階轉換 
 
    在圖 3.1 中，我們將原始影像的 R、G、B 像素值轉換為灰階影像表示，藉以
突顯出切片影像中，我們感興趣之乳房導管部份，圖 3.1(a)為正常組織切片影像，
圖 3.1(b)為異常組織切片影像，兩者在染色程度上，明顯有很大的不同，但影像
中還是很明顯可以觀察到，乳導管及間質細胞核的部份會呈現較低的灰階，而間
  
(a)                            (b) 
 
(c)                            (d) 
圖3.2、經由Otsu演算法分割的結果、 
(a)正常組織切片影像；(b)圖 a 之分割結果； 
(c)惡性腫瘤組織切片影像；(d)圖 c 之分割結果。 
 
3.3 去除紅血球之處理 
     
但是在部份組織切片影像中，由於人工穿刺手術取得切片技術的影響，會使
得部份組織切片影像中會如圖 3.3(a)所示，影像夾雜了一些紅血球的部份，有鑑
於此，我們利用直方圖分析的模式，將具有較高紅色成份，屬於紅血球的像素濾
除(見圖 3.3(c))。此一步驟主要的目的在於去除分割影像中包含紅血球部份，但
得到我們所需之乳房導管分割影像。 
當我們得到最後之乳房導管分割影像後，可藉由第二章所提到的影像型態
學，斷開運算及邊界偵測的處理方法，其結果會如圖 3.5 所示，得到乳房導管的
邊緣影像。 
 
(a)                               (b) 
 
(c) 
圖3.4、雜訊移除結果、(a)正常組織切片影像；
(b)圖a去除紅血球後的分割結果；(c)圖b去除間質細胞核後之結果。
 
 
 (a)                          (b) 
 
(c)                          (d) 
圖3.7、乳房導管外緣區域、(a)正常組織切片影像；(b)圖a之分割影像；
(c)圖b之導管內緣區域；(d)圖b之導管外緣區域。
 
3.6 貝式網路訓練和測試 
 
經系統對影像各特徵參數進行運算所得之結果顯示，明顯的本研究所選取之
特徵參數在正常組織與異常組織上均有差異性。因此，實驗中之貝氏網路會利用
實驗步驟中所擷取之特徵參數，以監督式學習的方式，針對訓練影像進行貝氏網
路樣本訓練。 
貝氏網路會依據各特徵參數之參數值大小，自動給定參數的條件機率。在此，
我們使用了K-次交叉驗證法來提升貝式分類法的準確率，首先我們將 72 張影像樣
2G 之表3.4、群組 樣本辨識結果
 正常影像 異常影像 
系統判斷為正常 31 TN 13 FN 
系統判斷為異常 5 FP 23 TP 
總計 36 36 
 
3G 之表3.5、群組 樣本辨識結果
 正常影像 異常影像
系統判斷為正常 31 TN 14 FN
系統判斷為異常 5 FP 22 TP
總計 36 36
 
4G 之表3.6、群組 樣本辨識結果
 正常影像 異常影像 
系統判斷為正常 31 TN 8 FN 
系統判斷為異常 5 FP 28 TP 
總計 36 36 
 
由上面各表所列出的結果觀察，我們發現在群組 的訓練中可得到最好的辨
識結果，在下表 3.7 中計算出群組 所建立出的貝式網路分析系統，其Accuracy、
Sensitivity 及Specificity，來確認貝式網路的辨識的效果。 
4G
4G
 
表3.7、練組效能評估結果
 Accuracy Sensitivity Specificity 
Performance 81.94% 77.78% 86.11% 
     
四、結論 
 
 國內乳癌的發生率逐年增加，於民國八十五年超越子宮頸癌，成為婦女十大
死因的第四位，並有逐年增加的趨勢。臨床上對於乳癌之診斷，通常是婦女自我
檢查發覺異狀，自行到醫院就診，通常先經由醫師觸診後，再藉由乳房 X 光攝影
或乳房超音波影像檢查，若有疑似癌化的部位，再以細針抽吸或手術切片等方式
採樣，進行組織病理檢查，以達到早期發現早期治療的目的，以期提高治癒的機
率。 
而病理醫師診斷時，會造成其判讀困難的原因，除了樣本染色的好壞及醫師
判讀的經驗外，其他包括病患的年齡、影像品質、採樣技術、乳房密度等，皆會
影響醫師診斷的正確性。在大量檢查時，對於醫師的體力與精神力更是一大負擔。 
本研究以組織學和影像處理技術為基礎，建構出一套乳房組織影像處理與分
析系統，本系統可協助病理科醫生於臨床上分析及判斷乳房組織切片，決定乳房
導管及病灶所在，提供客觀的診斷結果。 
事實上，國內外以乳癌組織學的相關研究非常少或其甚少以電腦或影像處理
技術做為診斷基礎，本研究中最主要提出了一套以組織學為基礎之乳房導管的分
割方法，偵測出乳導管區域，並擷取出乳導管之內外輪廓邊緣，量化出與組織型
態或癌變的有關參數，便於醫生做各種觀察檢測，也可將其應用在實際病理學的
診斷上由於本研究與病理醫師的合作，因此充分量化乳癌組成的參數，做為評估
乳癌的診斷依據，實驗證實本研究所提出的診斷結果有很高的準確率，也很有效
五、參考文獻 
 
[1] N. H. ANDERSON, P. W. HAMILTON, P. H. BARTELS,D. THOMPSON, R. 
MONTIRONI and J. M. SLOAN,”Computerized scene segmentation for the 
discrimination of architectural features in ductal proliferative lesions of the breast, ” 
Journal of pathology, vol. 181: 374–380 (1997). 
[2] P. Bamford and B. Lovell, “Unsupervised cell nucleus segmentation with active 
contours,” Signal Processing, 203-213,1998. 
[3] M. J. Bottema and J. P. Slavotinek,” Detection and classification of lobular and 
DCIS (small cell) microcalcifications in digital mammograms,” Pattern Recognition 
Letters vol: 21, Issue: 13-14, pp. 1209-1214, December, 2000. 
[4] H. C. Chen, W. J. Chien, and S. J. Wang, “Contrast-Based Color Image 
Segmentation,” IEEE vol. 11,  Issue 7, Page(s):641 – 644, July 2004. 
[5] G. R. C and R. E. Woods, “Digital Image Processing / 2nd edition,” Prentice Hall, 
2001. 
[6] 巫宗昇，”利用彩色資訊之肝切片電腦影像分割”，成功大學資訊工程研究所碩
士論文，1992。 
[7] 季瑋珠，張金堅，”本土醫學資料庫之建立及衛生政策上之應用”，1993 
[8] 國家衛生研究院 癌症研究組 TCOG 乳癌研究委員會，”乳癌診斷與治療共
識”，2004 年 10 月。 
[9] 馮齡儀，”電腦輔助子宮頸抹片異常細胞辨識之初期研究”，中大學醫學工程研
究所碩士論文，2004。 
