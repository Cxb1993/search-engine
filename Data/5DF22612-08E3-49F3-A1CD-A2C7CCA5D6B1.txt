 I 
 
目錄 
 
（一）中文摘要                                             I 
（二）英文摘要                                             II 
（三）報告內容 
  一、前言與研究目的                                  1 
  二、研究方法                                        2 
  三、結果與討論                                      10 
  四、結論與建議                                      17 
（四）計畫成果自評部分                                     19 
（五）附錄                                                 21 
 
 
 1 
 
（三）報告內容 
一、前言與研究目的 
 
從過去文獻的研究結果中可以發現，在動作發生時，雖然都伴隨著有ERD、ERS的出
現，可以用來做為動作的判斷，但是實際在實驗時會發現，不同的受試者之間，個體變異
性很大，光是使用 ERD、ERS 來做為判斷，穩定性不夠，必須配合其它的量化方法，才能
提高動作判斷的準確性。 
腦功能是由相當複雜的神經網路所構成，如額葉 -頂葉所在的注意力網路 (the 
frontal-parietal attention network)、或是靜息狀態網路(the resting state network)、運動網路
(the motor network)等[1]。大腦是依循著不同頻率組成的一個複雜系統，可以利用神經系
統在群落間的同調性(coherent)，來達到互相溝通的功能，其功能整合(functional integration)
是一種全面性的影響，也就是腦區間的交互作用與功能的連結，而不僅僅是只有腦區內的
作用[2,3] 
傳統上，對於大腦電磁訊號的量化分析，一向是基於頻譜分析(spectrum analysis)方
法，其中一個核心假設是將訊號的發生視為穩定程序(stationary process)。透過對大腦病理
或是運動障礙者之大腦電磁、電波圖的觀察，有大量證據指出大腦的活動乃是動態的非線
性、非穩定(non-stationary)程序，因此對於訊號的非線性性質進行度量似是可以為之。至
今已有許多訊號的時間－頻率表示法(time-frequency representation)及相依於時間的度量法
(time-dependent measure)被提出，用以強調對大腦瞬息與非規則事件的研究，這其中尤以
互信息法(mutual information，MI)為最。互信息法擁有線性及非線性性質，利用高階統計
法及混亂量度等基於資訊理論之方法，計算訊號含有之訊息量，藉此研究腦皮質間溝通，
認定大腦訊號之產生為隨機程序，對一時間序列之混亂度的量化。[4] 
在過去的文獻中指出，以時域為主的交互信息法(cross mutual information， CMI)用在
寬頻帶分析上不夠值得信賴[5,6]，於是我們需要選擇一個適當的頻帶以利分析。本子計畫
的試驗是實際手臂上抬運動，由於動作幅度較大且實驗動作多次，受試者的 β頻帶 ERS 較
為明顯，而α頻帶 ERD 在不同受試者之間有所不一樣，且並不一定明顯，因此我們選擇與
執行動作相關的 β頻帶做為主要探討的神經網路，預期辨別特徵會較為明顯，使系統在動
作發生時的辨識準確性提高。 
在此我們運用交互信息法(cross mutual information, CMI)與數種不同方式比較，以期從
單筆腦電波訊號中擷取出有利於事件判別(偵測上抬運動與左右手辨識)的特徵，來建立一套
高準確性與時效性的分析流程，適用於即時腦波辨識分析系統。 
判斷流程中有兩層分類，分辨上抬運動與休息狀態與辨別左手臂和右手臂上抬運動，
本子計畫內容則主要環繞在討論此兩種分類。我們針對不同受試者利用時間頻率圖形尋找
其各自適合的頻帶，在上抬運動與休息狀態之分類上，將比較交互信息特徵與傳統β能量
反彈特徵；在左手臂和右手臂上抬運動之分類，我們取手臂運動試驗中較特徵顯著的時間
區段訊號並比較三種具不同特性之濾波方式，帶入交互信息法，即 Morlet 小波轉換濾波、
本質模態函數濾波、巴氏帶通濾波，與兩種不同交互信息特徵組合(全腦交互信息組成圖
 3 
 
本實驗為左右手臂上抬運動。受試者坐在離電腦螢幕 90 公分遠的地方。同時，他們被
要求手臂和手要放鬆和處於舒適的狀態，在資料擷取時盡量避免眼動。 
實驗中每 10 秒為一個重複的試驗。在第一秒時會出現全黑螢幕，此時受試者可以自由
的眨眼，之後九秒會有個十字請受試者注視，在第五秒時會出現一個視覺的箭頭指示，請
受試者左手或右手手臂上抬，此時定義為起始時間點(onset time) (如圖 2)，而從動作起始時
間點的-3 秒到 4 秒試驗的訊號，將被當成一筆試驗來進行接下來分析。每位受試者分別重
複 140 個右手臂上抬的試驗和 140 個左手臂上抬的試驗。 
 
圖 2. 左右手臂上抬的實驗設計流程圖。時間區段 A(0~1)可以眨眼。區段 A 後會出現一個
十字出現在螢幕，然後一個視覺的圖像信號會出現在時間點 B，時間區段 C(2~9，信號起始
時間點的前 3 秒到後 4 秒)視作一筆試驗資料。 
 
3. 分析方法 
使用 CMI 進行特徵擷取 
在我們的實驗中，每一個試驗的腦電波資料包含 3501 個點(動作起始時間點的-3 秒到 4
秒)，首先使用 α-相關或 β-相關的 IMF 對腦電波其他通道的數據做環形卷積[7]。 
CMI 的計算是基於熵(entropy)和聯合熵(joint entropy)如下敘述： 
已濾波的第 i 個通道訊號可視為一隨機變數 Fi，它的機率密度函數(probability density 
function, pdf) 定義為 p(Fi,b)。熵是一種表示資訊平均總額的方式，反映出不確定性
(uncertainty)的程度。隨機變 Fi 的熵定義為 H(Fi)，表示如下。 
∑
=
−= b
N
b
bibii FpFpFH
1
,, )(ln)()(
                          (1) 
其中 b=1,2,…,Nb 是在透過資料 histogram 來估計 pdf 時，所使用的取樣數(sampling 
bins)。相同地，將第 i個和第 j個通道的聯合機率密度函數(joint probability density fnction ,jpdf) 
定義為 p(Fi,b, Fj,b)。聯合熵定義為 H(Fi,Fj)，表示如下。 
∑
=
−= b
N
b
bjbibjbiji FFpFFpFFH
1
,,,, ),(ln),(),(                (2) 
 5 
 
 
圖 3 交互信息特徵組合圖(A)為全腦交互信息組成圖(28×28)，將其每一行(或列)加總可得(B)
總耦合強度拓樸圖，將 A 取出第 13 行和第 14 行(C3 和 C4)即可分別將之表示成(C)C3 頻道
交互信息拓樸圖和(D) C4 頻道交互信息拓樸圖。 
系統判斷流程 
在本子計畫中，將運用交互信息法，找出頻道間功能連結的程度或耦合(coupling)程
度，期望能在單筆腦電波訊號擷取出重要特徵並藉此發展左、右手臂上抬運動判斷流程，
概要架構如圖 4。而此流程中需要兩層分類器，第一層分類器是用來辨識受試者處於動作
狀態或是休息狀態，當辨識結果屬於動作狀態時，接著進入第二層分類器，此分類器是用
來判別左手臂上抬運動或右手臂上抬運動。 
 
 7 
 
eventN
TPE:TPR
                                   (4) 
 
NICPN
FPW:FPR
                                   (5) 
 
其中正確的陽性事件次數(TPE)是以事件(一次手臂運動)為單位，在事件發生後 ICP 區
段有被標記為動作狀態，即為正確的事件。TPR 即是正確的陽性事件次數除以事件次數
(即手臂運動次數)。不正確的陽性區段次數(FPW)則是 ICP範圍外，被歸類為動作狀態的區
段。FPR 即是不正確的陽性區段次數除以非 ICP 的區段數量。  
 
 
圖 6 試驗分區示意圖。每個試驗 7 秒鐘以 1 秒為一個單位，每隔 0.5 秒切一個區段，一個
試驗可以切 13 個區段(即區段-6 到區段 6)，ICP 則針對不同特徵特性定義。 
 
第二層:左右手臂上抬運動的分類 
我們只取手臂運動試驗中特徵顯著的時間區段訊號，由於交互信息法需要訊號在適當
的頻帶以利方法的運作，於是本子計畫利用三種具有不同特性之濾波方法，Morlet 小波轉
換(Morlet Wavelet Transform)濾波、本質模態函數(Intrinsic Mode Function， IMF)濾波(下
段 a.b會再仔細說明這兩種濾波的流程) 、巴氏帶通濾波(Butterworth band pass filter)，擷取
出 β相關頻帶的腦電波訊號，並比較這三種濾波方式的效益。 
這部分分類的交互信息特徵組和除了利用完整地描述運動網路的全腦交互信息組成圖
(whole-brain CMI map)，我們也重複相同的分析步驟但只擷取 C3 和 C4 跟其他頻道的交互
信息，我們稱此種簡單的特徵組和為運動相關交互信息向量(motor-related CMI vector)。 
擷取出特徵後，利用主成分分析法與費雪線性區別分析法，壓縮並投影資料，再利用
兩群訓練資料(左手運動及右手運動)的平均值 m1、m2 與標準差 s1、s2找出閥值，其方式為
計算兩群資料平均值的中間點再以兩群標準差加以修正，即(m1+m2)/2 × s1/(s1+s2)，運用
 9 
 
變化也因受試者而異，因此本質模態函數分量是一特定試驗和特定受試者的濾片，所有頻
道的腦電波經過這種特定試驗濾波器進行環形卷積，預期將可濾出其他頻道數據中與運動
相關的成分，用以提升左右手分類的準確性。 
 
 
圖 8 本質模態函數濾波器流程圖 
 
4. 即時辨識 
本子計畫中除了採用離線分析的方法去辨識手臂上抬時的腦波訊號特徵外，另外還依循
著離線分析時的實驗步驟，在辨識運動與休息狀態的部分採用 Cz 頻道的 β 能量作為判斷
方式(分類流程如圖 5)，而左右手的辨識，則是將訊號以巴氏帶通濾波器，擷取出β相關
頻帶的腦電波訊號，並以運動相關交互信息向量作為判別依據(流程如圖 7)，初步完成了
一套即時的線上腦波資料擷取與辨識系統，建立個人化的腦波特徵資料庫、進行即時的手
臂上抬運動判別，使得受試者執行單一手臂上抬運動時，能即時分析資料、辨識，並將其
輸出做為機械控制之輸入。 
即時辨識系統之使用者介面 
這套即時辨識系統之使用者介面主要是利用圖形以及文字，簡單的顯示接收到的訊號
分析結果。如圖 9 所示，整個使用者介面包含了十個部分，分別即時展示不同的運算結果，
各部分展示與意義敘述如下： 
A. 辨識手動正確率：顯示當手臂上抬後，經由計算能辨識出手動的正確率。 
B. 眼動訊號：實驗進行時，若偵測到眼球運動，則會顯示如圖的眼睛圖形，若沒有偵測
到眼球運動，則圖形為空白。 
C. 辨識左右手正確率：顯示當辨識出手動之後，判別出左手或右手的正確率。 
D. 辨識左右手：若辨識出左手(或右手)有上抬運動，D.1(或 D.2)會秀出立體的手掌圖形(如
D.2)，反之，秀出一個灰色的手掌輪廓(如圖 D.1) 
E. 實際手動：實際左手(或右手)有上抬運動，E.1(或 E.2)會秀出立體的小手掌圖形(如 E.2)，
 11 
 
為區段 1~6，平均 TPR 為 84%±15%，而 ICP 為區段-1~1，平均 TPR 為 75%±7%。 
表 1 FPR 為 10%，上抬運動與休息狀態分類的正確率 
特徵 β能量 交互信息 
ICP 區段 1~6 區段 1~6 區段-1~1 
受試者 S1 87 % 97 % 69 % 
受試者 S2 99 % 93 % 65 % 
受試者 S3 74 % 73 % 81 % 
受試者 S4 91 % 94 % 81 % 
受試者 S5 55 % 63 % 77 % 
平均 81 % 84 % 75 % 
標準差 17 % 15 % 7 % 
在分類上抬運動與休息狀態中須透過 ROC 曲線來輔助閥值的選擇。ROC 曲線是利用
不同的閾值顯示真陽性比率(TPR)及偽陽性比率(FPR)的圖形。利用 ROC 曲線，可觀察閾
值與 TPR、FPR 的關係，進而在 TPR 與 FPR 的矛盾中取得平衡選擇合適的閾值。 
圖 10 為五位受試者不同特徵與 ICP 區段的訓練資料、測試資料 ROC 曲線，兩曲線中
兩端閾值分別為動作狀態與休息狀態訓練資料(經由費雪線性區別分析法後之投影點)的平
均值，圖中紅、藍線分別為訓練資料、測試資料之 ROC 曲線。從圖中我們觀察訓練資
料、測試資料 ROC 曲線的異同：兩條曲線差異越小表示訓練與測試資料差異小，也表示
訓練模型已經足以表示測試資料，資料穩定性夠。我們觀察這兩種不同特徵，發現 β 能量
特徵兩曲線差異較小；而交互信息特徵差異較大，且測試資料 ROC 曲線有向左偏移的現
象，也就是整體上來看 FPR 增加了。 
上表是為利用測試資料的 ROC 曲線選定固定 FPR 所呈現結果，但在實際運用上，需
從訓練資料上選取適合閾值，經過觀察訓練資料的 ROC 曲線與閾值的關係，發現閾值設
定為 0 即最佳切斷點(最靠曲線左上角的點)也符合在 FPR 為 10%左右或以下，表 2 為閾值
設定為 0，受試者們各特徵的 TPR 和 FPR。β 能量當作特徵(ICP 為區段 1~6)，五位受試者
平均 TPR 為 82%、平均 FPR 為 9%，而以交互信息當作特徵，ICP 為區段 1~6，平均 TPR
為 97%、平均 FPR 為 22%，另 ICP 為區段-1~1，平均 TPR 為 91%、平均 FPR 為 23%。我
們發現交互信息特徵的 TPR 雖然都達 90%以上，但相對的 FPR 也升高。 
表 2 以經驗選擇閾值，上抬運動與休息狀態分類的 FPR 和 TPR 
特徵 β能量 交互信息 
ICP 區段 1~6 區段 1~6 區段-1~1 
 TPR FPR TPR FPR TPR FPR 
受試者 S1 82 6 98 12 93 27 
受試者 S2 88 2 98 17 93 29 
受試者 S3 80 11 97 32 95 25 
受試者 S4 83 4 94 10 90 17 
受試者 S5 78 23 95 38 85 19 
平均 82 9 97 22 91 23 
標準差 4 8 2 12 4 5 
 
 13 
 
S5 則較難以判斷。二、β 能量反彈的強度也不同，我們將能量反彈的最大強度除以休息狀
態基準值：受試者 S1 為 4、受試者 S2 為 5.8、受試者 S3 為 2、受試者 S4 為 4.4、受試者
S5 為 1 左右。 
結果顯示，以 β 能量為特徵的辨識率跟 β 能量反彈的強度相關，如果反彈強度遠大於
休息狀態的強度就會得到較好的結果，不顯著的 β 能量反彈會得到較低的辨識率，例如受
試者 S5。 
 
圖 11 五位受試者各區段的平均 Cz 頻道 β能量。紅色的虛線為基準線，其為前四個區段(區
段-6~-3)β能量的平均。 (A)受試者 S1 的平均 β能量，只可看見 ERS，β能量反彈最大是在
區段 3，而區段 3 之最大值與其基準比為 4  (B) 受試者 S2 的平均 β能量，β能量反彈最大
是在區段 3，其最大強度與基準的比為 5.8  (C)受試者 S3 的平均 β能量，可以清楚的看見
ERD(區段 0 和 1)和 ERS，β能量反彈最大是在區段 3(如不考慮因小時段濾波所造成的誤差，
區段內一開始訊號的大震盪)，其最大強度與基準的比為 2  (D)受試者 S4 的平均 β能量，β
能量反彈最大是在區段 2，其最大強度與基準的比為 4.4  (E)受試者 S5 的平均 β能量，沒
有明顯的 ERD 和 ERS。 
圖 12 顯示五位受試者的全腦交互信息拓樸圖 (由全腦組成圖加總得來，見 3.1 節說
明)。圖中(A)顯示受試者 S1 隨著時間而變化的耦合關係，『由區段-6 到信號起始時間點附
 15 
 
色時段的差異值總和為 193.9(C)受試者 S3 的全腦交互信息拓樸圖，其藍色與綠色時段的差
異值總和為 198.8，紅色與綠色時段的差異值總和為 68.3(D)受試者 S4 的全腦交互信息拓樸
圖，而藍色與綠色時段的差異值總和為 326.5，紅色與綠色時段的差異值總和為 123.3(E)受
試者 S5 的全腦交互信息拓樸圖，其藍色與綠色時段的差異值總和為 267.9，紅色與綠色時
段的差異值總和為 87.9。 
左右手辨識率 
經過巴氏帶通濾波和 Morlet 小波轉換濾波、本質模態函數(IMF)濾波，而特徵組合為
全腦交互信息組成圖之平均辨識率分別為 83%、75%、76%；經過此三種濾波方式所得的
運動相關交互信息向量平均辨識率分別為 80%、77%和 72%。各個受試者不同濾波方式及
特徵組合的辨識率如下表 3。 
 
表 3 手臂上抬運動腦電波之辨識率 
特徵組合 全腦交互信息組成圖 
(whole-brain CMI map) 
運動相關交互信息向量 
(motor-related CMI vector) 
濾波方式 巴氏帶通 Morlet IMF 巴氏帶通 Morlet IMF 
受試者 S1 100 99 88 99 98 87 
受試者 S2 86 69 72 77 69 64 
受試者 S3 65 67 84 60 70 74 
受試者 S4 88 74 70 91 78 67 
受試者 S5 78 66 65 73 68 66 
平均(%) 83 75 76 80 77 72 
標準差(%) 13 14 10 15 13 9 
 
左右手特徵樣式的差異 
圖 13 為受試者 S1 以巴氏帶通濾波之平均交互信息特徵圖。圖中(A-1)為左手運動的全
腦組成圖，可以看到第 15 列(C4 頻道與全腦的耦合程度)整體較第 13 列(C3 與全腦的耦合
程度)有較高的值；圖中(A-2)右手的全腦組成圖則反之，整體第 13列的值高於第 15列；利
用雙列相關係數計算左右手運動差異特徵如圖中(A-3)，顏色越偏圖軸兩端表示差異值越
大，我們發現左右手運動除了 C3、C4 頻道，其他頻道也有明顯的差異。圖中(B)為全腦交
互信息拓樸圖，更清楚地顯示：與手臂運動同側的頻道耦合值較低(其與全腦總耦合程度
較低)；而對側耦合值較同側高的現象。由特徵差異圖(B-3)我們發現左右手運動耦合有明
顯差異的區域在頂葉區(parietal lobe)，且差異值有對稱現象：拓樸圖右側 C4、CP2、
CP6、P4 頻道差異值偏紅(表示左手耦合程度較右手大)；左側 C3、CP1、CP5、P3 頻道差
異值則偏藍(右手耦合程度較左手大)。 
由全腦組成圖即可看到左手臂運動對側 C4 頻道耦合向量較同側 C3 顯著；右手臂運動
對側C3頻道耦合向量較同側C4顯著。我們把此兩頻道(C3和C4)耦合向量用拓樸圖表示，
如圖 12 C 與 D，發現手臂運動對側頻道的交互信息拓樸圖也有這現象(對側的頻道耦合值
較高；而同側耦合值較低)：如圖(C-2)顯示 C3 頻道與同側頂葉的頻道有較高的耦合，與對
側頂葉頻道有較低的耦合，而(D-1)亦然。而運動相關交互信息向量之差異特徵圖也顯示
如全腦特徵拓樸一樣的結果，如圖(C-3)(D-3)。 
圖 14為其餘四位受試者(S2、S3、S4、S5)以巴氏帶通濾波之交互信息特徵圖。雖然不
 17 
 
 
圖 14 四位受試者(S2、S3、S4、S5)以巴氏帶通濾波之交互信息特徵圖。 (A) 四位受試者
的左手臂上抬運動平均全腦交互信息拓樸圖(B) 四位受試者的右手臂上抬運動平均全腦交
互信息拓樸圖(C)左右手差異全腦交互信息拓樸圖，偏紅表示左手耦合程度較大；偏藍表示
右手耦合程度較大(D) 左右手差異全腦交互信息組成圖。 
 
即時系統辨識結果 
在即時辨識運動與休息狀態的部分，我們在眼動可能會影響到判斷結果的範圍內，如
果偵測到眼動訊號，就將此筆試驗排除不列入計算，因此辨識率平均可達到 90%(最好的為
93%，最差的為 87%)，而以受試者 S1 來說，FPR 甚至已可降低至 0；在辨識左右手的部分，
整體平均為 74%，與離線分析結果，辨識率下降了 6%，而原來辨識結果較好的受試者 S1
也由 99%下降到 94%，S4 由 91%下降到 89%，其他受試者辨識率則都低於 60%。 
 
四、結論與建議 
本子計畫主要目的為發展辨別左右手臂上抬運動腦電波之判斷流程，主要分兩部分討
論，第一部分：分辨上抬運動與休息狀態，將比較兩種不同特徵：交互信息與傳統 β 能量
反彈；第二部份：辨別左手臂和右手臂上抬運動，取手臂運動試驗中較特徵顯著的時間區
段訊號，接著以三種具不同特性之濾波方式，Morlet 小波轉換濾波、本質模態函數濾波、
巴氏帶通濾波帶入交互信息法，可得兩種不同交互信息特徵組合：全腦交互信息組成圖、
運動相關交互信息向量，於此部分我們比較不同的濾波方式與特徵組和於此分類辨識之效
用。 
 19 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
□V   達成目標 
□ 未達成目標（請說明，以 100 字為限） 
□ 實驗失敗 
□ 因故實驗中斷 
□ 其他原因 
說明： 
 
 
 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：□V 已發表 □V 已投稿之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 □V 無 
技轉：□已技轉 □洽談中 □V 無 
其他：本計畫執行期間總共發表 SCI 期刊論文 6 篇、研討會論文 5 篇、博士
班畢業論文 1 篇、碩士班畢業論文 2篇  
 
 
 
 21 
 
 
 23 
 
Information. In Proceedings of CACS International Automatic Control Conference, Taipei, 
Taiwan, November 27-29, 2009. 
96年度專題研究計畫研究成果彙整表 
計畫主持人：吳育德 計畫編號：96-2221-E-010-003-MY3 
計畫名稱：智慧型肢體同動機械人系統之研發--子計畫二：智慧型肢體同動機械人系統之同調性分析
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 5 5 100%  
研究報告/技術報告 0 0 100%  
研討會論文 5 5 100% 
篇 
 
論文著作 
專書 1 1 100% 章/本 one chapter 
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
