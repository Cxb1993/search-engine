第二章 問題描述
2
限制標準。本計畫使用同時擾動隨機近似法配合所提出之限制式處理
新方法，來完成上述濾波器成本最小及暫態現象能量最小之目標。
本計畫利用十八個匯流排之電力系統作為測試對象，以
MATLAB 6.5、NeuroSolutions 專業軟體來進行範例系統模擬、數理分
析，模擬結果將可驗證本計畫方法之有效性及準確性。
關鍵詞：電力品質，電容切換暫態現象，小波轉換，巴賽瓦定理，模
糊分類，類神經網路，被動式濾波器，串接電感器
第二章 問題描述
4
features of the transients. Then proper location number for metering
measurements by fuzzy clustering is determined. Finally, the features and
transient source location is trained by neural networks. Diverse patterns
of PQ events are simulated by Matlab6.5/NeuroSolutions software.
The single-tuned filter and switching transient mitigation design are
presented in the second part in this project. The filter cost is minimized
while satisfying the harmonic standard and power factor compensation
for the single-tuned filter design. The pre-insertion inductor method is
used and the switching transient wavelet energy is minimized while
satisfying the capacitor momentary rating for the filter switching transient
mitigation. The Discrete Simultaneous Perturbation Stochastic
Approximation method with a new constraint treatment for achieving the
minimums of the filter cost and transient energies is present in this
project.
Finally, an 18-bus power system is used for testing, Simulation results
obtained by using Matlab6.5/NeuroSolutions show that the proposed
approach is effective and relatively accurate in comparison with existing
approaches.
Keywords: Power Quality, Wavelet Transform, Parserval Theorem, Fuzzy
clustering, Neural Network, Capacitor Switching Transients,
Passive Filter Planning, Pre-insertion Inductors, Discrete
Simultaneous Perturbation Stochastic Approximation.
第二章 問題描述
6
2-7-2 台灣諧波管制標準..................................................... 53
2-7-3 各先進國家諧波管制標準比較................................. 55
2-8 濾波器 ................................................................................. 57
2-9單調式濾波器切換暫態現象的抑制 .................................. 60
第三章 小波理論................................................................................ 62
3-1 簡介 ..................................................................................... 62
3-2 傳統訊號分析方法 ............................................................. 62
3-2-1傅立葉轉換 (Fourier Transform)............................. 62
3-2-2 短時傅立葉轉換(Short-Time Fourier Transform,
STFT) .................................................................................... 64
3-3 小波轉換 (Wavelet Transform) ....................................... 65
3-3-1 小波函數(Wavelet Function) .................................... 66
3-3-2 多重解析度分析(Multiresolution Analysis, MRA) 70
3-3-3 連續小波轉換(Continuous Wavelet Transform,
CWT)..................................................................................... 77
3-3-4 離散小波轉換(Discrete Wavelet Transform, DWT)
................................................................................................ 80
3-4 本計畫使用之小波函數 ..................................................... 81
3-5 小波轉換與傅立葉轉換之比較 ......................................... 84
第四章 類神經網路與模糊理論 ....................................................... 86
4-1 簡介 ..................................................................................... 86
4-2類神經元的模型及架構 ...................................................... 87
4-2-1 生物神經元模型......................................................... 87
4-2-2人工神經元模型.......................................................... 90
4-2-3類神經網路架構與種類.............................................. 97
4-3 倒傳遞神經網路(Back-Propagation Network) ............. 101
4-3-1 簡介 ........................................................................... 101
4-3-2 網路架構 ................................................................... 101
第二章 問題描述
8
Stochastic Approximation, SPSA) .................................... 129
5-1-4 離散同時擾動隨機近似法(Discrete Simultaneous
Perturbation Stochastic Approximation, DSPSA) .......... 131
5-2 考慮不等限制式的最佳化問題 ....................................... 133
5-2-1 處罰函數法 ............................................................... 133
5-2-2 新型不等限制式處理法........................................... 135
第六章 本計畫使用之方法.................................................................. 140
6-1配電系統電容切換暫態之位置判斷研究方法 ................ 140
6-1-1 簡介 ........................................................................... 140
6-1-2 MATLAB小波工具箱之使用 ................................. 141
6-1-3小波轉換特徵值之擷取............................................ 142
6-1-4 模糊分類法 ............................................................... 146
6-1-5 類神經網路 ............................................................... 149
6-2 配電系統單調式濾波器設計之研究方法 ....................... 159
6-2-1 模擬系統之建構....................................................... 159
6-2-2 單調式濾波器設計之數學表示式........................... 163
6-3單調式濾波器投入暫態抑制之研究方法 ........................ 165
第七章 模擬與結果.............................................................................. 167
7-1配電系統電容器切換暫態位置判斷研究 ........................ 167
7-1-1十八個匯流排系統.................................................... 167
7-2 小波係數能量 ................................................................... 170
7-3模糊分類之模擬結果 ........................................................ 180
7-3-1以電流模糊分類分析安置量測儀表........................ 180
7-3-2以電壓模糊分類分析安置量測儀表........................ 181
7-4 類神經網路之模擬結果 ................................................... 183
7-4-1資料描述 .................................................................... 183
7-4-2倒傳遞網路之模擬結果............................................ 185
7-4-3 結合主要成份分析網路至倒傳遞網路之模擬結果
第二章 問題描述
10
圖目錄
圖 2. 1 國際電工學會電力品質事件的定義[4-5] ................................ 29
圖 2. 2 美國電機電子工程師學會電力品質事件的定義[4-5] ............ 30
圖 2. 3 單一電容器切換電路模型 ........................................................ 31
圖 2. 4 單一電容器切換等效電路 ........................................................ 31
圖 2. 5 放大因數..................................................................................... 35
圖 2. 6 當
0
dt
dv
投入時，振盪電流成份之大小 ................................. 37
圖 2. 7 當 coVV  投入時，振盪電流成份之大小 ................................ 37
圖 2. 8 電容性電路之單相電路圖 ........................................................ 41
圖 2. 9 中斷電感電流之電壓與電流圖 ................................................ 42
圖 2. 10 斷路器發生再燃(re-ignition)時之電壓圖............................... 44
圖 2. 11 含一電容器組之配電所之單線圖........................................... 45
圖 2. 12 含一電容器組之配電所之單相電路圖 .................................. 45
圖 2. 13 電感性負載之單相電路圖 ...................................................... 46
圖 2. 14 單調濾波器架構及阻抗頻率響應圖 ...................................... 58
圖 2. 15 等效雙調濾波電路................................................................... 58
圖 2. 16 各類型阻尼濾波器架構圖 ...................................................... 59
圖 2. 17 串接額外電感之濾波器........................................................... 60
第二章 問題描述
12
圖 4. 3 人工神經元模型......................................................................... 90
圖 4. 4 類神經元之數學模型................................................................. 91
圖 4. 5 發生於神經元突觸之「時空性相加」示意圖 ........................ 92
圖 4. 6 常見的轉移函數......................................................................... 96
圖 4. 7 典型的三層網路模型架構 ........................................................ 97
圖 4. 8 單層前饋網路............................................................................. 99
圖 4. 9 多層前饋網路............................................................................. 99
圖 4. 10 循環式網路............................................................................. 100
圖 4. 11 二維的 33之晶格狀網路 ..................................................... 100
圖 4. 12 倒傳遞類神經網路架構圖 .................................................... 101
圖 4. 13 倒傳遞演算法之順向傳遞與逆向傳遞圖 ............................ 102
圖 4. 14 主要成份分析結合多層感知器網路之架構圖 .................... 106
圖 4. 15 二維矩陣之自我組織特徵映射模型 .................................... 110
圖 4. 16 放射狀基底函數網路的架構圖 ............................................ 115
圖 4. 17 放射狀基底函數網路輸出值之求取 .................................... 118
圖 4. 18 常見的歸屬函數圖形[12]...................................................... 120
圖 6. 1 判別電容器位置之流程圖 ...................................................... 140
圖 6. 2 db4 小波轉換............................................................................. 142
圖 6. 3 小波轉換後之能量分佈圖 ...................................................... 144
第二章 問題描述
14
圖 7. 12 五階單調式濾波器電容器容量的疊代過程 ........................ 214
圖 7. 13 五階單調式濾波器諧振點的疊代過程 ................................ 215
圖 7. 14 七階單調式濾波器電容器容量的疊代過程 ........................ 215
圖 7. 15 七階單調式濾波器諧振點的疊代過程 ................................ 216
圖 7. 16 目標函數的疊代過程............................................................. 216
圖 7. 17 加裝濾波器前後的系統的五階諧波電壓 ............................ 217
圖 7. 18 加裝濾波器前後的系統的七階諧波電壓 ............................. 218
圖 7. 19 匯流排十的七階諧波電壓疊代過程 .................................... 219
圖 7. 20 目標函數疊代過程................................................................. 220
圖 7. 21 加裝濾波器前後系統的五階諧波電壓 ................................ 221
圖 7. 22 加裝濾波器前後系統的七階諧波電壓 ................................ 221
圖 7. 23 安裝於匯流排十之五階濾波器的額外串接電感量疊代過程
................................................................................................................ 223
圖 7. 24 安裝於匯流排十之七階濾波器的額外串接電感量疊代過程
................................................................................................................ 224
圖 7. 25 目標函數的疊代過程............................................................. 224
第二章 問題描述
16
表 7. 7 十八匯流排系統依據電壓模糊分類法所得之分類 .............. 181
表 7. 8 十八匯流排系統依據電壓模糊分類法所得儀表放置位置 .. 182
表 7. 9 十八個匯流排系統匯流排與對應電容器之編號 .................. 184
表 7. 10 電容器開關之投入情形......................................................... 184
表 7. 11 輸出神經元編碼..................................................................... 184
表 7. 12 倒傳遞網路之輸入神經元選取 ............................................ 185
表 7. 13 倒傳遞網路之模擬結果比較(1)............................................ 187
表 7. 14 倒傳遞網路之模擬結果比較(2)............................................ 188
表 7. 15 倒傳遞網路之模擬結果比較(3)............................................ 188
表 7. 16 輸入神經元與主要分析成份個數選取 ................................ 189
表 7. 17 主要成份分析網路結合倒傳遞網路之模擬結果比較(1).... 192
表 7. 18 主要成份分析網路結合倒傳遞網路之模擬結果(2)............ 195
表 7. 19 主要成份分析網路結合倒傳遞網路之模擬結果比較(3).... 195
表 7. 20 輸入神經元與自我組織類神經網路之輸出維度選取 ........ 197
表 7. 21 自我組織類神經網路至倒傳遞網路之模擬結果(1)............ 201
表 7. 22 自我組織類神經網路結合倒傳遞網路之模擬結果(2)........ 204
表 7. 23 自我組織類神經網路結合倒傳遞網路之模擬結果(3)........ 205
表 7. 24 放射狀基底函數網路之輸入神經元選取 ............................ 206
表 7. 25 放射狀基底函數網路之模擬結果比較(1)............................ 208
第二章 問題描述
18
第一章 緒論
1-1 研究背景與動機
電力品質問題[1-3]是電力公司與電力用戶最關心的問題之一。
在電力用戶方面，近幾年來，由於高科技產業的蓬勃發展，這些高科
技產業大量使用精密的生產設備與測試儀器，且這些設備與儀器對於
供電品質要求甚高，對電力系統干擾容忍度不像傳統電力設備，部分
的設備或儀器也可能因供應電壓的變動而導致設備跳脫或資料損壞
[5,6]，進而造成用戶重大經濟損失。
一般而言，電力品質問題包括了電壓驟昇(Swell)、驟降(Sag)、電
力諧波(Harmonic)、三相不平衡、頻率飄移等問題。此外，電力系統
中的電磁暫態現象，如電容器切換會造成電壓暫態(Transient)突波事
故，電壓振幅可能因共振現象而放大。雷擊造成之電壓突波頻率更高
達百萬赫茲（MHz），電容器切換與雷擊對於電力電子設備之供電品
質顯然成為嚴重之威脅。
在電力系統中加電容器可獲得以下諸多效益，例如改善功率因數
減少虛功率在系統中的流動可節省電費的支出、提升供電能力、電壓
的改善及減少損失等。因此，適當的裝設電容器組的位置對電力品質
的改善有很大的助益。而當電容器發生投入或切離動作時，所引起輸
配電線上之電壓及電流波形發生大電流及高電壓等暫態現象，卻是擾
亂電力品質干擾的主要關鍵[8,9]。這些暫態高電壓大電流可能會導致
系統設備之誤動作及損毀，甚至會經由配電饋線之傳導而造成臨近網
路的設備燒毀及暫態靈敏性負載中保護設備誤動作並造成重大損
失，進而關係到責任歸屬及賠償等問題。因此電力公司在處理此類電
力事故之原因釐清及責任歸屬等問題上，正確的暫態事故發生時間、
確實位置與嚴重程度等資訊便相當重要。所以，對於電力公司要如何
第二章 問題描述
20
（Window）寬度固定，因此在頻率及時間的解析度上會有相互牽制
的作用，因此短時傅利葉轉換對於電力品質暫態訊號亦無法提供一完
整之解析。為改善上述缺點，許多學者提出小波轉換（Wavelet
Transform）換於電力品質暫態現象的問題上[17,18]。小波轉換具有可
變之時-頻變換特性，可依不同頻率的解析度提供不同的視窗寬度；
換句話說，小波轉換可依不同頻率的組成，將信號分解成不同頻率之
時-頻域視窗。因此，當電力品質事故電壓信號經小波轉換後，會因
信號的不同，而在各階時-頻域上留下不同的信號。依照各階時-頻視
窗之不同的係數值，可作為電力品質事故分類辨識之依據。
為了自動檢視各種不同的電力品質事件問題，需要一個適合之分
類工具，許多學者提出結合小波轉換與類神經網路[19-21]作為監測與
分類電力品質事件之工具，均有相當不錯的成效。但大量的小波係數
亦會對辨識系統造成嚴重的負擔。因此單純利用小波係數作為電力暫
態之特徵值應用上較為困難，必須在對小波係數進行預處理，以期能
找到不為時間軸所影響之特徵值，並能以更少數目之特徵值，作為不
同電力暫態信號之代表。有鑑於此，以小波轉換為基礎的特徵值擷取
方式，已廣泛使用於電力品質事故之分類與辨識。為分類與辨識電力
品質事故，Elmitwally 與 Farghal 等人[22]提出利用均方根值、平均值、
標準差與最大之小波係數值作為輸入辨識系統之代表特徵值。S.
Santoso 等[23] 提議萃取不同分解刻度之小波轉換係數的絕對直當作
特徵值，做為神經網路之輸入資料以分類干擾信號類型。B. Perunicic
等 [24] 提出利用離散小波轉換係數 DWTC)直接當作自組織
(Self-Organizing Map, SOM)神經網路之輸入資料，以分類電力擾動信
號之形式。綜上所述每一種方法皆有其優缺點及準確性，其主要目的
都是為了解決小波轉換產生之龐大小波係數等問題。
本計畫擬建立一套以結合小波轉換與類神經網路為基礎之電容
器暫態源位置辨識系統，並針對龐大特徵值等問題提出巴賽瓦定理
(Parsevals Theorem)及模糊分類法分別做代表特徵值之產生與安裝監
第二章 問題描述
22
目標三：抑制被動式濾波器投入時的暫態現象。
目標四：研究一套快速計算濾波器設計問題的數學方法。
本計畫的研究步驟如下：
步驟一：收集既有之文獻，以了解電容器暫態源位置判斷、單調
式濾波器設計及電容器投入暫態抑制之相關研究方法。
步驟二：利用 MATLAB Power System Blockset Toolbox 來模擬實
際十八個匯流排電力系統，並取得不同電容器切換之所
有匯流排電壓及電流暫態訊號。
步驟三：了解小波轉換之觀念及 MATLAB 小波工具箱之使用方
式，對暫態訊號進行離散小波轉換產生各階小波係數。
步驟四：運用能量觀點，以巴賽瓦定理(Parsevals Theorem)對小
波係數做各階能量的計算，並取前 5 階小波係數能量作
為暫態訊號之代表特徵值。
步驟五：學習模糊理論及開發模糊分類程式，研究如何將模糊分
類方法及特性，應用在代表特徵值選擇及量測儀表之數
量與最佳安裝位置。
步驟六：學習倒傳遞網路、自我組織映射網路、主要成份分析網
路及放射狀基底函數網路等四種類神經網路的基本觀
念並了解類神經軟體 NeuroSolutions 之使用方式。
步驟七：用不同儀表安置組合所取得之暫態特徵資訊做為類神經
網路之數入而對其進行訓練，並比較其相關結果。
步驟八：了解不包含限制條件的最佳化方法及包含限制條件的最
佳化方法。
步驟九：開發 MATLAB 程式來模擬實際十八個匯流排電力系統。
第二章 問題描述
24
(8) 以離散同時擾動隨機近似法為基礎，提出一個快速設計配電
系統單調式濾波器的方法。
(9) 提出一個抑制濾波器投入引起暫態能量最小化的方法。
(10)提出一套不等限制式之最佳化數學方法
1-5 報告架構
本報告共分為七個章節，其組織架構概述如下：
第一章 緒論
主要在概述本計畫之研究背景與動機、文獻回顧、研究目標與步
驟及本計畫之貢獻。
第二章 問題描述
簡介電力系統故障種類及描述電容器切換造成暫態現象之基本
觀念與與抑制原理，及諧波的基本觀念。
第三章 小波轉換
闡述傳統信號分析方法及詳細說明小波轉換的數學理論基礎，
以比較各種信號分析方法之優缺點。
第四章 類神經網路與模糊理論
首先簡介類神經網路之基本原理，並說明本計畫所採用之倒傳
遞網路、自我組織映射網路、主要成份分析網路及放射狀基底
函數網路四種類神經網路的網路架構及學習訓練過程與方法。
概述模糊集合的觀念及簡單的模糊運算，並對 fuzzy-c-means
(FCM)演算法之步驟加以介紹。
第五章 最佳化方法
第二章 問題描述
26
第二章 問題描述
本章將簡介電力系統故障種類及描述電容器切換造成暫態現象
之基本觀念與抑制方法，最後描述電力系統諧波現象及抑制方法。
2-1 電力暫態現象
電力暫態信號在電力系統變動的分析中，是指非自然的不良電力
變化事件，亦即發生短暫非預期的電壓失真波形，其持續的時間從幾
奈秒到幾秒之間。在電力品質暫態現象中，波形失真、電壓暫態、電
力中斷、電壓驟降與電壓驟升等，皆屬於電力暫態信號的一部份。
在電壓陡降或驟升方面，若有大型負載的加入、切離、或系統內
有故障現象發生時，電壓波形通常會由穩態現象，突然產生降低或提
升的暫態現象，隨即恢復穩態電壓。此種電壓突然改變的過程，即為
電力暫態信號的一種。另外，在電力系統內某一饋線發生故障時，在
另一饋線用戶端所發生的電壓陡降甚至中斷的現象，亦能造成電力用
戶電力儀器設備的跳脫。此外，因為電容器組切換而導致的電壓暫態
現象與整流器所造成的電壓陷落現象，皆屬於電力暫態信號。
2-2 電力暫態現象種類
在電力系統中，電力暫態經常用以表達眾多的電磁現象。根據
Daugan 等學者之研究[25,26]指出，電力系統電磁現象之分類與特性
如表 2.1 所示。表中對於穩態與非穩態之電磁現象可用適當屬性加以
描述，穩態的現象可使用如振幅大小、頻率、頻譜與電源端阻抗等屬
第二章 問題描述
28
表 2. 1 電力系統電磁現象分類與特性[6]
1.0 暫態
1.1 脈衝
1.1.1 奈秒 5-ns 上昇 <50 ns
1.1.2 微秒 1-μs 上昇 50 ns-1 ms
1.1.3 毫秒 0.1 ms上昇 >1 ms
1.2 震盪 S
1.2.1 低頻 <5k Hz 0.3-50 ms 0-4 pu
1.2.2 中頻 5-500 kHz 20μs 0-8 pu
1.2.3 高頻 0.5-5 MHz 5μs 0-4 pu
2.0 短期暫態
2.1 瞬時
2.1.1 電力中斷 0.5-30 cycles <0.1 pu
2.1.2 電壓陡降 0.5-30 cycles 0.1-0.9 pu
2.1.3 電壓驟昇 0.5-30 cycles 1.1-1.8 pu
2.2 短暫
2.2.1 電力中斷 30 cycles-3 s <0.1 pu
2.2.2 電壓陡降 30 cycles-3 s 0.1-0.9 pu
2.2.3 電壓驟昇 30 cycles-3 s 1.1-1.4 pu
2.3 暫時
2.3.1 電力中斷 3 s-1 min <0.1 pu
2.3.2 電壓陡降 3 s-1 min 0.1-0.9 pu
2.3.3 電壓驟昇 3 s-1 min 1.1-1.2 pu
3.0長期暫態
3.1 持續中斷 >1 min 0.0 pu
3.2 低電壓 >1 min 0.8-0.9 pu
3.3 過電壓 >1 min 1.1-1.2 pu
4.0 電壓不平衡 穩態 0.5-0.1%
5.0 波形失真
5.1 直流偏壓 穩態 0-0.1%
5.2 諧波 0-100th 穩態 0-20%
5.3 非整數諧波 0-6 kHz 穩態 0-2%
5.4 電壓陷落 穩態 0-1%
5.5 雜訊 寬頻 穩態 0-1%
6.0 電壓變動 <25 Hz 穩態 0.1-7%
7.0 頻率變動 <10 s
分類 分佈頻域 持續時間 電壓大小
第二章 問題描述
30
圖 2. 2 美國電機電子工程師學會電力品質事件的定義[4-5]
暫態
(Transient)
電壓驟昇
(Swell)
過電壓
(Overvoltage)
正常操作電壓
(Normal operating voltage)
電壓陡降
(Voltage dip)
欠電壓
(Undervoltage)
長期電力中斷
(Long interruption)
1min3sec0.5cycle 事件持續時間
1.1pu
0.9pu
0.1pu
電
壓
振
幅
大
小
短暫
(Momentary)
暫時
(Temporary)
暫態
(Notch/
Transient)
第二章 問題描述
32
為了數學分析之方便性，在此假設電源為理想的弦電壓源
)sincoscos(sin)sin(  ttVtVv mms  (2.2)
其中， mV 系統電壓之最大值，系統角頻率，開關閉合時之相
角。由克希荷夫電壓定律(KVL)中可獲得下列式子:
 idtCdt
di
LiRtVm
1
)sin(  (2.3)
經求解後可得到如下兩個 )(ti 表示式:
(1)當 RLR /2 時，則電路會呈現過阻尼電路，即
)()sin()( 21
ttat
m eAeAetIti
   (2.4)
(2)當 RLR /2 時，則電路會呈現欠阻尼電路，即
)sincos()sin()( 21 tBtBetIti nn
at
m    (2.5)
其中，
,tan,
)(
1
22 


 

 
R
XX
XXR
V
Z
V
I CL
CL
mm
m 
22
0n0
22 ,/1,,2/   LCLR n (2.6)
常數項 1A 、 2A 、 1B 、 2B 則由電容器初始電壓來決定，在此假
設在時間點 t=0 時， 0)( ti 。則電感上電壓方程式可表示成
第二章 問題描述
34
令 ,, 00 CBX
Xn C
L
c 
  則
12
2


n
n
BV
Z
V
I Cm
m
m (2.14)
cos'1 mIB  ，以及 (2.15)
n
m
n
Cm I
L
VV
B



 sincos
' 02 

=    sin
1
sin 20 

n
n
BVVVnB CmCmC
= 


  sin0 m
m
C I
V
V
n (2.16)
由上公式可知，電流的放大因數
12 n
n
可由圖 2.5 中曲線來觀察，
當n愈小時，即 L、C 愈大，則放大因數愈大，將會使得振盪電流成
份愈大。
第二章 問題描述
36
在一般情形下， 0CV 可為任意值(視電容器打開瞬間其兩端的電壓
及其自然放電的時間長短而定)。要如何選擇電容器投入時機，而使
電容器投入十時產生之暫態電流最小，由(2.13)式的觀察，可有兩種
較佳的選定：
(A)當 0CVV  ，即 V
VC0sin  (2.19)
(B)當 0
dt
dv
，即 0cos  (2.20)
由圖 2.6 及圖 2.7 中可分別顯示(2.19)式及(2.20)式之條件，當電
容器投入時其暫態電流與穩定電流之關係，由圖中可以清楚的表示，
當 0CVV  時將可獲得較小之振盪電流成份。
第二章 問題描述
38
2-3-2 電壓分析
由圖 2.3及圖 2.4中分析電容器上之端電壓可由克希荷夫電壓定
律(KVL)來表示
)(
)()(
)sin( 2
2
tV
td
tVd
LC
dt
tdV
RCtVv C
CC
ms   (2.21)
由於系統皆屬於電感性，且為了數學分析之方便，故將電阻成份
忽略不計。再經過電路分析求解過後可得到電容器瞬時電壓方程式
   tCtCtVtV nnmc  sincossin 21  (2.22)
其中
sin01 mC VVC  (2.23)
cos12 mVn
C  (2.24)
由(2.22)式中可知，其中  tsin 部份可表示為穩態響應；
tC ncos1 及 tC nsin2 部份則為暫態響應。假設要讓電容器投入時無暫
態電壓的發生，則必須同時讓 1C 及 2C 為零，即
2
,0cos(A)
 θ (2.25)
sin(B) 0 mC VV  (2.26)
要滿足(2.25)式，即表示電容器要領先充電至 sinmV 時投入，而
第二章 問題描述
40
表 2. 2 開關設備閉合時之電流與電壓數學表示式
電壓
電流
角度 0 90
tcosItcosI)t(i nmm   )(
 tcosVtsinVtV nmmc   )90(
tsinnItcosI)t(i nmm   )90(
 tsinV
n
tsinVtV nmmc 
1
)( 
第二章 問題描述與數學表示式
42
器之電感，Rs與 Cs為電壓變壓器、電流變壓器、匯流排等諸如此類
之電阻及電容，電容性負載以 C 來表示，且其經由負載側之漏電感
'L 與斷路器相連接。當 'LLs  且 CLs  1 ，則電流相角領
先電壓 90° 。此一流經負載側之電流與斷路器額定之短路電流相較
之下是相對小的，故此電流即使在一短的燃弧時間亦可被中斷。在
負載側之電容充滿電量且電壓處於接近峰值的狀態下打開斷路器，
經過半個週期後，斷路器電源供應側之電壓極性與負載側相反，此
時斷路器兩端之電壓差可達 2 倍之峰值電壓，如圖 2.9 所示，其中 1
為供應電壓；2 為負載側電容之電壓；3 為斷路器兩端之電壓。
圖 2. 9 中斷電感電流之電壓與電流圖
若此時斷路器處於閉合之情況下，則其電壓差 EUU c  稱為
Ferranti rise，其效果可視為將負載電容當作一反作用於系統之電
源，這會使得斷路器電源側之電壓發生劇烈跳動(jump)之現象，且
其振動頻率為
ssCL
f
2
1 (2.29)
此一劇烈跳動電壓之上升率為
時間
e,i
3
1
2
E
瞬時電流
中斷
uc
ic
第二章 問題描述與數學表示式
44
暫態電流之值第一次通過 0 時上升至 3E，同時電弧通道消失，斷路
器中斷此暫態電流，此時斷路器之滅弧觸點只分離一小段距離，而
另一個再燃之情形便隨之發生。當斷路器出現第二次再燃時，暫態
電流會達到 2 倍之振幅，導致當電弧通道再次消失時，通過負載側
電容之電壓增加到 5E，而斷路器之電壓增為 6E。當若干個再燃之
情形以這種方式發生時，在斷路器會出現相當高之電壓差，進而發
生跳弧(flashover)現象，導致其在斷路器外產生短路之情形，因此斷
路器便失去其功用了，這是相當危險且不樂於見到之情形。
圖 2. 10 斷路器發生再燃(re-ignition)時之電壓圖
2-4-2 電容突入電流
在電力系統中，電容器組因要改善功因或濾除諧波成分，故必
須要做投入或切離系統的動作。中斷電容電流可能會引起絕緣擊穿
的問題，而電容投入系統亦會產生大量之突入電流流入系統。圖 2.11
+E
-E
+3E
+E
-E
-5E
+2E
-4E
電流
電壓
高頻放電
電流
C
L
E
s
2
瞬時電流
中斷
時間
電源側
電壓
負載側
電壓
斷路器
端電壓
第二章 問題描述與數學表示式
46
其中 C
LZ ss  為電路之特徵阻抗
C
Lf ss 2
1 為電路之固有頻率
E(0) 為開關在 t = 0 切換時電壓源之瞬間電壓
若當電容投入時，電壓源之值為最大，則所產生之暫態突入電
流其峰值會比穩態時流經電容之電流高出許多倍，這會導致電容器
與開關裝置損毀。若斷路器絕緣擊穿之情形恰發生在其接觸器連接
之前，如此高的突入電流，可能會導致接觸器因材質熔毀而相連在
一起。
2-4-3 中斷小電感電流
小電感電流與小電容電流相同，皆可在一短的燃弧時間被開關
設備所中斷，開關設備如高壓電路斷路器是設計用來清除大量之短
路電流，因此用於消除由小電流所起之電弧現象是容易的。在電流
被中斷後，斷路器內滅弧觸點間之空隙越小，則其反抗發生絕緣擊
穿之能力就越低。
圖 2. 13 電感性負載之單相電路圖
在圖 2.13 之電路中，當斷路器打開中斷流經負載之電流時，負載電
容之電壓為
CCd
Ls
Rs
Cs
Ecos(wt) L
+
-
uc
第二章 問題描述與數學表示式
48
所謂的諧波失真(Harmonic Distortion)。諧波之數學解釋如下：任何
週期性之電壓及電流波形都可用傅立葉級數(Fourier Series)來表示
其直流成份及各正弦波成份的總和，如(2.37)式所示：
 



1
0 2sin2)(
h
hhh tfEata 
其中 Eh為第 h 次諧波有效值，fh為第 h 次諧波頻率(fh=hf1)， h為第
h 次諧波相角。
含有諧波成份的失真波形，依其波形特性可分為對稱性波形及
非對稱性波形，對稱性波形僅含奇次諧波，非對稱波形則含有偶次
諧波，通常研究諧波時只考慮整數倍諧波，諧波頻率為基本波的整
數倍。諧波成份即為傅立葉級數中頻率大於基本波之成份，諧波失
真之定義如(2.38)式所示：
1E
E
HD h
總諧波失真之定義如(2.39)式所示：
%100
1
2
2




E
E
THD h
h
2-6 諧波對電力系統的影響
(2.37)
(2.38)
(2.39)
第二章 問題描述與數學表示式
50
生機械共振(Mechanical Oscillations)。
 電力線
由於諧波電流為基頻電流以外之異常電流，電力線對高頻之諧
波電流有集膚效應(Skin Effect)與鄰近效應(Proximity Effect)，使額定
載流量減少。電力中如有過量之諧波電流會有過熱之現象，使電力
線之絕緣層受熱而劣化，縮短其使用壽命。電力線最高容許電流即
安全電流，當電力線中有諧波電流時，電力線之安全載流量必定降
低，過量之諧波電流可能破壞導體之絕緣層，發生導體絕緣壞而燒
毀。
 電容器
電容諧波事故常因電力系統發生並聯共振擴大諧波污染，產生
過大之諧波電壓所致，一般改善方法為在電容器上串接適當之電感
值，使諧振點避開諧波源頻率，除可免於擴大諧波污染外，亦可適
度濾除諧波。
 計量表(Metering)
計量表和測量儀器可能因諧波污染而影響其正常運轉，特別在
發生諧波因共振而放大時，諸如瓦時表可能因諧波引起三相不平衡
而造成瓦時表的正誤差或負誤差，通常總諧波失真率要大於 20%才
會造成明顯誤差。計量表和測量儀器採用儀器專用變比器可避免諧
波干擾。
 開關設備(Switchgear)和電驛(Relaying)
第二章 問題描述與數學表示式
52
業界使用非線性負載日益增加，產生諧波電流注入電力系統，引起
諧波電壓影響供電品質，故於 1974 年開始致力於諧波標準之制訂，
並於 1981 年完成 IEEE/Std 519-1981 版「諧波控制及靜態轉換器虛
功 補 償 指 南 (IEEE Guide for Harmonic Control and Reactive
Compensation of Static Power Converters)」，作為工業界與電力公司管
制諧波電流及電壓的參考依據，並每隔五年定期檢討修訂所建議的
標準內容。其中曾於 1989 年略作修改，並於 IEEE Transactions 中發
表修改內容，名稱亦改為「 IEEE Recommended Practices and
Requirements for Harmonic Control in Electrical Power Systems」
[64]。最新版由諧波與虛功補償分會與電機電子工程師協會之電力
工程學會中之輸配電力系統諧波協會(Working Group on Power
System Harmonics of the Transmission and Distribution Committee of
the IEEE Power Engineering Society)共同完成，稱 IEEE/Std 519-1992
版，並於 1993 年 4 月公告，內容中之主要諧波標準推薦值如表 2.3
與表 2.4 所示。
第二章 問題描述與數學表示式
54
至於受污染而影響電力品質。
表 2. 5 台電民國 76 年大用戶諧波電壓限制暫訂標準
電壓等級 11kV 以下 69kV 161kV 以上
電壓總諧波失真值(%) ＜3% ＜1.5% ＜1%
註：11kV 以下系統，由所轄各營業區處管制。
69kV 系統，由供電處及各營業區處管制。
161kV 系統，由電力調度處管制。
表 2. 6 a 台電民國 81 年之電力系統諧波管制暫行標準
用戶注入其責任分界點之諧波電流 81 年 11 月 25 日訂定
(1) 3.3~22.8kV 系統 82 年 6 月 4 日修訂
諧波電流失真率限制值(%)
各次諧波個別值(奇次)
LSC II ＜11 11≦n＜17 17≦n＜23 23≦n＜35 35≦n
總諧波失真
THD(%)
＊＜20
20~50
50~100
100~1000
＞1000
4.0 2.0 1.5 0.6 0.3
7.0 3.5 2.5 1.0 0.5
10.0 4.5 4.0 1.5 0.7
12.0 5.5 5.0 2.0 1.0
15.0 7.0 6.0 2.5 1.4
5.0
8.0
12.0
15.0
20.0
註：偶次諧波為上述限制值之 25%
＊：自備發電機用戶一律採用 LSC II 小於 20 之限制值。
ISC：用戶責任分界點短路電流。
IL：對既設用戶取 12 個月最大負載電流平均值。
對新設或增設用戶，取主變額定電流值。
(2) 對於 34.5~161kV 系統為上述限制值之 50%。
第二章 問題描述與數學表示式
56
表 2. 7 先進國家諧波標準比較表
諧波電流(In) 諧波電壓(Vn)
偶次(Even) 奇次(Odd) 總諧波電流失真(THD) 偶次(Even) 奇次(Odd) 總諧波電壓失真率(THD)
瑞典 n≦13→4%
n＞13→3% 5%
2-6 級→0.5%
≧8 級→0.2%
3-19 級→1%
21-25 級→0.7%
≧25 級→0.2+0.5*25/n
1.5%
法國 ≦0.6% ≦1.0% THD≦1.6%
英國
(G5/3)
依電壓等級 0.415kV，6.6-11kV，33-66kV，
132kV 以上分別管制各級諧波電流大小。
0.5~2% 1~4% 1.5~5%
日本 用戶擁有的高諧波發生機器的容量換算至6-pulse
之整流設備等效容量，再將各種機器的換算等效
容量加以合計後，依據配電與特高系統分別管制
各級諧波電流容許值。
無
第四章 類神經網路與模糊理論
58
(Ⅰ) 架構 (Ⅱ) 頻率響應
圖 2. 14 單調濾波器架構及阻抗頻率響應圖
(b) 雙調濾波器(Double-Tuned Filter)
若某網路的等效阻抗值在某兩個特定共振頻率下有最低阻
抗，則稱為雙調式濾波電路。此型電路基本上可視為兩個單
調濾波電路的並聯。其等效雙調濾波電路如圖 2.15 所示。
圖 2. 15 等效雙調濾波電路
(2) 阻尼濾波器(Damped Filter)
此型濾波器具有頻寬較大與低阻抗的特性，對於頻率高於調
阻抗
頻率
調諧頻率
C
L
R
C1
C2
L1
L2
R1
R2R3
第四章 類神經網路與模糊理論
60
步驟二：決定濾波器中電感器的電感值
在單調式濾波器中，電感器的電感值(LF)與電容器
的電容量(QCF)之間的關系(2.41)式。
CFF
C
F Qfh
V
L


1
2
2
其中 hF 為濾波器的諧振點，f1 為電力系統基頻，VC 為
電容器的額定電壓。
N 階單調式濾波器的諧振點(hF)通常設計在 N -1 至
0.92·N 之間[49]。
2-9單調式濾波器切換暫態現象的抑制
由於當濾波器投入時會產生暫態現象，根據 IEEE Std 18-1992[59]
中的 5.3 節，電容器僅能夠承受峰值為額定電壓 22 倍的暫態電壓。
串聯電感提供部分之減緩暫態之功能，但還不足提供完善之改善，故
本計畫擬額外串接電感器於暫態使用，伺幾個週期後再將其旁路，其
結構如圖(2.17)所示。
圖 2. 17 串接額外電感之濾波器
(2.41)
第四章 類神經網路與模糊理論
62
第三章小波理論
3-1 簡介
小波轉換早期是為基礎數學發展的理論，但在 90 年代經 Mallat
和 Daubechies 等人將小波轉換的理論從工程的觀點作了多項的詮釋
後，使得小波轉換由理論階段進入了工程應用的領域。目前在數位信
號分析、語音處理、影像處理及電腦視覺等研究領域上，有關小波轉
換的相關技術與研究文獻正在迅速成長。無疑地，小波轉換已成為充
滿潛力的新興研究課題。
傳統電力品質之量測與分析的方法大多是藉由傅立葉轉換，將訊
號從時域轉換至頻域，以瞭解訊號頻譜資訊，但傅立葉轉換乃是著重
於穩態信號之探討，對於訊號中所包含之高頻暫態現象的分析，則無
法達到良好之效果，同時對於不良之電力品質亦無法適時的發出警
訊，使之做一時的處理，因此本計畫採用小波轉換作為分析電力訊號
之工具，以改善傅立葉轉換之缺失。
3-2 傳統訊號分析方法
在說明小波轉換(Wavelet Transform)之前，我們先來介紹傳統訊
號分析方法。
3-2-1傅立葉轉換 (Fourier Transform)
傅立葉轉換是一種可將訊號從時域的表現方式轉換成頻域的表
現方式的一種數學工具。如圖 3.1 所示，時域信號經過傅利葉轉換後，
可以得到頻域的資訊。由公式 3.1 可知，時域訊號 )(tF 經過基底函數
jwte 投影至頻域而得頻域訊號 )(F 。對許多信號處理而言，當頻率
第四章 類神經網路與模糊理論
64
3-2-2 短時傅立葉轉換(Short-Time Fourier Transform, STFT)
為了改善傅利葉轉換的缺點，英國科學家 Dennis Gabor 提出了短
時傅立葉轉換 [31]。 如圖 3.2 所示，短時傅立葉轉換利用加
(Windowing)方式對時域訊號做某區段時間內的傅立葉轉換，可以得
到時間和頻率的關係。
圖 3. 2 訊號經過短時傅利葉轉換於時域與頻域上
定義 R 表示一實數集合，Z 表示所有整數集合，一維平方可積分
函數(Square-integrable Function)空間則以 )(2 RL 表示之。利用窗函數
g(t)的平移(Shift)及調變(Modulation)，令 )(, btgeg
tj
b   ，則對於
)()( 2 RLtf  之短時傅立葉轉換定義為：
(3.3)
其中
f(t)為輸入連續訊號；
g(t)為 window function；
w 為調變因子；
b 為平移因子。
   )(),()()(),( , tftgdttfbtgebSTFT btjf 
Window
振
幅
時間
短時
傅利葉
轉換
頻
率
時間
第四章 類神經網路與模糊理論
66
圖 3. 3 訊號經過小波轉換於尺度域與時間域上
3-3-1 小波函數(Wavelet Function)
法國學者 Morlet 在做信號分析研究時發現傳統的傅立葉轉換難
以達到要求，因而引入小波概念，對信號進行分解。隨後 Grossman
對 Morlet 的信號[33]，藉由一適當函數的轉移(Translation)與擴張
(Dilation)的方式將信號分解，此一有限且具震盪性的適當函數即為小
波(Wavelet)。考慮一實數或複數連續函數 )(t 具有下列特性：
1. 積分為零：
(3.4)
2. 能量有限：
(3.5)
當 )(t 符合上述兩種性質時，則此函數 )(t 即稱為母波(Mother
Wavelet)或小波。性質 1 暗示著此函數具有震盪性，故其圖形必是上
下起伏之震盪波(Oscillatory Wave)。性質 2 則暗示此函數大部分能量
是被限制在有限的時間內，表示 )(t 所形成之面積必然不大，其振
幅必須在正負兩個方向上快速衰減為零。相較於弦波而言，此種函數
可說是較小的波形(Small Wave)，因此會有小波(Wavelet)的名稱。如
圖 3.4 為著名的 Daubechies 4 小波函數。
 0)( dtt
 dtt
2)(
Window
振
幅
尺
度
時間 時間
小波
轉換
第四章 類神經網路與模糊理論
68
圖 3. 5 小波函數進行壓縮及平移
小波函數已於上中描述其特性，因此接下來將繼續介紹尺度函
數。令函數 )(t 滿足下列條件[34]：
1. 積分為 1：
(3.7)
2. 能量為 1：
(3.8)
3. 由函數 )(t 與其整數轉換所組成的集合為正交集合：
(3.9)
因正交函數集合為線性獨立(Linearly Independent)，因此，集合
 Zkkt  :)( 包含線性正交的函數。換句話說，可將基本函數定義
)(t 經由整數轉換後，表示成另一函數的集合：
(3.10)
所以，此集合可視為一線性向量空間 0V 的基底，可用下式表示：
)()}({ 200 RLVtSpanV k
k
  (3.11)
其中表示閉區間。並意味著：
 1)( dtt
  1)()(
22 dttt 
Znnntt  )()(),( 
2)()( LZkkttk  
第四章 類神經網路與模糊理論
70
3-3-2 多重解析度分析(Multiresolution Analysis, MRA)
多重解析度分析是在不同程度的解析度下，檢視欲分析函數，可
將訊號解析或重建於不同的解析層(resolution level)。藉由多重解析度
分析，可將一複雜的信號分解成較單純的信號，再分別研究分解後信
號，以探討信號內所含的資訊
當函數 )()( 2 RLtf  ，則有一尺度函數 )(t 可從 )(2 RL 空間中的函
數 f 濾得較為平滑的子信號，以數學的觀點而言，則函數 f 可由尺度
函數 )(t 來近似；其中 )(2 RL 表示一維平方可積分之空間。所以尺度
函數 )(t 可視為低通濾波器，而同一層的高通濾波器則為小波函數
)(t 。
基本上小波轉換是以一連串不同的解析度空間 mV ( Zm )以連續
近似來表示函數 f(t)，則其組成之多重解析度空間滿足下列性質：
1. 包含性 (Containment)，如圖 3.6 所示：
   11012 VVVVV (3.18)
圖 3. 6 小波轉換之包含性
2. 完整性 (Completeness)：
 )(,0 2 RLVV m
Zm
m
Zm


 (3.19)
W2 W1 W0 0V
0123 VVVV 
第四章 類神經網路與模糊理論
72
其中表示正交和。換言之， 1mV 可分解成 mV 和 mW 兩個子空間；
同理， mV 和 mW 兩個子空間可合成空間 1mV ，如圖 3.7。
圖 3. 7 不同尺度空間之分解與合成
而 mV 可再被表示成
1111   mmmmm WV,WVV (3.26)
如此遞迴分解，則 1mV 可表示為
(3.27)
由於 mV 空間可分解成 1mV 子空間和 1mW 子空間的正交和，所以
1mW 包含於 mV ，又因為 mV 和 mW 互相垂直，故可知 1mW 與 mW 也互相
垂直，依此類推可得知各細緻子空間兩兩互相垂直，如下式所示：

Zm
jW

0 (3.28)
 


21
11
1






mmm
mmm
mmm
WWW
WWV
WVV
1mV
mV mW
第四章 類神經網路與模糊理論
74
合產生
 
n
)nt(]n[h)t( 22  (3.32)
同理，小波函數 )(t 亦可表示成
 
n
)nt(]n[g)t( 22  (3.31)
其中 ][nh 及 ][ng 為濾波器係數(Filter Coefficient)：
(3.32)
(3.33)
當信號 )(tf 在 0V 空間上，且轉移尺度函數集合 )}nt({  展延出 0V
空間，則 )t(f 可表示成
 
n n
n tncntnctf )(][)(][)( ,000  (3.34)
其中
(3.35)
 


 dtnttnh )(
22
1
][ 
 


 dtnttng )(
22
1
][ 
  dtnttfttfnc n )()()(),(][ ,00 
第四章 類神經網路與模糊理論
76
同理
 
k
kcnkgnd ][]2[][ 01 (3.41)
][1 nc ， ][1 nd 為信號f(t)經小波轉換後之第一層係數，爾後再以 ][2 nc 當
下一層之輸入信號，再進行小波轉換，依此類推，即可得小波轉換多
重分解。上述小波轉換多重解析度分析架構如圖3.5所示，而離散信
號 ][0 nc 代表f(t)於最高解析度空間之小波轉換係數值，即
)(][0 nTfnc  (3.42)
其中T為採樣間距(Sampling Interval)。圖3.9中↓2為減半取樣(down
sample by 2)的意思。
圖3.10所示為一維信號重建架構。信號分解及重建過程中所使用
之濾波器乃一完整重建 (Perfect Reconstruction)之四相鏡濾波器
(Quardrative Mirror Filter, QMF)，其確保信號於分解成相異頻段子信
號後，亦能完整重建，使其恢復原始信號。
圖 3. 9 多重解析一維信號分解架構圖
圖 3. 10 多重解析一維信號重組架構圖
第四章 類神經網路與模糊理論
78
對任一函數 )R(L)t(f 2 ，此時連續小波轉換定義為：
(3.43)
其中 )b,a(CWT 為函數 )(tf 的連續小波轉換值， )t( 為母小波或
小波，參數 a 與 b 為實數，星號表示其共軛複數。因此，小波轉換是
含有雙變數的一種函數。由(3.6)式，可將(3.43)式改寫成較簡潔的形
式：
(3.44)
此時， )t()t(,  01 ，正規化因子 a
1 可確保對所有的參數 a 與 b，
能量皆能維持一定，可用下列方程式表示：
對所有的參數 a 與 b (3.45)
而使用連續小波轉換分解一個訊號可分成五個步驟
步驟1： 挑選一個小波函數
步驟2： 計算一段訊號與小波函數間之相似係數C，其表示此段訊號
與小波函數的相似度，當係數越大則表示兩者越相似。換句
話說，當此段訊號的能量與小波函數能量相同時，係數C可
以用相關係數來解釋，如圖3.13所示。
 
 dt
a
bt
tf
a
baCWT f )()(
1
),( 
)(),()()(),( ,, ttfdtttfbaCWT babaf   
 


 ,)()( 22, dttdttba
第四章 類神經網路與模糊理論
80
)nta(a)t( m
m
n,m  

0
2
0 
在連續小波轉換當中，尺度會隨著頻率成比例的改變，小尺度(low
scale)表示母波函數的壓縮，此時小波函數迅速改變，也代表著訊號
高頻的部份，反之，大尺度(high scale)表示母波函數的擴張，此時小
波函數改變緩慢，也代表著訊號低頻的部份。
3-3-4 離散小波轉換(Discrete Wavelet Transform, DWT)
離散小波轉換(DWT)是為了降低連續小波轉換(CWT)計算上之複
雜度而提出的。因連續小波轉換受到冗餘性(Redundancy)和不可實現
性(Impracticality)的兩個限制，為了兼顧理論的實用性與完整性，藉
由將連續小波轉換公式中的尺度參數 a 與平移參數 b 離散化
(Discretization)，即可獲得離散小波轉換。因此將 a, b 參數調整為
nab,aa m  0 ，其中 10  a,Zn,m ，則(由 3.6)式可得離散小波函數
為：
(3.46)
若選擇 20 a ，則稱為二元化小波函數(Dyadic Wavelet)，且式 3.46
可改寫成為下式：
(3.47)
此時只要適當選擇 m 即可將訊號作細節 (Detailed)或粗略
(Approximate)的分析。
對應於上節所述之連續小波轉換而言，離散小波轉換即可表示如
下：
(3.48)
)
2
(
2
1
)(, mmnm
nt
t
 
  
k
mmf
nk
kfnmDWT )
2
()(
2
1
),( 
第四章 類神經網路與模糊理論
82
緊接著利用(3.32)式，設 3210 ,,n,)t()t(  ，以迭代的方式即可
求出Daubechies 的尺度函數，如圖3.16(a)所示。
利用式3.34與式3.39，即可求出Daubechies小波函數係數值如下：
(3.54)
小波函數D4，經迭代之後，其圖形如圖3.16(b)所示。當然尺度函數的
係數不只可用四個而已，基本上，二的次方的係數皆可
圖 3. 16 D4 尺度函數與小波函數
綜合而言，利用上述所獲得的函數 )(tk 與 )t(k,j ，可擴展成所有
)R(L2 空間。根據式3.25，任何的函數 )()( 2 RLtf  利用尺度函數與小
波函數可表示成級數的形式：
 







0j
k,jk )t()k,j(d)t()k(c)t(f  (3.55)
此展開式中暗示著，第一項的總和部分為對函數f(t)較低解析度或較
粗略的估計；而在第二項中，對於持續增加的參數j 來說，就會用越
}
24
31
),
24
33
(,
24
33
),
24
31
({
4,
Dwh
時間 時間
振
幅
振
幅
(a)迭代十次後的D4尺度函數 (b)迭代十次後的D4小波函數
第四章 類神經網路與模糊理論
84
 dtttfttfkjc kjkj )()()(),(),( ,,  (3.60)
與
 dtttfttfkjd kjkj )()()(),(),( ,,  (3.61)
此時，在小波展開式中的係數d(j, k)，則被稱為信號f(t)的離散小
波轉換。在實際應用上，因已知的只有信號的採樣點，並不是信號本
身的函數形式，當使用所有的採樣點來當輸入信號時，則此時的尺度
為最精細的，所以此時對信號擁有最高的解析度。
3-5 小波轉換與傅立葉轉換之比較
根據3.1到3.4節對於傅利葉轉換、短時傅立葉轉換及小波轉換的介
紹，本節做了簡單圖表做比較，如圖3.17及表3.1所示。
圖 3. 17 傅立葉轉換、短時傅立葉轉換和小波轉換比較
(a) 時域
(d) 尺度-頻域(小波轉換)
時間
時間
振
幅
頻
率
尺
度
(c) 時域-頻域(短時傅利葉轉換)
振幅
(b) 頻域(傅利葉轉換)
頻率
頻
率
第四章 類神經網路與模糊理論
86
第四章 類神經網路與模糊理論
4-1 簡介
類神經網路(Artificial Neural Networks，簡稱 ANN)是一種模仿生
物的大腦與神經網路系統所建構出來的資訊處理系統，能夠對於由外
界所輸入的訊號具備儲存、學習、回想等一系列動作。類神經網路較
精確的定義為:「類神經網路是一種計算系統，包括軟體與硬體，它
使用大量簡單的相聯人工神經元來模仿生物神經網路的能力。人工神
經元是生物神經元的簡單模擬。它從外界環境或者其他人工神經元取
得資訊，並加以非常簡單的運算，並輸出其結果到外界環境或者其他
人工神經元。」[38]大約在一百多年以前，藉著解剖學的幫助，生物
學家方瞭解生物大腦的主要構造細胞是神經細胞，然後神經電化學家
E.D.Adrain 的研究發現：「當外界輸入一電流給一個神經細胞時，神
經細胞受到足夠強度電流刺激時，便會放出電流，這種電流大多具有
相同的強度，其放射頻率與外來刺激的電流強度成正比。」人類開始
才對於神經細胞的作用有所瞭解，幫助日後類神經網路模型的建立。
最早由 Mc Culloch 和 Pitts [39]在 1943 年提出第一個神經元運算
模型，直到 1949 年加拿大心理學家 Hebb 提出學習方式，稱為 Hebbian
學習法則，建立類神經網路的雛型，學習法則的觀念直到現在仍然被
採用，在 1980 年美國物理學家 Hopfield，將能量函數的觀念引進到
神經網路，使得類神經網路之研究又開始復甦，在 1986 年 Rumelhart
和 PDP( Parallel Distributed Processing )研究群提出回傳神經網路，從
此類神經網路更加快速發展。
近年來類神經網路受到各界的矚目，包括心理學、數學、醫學、
計算機科學、及電機工程等不同研究領域，主要建立具有智慧型的系
統，提供各界的需求，在電機工程領域則應用於控制工程、最佳化、
第四章 類神經網路與模糊理論
88
機構，可接收或傳遞受激發的訊號(或稱為神經脈衝)。
(4)突觸(神經節)(Synapse)：神經元之間的訊號是透過軸突與樹突來傳
遞，而軸突與樹突之間的界面就是突觸。每個神經元大約有
310 ~ 410 個突觸，當軸突送出訊號時，會在突觸分泌一種傳導物
質，使得接收的神經元中的細胞體產生電位的變化。
圖 4. 1 生物神經細胞
當外界各種不同型式資訊或能量訊號(例如:聲，光，電，熱等等
刺激)，透過感官器官轉換成電的訊號後，便會進入神經細胞中，而
在神經元內此輸入訊號，是經由突觸間內部電位變化後，透過樹突傳
送至細胞本體，再由軸突傳送至樹突，成為下一個神經元的輸入訊
號。其中，突觸內的影響強度就是生物神經網路儲存資訊的地方，生
物神經網路的學習就是在調節突觸的強度。
類神經網路根據生物體的功能，仿照成生物神經元模型，生物體
與生物模型對照表，如表4.1所示。
輸入樹突
輸出樹突
突觸
細胞體
軸突
第四章 類神經網路與模糊理論
90
4-2-2人工神經元模型
在瞭解了生物神經細胞模型後，類神經網路便是模仿生物神經細
胞而建立人工神經元，其模型如圖4.3所示。
圖 4. 3 人工神經元模型
人工神經元模型中輸入與輸出值的數學模型可表示為：


  

n
i
jii xwfy
1
 (4.1)
其中
y : 模仿生物神經元模型的輸出訊號。
ix : 模仿生物神經元模型的輸入訊號。
(.)f ：模仿生物神經元模型的轉換函數(Transfer Function)，是一
個用已將從其他處理單元輸入的輸入值之加權乘績和轉
換成處理單元輸出值的數學公式。
iw ：模仿生物神經元模型的神經節強度，又稱連結加權值。
j：模仿生物神經元模型的閥值。
連結加權值
輸入訊號
j
閥值
f
轉換
函數
處理單元
淨輸入
net
y
輸出訊號
第四章 類神經網路與模糊理論
92
刺激性的突觸，而抑制性得突觸則由負值的鍵結值所表示。
二、 加法單元：當神經傳導物質到達後級突觸時，如圖 4.5 所示的
「時間性相加(temporal summation)」和「空間性相加(spatial
summation)」會將所有到達後級突觸的刺激加以整合。「時空性
相加(spatio-temporal summation)」所產生的綜合性層次電位，
會從四面八方像軸突丘傳遞，整個過程相當地複雜，在簡單的
類神經元的模型中，我們通常以一個加法單元來簡化此過程。
圖 4. 5 發生於神經元突觸之「時空性相加」示意圖
三、 活化函數 (activation function)：活化函數或稱轉換函數(transfer
function)，在軸突丘部位所呈現的整體細胞膜電位，若超過閥
值，則「活化電位」脈衝會被激發，整個傳遞而來的資訊在這
裡被調變(modulation)處理，軸突丘將資訊編碼於 (1)活化電位
的是否產生及 (2)活化電位脈衝的產生頻率中。因此將經過權
重相加的輸入，透過活化函數的轉換，使得類神經元的輸出代
表短期間之平均脈衝頻率。
一般處理單元輸入與輸出的關係，可用輸入值加權乘積之和的函
數來表示：
第四章 類神經網路與模糊理論
94
二、線性函數 (linear function)：
如圖 4.6(b)與(4.5)式所示，當轉移函數的淨數入 v 為多少時，則神經
元的輸出將隨之成線性改變。
(4.5)
三、區域線性函數 (piecewise linear function)：
(4.6)
其中 c、 1v 及 2v 是實數型常數。這是個有上下限的遞增函數，可逼近
非線性放大器的輸出，如圖 4.6(c)所示。
四、雙彎曲函數 (sigmoid function)：
(4.7)
或
(4.8)
其中 c 為實數型常數。這是個單調遞增(monotonic increasing)、平滑
且可微分的函數，大部分的類神經網路如：倒傳遞類神經網路







2
12
1
0
1
vvif
vvvifcv
vvif
)v(
)2(1
)2(1
)()(
)()(
)()(
cvexp
cvexp
cvexpcvexp
cvexpcvexp
cvtanhv




)(1
1
)(
cvexp
v


cvv )(
第四章 類神經網路與模糊理論
96
圖 4. 6 常見的轉移函數
y
+1
-1
0
y
+1
-1
0
y
+1
-1
0
y
+1
-1
0
y
+1
-1
0
y
+1
0
(a)硬限制函數 (b)線性函數
(c)區域線性函數 (d)雙彎曲函數
(e)雙曲線正切函數 (f)高斯函數
第四章 類神經網路與模糊理論
98
類神經網路的模式有數十種，大致上依學習策略與網路架構加以
分類。而依網路學習策略而言，可以分為以下四類[38]:
(1) 監督式學習網路(Supervised Learning Network)：所取得的訓練範
例當中，包含輸入值以及輸出值，在學習的過程當中，輸入值經
由網駱的運算，會計算出一組推論值，將此推論值會與範例的輸
出值比較，來調整網路內的權重值，如此不斷地反覆計算，以達
到推論值與輸出值之差距達到最小，倒傳遞類神經網路即屬於此
類網路。
(2) 非監督式學習網路(Unsupervised Learning Network)：所取得的訓
練範例當中，只有輸入值，從學習的範例去尋找範例內在聚類規
則，自行找出輸入資料的規則或趨勢，自組織映射圖網路即屬於
此類網路。
(3) 聯想式學習網路(Associate Learning Network)：所取得的訓練範例
當中，學習範例的內在記憶規則，以應用於新的輸入樣本中(只
有不完整的狀態變數值而需推論其完整狀態變數值的應用)，霍
普菲爾網路即屬於此類網路。
(4) 最適化應用網路(Optimization Application Network)：對一模擬問
題所設計的變數值，不僅使其滿足設計限制條件，並且使得我們
所定義的目標達到最佳狀態的設計目標。
依網路架構分類可以分為以下四類:
一、 單層前饋網路(Single-layer feed forward network)：如圖 4.8 所
示，整個網路由一層具有處理能力的類神經元所組成，通常此
種網路的功能性較差，只能處理線性問題。.
二、 多層前饋網路(Multi-layer feed forward networks)：這是種含有隱
藏層(hidden layer)及輸出層(output layer)的網路，這些層中的類
第四章 類神經網路與模糊理論
100
三、 循環式網路(recurrent networks)：此種網率與前饋型網路的主要
差別就在於它的輸出會透過另一組鍵結值，連結於網路的某處
(如輸入層或隱藏層)而迴授至網路本身，如圖 4.10 所示。
圖 4. 10 循環式網路
四、 晶格狀網路(lattice networks)：基本上，此種網路屬於前饋型網
路，只不過其輸出層的類神經元是以矩陣方式所排列，如圖 4.11
所示。自我組織特徵映射網路 (self-organize feature-mapping
networks)就是屬於此種網路。
圖 4. 11 二維的 33之晶格狀網路
第四章 類神經網路與模糊理論
102
輸入層(Input Layer)：
用來接收網路的輸入訊號，其處理單元數目依問題而定，而處理
單元函數使用線性轉換函數即 f(x)=x。
隱藏層(Hidden Layer)：
用以表現輸入處理單元間的交互影響。
輸出層(Output Layer)：
用以表現網路的輸出變數，其處理單元數目依問題而定，而處理
單元函數使用非線性轉換函數。
4-3-3 倒傳遞演算法則
倒傳遞演算法基本上它可分為順向訊號傳遞與逆向誤差傳遞兩
個階段(如圖 4.13)，當倒傳遞法在順向訊號傳遞階段，網路會將每一
個輸入樣本傳到輸入層，然後把輸入層得到的輸出當作中間層的輸入
參數傳到中間層，再將中間層得到的輸出當作輸出層的輸入參數傳到
輸出層，如此便可得到網路最後的推論輸出值，也就是每個在中間層
的神經元 j 可產生一個輸出值 jY 。
圖 4. 13 倒傳遞演算法之順向傳遞與逆向傳遞圖

1net
2net
ix y
訊息順向傳遞
誤差修正逆向傳遞
第四章 類神經網路與模糊理論
104
於中間層與輸入層間的加權值做最佳的調整，也就是
ij
)old(
ij
)new(
jk VVV  (4.17)
ij
)old(
ij V
E
V

  (4.18)
      


L
k
inetjknetkk
)old(
ij XY'fWO'fODV
1
 (4.19)
最後，不斷地調整網路中所有的加權值，直到學習結束，其最主
要目的就是希望網路的預測輸出值與我們想要的期望輸出值越接近
越好，如此才可達到最佳的設計。
4-3-4 倒傳遞神經網路優缺點
倒傳遞神經網路優點如下：
(1) 輸出值為連續值，適用於樣本識別分類問題、函數合成、適應控
制、雜訊過濾、資料壓縮及專家系統等應用，其應用範圍最廣。
(2)學習精度高、可處理複雜的樣本識別問題及高度非線性的函數合成
問題。
(3)回想速度快。
倒傳遞神經網路缺點如下：
(1)學習速度慢。
第四章 類神經網路與模糊理論
106
圖 4. 14 主要成份分析結合多層感知器網路之架構圖
4-4-3 主要成份演算法則
假設神經元 A 的軸突(axon)足以刺激鄰近的神經元 B，當我們持
續不斷地給予刺激，因而激發了神經元的新陳代謝，促使神經元 A
激發神經元 B 的功效增加。
此一神經元傳送訊息機制的觀念由 Stent(1973)將其推衍出兩種法
則：
1.若兩個連結的神經元同時被激發，則其連結的強度將增強。
2.若兩個連結的神經元非同時被激發(即一個有反應，另一個沒有反
應)，則其連結的強度將變弱或消失。
根據此法則，我們可以推導出 Hebbian 學習法的數學式。
假設 jiw 表示第 j 個神經元與第 i 個輸入單元的連結權重，輸入值
為 ix ，第 j 個神經元的輸出值為 jy ，則權重於第 n 次疊代的修正量為
1y
2y
my
1x
2x
1H
2H
kH
1y
2y
jy
ix
主要成份分析
(非監督式網路)
多層感知器網路
(監督式網路)
11
w
m1w
mpw
1x
px
2x
3x
4x
5x
6x






第四章 類神經網路與模糊理論
108
kiw ：第 i 個輸入單元連結到第 k 個神經元之權重值
ky ：第 k 個處理元件之輸出值
4-4-4 主要成份分析網路優缺點
主要成份分析網路優點如下：
(1)主要成份分析法使用正交化方式且它收斂速度快，因此，使資料特
徵值正交時，其網路訓練的複雜度大大的降低。
(2)利用網路擷取真正影響系統的輸入資料特徵值，以減少倒傳遞網路
之輸入資料。
主要成份分析網路缺點如下：
(1)任何一種減少輸入資料的方式，都有可能會使網路忽略掉相對小的
輸入資料特徵值，而使得倒傳遞網路訓練變得不精確。
第四章 類神經網路與模糊理論
110
圖 4. 15 二維矩陣之自我組織特徵映射模型
輸入層：用以表現網路的輸入變數，也就是用來訓練網路的資料向量
(Data vector) ix ，而輸入資料的數目是依照問題而訂。
n,,,i,Rx,,x,xx pipiii  21][ 21  (4.26)
其中 x i 為第 i 筆向量資料；
n 為總資料的筆數；
p 為資料向量的維度。
輸出層：用以表現網路的輸出變數，它是利用拓撲結構以呈現輸入資
料的分佈狀況。
權值向量：為每個輸出層神經元與輸入層相互連結關係所構成的權值
向量(Weight Vector) wj，當網路訓練完後，其輸出神經元
相鄰近者會具有相似的權值向量。
k,,j,Rw,,ww pjpjj  1][ 1  (4.27)
1x
2x
px
iy
1iw
2iw
ipw
第四章 類神經網路與模糊理論
112
Nj
w
w
x
w
w
x
j
j
j
j ,,2,1,
*
* 
是將權值向量正規化成長度為 1 的單位向量之後，找出那一個正規
化後的權值與輸入向量的距離最短，此類神經元便是得勝者，可用下
列式子表示此過程：
(4.29)
或者
(4.30)
其中  表示歐幾里德距離，而第 j* 個類神經元，就是與當時
輸入向量最匹配的類神經元，我們稱第 j*個類神經元為對輸入向量
x 的「得勝者」。由(4.20)或(4.21)式中可知，特徵映射是將連續的輸
入空間，映射至離散的類神經元，而網路的輸出可依據問題的需要，
以對輸入向量 x 最匹配的類神經元 j* 作為網路的輸出，或是以對
輸入向量 x ，具有最小歐幾里德距離的權值向量 *jw ，來作為網路
的輸出。
我們將其演算步驟敘述如下：
步驟一、初始化：將權值向量 )(w j 0 ，以隨機方式設定其值，但須
注意所有的 N 個權值向量之初始值都應不同，而 N 是類
神經元的個數。
步驟二、輸入呈現：從訓練集中隨機選取一筆資料輸入此網路。
Nj
w
w
xwxxj
j
j
jj
T
j
,,2,1,minargmaxarg)(* 
第四章 類神經網路與模糊理論
114
(2)有效處理資訊: 自我組織映射網路之特徵映射是以陣列的平行處
理來進行大量資訊的處理。
自我組織映射網路缺點如下：
(1) 自我組織映射網路需要大量的節點，導致權數計算量增加，且大
量佔用電腦的記憶體暨大幅增加計算複雜度。
4-6 放射狀基底函數網路(RBFN)
4-6-1 簡介
放射狀基底函數(RBFN)是一種較新發展出來的神經網路，尤其
應用於非線性系統的鑑別上有著其顯著的效果，像是最為廣泛的死區
鑑別應用就是一個很好的例子，已經有許多強而有力的實驗成果可以
驗證。 這種類神經的網路架構用在函數的近似上尤其有極好的效
果。特別是其對輸入輸出關係描述為線性是最引人注意的特性之一。
也因為這個特性，我們目前所採用的控制方式能夠處理這個系統輸入
非線性所導致的影響，並且也能夠處理非線性化的參數了。
4-6-2 網路架構
放射狀基底函數是由一個輸入層(Input)、一個隱藏層(Hidden)以
及一個輸出層 (Output)三層所架構而成的其中隱藏層是由多個
receptive field units 所組成。從輸入層到輸出層的過程，不同層神經
元之間是使用前饋式(Feedforward)的相互連接方式使其連接。對於這
種連接方式，層與層之間的訊號傳遞只允許訊號不斷的往前傳遞，並
且在傳遞的過程中只經過每個神經元一次。一個多輸入多輸出的放射
第四章 類神經網路與模糊理論
116
路。在第一階段的非監督式學習中，放射狀基底函數網路的訓練輸入
值

是一個多維向量，在此利用K-means clustering algorithm 將這些訓
練輸入值分為J群，亦即在隱藏層中會有J 個receptive field units，再
分別計算各個receptive field unit 的中心值(目標向量)以及變異數，並
記錄在receptive field unit 上。在這一階段中，只是單純地將訓練輸入
值分群，而輸入層和隱藏層之間的權重值並不做調整的動作，也可以
說此一權重值是沒有作用的，此不調整權重值的學習方式即為非監督
式學習。
接下來必須決定如何由隱藏層前進到輸出層。隱藏層和輸出層之
間的溝通主要是透過receptive field units 的激發水準(Ai, Activation
level)來決定，基本的激發水準計算是以歐幾里德距離(Euclidean
distance)為演算法則：
J,uRiRAi ii 1,2,...i






 (4.33)
其中

：訓練輸入值, 為一個多維的輸入向量。

iu ：receptive field units的中心值(目標向量)
J：receptive field units 的個數。
：平滑參數(Smoothing parameter)，為一大於0 的值。
iR ()：receptive field unit 的輻射基底函數
第四章 類神經網路與模糊理論
118








  H
i
i
H
i
ii
H
i
H
i
i
R
Rw
Ai
Aiw
d
1
1
1
1
)(
)(


 (4.36)
雖然加權平均在計算上較為複雜，但是在receptive field unit 之間
出現重疊(亦即出現交互作用)的時候，卻能有效指出各個receptive
field unit 彼此重疊的程度。事實上，若在隱藏層即先對所有節點的輻
射基底函數進行一次正規化的動作，亦即同除一個 )(Rii ，則所有
receptive field unit 激發水準值的總和結果將會與加權平均方法所得
的結果相同。同樣地，若將加權總和的值除上一個 )(Rii 或是
 ii A，也能得到和加權平均方法一樣的結果，相關的圖示如圖4.17(b)
所示。關於放射狀基底函數網路兩階段式的學習方法概略整理如表
4.2 所示。
圖 4. 17 放射狀基底函數網路輸出值之求取
1
2
W1
W2
W3
W4
A1
A2
A3
A4
 1
2
W1
W2
W3
W4
A1
A2
A3
A4

Ai
y y
(a)以加權總和計算 (b)以加權平均計算
120
4-7 模糊理論
現實生活中碰到的問題大多具備不確定性，每個人對同一問題
的看法也就不盡相同，這些不能用明確的數字或模型表達的事務，必
須藉助一種表達程度的語法來形容，因此產生了模糊理論，以便將事
物的特徵或性質以模糊型態或模糊群組來表現處理。
4-7-1 模糊理論簡介
模糊理論是查德(L.A. Zadeh) [43]教授於 1965 年所提出，其中模
糊集合(Fuzzy Set)的觀念，強調是以模糊邏輯來描述現實事物的等
級，並以歸屬於某一語法的數學函數(稱之為歸屬函數，membership
function)，將其歸屬度予以量化，讓我們在解決不明確的問題時，可
以使用歸屬函數將問題表達的更完整，以彌補明確集合中以二值邏輯
的缺點。常見的歸屬函數有以下三種(如圖 4.18 所示)(1)、(2)及(3)為
連續型，(4)為離散型。
圖 4. 18 常見的歸屬函數圖形[12]
(1)三角形
(3)吊鐘形
(2)梯形
(4)離散形
122
x : 為特性函數
x: 為任一自然數
Χ: 為明確集合
(4.1)式簡單的說就是，x 值若是屬於 X 集合內的元素， x =1，
反之， x =0。
(2) 模糊集合
明確集合的特性函數 x 非 1 及 0，若有一宇集合 A，所謂宇集
合即所有 x 的來源集合，其特性函數 x 是介於 0 和 1 之間，也就是
說， 1x 屬於 X 集合的程度比 2x 屬於 X 集合的程度大，這個程度是 0
到 1 的比較，所以屬於 X 集合內的各元素，並非明確的，而是模糊的，
X 稱之為模糊集合，而其特性函數為歸屬函數，通常此表示法為
)(x ，不再是 x ，如(4.38)式:
 Axxx  ,10  (4.38)
其中，
xX : 屬於 X 集合的歸屬函數
A : 宇集合，所有 x 的來源集合
4-7-3 模糊分類
模糊理論自 1965 年問世以來發展迅速，也被廣範應用於各方
面，其中 Bellman、Kalaba、Zadeh 和 Ruspini [43]開風氣之先，分別
於 1966 年和 1969 年提出模擬理論應用於聚類分析方面的研究，即所
謂模糊分類(Fuzzy Clustering)。現今許多模糊分類方面的研究分析都
導源於 Fuzzy-c-Mean(FCM)分類分析，FCM 分類演算法最早研究在
124
Cc1for,03
Ni1for,12
Cc1,Ni1for,101
21
21



icii
icii
ci
U...UUN).(
U...UU).(
],[U).(
4-7-4 FCM演算法
Bezdek 為解決模糊 C 分割的問題，推導滿足目標函數 ),( VUJ FCM
最小化的演算法，即目前較為廣泛討論的 FCM 演算法。
其中

 
mVXUVUJ
N
i
C
c
ci
m
ciFCM 1,)(),(
1 1
2 (4.41)
對於要進行 N 筆資料   nRni x,...,x 分成 C 類，有四個主要步驟
要考慮：
步驟 1：首先定義一個歸屬函數矩陣
  nchci RUU  (4.42)
其中 h 為疊代次數(Iterative Index) ，C 為分類數，N 為所要分類之資
料筆數，開始時 h=0。
步驟 2：產生 V 矩陣
126
第五章 最佳化理論
最佳化(Optimization)是指計算一個或多個變數的值使某一目標
函數值最大或最小，並滿足等式及不等限制式。5-1 節將簡介無限制
式的最佳化問題，並依據發展的先後順序介紹四種最佳化方法。5-2
節將說明如何將有限制式的最佳化問題，轉變成沒有限制式的最佳化
問題。
5-1無限制條件的最佳化問題
令某一目標函數為 f(x)，變數向量為 x，如欲表示為一個計算最
佳值的問題，可將此問題定義成(5.1)式至(5.2)式。
xf
x
opt
 nxxxx ...,,, 21
當 f(x)對變數向量中每一個變數微分皆為零時，此變數向量值所對應
的目標函數即為極值，此變數向量值也稱做 f(x)的最佳解。數學式如
(5.3)式。

 



























0
0
1

nx
xf
x
xf
(5.1)
(5.2)
(5.3)
128
Approximation, FDSA)
有限差分隨機近似法與梯度法相當類似，最大差別是此方法使用
差分值取代(5.4)式中的微分值，其疊代式如(5.5)式。


 
 

       

       
 











































k
n
kk
n
kk
k
kkkk
k
k
n
k
k
n
k
c
cxfcxf
c
cxfcxf
a
x
x
x
x
2
2
11
1
1
1
1
1
1
11



其中 i為一個 n 維向量，第 i 維的數值為 1，不是第 i 維的數值為 0。
例如：假設 n＝4，i=3 時，則 Ti ]0100[ 。此外，a(k)與 c(k)為一正
值的衰減函數，其函數值如(5.6)式與(5.7)式。

 

kA
a k


1

 

k
c k


1
(5.6)式與(5.7)式中的及值會因 x 的數量級的不同而有所不
同，例如：假設 x 的數量級為 105，f(x)對變數之差分值的數量級為 102，
如果期望疊代 100 次左右收斂，則 a(k)的數量級應在 101，即可決定
的大略值。此外，值的決定不需要很精準，因為此值只是決定疊代
步伐的乘數，只要數量級正確，數值的略大略小僅影響疊代的次數。
、理論值分別為 0.701 及 0.201，此理論值的推導請參閱[53]。A
值是另一個決定疊代速度的因素。
(5.5)
(5.6)
(5.7)
130
此外，同時擾動隨機近似法只有在計算二個以上自變數的最佳化
問題時，才會優於有限差分隨機近似法。當自變數的維度等於一時，
上述兩種方法的疊代過程將完全一樣。下面為簡單的證明：當自變數
的維度等於一時，有限差分隨機近似法的自變數步進值如(5.9)式。

       
k
kkkk
k
c
cxfcxf
a



2
1
1
11
1
1 
因為(5.9)式中 1等於 1，故自變數步進值可寫成(5.10)式。

       
k
kkkk
k
c
cxfcxf
a



2
1
1
1
1
另外，同時擾動隨機近似法在自變數維度等於一時的自變數步進值為
(5.11)式。

         
 kk
kkkkkk
k
c
cxfcxf
a
1
1
1
11
1
1
2 


其中 k1 為一個正一負一各半機率的隨機函數，當 k1 為正一時，自變
數步進值為(5.12)式。

       
k
kkkk
k
c
cxfcxf
a



2
1
1
1
1
(5.9)
(5.11)
(5.10)
(5.12)
132
其中 round(•)是指(•)值經過“四捨五入”後的值。此版本的最主要的缺
失在於 f(y)中的 y 必須要是整數，才符合實際應用狀況，換句話說，
當實際變數之資料型態為離散時，例如開關等，非離散變數值對 f(y)
則不具有意義。
據上述缺失，Hill 博士又於西元 2003 年再度提出更符合實際需
求的離散同時擾動隨機近似法，疊代式如(5.15)式。


 
 

         
 
 






































1
1
111
1
1
11
2 k
n
k
kkkk
k
k
n
k
k
n
k
xfxf
a
x
x
x
x


其中的y 是指 y 值經過“無條件捨去”後的值。此新版本已完全解決
原始版本與實際應用不符的情況。此外，此版本對離散疊代過程的收
斂特性有一特殊貢獻，其最主要的關鍵是等式左方及等式右方第一個
變數值是非離散的暫時值，也就是連續值，此連續值使離散的疊代過
成更接近連續特性，大幅提高了收斂特性，且不影響實際的應用。
第三版本的離散同時擾動隨機近似法是 Hill 博士又於西元 2005
年提出的，疊代式如(5.16)式。
(5.15)
134
處罰函數法是一個可將含有不等限制式之最佳化問題轉換成無
限制條件之最佳化問題的常用方法。(5.17)式至(5.19)式是一個含有不
等限制式的最佳化問題，經過處罰函數法轉換後的無限制式條件之最
佳化問題如(5.20)式至(5.23)式。
  


r
j
jj
x
xpwxf
1
2opt
  xgxp jj ,0max
 Trwwww ...,,, 21
 Tnxxxx ...,,, 21
其中 w 是一個 r 維的向量，r 為不等限制式的數目。
計算 w 值是使用 5-2-1 至 5-2-4 的最佳化方法配合處罰函數法處
理不等限制式時，最重要也是最困難的關鍵，w 值的每次疊代式如
(5.24)式。


 
 





































k
r
k
k
r
k
k
r
k
w
w
w
w
w
w

1
1
1
11
其中 kw1 , kw2 ,…, krw 是每次疊代時的增量，此組增量必須與
(5.20)式中的 p1, p2,…,pr相互協調。最終的 1w ,

2w ,…, 

rw 必須趨
(5.20)
(5.21)
(5.22)
(5.23)
(5.24)
136
l 為 
rkk
xg
,...,2,1 中大於零的總數。此問題變成一個 n+l 個未知變數的
最佳化問題。
當使用梯度逼近法計算(5.32)式至(5.34)式的最佳化問題時，變數
xi的疊代步進值( ix )如(5.34)式。
 







 
Kk i
k
k
i
xi x
xg
x
xf
a 
其中 a 為一個常數，一般 a 值大約為 x 的數量級除以  xxf  / 的數量
級。如果變數 xi的疊代步進值為 fxi , ，
 ifx xxfai  /,
則限制條件失效；如果變數 xi的疊代步進值為 gxi , ，






 
Kk i
k
kgx x
xg
a
i
,
則疊代計算後的結果僅能滿足限制式條件，並非最佳解。
gk(x)在經過一次疊代後的變動量可寫成 kg ：

Kk
x
xgn
i i
k
xg ik


 

,
1
令 gk(x)的變動量為-gk(x)(即經過一次疊代後，期望 gk(x)等於零之意)，
(5.37)式可改寫成(5.38)式。
(5.37)
(5.36)
(5.34)
(5.35)
138
成(5.43)式。
  






 
Kk i
k
k
i
x x
xg
xc
x
xf
a
i
接下來將詳細說明如何用(5.43)式推導 ck(x)：
步驟一：將(5.36)式中的指標 k 換成指標 s，以避免與(5.39)式中
的指標 k 混淆，取代指標後的(5.36)式代入(5.39)式中，
可得(5.44)式。
   Kkxg
x
xg
x
xg
a k
n
i i
k
Ks i
s
s 





 
 
,
1

步驟二：展開總加符號後重新排列，使指標為 s 的總加符號包含
指標為 i 的總加符號，如(5.45)式。
   Kkxga
x
xg
x
xg
k
Ks
n
i i
k
i
s
k 






 
 
  ,1
1

步驟三：(5.45)式為一組 l 條等式的聯立方程組，此聯立方程組即
為 l 個新增變數與 n 個未知變數之間的關係。為了清楚
表式此聯立方程組，可用矩陣方式表示之，如(5.46)式
所示。
(5.44)
(5.45)
(5.43)
140
第六章 本計畫使用之方法
6-1配電系統電容切換暫態之位置判斷研究方法
6-1-1 簡介
本計畫將以十八匯流排系統作為研究案例，且利用模擬軟體
MATLAB SimPowerSystem 建立十八匯流排系統，以取得不同電容器
切換之所有匯流排電壓及電流暫態訊號。圖 6.1 所示的是本計畫對小
波係數特徵值擷取的方式，以及辨識系統的流程圖。首先利用所得到
的電力訊號，透過 MATLAB 小波工具箱將其轉換成小波係數後，萃
取出包含在訊號中重要的成分，並運用能量觀點，以巴賽瓦定理
(Parsevals Theorem)對小波係數做各階能量的計算，並取前 5 階小波
係數能量作為暫態訊號之代表特徵值。接著利用模糊分類方法於量測
儀表之數量與最佳安裝位置。
最後將不同儀表安置組合所取得之暫態特徵資訊做為倒傳遞網
路、自我組織映射網路、主要成份分析網路及放射狀基底函數網路等
四種類神經網路之輸入向量，經過類神經網路訓練後，辨識各種不同
匯流排電容器切換之相對位置，而此網路乃是透過 NeuroSolutions 軟
體所建立，其用法在附錄 A 有詳細介紹。
圖 6. 1 判別電容器位置之流程圖
擷取
暫態訊號 利用
離散小波轉換
取得各階
小波係數
利用
巴賽瓦定理作
各階小波係數
之能量計算
代表特徵值
擷取
利用模糊分類
於量測儀表
之數量與
安裝位置
類神經網路
(ANN)
電容器位置
之判斷
142
轉換後，可得到小波係數 ][c1 n 與 ][d1 n ，如圖6.2(b) 所示。若要進一
步作第二層之分析，只需將第一層轉換後之近似係數 ][c1 n 當作輸入向
量即可產生第二層之小波係數 ][c 2 n 與 ][d 2 n ；依此類推，亦可完成多
層解析之小波轉換。若所需要之多層解析數量多時，則可使用多重解
析之指令。如圖6.2(c)為細部係數 ][d 3 n 與 ][d 4 n 。
(a)
(b)
(c)
c1[n]
c0[n]
d1[n]
d2[n]
d3[n]
圖 6. 2 db4 小波轉換
6-1-3小波轉換特徵值之擷取
6-1-3-1 巴賽瓦定理(Parsevals Theorem)
傳統之特徵擷取是採用均方根值，但它只能對於電壓驟昇(降)電
力中斷、過(低)電壓有效，對於諧波、脈衝暫態、電壓閃爍則無法量
144
忽略掉到信號某種的特徵，故本計畫採用擷取電容器投入時，前後五
個週期之波形，以避免擷取多餘不必要的信號又可得到信號的特徵，
並利小波轉換取得小波係數再利用能量的觀點來求得小波係數能
量。利用暫態波形圖 6.4(a)所取得的 db4 小波函數第一層到第十三層
之小波係數能量長條圖，如圖 6.3 所示。
圖 6. 3 小波轉換後之能量分佈圖
但能量觀點來看，在電力事故訊號中，基波的能量通常是遠大於
暫態的能量。所以基於本計畫之取樣率為 256(點/週)下，如圖 6.3 所
示，第七階(240Hz~120Hz)及第 8 階(120Hz~60Hz)能量明顯較大。因
此電力品質事故所造成之暫態能量，會因基波能量的存在而很難明顯
的顯現出來。若能將小波轉換與巴賽瓦裡論轉換出來的能量特徵值減
除掉基波的能量，就可以更明顯的凸顯不同電力品質事故之特徵。如
圖 6.4。
146
圖 6. 5 正常波形與暫態訊號之各階小波能量差
6-1-4 模糊分類法
上一節已詳細介紹代表特徵值之擷取方法，雖然能解決有效暫
態特徵之擷取問題，且減少擷取過多的信號與送入類神經網路之輸入
向量，增加類神經網路之效率。但實際上暫態訊號量測之儀表數目是
有限的，大量的儀表將造成電力公司龐大的成本負擔。接著本計畫利
用模糊分類來討論量測儀表之數量與最佳安裝位置，主要是依據
4-7-4 節中 FCM 演算法，求得當各電容器分別於電壓之相角為 0°、
90°、180°以及 270°時做切換動作，各個匯流排之五階電壓小波係數
能量和合及配電線之之五階電流小波係數能量和之分類，並分別假設
為暫態電流特徵值及暫態電壓特徵值。最後本計畫將針對 14、11、8、
4 及 2 等儀表個數，分別討論其結果。
6-1-4-1電流分類法
電流分類法乃是分別在設有電容器之匯流排做切換的動作，再依
據配電之暫態電流特徵值的大小加以分類求得歸屬值 Uci及該類重心
Vct 。













c
j
m
jtit
ctit
ci
VX
VX
U
1
2
1 (6.3)
148
1
2
1













mc
j jtit
ctit
ci
VX
VX
U (6.5)
 
 


 N
i
m
ci
N
i
it
m
ci
ct
U
XU
V
1
1 (6.6)
其中
c = 1 ,…, C為所欲分類之數目。
i = 1 ,…, N為匯流排之數目。
t = 1 ,…, T為配電線之數目。
Xit : 第 t 個匯流排作電容器切換，第 i 個匯流排之暫態電壓特徵
值。
Uci : 第 i 個匯流排之暫態電壓特徵值，屬於第 c 類之歸屬值。
Vct : 第 c 類匯流排暫態電壓特徵值的重心值。
儀表放置之準則如下：
(1) 從 Uci 的歸屬值得知那些匯流排之暫態電壓特徵值是屬於同一類。
(2) 利用 Vct 得知每一類重心值，並計算每一匯流排之暫態電壓特徵值
150
三、假設 C 個電容器之開關分別在電壓之相角為 90°、180°、270°、
360° 時做切換(Switch on/Switch off)，則有 C *4 組投入情況。
四、根據第二及第三項條件，則總共可組合出(B*E+１)* C *4 種電
路，以及所對應的資料。
五、把資料隨機化，取前 60%當作訓練資料(Training data)，接著 10%
當作確認資料(Validation data)，最後 30%當作測試資料(Testing
data)。
六、建立倒傳遞神經網路，於每個量測點將取得電壓或電流以及電壓
加電流，並取前五階小波係數能量做為代表特徵值，故依取得之
資料其輸入神經元個數分別為 D*5 (資料為電流或電壓)及
D*10(資料為電流加電壓)，輸出神經元個數為 4。圖 6-7 利用
NeuroSolutions 建立之倒傳遞神經網路。
七、當倒傳遞網路訓練完畢後，即可以判斷當電容器投入時，其相對
應之位置。
圖 6. 6 利用 NeuroSolutions 建立倒傳遞網路
6-1-5-2 結合自組織映射網路至倒傳遞網路於暫態源位置判斷
神經元輸入端 轉移函數 神經元輸出端
152
及 D*10(資料為電流加電壓)，輸出神經元個數為 4。圖 6.7 利用
NeuroSolutions 建立之自我組織映射網路。
七、當自我組織映射網路訓練完畢後，即可以判斷當電容器投入時，
其相對應之位置。
154
表 6. 1 自我組織類神經之輸出網路維度的行與列之排列準則
6-1-5-3 結合主要成份分析網路至倒傳遞網路於暫態源位置判斷
主要成份分析網路是一種非監督式的類神經網路，故本研究將結
合監督式類神經網路之倒傳遞網路於暫態源位置判斷上。主要成份分
析網路可以很快計算出輸入神經元的權重值，依據每個神經元權重值
的大小排列，當我們輸入想要減少的神經元個數時，主要成份分析網
路會留下神經元權重值大的值。假設輸入神經元個數有 m 個，當我
們設定主要成份分析網路個數為 n 個，則主要成份分析網路會忽略掉
(m-n)個權重值小的值，再將 n 個輸入神經元資料傳送到倒傳遞網路
作訓練，進而縮短網路訓練時間。本節將說明利用結合主要成份分析
網路至倒傳遞網路於暫態源位置判斷之步驟與方法。
電壓
電流
電流
電壓
訊號
擷取 432
11 11
8
8
5
3
7
6
5
3
2
7
6
5
3
2
11
9
8
5
3
7
6
5
3
2
7
6
5
3
2
10
8
6
4
8
7
6
4
2
8
7
6
4
2
11
10
8
6
4
8
7
6
4
2
8
7
6
4
2
行行行行
1
儀表
數目
(D) 列列列
四種輸出網路之維度
10
10
7
5
3
7
6
5
3
2
7
6
5
3
2
11
10
8
6
4
8
7
6
4
3
8
7
6
4
3
12
10
9
6
4
8
7
6
4
4
8
7
6
4
4
13
11
10
7
5
9
8
7
5
5
9
8
7
5
5
列
輸入
神經元
(D ＊5)
202
404
808
11011
14014
102
204
408
5511
7014
7014
5511
408
204
102
156
圖 6. 8 利用 NeuroSolutions 建立主要成份分析網路
由 4-5 節可知，主要成份分析網路是一種非監督式學習的網路，
它是將網路中之輸入資料轉換投射到新的空間(特徵空間)中作訓練
[40]。主要成份分析網路提供一個正交集合和順序的投射方式，其中
正交集合為輸入向量關係矩陣的特徵向量。而主要成份分析網路先計
算出輸入資料中最大的特徵值，然後依序投射到特徵向量空間，若網
路減少向量空間維度，則投射到特徵向量的特徵值將依序由大到小投
射到特徵向量空間，當向量空間不夠時，主要成份分析網路就會忽略
較小的特徵值。所以輸入向量關係矩陣的特徵向量之維度將影響訓練
結果與速度，故本將針對不同之主要分析成份個數做訓練，並討論其
相關結果。而學習法則為 SangersFull，其為一種非監督式學習。其權
重更新值為式 6.7 [47]：
)ywx(yΔw
i
1k
kkjjiij 

 (6.7)
其中
：學習速率(Step Size)
jx ：為第 j 個輸入值(系統中各匯流排之電壓或電流代表特徵
值)
神經元輸入端 主要成份分析網路 轉移函數 神經元輸出端
158
6-1-5-4 利用放射狀基底函數網路於暫態源位置判斷
放射狀基底函數網路是一種較新發展出來的神經網路，尤其應用
於非線性系統的鑑別上有著其顯著的效果，像是最為廣泛的死區鑑別
應用就是一個很好的例子，已經有許多強而有力的實驗成果可以驗
證。 這種類神經的網路架構用在函數的近似上尤其有極好的效果。
特別是其對輸入輸出關係描述為線性是最引人注意的特性之一。也因
為這個特性，我們目前所採用的控制方式能夠處理這個系統輸入非線
性所導致的影響，並且也能夠處理非線性化的參數了。本節將說明利
用放射狀基底函數網路於暫態源位置判斷之步驟與方法。
以下列出利用放射狀基底函數網路做電容器暫態源位置判斷之步驟：
一、測試系統有 A 個匯流排個數，B 個匯流排有負載，C 個電容器，
D 個儀表數目。
二、假設 B個匯流排有負載量分別變化 E 個正負百分比，則有(B*E+1)
種變化。
三、假設 C 個電容器之開關分別在電壓之相角為 90°、180°、270°、
360。 時做切換(Switch on/Switch off)，則有 C *4 組投入情況。
四、根據第二及第三項條件，則總共可組合出(B*E+１)* C *4 種電
路，以及所對應的資料。
五、 把資料隨機化後，取前 60%當作訓練資料(Training data)，接著
10%當作確認資料(Validation data)，最後 30%當作測試資料
(Testing data)。
六、建立主要放射狀基底函數網路，於每個量測點將取得電壓或電流
以及電壓加電流，並取前五階小波係數能量做為代表特徵值，故
依取得之資料其輸入神經元個數分別為 D*5 (資料為電流或電壓)
160
圖 6. 10 電力公司網路的戴維寧等效電路模型
圖中的 RS 為電力系統等效電阻，LS 為電力系統等效電感，hS 為諧波
階數，f1為系統基頻。
一般電力公司僅提供責任分界點上的短路容量(SSCC)及品質因數
(QSCC)給客戶端，故 RS及 LS與 SSCC及 QSCC的關係如下：
1
22
2
2
2
1
f
S
V
Q
Q
L SCCSCC
SCC
S 






22
21
1






SCCSCC
S S
V
Q
R
(2) 發電機模型：發電機一般比較不會產生諧波電壓，故可以以
一個簡單的並聯阻抗來表示，通常是使用次暫態或負序電抗值。更完
整的模型則是考慮發電機電阻的集膚效應，可用(6.10)式表示[71]：
)0.1( BDC hARR 
(6.8)
(6.9)
(6.10)
162
1/(2π∙hS∙f1∙CF)
2π∙hS∙f1∙LF
圖 6. 11 單調式濾波器的諧波模型
圖中 LF為濾波器的電感值，CF為濾波器的電容值。通常用來表示濾
波器的單位是濾波器的電容量(QCF)及濾波器的諧振點(mF)，(6.11)式
為 LF、CF與 QCF、mF的關係式。
CF
F Qf
C


12
1

  122 fm
Q
L
F
CF
F 


(7) 其他負載：在工廠內最常見到電感性及電容性負載，這類的
被動性元件皆可被表示成頻率的函數，其差異在於電感器之阻抗值和
頻率成正比，而電容器之阻抗值和頻率成反比，(6.13)式及(6.14)式即
為在諧波次為 h 時之等效電感抗及電容抗值。
hXhX LL  )1()(
(6.11)
(6.12)
(6.13)
164
 責任分界點上最低功率因數限制函數
關於自變數的上限及下限函數如(6.16)式至(6.19)式。
JjHhQQ CFhjCFhj  ,,0max
JjHhQQ CFhjCFhj  ,,0min
JjHhhmFhj  ,,092.0
  JjHhmh Fhj  ,,01
其中 maxCFhjQ 及
min
CFhjQ 分別為自變數 QCFhj的上限值及下限值，
max
Fhjm 及
min
Fhjm
分別為自變數 mFhj的上限值及下限值。
關於各級諧波電壓在各匯流排上的限制函數如(6.20)式。
JjHhVV hjhj  ,,max
其中 maxhjV 為 h 級諧波在匯流排 j 之電壓等級時的諧波電壓限制值， hjV
可由(6.21)式求得：
(6.17)
(6.18)
(6.19)
(6.20)
(6.16)
166
  
  

H
h
N
j
J
k
S
jk
S
jk hLEhLEMin
2 1 1
11
21
s.t
  NjVV
peak
jhCjhC ,,2,1， 
      NjII
peak
jhLhLjhLhL ,,2,1，2121  
其中 J：小波理論中刻度層之總數
1S
jkE ：當 S1投入時，第 j 個匯流排上第 k 刻度層能量
2S
jkE ：當 S2投入時，第 j 個匯流排上第 k 刻度層能量
VC(h)j：第 j 個匯流排上，第 h 次濾波器上電容器兩端電壓
I(L1(h)+L2(h))j：通過第 j 個匯流排上，第 h 次濾波器上電感之電流
(6.24)中的能量值，是 MATLAB 小波工具箱的計算結果。關於
MATLAB 小波工具箱的使用，請參閱 6-1-2。
(6.24)
(6.25)
(6.26)
168
圖 7. 1 十八個匯流排系統單線圖
圖 7. 2 MATLAB SimPowerSystem 模擬十八個匯流排系統電路圖
B51B50B1B2B3B4B5B6B7B8
B9
B20
B22
B21
B23
B24B25
B26 AC138KV
Transformer
10MVA
12.8KV-138KV
51501234567
8
9 20
22
21
23
2425
26
System Base=10MVA
Substation
12.5KV / 138KV Swing Bus
170
基於研究上之便利，將上述之十八個匯流排系統依輸電線之起始
和終止匯流排位置做重新編號，如表 7.3 所示。以及每個匯流排新舊
對應之編號，如表 7.4 所示。
表 7. 3 十八個匯流排系統每條配電線的起始和終止匯流排位置
表 7. 4 十八個匯流排系統每個匯流排新舊對應之編號
7-2 小波係數能量
由於小波轉換後會產生大量的小波係數，進而造成送入辨識系統
之輸入向量過大，降低辨識系統之效率以及運算速度，因此本計畫也
運用能量觀點，以巴賽瓦定理對小波係數做各階能量的計算，取暫態
訊號之前 5 階能量及能量和分別作為類神經網路之輸入向量及模糊
演算法之暫態特徵值。以期有效解決擷取過多信號等問題。本節例舉
三種電路組合並根據上述之方法分別作說明。
1716151413121110配電線
50,5150,125,2623,2523,2421,2321,2220,21
匯流排
位置
987654321配電線
1,202,97,86,75,64,53,42,31,2
匯流排
位置
181716151413121110新編號
515026252423222120舊編號
987654321新編號
987654321舊編號
172
(a)匯流排一至十八之電壓五階小波係數能量
(b)匯流排一至十八之電壓五階小波係數能量和
圖 7. 4 電路一之五階電壓小波係數能量
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus1
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus2 bus3 bus4 bus5 bus6
bus7 bus8 bus9 bus10 bus11 bus12
bus13 bus14 bus15 bus16 bus17
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus18
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 (Bus)
174
(2) 暫態電路二：
假設匯流排十二之電容器開關於 90°時投入，如圖 7.6 所示。圖
7.7(a)(b)分別為匯流排一至十八之電壓五階小波係數能量及能量和。
圖 7.8(a)(b)為一至十七條配電線之電流五階小波係數能量及能量和。
圖 7. 6 電路二
12345678 9
10
11
12
13
14
15
16
17
18
176
(a)配電線一至十七之電流五階小波係數能量
(b)配電線一至十七之電流五階小波係數能量和
圖 7. 8 電路二之五階電流小波係數能量
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
Line1
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
Line2 Line3 Line4 Line5 Line6
Line7 Line8 Line9 Line10 Line11 Line12
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
Line13 Line14 Line15 Line16 Line17
1 2 3 4 5
6
4
2
0
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 (Line)
178
(a)匯流排三至十八之電壓五階小波係數能量
(b)匯流排三至十八之電壓五階小波係數能量和
圖 7. 10 電路三之五階電壓小波係數能量
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus1
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus2 bus3 bus4 bus5 bus6
bus7 bus8 bus9 bus10 bus11 bus12
bus13 bus14 bus15 bus16 bus17
1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
bus18
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 (Bus)
180
7-3模糊分類之模擬結果
在前述章節已詳細說明模糊分類法之使用方法及研究之步驟，
本計畫利用模糊分類來討論量測儀表之數量與最佳安裝位置，主要是
依據 4-7-4 節中 FCM 演算法，求得當各電容器分別於電壓之相角為
0°、90°、180°以及 270°時做切換動作，各個匯流排之五階電壓前五
階小波係數能量合及配電線之之電流前五階小波係數能量合之分
類。並針對 14、11、8、4 及 2 等儀表個數，分別討論其結果。
7-3-1以電流模糊分類分析安置量測儀表
表 7.5 表示根據 4-7 節中的模糊分類方法所得不同類別下，每類
所包含之配電線。表 7.6 中符號○表示根據模糊分類，所選取儀表應
放置的 C 條配電線。
表 7. 5 十八匯流排系統依據電流模糊分類法所得之分類
(1),( 2,3,4, 5,6,7,8,9,10,1112,13,14,15,16,17 )
(1),(2,3,4,5,6, 9,10,11,13,14,15,16,17),( 7),(8)
(1),(2,9,10,11,13,14,17),(3,4,6,12),(5),(7),(8),(15),(16)
(1),(2,9,10,13,17),(3),(4,6),(5),(7),(8),(11,14),(12),(15),(16)
(1,2,14,15,),(3),(4),(5),(6),(7),(8),(9)(10),(11),(12),(13),(16),(17)
配電線
2
4
8
11
14
分類數
目
182
表 7. 8 十八匯流排系統依據電壓模糊分類法所得儀表放置位置
○
○
○
18
○○2
○○○○4
○○○○○○○8
○○○○○○○○○○11
○○○○○○○○○○○○○14
1716151413121110987654321
匯流排
儀表數目
184
認，進出推斷對應之暫態源及匯流排位置，所以可得十種不同的主要
判斷情況，如表 7.10 所示。而依照此十種判斷情況可得目標函數如
表 7.11 所示。表 7.9 為根據十八個匯流排系統新匯流排編號與對應電
容器之編號。
表 7. 9 十八個匯流排系統匯流排與對應電容器之編號
表 7. 10 電容器開關之投入情形
表 7. 11 輸出神經元編碼
10
25
987654321
電容器
(開關)
2421207543250匯流排
ON
─
─
─
─
─
─
─
─
─
開
關
10
─
ON
─
─
─
─
─
─
─
─
開
關
9
─
─
ON
─
─
─
─
─
─
─
開
關
8
─
─
─
ON
─
─
─
─
─
─
開
關
7
─
─
─
─
ON
─
─
─
─
─
開
關
6
─
─
─
─
─
ON
─
─
─
─
開
關
5
─
─
─
─
─
─
ON
─
─
─
開
關
4
─
─
─
─
─
─
─
ON
─
─
開
關
3
──10
──9
──8
──7
──6
──5
──4
──3
ON─2
─ON1
開
關
2
開
關
1
事件
1010
10
1001
9
1000
8
0111
7
0110
6
0101
5
0100
4
0011
3
0010
2
0001編碼
1事件
186
其中倒傳遞網路之各項參數分別為：輸入層之神經元個數如表
7.12 所示，有 15 種情況；輸出層之神經元個數為 4，如表 7.11 所示；
隱藏層層數為 1；隱藏層之神經元個數是以輸入層之神經元個數取一
半並做四捨五入；隱藏層及輸出層之轉移函數皆為 SigmoidAxon；學
習規則為 Momentum；非監督式學習之最大學習次數為 1000；監督
式學習之學習次數為 10000；學習率為從 0.01 減至 0.001；收斂條件
為訓練資料與確認資料之 MSE 小於 0.01。判定之方法為：以四捨五
入法取到整數位，其值若大於 0.5 則判定為 1，反之則判定為 0，目
標函數與輸出函數之誤差都為零，表示輸出函數與目標函數相同，則
正確率為 100 %。
結果討論
由表 7.13 中可知所有 Case 都有收斂，收斂次數最高為 Case6，
最低為 Case14。而收斂時間會受收斂次數及輸入神經元個數所影響，
其中最長收斂時間為 Case6。以事件判定結果做觀察可得: 當輸入倒
傳遞網路之資料為 Case10 時，有最高之辨識率，即輸入資料以十四
個量測儀表所擷取一至五階電流代表特徵值之方式，其結果最好。若
輸入之資料以二個量測儀表所擷取一至五階電壓電流小波係數能量
之方式，其結果最差。
表 7.14 以輸入代表特徵值種類之不同所做結果比較。其中平均
事件判定結果以電流小波係數能量之方式最高，平均收斂時間以電壓
小波係數能量之方式最短，而平均收斂次數以電壓電流小波係數能量
之方式最少。由此表可發現輸入小波係數能量種類之不同會明顯影不
同輸出結果，即不同小波係數能量種類可應用於不同情況。
表 7.15 以儀表數目之不同所做結果比較。由表可知之除了儀表
188
表 7. 14 倒傳遞網路之模擬結果比較(2)
表 7. 15 倒傳遞網路之模擬結果比較(3)
92.98494.492.712平均事件判定結果(%)
7.68.84
平均收斂時間
(秒)
28.6160.836.2平均收斂次數
Case11至
Case16
(電壓電流)
Case6至
Case10
(電流)
Case1至
Case5
(電壓)
94.173
9
16
Case6
Case10
Case15
14
93.26
3.66
13.66
Case4
Case9
Case14
11
Case3
Case8
Case13
Case2
Case7
Case12
電壓
電流
電壓電流
Case1
Case6
Case11
93.53692.44693.40
平均事件
判定結果
(%)
6.337.337.66
平均收
斂時間
(秒)
72.6691182.66
平均收
斂次數
842儀表數目
190
Case 6-2 2 一至五階電流小波係數能量 7 10
Case 6-3 2 一至五階電流小波係數能量 6 10
Case 6-4 2 一至五階電流小波係數能量 5 10
Case7-1 4 一至五階電流小波係數能量 20 20
Case 7-2 4 一至五階電流小波係數能量 10 20
Case 7-3 4 一至五階電流小波係數能量 7 20
Case 7-4 4 一至五階電流小波係數能量 5 20
Case 8-1 8 一至五階電流小波係數能量 40 40
Case 8-2 8 一至五階電流小波係數能量 20 40
Case 8-3 8 一至五階電流小波係數能量 14 40
Case 8-4 8 一至五階電流小波係數能量 10 40
Case 9-1 11 一至五階電流小波係數能量 55 55
Case 9-4 11 一至五階電流小波係數能量 28 55
Case 9-3 11 一至五階電流小波係數能量 19 55
Case 9-4 11 一至五階電流小波係數能量 14 55
Case 10-1 14 一至五階電流小波係數能量 70 70
Case 10-2 14 一至五階電流小波係數能量 35 70
Case 10-3 14 一至五階電流小波係數能量 24 70
Case 10-4 14 一至五階電流小波係數能量 18 70
Case 11-1 2 一至五階電壓電流小波係數能量 20 20
Case 11-2 2 一至五階電壓電流小波係數能量 10 20
Case 11-3 2 一至五階電壓電流小波係數能量 7 20
Case 11-4 2 一至五階電壓電流小波係數能量 5 20
Case 12-1 4 一至五階電壓電流小波係數能量 40 40
Case 12-2 4 一至五階電壓電流小波係數能量 20 40
Case 12-3 4 一至五階電壓電流小波係數能量 14 40
Case 12-4 4 一至五階電壓電流小波係數能量 10 40
Case 13-1 8 一至五階電壓電流小波係數能量 80 80
Case 13-2 8 一至五階電壓電流小波係數能量 40 80
Case 13-3 8 一至五階電壓電流小波係數能量 27 80
Case 13-4 8 一至五階電壓電流小波係數能量 20 80
Case 14-1 11 一至五階電壓電流小波係數能量 110 110
Case 14-2 11 一至五階電壓電流小波係數能量 55 110
192
Case14 隨主要分析成份個數遞減而減少。但每次收斂時間完全因為
主要分析成份個數遞減而明顯減少，故主要分析成份個數確實會影響
類神經網路之每次之收斂時間。
表 7.18 為每個 Case 之平均輸出結果與總平均。表 7.19 為以輸入
代表特徵值種類之不同所做結果比較。其中平均事件判定結果以電壓
電流小波係數能量之方式最高，即輸入層之神經元個數越多平均事件
判定結果越高;平均收斂時間以電壓小波係數能量之方式最短，而平
均收斂次數以電壓電流小波係數能量之方式最少。
表 7. 17 主要成份分析網路結合倒傳遞網路之模擬結果比較(1)
收斂
情況
(是/否)
收斂
次數
收斂
時間
(秒)
每次
收斂時間
(秒/次)
事件判定
結果(%)
主要分析
成份個數
Case 1-1 是 211 9 0.0427 90.04 10
Case 1-2 是 134 6 0.0448 90.58 7
Case 1-3 是 172 7 0.0407 89.76 6
Case 1-4 是 521 21 0.0403 90.31 5
Case 2-1 是 42 3 0.0714 94.27 20
Case 2-2 是 94 5 0.0532 92.36 10
Case 2-3 是 144 8 0.0556 92.9 7
Case 2-4 是 140 6 0.0429 98.09 5
Case 3-1 是 19 4 0.2105 94.95 40
Case 3-2 是 23 4 0.1739 95.08 20
Case 3-3 是 34 4 0.1176 93.17 14
Case 3-4 是 29 3 0.1034 93.17 10
Case 4-1 是 19 7 0.3684 92.76 55
Case 4-4 是 24 5 0.2083 90.45 28
Case 4-3 是 23 4 0.1739 90.45 19
194
Case 12-1 是 28 7 0.25 95.9 40
Case 12-2 是 40 5 0.125 96.04 20
Case 12-3 是 86 9 0.1047 95.9 14
Case 12-4 是 116 10 0.0862 96.18 10
Case 13-1 是 23 15 0.6522 95.63 80
Case 13-2 是 18 4 0.2222 94.4 40
Case 13-3 是 20 3 0.15 93.45 27
Case 13-4 是 24 3 0.125 97.27 20
Case 14-1 是 34 77 2.2647 96.58 110
Case 14-4 是 31 43 1.3871 94.81 55
Case 14-3 是 30 11 0.3667 94.95 37
Case 14-4 是 34 8 0.2353 94.95 28
Case 15-1 是 15 22 1.4667 94.67 140
Case 15-2 是 37 58 1.5676 94.67 70
Case 15-3 是 31 30 0.9677 94.67 47
Case 15-4 是 53 51 0.9623 94.67 35
196
7-4-4 結合自我組織映射網路至倒傳遞網路之模擬結果
自我組織映射網路(SOM)是一種非監督式的類神經網路，本計畫
擬結合自我組織映射網路與倒傳遞網路，而使倒傳遞網路輸入神經元
個數減少，進而討論相關結果。根據表 7.12 之倒傳遞網路之輸入神
經元選取方式再搭配表 6.1 自我組織類神經之輸出網路維度的行與列
個數做三次遞減而可分出共 60 種 Case，如表 6.20 所示。
198
Case 8-1 8 一至五階電流小波係數能量 7x6 40
Case 8-2 8 一至五階電流小波係數能量 6x6 40
Case 8-3 8 一至五階電流小波係數能量 6x5 40
Case 8-4 8 一至五階電流小波係數能量 5x5 40
Case 9-1 11 一至五階電流小波係數能量 8x7 55
Case 9-4 11 一至五階電流小波係數能量 7x7 55
Case 9-3 11 一至五階電流小波係數能量 7x6 55
Case 9-4 11 一至五階電流小波係數能量 6x6 55
Case 10-1 14 一至五階電流小波係數能量 9x8 70
Case 10-2 14 一至五階電流小波係數能量 8x8 70
Case 10-3 14 一至五階電流小波係數能量 8x7 70
Case 10-4 14 一至五階電流小波係數能量 7x7 70
Case 11-1 2 一至五階電壓電流小波係數能量 5X4 20
Case 11-2 2 一至五階電壓電流小波係數能量 4X4 20
Case 11-3 2 一至五階電壓電流小波係數能量 4X3 20
Case 11-4 2 一至五階電壓電流小波係數能量 3X3 20
Case 12-1 4 一至五階電壓電流小波係數能量 7x6 40
Case 12-2 4 一至五階電壓電流小波係數能量 6x6 40
Case 12-3 4 一至五階電壓電流小波係數能量 6x5 40
Case 12-4 4 一至五階電壓電流小波係數能量 5x5 40
Case 13-1 8 一至五階電壓電流小波係數能量 10x8 80
Case 13-2 8 一至五階電壓電流小波係數能量 9x8 80
Case 13-3 8 一至五階電壓電流小波係數能量 8x8 80
Case 13-4 8 一至五階電壓電流小波係數能量 7x8 80
Case 14-1 11 一至五階電壓電流小波係數能量 11x10 110
Case 14-2 11 一至五階電壓電流小波係數能量 10x10 110
Case 14-3 11 一至五階電壓電流小波係數能量 10x9 110
Case 14-4 11 一至五階電壓電流小波係數能量 9x9 110
Case 15-1 14 一至五階電壓電流小波係數能量 13x11 140
Case 15-2 14 一至五階電壓電流小波係數能量 12x11 140
Case 15-3 14 一至五階電壓電流小波係數能量 11x11 140
Case 15-4 14 一至五階電壓電流小波係數能量 11x10 140
200
壓電流小波係數能量之方式最高，即輸入層之神經元個數越多平均事
件判定結果越高;平均收斂時間以電壓代表特徵值之方式最短，而平
均收斂次數以電壓電流小波係數能量之方式最少。
202
Case 7-4 否 11000 698 0.0635 86.9 3X3
Case 8-1 是 988 193 0.1953 92.9 7x6
Case 8-2 是 838 152 0.1814 93.45 6x6
Case 8-3 是 916 153 0.167 94.67 6x5
Case 8-4 是 1138 151 0.1327 95.36 5x5
Case 9-1 是 1680 502 0.2988 94.4 8x7
Case 9-2 是 2844 772 0.2714 94.4 7x7
Case 9-3 是 1933 471 0.2437 94.4 7x6
Case 9-4 是 3772 841 0.223 94.13 6x6
Case 10-1 是 1167 759 0.6504 95.49 9x8
Case 10-2 是 1316 528 0.4012 95.63 8x8
Case 10-3 是 2017 739 0.3664 95.63 8x7
Case 10-4 是 4152 1373 0.3307 95.36 7x7
Case 11-1 是 2698 281 0.1042 91.81 5X4
Case 11-2 是 1661 169 0.1017 91.81 4X4
Case 11-3 是 1460 88 0.0603 95.36 4X3
Case 11-4 是 4687 339 0.0723 90.31 3X3
Case 12-1 是 1132 234 0.2067 96.04 7x6
Case 12-2 是 2464 912 0.3701 96.04 6x6
Case 12-3 是 5487 1153 0.2101 94.81 6x5
Case 12-4 是 2613 717 0.2744 95.49 5x5
Case 13-1 是 10502 9748 0.9282 91.4 10x8
Case 13-2 是 1240 2929 2.3621 94.4 9x8
Case 13-3 是 818 212 0.2592 89.9 8x8
Case 13-4 是 6727 5054 0.7513 91.67 7x8
Case 14-1 是 2972 7803 2.6255 90.58 11x10
Case 14-4 是 1711 7097 4.1479 89.63 10x10
Case 14-3 是 1182 8159 6.9027 93.17 10x9
Case 14-4 是 1211 7149 5.9034 93.31 9x9
Case 15-1 是 699 10939 15.6495 94.13 13x11
Case 15-2 是 2662 17497 6.5729 93.72 12x11
Case 15-3 是 2527 14360 5.6826 87.03 11x11
204
表 7. 22 自我組織類神經網路結合倒傳遞網路之模擬結果(2)
平均收斂次數
平均收斂時間
(秒)
平均事件判
定結果(%)
Case1-1 ~ 4 8566.25 304.75 79.53
Case2-1 ~ 4 2294 162.75 91.67
Case3-1 ~ 4 1160.25 198 93.72
Case4-1 ~ 4 2429.25 517 92.29
Case5-1 ~ 4 1425.5 1315.75 93.65
Case6-1 ~ 4 8384.5 667 80.18
Case7-1 ~ 4 11000 803.5 90.89
Case8-1 ~ 4 970 162.25 94.1
Case9-1 ~ 4 2557.25 646.5 94.33
Case10-1 ~ 4 2163 849.75 95.53
Case11-1 ~ 4 2626.5 219.25 92.32
Case12-1 ~ 4 2924 754 95.6
Case13-1 ~ 4 4821.75 4485.75 91.84
Case14-1 ~ 4 1769 7552 91.67
Case15-1 ~ 4 2758.75 15260.25 92.08
Case1~Case15
總平均
3723.333 2259.9 91.29
206
表 7. 24 放射狀基底函數網路之輸入神經元選取
其中放射狀基底函數網路之各項參數分別為：RFU 數目如表 7.24
所示，會隨輸入神經元個數之不同而改變；輸入層之神經元個數如表
7.24 所示，有 15 種情況；輸出層之神經元個數為 4，如表 7.11 所示；
隱藏層層數為 1；隱藏層之神經元個數是以輸入層之神經元個數取一
半並做四捨五入；隱藏層及輸出層之轉移函數皆為 SigmoidAxon；學
習規則為 Momentum；而競爭法則為 Consciencefull；非監督式學習
之最大學習次數為 1000；監督式學習之學習次數為 10000；學習率為
從 0.01 減至 0.001；收斂條件為訓練資料與確認資料之 MSE 小於
0.01。判定之方法為：以四捨五入法取到整數位，其值若大於 0.5 則
135
110
80
25
15
65
50
25
15
10
65
55
25
15
10
RFU
數目
一至五階電壓電流小波係數能量
一至五階電壓電流小波係數能量
一至五階電壓電流小波係數能量
一至五階電壓電流小波係數能量
一至五階電壓電流小波係數能量
一至五階電流小波係數能量
一至五階電流小波係數能量
一至五階電流小波係數能量
一至五階電流小波係數能量
一至五階電流小波係數能量
一至五階電壓小波係數能量
一至五階電壓小波係數能量
一至五階電壓小波係數能量
一至五階電壓小波係數能量
一至五階電壓小波係數能量
輸入小波係數能量 輸入神經元數目
儀表
數目Case
140
110
80
40
20
70
55
40
20
10
70
55
40
20
10
14Case 15
11Case 14
8Case 13
4Case 12
2Case 11
14Case 10
11Case 9
8Case 8
4Case 7
2Case 6
14Case 5
11Case 4
8Case 3
4Case 2
2Case 1
208
表 7. 25 放射狀基底函數網路之模擬結果比較(1)
135
110
80
25
15
65
50
25
15
10
65
55
25
15
10
RFU數目
90.0474104799是Case 15
91.391372.91941平均
92.9
92.76
94.4
90.72
94.4
92.63
93.17
91.81
92.22
89.35
90.45
89.9
90.04
86.08
事件判
定結果
(%)
13175是Case 11
511500是Case 12
28325333是Case 13
69756915是Case 14
29658是Case 6
15221是Case 7
93672是Case 8
4251400是Case 9
16713777是Case 10
是
是
是
是
是
收斂情
況
(是/否)
439
457
142
35
7
收斂
時間
(秒)
915
1405
976
243
127
收斂
次數
Case 1
Case 2
Case 5
Case 4
Case 3
210
本計畫利用倒傳遞網路、自我組織映射網路、主要成份分析網路
及放射狀基底函數網路等四種不同類神經網路作為來判斷電容器暫
態源位置，其辨識效果均能達到設定之目的。由此驗證本計畫所提之
方法能正確判斷電容器暫態源位置。但由於每一種網路之特性與訓練
結果皆不同，故在此利用不同之判斷基準整理出下列比較，如表
7.28、7.29、7.30。
表 7. 28 四種類神經之事件判定結果比較
由表 7.28 可知主要成份分析網路結合倒傳遞網路之事件判定結
果為最佳。而以電壓電流小波係數能量之方式所得事件判定結果普遍
較較好。故如以事件判定結果作為儀表安裝之主要基準，本研究建議
以主要成份分析網路結合倒傳遞網路作為電容器暫態源位置辨識系
統，並以電壓電流小波係數能量之方式作為輸入向量之擷取。至於儀
表數量與安裝位置可根據上述之建議方式再經由表 7.17 之 Case6 至
Case10 可得，當儀表數量為 2、4、8、11、14 時，其事件判定結果分
別為 90.81%、91.2%、93.7%、94.4%以及 96.1%。
總平均
Case11至
Case16
(電壓電流)
Case6至
Case10
(電流)
Case1至
Case5
(電壓)
91.39 %92.16 %92.85 %89.16 %
放射狀基底
函數網路
91.29 %92.7 %91 %90.17 %
自我組織類神經網
路至倒傳遞網路
93.63 %94.798 %93.262 %92.842 %
主要成份分析網路
至倒傳遞網路
92.984 %92.984 %94.4 %92.712%倒傳遞網路
212
由表 7.30 可知倒傳遞網路之收斂時間為最佳。而以電壓代表特
徵值之方式所得收斂時間普遍較好。故如以收斂時間作為儀表安裝之
主要基準，本研究建議以倒傳遞網路作為電容器暫態源位置辨識系
統，並以電壓代表特徵值之方式作為輸入向量之擷取。至於儀表數量
與安裝位置可根據上述之建議方式再經由表 7.13 之 Case6 至 Case10
可得，當儀表數量為 2、4、8、11、14 時，其收斂時間分別為 4、4、
3、4 以及 5 秒。
7-6 配電系統單調式濾波器設計研究
本計畫採用一個十八個匯流排的系統模擬單調式濾波器的設計
問題。系統單線圖如圖 7. 3 所示。表 7. 31 為注入系統的諧波電流。
表 7. 32 是系統尚未加裝功因補償電容器及濾波器時，每一個匯流排
的諧波電壓。系統未加裝濾波器及電容器前的功率因數為 0.84。
表 7. 32 顯示，匯流排九及匯流排十的的五次及七次諧波電壓最
為嚴重，故本計畫決定以匯流排九及匯流排十為加裝單調式濾波器的
候選匯流排。如果設計結果中，某一匯流排上濾波器的電容量離散值
為零個單位，代表此匯流排不需要裝設濾波器，就此原理，候選匯流
排的數量是越多越好。當候選匯流排的數量越多時，最佳化問題函數
的非線性成份越高，對以梯度為疊代依據的演算法相當不利，會造成
疊代發散的現象。
表 7. 31 注入系統的諧波電流
諧波電流注入量(%) 匯流排三 匯流排六 匯流排十
五階 12.0 10.5 10.5
七階 3.5 4.9 5.0
214
始值。由目標函數式得知，濾波器的電容器容量越小，諧振點越大，
則設備成本則越小。基於上述兩個條件，五階與七階濾波器之電容器
容量的疊代初始值為 10 個 6000KVAR 的電容器組並接，諧振點的疊
代初始值分別為接近且小於 4.6 及 6.44 的值。
圖 7. 12至圖 7. 16為利用離散同時擾動隨機近似法配合新型不等
限制式處理法，計算單調式濾波器設計問題的疊代過程。圖 7. 12 與
圖 7. 13 分別為候選匯流排中，五階濾波器的電容器容量及諧振點的
疊代計算過程；圖 7. 14 與圖 7. 15 分別為候選匯流排中，七階濾波器
的電容器容量及諧振點的疊代計算過程；圖 7. 16 為目標函數值的疊
代過程。表 7. 33 為利用離散同時擾動隨機近似法配合新型不等限制
式處理法，計算單調式濾波器設計問題的模擬結果，圖 7. 17 為加裝
濾波器前後系統的五階諧波電壓，圖 7. 18 為加裝濾波器前後系統的
七階諧波電壓。
圖 7. 12 五階單調式濾波器電容器容量的疊代過程
216
圖 7. 15 七階單調式濾波器諧振點的疊代過程
圖 7. 16 目標函數的疊代過程
218
0
0.5
1
1.5
2
2.5
3
3.5
4
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18
匯流排編號
諧
波
電
壓
(%
)
未裝置濾波器及電
容器
裝置濾波器
圖 7. 18 加裝濾波器前後的系統的七階諧波電壓
表 7. 33 的計算結果中，濾波器中電容器容量 Q5i及 Q7i的值為零
時，代表在此匯流排上不需要加裝濾波器，m5i及 m7i的值也就沒有意
義。從目標函數式得知，mki的值會乘上 Qki的值，所以當 Qki的結果
為零，且 mki沒有超過上下限時，(7.1)式為零
     0,, 

  mQgmQfm CjCki
Δmki等於零，mki不再疊代，如圖 7. 14 與圖 7. 15 中 120 次至 190 次
的疊代過程。所以當 Qki的值為零時，則不需要看 mki的值。
圖 7. 17 及圖 7. 18 顯示，配電系統加裝濾波器後，除了匯流排十的七
階諧波電壓稍微超出管制標準外，其餘所有匯流排上的五階與七階諧
波電壓皆滿足諧波管制標準。此外，圖 7. 19 為匯流排十的七階諧波
電壓疊代過程，對照圖 7. 19 及圖 7. 16 中第 100 次至第 200 次的疊代
過程，顯示本計畫提出的不等限制式處理法，使疊代過程先滿足最小
(7.1)
220
圖 7. 20 目標函數疊代過程
表 7. 34 以基因演算法設計單調式濾波器的模擬結果
Q 5i (pu ) m 5i Q 7i (pu ) m 7i
匯流排九 0 0
匯流排十 0.24 4.6 0.24 6.44
裝置成本
計算時間
七階濾波器
182,857元
12分32秒
五階濾波器
疊代次數
目
標
函
數
222
模擬結果顯示，使用本計畫提出之方法計算單調式濾波器的設計
問題時，僅需要基因演算法四十七分之一的時間，且設計結果相近。
比較圖 7. 18 及圖 7. 22，可見匯流排十的七階諧波電壓在使用基因演
算法設計時已滿足諧波管制標準，因為表 7. 34 中，匯流排十的濾波
器電容器容量大於表 7. 33 中匯流排十的濾波器電容器容量。但由於
加裝七階濾波器會放大五階諧波電壓的效果，故圖 7. 21 中，匯流排
十的五階諧波電壓稍微超出諧波管制標準。
綜合上述結果與討論，本計畫提出之方法不論在速度上與模擬結
果上，皆優於基因演算法。
7-7 濾波器投入切離暫態抑制模擬結果
本研究利用 MATLAB SimPowersystem 模擬實際電力系統，系統
說明與參數請參照 7-1-1 節。根據 7-6-1 節的結果顯示，為了滿足諧
波管制標準及功率因數補償，必須在匯流排十上加裝五階及七階的單
調式濾波器。在投入五階及七階單調式濾波器時，為了抑制投入時的
暫態現象，本研究將上述兩種濾波器改接成圖 2. 17 的接線方式，並
計算出最佳的串接電感(L1)值。
本研究使用時擾動隨機近似法與新型不等限制式處理法，計算最
適的濾波器串接電感值。疊代初始值為一組滿足限制條件的隨機值。
表 7. 35 為匯流排十依據表 7. 33 的濾波器容量，同時投入五階及七階
濾波器時的暫態抑制模擬結果。圖 7. 23 及圖 7. 24 為額外串接電感值
的疊代過程，圖 7. 25 為目標函數的疊代過程。
224
圖 7. 24 安裝於匯流排十之七階濾波器的額外串接電感量疊代過程
圖 7. 25 目標函數的疊代過程
226
下，其類神經種類、代表特徵值、儀表數量之選擇。而我們利用與主
要成份分析網路使倒傳遞網路之輸入神經元個數減少。也利用自我組
織映射網路減少輸入網路維度，使每次之收斂時間減少，雖然造成事
件判定結果變差，但其值還是在 90%以上下。所以它可以快速地做運
算以做為及時監控系統參考之用。
本計畫第二部分的研究是應用同時擾動隨機近似法配合新型不
等限制式處理法，並借由 MATLAB SimPowerSystem 軟體，建立最佳
化問題中的函數，快速計算配電系統單調式濾波器及濾波器投入暫態
抑制的最佳化問題。
本研究以十八匯流排系統作為設計範例。模擬結果顯示，在單調
式濾波器的設計問題中，使用本計畫提出方法的計算時間，僅需基因
演算法之計算時間的六十二分之一。
8-2 未來研究方向
1. 選用不同母小波之小波轉換於本辨識系統上。以提升辨識結
果。
2. 將離散小波轉換能量擷取方法與辨識系統接合實現硬體電
路， 實際應用於電容器暫態源位置辨識儀表或系統上。
3. 應用不同電力品質問題之辨識事件，並建立一個知識庫，依
據辨識之結果與數值，提供一套改善之對策，期能做到改善
電力品質問題之改善。
4. 全域最佳解問題
5. 阻尼濾波器設計
6. 不同抑制濾波器投入暫態的方法
228
[8] A. McEachern, “Designing Electronic Devices to Survive 
Power-Quality Events,” IEEE Industry Applications Magazine, Vol. 6,
No. 6, pp. 66-69, Nov.-Dec. 2000.
[9] R.A. Adams, S.W. Middlekauff, E.H. Camm, and J.A. McGee,
“Solving Customer Power Quality Problems Due to Voltage 
Magnification,” IEEE Trans. on Power Delivery, Vol. 13, No. 4, pp. 
1335-1341, Oct. 1998.
[10] P. P. Pericolo and D. Niebur, "Discrimination of Capacitor Transients
for Position Identification," Proceeding of the 2001 IEEE PES Winter
Meeting, Vol. 2, 2001, pp. 872-877.
[11] A. C. Parsons, W. M. Grady, E. J. Powers, and J. C. Soward, "Rules
for Locating the Sources of Capacitor Switching Disturbances,"
Proceedings of the 1999 IEEE PES Summer Meeting, Vol.2 , pp.
794-799.
[12] A. C. Parsons, W. M. Grady, E. J. Powers, and J. C. Soward, "A
Direction Finder for Power Quality Disturbance Based Upon
Disturbance Power and Energy," IEEE Trans. on Power Delivery, Vol.
15, No. 3, July 2000, pp. 1081-1086.
[13]S. Santoso, J. D. Lamoree, and M. F. McGranaghan, "Signature
Analysis to Track Capacitor Switching Performance," Proceedings of
the 2001 IEEE PES Summer Meeting, Vol. 1, pp. 259-263.
[14] J. Kim, W. M. Grady, A. Arapostathis, J. C. Soward, and S. C. Bhatt,
"A Frequency Domain Procedure for Locating Switched Capacitors in
Power Distribution Systems," Proceedings of the 2000 IEEE PES
Summer Meeting, Vol. 2, pp. 945-950.
[15] J. Kim, W. M. Grady, A. Arapostathis, J. C. Soward, and Sid C. Bhatt,
230
[23] F. Mo and W. Kinsner, “Wavelet Modeling of Transient in Power                    
Systems,” 1997 Conference on Communications, Power and
Computing Proceedings; Winnipeg, MB; pp.132-137, May 22-23,
1997.
[24] S. Sannoto, E, J Powers, W. M Grady, and P. Hofmann, “Power 
Quality      Assessment via Wavelet Transform Analysis,” IEEE
Trans. on Power Delivery, Vol. 11, No. 2, pp. 924-930, April 1996.
[25] 陳耀欽 ，「應用演算法與人工智慧進行配電系統諧波源位置之
偵測」，碩士論文，中原大學，民國86年7月。
[26] J. Arrillaga, B.C. Smith, N.R. Waston, and A.R. Wood, Power
System Harmonic Analysis, John Wiley & Sons Ltd., West Sussex,
1995.
[27] H.J. Bollen, Understanding Power Quality Problems: Voltage Sags
and Interruptions, The Institute of Electrical and Electronic
Engineers, Inc., New York, 2000.
[28] A. Greenwood, Electrical Transient in Power Systems, 2nd Edition,
John Wiley & Sons, 1991.
[29] T. J. E. Miller, Reactive Power Control in Electric Systems, John
Wiley & Sons, 1985.
[30] L. Sluis, “Transients in Power Systems,” John Wiley & Sons, Ltd. 
2001.
[31] D. E. Newland, “An Introduction to Random Vibrations, Spectral 
and Wavelet Analysis Longman Scientific & Technical,” England, 
1993.
[32] S. Malat, “A Theory for Multiresolution Signal Decomposition: The 
Wavelet Representation,” IEEE Trans. on Patern Analysis and 
232
[43] L. A. Zadeh, “Fuzzy Set,” Information and Control, Vol. 8, 1965, pp. 
338-353.
[44] J.C.Dunn,“A Fuzzy relative of the ISODATA process and its use in 
detecting compact,”Wel-separated Clustering, J.Cybernet,
pp.32-57,1974
[45] J.C. Bezdek, Pattern Recognition with Fuzzy Objective Function
Algorithms, New York: Plenum Press, 1981.
[46] K. J. Paten, “Evaluating Market Power in Congested Power 
Systems, ”B.S., University of Ilinois at Urbana-Champaign, 1997.
[47] Elham B. Makram, E. V. Subramaniam, Adly A. Girgis, and Ray
Catoe, “Harmonic Filter Design Using Actual Recorded Data,” IEEE 
Transactions on Industry Application, Vol. 29, No. 6, Nov. 1993.
[48] Gary W. Chang, Shou-Yung Chu, and Hung-Lu Wang, “A New 
Method of Passive Harmonic Filter Planning for Controlling Voltage
Distortion in a Power System,” IEEE Transactions on Power 
Delivery, Vol.21, No.1, Jan. 2006.
[49] Ying-Yi Hong, and Wei-Fen Huang, “Interactive Multiobjective 
Passive Filter Planning with Fuzzy Parameters in Distribution
Systems using Genetic Algorithms,” IEEE Transactions on Power 
Delivery, Vol. 18, No. 3, Jul. 2003.
[50] Chih-Ju Chou, Chih-Wen Liu, June-Yown Lee, and Kune-Da Lee,
“Optimal Planning of Large Passive-Harmonic-Filters Set at High
Voltage Level,” IEEE Transactions on Power Systems, Vol. 15, No 1, 
Feb. 2000.
[51] Ying-Pin Chang and Chi-Jui Wu, “Optimal Multiobjective Planning 
of Large-Scale Passive Harmonic Filters using Hybrid Differential
234
Transactions on Power Delivery, Vol. 8, No.3, Jul. 1993.
[61] R. A. Adams, and S. W. Middlekauf, “Solving Customer Power 
Quality Problems due to Voltage Magnification,” IEEE Transactions 
on Power Delivery, Vol. 13, No. 4, Oct. 1998.
[62] T. A. Belei, R. P. O’Leary, and E. H. Camm, “Evaluating 
Capacitor-Switching Devices for Preventing Nuisance Tripping of
Adjustable-Speed Drives due to Voltage Magnification,” IEEE 
Transaction on Power Delivery, Vol. 11, No. 3, Jul. 1996.
[63] Report by Working Group 3.4.17 of the IEEE Surge Protective
Devices Commitee, “Impact of Shunt Capacitor Banks on
Substation Surge Environment and Surge Arrester Applications,” 
IEEE Transactions on Power Delivery, Vol. 11, No. 4, Oct. 1996.
[64] IEEE Std. 519-1992, “IEEE Recommended Practices and 
Requirements for Harmonic Control in Electric Power Systems,” 
New York, 1993.
[65] 卓大鈞, 單調式電力諧波濾波器最佳設計, 私立淡江大學電機
工程學系控制系統組碩士論文, 中華民國八十七年六月.
[66] Y. H. Yan, C. S. Chen, C. S. Moo, and C. T. Hsu, “Harmonic 
Analysis for Industrial Customers,” IEEE Transaction Industry 
Applications, Vol. 30, No. 2, Mar. 1994.
[67] 台電公司, “諧波電壓暫訂標準,” 電業字第 7605～0160 函, 民國
76 年 5 月 4 日.
[68] 江榮城, 楊金石, 顏世雄, 及鄭久男, “配電系統諧波電流量測與
分析,” 中華民國第十二屆電力工程研討會論文集, 民國 80 年，
pp. 114-120.
236
附錄 A NeuroSolutions軟體介紹
本文是使用 NeuroSolutions 來進行解制電業市場中可利用傳輸能
力之估測。圖 A.19 為 NeuroSolution 使用的工作視窗。
圖 A.19 NeuroSolutions 之工作視窗
下面說明常用的物件：
‧Axons(軸索) ：在 NeuroSolutions 中為處理單元。每一個
Axons 元件相當一系列之處理單元。
Synapses(‧ 突觸) ：為連結處理單元與處理單元間之功能，並
且可以設定權重。
238
而下面 A-2-1 節我們將介紹如何利用 NeuroSolutions 來建立類神
網路步驟，A-2-2 節將說明研究之執行過程。
A-2-1 如何建立類神經網路
利用 NeuroSolutions 建立類神經網路，有兩種主要的方法。一種
為 NExpert 方式，另一種為 NBuilder 方式，下面我們將介紹這兩種主
要的方法。
1.NeuralExpert：
步驟一：
圖 A.20 為 NeuralExpert 的開始對話框，它是一種精靈模式，
使用者只要有輸入資料，然後選擇四種型式，分別為分類、函數
逼近、預測及叢集其中一種方法，它就會幫助你自動建立理想的
網路。
圖 A.20 NeuralExpert 開始對話框
NeuralExpert
240
步驟四：
圖 A.23 為欲建立網路的複雜度對話框。
圖 A.23 網路複雜度對話框
圖 A.24 為利用 NeuralExpert 精靈模式建立之網路，可以發現此種
模式是給初學者或不懂類神經架構的使用者使用。
圖 A.24 利用 NeuralExpert 精靈模式建立之網路
開始訓練 丟值
242
步驟二：訓練資料
圖 A.27 為 NeuralBuilder 訓練資料，可以選擇輸入的資料與所
期望的資料，也可以忽略不重要的資料。
圖 A.27 NeuralBuilder 訓練資料
步驟三：交叉確認資料
圖 A.28 為 NeuralBuilder 交叉確認資料，可以讀取檔案或者直
接從輸入資料中選取所需之交叉確認資料。
圖 A.28 NeuralBuilder 交叉確認資料
244
步驟六：模擬控制
圖 A.31 為 NeuralBuilder 模擬控制，可以設定最大訓練次數、
學習參數及均方誤差值。
圖 A.31 NeuralBuilder 模擬控制
步驟七：監測架構
圖 A.32 為 NeuralBuilder 監測架構，可以設定網路中輸入、輸
出、期望、誤差及量測的監測。
圖 A.32 NeuralBuilder 顯示架構
   
1 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                         96  年 7 月 11 日 
報告人姓名  
洪穎怡 
 
服務機構 
及職稱 
 
中原大學電機系教授兼院長 
 
     時間 
會議 
     地點 
96.7.1-5 
瑞士洛桑(Lausanne) 
本會核定 
補助文號 
NSC 95-2221-E-033-081- 
會議 
名稱 
 (中文) 2007 PowerTech 國際會議 
 (英文) International Conference on 2007 IEEE PowerTech 
發表 
論文 
題目 
(中文) 自主型系統之 kW 排程 
(英文) KW Scheduling in an Autonomous System  
 
一、 參加會議之經過 
 
本次會議搭乘班機於 7 月 1 日晚上，由桃園中正國際機場起飛，經約 3 小時 20
分抵曼谷，同日再搭泰航班機於次(2)日清晨抵蘇黎世，立即搭火車於中午到洛桑。 
 
 2 日中午至 Elite Hotel Check in，隨後即至 Swiss Federal Institute of Technology in 
Lausanne (EPFL) 大學辦理報到註冊，隨即參加主題為 Distributed Generation (I)之論
文發表，此節共有 5 篇論文，分別是(1) An Efficient Multi-objective Meta-heuristic 
Method for Distribution Network Expansion Planning (Mori Hiroyuki (Meiji University, 
Japan)), (2) Least-cost model predictive control of residential energy resources when 
applying µCHP (Houwing Michiel (Delft University of Technology, The Netherlands)), (3) 
Three-Phase Controlled-Q Updating Method for Forward/Backward Sweep-Based 
Distribution Systems Power Flow Algorithms (Eminoglu Ulas (Gebze Institute of 
Technology, Turkey)), (4) Multi-criteria Reconfiguration of Distribution Electrical 
Networks for Minimization of Power Losses and Damage Cost due to Power Supply 
Interruption (Tristiu Ion (University POLITEHNICA of Bucharest, Romania)), (5) 
Intelligent Nodes in Distribution Systems - Optimizing Steady State Settings (de Graaff 
Roald (KEMA, The Netherlands))。分散式電源是目前最熱門的研究課題，其中第三篇
有關無效電力控制之主題為本人目前研究之課題，當中亦提供了為多構思。 
 
 
   
3 
Islanding and Cascading Outages (Zaag Nader (Mcgill University, Canada)), (4) Interarea 
Oscillations and Tie-line Transients in the Hellenic Interconnected System (Nomikos 
Vassilis (HTSO, Greece)), (5) The Impact of a Power Plant on the Inter Area Oscillations 
(Kiss Lajos (Budapest University of Technology and Economics, HUNGARY))。系統全黑
是目前台電公司一重要課題，每月的台電內部召開的穩定度與可靠度會議，於今年
七月正要討論低頻卸載之段數、開始頻率、延遲時間與卸載總量，正確的選擇事故
分析亦是在本節之重要研討題目。7 月 4 日下午參加主題為 Distributed Generation (X)
之論文發表，此節共有 5篇論文，分別是(1) Wind Energy Storages – Possibilities (Spahic 
Ervin (Technische Universität Darmstadt, Germany)), (2) Sizing and Optimal Operation of 
Battery Energy Storage System for Peak Shaving Application Oudalov Alexandre (ABB 
Switzerland Ltd, Corporate Research), (3) Reactive Power Generation by DFIG Based 
Wind Farms with AC Grid Connection (Wilch Michael (University Duisburg-Essen, 
Germany)), (4) A Regulatory Framework for Microgeneration and Microgrids (Costa 
Paulo (School of Technology of Viseu, Portugal)), (5) MicroGrid Online Management and 
Balancing Using Multiobjective Optimization (Mohamed Faisal ( Helsinki University of 
Technology, Finland)) 。其中第三篇論文涉及無效電力及電壓控制，吾人對此十分有
興趣。吾人早期即研究輸電系統之無效電力控制，當分散式電源加入時，無論是配
電系統或微型電網自己之無效電力控制就顯得十分重要。第四篇此主題乃有關京都
議定書延伸之分散式電源。由此吾人可知京都議定書帶給世界之影響，台灣雖不為
簽署國，但台灣之傳統工業與火力電廠造成之 CO2 會大大影響地球村。 
 
7 月 5 日早上參加早上參加主題為 Reliability 之論文發表，此節共有 5 篇論文，
分別是(1) A Comprehensive Approach for Bulk Power System Reliability Assessment 
(Yang Fang (Georgia Institute of Technology, USA)), (2) Modelling of Ice Storms and 
their Impact Applied to a Part of the Swedish Transmission Network (Brostrom Elin 
(Royal Institute of Technology, Sweden)), (3) Forced Outage Cause Identification Based 
on Bayesian Networks (Tronchoni Alex (Pontifical Catholic University of Rio Grande do 
Sul, Brazil)), (4) Model for Quantifying the Effect of Circuit Breaker Maintenance Using 
Condition-Based Data (Natti Satish (Texas A&M Unviersity, USA)), (5) An 
Activity-based Interruption Cost Model for Households to be Used in Cost-Benefit 
Analysis (Alvehag Karin (Royal Institute of Technology, Sweden))。本人今年度申請了
一個國科會兩年期的一般型專題計畫，主題是有關電力系統可靠度計算，本節中幾
個問題之研討相當有助於計畫之研發。 
 
二、與會心得 
 
    本次會議共有約 450 篇論文，吸引全球約 550 位學者專家前來。此次台灣前往
該會議的人士計 5 名。 
Paper ID: No. 26
1
KW Scheduling in an Autonomous System
Ying-Yi Hong, Senior Member, IEEE Ching-Sheng Chiu Chang-Ting Li
Abstract- The distributed generations have several advantages
such as reducing the required transmission capacity, real power
loss, and the traditional generation expansion, etc. An
autonomous system is an independent system that may include
diesel generators, wind park, solar photovoltaic (PV) module
and/or batteries, etc. This paper presents a new method for
dealing with the short-term kW scheduling of an autonomous
system. The fuel cost of diesel units is minimized and all
operation constrains are satisfied. The genetic algorithm is used
to solve this problem. The penalty function and encoded
independent variables are discussed. Simulation results based on
an autonomous system show the applicability of the proposed
method.
Index terms: autonomous system, distributed generation,
generation scheduling, genetic algorithms.
I. INTRODUCTION
istributed generations (DG) have been received
attention as alternatives for the electricity generation
recently. The advantages of DG include reductions of
the required transmission capacity, real power loss and the
conventional generator expansion, etc. The DG system
generally consists of the following: (i) small and modular
generating systems (e.g., microturbines, fuel cells and
cogeneration) that use diversified fuels; (ii) renewable energy
resources (such as solar, wind, geothermal, biomass, tidal, and
hydropower).
Although DG has some advantages for the power system,
DG still has several problems: (i) impact upon the power
system, e.g., protective coordination and power quality, (ii)
technologies for improving the DG efficiencies and (iii)
efficient operation in the DG system. This paper stresses the
third problem, especially the short-term kW scheduling in an
autonomous system. An autonomous system is an independent
system that may include diesel generators, wind farm,
photovoltaic (PV) array and/or batteries, etc. In this system, the
power converters as well as battery charge/discharge should be
considered.
-----------------------------------------------------------------------
This work is sponsored by National Science Council under Grant
95-2623-7-033-005-ET
Hong Y.Y. is with Department of Electrical Engineering, Chung Yuan
University, Chung Li 320, Taiwan. Email: yyhong@dec.ee.cycu.edu.tw
Chiu C.S. is a Ph.D. graduate student in the Department of Electrical
Engineering, Chung Yuan University, Chung Li 320, Taiwan. Email:
g9278025@cycu.edu.tw
Li C.T. was graduated from the graduate school of Electrical Engineering,
Chung Yuan University, Chung Li 320, Taiwan in 2005
Only a limited number of papers concerning the
short-term generation scheduling of distributed/renewable
resources was published. An approach based on dynamic
programming to determine the minimum of the diesel fuel
consumption in an autonomous system is presented in [1].
Wind, solar PV module and batteries were considered as
control variables in [1]. A method covering a priority list
incorporated with a probability distribution model for wind to
deal with the kW scheduling of the wind/diesel autonomous
system is proposed in [2]. The short-term generation
scheduling problem consisting of constraints of battery
capacity, minimum up/down time and ramp rates for thermal
units, as well as solar PV capacity, was solved by the
augmented Lagrangian relaxation in [3]. An hourly-discretized
optimization algorithm was proposed to identify the optimum
daily operational strategy for the wind turbines and the hydro-
generation pumping equipments in [4]. The stochastic
characteristics of the wind power are also exploited [4]. A
Lagrangian relaxation-based method for solving short-term
scheduling of batteries in a grid-connected solar PV/battery
system is presented in [5]. The hourly charge/discharge
commitment of batteries in a utility grid is determined [5].
On the other hand, Genetic Algorithms (GAs) can be
employed to obtain an optimal solution while dealing with the
inequality constraints efficiently [6]. Furthermore, GA can
easily deal with non-differentiable functions. Genetic
Algorithms have been used in many applications in the area of
power engineering, e.g., [7]~[13]. GA was applied to treat the
economic dispatch for cogeneration systems involving multiple
bilateral contracts in the deregulated market [7]. GA was also
used to solve a multi-objective passive filter planning problem
for reducing harmonics [8]. Transformer capacities in an
industrial factory with intermittent loads were determined by
binary-encoded GA in [9]. The network reconfiguration
considering multi-objective (voltage drop and loss) in the
distribution system is determined by Pufer-encoded GA. Other
applications of GA include direct load control [11], reactive
power compensation [12], and network reconfiguration [13].
These papers [7]~[13] show that GA is able to solve the
optimization problem with proper treatments of encoding and
inequality constraints.
This paper addresses the short-term (24 hours ahead) kW
scheduling in an autonomous system, including diesel
generators, wind farm, PV array, and batteries. The problem is
formulated by a nonlinear programming problem using
D
Paper ID: No. 26
3
be equal to the single kW generation multiplied by the WTG
unit number. In this paper, the fuel costs of the diesel units will
be minimized. When the system load is small, the wind power
may not be fully used even though the wind velocity is
sufficiently large. Under this condition, the wind power
generation may be reduced by pitch/yaw/variable-speed
control or even stall control. Hence, Eq. (3) is considered.
Similarly, the total solar PV kW generation will be
smaller than its available maximum kW limit. SS PP ˆand
signify the (unknown) PV kW generation and the (known)
available maximum kW generation subject to the solar
radiation and temperature in (4).
The batteries are connected to the solar PV module
through a DC/DC chopper and to the power system grid
through a DC/AC inverter and transformer. The energy storage
VB (kWh) in the battery should be subjected to its limits as (5).
The symbols BV and BV are the minimum and maximum
limits of the energy stored at the batteries.
The energy balance in the battery during hour j is
considered in (6) and (7). The symbol B (e.g., 75%) is the
efficiency during the charging period. BP is the energy output
(positive for discharging and negative for charging).
Practically, the dispatcher in an autonomous system hopes
that the battery storage would have expected values in the
beginning and at the end of a day as shown in (8) and (9).
The solar PV modules and batteries are connected to a
step-up transformer via an inverter. Equations (10) and (11)
are hence obtained. The symbol I is the efficiency (e.g.,
95%) of the inverter. The symbol SBP denotes the inverter
output (kW).
The superscore and underscore in (12) denote the
maximum and minimum limits, respectively. The symbols
STP and iDP represent the known rating of the inverter and
kW variation of the i-th diesel generator between two
consecutive hours j and (j-1). Equation (13) denotes the
ramping rate limit for a diesel generator. Equation (14) means
that the total generation from diesel generators should not be
greater than the system demand; otherwise, the kW generation
from diesel generators will charge the battery banks. The
generation from the hybrid solar-battery module should not be
greater than the inverter rating, defined in (15).
The above formulation can be solved through
Lagrangian as follows:
Min      
  




 
J
j
ND
i
LSBWDiDi jPjPjPjPjjPF
1 1
 (17)
and subject to (3)~(15). The symbol )( j is the Lagrange
multiplier at hour j.
III. THE PROPOSED METHOD
The problem described above becomes very complicated
because the constraints become coupled due to the battery
charging/discharging (see (6) and (7)) and the generator
ramping rate, i.e., (13). The above formulation can be solved
by any nonlinear programming. An efficient algorithm of
robust capability in treating inequality constraint and of
approaching to global optimum is hence required to solve the
above problem. GA is used in this paper because GA fullfils
these two criteria [6].
A. Background of Genetic Algorithms (GAs)
The encoded binary strings are used for the
independent variable representation. The length of the string
depends on the precision required. A new fitness function will
be given for evaluating the performance of the strings. In this
paper, the Lagrangian plus the penalty functions (which will be
defined below) is defined as the fitness function.
The GA is achieved by 3 operations: selection, crossover
and mutation. The string that is fitter will have a better chance
to be selected to the next iteration with a pre-specified
population size. The randomized couple of strings (individuals
in the mating pool) are selected to achieve crossover after
selection. The selection is achieved by “roulette wheel.”
Mutation provides an opportunity to create new chromosomes
and avoids normal evolution for only considering reproduction
and crossover. Detailed information related to GA can be
found in [6].
B. Penalty Functions
The solution space is decomposed into feasible and
infeasible regions. In this paper, the penalty functions are
considered in GA to enforce the corresponding violated
constraints from the infeasible region into the feasible region.
The GA tends to maximize a fitness function. In this paper
the fitness is defined as the negative Lagrangian minus penalty
functions.
For example, the penalty function for )( jVB with
respect to BV in Eq. (5) is given:
Paper ID: No. 26
5
TABLE II 24-HOUR DEMAND, MAXIMUM AVAILABLE PV AND WIND POWER
Hr
System
demand
（kW）
Max. PV
（kW）
Max.
wind
power
（kW）
Hr.
System
demand
（kW）
Max. PV
（kW）
Max.
wind
power
（kW）
1 351.0 0.0 1.08 13 422.0 88.20 37.44
2 290.0 0.0 0.96 14 358.0 81.84 29.04
3 262.0 0.0 22.44 15 302.0 71.40 32.04
4 249.0 0.0 22.80 16 258.0 55.68 36.36
5 240.0 0.0 24.84 17 245.0 37.80 36.24
6 244.0 0.0 27.60 18 290.0 18.84 27.60
7 241.0 9.48 45.72 19 325.0 0.0 19.44
8 237.0 36.72 49.20 20 356.0 0.0 15.0
9 295.0 57.72 47.40 21 443.0 0.0 11.16
10 347.0 72.48 46.80 22 560.0 0.0 1.80
11 407.0 84.0 45.24 23 526.0 0.0 0.12
12 467.0 88.2 39.36 24 445.0 0.0 0.12
B. Optimal Scheduling and Evolution Performance
The priority list is used to determine the status (on/off) of
each diesel generator [14] for these 24 hours first. Table III
shows the result for the priority list for each generator i, i=1,
2,…, 8 and for each hour j, j=1, 2, .., 24. As shown in Table III,
zero and one denote off and on of the diesel units, respectively.
Table IV illustrates the total kW (kWh) generations (storage)
for the different resources. It was found that the batteries were
charged (negative values) at hours 4, 6, 7, 8, 9, 10, 13-16 and
17. Finally, the fuel cost converges to 27885.1 $/h. It took 10
min CPU time and 621 iterations (generations).
The same system was also studied using Sequential
Quadratic Programming (SQP) provided by MATLAB
optimization tool box and the simulation result is illustrated in
Table V. The fuel cost converges to 27903.7 $/h. It is found
that GA is capable of searching a better optimum then SQP.
V. CONCLUSIONS
A new method using genetic algorithm is proposed for
solving the short-term real power scheduling in an autonomous
system. The fuel costs of the diesel generators are minimized
while the operation constraints including equality and
inequality constraints are fulfilled. The Lagrange multiplier
and battery storage are considered as independent variables for
reducing the total bit length of a string in the mating pool. The
total bit length is independent of the diesel generator number.
A sample system including diesel generators, wind farm,
solar PV module, battery bank and inverter, is used for
simulation. A comparative result based on SQP is also given.
The simulation results show that GA is capable of attaining a
better optimal solution than SQP.
TABLE III RESULTS FOR THE PRIORITY LIST
j=1 j=2 j=3 j=4 j=5 j=6 j=7 j=8 j=9 j=10 j=11 j=12
i=1 0 0 0 0 0 0 0 0 0 0 0 0
i=2 0 0 0 0 0 0 0 0 0 0 0 0
i=3 0 0 0 0 0 0 0 0 0 0 0 0
i=4 0 0 0 0 0 0 0 0 0 0 0 0
i=5 1 0 0 0 0 0 0 0 0 0 1 1
i=6 1 1 1 1 1 1 1 1 1 1 1 1
i=7 1 1 1 1 1 1 1 1 1 1 1 1
i=8 1 1 1 1 1 1 1 1 1 1 1 1
j=13 j=14 j=15 j=16 j=17 j=18 j=19 j=20 j=21 j=22 j=23 j=24
i=1 0 0 0 0 0 0 0 0 0 0 0 0
i=2 0 0 0 0 0 0 0 0 0 1 0 0
i=3 0 0 0 0 0 0 0 0 0 1 1 0
i=4 0 0 0 0 0 0 0 0 1 1 1 1
i=5 1 1 1 0 0 0 1 1 1 1 1 1
i=6 1 1 1 1 1 1 1 1 1 1 1 1
i=7 1 1 1 1 1 1 1 1 1 1 1 1
i=8 1 1 1 1 1 1 1 1 1 1 1 1
TABLE IV TOTAL KW (KWH) GENERATIONS (STORAGE) OBTAINED GA FOR
DIFFERENT RESOURCES.
Real Power
j
PD（kW） PW
（kW）
PS
（kW）
PB（kW） VB
（kWh）
1 338.68 1.07 0.00 8.07 391.93
2 261.52 0.90 0.00 30.89 361.04
3 234.88 20.86 0.00 2.07 358.97
4 232.91 20.46 0.00 -8.52 365.36
5 209.63 23.85 0.00 2.37 362.99
6 216.53 27.38 0.00 -4.01 366.00
7 190.68 42.63 9.30 -1.29 366.97
8 186.03 48.88 35.17 -33.60 392.17
9 200.52 47.29 53.83 -2.16 393.79
10 234.00 46.63 71.99 -4.16 396.91
11 285.05 40.72 81.71 7.03 389.88
12 343.02 39.04 87.80 1.59 388.29
13 306.65 35.38 87.48 -4.38 391.57
14 266.27 28.80 81.18 -15.57 403.25
15 243.56 30.95 71.20 -47.00 438.50
16 194.53 36.23 55.63 -30.75 461.56
17 202.89 35.87 37.34 -27.19 481.95
18 240.34 25.80 17.98 2.50 479.45
19 294.21 19.41 0.00 6.98 472.47
20 333.72 14.90 0.00 2.92 469.55
21 415.50 11.10 0.00 10.61 458.94
22 530.17 1.79 0.00 31.10 427.84
23 495.96 0.12 0.00 28.65 399.19
24 424.16 0.12 0.00 16.14 383.05
