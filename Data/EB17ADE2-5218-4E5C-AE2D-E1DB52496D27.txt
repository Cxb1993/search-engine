 1
一、中文摘要 
本計畫利用自然流量資料建立以類神經網路推估河川流量矩陣，並將流量矩陣與魚類
生態矩陣結合，做為生態水資源管理中以保育用水總量管制下之流態管理方式。本計畫第
一年以生態河川流態推估為主要工作內容，重點在將已完成的臺灣生態水文分區中建立以
類神經網路方式推估河川流量矩陣之模式，此一模式將原有流量矩陣迴歸模式中，僅推估
各水文指標所有資料年平均之單一數值之方式，拓展成為各年推估值以做為在運用中等程
度擾動說時的擾動分布特性。第二年則將蒐集現有的魚類等採樣之歷史資料，利用魚類資
料及河川水質資料結合結構方程式分析方式，建立河川生物所需棲息地與河川流量矩陣間
的關係，以做為流量管理時對河川生態系統的考量依據。第三年則將結合前二年的成果，
以年保育用水的總量需求考量，取代以往以日最小流量之生態基流量管理方式，達到流態
管理的生態水資源管理模式。 
 
中文關鍵詞：魚類群落；生態水文指標；河川流態；結構方程式；流態管理方式 
 
 
 
二、英文摘要 
This three-year project uses natural flow regime information to predict the flow matrix by 
using artificial neural network.  It also integrates the fish community information, water quality, 
and streamflow matrix to develop fish community-base ecohydrological and water quality 
indicators by structural equation model.  Finally, those techniques use a regime-based approach 
coupled with total volume idea for ecological water resources management. 
In the first year, the major objective of this research is to estimate streamflow regime matrix 
for ecological water resources management.  For each hydrologic indicator of the flow regime, 
the annual value of the indicator is estimated by artificial neural networks.  The results could 
provide a distribution type of records instead of just a single value.  In the second year, the 
major objective of this research is to construct a useful and practicable tool based on some 
“quantitative ecohydrological indicators” for ecological water resources management.  A further 
extension of this analysis assists in developing management strategies where the volume, 
frequency and timing of flows can be provided that more closely meet the habitat and ecological 
needs of an identified fish community.  In the third year, the major objective of this research is 
to apply regime-based approach coupled with total volume idea for ecological water resources 
management.  The protected and nurtured flow has implied to reserve an annual volume of 
water for river ecosystems.  This research analyzes different flow regime scenarios coupled with 
several annual volume types for ecological water resources management. 
 
英文關鍵詞：Fish Community; Ecohydrological Indicators; Flow Regime; Structural Equation 
Model; Regime-Based Approach 
 
 
 3
not only important for water resources planning and management issues, but is increasingly 
germane to ecological studies across a wide range of spatial and temporal scales (Sanborn and 
Bledsoe, 2006).  Streamflow regime includes the magnitude, timing, duration, frequency, and 
the rate of change and is increasingly cited as a ‘master variable’ that structures aquatic 
ecosystems and habitats (Poff and Ward, 1989; Richter et al., 1996; Poff et al., 1997; Suen, 2005; 
Suen and Herricks, 2009).  Because most biomonitoring sites are usually ungauged and there is 
highly uncertainty regarding which hydrologic characteristics explain the observed biological 
variation, there is a burgeoning interest in the prediction of ecologically relevant hydrologic 
metrics for these sites. 
In order to get the ecological flow regimes at the station located just upstream from the 
research reach location, reference flow concept suggests that one option is to use an observed 
flow record from a nearby location (Hughes and Smakhtin 1996; Hughes et al. 1997).  The 
literature is replete with studies focused on predicting selected streamflow attributes for ungauged 
streams (e.g. Vogel et al., 1999; Chiang et al., 2002).  The typical approach to streamflow 
prediction in ungauged basins across large regions is to delineate geographic areas of similar 
streamflow pattern, use regression to relate watershed characteristics to streamflow variables, and 
assess model reliability (e.g. Jennings et al., 1994).  The identification of distinct streamflow 
regime types at ungauged sites is critical for stratifying key processes and developing robust 
predictive models for each flow regime type.  Selecting geographically contiguous regions of 
flow regime types from previously delineated regions (e.g. Vogel et al., 1999) or examining 
residuals of regression Equations (Jennings et al., 1994; Tucci et al., 1995) facilitates 
stratification of ungauged streams.  Cluster analysis can be used to objectively define 
geographically independent streamflow groups across regions (Hawley and McCuen, 1982; 
Haines et al., 1988; Burn, 1989; Hughes and James, 1989; Poff and Ward, 1989; Burn and 
Boorman, 1993; Kresch, 1993; Poff, 1996; Harris et al., 2000) and has been coupled with 
discriminant analysis to identify streamflow cluster membership of ungauged streams using 
catchment characteristics (Chiang et al., 2002).  Regression has been used within defined 
regions or strata to predict the mean and variance of flows, autocorrelation, flood durations and 
volumes (Thomas and Benson, 1970), parameters of statistical distributions to reproduce flow 
duration curves (e.g. Smakhtin et al., 1997; Fennessey and Vogel, 1990; Sugiyama et al., 2003), 
direct estimates of flood quantiles (Thomas and Benson, 1970; Surian and Andrews, 1999; Pitlick, 
1994; Jennings et al., 1994), low flows (Ries and Friesz, 2000), and parameters of time series 
models to generate synthetic streamflows (Chiang et al., 2002).  
A recent development that builds on ecohydrological research and analysis is the 
implementation of management programs that add ecological objectives to the existing public 
safety and water supply objectives of water resources management.  One of the earliest 
applications was in the protection of instream flows.  It was recognized that extraction of water 
for irrigation, industrial, or other off stream use competes with in channel flow needs to sustain 
ecosystems.  The primary focus of the instream flow needs analysis was setting a minimum 
target flow (Bovee, 1996; Milhous et al., 1989).  Although minimum flow targets were 
important, it was recognized that minimum flow maintenance failed to address other critical flow 
needs of a natural or ecological flow regime (Poff et al., 1997).  To address this problem 
improved methods of hydrological analysis were developed that emphasized hydrological 
indicators for a full range of flows.  Hydrological indicators have been widely used to describe 
flow regimes for river restoration and water resources management (Clausen and Biggs, 2000; 
Hughes and James, 1989; Poff, 1996; Richter et al., 1996 & 1997).  These indicators are 
intended to capture aspects of magnitude, frequency, duration, rate of change, and timing of flow, 
which play important roles in sustaining ecological integrity of flowing water systems (Poff et al., 
1997).  Olden and Poff (2003) reviewed 171 currently available hydrological indicators and 
provided a statistically-based framework used in selecting non-redundant hydrological indices for 
 5
variability that is expected to promote natural stream biota.   
In Taiwan, due to the uneven distribution of water resources both in the temporal and spatial 
domains, droughts and floods occur frequently every year.  Reservoirs play a very important role 
to keep water from the wet season for use during the dry season.  Most of the reservoirs in 
Taiwan are operated by rule curves.  These rule curves are usually established at the planning 
stage and provide long-term operation guidelines for reservoir managers to meet planned water 
demand.  The rule curves are applied based on actual storage and can hardly account for 
hydrological variabilities.  But due to their simplicity, reservoir managers still prefer to use rule 
curves to operate reservoirs (Huang and Yang 1999; Tu et al. 2003).  The target storage curves 
define the release within each year as a function of the existing storage level and overall release 
target amounts.  Reservoir managers operate reservoirs to achieve the target storage while 
meeting downstream water needs.  Most of the target storage approaches in Taiwan are still in 
the research stage and reservoir managers are usually reluctant to take any risk to adopt these 
approaches (Kuo et al. 2003). 
 
（四） 研究方法 
This research, “Regime-based approach for ecological water resources management”, is 
proposed as a three year project.  Figure 4.1 shows the framework of this project. 
 
Gauge station
Natural streamflow 
data
Genetic 
programming 
to find critical 
hydrologic 
indicators 
Natural flow regime 
characteristics
Natural flow regime 
classifications
Climatic and 
physiographic data
Ecohydrological 
regions
Artificial neural 
networks models 
ANNs-(I) & (II)
Annual values for 
flow matrix of 
ecological flow 
regime
Dominated 
environmental 
factors
Fish autecology 
matrix analysis 
Ecological flow 
regime matrix
Climatic and 
physiographic region 
classifications
Fish sampling location
Fish community 
data
Climatic and 
physiographic data
Ecohydrological 
regions
Review method to find 
critical hydrologic 
indicators 
Hydrologic indicators related  
to fish community and their 
habitat requirements
Streamflow data
Flow matrix 
calculation
Principal 
component 
analysis to  
find critical 
hydrologic 
indicators
Study area 
information
Ecosystem needs 
objectives
Human needs 
objectives
Non-dominated sorting 
genetic algorithm
Trade-off between water 
shortage and the protected 
and nurtured flow
First Year Second Year
Third Year
 
 7
output values and the target values.  This process is referred to as training or learning.  It stops 
when the errors are minimized or another stopping criterion is met. 
Radial basis function neural networks (RBFNN) 
At approximately the same time, Powell (1987) and Broomhead and Lowe (1988) developed 
radial basis function neural networks.  Such a network also consists of an input layer, a single 
hidden layer, and an output layer.  The number of input and output nodes is, like the BPNN, 
determined by the nature of the actual input and output variables.  The number of hidden nodes, 
however, is not determined by trial and error; instead, the fuzzy min-max clustering algorithm 
(Simpson 1993) is used to decide the number of hidden nodes.  The output of the RBFNN is 
calculated according to 
  )( CXWY                                                   (4-2) 
where X is the input value, Y is the output value, ( ) is the radial basis function, the W’s are 
the weights connecting the hidden and output nodes, and C represents the center of each hidden 
node, which depends on the observed input data and is an outcome of the clustering algorithm.  
CX   is the Euclidian distance between the input and hidden nodes. 
Each hidden node represents a group of input nodes that have similar information from input 
data.  The data process from the input layer to the hidden layer follows a clustering procedure, 
which prescribes the same activation function for input data values that are similar (although the 
input to the hidden layer is still a function of input-layer data values).  The transformation 
associated with each node of the hidden layer is a Gaussian function.  The output layer is a 
linear combination of the nonlinear radial basis functions. 
 
4.2 Indicators of Hydrologic Alterations (IHA) 
Changes in flow management can affect the timing, magnitude, duration, and frequency of 
flows.  The Index of Hydrologic Alteration developed by Richter et al. (1996) is used to quantify 
these potential impacts and applied it to each gauge streamflow records in this research.  This 
model uses mean daily discharges and calculates 32 indices that describe the hydrologic regime 
for that station (Table 4.1).  The thirty-two indices generated by IHA consist of five major 
categories : (1) magnitude; (2) magnitude and duration of annual extreme conditions; (3) timing 
of annual extreme conditions; (4) frequency and duration of high and low pulses; and (5) rate and 
frequency of changes in conditions.  In essence, the model evaluates changes in both minima 
and maxima, and also synthesizes and groups these two extremes over several temporal scales 
(1-day, 3-day, 7-day, 30-day, and 90-day).  The method does not characterize the storm 
hydrograph per se, but instead calculates the hydrograph rise and fall based on the mean daily 
discharges, and determines the number of rises and falls for a given year.   
The IHA expresses hydrologic variability within the year by calculating the number of times 
the sequence of daily discharges changes from a rising hydrograph to a falling hydrograph, and 
vice versa.  These reversals can occur on daily, weekly, or seasonal scales and depend upon 
broad hydro-climatological conditions reflecting regional flood producing mechanisms and basin 
characteristics.  The model also expresses the duration of high and low events and determines, 
for a given year, the number of times (i.e. “pulses”) that the 75th percentile is exceeded and the 
number of times that the 25th percentile is not attained.  It also characterizes the length of the 
pulses exceeding the representative quartiles. 
 
 9
Sn
ASR                                                           (4-3) 
where  
S : fish community (sampling results) data matrix, ]   [ 321 nj SSSSSS   
A : fish autecology matrix 
Sn : total species number of the fish community (sampling results) data S 
R : environmental requirement matrix for fish community S, ]   [ 321 mi RRRRRR   
Each value (R i) in the environmental requirement matrix R represents the percentage of the 
fish species in the sampling community S having the feature described by the environmental 
factor Ei.   
 
Table 4.2  The fish autecology matrix (A) with n species  m environmental factors╳  
  Environmental factor E 
  mi EEEEEE 4321
Fi
sh
 sp
ec
ie
s F
 
n
j
F
F
F
F
F


3
2
1
 














nmninnnn
jmjijjjj
mi
mi
mi
AAAAAA
AAAAAA
AA
AA
AA







4321
4321
33
22
11
010
100
1101
 
 
4.4 Genetic programming (GP) 
Genetic programming can identify relationships that may not be obvious from other 
analytical techniques and it has been demonstrated as an efficient technique to construct a 
relationship function with sereval independent variables.  The nature of GP allows the user to 
add additional information on how a system performs by providing insight into the relationship 
between system input and output data (Savic et al., 1999).  Following the rules of natural 
selection, GP is a symbolic learning technique that determines the best format and coefficients of 
the regression function.  The format of the function is determined by selecting a given set of 
arithmetic and mathematical operators, such as “+”, “-“, “x”, “/”, “sin”, “cos”, “exp”, and “log”, 
etc. Moreover, Boolean operators (AND, OR, NOT), logical expressions (IF-THEN- ELSE), 
iterative functions (DO-UNTIL), or any other user-defined procedures can also be coded into the 
GP structure. 
The GP encodes a function as a tree composed of nodes and branches, and then optimizes 
functions based on natural selection principles.  The procedure of GP is similar to that of genetic 
algorithms (GA), which generate solutions based on parent population and improve solutions by 
the processes of selection, crossover, and mutation (Holland, 1975). Following Koza (1992), the 
general procedure and major components of GP are illustrated in Figure 4.3.  After the initial 
parent population (P) has been generated, the program evaluates the fitness of all alternatives.  
Then two parent alternatives are selected for reproduction according to their fitness.  Those with 
higher fitness are given greater probabilities to mate.  Crossover and mutation are two major 
procedures to produce offspring; the program continues these two procedures until the 
predetermined size of population is reached.  Then the offspring population is treated as a new 
generation for another computation iteration until a stop criterion (e.g., the number of generations 
equals to the prescribed maximum) is met. 
 11
 
Figure 4.4  The illustration of intermediate disturbance hypothesis concept (from Connell 1978) 
 
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
Low flow events (1/year)
0
1
2
3
4
5
6
7
8
Fr
eq
ue
nc
y 
(y
ea
r)
 
Figure 4.5  Low flow event frequency of a natural flow regime situation 
 
By using data on historical flow that represents a system has been less disturbed by human 
influence, the intermediate ranges of hydrologic variations can be used as the most ideal 
management target.  The degrees of the ideal levels are reduced if the hydrologic variations are 
too high or too low.  Fuzzy set theory can be applied to represent the degree of satisfaction 
(Zimmermann 1991).  The ecohydrological indicators are fuzzified as a fuzzy number shown in 
Figure 4.6.  The membership values of the intermediate ranges of ecohydrological indicators are 
close to 1, and the lower or higher hydrologic variations are transferred to lower membership 
values. 
 
Hydrologic indicators
M
em
be
rs
hi
p 1.0
 
Figure 4.6  Using a fuzzy membership function to represent the IDH concept applied to 
ecological flow regimes 
 
There is a conceptual framework for fish communities in small warmwater streams 
 13
Encodingi
Generate the init. 
population
r t  t  i it. 
l ti
Compute the 
fitness of each 
individual in the 
population
t  t  
fit  f  
i i i l i  t  
l ti Produce the new 
population by the 
three operators
-- selection, 
crossover and 
mutation --
r  t   
l ti   t  
t r  r t r
-- l ti , 
r r  
t ti  --
Replace the old 
population by the 
new population  
l  t  l  
l ti   t  
 l ti   
Keep the best 
solutions by the 
elitist policy
 t  t 
l ti   t  
liti t li
Converge?r
YES
NO
End  
Figure 4.8  NSGA II procedure 
 
4.7 Structural equation modeling 
The structural equation modeling is a comprehensive statistical approach to testing 
hypotheses about relations among observed and latent variables.  It is a general methodology for 
specifying, estimating, fitting, and evaluating models of relationships among variables.  Figure 
4.9 shows the relationships between the observed and latent variables.  The path coefficients are 
very important and could show how strong the relationships between the observed and latent 
variables.  Figure 4.10 shows the basic structure of the structural equation model.  In a 
structural equation model, the latent variables of the measurement models could show the 
cause-effect relationship and the arrow means the effect.  Figure 4.11 shows the procedure of 
using the structural equation model in ecohydrological indicators development. 
 
 V1 
V2 
F 
E1 
E2 
1 
2 Latent variables
Observed variables
Observed 
errors
Path coefficient
 
Figure 4.9  The relationships between observed and latent variables in the structural equation 
model 
 
V1
V2
V3
F1
E1
E2
E3
V4
V5
V6
F2
E4
E5
E6
D
Measurement model 1 Measurement model 2 
Structure model
 
Figure 4.10  The basic structure of the structural equation model 
 15
extreme low flow timing, and extreme low flow magnitude.  The ecosystem objective (C4) in 
this research is to maximize the possibility that fits the high and low thresholds of range of 
variation approach (Richter et al. 1997). 
In order to reduce the inconvenience of long duration of water supply deficit, consecutive 
water supply deficit is also considered for developing reservoir operation strategies.  Another 
human needs objective (C3) in this research is to minimize the number of consecutive water 
supply deficit periods. 
In the multi-objective reservoir operation model, all of the objectives are combined into one 
objective for calculation.  The combined can be written as: 
 
 1 1 2 2 3 3 4 4max       w C w C w C w C          (4-4) 
where 
36
1
1 1
11 max 0,
36  
         
N
i i
j i i
D RC
N D
 
2 12
1 1
1
 

N t t
j t
C
Wqd n
 
3 36
1 1
1
 

N i i
j i
C
Dd n
 
4
1
/ 0.511
0.5
X
k
k
E NC
X 
    
Constraints: 
Si = Si-1 + Ii - Ri  
Si － Si-1 < 20 
Si-1 － Si < 50 
0.9S0 < S36 <1.1S0 
0 < Si < Smax 
If Si-1 < Rule3i-1 then 
0.5
0.8
  
  
i i
i i
Rag Dag
Rpub Dpub
 
 
If  Si-1   Rule3i-1 & Ri > Di  then  
  
  
  
i i
i i
i i i i
Rs Ds
Rt Dt
Ru R Rs Rt
    
 
If  Si-1   Rule3i-1 & Ri   Di then  
  
  
  
  
i i
i i
i i
i i
Rs Ds
Rt Dt
Ru Du
R D
   
 
Si > Rule2i  ,  i = 1~12, 31~36 
Rule1i < Si < Rule3i  ,  i = 13~30 
Di = Dagi + Dpubi = Dsi + Dti + Dui 
If Ri > Di then Ri = Ragi + Rpubi + Rspill = Rsi + Rti + Rui 
If Ri   Di then Ri = Ragi + Rpubi = Rsi + Rti + Rui 
 
In order to assess the water supply deficit condition, a generalized storage index (GSI) (Hsu, 
 17
If  Dci > Dui  then  Ri = Dsi + Dti + Dci + Rsill        (4-6) 
where 
Dci: the protected and nurtured flow at the ith ten-day period 
Ri: release of the reservoir at the ith ten-day period 
Dsi: water demand of ShiMen Irrigation Canal at the ith ten-day period 
Dti: water demand of Taoyuan Irrigation Canal at the ith ten-day period 
Dui: water demand of Yuan-Shan Weir at the ith ten-day period 
Rspill: reservoir overflow 
 
In this research, three protected and nurtured flow (dry-wet periods, seasonal, and monthly) 
scenarios are considered.  By applying equation 4.6, the protected and nurtured flow of three 
scenarios can be estimated.  Figure 4.13 shows the comparison of water demand between the 
three protected and nurtured flow scenarios and Yuan-Shan Weir.  The protected and nurtured 
flow needs to provide more water for the downstream channel.  Figure 4.14 shows the increased 
water supply load % after considering the protected and nurtured flow for the three scenarios.  
Although more water should benefit to downstream ecosystem, the increased water supply may 
cause more water deficits in ShiMen Reservoir operation. 
 
Ten-day period
W
at
er
 d
em
an
d 
(m
ill
io
n 
cu
bi
c 
m
et
er
)
Protected and nurtured flow
Ecological base flow
 
Figure 4.12  The comparison between the protected and nurtured flow and ecological base flow 
 
 19
36
1
1 1
11 max 0,
36  
         
N
i i
j i i
D RC
N D
 
2 12
1 1
1
 

N t t
j t
C
Wqd n
  If  
12
1 1
0
 
 N t t
j t
Wqd n   then  C2 = 1.1 
3 36
1 1
1
 

N i i
j i
C
Dd n
  If  
36
1 1
0
 
 N i i
j i
Dd n   then  C3 = 1.1 
4
1
/ 0.511
0.5
X
k
k
E NC
X 
    
subject to 
Si = Si-1 + Ii - Ri 
Si － Si-1 < 20 
Si-1 － Si < 50 
0.9S0 < S36 <1.1S0 
0 < Si < Smax 
If Si-1 < Rule3i-1 then 
0.5
0.8
  
  
i i
i i
Rag Dag
Rpub Dpub
 
 
If  Si-1   Rule3i-1 & Ri > Di  then  
  
  
  
i i
i i
i i i i
Rs Ds
Rt Dt
Ru R Rs Rt
    
 
If  Si-1   Rule3i-1 & Ri   Di then  
  
  
  
  
i i
i i
i i
i i
Rs Ds
Rt Dt
Ru Du
R D
   
 
Di = Dagi + Dpubi = Dsi + Dti + Dui 
If Ri > Di then Ri = Ragi + Rpubi + Rspill = Rsi + Rti + Rui 
If Ri   Di then Ri = Ragi + Rpubi = Rsi + Rti + Rui 
 
 
 21
 
(a) Region 1: 13 stations  (b) Region 1: 13 stations  (c) Region 1: 13 stations 
Figure 5.1  Three ecohydrological regions 
 
0.00
0.02
0.04
0.06
0.08
0.10
0.12
Region 1 Region 2 Region 3
Region 1 0.0283 0.0292 0.0307 0.0381 0.0691 
Region 2 0.0453 0.0477 0.0517 0.0663 0.0999 
Region 3 0.0482 0.0494 0.0509 0.0614 0.0962 
1-day
minimum
3-day
minimum
7-day
minimum
30-day
minimum
90-day
minimum
St
re
am
flo
w
 (%
)
 
0.0
2.0
4.0
6.0
8.0
10.0
Region 1 Region 2 Region 3
Region 1 8.8305 5.0875 2.9580 1.2149 0.6806 
Region 2 6.7396 4.1185 2.4497 1.0727 0.6092 
Region 3 4.4425 2.9773 2.0102 0.9549 0.5847 
1-day
maximum
3-day
maximum
7-day
maximum
30-day
maximum
90-day
maximum
St
re
am
flo
w
 (%
)
 
(a) (b) 
0
50
100
150
200
250
300
Region 1 Region 2 Region 3
Region 1 54 219 
Region 2 124 241 
Region 3 54 212 
Date of 1-day minimum Date of 1-day maximum
Ju
lia
n 
da
te
 
0.0
5.0
10.0
15.0
20.0
Region 1 Region 2 Region 3
Region 1 6.13 12.47 9.70 6.92 
Region 2 8.31 8.96 10.75 6.88 
Region 3 5.86 15.67 6.99 9.61 
Low pulse
count
Low pulse
duration
High pulse
count
High pulse
duration
D
ur
at
io
n 
(d
ay
)
 
(c) (d) 
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.35
Rise rate Fall rate Number of reversals
0
10
20
30
40
50
60
70
80
90
100
Region 1 Region 2 Region 3
N
um
be
r o
f r
ev
er
sa
ls
St
re
am
flo
w
 (%
)
St
re
am
flo
w
 (%
)
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
1 2 3 4 5 6 7 8 9 10 11 12
Month  
(e) (f) 
Figure 5.2  The hydrologic characteristic of the three ecohydrological regions 
 23
5.1.2 Develop streamflow matrix by using artificial neural networks 
The physiographic data of the 42 stations (Table 5.1) and precipitation data of are used in the 
artificial neural networks (ANNs) as inputs.  In order to reduce the dimension of the ANNs, 
principal component analysis is used.  4 principal components are used in the ANN model and 
the hidden nodes of the ANN models are 3.  All of the data are divided into 2 groups: training 
date set and validation data set.  Root mean square error (RMSE), root mean square error 
percentage (RMSE_P), and correlation coefficient (CC) are used to evaluate the ANN model 
performance.  They can be calculated as: 
 
 2
1
N
i i
i
T O
RMSE
N




 (5-1) 
_ 100%
i
RMSERMSE P
O
   (5-2) 
  
   22
N
i i i i
i
N N
i i i i
i i
T T O O
CC
T T O O
 

 

 
 (5-3) 
Table 5.2 shows the ANN models for hydrologic indicators.   
The results show that most of the hydrological indicators can be correctly estimated by the 
ANN models.  The sources of errors are generally from the precipitation data (different temporal 
scales) and the physiographic characteristics of each station.  The average of the correlation 
coefficients of reaches more than 0.7, which means highly correlated results.  The ANN model 
is an effective tool for determining the hydrological characteristic of the ecological regime.  
 
 
 25
would be determination of the habitat conditions produced by a given discharge for each species 
of interest considering all life stages of each species.  Although there are methods of 
flow-related habitat assessment (e.g. Bovee 1982), these methods are typically site specific, are 
available for a limited number of species, and require extensive additional analysis to address 
regime requirements.  Furthermore, the complexity of attempting this approach for 30 species 
renders it impossible because the detailed habitat preference data needed for Taiwan fish species 
are not available.  In the absence of detailed habitat preference data, an alternative must be 
found to link flow information and species presence for use in analysis.  The link used in this 
paper is the autecology matrix (Suen and Herricks 2006).  The Taiwan fish autecology matrix 
assembles ecological requirements of fish species in a table that supports rapid assessment of 
environmental, ecological, or other requirements of these species.  It is possible to conduct a 
community analysis where the environmental requirements for a group of species can be 
determined.  For example the matrix supports determination that a group of species require 
stable spawning conditions during the same time period or require maintenance of pools or riffle 
areas.  These requirements can be translated into flow needs based on watershed conditions.  
An autecology matrix analysis allows relatively easy identification of the environmental and 
ecological requirements of fish communities (Suen and Herricks 2006).  In the Dahan River, 
information from the autecology matrix analysis was used to identify expected responses of 
indigenous species to flow regimes provided by modified reservoir operational rules. 
To support the multiobjective analysis of reservoir operation a reduced set of hydrologic 
indicators was needed.  Based on the autecology matrix (Suen and Herricks 2006), it was 
possible to identify conditions favorable to indigenous species.  The conditions selected also 
produced conditions unfavorable for exotic, or generalist, species (Moyle and Light 1996).  For 
instance, indigenous species require flows typical of high discharge periods during typhoons 
(hurricanes) and extended low flows during the dry season (Bernardo et al. 2003).  Exotic 
species are poorly adapted to high discharges so a return to historical flow conditions with 
periodic high discharge conditions would be expected to benefit indigenous species (Tew et al. 
2002, Mathesw 1986).  Therefore, the indicator “Wet season 3-day maximum” was used to 
establish a possible rule for reservoir operation that would mimic typhoon-related flow events 
that would be expected to benefit downstream indigenous species. 
Other hydrologic conditions that, if produced by reservoir management procedures, would 
be expected to benefit indigenous species include the “Dry season 3-day maximum,” the 
“Number of high flow events within each dry season,” and the “Mean of all positive differences 
between consecutive values in the wet season (rising rate)”.  These indicators are related to the 
increased stage and flow velocity and can be related to spawning based on general habitat 
conditions and habitat stability.  For example increased discharge produces deeper pools, higher 
average velocity in pools, and expansion of habitat in riffle areas.  Because indigenous species 
tend to be riffle spawners with eggs attached to coarse substrates not moved by higher flows, 
these species are at an advantage.  Correspondingly, exotic species tend to be bottom-nesting, 
preferring low to no velocity in pool areas (Suen 2005).  Although the spawning periods of both 
indigenous and exotic species are similar, the coarse substrate habitat selected by indigenous 
species is less susceptible to damage by stage or velocity changes than the fine substrate habitats 
commonly used by exotic species.  The “Mean duration of low flow events” was used to 
identify reduced riffle area and the length of time low velocity pools. 
The final indicator “Mean streamflow for each 10-day period” is related to flow magnitude 
relationships to habitat.  High flows maintain stream channel conditions (Leopold et al. 1964; 
Ward and Trimble 2004) producing stream habitats that connect the channel with riparian areas 
(Hupp and Osterkamp 1996).  An alternative indicator was the use of “The coefficient of 
efficiency of the yearly trend of hydrograph” which takes into account both “mean streamflow for 
10-day period” and “timing of annual extreme conditions”.  This coefficient shows how close 
 27
efficiency (CE) of the 
yearly trend of hydrograph 
variability) can lead to increased habitat 
segregation with corresponding increased 
support for diversity and/or density.   
Poff and Ward 1989; 
Horwitz 1978; Pusey 
et al. 1995 
 Wet season 3/10-day 
maximum 
The lateral expansion of floodplain habitats 
during flooding creates important spawning, 
nursery and foraging areas for many fish 
species.  
Ward et al. 1999 
 Number of high/low pulses 
with in each wet/dry 
season 
Reducing the frequency of disturbance in 
regulated rivers due to high or low flows may 
cause a decline in species diversity as suggested 
by the intermediate disturbance hypothesis. 
Connell 1978; Ward 
and Stanford 1983; 
Puckridge and 
Walker 1995 
 Mean duration of high 
pulses each year 
Prolonged inundation alters the amount of 
shallow or riffle habitat.   
Bogan 1993 
 Dry season 10-day 
minimum 
If the 10-day minimum is too low, there will be 
fewer deep pools and deep riffles. 
 
 Wet season 3-day 
maximum 
Extreme flows in Taiwan may increase flow 
depth from 1-3 m to 30m in some channels – 
these events alter habitat in unexpected ways. 
 
    
Habitat (cover) Wet season 3-day 
maximum 
Individual high flow events greatly reduce the 
biomass and change the species composition of 
periphyton  
Power and Stewart 
1987 
 Mean duration of high/low 
pulses each year 
Altered inundation duration of floodplain can 
alter plant cover types 
Auble et al. 1994 
    
Current Mean of all positive 
differences between 
consecutive values in 
dry/wet season 
Rapid changes in river stage may wash out or 
strand organisms.  
Cushman 1985 
 Mean of all negative 
differences between 
consecutive values in 
dry/wet season 
Highly variable amplitude of the falling limb can 
cause variable migration intensity. 
Welcomme 1985 
    
Substrate Wet season 3-day 
maximum 
Exceptionally high flows associated with typhoon 
events will wash out organisms and change 
channel substrate location and composition.   
Cushman 1985 
 Number of high pulses (2.0 
x wet season mean) with 
in each wet season 
The frequency of high pulses, wash out, and 
substrate change can shift community 
dominance to endemic species.  
 
 Mean of all positive 
difference between 
consecutive values in wet 
season 
Metric of flow rate increase useful in assessing 
potential for wash out and period over which 
habitat disruption is possible.   
 
    
Spawning 
substrate 
Dry season 10/30/90-day 
minimum 
Low and relatively stable flows required for 
spawning and recruitment of riverine fish. 
Humphries and Lake 
2000 
 Wet season 3-day 
maximum 
Exceptionally high flows associated with typhoon 
events will wash out organisms and change 
channel substrate location and composition.   
Cushman 1985 
 Number of high pulses 
(2.0x  wet season mean) 
with in each wet season 
The frequency of high pulses will change the 
streambed substrate altering spawning area and 
location. 
 
 Mean of all positive 
difference between 
consecutive values in wet 
season 
Mean rising rate will change availability of 
spawning habitat and may disrupt spawning 
activity. 
 
 Mean of all negative 
differences between 
consecutive values in 
dry/wet season 
Reduction of flow can strand spawning 
organisms or disrupt use of spawning habitat. 
 
 29
By examining the relationships between stream ecosystems, water quality, and hydrologic 
characteristics, we can understand the preference of different organisms to flow regimes.  The 
development of the multipurpose hydrological indicators is quite important to the management of 
ecological flow.  The structural equation modeling provides examination of a set of relationships 
between one or more independent variables and one or more dependent variables, so the modeler 
could explicitly capture the unreliability of measurement in the model, which in theory allows the 
structural relations between latent variables to be accurately estimated. 
In this study, the structural equation model is used to build five water quality models and 
one biodiversity model.  The water quality model examines the causality of hydrologic 
indicators and River Pollution Index, which expresses the relationship between the hydrological 
indicators and water quality condition, and the biodiversity model examines the causality of 
hydrological indicators and Shannon Index, which expresses the relationship between 
hydrological indicators and biodiversity.  By analyzing water quality and biodiversity models, a 
suite of hydrological indicators representing multiple characteristics can be obtained.  The 
multipurpose hydrological indicators selected from this research can not only provide the specific 
hydrologic and water quality information that fish requires, but also can provide the guidance for 
water resources authorities to achieve the goal of ecological restoration.   
Figure 5.3 shows the streamflow, water quality, and fish data used in this research.  In order 
to determine the influence of streamflow variability to water quality, 11 hydrologic indicators are 
considered for the analysis.  For structural equation modeling purpose, 11 hydrologic indicators 
are classified into 7 factors: 
Factor 1 includes 3-day min, 7-day min, and 30-day min.  It represents the low flow 
magnitude in the dry period. 
Factor 2 includes 7-day max and 30-day max.  It represents the high flow condition in wet 
period. 
Factor 3 includes 90-day max.  It represents the long term high flow condition. 
Factor 4 includes Hi pulse # and Lo pulse #.  It represents the number of high and low flow 
events. 
Factor 5 includes Date max.  It represents the timing of the 1 day maximum. 
Factor 6 includes Low pulse L.  It represents the duration of low flow events. 
Factor 7 includes Reversals.  It represents the flow variation caused by precipitation. 
 
 
   
(a) Streamflow (b) Water quality (c) Fish 
Figure 5.3  Data used in the structural equation model 
 
Figure 5.4 shows the dissolved oxygen (DO) SEM model.  The largest absolute number of 
the path coefficient is connecting to Factor 2 (-0.52).  It represents the negative correlation 
between the two hydrologic indicators (7-day max and 30-day max) and DO values.  The reason 
 31
because the extreme flow events would increase/decrease the downstream suspended solid 
conditions.  
 
FACTOR1
-.03
水質
1.00
7-day mind2
1.00
3-day mind1 1.00
1.00
懸浮固體 e
1.00
z
.97
30-day mind3
FACTOR2.99
30-day maxd5
1.00
.94
7-day maxd4
.97
.25
1.00
.98
.79
FACTOR3
.97
1.00
90-day maxd6
1.00
-.04
FACTOR4
.27
.14
Lo pulse #d8
.37
.18
Hi pulse #d7 .42
-.59
FACTOR5
1.00
Date maxd9
1.00
.40
FACTOR6
-.15
1.00
Lo pulse Ld10
1.00
FACTOR7
1.00
Reversalsd11
1.00
-.31
.11
-.54
-.27
.83
-.04
-.39
-.63-.27
1.18
-.16
-.10
-.08
-.12
.10 -.20
Standardized estimates
χ2 = 49.085
DF = 35, P = 0.057
Water quality SS
 
Figure 5.6  Water quality (suspended solid) SEM model 
 
Figure 5.7 shows the nitrate SEM model.  The largest absolute number of the path 
coefficient is connecting to Factor 3 (-0.52).  It represents the negative correlation between the 
90-day max and BOD values.  The reason for this probably is because the monsoon climate 
could dilute upstream pollutants.   
 
FACTOR1
.02
水質
1.00
7-day mind2
1.00
3-day mind1 1.00
1.00
氨氮 e
1.00
z
.97
30-day mind3
FACTOR2.99
30-day maxd5
1.00
.94
7-day maxd4
.97
.46
1.00
.98
.79
FACTOR3
.97
1.00
90-day maxd6
1.00
-.52
FACTOR4
-.22
.15
Lo pulse #d8
.39
.19
Hi pulse #d7 .44
-.58
FACTOR5
1.00
Date maxd9
1.00
.39
FACTOR6
-.15
1.00
Lo pulse Ld10
1.00
FACTOR7
1.00
Reversalsd11
1.00
-.31
.12
-.53
-.28
.83
-.04
-.38
-.61-.27
1.14
-.16
-.10
-.06
.05
.12 .22
Standardized estimates
χ2 = 45.784
DF = 35, P = 0.105
Water quality Nitrate
 
Figure 5.7  Water quality (nitrate) SEM model 
 
Figure 5.8 shows the River Pollution Index (RPI) SEM model.  The largest absolute 
number of the path coefficient is connecting to Factor 2 (0.57).  It represents the positive 
 33
show the relationships between the climatic and water quality conditions.  7-day max, 30-day 
max, and 90-day max are selected to show the multipurpose of indicators.  The water resources 
managers could consider use these ecohydrological indicators in the ecological water resources 
management. 
 
5.3 Regime-based approach coupled with total volume idea for ecological water resources 
management 
 
5.3.1 Optimal reservoir operation considering downstream water quality and environmental 
flow needs 
In the multi-objective model, Equation 1 is used to combine them into one objective.  
There is no specific guidance for setting weightings for these objectives.  We would like to put 
more emphasis on minimize water supply deficit and environmental flow components, so the 
weightings for two human objectives (C1 and C3), water quality objective (C2), and 
environmental flow objective (C4) are set to 0.4, 0.1, 0.1, and 0.4, respectively.  Further 
sensitivity analysis of these weighting is suggested.  Based on the current settings, the optimal 
reservoir operation results are compared with traditional M-5 Rule Curve operation results.  
Only three years (1993, 1995, and 1997) GSI results of the optimization model are better than the 
results of M-5 Rule Curve operation (See Table 5.5).  Two years (1994 and 1996) GSI results of 
the optimization model are worse than the results of M-5 Rule Curve operation.  The water 
supply deficit of these two years increases about 25 %.  The number of total water quality 
violation months of optimization model is generally less than 2 months while the M-5 Rule Curve 
operation may reach to 5 months (See Table 5.6).  Although the optimization model only 
considers very small weighting (0.1) on water quality objective, the downstream water quality 
has been improved to provide better use of the water supply purpose.   
 
Table 5.5  The GSI comparisons of M-5 Rule Curve and optimization model results 
Year 1993 1994 1995 1996 1997 1998 1999 2000
M-5 Rule Curve 8.24 7.96 1.02 34.82 0.11 0.11 0 0 
Optimization model 5.07 22.78 0.38 72.18 0 0.12 0 0 
 
Table 5.6  The comparisons of number of total water quality violation months 
Year 1993 1994 1995 1996 1997 1998 1999 2000
M-5 Rule Curve 5 2 3 3 2 0 0 0 
Optimization model 1 2 1 1 1 2 0 1 
 
In order to maintain the similar flow variability of downstream release to the natural flow 
regime, the optimization model manages the release to allow the EFCs falling between the upper 
and lower thresholds.  Figure 5.10 shows the comparisons of ten EFCs comparisons of M-5 
Rule Curve and optimization model results.  Based on Richter et al. (1997) suggestion, 50 % of 
the years should fall between the upper and lower thresholds.  In other words, four year 
management results should in that range.  The optimization results of high flow EFCs are 
generally better than the M-5 Rule Curve operation results, but both optimization and M-5 Rule 
Curve operation results of extreme low flow EFCs are not good.  The reservoir management has 
strongly affected the extreme low flow component of flow regime and made these very difficult 
to similar to natural flow regime.   
 35
The only objective of the M-5 Rule Curve operation is to provide water for human needs 
while the multi-objective model simultaneously considers several objectives.  The 
multi-objective model may not provide the best condition of the least water supply deficit.  
Tables 5.7 and 5.8 show the comparisons of water quality, water demand deficit, and EFCs 
improvement.  In 1993, 1995, 1997, and 1999, the optimization model improves both water 
quality and water demand deficit.  In 1994 and 1996, the optimization model only improves 
water quality but water demand deficit gets worse.  In 1998 and 2000, the optimization model 
only improves water demand deficit, but water quality gets worse.  Although the environmental 
flow objective cannot be compared by the same way, the improvement by optimization model 
could be seen in 5 of 6 high flow EFCs.  
 
Table 5.7  The comparisons of water quality and water demand deficit improvement 
(+: improved or the same; --: not improved) 
 GSI Public water demand deficit 
Agricultural 
water demand 
deficit 
Duration of 
water demand 
deficit 
Duration of 
water quality 
violation 
1993 + + + + + 
1994 -- -- -- -- + 
1995 + + + + + 
1996 -- -- -- -- + 
1997 + + + + + 
1998 -- + -- + -- 
1999 + + + + + 
2000 + + + + -- 
 
Table 5.8  The comparisons of EFCs improvement  
(+: improved or the same; --: not improved) 
 High flow Extreme low flow 
Frequency + -- 
Duration -- -- 
Timing + -- 
Magnitude + -- 
Rising rate +  
Falling rate +  
 
 
5.3.2 Apply the protected and nurtured flow scenarios in M-5 Rule Curve operation 
In this research, three protected and nurtured flow scenarios are defined: dry-wet period 
scenario, seasonal scenario, and monthly scenario.  Although the protected and nurtured flow 
increases the streamflow in the downstream area, but it also increases the reservoir operation 
loads in long term M-5 rule operation.  Figure 4.14 shows the water supply load increases about 
30%.  Because the year of 1993 is a dry year, insufficient inflow in wet season makes GSI index 
reaching more than 20 % in the dry-wet period and monthly scenarios.  M-5 rule operation only 
reaches 8.24 %.  In Figure 5.11, although water deficit durations are similar, three protected and 
nurtured flow scenarios are much worse than the M-5 rule operation because of no partial water 
supply policy in the three protected and nurtured flow scenarios.  
 
 
 
 37
Table 5.11  The water quality violation comparison of the three protected and nurtured flow and 
M-5 rule operation scenarios (month) 
Year 1993 1994 1995 1996 1997 1998 1999 2000 
M-5 rule operation 5 2 3 3 2 0 0 0 
Dry-wet period 2 2 2 1 1 2 0 0 
Seasonal 1 1 2 2 1 1 0 0 
Monthly 2 1 2 2 1 1 0 0 
 
The results show that the seasonal protected and nurtured flow scenario performs the best in 
water deficit and flow variability than the other two protected and nurtured flow scenarios.  In 
order to know the ecological influence of the seasonal protected and nurtured flow scenario, the 
ecohydrological indicators are used.  If the reservoir operating under the seasonal protected and 
nurtured flow scenario can release the flow that is similar to natural flow variability, it could 
benefit to downstream ecosystems. 
After determining the ecohydrological indicators, the range of variability approach (RVA) is 
used to evaluate the natural flow achievement.  Figure 5.12 shows the results of our model.  
Only one or two values of the three ecohydrological indicators: three day max in the wet period, 
three day max in the dry period, high flow events in the dry period fall into the target range.  It 
means that streamflow alterations by human activities are too large.   
Table 5.12 shows the results of the coefficient of efficiency of yearly hydrograph.  If the 
value is closer to 1, it means the released flow hydrograph is closer to natural flow condition.  
The results show downstream hydrograph is almost impossible to be similar to natural flow 
condition.  The reservoir operation alters the flow regime a lot.  It may affect the cue of some 
organisms breeding signals and damages to the river ecosystems. 
 
Table 5.12 The coefficient of efficiency of yearly hydrograph under the seasonal protected and 
nurtured flow scenario 
Year  1993 1994 1995 1996 1997 1998 1999 2000
Seasonal protected and nurtured flow -2.63 0.30 -1.66 0.15 0.19 -0.08 -0.11 0.12
 
 39
 
Table 5.13  The GSI value comparison between the seasonal protected and nurtured flow 
scenario and the optimal model 
 1993 1994 1995 1996 1997 1998 1999 2000 
Seasonal protected 
and nurtured flow 17.12 78.47 0.03 151.71 0 0 0 0 
Optimal model 1.02 7.96 0.11 72.18 0 0.03 0.01 0 
 
Table 5.14  The water deficit comparison between the seasonal protected and nurtured flow 
scenario and the optimal model 
 1993 1994 1995 1996 1997 1998 1999 2000
Seasonal protected 
and nurtured flow 68.25 110.02 3.33 162.25 0 0 0 0 
Optimal model 20.96 40.63 4.39 90.96 0 3.22 9.47 0 
 
Table 5.15 is the water quality violation duration comparison between the seasonal protected 
and nurtured flow scenario and the optimal model.  Although in 1994 there is one month more 
violation in the optimal model than the protected and nurtured flow, the violation conditions in 
most other years are improved. 
 
Table 5.15  The water quality violation comparison between the seasonal protected and nurtured 
flow scenario and the optimal model 
 1993 1994 1995 1996 1997 1998 1999 2000 
Seasonal protected 
and nurtured flow 1 1 2 2 1 1 0 0 
Optimal model 1 2 1 1 0 0 0 0 
 
Table 5.16 and Figure 5.13 show the comparison between the seasonal protected and 
nurtured flow scenario and the optimal model.  The coefficient of efficiency could not be 
improved.  It means it is impossible to make the downstream flow regime similar to natural flow 
regime because the major purpose of the reservoir is providing water for human use.  In Figure 
5.13, because three-day max in dry period, mean duration of low flow events, mean duration of 
low flow events reach the best condition of the RVA range (50% criteria), it means the optimal 
model could possible to catch the characteristics of the natural flow regime. 
 41
water quality conditions.  By changing the reservoir operational release strategy to improve 
water quality, it can benefit to water supply quality and reduce the treatment cost of the water 
company.  The ecohydrological indicators also show improved results (except the CE value of 
yearly hydrograph).  The optimal model considers water supply, water quality, and river 
ecosystem, and provides a better option for the ecological water resources management.   
 
Table 5.17  The comparison of the GSI, water deficit, and water quality violation (★: improved) 
Year 1993 1994 1995 1996 1997 1998 1999 2000
GSI ★ ★ ☆ ★ ★ ☆ ☆ ★ 
Total water deficit ★ ★ ☆ ★ ★ ☆ ☆ ★ 
Water quality violation ★ ☆ ★ ★ ☆ ☆ ★ ★ 
 
Table 5.18  The comparison of the ecohydrological indicators (★: improved) 
Three-day max in wet period ★
Three-day max in dry period ★
Mean duration of low flow events ★
High flow events in dry period ★
Mean duration of low flow events ★
The CE value of yearly hydrograph ☆
 
Figure 5.14 is the best storage curve of the optimal model.  In order to achieve better 
ecological goal, the ten-day release of the optimal model would cause long term storage after 
larger release.  It will not happen in the M-5rule curve operation.  There are also several 
ten-day periods of the optimal best storage levels show lower storage conditions than the lower 
limit of the M-5 Curve.  In Tables 5.13 and 5.14, the optima model won’t cause too serious 
water deficit conditions.  In order to compromise all the objectives at the same time, the 
reservoir managers need to develop more complicated model to operate the reservoir.  This 
study provides a good case study for considering water supply, water quality, and river ecosystem 
at the same time.   
 
Ten-day period
St
or
ag
e 
(m
ill
io
n 
cu
bi
c 
m
et
er
)
 
Figure 5.14 The best storage curve when considering the optimal model 
 
 43
Holland, J. H. 1975. Adaptation in Natural and Artificial Systems, University of Michigan    
Press, Ann Arbor. 
Huang, W. C. and F. T. Yang. 1999. “A handy decision support system for reservoir operation in 
Taiwan”, Journal of the American Water Resources Association, 35(5), 1101-1112. 
Hughes, D. A., J. Okeefe, V. Smakhtin, and J. King. 1997. “Development of an operating rule 
model to simulate time series of reservoir releases for instream flow requirements”, Water SA 
23(1): 21-30. 
Hughes, D. A. and V. Smakhtin. 1996. “Daily flow time series patching or extension: A spatial 
interpolation approach based on flow duration curves”, Hydrological Sciences Journal 41(6): 
851-871. 
Hughes, D. A. and G. Ziervogel. 1998. “The inclusion of operating rules in a daily reservoir 
simulation model to determine ecological reserve releases for river maintenance”, Water SA, 
24(4), 293-302. 
Hupp, C. R. and W. R. Osterkamp, 1996. Riparian vegetation and fluvial geomorphic processes. 
Geomorphology 14: 277-295. 
Jennings, M. E., W. O. Thomas Jr., and H. C. Riggs, 1994. Nationwide Summary of US 
Geological Survey Regional Regression Eqs. for Estimating Magnitude and Frequency of 
Floods for Ungauged Sites, 1993. USGS Water-Resources Investigations Report 94-4002, 
196 pp 
Junk WJ, Bayley PB, Sparks RE. 1989. The flood pulse concept in river-floodplain systems. 
Canadian Special Publication of Fisheries and Aquatic Sciences 106: 110-127. 
Koel, T.M. and R. E. Sparks, 2002. “Historical patterns of river stage and fish communities as 
criteria for operations of dams on the Illinois River.” River Research and Applications, 18(1), 
3-19. 
Koza, J. R. 1992. Genetic Programming: On the Programming of Computers by Means of Natural 
Selection, MIT Press, Cambridge, MA 
Kuo, J. T., W. C. Cheng, and L. Chen. 2003. “Multiobjective water resources systems analysis 
using genetic algorithms - application to Chou-Shui River Basin, Taiwan”, Water Science and 
Technology 48(10): 71-77. 
Leopold, L. B., Wolman, M. G., and J. P. Miller. 1964. Fluvial Processes in Geomorphology. 
W.H. Freeman and Sons, San Francisco. 
Liberali, V. and R. Rossi, 2001. “Artificially evolved design of digital filters”, Workshop on 
Advanced Mixed-Signal Tools, Munich. 
Matthews, W. J. 1986. “Fish faunal structure in an Ozark stream: stability, persistence and a 
catastrophic flood.” Copeia, 1986, 388-397. 
McCulloch, W. S. and W. Pitts, 1943. “A logical calculus of the ideas imminent in nervous 
activity”, Bulletin and mathematical biophysics 5: 115-133 
Milhous, R. T., M. A. Updike, and D. M. Schneider. 1989. Physical Habitat Simulation System 
Reference Manual—Version II. Instream Flow Information. Paper No. 26. Biological Report 
89(16). US Fish and Wildlife Service: Washington, DC. 
Ministry of Economic Affairs. 2002. Shihmen Reservoir Operation Rules. Ministry of Economic 
Affairs, Taipei. (in Chinese) 
Moyle, P. B., and Light. T. 1996. “Fish invasions in California: do biotic factors determine 
success?” Ecology, 77, 1666–1670. 
Olden, J. D. and N. L. Poff. 2003. “Redundancy and the choice of hydrologic indices for 
characterizing streamflow regimes”, River Research and Applications 19(2): 101-121. 
Poff, N. L. and J. D. Allan, 1995. “Functional organization of stream fish assemblages in relation 
to hydrological variability”, Ecology 76(2): 606–627. 
 45
Suen, J. P. and E. E. Herricks. 2009. “Developing fish community based ecohydrological 
indicators for water resources management in Taiwan”, Hydrobiologia 625: 223-234. 
Suen, J. P. and W. C. Su. 2010. ‘Reconstructing Riverine Mesohabitat Unit Composition Using 
Fish Community Data and an Autecology Matrix’, Journal of Fish Biology 77(4): 972-984. 
Suen, J. P., J. W. Eheart, E. E. Herricks, and F. J. Chang. 2009. ‘Evaluating the Potential Impact 
of Reservoir Operation on Fish Communities’, Journal of Water Resources Planning and 
Management-ASCE 135(6): 475-483. 
Suen, J. P., E. E. Herricks, and J. W. Eheart, 2004, “Ecohydrologic Indicators for Rivers of 
Northern Taiwan”, ASCE/EWRI World Water & Environmental Resources Congress 2004, 
Salt Lake City, Utah, USA. 
Tew, K. S., C. C. Han, W. R. Chou, and L. S. Fang, 2002. Habitat and fish fauna structure in a 
subtropical mountain stream in Taiwan before and after a catastrophic typhoon. 
Environmental Biology of Fishes 65(4): 457-462. 
Townsend, C. R. and R. H. Riley, 1999. “Assessment of river health: accounting for perturbation 
pathways in physical and ecological space”, Freshwater Biology 41(2): 395-405. 
Townsend, C. R., M. R. Scarsbrook, and S. Doledec, 1997. “The intermediate disturbance 
hypothesis, refugia, and biodiversity in streams”, Limnology and Oceanography 42(5): 
938-949. 
Tu, M. Y., N. S. Hsu, and W. W. G. Yeh. 2003. “Optimization of reservoir management and 
operation with hedging rules”, Journal of Water Resources Planning and Management- ASCE 
129(2): 86-97. 
Tucci, C., A. Silveira, J. Sanchez, and F. Albuquerque, 1995. “Flow regionalization in the upper 
Paraguay basin. Brazil”, Hydrologic Science 40: 485–497. 
Vannote, R. L., G. W. Minshall, K. W. Cummins, J. R. Sedell, and C. E. Cushing. 1980. “The 
river continuum concept”, Canadian Journal of Fisheries and Aquatic Sciences 37: 130-137. 
Vogel, R.M., I. Wilson, and C. Daly, 1999. “Regional regression models of annual streamflow 
for the United States”, Journal of irrigation drainage Engineering 125: 148–157. 
Wang, H. C. 1998. Biomonitoring analysis of fish in Tamshui River. Annual Scientific Report of 
National Institute of Environmental Analysis, Environmental Protection Administration, vol.7: 
181-212. (in Chinese) 
Yang Y. C. E., X. M. Cai, and E. E. Herricks, 2006. “Identification of hydrologic indicators 
related to fish population: comparative study of three approaches, submitted to Water 
Resources research. 
Zimmermann, H. J, 1991. Fuzzy set theory and its applications, 339 pp., Klumer Academic 
Publishers: Taiwan. 
汪靜明，1998，「河川生態基流量設計及魚類棲地改善之理念」，環境教育季刊 35: 46-69. 
吳瑞賢、陳榮松、温博文，2005，保育用水推動策略規劃，經濟部水利署水利規劃試驗所
研究報告，pp. 1-240。 
吳瑞賢、温博文、畢嵐杰，2006，檢討水庫與攔河堰操作策略影響保育用水標的之探討，
經濟部水利署水利規劃試驗所研究報告，pp. 1-200。 
吳瑞賢、溫博文、毛振泰、張楨驩，2004，「河川生態基準流量及魚類棲地分布之研究-以
卑南溪為例」，中國土木水利工程學刊 16(2): 301-314。 
張斐章、孫建平、E. E. Herricks、陳盈守、楊翰宗，2004，「流量變化於生態河川流態及水
資源管理之研究」, 第一屆生態工程學術研討會，台北，289-300。 
楊津豪，2006，「河川生態廊道與魚類物理棲地之水理模式研究」，國立臺灣大學土木工
程學系碩士論文，台北，pp.1-151。 
謝暻椲，2002，「大漢溪中游生態基流量推估與棲地改善之研究」，國立中央大學土木工
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                              日期： 99 年 5 月 30 日 
 
一、參加會議經過 
本次會議地點位於美國 Providence, Rhode Island，會議時間為 99 年 5 月 16 日至 20
日，舉行為期五天之研討及演講活動。 
本次參加會議共發表兩篇論文，其中「Optimal Reservoir Operation Considering 
Downstream Water Quality and Environmental Flow Needs」被大會安排為口頭論文發表，
時間為 5 月 18 日下午 1 時 30 分至 3 時 00 分，為 Planning and Management 主題中之 The 
G. V. Loganathan Memorial Track on Reservoir Operation 小節的第一篇報告，本篇有撰寫全
文並收錄於光碟中；另一篇「Use of Structural Equation Modeling to Examine the 
Relationships among Hydrologic Indicators, Water Quality, and Stream Ecosystems」亦被大會
安排為口頭論文發表，時間為 5 月 18 日上午 11 時 00 分至 12 時 30 分，為 Hydraulics & 
Waterway 主題中之 Eco-Hydrology I 小節的第四篇報告，本篇僅有摘要投稿。本次論文
宣讀發表，第一篇共有兩位學者提問討論，對於多目標的水庫管理及如何有效提供決策
者參考做討論，並對生態、水質及民生用水的調配提出建議；第二篇共有兩位學者提問
討論，則對於結構方程式模式的建立非常有興趣，並對本研究成果給予高度的肯定，會
後休息時間與他們都分別有更進一步交換意見及討論，他們對於論文研究有高度興趣並
予以肯定，且互相留下連絡方式建立日後學術交流的管道，亦是此行的收穫之一。 
計畫編號 NSC 96-2221-E-006-264-MY3 
計畫名稱 河川流態於生態水資源管理之研究 
出國人員
姓名 孫建平 
服務機構
及職稱 
國立成功大學水利及海洋工程學系 
助理教授 
會議時間 99 年 5 月 16 日至 99 年 5 月 20 日 會議地點 Providence, Rhode Island, USA 
會議名稱 World Environmental & Water Resources Congress 2010 
發表論文
題目 
1. Optimal Reservoir Operation Considering Downstream Water Quality and 
Environmental Flow Needs 
2. Use of Structural Equation Modeling to Examine the Relationships among 
Hydrologic Indicators, Water Quality, and Stream Ecosystems 
22. Water Resources Planning and Management (sub)  
23. Section and Branch Activities Council  
24. 7th Urban Watershed Management Symposium  
25. Urban Watershed Management  
26. Concentrate Management in Desalination  
27. Security Enhancements and Emergency Challenges or Suggested Changes  
28. Stormwater Infrastructure  
29. Sustainability  
30. Water Distribution Systems (symposium)  
31. Water Pollution Control Committee  
32. Improved Watershed Delineation and Modeling  
33. Hydroclimate Committee of Watershed Council  
34. Hydrologic Monitoring Network Track  
35. NEXRAD Rainfall Data Analysis and Application Track  
36. Uncertainty Analysis Approaches in Hydrologic Modeling  
經過五天的論文發表、討論及相關議程，研討會於 5 月 20 日下午圓滿結束。 
 
二、與會心得 
首先感謝國科會在經費上之支持，使本人能有機會參與此次國際研討會，將本研究
計畫成果發表於國際會議上。 
本會議為一年一度美國土木工程學會在水資源及環境方面之主要會議，本人連續數
年都參與討論，此次更將國科會計畫成果發表於會議上，由於與與會學者已建立一定程
度的熟悉度，藉由與會學者之交流討論，提供未來本人在教學與研究上的許多寶貴意見，
生態水資源之研究方向為目前國際學者相當有興趣的課題，值得本人及相關人員做更深
 1
Optimal Reservoir Operation Considering Downstream Water Quality and 
Environmental Flow Needs 
 
Jian-Ping Suen1 and Ruei-Hong Wang2 
 
1 Department of Hydraulic and Ocean Engineering, National Cheng Kung University, 
No.1 University Road, Tainan 701, TAIWAN; Phone 886-6-2757575-63243; Fax 
886-6-2741463; Emails: jpsuen@mail.ncku.edu.tw  
2 Department of Hydraulic and Ocean Engineering, National Cheng Kung University, 
No.1 University Road, Tainan 701, TAIWAN; Phone 886-6-2757575-63243; Fax 
886-6-2741463; Emails: n8696103@mail.ncku.edu.tw  
 
 
 
ABSTRACT 
 
This study develops an optimal reservoir management model based on each ten-
day operation periods for Shihmen Reservoir.  The model tries to not only meet the 
human water requirement, but also to consider water quality and ecological issues.  In 
Taiwan, lots of infrastructures have been built in almost every river to effectively use 
water resources and provide disaster defense.  It results in downstream flow 
regulation or violent flow fluctuation that causes impacts on aquatic ecosystem 
biodiversity.  Decision makers should take flow variability into account in water 
resources management policy.   
 
Human demands, water quality, and ecological issues are considered in the optimal 
reservoir management model.  Human demands objective is based on water rights of 
different users and M-5 Rule Curve of Shihmen Reservoir.  Ecological objective is 
based on consideration of Environmental flow components (Richter et al. 2007).  
Water quality model uses an artificial neural network model to simulate downstream 
water quality by using streamflow, rainfall, upstream water quality, and measure time 
as inputs.  Then this model is combined with human demands and environmental flow 
components considerations to establish an optimal reservoir management model by 
using genetic algorithm.  The optimal reservoir operation model considers human 
demands, water quality and flow regime to benefit to both human society and aquatic 
ecosystems. 
     
 
INTRODUCTION 
 
Suen and Eheart (2006) propose a model that incorporates the ecological flow 
regime approach for multi-objective reservoir management.  In this model, although 
both ecosystem and human needs are considered in reservoir operation considerations, 
water quality is still another important factor that affects both human and ecosystem 
needs.   
 
 3
 
1
j
2
k
Downstream 
water quality
Input layer
4 nodes
Output layer
1 node
Hidden layer
k nodes
Ten-day 
streamflow, 
Cumulative 
three-day 
rainfall, 
Upstream water 
quality
Ten-day rank
 
Figure 1  Water quality ANNs model 
 
Multi-objective reservoir operation model 
 
In this research, three reservoir operational management objectives are considered: (1) 
provide sufficient water for human use, (2) provide natural variability for ecosystem 
use, and (3) provide good water quality for both human and ecosystem use.  Due to 
reservoir operational management in Taiwan is based on 36 ten-day periods, all the 
calculations in this research use the ten-day streamflow for parameter calculation. 
 
The ShihMen Reservoir is a multipurpose water resources project that not only 
satisfies irrigation, power generation, and public water supply, but also provides flood 
control and recreation.  The reservoir allocates water prioritized by domestic, 
agricultural, hydropower, and industrial uses and it operates based on the 36 ten-day 
periods rules.  The 36 effective reservoir storage values at the end of each ten-day 
period are the decision variables (target storage).  The human needs objective (C1) in 
this research only considers domestic and agricultural needs to minimize the water 
supply deficit. 
 
Water quality objective considers total nitrogen concentration in the downstream area.  
The concentration should maintain at least less than 0.3 mg/l for general public use.  
The water quality objective (C2) in this research is to minimize the frequency of the 
standard violations. 
 
Richter et al. (2007) propose the environmental flow components (EFCs) approach 
for maintaining downstream ecosystem integrity.  Five categories of EFCs (extreme 
low flows, low flow, high flow pulses, small floods and large floods) can be 
calculated by the Indicators of Hydrologic Alteration (IHA) software (The Natural 
Conservancy, TNC, 2005).  For ease of reservoir management in this research, only 
ten of the original 34 EFCs are considered.  They are high flow frequency, high flow 
duration, high flow timing, high flow magnitude, high flow rising rate, high flow 
falling rate, extreme low flow frequency, extreme low flow duration, extreme low 
flow timing, and extreme low flow magnitude.  The ecosystem objective (C4) in this 
research is to maximize the possibility that fits the high and low thresholds of range 
of variation approach (Richter et al. 1997). 
 
 5
In order to assess the water supply deficit condition, a generalized storage index (GSI) 
(Hsu, 1995) is used to evaluate water supply deficit condition.  The GSI definition 
can be written as: 
 
2
1
100
100=
⎛ ⎞= ⎜ ⎟×⎝ ⎠∑
N
i
i i
DPDGSI
N DY
    (2) 
where 
36
1
( (%) )j j
j
DPD DDR NDC
=
= ×∑  
  
 
RESULTS AND DISCUSSION 
 
Water quality simulation results 
 
There are so many factors affecting water quality.  No single factor could 
dominate the simulation results.  The ANNs model could effectively capture the 
complex relationships between rainfall, streamflow and upstream water quality.  
Figure 2 and Table 1 show the water quality simulation results by ANNs model.  The 
yearly water quality training results of 1993, 1995, 1996, and 1998 reveal high 
correlation, but the validation results of 1999 and 2000 only reveal moderate 
correlation.  The standard of nitrogen concentration is set 0.3 mg/l for general public 
and industrial water use.  Several false negative results can be found in the training 
events.  Reservoir managers still need to pay attention on applying this result.  More 
data sets for training may avoid this false negative condition.   
 
N
itr
og
en
 c
on
ce
nt
ra
tio
n 
(m
g/
l) 
       
                (a)                                   (b)                                  (c)                                   (d) 
       
                (e)                                    (f)                                   (g)                                  (h) 
 Month
Figure 2  Water quality simulation results by ANNs model.  (a)~(f): training events; 
(g)~(h): validation events. 
 7
 
 
         Optimization model                  M-5 Rule Curve          Optimization model                  M-5 Rule Curve
Te
n-
da
y 
pe
rio
ds
 
10
6  m
3  
 (c) High flow timing  (d) High flow magnitude 
 
         Optimization model                  M-5 Rule Curve          Optimization model                  M-5 Rule Curve
10
6  m
3  /
 T
en
-d
ay
 
10
6  m
3  /
 T
en
-d
ay
 
 (e) High flow rising rate  (f) High flow falling rate 
 
         Optimization model                  M-5 Rule Curve          Optimization model                  M-5 Rule Curve
Ti
m
es
 
Te
n-
da
y 
pe
rio
ds
 
 (g) Extreme low flow frequency  (h) Extreme low flow duration 
 
         Optimization model                  M-5 Rule Curve          Optimization model                  M-5 Rule Curve
Te
n-
da
y 
pe
rio
ds
 
10
6  m
3  
 (i) Extreme low flow timing  (j) Extreme low flow magnitude 
 
Figure 3  The EFCs comparisons of M-5 Rule Curve and optimization model results  
 
         Optimization model                  M-5 Rule Curve          Optimization model                  M-5 Rule Curve
Ti
m
es
 
Te
n-
da
y 
pe
rio
ds
 
 (a) High flow frequency  (b) High flow duration 
 9
more, if the economic benefits of better environmental flow condition are also taken 
into account, operation by this model may more feasible.  Reservoir managers also cn 
adjust the weightings of each objective to get the trade-off curves for making 
decisions by policy makers. 
 
 
NOTAIONS 
Ri: total release at the ith ten-day period 
Di: total water demand at the ith ten-day period 
Si: reservoir storage at the ith ten-day period  
Rule1i: upper rule curve (M-5 curve) at the ith ten-day period 
Rule2i: lower rule curve (M-5 curve) at the ith ten-day period 
Rule3i: critical rule curve (M-5 curve) at the ith ten-day period 
Ragi: agricultural release at the ith ten-day period 
Dagi: agricultural demand at the ith ten-day period 
Rpubi: public release at the ith ten-day period 
Dpubi: public demand at the ith ten-day period 
Rsi: ShihMen Canal release at the ith ten-day period 
Dsi: ShihMen Canal demand at the ith ten-day period 
Rti: TaoYuan Canal release at the ith ten-day period 
Dti: TaoYuan Canal demand at the ith ten-day period 
Rui: total release of the After Bay at the ith ten-day period 
Rspill: water release for flood control at the spillway 
Ek: the number of years of kth EFCs falls in RVA threshold (K=1~X) 
X: the number of EFCs (in this research, X=10) 
N: the number total years  
Wqdt: at the tth month period, 1: if the water quality violates the standard; 
0: if it does not 
Ddi: at the ith ten-day period, 1: if there is water supply deficit; 0: if it 
does not 
nt: the number of consecutive water quality violation at the tth month 
period 
ni: the number of consecutive water supply deficit at the ith ten-day 
period 
w: the weighting of each sub objective 
DPD: the deficit percent index 
DDR: the deficit rate index 
NDC: the number of consecutive water supply deficit 
DY: the total number of ten-day periods (36) 
 
 
ACKNOWLEDGEMENTS 
 
The authors gratefully acknowledge the research support of the National Science 
Council, Taiwan under grant number NSC 96-2221-E-006-264-MY3 and National 
Cheng Kung University under grant number R046.     
Use of Structural Equation Modeling to Examine the Relationships among Hydrologic Indicators, Water 
Quality, and Stream Ecosystems 
Jian-Ping Suen1, Tsung-Chi Chang1 
1Hydraulic and Ocean Engineering, National Cheng Kung University 
The variability of the natural flow regime has a strong influence on the stream ecosystems. By examining the relationships between 
stream ecosystems and hydrologic characteristics, we can understand the preference of different organisms to flow regimes. The 
development of the ecohydrological indicators is quite important to the management of ecological flow. By using principal component 
analysis (PCA) and structural equation modeling (SEM), we select the ecohydrological indicators that could express the significance 
of hydro-climate, water quality and fish species diversity. Then the logistic regression analysis model is used to examine the relation 
between fish and hydrologic indicators by using fish's present conditions. The structural equation modeling allows examination of a 
set of relationships between one or more independent variables and one or more dependent variables, so the modeler could explicitly 
capture the unreliability of measurement in the model, which in theory allows the structural relations between latent variables to be 
accurately estimated. The ecohydrological indicators selected from this research can not only provide the specific hydrologic and 
water quality information that fish requires, but also can provide the guidance for water resources authorities to achieve the goal of 
ecological restoration. 
96 年度專題研究計畫研究成果彙整表 
計畫主持人：孫建平 計畫編號：96-2221-E-006-264-MY3 
計畫名稱：河川流態於生態水資源管理之研究 
成果項目 
量化 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
國內 
論文著作 
期刊論文 1 1 100% 
篇 
 
研究報告/技術報告 0 0 100%  
研討會論文 5 5 100%  
專書 0 0 100%   
專利 申請中件數 0 0 100% 件  已獲得件數 0 0 100%  
技術移轉 
件數 0 0 100% 件  
權利金 0 0 100% 千元  
參與計畫人力 
（本國籍） 
碩士生 3 0 100% 
人次 
主要參與人碩士
生為 3人，另有許
多碩士生研究生
參與資料整理等
工作 
博士生 0 0 100% 
主要參與人碩士
生為 3人，另有許
多博士生研究生
參與資料分析等
工作 
博士後研究員 0 0 100%  
專任助理 0 0 100%  
國外 
論文著作 
期刊論文 3 3 100% 
篇 
 
研究報告/技術報告 0 0 100%  
研討會論文 5 5 100%  
專書 0 0 100% 章/本  
專利 申請中件數 0 0 100% 件  已獲得件數 0 0 100%  
技術移轉 
件數 0 0 100% 件  
權利金 0 0 100% 千元  
參與計畫人力 
（外國籍） 
碩士生 0 0 100% 
人次 
 
博士生 0 0 100%  
博士後研究員 0 0 100%  
專任助理 0 0 100%  
