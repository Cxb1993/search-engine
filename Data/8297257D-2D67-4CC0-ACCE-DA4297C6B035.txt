 2 
 
研究計畫之背景及目的  
  
由於定位服務之殷切需求與定位技術之逐漸成熟，如何建立合乎需求導向之
系統為一重要議題。本研究以二年時間，探討與建立隨時隨地均可定位之全面定
位(ubiquitous positioning)技術，期能一方面由使用者觀點出發，針對多種異質
性(heterogeneous)、間歇式(intermittent)之可供定位訊號予以有效判斷、處理、
與整合；另一方面由系統服務者觀點出發，發展符合服務品質(Quality of Service, 
QoS)之技術與系統。計畫之執行將結合法則發展、分析與實作以確切建立技術。 
 
一定位系統藉由量測特定訊號並配合內建資料以進行位置解算。定位系統藉
由感測元件接收與先置處理定位之訊號。目前可供定位之訊號相當豐富與多元。
這其中全球導航衛星系統(Global Navigation Satellite System, GNSS)利用一群
衛星提供定位與定時之資訊。於 GNSS 中，美國所發展之 GPS 已相當普及。
GPS 主要提供使用者全日全天候準確的定位訊息。其衛星星系由分布在 6 個軌
道面上衛星群所組成，GPS衛星發射的訊號包含 L1及 L2兩個載波，L1載波頻
率為 1575.42MHz，L2載波頻率為 1227.6MHz，其訊號包括用來識別與定位的
電碼及導航資料。在使用者端同時間收到 4顆以上的衛星訊號後，可進行導航定
位的計算，可得三維座標系中的座標及接收器之 GPS系統時間差，目前其定位
精度約為 10公尺。為改善 GPS定位精度與完整性，美國近年正進行 GPS近代
化(modernization)之工作，主要將改善訊號品質、增加 L2 電碼與 L5 訊號、以
確保美國於此一技術之領先。歐盟目前進行 Galileo 導航衛星計畫，將由 30 顆
中軌道衛星所組成，分布於 3 個軌道面上。和現行 GPS 相比，Galileo 有較高
的優越性；例如：衛星顆數較多、軌道位置高、提供 3組民用導航訊號以提高定
位精度…等，預計可提供 8公尺左右之即時動態單點定位精度。Galileo與 GPS
訊號具有相容與互用性，有利於利用單一接收機接收來自二不同星系之訊號。除
 4 
資訊於一體，並視訊號之取得及品質調整位置解算方式可以因應不同環境變化、
異質性訊號、間歇式量測之場合而達到隨時隨地均可定位之全面定位。 
 
軟體無線電(Software Defined Radio, SDR)由於具有可整合各種分歧的無
線通訊協定並具開發成特定應用之潛力，這幾年成為通訊界研發的重點之一。軟
體無線電的概念為『滿足不同通訊環境下的多模、多功能要求，以軟體架構為基
礎開發且具備可適性，可程式化之全數位化通訊設備』。因此，以上述概念實作，
具有可適性，且可利用軟體控制方式改變硬體特性的通訊設備，皆可廣泛視為軟
體無線電系統。伴隨高速處理器與寬頻類比數位轉換器的進展，軟體無線電系統
在技術上亦已臻成熟。無疑地，軟體無線電之架構可滿足全方位定位面臨多變訊
號之接收與處理要求；本計畫因此探討與建立軟體無線電技術，以達全方位定位。 
 
 
研究成果及說明  
 
對於採用異質性訊號之定位議題，訊號品質之過濾有相當之必要性。若將
錯誤之資訊納入整體定位計算過程則定位結果將受到誤導。以 GNSS 定位系統
為例，由於訊號相當微弱，有可能受到干擾與誤導。有關干擾之議題，本研究採
用天線陣列方式進行因應。此一部分之結果可參考附件一「Effect of Array 
Configurations on the Performance of GNSS Interference Suppression」發表
於 International Journal of Control, Automation, and Systems (Vol. 6, No. 6, 
884-893, 2008)。此一論文主要研究天線陣列之安排及分析干擾抑制之效能。 
 
誤導(spoofing)訊號對 GNSS定位亦會有相當大之影響。本計畫針對誤導訊
號之影響進行評估，結果可參考附件二「Analysis of Global Navigation Satellite 
System Position Deviation Under Spoofing」發表於 IET Radar, Sonar, and 
Navigation (Vol. 3, No. 1, 1-7, 2009)。 
International Journal of Control, Automation, and Systems, vol. 6, no. 6, pp. 884-893, December 2008 
 
884 
 
Effect of Array Configurations on the Performance of 
GNSS Interference Suppression 
 
Chung-Liang Chang and Jyh-Ching Juang* 
 
Abstract: This paper analyzes, through simulations, GNSS interference mitigation performance 
against wideband and narrowband interferences by using spatial-temporal adaptive processing 
(STAP). The mathematical analysis results demonstrate that the array configuration has a 
considerable effect on the spatial-temporal correlation function. Based on the results, different 
array configurations are presented to evaluate and observe the effect on interference mitigation. 
The analysis results are further assessed through simulations. 
 
Keywords: Antenna array, GNSS, interference mitigation, STAP. 
 
1. INTRODUCTION 
 
In recent years, the Global Navigation Satellite 
System (GNSS) has been widely used in military and 
civilian application to provide users with information 
of position, velocity, and time. Although the Global 
Positioning System (GPS) system offers some 
inherent anti-jam protection [1,2], owing to its low 
signal power from satellite, an interfering signal with 
enough power and a time/frequency signature could 
adversely affect the use of GPS signal for navigation 
[3]. It is necessary to suppress the interference well 
below the weak GPS signal.  
Throughout the years, many interference mitigation 
techniques of GPS have been developed; see, e.g., [4-
11]. However, these approaches [4-7] may be 
effective against a certain type of interferences, but 
may not be applicable to all jammers. The traditional 
adaptive antenna techniques [8-11] may ultimately run 
out of degree of freedom as the number of 
interferences increases and may be inadequate for 
wideband operation.  
Recently, the spatial-temporal adaptive processing 
(STAP) techniques have been applied to perform 2D 
(spatial and temporal domain) filtering on GPS signals 
so as to eliminate narrowband and broadband/co-
channel interferences [12-15]. Most of the adaptive 
array algorithms function along with different array 
configurations to proceed with interference mitigation 
analysis, such as Uniform Linear Array (ULA) in [14], 
Uniform Circular Array (UCA) in [10,12,13,15], and 
Uniform Rectangular Array (URA) in [9,11,16]. 
However, the performance of the adaptive antennas is 
susceptible to several factors, among which array 
configuration is an essential one, as is mentioned in 
[17]. 
In the traditional antenna systems, array configura-
tion consisting of array aperture, array elements’ 
locations and individual element pattern clearly 
illustrates the characteristics of the associated steering 
vectors, or the array manifold. For traditional narrow-
band adaptive antennas, spatial correlation coeffi-
cients play a prominent part in the output performance 
[18]. The smaller the spatial correlation between the 
desired and interference sources, the better the output 
performance. Similar to the performance analysis of 
the conventional adaptive antennas, the STAP 
performance is also influenced by the configuration of 
the employed antenna array [19,20].  
In this paper, we present the notion of spatial-
temporal correlation function, which adequately 
portrays the joint spatial and temporal correlation 
relationship between the desired user signal and the 
interference signals, as well as the influence of the 
array configuration on the output performance of 
STAP systems. Under the minimum mean square 
error (MMSE) criterion, an analytical form of the 
residual error power of array systems is obtained. We 
aim to analyze and compare various array configura-
tion effects on the associated spatial-temporal 
correlation function in interfered environ-ment. Three 
general types of equally spaced arrays are considered 
in this paper-ULA, URA, and UCA on the associated 
spatial-temporal correlation function in an interfered 
environment. The analysis results show that the array 
__________  
 Manuscript received July 19, 2007; revised February 26, 
2008; accepted June 16, 2008. Recommended by Editorial
Board member Dong-Ho Cho under the direction of Editor
Hyun Seok Yang. This work was supported by the National 
Science Council of Taiwan under grant NSC-96-2628-E-006-
246-MY2. 
 Chung-Liang Chang and Jyh-Ching Juang are with the 
Department of Electrical Engineering, National Cheng Kung
University, No. 1, University Road, Tainan 70101, Taiwan (e-
mails: ngj567.liang@msa.hinet.net, juang@mail.ncku.edu.tw).
* Corresponding author. 
Chung-Liang Chang and Jyh-Ching Juang 
 
886 
can be imposed in spatial domain or temporal domain. 
One class of these algorithms is the non-blind 
adaptive algorithm in which a training signal is used 
to adjust the array weight vector. Another technique is 
to use a blind adaptive algorithm which does not 
require a training signal. Still another is semi-blind 
adaptive algorithm in which the desired signal 
information can be obtained by inertia navigation 
system. In this section, a general non-blind adaptive 
algorithm based on conventional least-squares 
solution [20] is investigated for the weight 
coefficients of antenna array. The output of the STAP 
system is: 
( ) ( ),Hy k k= w x  (4) 
where w denotes the spatial-temporal weight vector 
and can be described as  
[
]
11 1 12 2
1 .
N N
H
M NM
k w k w k w k w k
w k w k
=w( ) ( ) ( ) ( ) ( )
( ) ( )
 
 
 (5) 
In this case, both w and ( )kx  are 1NM ×  
column vectors. Under the minimum mean square 
error criterion, the optimal weights of STAP system is 
the attempt to minimize the cost function 
{ }2( ) ( ) ( ) ,J k E d k y kτ= − −  (6) 
where ( )d k τ−  denotes the local replica, and 0τ ≥   
is the delay sample that is selected to output the best 
performance. {},E ⋅  is the expectation value, and 
⋅  denotes a Euclidean norm of a vector. The 
optimal adaptive weights computed through the 
adaptive array algorithms are multiplied by each 
corresponding measurement data and summed up 
altogether to give the output for acquisition/tracking 
modules. The optimal weight vector, optw , that 
maximizes the signal to interference plus noise ratio 
(SINR), satisfies the matrix Weiner-Hopf [20] 
1
,opt dx
−
=w M r  (7) 
where NM NMC ×∈M  is the signal plus interference 
plus noise auto-correlation matrix, which is guaran-
teed to be positive definite and NMdx C∈r  is cross-
correlation vector.  
In practice, the auto-correlation matrix M in (7) 
cannot be known a priori since it counts on the signal 
environment. Due to the unknown statistics of the 
interference, M must be determined adaptively from 
the data, which is thus mathematically equivalent to 
substituting sample estimate Mˆ  in (8) for M. 
1ˆ ( ) ( ) ( ),Hk k k
L
=M X X  (8) 
and the cross-correlation vector is computed as 
1
ˆ ( ) ( ) ( ),dx k k k
L
τ= −r X d  (9) 
where 
( ) [ (1 )], (2 ), , ( 1) ], 0,1, ,k kL kL k L k= + + + =X x x x 
,K  denotes the input data block which contains L 
snapshots of the input data vector and is used in the 
kth iteration. Where K is the number of iterations 
required for the algorithm to converge, and ( )k τ−d  
is the local replica data vector. The estimate weight 
vector can also be written as  
1ˆ ˆ( 1) ( ) ( )dxk k k
−
+ =w M r  (10) 
Some may find that equation (10) is very similar to 
(7). However, in (10), ˆ ( )kM  is an estimate of the 
correlation matrix of the input data vector, computed 
over the kth data block containing L snapshots of the 
input data vector, and ˆ ( )dx kr  is an estimate of the 
cross-correlation between the local replica and input 
data vector. It is called time coherent block adaptive 
beamforming [9,16] and the new weight vector is 
updated in accordance with  
( ) ( 1) (1 ) ( ),k k kµ µ= − + −w w w  (11) 
where µ  is a variable between 0 and 1 that is chosen 
to minimize the output variance .Hw Mw  It is 
assumed that the angle of arrival (AOA) of GPS 
signal inside the received data is known exactly. 
Therefore, with an attempt to increase the speed of 
antenna array weight coefficients to converge, the 
initial weights can be obtained by the following: 
2
(0) ,
opt
sr
opt
=
w
w
w
 (12) 
where optw  is the optimal weight in (7). From (6), 
the output square error power under the MMSE 
criterion of the system is obtained as 
1
min =1 =1 .
H H
dx dxξ
2 −
− −w Mw r M r  (13) 
In practice, one hopes to output the residual error 
power as small as possible to improve the STAP 
system performance. Signals are processed through 
the same non-blind array algorithm under three 
different array configurations. We then observe which 
array configuration can best upgrade system perfor-
mance. The output signal-to-interference-plus-noise 
ratio after adaptation is given by 
1010log ,
H
dd
H
SINR =
w R w
w Mw
 (14) 
where 2+Hdd dd dd nσ=R r r I  is the desired signal 
Chung-Liang Chang and Jyh-Ching Juang 
 
888 
1
, ,
0
( 1) ( ) ,
1, , ,
d d j j
M L
H
dj j
m
P k l m
j j
ϕ θ ϕ θ
+ −
=
 = − −
 
=
∑ a a d s

 (21) 
where djP  denotes power of spatial-temporal cross-
correlation. The relationship between Hdx ddr r  and the 
above correlation functions can be specified by the 
following: 
2 2 2
2 2 2
1 1
2 2
22
1
(0) ( 1) ( 1)
( ) (0) ( )
(0) ( )
( ) ( ) .
j j
j
H
dx dd
ds ds ds
ds d d
dN dN
NL L
ds dj
k L j k L
F F k F k
F k L F F k L
F F k L
F k F k
=− = =−
= + + − + + +
+ + + + + + +
+ + + +
= +∑ ∑ ∑
r r
 
 

 (22) 
From (20)-(22), it is observed that the spatial 
correlation 
, ,
,
d d s s
H
ϕ θ ϕ θa a  and , , ,j j j j
H
ϕ θ ϕ θa a  1,j =  
, j are important terms which can only be altered in 
any time-invariant environment. It is known that 
, ,d d j j
H
ϕ θ ϕ θa a  and , ,d d s s
H
ϕ θ ϕ θa a  depend on the 
configuration of the employed antenna array, which 
includes the distribution of antenna element positions, 
orientations, and antenna patterns. The smaller 
, ,d d j j
H
ϕ θ ϕ θa a  and , , ,d d s s
H
ϕ θ ϕ θa a  the smaller 
( )dsF k  and ( )djF k , so that the smaller ,
H
dx ddr r  
and thus the smaller the residual error power, which 
leads to the better STAP performance. The same 
analysis results can also be applied in the scenario of 
multiple satellites. 
 
3.3. Antenna array manifold vector model 
From the above analysis, the better performance of 
the adaptive antenna under STAP can be obtained 
under the array configuration where Hdx ddr r  is 
minimized. The basic array configuration model 
consists of two parts, the element pattern and the 
pattern of the array with the actual elements replaced 
by isotropic point sources, namely array factor. The 
entire pattern of the array is the product of element 
pattern and the array factor. It consists of N omni-
directional elements, equally/unequally distributed at 
the observation angle ( , )ϕ θ , as shown in Fig. 1(a). 
Figs. 1(b)-(d) shows several examples of planar arrays 
that are of interest. The input is a plane wave 
propagating in the direction with temporal frequency. 
θ
x
y
z
ρ
h
u
ϕ
      
x
y
z
 
(a) Antenna array with plane wave input.         (b) ULA. 
 
x
y
z
      
x
y
z
 
(c) UCA.           (d) URA. 
Fig. 1. Antenna array cartesion coordinate system and examples. 
Chung-Liang Chang and Jyh-Ching Juang 
 
890 
temporal processing under various array configura-
tions. 
To verify the performance improvement, three same 
STAP systems are constructed on the three array 
configurations with 5 taps in each array channel. Note 
that MMSE value is the average result of 50 different 
simulations, based on the prerequisite of the same 
numbers and types of interference. The SINR im-
provement versus array configurations is summarized 
in Table 3. The SINR improvement is defined as the 
difference between the output SINR and input SNR. 
The residual error power under the MMSE criterion 
for ULA in Scenario 1 is 9.1742− dB, whereas 
11.1892− dB for UCA, and 12.0821− dB for URA. 
The residual error power under the MMSE criterion 
for ULA in Scenario 2 is 10.9711− dB, whereas 
11.8892− dB for UCA, and 14.1551− dB for URA. 
The average results clearly show that the use of URA 
can improve array output performance better than 
other array configurations. The effect of the number of 
time delay taps on interference mitigation is also 
analyzed. From Fig. 5, we see that, as expected, 
adding temporal taps does indeed improve the SINR. 
As can be seen from Fig. 5, the SINR improvement is 
always modest if five or more taps are employed in 
first scenario and eight or more taps are required in 
scenario 2, respectively. Nevertheless, the more the 
tap numbers, the longer the system computation time 
( 2O[( ) ]NM ) and conver-gence time. In this paper, 
five taps are adopted for analysis. 
Observe that the use of URA leads to the SINR 
improvement. In Figs. 6 and 7, the performance result 
for the signal correlation under different array 
configurations is shown. We plot the amplitudes of 
( )dsF k  and ( )djF k  in Figs. 6 and 7 for scenario 1 
and scenario 2, respectively. The results demonstrate 
that there are no discernible difference of the 
correlation function peak from its correct location at 
zero code phase offset in Figs. 6(a) and 7(a), 
respectively. Even in the presence of several strong 
wideband or narrowband interferences, there is not a 
drastic broadening of the correlation function. This 
result meets the expectation for very large tracking 
errors. Small code tracking errors are defined by the  
Table 3. Antenna element N = 9 and M = 5. 
SINR improvement (dB) (average value) 
 
ULA UCA URA 
Scenario 1 38.6 40.8 42.2 
Scenario 2 41.8 42.3 44.1 
MMSE Criterion (dB) (average value)  
ULA UCA URA 
Scenario 1 –9.1742 –11.1892 –12.0821 
Scenario 2 –10.9711 –11.8892 –14.1551 
 
 
(a) Beam pattern for Scenario 1 (ULA): 4WBI, 1NBI.
 
(b) Beam pattern for Scenario 2 (ULA): 4NBI, 1WBI.
Fig. 2. Antenna array pattern response.  
 
(a) Beam pattern for Scenario 1 (UCA): 4WBI, 1NBI.
 
(b) Beam pattern for Scenario 2 (UCA): 4NBI, 1WBI.
Fig. 3. Antenna array pattern response. 
Chung-Liang Chang and Jyh-Ching Juang 
 
892 
shift and variance of the correlator in S-curve 
position. Figs. 6(b) and 7(b) tell the fact that under 
URA, the sidelobe levels of the associated correlation 
functions are reduced in comparison with that of other 
array configuration. Therefore, the increase in pseudo-
range error is limited. 
In addition, we attempt to add antenna numbers to 
observe its effect on STAP performance. To satisfy the 
square configuration of URA, 16 as well as 25 
antennas are also adopted to proceed with simulation, 
the results of which are shown in Figs. 8(a) and (b). 
These figures illustrate that adding antenna 
numbers does enhance STAP performance. It is also 
shown that the URA configuration in general has a 
better performance in interference mitigation. 
However, to constitute a URA configuration, the 
antenna numbers are confined to 2 2× , 3 3× , 4 4× , 
etc, as opposed to ULA and UCA. When the antenna 
number and cost are to be considered, the UCA 
configuration appears to yield a better balance. 
 
5. CONCLUSIONS 
 
In this paper, a non-blind STAP is adopted for 
interference mitigation. A criterion function is 
developed to assess the STAP performance in various 
array configurations. The performance improvement 
of the STAP system based on different array 
configurations is analyzed. Also, the associated 
spatial-temporal correlation function through 50 
different simulations of GPS orbit in interfered 
environment under various array configurations is 
assessed and compared. The performance of the STAP 
system is illustrated via computer simulations in 
scenarios with WBI, NBI, and noise. The presented 
approach can serve as a tool in assessing the antenna 
array configuration design in interference mitigation. 
The analysis discussed in this paper is based on the 
prerequisite of equal spacing of each antenna. In the 
future, we will focus on the scenario of unequal 
spacing and design the best array configuration to 
reduce the effect of cross-coupling and interference. 
Future researches will also address the generalization 
of the proposed approach to account for the mitigation 
of multipath effect in positioning and attitude 
determination [23]. 
 
REFERENCES 
[1] E. D. Kaplan and C. J. Hegarty, Understanding 
GPS: Principle and Application, 2nd ed., Artech 
House, Boston, USA, 2006. 
[2] B. W. Parkinson and J. J. Spilker, Global 
Positioning System: Theory and Applications, 
American Institute of Aeronautics and 
Astronautics, Washington, USA, 1996. 
[3] P. Ward, “Effects of RF interference on GPS 
satellite signal receiver tracking,” in E. D. 
Kaplan (ed.) Understanding GPS: Principles 
and Applications, Artech House, Norwood, USA, 
pp. 209-236, 1996. 
[4] J. J. Jr. Spilker and F. D. Natali, “Interference 
effects and mitigation techniques,” in B. W. 
Parkinson et al. (eds.) Global Positioning 
System: Theory and Applications, American 
Institute of Aeronautics and Astronautics, 
Washington, USA, pp. 717-772, 1996. 
[5] C. L. Chang, J. C. Juang, and Y. L. Tsai, 
“Development of neural network-based GPS 
anti-jam techniques,” Proc. of CACS Automatic 
Control Conf., Changhua, Taiwan, pp. 1076-
1081, March 2004. 
[6] J. W. Ketchum and J. G. Proakis, “Adaptive 
algorithm for estimating and suppressing 
narrow-band interference in PN spread-spectrum 
systems,” IEEE Trans. on Communications, vol. 
30, no. 5, pp. 913-924, April 1982. 
[7] J. C. Juang, C. L. Chang, and Y. L. Tsai, “An 
interference mitigation approach against 
pseudolite,” Proc. of the International 
Symposium on GNSS/GPS, pp. 144-156, Sydney, 
December 2004. 
[8] D. J. Moelker, E. van der Pol, and Y. Bar-Ness, 
ULA
UCA
URA
-25
-20
-15
-10
-5
0
                
N  = 9                       N = 16                      N = 25
                 
Antenna elements (N )
M
M
S
E
 (
d
B
)
Scenarios 1
(a) Scenario 1. 
ULA
UCA
URA
-25
-20
-15
-10
-5
0
                
N  = 9                       N = 16                      N = 25
                 Antenna elements (N )
M
M
S
E
 (
d
B
)
Scenarios 2
(b) Scenario 2. 
Fig. 8. MMSE in dB. 
Published in IET Radar, Sonar and Navigation
Received on 7th October 2007
Revised on 10th June 2008
doi: 10.1049/iet-rsn:20070153
ISSN 1751-8784
Analysis of global navigation satellite system
position deviation under spooﬁng
J.-C. Juang
Department of Electrical Engineering, National Cheng Kung University, Tainan, Taiwan, Republic of China
E-mail: juang@mail.ncku.edu.tw
Abstract: The position deviation in global navigation satellite system (GNSS) positioning, which is subject to
spooﬁng, is analysed. A spoofer transmits GNSS-like signals to a navigation receiver and may cause a
signiﬁcant position deviation in navigation computation. Although GNSS receivers can be equipped with
certain receiver autonomous integrity monitoring (RAIM) schemes to provide fault detection and isolation
functions, it is possible that the misleading information because of spoofers may enter a GNSS receiver
without being detected. As spoofers may inject erroneous pseudo-range measurements to the navigation
receiver with a false message, it is important to assess the spooﬁng effect on the resulting position. An
optimisation approach is adopted to determine the worst-case misleading message and the resulting position
deviation. A vulnerability index against spooﬁng is deﬁned for the assessment of the position deviation in a
spoofed environment.
1 Introduction
The global navigation satellite system (GNSS) positioning
is known to be vulnerable to interference because of the
long distance of travel of the radio signal and the resulting
low signal power. In the presence of interferences or
spooﬁng, the GNSS navigation performance is likely to
be degraded and the navigation function may even
be incapacitated. Throughout the years, many GNSS
interference mitigation techniques have been developed
[1, 2]. A challenge in GNSS interference mitigation is that
a wide class of interferences needs to be considered. These
interferences range from wide-band noises, narrow-band
continuous waves, frequency modulated interferences,
pulsed-type interferences, to pseudo random noise (PRN)-
type interferences. Among these interferences, PRN-type
interferences originating from pseudolites or reradiators
manifest themselves as GNSS-like signals, bearing the
same frequency, format and code modulation as legitimate
GNSS signals. In some navigation applications, pseudolites
can be used to enhance accuracy and availability [3, 4].
However, when these devices are used in an adverse
manner, they may spoof GNSS receivers. In the celebrated
report [5], it is stated that ‘A spoofer also can defeat nearly
all anti-jamming equipment.’ Existing mitigation methods
against spoofers rely on the veriﬁcation of navigation
messages, successive cancellation [6, 7] and antenna array
techniques [8, 9].
Given that the PRN-type interferers or spoofers are
difﬁcult to detect and resist, it is of interest to assess the
worst-case position/time deviation when a GNSS receiver
is subject to hazardously misleading information from such
kinds of devices. Essentially in a radio-based navigation
system, a set of transmitters broadcast ranging signals to
the receiver for the latter to determine the position and
time of the broadcast signals. A spoofer tries to augment
the existing system with a ranging measurement in a form
similar to that of the navigation system, so that the receiver
will also utilise the augmented signal for position ﬁxation.
As the augmented signal is subject to misleading
information, the resulting navigation accuracy is affected
and the navigation function may be denied. In the paper,
an optimisation method is employed to determine the
worst-case misleading message of a spoofer to lead a
GNSS receiver astray. It is shown that the worst-case
position error can be expressed as a product of the range
residual and a geometry-related factor. The geometry-
related factor which is termed as the vulnerability index
against spooﬁng (VIAS) reveals the geometric relationship
IET Radar Sonar Navig., 2009, Vol. 3, No. 1, pp. 1–7 1
doi: 10.1049/iet-rsn:20070153 & The Institution of Engineering and Technology 2008
www.ietdl.org
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:14 from IEEE Xplore.  Restrictions apply. 
biased to result in a position deviation in a deterministic sense.
Hence, the absolute value (inﬁnity-norm) of the range residual
condition (6) is more relevant in the analysis as it directly relates
the parameters associated with the spoofer, namely c and d and
that associated with the navigator, that is, g. The threshold g is
hereafter termed as the RAIM level. Finally, some constraints
are further imposed on the vector c. For example, the vector c
is required to satisfy
vTc  a (7)
for some given vectorv and scalara. Suppose that the vectorv is
in the zenith direction, this constraint is to reﬂect the practical
elevation masking of the receiver in ruling out measurements
from satellites at low-elevation angles.
Note that the spoofer is capable of adjusting c and d to
lead to the maximal position deviation. Deﬁne the
weighted norm kx12 x0kW is deﬁned as kx1  x0kW ¼p
((x1  x0)TW (x1  x0)) where W is a positive deﬁnite
weighting matrix. The analysis of the worst-case position
deviation can be stated in terms of the following
optimisation problem
max
c,d
kx1  x0kW (8)
subject to (5)–(7). Before solving the problem (8), it is noted
that the objective function kx12 x0kW can be expressed in
terms of the unknown variables c and d more explicitly.
Indeed, certain manipulations by taking the difference
between (2) and (4) reveal that the position deviation
vector x12 x0 can be expressed as
x1  x0 ¼ GTG  GTe(eTe)1eTG
 1
 c  GTe(eTe)1
 
d  cTx1  b1
 
(9)
Let
Q ¼ GTG  GTe(eTe)1eTG
 1
W GTG  GTe(eTe)1eTG
 1
(10)
and
c0 ¼ GTe(eTe)1 (11)
The square of the weighted position deviation becomes
kx1  x0k2W ¼ (d  cTx1  b1)2  (c  c0)TQ(c  c0) (12)
The expression also separates the roles of c and d. The
weighted position deviation is a product of the range
residual error jd  cT1 x1  b1j and a geometry-related factorp
((c  c0)TQ(c  c0)). It is clear that the worst-case
scenario occurs when the false measurement d is selected so
that jcTx1 þ b1  d j ¼ g and the false position vector c is
determined such that (c  c0)TQ(c  c0) is maximised.
The problem for the determination of the optimal c, thus,
becomes
min
c
 (c  c0)TQ(c  c0) (13)
subject to (5) and (7). Note that the vector c0 in (11) can
indeed be expressed as c0 ¼ (1=n)
Pn
i¼1 gi, that is, it is the
average of the unit-length observation vectors in the
unperturbed system. The optimization formulation (13) can
then be interpreted as the ﬁnding of the unit-length vector
c within a cone speciﬁed in (7) to deviate from c0 as much
as possible in terms of the weighted norm of Q. In the
following, the problem (13) will be solved. Introducing
the Lagrange multipliers m and h, the Hamiltonian for the
optimisation problem is formulated as
H ¼ (c  c0)TQ(c  c0) m(1 cTc) 2h(vTc  a)
(14)
Let the optimal vector c and Lagrange multipliers be denoted
by c, m and h, respectively. The Karush–Kuhn–Tucker
conditions [13] for optimality are
@H
@c

c
¼ Q(c  c0)þ mc  hv ¼ 0 (15)
together with (c)Tc ¼ 1, vTc  a, m  0, h  0 and
h(vTc  a) ¼ 0. In particular, the optimal c can be
solved from (14) as
c ¼ (mI Q)1(Qc0  hv) (16)
where I is the identity matrix. To ensure that the minimum of
(13) is reached, the matrix mI 2 Q is required to be positive
deﬁnite. The expression (16) is then substituted into the
remaining equations for the determination of the optimal
m and h. The solution to the problem depends on
whether the equality vTc ¼ a is met. If vTc . a, the
optimal value of h becomes h ¼ 0 and the variable m is
solved from (c)Tc ¼ 1 or
cT0Q(m
I Q)2Qc0 ¼ 1 (17)
On the other hand, if the condition vTc ¼ a becomes active,
the optimal m and h are the solutions to the following
simultaneous equations
(Qc0  hv)T(mI Q)2(Qc0  hv) ¼ 1 (18)
and
aþ vT(mI Q)1(Qc0  hv) ¼ 0 (19)
IET Radar Sonar Navig., 2009, Vol. 3, No. 1, pp. 1–7 3
doi: 10.1049/iet-rsn:20070153 & The Institution of Engineering and Technology 2008
www.ietdl.org
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:14 from IEEE Xplore.  Restrictions apply. 
simulation, the location of Tainan, Taiwan is selected as the
area of interest. Based on GPS YUMA almanac, the
observation matrix in a period of 1 day (1 October 2007)
can be computed. Suppose that the weighting matrix W is
given by W ¼ C ecefenu
1 0 0
0 1 0
0 0 0:5
2
4
3
5C enuecef where C enuecef is the
coordinate transformation matrix from the earth-centred
earth-ﬁxed (ECEF) coordinate frame to the east-north-up
(ENU) coordinate frame and Cenuecef the transpose of C
enu
ecef .
The selection of the weighting matrix implies that more
emphasis is on the position deviation in the horizontal plane
than in the vertical direction. At any particular time instant,
the distribution of the GPS satellites can be obtained and,
henceforth, the worst-case vector c that could potentially
lead to a signiﬁcant position error can be determined by
solving the optimisation problem (13). In the optimisation
problem, the elevation mask is set as 100 and the vector v is
along the local zenith direction. Fig. 1 depicts the VIAS in
(21) for a period of twelve hours. The VIAS varies as a
function of the distribution of observable satellites. At those
instants when the VIAS is at its peak, the spoofer is more
effective in creating a large position deviation. The position
dilution of precision (PDOP) is also illustrated in the ﬁgure.
Not surprisingly, the VIAS is somehow correlated with the
PDOP which means that when the satellite geometry is
relatively good, it is more difﬁcult to divert the positioning
solution.
Within this period, the peak VIAS is 2.7520 (marked by a
circle in Fig. 1) which occurs at around 22 o’clock. Fig. 2
depicts the GPS satellites/spoofer sky plot at this time
instant. In this ﬁgure, six satellites are observable which are
marked by circles with PRNs 2, 4, 10, 12, 13 and 17,
respectively. The spoofer transmits a GPS-like signal that
bears a false position vector c at the location as marked by a
pentagon symbol (S letter) in the ﬁgure. The 10-degree
elevation mask is depicted using a dashed line. The spoofer
reports its false position vector at a low-elevation angle in an
attempt to shift the balance of satellite distribution. To
assess the position deviation, both the nominal case and
perturbed case are simulated 100 times in which a zero-
mean random noise with standard deviation of 4 m is added
to the pseudo-range measurement. The false measurement
d is biased in accordance with (26) and the RAIM level is
selected as 33 m. The computed position in the horizontal
plane is depicted in Fig. 3 and the position error is
generated without violating the RAIM constraint in (6).
To see how the VIAS varies at different locations on the
Earth, the VIAS map at the aforementioned time instant is
presented in Fig. 4. At some locations, the VIAS is very
large which implies that the area is susceptible to spooﬁng.
In the ﬁgure, the maximal VIAS (.20) occurs at longitude
2788 and latitude 2548. The corresponding sky plot of the
GPS/spoofer constellation at this position and time is
illustrated in Fig. 5. There are four observable GPS
satellites, all at relatively high elevation. Yet, the injection
of a low-elevation spoofer in the depicted direction may
lead to a devastating position error.
Since the VIAS map is related to the GNSS constellation,
the VIAS analysis approach is applied to the Galileo
constellation to assess the susceptibility of the system
against spooﬁng. In this analysis, the 30-satellite Galileo
Figure 1 VIAS and PDOP
Figure 2 Sky plot of the GPS satellites and spoofer
Figure 3 Position deviations in the nominal and perturbed
cases
IET Radar Sonar Navig., 2009, Vol. 3, No. 1, pp. 1–7 5
doi: 10.1049/iet-rsn:20070153 & The Institution of Engineering and Technology 2008
www.ietdl.org
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:14 from IEEE Xplore.  Restrictions apply. 
[5] Volpe National Transportation Systems Center:
‘Vulnerability assessment of the transportation
infrastructure replying on the global positioning system’.
Report for U.S. Department of Transportation, 2001
[6] MADHANI P.H., AXELRAD P., KRUMVIEDA K., THOMAS J.:
‘Application of successive interference cancellation to the
gps pseudolite near-far problem’, IEEE Trans. Aerosp.
Electron. Syst., 2003, 39, pp. 481–488
[7] JUANG J.C., CHANG C.L., TSAI Y.L.: ‘An interference mitigation
approach against pseudolite’. Proc. Int. Symp. GNSS/GPS,
2004
[8] MCDONALD K.F., RAGHAVAN R., FANTE R.: ‘Lessons Learned
through the implementation of space-time adaptive
processing algorithms for GPS reception in jammed
environments’. Proc. IEEE PLANS, 2004
[9] JUANG J.C., CHANG C.L.: ‘Performance analysis of GPS
pseudolite interference mitigation using adaptive spatial
beamforming’. Proc. Institute of Navigation, Annual
Meeting, 2005
[10] MISRA P., ENGE P.: ‘Global positioning system – signals,
measurements, and performance’ (Ganga-Jamuna Press,
Lincoln, 2006, 2nd edn.)
[11] HOFMANN-WELLENHOF B., LICHTENEGGER H., COLLINS J.: ‘GPS:
theory and practice’ (Springer, New York, 2001, 5th edn.)
[12] SC-159: ‘Minimum operational performance standard
for airborne equipment using global positioning system/
wide area augmentation system’. RTCA/DO-229C,
Washington DC, 2001
[13] NOCEDAL J., WRIGHT S.J.: ‘Numerical optimization’
(Springer, 1999)
[14] JUANG J.C.: ‘On GPS positioning and integrity
monitoring’, IEEE Trans. Aerosp. Electron. Syst., 2000, 36,
pp. 327–336
IET Radar Sonar Navig., 2009, Vol. 3, No. 1, pp. 1–7 7
doi: 10.1049/iet-rsn:20070153 & The Institution of Engineering and Technology 2008
www.ietdl.org
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:14 from IEEE Xplore.  Restrictions apply. 
SHEN et al.: SOIL MOISTURE ESTIMATION BY REFLECTED GPS SIGNALS WITH GROUND TRUTH MEASUREMENTS 731
Fig. 1. System block diagram.
Fig. 2. Measurement system for the estimation of soil moisture and roughness.
depicts the block diagram of signal processing in which two
different types of antennas are used to receive dual-frequency
GPS signals. The computational process first determines the
position of the two antennas, deduces the reflection point,
and then estimates the reflectivity of the reflecting surface. A
representative ground truth measurement is illustrated in Fig. 2,
in which an RHCP antenna is used to receive direct line-of-
sight GPS signals, and three LHCP antennas are used to receive
the reflected signals [9]. The opposite polarization of the two
antenna sets is due to the fact that the GPS signals are RHCP,
and as a result, the reflected signals become LHCP. As the
reflected signals are bounced from the surface, the soil moisture
and roughness will affect the signal quality. The measurement
principle is thus to deduce the reflectivity and soil moisture by
processing the collected direct and reflected signals. Relevant
descriptions of the setup and results of using the combined
Authorized licensed use limited to: National Cheng Kung University. Downloaded on March 25, 2009 at 01:15 from IEEE Xplore.  Restrictions apply.
SHEN et al.: SOIL MOISTURE ESTIMATION BY REFLECTED GPS SIGNALS WITH GROUND TRUTH MEASUREMENTS 733
height of the reflection surface after correction hground can be
obtained. An alternative way to obtain hground is as follows:
hground =
hRHCP + hLHCP
2
− hundulation (2)
where hundulation is available from the output of the GPS
receiver. Both methods yield similar results that compare well
to the ground-based measurements of the ground height and
reflection surface level.
The surface roughness parameter (DISP) is defined as the
ratio of the surface height standard deviation to the length of
the reflected footprint, i.e.,
DISP = standard deviation of hground
length of reflected footprint . (3)
The DISP will be used in the following for the estimation of
soil moisture.
C. Reflectivity and Ground Object Detection
The GPS signal reflection or scattering by an object depends
on the surface roughness and electrical properties (conductivity
and emissivity) of the reflecting material. Indeed, different
materials including dry ground (grass), wet ground (different
composition of sand, silt, and clay), trees and forest, fresh
stream water, ocean water bodies, road, and concrete may give
different reflectivities [1], [3]. The surface reflectivity , which
is defined as the ratio of reflected power to direct power [5],
can be used for the classification of ground object. In Dinesh
Manandhan, the resultant reflection coefficient is shown to be
the sum of the copolar and cross-polar reflection coefficients.
Let Γ0 and Γx be, respectively, the copolar and cross-polar
reflection coefficients, and the resultant reflection coefficient
Fc is Fc =
√
Γ20 + Γ2x. As the GPS signals are circularly po-
larized, the reflection coefficient is indeed a function of the
elevation angle from the receiver to the satellite. This coefficient
is denoted as Fc and can be computed once the elevation angle
is known, giving the form Fc(EL), where EL is the elevation
angle from the receiver to the satellite. In the case when the
satellite image of the area is available, it is possible to index
the object using red–green–blue (RGB) intensity so that the
coefficient Fc is also a function of the RGB color classification.
The surface reflectivity  is related to the reflection coefficient,
the power ratios between reflected and direct signals, and a
correction factor due to the surface property. More precisely,
the surface reflectivity is expressed as
 = (SNR)r −Nr
(SNR)d −Nd · Fc(EL) · F (mv, DISP,%sand,%clay)
(4)
where (SNR)r and (SNR)d are the signal-to-noise ratios of
the reflected and direct signals, respectively. The two terms
Nr and Nd, respectively, represent the noise level along the
path of reflected and direct paths, which are also functions of
the LHCP and RHCP antennas and channels. The correction
factor F (mv, DISP,%sand,%clay) is used to model the soil
roughness effect and soil content. Letting l be the emissivity
of soil moisture and ε′ the dielectric constant, it is known that
[18] the two terms are related via l = 1− |1−
√
ε′/1 +
√
ε′ |2.
The dielectric constant, however, is a function of soil moisture
mv and composition of the reflecting surface, which is charac-
terized in terms of sand and clay contents in percentage of dry
weight of soil, represented by %sand and %clay, respectively.
Further, the correction factor F (mv, DISP,%sand,%clay) can
be expressed as
F (mv, DISP,%sand,%clay) =
1− l
exp(DISP) . (5)
It is further remarked that in reflected GPS signal processing,
there are multiple observations that can simultaneously be
measured. As a result, with respect to each satellite, the local
height hground, roughness DISPi, and reflectivity ij can be
obtained. The superscript i may be used hereafter to denote
the relevant term with respect to the ith satellite. In addition,
the term may be a function of the frequency. Hereafter, the
subscript j is used to stand for different frequencies.
The discussions thus far are briefly summarized using the
flowchart in Fig. 4. As depicted, the positions of the RHCP
and LHCP antennas are first computed. This is followed by
an altitude loop that relies on DTED data to obtain a refined
estimate of the reflection point and reflectivity. When the satel-
lite image can be brought to bear, a ground object detection
index can further be obtained. Consequently, the soil reflection
coefficient, roughness effect, emissivity, and dielectric constant
are computed. Finally, the soil moisture mv and soil content are
computed. The last step in the computation of soil moisture and
soil content relies on a model-based approach. More precisely,
the relationship between soil moisture and dielectric constant
is established based on a set of controlled experiment data.
Accordingly, the reflectivity can then be used to deduce soil
moisture and dielectric constant.
D. Ground Truth Measurement
The process for the establishment of a model is described
in the following. A set of soil samples is collected and placed
in a controlled experiment setup, as depicted in Fig. 2. The
soil sample is textually a sand loam soil, with a composition
within the topsoil of 51.5% sand, 10.3% clay, 38.2% silt, and a
bulk density ρbulk of 1.91 kg · m−3. The mass of water content
mg and the volumetric of soil moisture mv depend on the dry
density of soil ρbulk, wet density of soil ρwet, weight of wet soil
Wwet, and weight of dry soil Wdry. The relationship between
mv and mg is [16], [18]
mv =
ρbulk
ρwet
mg =
ρbulk
ρwet
Wwet −Wdry
Wdry
. (6)
In the measurement, six planes of samples with different
soil moistures are prepared, and the parameters and deduced
variables for ground truth measurement for soil moisture are
presented in Table I. The dielectric constant ε′ is assumed to be
Authorized licensed use limited to: National Cheng Kung University. Downloaded on March 25, 2009 at 01:15 from IEEE Xplore.  Restrictions apply.
SHEN et al.: SOIL MOISTURE ESTIMATION BY REFLECTED GPS SIGNALS WITH GROUND TRUTH MEASUREMENTS 735
Fig. 5. Reflected area and receiver position at NCKU.
A. Roughness Results
The first experiment is conducted at the top floor of a building
at the National Cheng Kung University (NCKU). As shown in
Fig. 2, the GPS L1/L2 dual-frequency antennas are mounted
on a 0.7-m-high steel pipe on the planes, and it is able to
change its horizontal angle. Every 1–2 h, the GPS integrated
receiver system takes a measurement at the soil moisture planes
at different vertical angles (from 20◦ to 80◦ with no spacing
between 0 and 1 for each reflected GPS observations). For
the GPS L1/L2 dual-frequency integrated receiver system, it is
considered that the emissivity depth of soil is in the range of
2–6 cm, depending on the soil dielectric properties. As there are
six planes in total, the measurements are separately processed
to give the surface roughness DISP effects on the dielectric
constant of soil moisture with six different planes at different
volumetric of soil moisture. Fig. 5 depicts the reflection point
and receiver position at a specific epoch of measurement. The
length of reflected footprint for PRN 13 is 0.40 m, the standard
deviation of height for PRN 13 is 0.098 m, and consequently,
the surface roughness of soil moisture for PRN 13 reflected
point DISP13 = 0.098/0.40 = 0.245, which is like a roughness
surface. Similarly, the surface roughness of ground truth mea-
surement for PRN 23 is DISP23 = 0.0987/0.45 = 0.219, and
the surface roughness of ground truth measurement for PRN 25
is DISP25 = 0.0989/0.48 = 0.206. The surface roughness es-
timates based on this ground truth measurement for PRN 13,
PRN 23, and PRN 25 are rough surface. This analysis is
consistent with the soil samples that are used in the experiment.
Another experiment, which is an uncontrolled one, is con-
ducted over the Lon-Ann Bridge over Dar-Jar stream. This is
illustrated in Fig. 6. Again, as depicted in Fig. 4, the reflection
point with respect to each observable satellite is computed
based on the collected dual-frequency direct and reflected GPS
measurements. In this experiment, the length of the reflected
Fig. 6. Reflected footprint for PRN 27, PRN 28, and receiver positions on Lon
Ann Bridge.
footprint for PRN 27 is 75.5 m, and the standard deviation of
altitude for PRN 27 is 2.58 m, giving the surface roughness
of stream soil moisture for PRN 27 reflected point DISP27 =
2.58/75.5 = 0.034, which implies that the reflection is from a
smooth surface. In addition, the length of the reflected footprint
for PRN 28 is 350.2 m, the standard deviation of altitude
is 2.56 m, and the surface roughness of the reflected point
becomes DISP28 = 2.56/350.2 = 0.007. This also indicates
that the reflection of PRN 27 is from a smooth surface. In Fig. 6,
the reflection points of PRN 27 and PRN 28 are indeed from the
stream. Hence, the analysis of roughness can indeed be used to
estimate the type of reflection surface.
B. Soil Moisture Results
In the following, the reflectivity and soil moisture results
are presented based on the analysis of the aforementioned
two experiments. Fig. 7 depicts a comparison of reflectivity
versus soil moisture and surface roughness for measurements at
Lon-Ann Bridge (PRNs 27 and 28) and NCKU (PRNs 13,
23, and 25). The reflectivity for PRN 28 (281 = 0.10−0.25)
is larger than the reflectivity of PRN 27 (271 = 0.05−0.10).
The reflectivity dependent on the elevation angle EL28 = 20◦
of PRN 28 is not the same as the elevation angle EL27 =
60◦ of PRN 27. The reflectivity from stream soil moisture
with smooth surface DISPi = 0.007−0.034 and volumetric
water (mv: 13.5%–26.7%) of soil moisture is the same as
the reflectivity of the ground truth measurement. The specific
plottings of reflectivity 281 = 0.35−0.45 for PRN 28 and
271 = 0.10−0.17 for PRN 27 are from stream water.
The ground truth measurement derived the reflectivity
251 = 0.09−0.16 of PRN 25 that is lower than the reflec-
tivity 131 = 0.15−0.22 of PRN 13. However, the reflected
angle EL13 = 37◦ of PRN 13 is the same as the reflected
Authorized licensed use limited to: National Cheng Kung University. Downloaded on March 25, 2009 at 01:15 from IEEE Xplore.  Restrictions apply.
SHEN et al.: SOIL MOISTURE ESTIMATION BY REFLECTED GPS SIGNALS WITH GROUND TRUTH MEASUREMENTS 737
[17] Z. Y. Chang, B. P. Iliev, J. F. de Groot, and G. C. M. Meijer, “Extending
the limits of a capacitive soil–water-content measurement,” IEEE Trans.
Instrum. Meas., vol. 56, no. 6, pp. 2240–2244, Dec. 2007.
[18] J. Behari, Microwave Dielectric Behavior of Wet Soil. New York:
Springer-Verlag, 2005, ch. 1-2, pp. 7–38. copyright with Anamaya,
New Delhi, India.
Lie-Chung Shen (M’06) received the B.S. degree
from Chung Cheng Science and Institute University,
Lon-Tan, Taiwan, in 1983 and the M.S. degree from
the National Central University, Chung-Li, Taiwan,
in 1990. He is currently working toward the Ph.D.
degree with the Department of Earth Science, Na-
tional Chung Kung University, Tainan, Taiwan.
Jyh-Ching Juang (S’80–M’82) received the B.S.
and M.S. degrees from the National Chiao Tung
University, HsinChu, Taiwan, in 1980 and 1982,
respectively, and the Ph.D. degree in electrical engi-
neering from the University of Southern California,
Los Angeles, in 1987.
He was previously with Lockheed Aeronautical
System Company, Burbank, CA. Since 1993, he
has been with the Department of Electrical Engi-
neering, National Cheng Kung University, Tainan,
Taiwan. His research interests include sensor net-
works, GNSS signal processing, and software-based receivers.
Ching-Lang Tsai received the B.S. degree from
Taiwan University, Taipei, Taiwan, in 1969.
He is currently a Professor with the Department
of Earth Science, National Cheng Kung University,
Tainan, Taiwan.
Chia-Chyang Chang received the B.Sc. degree
from Chung Cheng Institute of Technology (CCIT),
Taoyuan, Taiwan, the M.Sc. degree from the Na-
tional Cheng Kung University, Tainan, Taiwan, and
the Ph.D. degree in space geodesy from the Univer-
sity of Nottingham, Nottingham, U.K., in 1995.
He was a Full Professor with the Department of
Surveying and Mapping Engineering, CCIT, and the
Department of Information Management, Yuda Uni-
versity, Miao-Li, Taiwan. Since 2007, he has been
with the Department of Applied Geomatics, Ching
Yun University, Chungli, Taiwan. His research interests include satellite navi-
gation, geodetic monitoring, mobile positioning, and location-based services.
Ping-Ya Ko received the B.S. degree from Chung
Cheng Institute of Technology, Taoyuan, Taiwan, in
1983, the M.S. degree from the National Taiwan
University, Taipei, Taiwan, in 1988, and the Ph.D.
degree in aeronautics and astronautics from Stanford
University, Palo Alto, in 2000.
He is currently the General Director of the Mate-
rials and Electro-Optics Research Division with the
Chung Shan Institute of Science and Technology,
Taoyuan. His research interests include system en-
gineering, system integration, GPS/INS integration,
and electrooptical system integration.
Ching-Liang Tseng received the B.S. and M.S.
degrees from the National Cheng Kung University
(NCKU), Tainan, Taiwan, in 1968 and 1971, re-
spectively, the M.S. degree from The Ohio State
University, Columbus, in 1975, and the Ph.D. degree
from the University of South Australia, Adelaide,
SA, Australia, in 2001.
He is currently with NCKU, where he was a Pro-
fessor and the Head of the Department of Surveying
Engineering and is currently a Professor with the
Department of Earth Science and the Director of the
Satellite Geoinformatic Research Center.
Authorized licensed use limited to: National Cheng Kung University. Downloaded on March 25, 2009 at 01:15 from IEEE Xplore.  Restrictions apply.
IEEE Transactions on Consumer Electronics, Vol. 55, No. 2, MAY 2009 328 
using an RF front-end module which is responsible for signal 
amplification, noise filtering, down conversion, automatic 
gain control, and analog-to-digital conversion. The front-end 
module renders digital IF data at a rate of several mega Hz 
even though the incoming GNSS signal is in L band (1~2 
GHz). The digital IF data, typically 1 or 2 bits, are then 
processed by a baseband processor whose roles include 
correlation, signal acquisition, code and carrier tracking, and 
data demodulation. The demodulated data and resulting 
pseudorange measurements are then processed by a navigation 
processor to yield position, velocity, and timing information. 
Indeed, most existing consumer GPS receivers involve two 
chips for signal reception: one is the RF front-end chip for 
signal conditioning and conversion and the other is the 
baseband chip for the handling of correlation/tracking and 
navigation tasks. A software receiver differs from a 
conventional receiver in the sense that the functions of the 
baseband chip including correlation/tracking and navigation 
tasks are realized through software, leading to a more flexible 
design with potential savings in cost and power. Fig. 1 depicts 
the hardware architecture of a typical software GNSS receiver.  
 
 
Fig. 1. Hardware architecture of a software GNSS receiver 
 
At NCKU, a software GPS receiver based on Fig. 1 has 
been developed. In this software receiver, the front-end 
module is the GPS Signal Tap [6] which contains two main 
blocks: RF down-converter and data buffer. The RF down-
converter convert GPS signal to low IF signal at 15.42 MHz. 
The IF signal is then sampled at 4.096 MHz and digitized into 
1-bit data stream. The data buffer stores the digitized IF data 
temporarily before sending to the host computer through a 
USB interface for tracking and navigation processing. In the 
software GPS receiver, a personal computer (PC) running at 
2.4 GHz is used to realize the receiver functions. The host 
computer fetches the data routinely and performs the 
acquisition, tracking, and navigation tasks. The software flow 
chart of the software GPS receiver is shown in Fig. 2. Once 
the software is started, parameters are initialized. The 
parameters include the filter coefficients, selections of 
tracking schemes, variables pertaining to the setting of 
tracking channel, initial estimates of position and time, 
almanac, and ephemeris, if possible. After the initialization, 
the software enters an indefinite loop in which a block of data 
from the front end is obtained and processed. As the sampling 
frequency is set as 4.096 MHz, a 128-msec-long data is 
received on every request. The signal data are then correlated 
with local replica in the software correlator. To realize the 
correlator function in software, tables of code and carrier are 
provided and stored [3]. The code table has totally 16368 
phases in C/A code period. For each phase, code table is made 
for 1 millisecond long. The number of total phase influences the 
accuracy of pseudorange and memory size. Carrier table is made 
to span ±10 kHz Doppler frequency with spacing of 100 Hz. In 
each frequency, the carrier table has zero phase in the beginning 
of table. The code phase and carrier frequency could be set 
before the correlation operation between the incoming data 
block and the data from the memory. The bit-wise operation 
processes 32 input samples simultaneously and makes the real-
time operation possible. The correlation results are fed to 
another part of receiver, the tracking-to-navigation procedure. 
 
 
Fig. 2. Flow chart of the software GPS receiver 
 
In the GPS software receiver, the tracking-to-navigation 
procedure facilitates the functions of acquisition, tracking, 
data demodulation, pseudorange measurement, and position 
fixing. In the open-source software [7], some of these 
functions are described. In the software receiver, specific 
features are developed to meet the real-time requirement and 
unique characteristics of the software correlator. Details of the 
tracking procedure in this processing chain are discussed in 
the following subsection.  
 
B. Tracking procedure 
The tracking procedure is controlled by a state machine as 
shown in Fig. 3. In the un-modified software GPS receiver, 
the tracking operation is decomposed into the following four 
states: acquire, confirm, pull-in, and lock. The acquire state 
performs a search in the dimensions of Doppler frequency and 
code phase to detect the presence of GPS signals. As long as 
the magnitude of any correlators is greater than a pre-
determined threshold, the operation then enters the confirm 
state. In the confirm state, an M of N detector is used to 
confirm whether the signal is present. Once the signal is 
detected, the operation then enters the pull-in state. In the 
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:15 from IEEE Xplore.  Restrictions apply. 
IEEE Transactions on Consumer Electronics, Vol. 55, No. 2, MAY 2009 330 
and 
( )
( ) ( )
1
ˆ[ ] 2 cos( )cos
ˆ2
         = sinc cos [ ]
2 2
k
k
t
S t
ii
S
Q k P t t dt
TPT
k
ω φ ω
ω ω θ
−
= +
−⎛ ⎞⎜ ⎟⎝ ⎠
∫
 
where the phase [ ]S kθ  is ( ) ( ) 1ˆ ˆ[ ] 2 iS k
T
k t
ω ωθ ω ω φ−−= + − − . 
Note that that phase difference between [ ]RS kθ  and [ ]S kθ  is 
 
( )
1
ˆ ˆ
ˆ[ ] [ ]
2
R i
S RS k
T
k k t
ω ωθ θ θ ω −−Δ = − = +  
The phase difference is affected by the rounding error in the 
frequency table and an offset due to frequency estimate. When 
the frequency estimate is available, the phase error can be 
compensated through the rotation operation; for otherwise, the 
phase tracking loop may be subject to phase discrepancy 
between two integration intervals. When the phase rotator is 
employed, the traditional carrier tracking loop can be used to 
track the frequency and phase of the incoming signal. 
 
When the incoming signals are locked, the pseudorange 
measurements can be obtained and, when there are more than 
four satellites being locked, the position of the receiver can be 
calculated.  
 
III. DATA INTERMITTENCY 
A. Issues of intermittent data 
In a software GNSS receiver, the digital IF data are 
buffered in the front end module. Upon request from the host 
computer, the buffered data are sent to the host computer for 
acquisition, tracking, and navigation processing. Since the 
host computer of a mobile device may be busy with some 
high-priority applications or the bus may be occupied by other 
data transfer flows, the data for GNSS applications are subject 
to burst-type errors in which blocks of data are lost as 
depicted in Fig. 5. Such a data intermittency phenomenon may 
affect the tracking procedure discussed in the previous section. 
Indeed, when a block of data is lost, the tracking operation 
cannot continue as the peak of the correlator output is no 
longer maintained. As a result, whenever a data intermittency 
occur, the tracking operation returns to the acquire state and 
the navigation capability is greatly compromised. In GPS 
signal tracking, the frequency, carrier phase, and code phase 
need to be locked. Typically, data intermittency may not lead 
to a significant variation on the frequency. However, both 
carrier phase and code phase are affected. In addition, as the 
data are decoded based on continuous tracking, the navigation 
data may then be subject to bit error. With the availability of 
A-GNSS techniques, the data decoding issue can be resolved. 
Therefore, the challenge lies in the seamless tracking of 
carrier phase and code phase. 
 
Note that when a block of data is lost, all tracking channels 
which are tuned to lock different satellites are equally affected. 
The inter-channel information can then be explored for the 
detection of data intermittency. Once the phenomenon is 
detected, it is desired to resume the tracking as soon as 
possible without going through the states of acquire, confirm, 
and pull-in. To this end, the intra-channel information reveals 
a way for the correction in carrier phase and code phase. By 
exploring the inter-channel and intra-channel information, the 
lock state can be recovered rapidly.  
 
 
Fig. 5.  Data intermittency 
 
B. Processing of intermittent data 
The proposed tracking procedure that is capable of 
accommodating data intermittency is depicted in Fig. 6. In the 
tracking procedure, a new recover state is included to recover 
the tracking performance in the presence of data gaps. The 
operations at the recover state include a detection scheme and 
a re-lock mechanism. When each channel has been visited, the 
tracking status of all channels that are in lock state can be 
assessed. When there are multiple channels that are subject to 
performance degradation such as drop of correlator output (of 
the prompt correlator) and increase of code/phase tracking 
error simultaneously, it is likely that the incoming signal is 
subject to either a signal blockage or data intermittency 
problem. The operation of the tracking software then enters 
the recover state.  To verify whether the problem is due to 
data intermittency, a correlator operation is performed by 
placing the local code replica at d  chips advance from the 
previous code phase. The advance in chips d  is related to the 
size of data block and can be computed as follows. Suppose 
that the size of the data block is N  bits and the sampling 
frequency is sF  Hz (or bit/sec), then each data block 
corresponds to a period of g
s
NT
F
=  in sec. Let cT  be the 
GNSS code chip length, Lf  be the carrier frequency, and ˆDf  
be the Doppler frequency of the channel, then the advance of 
chips of the code phase for re-lock is given by 
 
ˆ
1 gD
L c
Tfd
f T
⎛ ⎞= +⎜ ⎟⎜ ⎟⎝ ⎠
 
When a correlation operation is performed at the advanced 
position and a peak correlation value is obtained, it is likely 
that the tracking disruption is due to data intermittency. By 
cross-checking the results of different channels, the 
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:15 from IEEE Xplore.  Restrictions apply. 
IEEE Transactions on Consumer Electronics, Vol. 55, No. 2, MAY 2009 332 
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 3
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 13
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 25
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 27
 
Fig. 8.  Code phases of the original approach 
 
0 100 200 300
2.09
2.095
2.1
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 3
0 100 200 300
2.22
2.225
2.23
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 13
0 100 200 300
2.175
2.18
2.185
2.19
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 25
0 100 200 300
2.37
2.375
2.38
2.385
2.39
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 27
 
Fig. 9. Pseudorange measurements of the original approach 
 
0 50 100 150 200 250 300
0
50
100
150
200
250
300
Time (sec)
Lo
ca
l T
im
e 
(s
ec
)
 
Fig. 10. Local time of the original approach 
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 3
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 13
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 25
0 100 200 300
0
341
682
1023
Time (sec)
C
od
e 
P
ha
se
PRN 27
 
Fig. 11. Code phases of the proposed approach. 
 
0 100 200 300
2.095
2.1
2.105
x 107
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 3
0 100 200 300
2.226
2.228
2.23
x 107
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 13
0 100 200 300
2.18
2.185
2.19
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 25
0 100 200 300
2.375
2.38
2.385
2.39
x 10
7
Time (sec)
P
se
ud
or
an
ge
 (m
)
PRN 27
 
Fig. 12. Pseudorange measurements of the proposed approach. 
 
0 50 100 150 200 250 300
0
50
100
150
200
250
300
Time (sec)
Lo
ca
l T
im
e 
(s
ec
)
 
Fig. 13. Local time of the proposed approach. 
 
V.  CONCLUSION 
In the paper, a method is developed to account for data 
intermittency in a software GNSS receiver. For mobile 
applications with a software GNSS capability, the issues of 
data intermittency cannot be neglected. As the impact is 
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:15 from IEEE Xplore.  Restrictions apply. 
IEEE JOURNAL OF SELECTED TOPICS IN SIGNAL PROCESSING, VOL. 3, NO. 4, AUGUST 2009 651
Phase/Frequency Tracking in
a GNSS Software Receiver
Jyh-Ching Juang, Member, IEEE, and Yu-Hsuan Chen
Abstract—In the paper, a software-based technique for the
tracking of frequency and phase of Global Navigation Satel-
lite System (GNSS) signals is proposed. It is shown that a
software-based receiver with precomputed, zero-phase carrier
replicas for phase tracking is subject to phase jump in phase
tracking and ambiguity problems in frequency estimation. A
phase/frequency tracking architecture is proposed in which the
frequency of the incoming signal is estimated based on a lead-lag
structure which is similar to a traditional delay locked loop and
the phase, after de-rotation, is estimated using a frequency-aiding
phase locked loop. The effects of thermal noise and resolution-in-
duced noise are analyzed and verified using simulation. The
significance of frequency aiding in enhancing the phase tracking
response is also described.
Index Terms—Frequency-locked loop, GNSS, phase-locked loop,
software-based receiver.
I. INTRODUCTION
T HE reception of Global Navigation Satellite System(GNSS) signals is essentially a synchronization task in
which the receiver generates replicas in code and carrier phase
of the same format and modulation as the incoming signals so
that through some controls over the replica generation mecha-
nism, the replicas are aligned with the incoming signals. The
operation of a GNSS receiver has been extensively discussed in,
e.g., [1]–[3]. Recently, the concept of software defined radio has
been advocated as a means for the transmission and reception
of radio signals [4], [5]. In particular, several software receiver
approaches have been reported for the reception of GPS signals
[6]–[10]. A GNSS software receiver is advantageous in terms of
flexibility and reconfigurability. It also posses certain potential
in extracting weak signals and accommodate multipath when
unique signal processing techniques are employed. However,
a software receiver needs to implement routine tasks such as
code/phase generation and correlator using software, which
may consume some computation and data storage resources.
As a result, some modifications in the tracking system are
needed for a software receiver to account for unique features
and limitations.
Manuscript received July 01, 2008; revised April 14, 2009. Current version
published July 17, 2009. This work was supported by the National Science
Council, Taiwan, under Grant NSC 96-2628-E-006-246-MY2. The associate
editor coordinating the review of this manuscript and approving it for publica-
tion was Dr. Mohamed Sahmoudi.
The authors are with the Department of Electrical Engineering, National
Cheng Kung University, Tainan 701, Taiwan (e-mail: juang@mail.ncku.edu.
tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JSTSP.2009.2023832
In the reception of a GNSS signal, a correlater-based receiver
architecture in which local replicas of code and carrier are gen-
erated and mixed with the incoming signal before integration
is typically employed [1]–[3]. When the correlation operations
are accomplished in terms of software, it is essential to ensure
that the processing capability can accommodate the high-rate
data stream of the incoming signal in a real-time receiver. If
the processing speed is not far superior to the incoming data
rate, a block processing technique is often used. Using a block
processing technique to implement a correlator-based receiver,
the local replicas are not generated on the fly, rather they are
precomputed and stored in the memory. Techniques of efficient
code generation for GPS software receiver have been discussed
in [11]. Methods for software-based correlation processing are
also available; see, e.g., [12], [13]. A correlation operation is
equivalent to the summation and mixture of some blocks of data
samples and local replicas. In this scheme, the carrier table is
often designed to be of zero-phase to relax the overall memory
requirement. It turns out that the use of zero-phase replicas may
lead to difficulties in phase/frequency tracking. More precisely,
between two consecutive integration (correlation) periods, there
exists a phase jump which depends on the frequency of the in-
coming signal. The phase jump resembles a ramp input to the
receiver, leading to difficulties in phase tracking. Moreover, the
frequency cannot be estimated by taking the difference between
the phases of two consecutive integration periods. The lack of
frequency information may make the tracking loop sensitive to
parameter variation and noise. Another issue in relevant to the
use of carrier table is related to the resolution in frequency. The
limit in frequency resolution may result in frequency jitter. Nat-
urally, the finer the frequency resolution of the carrier table, the
smaller the jitters in frequency and phase estimates. However, a
fine resolution also implies a significant amount of memory. It
is thus desired to assess the effect of resolution-induced error in
carrier table on the resulting phase and frequency tracking error.
The paper proposes a phase/frequency tracking technique
that is suitable for software-based receiver in receiving GNSS
signals. Discussions on phase-locked loops (PLLs) and fre-
quency-locked loops (FLLs) can be found in many comprehen-
sive books, e.g., [14]–[16]. To account for the aforementioned
phase jump phenomenon, a different phase/frequency tracking
scheme is proposed in the paper. The tracking architecture
comprises three parts: an FLL that resembles a delay-locked
loop in code tracking is used for frequency tracking, a PLL
that relies on phase rotation to avoid rapid phase jumps, and
a frequency-aiding controller that feeds-forward frequency
information into the PLL to enhance tracking performance.
The significances of the proposed tracking architecture are as
follows.
1932-4553/$26.00 © 2009 IEEE
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:10 from IEEE Xplore.  Restrictions apply. 
JUANG AND CHEN: PHASE/FREQUENCY TRACKING IN A GNSS SOFTWARE RECEIVER 653
Fig. 1. Discontinuities in local replica result in phase ambiguities.
are also zero mean. Further,
.
Observe that the phase of the correlator output in (5)
contains three terms that are related to the input frequency ,
frequency estimation error , and input phase , respectively.
It is the first term that may impose some challenges in
the design of phase/frequency tracking loops. More precisely,
as the phase replicas are of zero-phase, between two integra-
tion intervals, the replicas are subject to a phase jump, forcing
the correlator output (5) to experience phase variation. Recall
that the phases at two consecutive integration intervals are given
by and
, respectively. Even when ,
, and , the resolved phase in the phase
tracking loop experiences a jump between
two consecutive integration intervals. The phase jump, as noted,
is a function of the frequency and time interval, and may affect
the phase tracking performance. Additionally, such jumps also
make it difficult to estimate the frequency based on phase differ-
ence. This phenomenon is illustrated in Fig. 1 in which a pure
sinusoidal input waveform is correlated with zero-phase local
cosine and sine replicas. As a result, the in-phase and quadra-
ture-phase correlator output components are subject to varia-
tions which may then lead to difficulties in phase tracking and
frequency estimation. It is remarked that the code tracking loop
is not subject to this phenomena since the integration period
is often selected to be a multiple of the code period and the dis-
continuities in code replica is not observed.
To overcome the aforementioned limitations, a phase/fre-
quency tracking architecture is proposed. The architecture is
shown in Fig. 2. Roughly, the system contains an FLL and a
PLL with the operation of the latter depending on signals of
the former. To obtain a reliable estimate of the frequency, three
replicas are indeed generated to correlate with the incoming
signal. These replicas differ in their frequency settings. In ad-
dition to the nominal frequency estimate , two other carrier
replicas at frequencies and are also generated
and correlated with the incoming signal. The correlator that
operates on is termed as the lead correlator and that
operates on is named as the lag correlator. In the above,
is the frequency offset between the nominal correlator and
Fig. 2. Proposed phase/frequency tracking architecture.
the lag correlator. It will be shown that by using the lead and
lag correlators, a frequency discriminator can be constructed,
similar to the noncoherent detector in a delayed locked loop
in code tracking, and the frequency can be tracked. As the
phase experiences rapid variations, a phase rotator is used to
compensate for the rotation and, consequently, a reliable phase
error can be obtained for phase tracking. In addition, a signal is
injected from the FLL to the PLL through the frequency-aiding
controller. It will be shown that the injection signal plays a
significant role in resolving phase ambiguities and stabilizing
the PLL.
III. DESIGN AND ANALYSIS OF THE TRACKING LOOP
In this section, the proposed phase/frequency tracking archi-
tecture will be analyzed. As both FLL and PLL are feedback
system, the performance aims are to ensure that the system re-
mains stable with the desired steady-state error, fast and accu-
rate tracking response, and acceptable noise response. The pro-
posed phase/frequency tracking architecture will be shown to
be capable of tracking the frequency and phase. The effects due
to thermal noise and resolution-induced noise will be analyzed.
The roles of design parameters such as frequency resolution and
correlator spacing (in frequency) will also be investigated. Fi-
nally, the design of the frequency-aiding controller will be de-
scribed.
A. Frequency Locked Loop
The FLL comprises two sets of correlators, a frequency dis-
criminator, a loop filter, a controlled oscillator, and a carrier
table. The two sets of correlators, as described previously, differ
in the frequencies of the local replicas. As the frequency setting
of the nominal (prompt) correlator is , the two sets of cor-
relators attempt to correlate the incoming samples with carrier
replicas at frequencies and , respectively. The
frequency discriminator provides a frequency error signal based
on the difference of the two correlator outputs. The frequency
error signal is then passed to the loop filter and a filtered fre-
quency error signal is generated which is then used to adjust
the controlled oscillator. The output frequency of the controlled
oscillator is denoted by , which may be different from the fre-
quency used in carrier look-up table, , by some resolution-in-
duced error. Once is obtained from through a quantization
process, the sinusoidal components at frequencies ,
and are looked-up from the carrier table.
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:10 from IEEE Xplore.  Restrictions apply. 
JUANG AND CHEN: PHASE/FREQUENCY TRACKING IN A GNSS SOFTWARE RECEIVER 655
Fig. 4. Normalized slope and range of the discriminator function.
(or ) at zero can be evaluated by substituting (8)–(14) into
(18) and, after some tedious yet routine manipulations, shown
to be
(19)
Note that the variance is a function of the frequency spacing
. To assess the frequency tracking response and frequency
error variance of the FLL, the block diagram of the linearized
FLL is depicted in Fig. 5. In the figure, is the thermal noise
and represents the equivalent noise induced by the limita-
tion of frequency resolution in building the carrier table. The
numerically controlled oscillator (NCO) is represented in terms
of the discrete-time transfer function and is the
loop filter which is designed to achieve the desired performance.
Clearly, the frequency error depends on the frequency input
, thermal noise , and resolution-induced noise . As two
correlators are used to obtain the error signal, the analysis of the
FLL is similar to the analysis of conventional delay locked loops
[1]–[3]. From Fig. 5, the transfer function of the closed-loop
FLL can be obtained as
(20)
Let , , and be, respectively, the
transfer functions from , , and to the frequency error
. The frequency error is a superposition of the three in-
puts through the above three transfer functions. It can be
easily shown that ,
, and .
In a typical FLL design, it is desired that the steady state error
for a frequency change is zero. Let be the -transform of
the frequency input , the steady-state error requirement can
be stated as
(21)
Fig. 5. Block diagram of the linearized FLL.
provided that the system is closed-loop stable. Suppose that the
input frequency is a step, the steady-state performance require-
ment can be achieved when for some satisfying
. Should a ramp frequency change be to be
tracked, a higher order filter can be similarly designed.
In addition to closed-loop stability and steady-state error, it is
also desired that the variance of the tracking error be minimized.
Two noise responses, from and , respectively, need to be
considered. Assume that the thermal noise and the resolution-
induced noise are independent, the variance of the frequency
error can be expressed as
(22)
In the above, is the 2-norm of the transfer function
which can be evaluated through the contour integral
Let be the noise bandwidth of the FLL, the 2-norm of
is known to satisfy
(23)
where is the dc-gain of which is 1 when the
steady-state error requirement is satisfied. As both the slope of
the FLL discriminator function and the variance of the
discriminator output have been derived in (17) and (19),
respectively, the variance of due to the thermal noise, i.e., the
first term on the right-hand side of (22), can be written as
(24)
where
(25)
and
(26)
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:10 from IEEE Xplore.  Restrictions apply. 
JUANG AND CHEN: PHASE/FREQUENCY TRACKING IN A GNSS SOFTWARE RECEIVER 657
Fig. 7. Block diagram of the linearized PLL.
designed to ensure that the resulting phase tracking error vari-
ance is minimized without sacrificing the tracking response. It
can be derived that the closed-loop transfer function from the
input to the output is
(36)
Without abusing of notion, the -transform of the phase error
can be expressed as
(37)
From the FLL, the frequency error and frequency output
depend on frequency input , resolution-induced noise ,
and equivalent thermal noise , the phase error can further be
rewritten as shown in (38) at the bottom of the page. The ex-
pression (38) indicates that the phase error depends on the fre-
quency input , phase input , and three noise terms. The
first two terms on the right-hand side of (38) are related to com-
mand responses. It is desired that the phase error be minimized
in the presence of frequency or phase input command. The fre-
quency-aiding injection controller can be used to shape
the command response. Indeed, from (38), with respect to a fre-
quency input, the phase error is not only governed by the dy-
namics of the PLL, i.e., , but also by a shaping filter
of the FLL, i.e.,
. Essentially, the shaping filter will not alter the sta-
bility, the dynamic response, however, may be affected. In par-
ticular, the frequency-aiding controller can be designed to
speed up the response of the PLL. This injection can be impor-
tant when considering the inherent tradeoff between noise atten-
uation and dynamic response requirements. Typically, the noise
bandwidth of the PLL is designed to ensure that the extent
of noise can be well regulated. A narrow bandwidth implies that
the variance of the phase tracking error is reduced. However,
the dynamic response for phase tracking may become sluggish
when the bandwidth is narrow. For a software receiver, the slope
of the ramp input may be very large, the tradeoff becomes more
severe. With the introduction of the frequency aiding controller,
a better balance can be achieved. A design example of will
be provided in the next subsection.
From (38), the variance of the phase tracking error can be
regarded as the combined effect due to the three noise terms
, , and . A rough estimate of the variance is shown in
(39) at the bottom of the page. The first two terms on the right-
hand side of (39) can thus be regarded as the phase jitter due
to thermal noise. In contrast, the last term is due to resolution-
induced noise. Substituting (35) and (36) into the first term on
the right-hand side of (39), the variance of the phase error due
to can be shown to be
(40)
(38)
(39)
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:10 from IEEE Xplore.  Restrictions apply. 
JUANG AND CHEN: PHASE/FREQUENCY TRACKING IN A GNSS SOFTWARE RECEIVER 659
TABLE I
SIMULATION PARAMETERS
Fig. 9. Frequency error as a function of   .
second example is to demonstrate the use of frequency-aiding
controller in enhancing the dynamic response of the system. The
pertinent parameters in the simulation are listed in Table I.
Recall that the frequency and phase tracking loops are sub-
ject to phase jumps between two consecutive time instants. This
phase jump is likely to yield an error in frequency estimation
should the frequency estimate be obtained by taking the differ-
ence between two consecutive phase estimates. The rapid vari-
ation of phase may also cause difficulties in phase tracking.
The proposed FLL is capable of correctly estimating the fre-
quency based on the discriminator output between two nearby
frequency estimates. Fig. 9 depicts the estimated and simulated
standard deviation of the frequency error with respect to dif-
ferent . The simulation results are obtained by running
100 Monte Carlo simulations. The mean of the standard devia-
tions of frequency error samples is marked by red dots and the
bound of the deviations is also depicted. For comparison, the
analytic results on frequency error due to thermal noise and res-
olution-noise which are computed using (24) and (27), respec-
tively, are also provided. The simulation results are essentially
consistent with the analytic results. It is observed that the res-
olution-induced noise dominates when is high; in com-
parison, the thermal noise effect results in a bigger error when
is low. It is also noted that the extent of variations in the
simulation results is relatively large when is high because
that the resolution-induced noise is essentially uniformly dis-
tributed. When is decreased, the thermal noise begins to
dominant and the extent of variations is reduced. When
is very low, the extent of variations increases slightly.
The proposed FLL/PLL architecture is capable of not only
providing a frequency estimate but also tracking the phase.
Fig. 10. Phase error as a function of   .
Fig. 10 shows the simulation and analytic results of the phase
error. The simulation results are obtained in a similar fashion
as those in the FLL. Three analytic results are plotted for com-
parison purpose. The one with “Thermal Noise 1” corresponds
to the summation of the first two terms on the right-hand
side of (39). The plot with “Thermal Noise 2” is obtained
from (42). Finally, the resolution-induced noise is the third
term on the right-hand side of (39). The limit in frequency
resolution of the carrier table would have some impacts on
the resulting phase jitter especially when is high. The
effects of thermal noise are inversely proportional to .
Hence, at a low , the phase jitter is induced primarily by
the thermal noise. The analytic result (42) is also shown to be
less conservative, and indeed, more accurate in predicting the
resulting phase jitter due to thermal noise.
The second simulation is to illustrate the use of frequency-
aiding in enhancing dynamic response. To visualize the effect
of this frequency-aiding controller, the following loop filters
and aiding controller are used: ,
, and . In this example,
the FLL is of first-order and the PLL is of second-order. The
parameter is determined so that the noise bandwidth of
the FLL is 2 Hz as in Table I. Similarly, the two parameters
and are determined so that the noise bandwidth of
the PLL is 8 Hz and the damping ratio of the PLL is 0.707.
To simulate the effect of the frequency-aiding controller in the
nonlinear FLL/PLL, the effect of resolution-induced noise and
thermal noise are not considered. It is assumed that at Epoch
200, the frequency input is subject to a step change of 10 Hz.
The FLL/PLL is thus required to accommodate this frequency
change with acceptable excursion of phase. The simulation re-
sults are depicted in Fig. 11. The FLL is capable of tracking this
frequency change as depicted in the upper portion of the figure.
The frequency responses are essentially the same whether the
frequency-aiding controller is used. There are significant dif-
ferences in the phase tracking responses. Indeed, when the fre-
quency-aiding controller is not employed, the PLL enters a long
pull-in process before the phase can finally be stabilized. In con-
trast, when the frequency aiding controller is used, the phase is
stabilized much more rapidly. The effectiveness of the proposed
Authorized licensed use limited to: National Cheng Kung University. Downloaded on September 1, 2009 at 22:10 from IEEE Xplore.  Restrictions apply. 
 出席 2008年 International Symposium on GPS/GNSS 會議報告 
 
莊智清 
成功大學電機工程系 
 
本次於日本東京台場舉行的 International Symposium on GPS/GNSS (全球導
航衛星系統國際會議)為衛星導航定位領域之一重要會議。此一年一度之會議一
般於亞太地區舉辦但參與此一會議之學者專家則來自世界各地。本年度會議日期
由 2008年 11月 11日至 11月 14日。本人於 11月 10日中午乘高鐵至桃園，由
桃園國際機場飛抵日本東京。11月 11-14日出席會議並與各國與會學者專家討論
研究議題。這期間並於 11月 13日上午與學生共同發表論文，題目為"Blending of 
MSAS and GAGAN for Regional SBAS Implementation"。 11月 15日由東京飛回
桃園機場再經高鐵回到台南。 
 
此次於日本東京舉行之會議，與會者近 450人，出席人員來自日本、美國、
俄羅斯、義大利、韓國、中國大陸、台灣等。第一天上午主要舉行 CGSIC會議，
各國代表針對 GNSS之發展進行會報。隨之於下午進行數場專題演講，題目與主
講人分別為 
Satellite Navigation: Past, Present, and Future. Prof. Per Enge, Stanford University 
GNSS-Performance Revolution. Prof. Gerard Lachapelle, University of Calgary 
Out on the Frontier. Mr. Alan Cameron, Editor-in-Chief, GPS World 
GNSS Ambiguity Resolution for Attitude Determination. Prof. Peter Teunissen, Delft Institute 
The Danger of GNSS. Prof. Borje Forssell, Norwegian University of Science and Technology 
此些主講人均為 GNSS研究與政策領域之代表人物。第二至四天則為正規議程，
議程主題包含  
1. Navigation Systems and Applications 
2. RTK-GPS and Ambiguity Resolution 
3. Multipath and Signal Interference 
4. New Products and Applications 
5. Atmospheric Effects 
Blending of MSAS and GAGAN for Regional SBAS 
Implementation 
 
Jyh-Ching Juang and Yung-Fu Tsai 
Department of Electrical Engineering, National Cheng Kung University 
Tainan, Taiwan 
 
 
BIOGRAPHY   
 
Jyh-Ching Juang received the Ph. D. degree in 
electrical engineering from University of Southern 
California, Los Angeles, in 1987. He had been with 
Lockheed Aeronautical Systems Company before he went 
back to Taiwan in 1993. Currently, he is a Professor at the 
Department of Electrical Engineering, National Cheng 
Kung University, Tainan, Taiwan. His research interests 
include DSP-based control applications, GPS navigation 
design, sensor network, and advanced signal processing.  
 
Yung-Fu Tsai is a Ph.D. student at the Department of 
Electrical Engineering, National Cheng Kung University, 
Tainan, Taiwan. His research is about the GPS signal 
processing algorithm. 
 
ABSTRACT  
 
Several space-based augmentation systems (SBAS) 
have been developed recently to augment GNSS (global 
navigation satellite system) services for enhanced air 
navigation performance. In Asia Pacific region, the 
Japanese MTSAT Satellite-based Augmentation System 
(MSAS) has been commissioned recently to broadcast 
GPS augmentation information for aviation. In addition, 
India is technically demonstrating a SBAS named 
GAGAN for augmented GPS navigation service. The 
Taipei FIR is located on the border of the service volumes 
of MSAS and GAGAN, it is thus of technical and 
operational interests to seek a synergistic integration of 
the messages provided by MSAS and GAGAN in Taipei 
FIR so as to pave a way for the future SBAS 
implementation in the region. In the paper, a fusion 
scheme is devised to blend fast, long-term, and 
ionospheric delay correction messages from MSAS and 
GAGAN. Not only the correction terms but also the 
relevant quality indicators are considered in the fusion 
process. Data analysis results of the received messages 
from two SBAS systems during a period of approximately 
2.5 months are reported in terms of the required 
navigation performance (RNP) at different phases of 
flight. The fusion scheme is assessed by collecting real 
data and the results are compared with surveyed data. 
Moreover, an adaptive strategy is proposed so that the 
spatial difference of GPS satellites between the Taipei 
FIR and two SBAS service volumes can be better 
accounted for. It is shown that the adaptive strategy can 
effectively blend the correction messages from MSAS 
and GAGAN to enhance the PA required navigation 
performance. 
 
INTRODUCTION  
 
The Global Positioning System (GPS) was 
developed, implemented, and operated by the U.S. 
Department of Defense (DoD) to provide position, 
velocity, and timing information to user worldwide [4][7]. 
GPS alone, however, doesn’t meet the accuracy, integrity, 
availability, and continuity requirements for aviation 
needs. The civil aviation organizations worldwide are 
implementing GPS or GNSS augmentation systems, such 
as SBAS (Space Based Augmentation System) [2], GBAS 
(Ground Based Augmentation System) [1], and GRAS 
(Ground Based Regional Augmentation System) [6]. 
Among these augmentation schemes, the objectives of 
SBAS are to provide improved GNSS services through 
broadcasting messages from space-based satellites to 
obtain seamless satellite navigation and positioning 
capability that could improve aviation safety and 
efficiency worldwide.  
In Asian Pacific region, Japan has been 
implementing an SBAS that broadcasts GPS 
augmentation information via the MTSAT (Multi-
functional transport satellite) [8]. In addition, India is also 
developing a SBAS named GAGAN (GPS Aided GEO 
Augmented Navigation) which is also capable of 
providing augmented navigation messages. The current 
configuration of MSAS contains eight reference stations 
and two geostationary satellites [8]. The eight reference 
stations are located, respectively, at Kobe, Hitachi-Ohta, 
Sapporo, Tokyo, Fukuoka, Naha, Hawaii, and Australia. 
The geostationary satellites, MTSAT-1R and MTSAT-2, 
were launched in 2005 and 2006, respectively. The 
MTSAT-1R is operational at 140° East and MTSAT-2 is 
operational at 145° East. The MSAS has been 
commissioned since September, 2007. The GAGAN 
system, on the other hand, is at a technology 
The fast and long-term SBAS correction messages 
contain terms for the correction of pseudorange 
measurements and correction of satellite error with 
respect to each mask-assigned satellite (Message type 1). 
The fast correction contains the range correction and 
range rate correction. The former, pseudorange correction, 
would be broadcast in the Message type 2-5/24 and the 
other could be computed from the range correction of 
different epoch. In GPS navigation, the position and clock 
time error of each satellite are computed based on 
broadcast ephemeris data for GPS [4][7][10]. SBAS 
provides corrections to the resulting satellite position and 
clock error via the long term satellite error correction 
messages (Message type 25/24). When both fast and long-
term corrections are available, it is expected that the 
aircraft can operate in non-precision approach (NPA) 
navigation mode. A major error in affecting GPS 
positioning accuracy is the ionospheric error. The SBAS 
establishes a wide-area ionospheric model to provide 
ionospheric error corrections for single-frequency user. 
The SBAS ionospheric correction messages contain the 
ionospheric grid point (IGP) masks (Message type 18) 
and ionospheric delay correction (Message type 26). The 
world-wide IGPs are divided into 11 bands and the IGP 
mask message indicates how many band masks are being 
broadcast. The IGPs as broadcast in MSAS and GAGAN 
satellites are depicted in Figure 3. In the figure, it is clear 
that, at the current stage, the broadcast IGPs are not 
overlapped. To compute the ionospheric correction for 
each pseudorange measurement, users first determine the 
location of the ionospheric pierce point (IPP) which is 
defined as the intersection segment from the receiver to 
the satellite and a thin-shell model with constant height of 
350 km. The vertical IPP delay is then computed based on 
available IGPs and the broadcast ionospheric delay term 
at each IGP. Once the vertical IPP delay is established, 
users can multiply the obliquity factor to obtain the 
ionospheric correction to be added to the pseudorange 
measurement. When ionospheric correction, as well as 
fast and long-term corrections, is used, the aircraft can 
operate in precision approach (PA) navigation mode. 
20 60 100 140 180
-60
-40
-20
0
20
40
60
The Broadcast IGPs
BAND 5 BAND 6 BAND 7 BAND 8
Longitude (deg)
La
tit
ud
e 
(d
eg
)
 
Figure 3. Broadcast IGPs of MSAS and GAGAN @ UTC 
2008/02/04 6:00 
In SBAS, the user position can then be calculated via 
a weighted least squares approach. The weighting matrix 
that is applied to the measurement equation is given by 
2
1
2
1 2
2
0 0
0 0
 
0 0 N
W
σ
σ
σ
−
 
 
 =
 
 
  


   

   (1) 
where N  is the number of GPS satellites and the variance 
2
iσ  is given by 
2 2 2 2 2
, , , ,i i flt i UIRE i air i tropoσ σ σ σ σ= + + +   (2) 
In the above, the error variance 2,i fltσ  is the fast and long-
term degradation confidence, which is the confidence 
bound on satellite clock and ephemeris corrections, 
2
,i UIREσ  is the user ionospheric range error confidence, 
which is the confidence bound on ionospheric delay 
corrections, 2,i airσ  is related to airborne receiver error 
confidence by considering noise, smoothing filter, and 
multipath, and 2,i tropoσ  is the tropospheric error confidence, 
which is the confidence bound on residual tropospheric 
error. Procedures and formulas for the determination of 
2
,i fltσ ,
2
,i UIREσ , 
2
,i airσ , and 
2
,i tropoσ  are available in [9] or [5]. 
The weighting is used not only for the determination of 
user position but also for the guarantee of performance. 
Indeed, as the variance is related to the degradation factor, 
a large variance implies the quality of navigation 
performance is degraded. The quality depends also on the 
relative geometry of observable satellites. At last, users 
can examine the performance of navigation service by 
comparing the protection level against position error in 
the horizontal plane and vertical direction using the 
triangle chart or Stanford chart. 
 
BLENDING OF MSAS AND GAGAN 
 
In Taipei FIR, SBAS correction messages can be 
received from MSAS and GAGAN. Unfortunately, the 
two messages from the two SBASs are not fully 
consistent. As a result, a fusion scheme must be 
developed should the two messages are to be used. 
Furthermore, the broadcast messages of the two SBASs 
are not complete in the sense that certain gaps exist so 
that corrections cannot be made. To remedy this 
limitation, an extrapolation/fusion approach is developed 
to establish the correction terms in the uncovered region. 
As discussed in the previous section, there are three 
correction entities that of interest, namely, fast corrections, 
long-term correction, and ionospheric delay correction. 
The former two are broadcast for each observable satellite, 
while the latter is broadcast based on the ionospheric grid 
point. The fusion schemes for these messages are thus 
different and will be discussed separately.  In this paper, a 
proposed approach, an adaptive strategy, is capable of 
low geomagnetic latitude, may be subject to severe 
ionospheric scintillation and anomalies. Compared with 
MSAS, the accuracy with the fused corrections is not 
good enough, since the spatial difference of GPS satellites 
between the Taipei FIR and GAGAN service volume. The 
correction messages broadcasted from GAGAN do not 
bestead for the Taipei FIR. To account for the discrepancy, 
an adaptive strategy must be adopted to filter the wrong 
kind of correction. 
Table 1. Accuracy of Static Tests 
Unit 
(m) SPS mode 
NPA mode 
(weighting [9]/[5]) 
  MSAS Fused 
HPE 5.22 m 4.90 / 4.62 5.06 / 4.80 
VPE 5.97 m 5.00 / 4.66 5.85 / 5.06 
 PA mode (weighting [9]/[5]) 
PA mode 
(weighting [5]) 
 MSAS Fused Adaptive Strategy 
HPE 3.67 / 3.50 3.70 / 3.54 3.45 
VPE 4.85 / 4.60 5.75 / 4.92 4.46 
In terms of the triangle chart, the horizontal position 
performance by using the two different weightings and 
fusion scheme or not is assessed. The result is depicted in 
Figure 4. A large protection level means that the SBAS 
service becomes unavailable. The variance computed in 
accordance with (10) based on the fused system would be 
small so that the protection level for the fused 
MSAS+GAGAN system is slightly smaller than the 
MSAS-only system. In NPA mode, both the availabilities 
remain 100% for the data collected in the period for both 
systems. 
 
Figure 4. Horizontal Performance in NPA mode (MSAS 
only and MSAS+GAGAN) 
The horizontal and vertical performance results in 
PA mode are depicted in Figures 5 and 6, respectively for 
the two systems. The PA availabilities of the horizontal 
and vertical performance for MSAS-only system are 
about 98.467% and 98.454%, receptively. Due to the 
reduction of variance, at certain time epoch, misleading 
information (MI) is observed, that is, it is possible that the 
position error is larger than the protection level. Recall 
that the accuracy of the fused MSAS+GAGAN system 
would not be significantly improved as shown in Table 1, 
misleading information is observed more often in the 
fused MSAS+GAGAN system. The PA availabilities of 
the horizontal and vertical performance for the fused 
MSAS+GAGAN system as depicted in Figure 6 are about 
99.23% and 99.116%, receptively. A major design 
concern of SBAS is the integrity, which is characterized 
in terms of probability of MI or HMI. Unfortunately, the 
fused scheme reduces the variance of the correction term 
to increase the availability and the probability of MI will 
increase.  
 
 
Figure 5. Horizontal/Vertical Performance in PA mode 
(MSAS-only) 
 
Figure 6. Horizontal/Vertical Performance in PA mode 
(Fused MSAS+GAGAN system) 
 
To avoid the integrity risk in the fusion of different 
SBAS, a modification on the selecting of the correct 
combination of satellites for navigation is investigated. By 
analyzing the collected data, an adaptive strategy is 
proposed to meet the PA mode navigation performance 
requirement. In Figure 6, some misleading information 
are observed which means the integrity requirement 
cannot be met. It was found that the misleading 
information mainly resulted from the distribution of the 
satellites being monitored by the MSAS and GAGAN 
reference stations and the satellites being used in Taipei 
FIR for position determination. As Taipei FIR is located 
on the border of the MSAS service region, the number of 
common-in-view satellites is limited which affects the 
resulting correction performance. Although some 
correction messages broadcasted from GAGAN can 
bestead for the Taipei FIR, Taipei FIR is far away the 
GAGAN service region. To account for the discrepancy, 
an adaptive weighting strategy is proposed. The weighting 
is based on [5], (9), and (10) with some considerations on 
the mutual observability of each satellite. 
1. With respect to those satellites that have been 
monitored with both long-term and fast correction 
messages generated, the revised weighting strategy (10) 
is used when the variance of fast and long term 
