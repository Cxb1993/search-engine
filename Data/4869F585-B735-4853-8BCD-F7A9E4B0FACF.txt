 2 
 
圖一 本子計畫與上下層子計畫關係圖。 
 
 
圖二 資料鏈結層軟體流程。 
 
軟體尚未與工研院的 DVB-T 實體層晶片整合，無
法實作時間切片功能。我們計劃於明年與實體層晶
片整合後，再完成此一功能。本年度的成果除以上
支援總計畫的資料鏈結層軟體之外，我們也設計了
另外兩個不同於規格書建議  (recommended) 的
DVB-H 資料鏈結層演算法，並評估其效能，以供業
界開發 DVB-H 接收機資料鏈結層軟硬體的參考。 
 
3、系統功能及流程 
本子計畫在整個計畫中的功能為接收子計畫
“DVB-H 網路與傳輸層軟體之開發”的指令後，向子
計畫“DVB-H 傳輸串流解碼軟體開發”的軟體要求
某一特定 Packet ID 的一個 MPE-FEC 框架
(MPE-FEC frame) 中之 sections 及其參數 (包括
MPE-FEC Frame 之列數及是否使用 MPE- FEC 編
碼 )。再經由圖二的流程後，將此框架中的 IP 
datagrams 傳到“DVB-H 網路與傳輸層軟體之開發”
子計畫的軟體。 
資料鏈結層資料軟體流程如下： 
1. 檢查 CRC 後貼上 MPE-FEC 框架。本軟體由
“DVB-H 傳輸串流解碼軟體開發”的軟體得到
sections 後，就以每個 section 尾端 4 個位元組的
CRC-32 檢查位元檢查每個 section 的正確性。如
果 section 內容正確，則依據 section 標頭內 real 
time parameters 參數域中的開始位址內容，及由
傳輸串流解碼器傳來的 MPE-FEC 框架的橫向列
數，把 section payload 從開始位址開始依序放入
MPE-FEC 框架中如圖三，並將整個 section 
payload 在擦失資訊表 (Erasure Information Table, 
EIT) 中標示成“可靠”。從 MPE 及 MPE-FEC 
sections 的標頭，資料鏈結層軟體可獲得此 MPE- 
 
圖三 MPE-FEC 框架。 
 
FEC框架中 ADT填塞行 (padding columns) 的行
數，把 ADT 中的填塞行都填上零位元組，並在
EIT 中標示為“可靠”。最後，資料鏈結層軟體把
所有 MPE-FEC 框架中尚未填入的部分在 EIT 中
標示為“抹失”。這些尚未填入部分包含那些因為
標頭位元組屬於錯誤傳輸串流封包而被丟棄的
sections，CRC-32 檢查發現錯誤的 sections，及因
為 puncturing 而沒有傳送的 RS data table 的最右
側幾個直行。整個流程中比較複雜的問題為資料
鏈結層軟體並不一定正確地收到最後一個 MPE 
section 或 MPE-FEC section，在此情況之下該如
何處理 padding 及結束一個框架的問題。我們解
決此問題後，設計出的流程如圖四。 
2. RS code 解碼：資料鏈結層將標示為“抹失”的位
元組當成抹失錯誤 (erasures) 位元組，將標示為
“可靠 ”的位元組當成正確位元組，然後對
MPE-FEC 框架中的每一橫列一一以(255, 191)里
得所羅門碼抹失解碼演算法解碼。(255, 191)里得
所羅門碼可以更正 64 個位元組的抹失錯誤。如
果一橫列中的抹失位元組少於或等於 64 個位元
組，則以里得所羅門碼抹失解碼演算法找出被抹
失的位元組，並填入 MPE-FEC 框架中，且在 EIT
中重新標示為“可靠”；如果一橫列中的抹失位元
組多於 64 個位元組，則不進行里得所羅門碼解
碼。 
 4 
 
圖六 測試資料串流。 
 
3. IP datagrams 的讀取：IP datagrams 的讀取由圖三
中的 Application data table 的右上方往下；一行一
行向左讀。每個 section payload 為一個 IP 
datagram，因此可以利用 IP datagram 標頭中記載
的 IP datagram 長度，把 IP datagrams 一個一個分
開讀出。如果遇到錯誤的 IP datagram 標頭(對應
的 EIT 為“抹失”)，則可利用通過 CRC 檢查的
section 標頭中的起始位置(在第 1 步中已經記載
下來)，重新找到一個正確的 IP datagram 的起始
位置，再繼續往下讀取 IP datagrams，其詳細流
程圖如圖五。 
本子計畫今年已經完成上述的功能，並與其它
子計畫軟體整合後，在個人電腦中的 Android 平台
執行並測試。值得注意的是，在今年計劃中，因為
尚未接上 DVB-T 實體層晶片，所以並未完成時間
切片功能。 
 
4、 驗證與測試  
 規格驗證 
本計畫利用預錄的公共電視 DVB-H 訊號及聯恩
公司的 DVB-H 測試軟體 (dvbSAM) 驗證資料鏈
結層軟體功能。驗證結果確認本軟體可以正確處
理 DVB-H 資訊。 
 外部測試 
所有子計畫依圖六的方式串接之後，依次測試
DVB-H 接收器的“開始”、“節目單解讀”、“節目選
取”、“節目播放”、及“結束”等動作。 
 內部測試 
每一個資料鏈結層的功能皆撰寫 unit test 程式，並
上傳至 subversion 系統。 
 
5、新的資料鏈結層演算法及模擬結果 
在第 3 節中所敘述的資料鏈結層軟體是依據規
格書所建議的方式設計。參考文獻 [9, 10] 的研究
結果發現，規格書中依據 CRC 檢查結果以決定整
個 section 是否正確的方法效果較差，反而使用傳輸
串流封包中的錯誤旗標 (Transport error indicator) 
來決定此傳輸串流封包的內容 (payload) 是否正確
的效果較佳。因此我們依據此利用錯誤旗標決定每
一個傳輸串流封包正確度的原則，修改 section 解封 
 
裝的方法。 
第一個演算法如下。資料鏈結層從 MPE-FEC
框架內的第一個傳輸串流封包開始解封裝。第一個
傳輸串流封包的 payload 一開始即為第一個 MPE 
section 的標頭，然後一個個傳輸串流封包的 payload
串出 sections。資料鏈結層可利用傳輸串流封包標
頭內的 Payload unit start indicator 旗標及(當旗標為
1 時的)指標位元組的內容，明確地區分出兩個
section 之間的交界位置，如此即可正確地取出每個
section 的資料。以上為所有的傳輸串流封包皆正確
(Transport error indicator 旗標為 0) 的情況下，取出
sections 的方法。如果資料鏈結層收到正確的傳輸
串流封包，資料鏈結層先判斷此傳輸串流封包是否
包含某一個 section 的標頭位元組。如果是，把在此
section 長度以內的所有正確傳輸串流封包的內容，
只要錯誤旗標為 0 的皆包入 section 中並填入
MPE-FEC 框架。不包含在正確 section 長度以內的
傳輸串流封包內容皆丟棄，直到下一個正確的
section 的標頭位元組出現為止，這是因為錯誤的標
頭位元組會導致整個 section 讀取錯誤。 
除了此演算法之外，我們又設計了另外一個解
section 封裝的演算法，稱為第二個演算法。此一演
算法與前一演算法不同的地方為某些因為錯誤的
標頭位元組而遺失了的 section，如果其資料的後面
是下一個正確 section 標頭位元組 (在正確的傳輸
串流封包內)，則這些資料可依據此正確的 section 
標頭的地址資料倒填入 MPE-FEC 框架中。圖七到
圖十分別為在不同 IP datagram 長度下 (分別為
60、200、500、及 1000 bytes)，以規格中建議的方
法  (標示為 standard) 、第一個演算法  (標示為
method 1) 、及第二個演算法 (標示為 method 2) 處
理解碼後的 IP datagram 錯誤率。由圖中可知，我們
新設計的兩種演算法，的確可以大幅改善規格中建
議的方法，我們將會於明年的計畫中，再進一步探
討這兩種新方法的優劣。 
 
6、結論 
本計畫完成 DVB-H 資料鏈結層自由軟體的撰
寫，並與 DVB-H 其它子計劃軟體整合為一個可以
在個人電腦 Android 平台上執行的 DVB-H 接收機
軟體。本軟體並以公視的訊號及聯恩的 dvbSAM 軟
體驗證成功。除了規格書建議的資料鏈結層軟體設
計方式之外，我們也設計了另外兩種不同的資料鏈
結層演算法，並以電腦模擬確認這兩種方法的確優
於原建議的演算法，值得廠商設計 DVB-H 時採用。 
 
7、計劃結果自評 
本計劃達成預期目標。如上節所述，本計劃不
但完成 DVB-H 鏈結層的軟體，與總計劃整合，並
加以驗證；另外並設計出兩個更好的鏈結層演算
法，以利技術轉移或學界的研究之用。我們最終希
望以這些結果出版期刊論文於 IEEE Transactions on 
Broadcasting。 
