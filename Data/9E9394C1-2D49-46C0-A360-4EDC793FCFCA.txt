 1
行政院國家科學委員會研究計畫成果報告 
印刷電路板 ( P C B ) 生產規劃決策支援系統之開發 - 子計劃二： 
印 刷 電 路 板 產 品 組 合 最 佳 化 規 劃 
計畫編號：NSC94-2213-E-155-004 
執行期限：93 年 8 月 1 日至 94 年 7 月 31 日 
主持人：邱昭彰   元智大學資管所 
 
印刷電路板(PCB)生產規劃決策支援系統之開發-子系統： 
印刷電路板產品組合最佳化規劃 
 
摘要 
在複雜多變的產業環境中，如何訂定適當的產品組合以期有效因應未來市場需求，一
直都是各方所關切的焦點之一。以印刷電路板（PCB）產業來說，市場需求變化預測
是依據歷史資料與人工經驗，進行下年度全年與各季的市場需求預測；往往人工預測
結果不準確，造成與實際狀況差異頗大，因此，每月必須再投入額外的人力及成本進
行市場需求微調的工作，以求切合實際市場需求。為了改善未來市場需求預測精準，
所以本研究將試圖根據各種產品組合之模型，研究探討印刷電路板產業中，如何經由
Product Mix 之組合應用分析，以增加整體印刷電路板之生產量與生產效能，進而創造
更高之企業營收。本研究主要將採用系統模擬方式針對市場上各種會影響印刷電路板
產業生產產品的風險加以模擬，並藉由結合基因演算法最佳化技術對實際的印刷電路
板產業產品組合問題牽涉到不確定性因子非線性之限制式，進行發掘適合的單目標非
線性解決方案。 
 
關鍵詞: 產品組合、風險評估、系統模擬、基因演算法 
 
 
 
 
 
 
 
 
 
 3
產品熱度已逐漸減退，廠商往更高階的覆晶封裝（Flip-Chip）載板發展。 
一般而言，產業競爭－反應活動之概念，如圖 1 所示。面對來自四面八方的激烈
競爭，印刷電路板製造商必須擬定適當的經營策略，以回應外在的競爭環境。印刷電
路板製造商之經營策略，關乎企業經營之成敗，對於企業之獲利，自具有決定性之影
響力；企業之「獲利」，則可透過「開源」與「節流」兩項經營活動的執行而達成：「開
源」意指保留現有的客戶，甚或吸引更多具有印刷電路板需求的廠商，並經由 Product 
Mix 之組合應用，以增加整體印刷電路板之生產量與生產效能，進而創造更高之企業
營收；「節流」則意指透過內部成本的縮減、有效運用產能與各項資源（指財力、物力、
機器、時間、製程方法等因素）等活動，以降低費用的支出，變相增加企業之獲利。 
經由企業「開源」與「節流」活動之相互整合，意指在已知或預測的印刷電路板
需求下，經由 Product Mix 之組合應用，使印刷電路板層板製造與各產品類別之需求
相互配合，並滿足產能之限制，諸如供應商（協力廠商）產能、財力、物力、機器、
時間、製程方法等。印刷電路板產品組合最佳化，不但牽動企業整體之獲利與經營策
略，更是企業在面對極激烈競爭環境下，所不可或缺之決策依據。 
 
圖 1 印刷電路板產業競爭—反應概念圖 
 
產業競爭者
企業經營策略
獲利目標
Product Mix 組合應用
產能限制
 
產業競爭者 
 
產業競爭者
 
產業競爭者 
 5
2. 文獻探討 
在過去學術界、實務界所研究發表的文獻，對於印刷電路板產業中產品組合的應
用與發展著墨甚少，大多把焦點聚集在印刷電路板產業產能規劃、生產製程的改善及
廠區規劃上，是故在蒐集、引用既有之相關文獻有相當之困難。因此本研究乃嘗試針
對印刷電路板產業之產品組合應用提出適合的解決方案。 
2.1 印刷電路板產業運用基因演算法預測及最佳化相關文件 
針對印刷電路板產業之「預測」與「最佳化」相關議題之探討，學者之研究則如
後所述。 
在 William[1999]的研究中，將整體之生產規劃，定義為二個月至十八個月之中期
產能規劃，主要目的為有效的利用組織的資源，去滿足所期望的需求。 
在蘇政芳[1998]的論文中，主要乃是以印刷電路板產業中，硬質多層電路板廠商
長期產能規劃為範圍，配合訪談或問卷使用的方法，來對印刷電路板產業之高階主管
進行調查，並將調查的結果分析，以探討廠商如何因應市場環境的變化，來決定擴充
產能的各項評做指標。Lieberman[1987]則認為擴充產能的策略，乃是取決於產業之特
性、競爭者行為、企業的長期策略，與企業的風險。在 Haberle et al.,[2001]的研究當
中指出，利用虛擬設計環境（Virtual Design Environment；VDE）將有利於印刷電路板
整體製造週期之評估，與印刷電路板設計之最佳化。此研究將印刷電路板製造週期區
分為設計、資源規劃，與製造三階段，並針對各階段加以模式化，使印刷電路板之設
計更有彈性，資源分配亦將切合印刷電路板之製造所需。此模式適用於協同生產、分
散式的製造環境。Popa et al.,[2001]則提出印刷電路板測試之概念、方法與技術，以及
應用於實務上之做法。 
將基因演算法運用在解決印刷電路板產業問題的研究案例已經愈趨增加，如
Witting & Burkhardt[1996]在研究中利用基因演算法求得最佳規劃格線，以用來取代手
工、經驗規劃印刷電路板傳輸導線之用。而 Regué[2001]針對印刷電路板生產線上問
題，利用基因演算法保留近端印刷電路板電場特性量測的結果，以預測印刷電路板置
於它處後電場分佈的狀況。 
Khoo & Ng[1998]針對印刷電路板元件配置的問題考量每種零組件的大小、高度、
用途不一，早期製造工程師必須事先以經驗決定要將各種元件放在板面何處、擺放的
順序等；若是沒有事先做好規劃，往往發生在實際進行組裝元件作業時，先安裝的體
積較大、高度較高的零件影響後來安裝零件的組裝流程，甚至無法安裝，並且規劃零
 7
於半自動化印刷電路板元件配置上是有其價值的，未來更可朝全自動印刷電路板元件
配置系統的運用發展。 
Pong et al.,[2001]提到利用基因演算法解決交流式電源供應器電磁波干擾的問
題。電源供應器電磁波干擾的問題主要來自兩電場交集處或是印刷電路板層板間串音
的發生，而干擾的發生就是一種雜訊，將影響其供電品質；解決干擾、雜訊的方法除
了消極地增加濾波器外，電路板設計於元件配置計劃時便先行考量避免電磁波干擾現
象的發生是更為重要的。在此研究中採用基因演算法配合競爭式選擇方式（Tournament 
method），作為產生新染色體的方法。競爭式選擇方法係指將之前作好排序的族群以優
生學的角度，只挑選前幾名做為繁衍的父代或母代，如此較能保障所挑選到的染色體
均是屬於族群中較優良的個體，問題也比較容易收斂；至於該挑選前多少名的個數，
數目不宜太小，因挑選的數目過小的話，以生物學的觀點，會造成所謂近親繁殖的現
象，最後將使得族群品質逐漸劣化。 
利用基因演算法以每個基因兩個位元組的編碼方式，將印刷電路板視為一二維空
間。如圖 2 所示，每一線路轉折點即為兩組基因的結合，兩端點間轉折點的增加即線
條曲線越精細便表示規劃時得到較多的彈性。 
 
                                               （資料來源：Pong et al., 2001） 
圖 2 規劃染色體示意圖 
配合基因演算法中複製、交配及突變的方法，如圖 3 所示[Pong et al.,]，增加一染
色體中基因的數目是為了增加解析度（Resolution），因過短的染色體，常會限制最佳
解的產生；利用增加染色體的基因數便能找出一電晶體其所發散電磁波的影響範圍；
再將此法推廣至整個交流式電源供應器印刷電路板規劃之用，能有效減少多餘濾波器
的使用、避免電路繞送時串音現象的發生以及減少後期反覆無效率地檢測之用。 
 9
2. 目標函數中含有許多變數，這些變數的數值描述不同的決策可能性，通常代表某種
資源的使用數量如資金、時間、人力、材料等等達成目標所必須使用的項目。  
3. 對資源的使用有許多條件的限制，其限制內容可以用線性的等式或不等式來描述。 
而 Hillier & Lieberman [1990b] 在另一本書中亦提到使用線性規劃的限制條件如
下： 
1. 所有的變數必須是連續的。 
2. 所有的變數必須大於或等於 0。 
3. 目標函數必須是線性多項式。 
4. 所有的條件必須是線性不等式。 
 
符合上述條件下的系統，如果用圖形分析的話，定義了一個凸空間（Convex 
space），在凸空間內部的任兩點連線，必仍屬於該凸空間的內部範圍。細節說明如下： 
1. 系統中 n 個變數定義了一個 n 向度空間，稱為問題空間（Problem space）。 
2. 每一個條件是一個 n-1 向度的次空間，將問題空間分割為兩半，一半包含所有符合
該條件的解，另一半為不符合該條件的解。 
3. 不論條件與變數的數目為何，符合所有條件的解所形成的集合必然是一個凸空間。 
線性規劃法擁有使用簡便、計算效率高的優點，商用的電腦套裝軟體如 LINDO、
MINOS 等便極為普遍。 
基因演算法的基本精神，在仿效生物界「物競天擇，適者生存」的自然進化法則，
是一種模擬生物基因演化的人工模型，也就是將生物界中遺傳演化重要機制以資訊科
學軟體實作模擬。在這模型中，問題的解答被巧妙地安排成一串數值，模擬染色體
（Chromosomes）中的一串基因（Genes）。大量的染色體經過演化（Evolution）、突
變（Mutation）與交配（Crossover）等等運算不停地產生新的品質更佳的染色體成員，
且淘汰不良的成員，最後演化出問題的最佳解答，我們也可以說基因演算法的運用即
在於解決困難的最佳化問題。 
Holland[1975]定義過所謂困難解的最佳化問題： 
z 本身就很複雜的問題。 
z 前題有很多的不確定性。 
z 需要很快獲得資訊以降低不確定性。 
z 新的資訊必須使平均效率的增加率和獲得資訊的效率達到一致。 
許多的實驗證明，基因演算法是一兼重效率與效能的搜尋方法，之所以如此是因
為基因演算法不同於傳統數學方法是以單點獨立的方法搜尋解空間，而是以多點搜尋
並交換資訊的方法來搜尋解空間。 
 11
s.t.    
1
L
ilk ik
l
Q D
=
≤∑  (2) 
       max
1
N
l
ilk
i
Q C
=
≤∑  (3) 
公式（1）中， ( ( ))k kV D T 是在 kT 時點下，生產決策所可產生的總邊際貢獻， iP 代
表產品 i的價格， ilVC 代表在第 l條生產線，所生產之產品 i的價格， ilkQ 在 kT 時點下，
第 l 條生產線中，產品 i的產量， ilS 表示在生產線 l上，產品 i的設立成本。公式（2）
中， ikD 代表 kT 時點下，對產品 i的需求量；公式（3）中， maxlC 則代表生產線 l的最大
產能。 
Bengtsson & Olhager[2002]亦指出，為了使用選擇權訂價模式，必須假設存在已交
易的股票或交易股票的投資組合，與產品組合的標的資產完美的相關，則可利用公式
（4）至（5）求解選擇權的價值。 
1 1 1
1( ) 0
2 ij
N N N
t i i i ij i j i j
i i j
F r D F D D F rFδ ρ σ σ
= = =
+ − + − =∑ ∑∑  (4) 
( , ) ( )F T D V D=  (5) 
公式（4）中 t FF t∂= ∂ ，r 為無風險報酬率，δ 為不足（赤字）之報酬率， i iFF D∂= ∂ ，
ijρ 為產品 i與產品 j 兩者需求間的相關係數， iσ 為產品 i需求的變動率， jσ 為產品 j 需
求的變動率， 2ij
i j
FF D D
∂= ∂ ∂ 。 
採 Feynman-Kac[ Bengtsson & Olhager,2002]推測表達公式，可將式（5）改寫成為
式（6），式（6）中資產 i的 Q-dynamics 則為給定的推測性之微分，如公式（7）所示。 
( )
,( , ) [ ( , )]
r T t Q
t DF t D e E F T D
− −=  (6) 
( )i i i t i i idD r D d D dWδ σ= − +  (7) 
i j ijdW dW dtρ=  (8) 
 13
電路板廠之生產型態，印刷電路板產業產值占全球比重為 9.9％，僅次於美、日（合
計占全球約 54％之市場），位居全球第三大，憑藉完整的原物料供應體系、生產靈活
彈性、價格競爭力、交期迅速之優點，成長率仍高於全球。 
由此可知我國印刷電路板產業必須重視產品結構的改變，一方面提昇製程技術，
並且一方面規劃最佳的產品組合，持續保有我國印刷電路板產業在國際市場上的競爭
力。 
電路板產業的產品組合問題往往涉及到許多因素，諸如廠區的產能規劃、經營季
節的淡旺季之分與同業間的價格競爭、訂單數量之波動等風險因素。這些風險因素之
間存在著相依關係，使得在解決問題必須要顧慮到諸多風險因素的關係而導致問題解
決的困難度。之前對此類問題曾有學者試著以類神經網路來解決[Yuang et al., 2000]，
但類神經網路的推論過程是一黑盒子（Black Box），我們無法得知其推論過程；也有
學者嘗試以模糊邏輯（Fuzzy Logic）來解決[Ghalia & Wang, 2000]，但模糊邏輯必須
依賴專家的知識，本身無能力自行產生規則，欠缺學習能力。而上述兩者均無法處理
問題中的不確定性，因此在本研究中採用蒙地卡羅法來模擬電路板產業產品之不確定
性的環境，再利用基因演算法找到最適的產品組合規劃。 
2.5 系統模擬 
真實世界中的問題往往包含太多不確定因素，以致很難單純以數學模式表示，在
這種情況下，採用系統模擬的方式不失為一個不錯的選擇。而選擇使用系統模擬方法
乃是基於下列數項考量[Sadoun, 2000]： 
1. 可以在一個新的設計或架構被實作前先行對其加以評估。 
2. 可以幫助學習、了解一個複雜架構內部或其下子系統間的交互作用。 
3. 提供了一個可供分析者產生多樣性結果的工具，而這些結果是難以在真實世界中實
作而得，或是會引發未可知的悲劇。 
4. 組織或是周遭環境的變遷可以被模擬，而變遷所產生的效應則可以觀察模擬系統的
行為得知。 
5. 系統模擬可以像一個工具般驗證結果的合理性。 
6. 系統模擬的實驗結果提供了一個對系統或是設計本身的彈性評估值，這些實驗結果
對設計者、使用者、管理者和購買者來說都是有價值的資訊。 
7. 系統模擬對效能規劃和調整來說，是一個成本效益（Cost-effective）工具。 
 
關於系統模擬的流程，如圖 8 所示，它的運作步驟說明如下： 
 15
2.5.1  蒙地卡羅模擬 
系統模擬是指一種靠著不斷改變所有的變數和限制式，求得可能結果的分配
（Distribution of possible outcomes）方法，而其中的變數和限制式可能都是一種統計
分配型態。蒙地卡羅模擬法為一靜態的系統模擬技術，它被使用於統計中的模型，由
於此模型的特性不會隨著時間而改變。它也可被應用於估計非機率性的表示式上（藉
由統計的技術）、或是應用於估計關鍵數值及假設檢定中的檢定力。它允許使用者自
行設定機率分配和目標公式，然後藉由亂數產生的數值與電腦的重覆計算，來試著找
出所有可能的解；在此效應下，電腦將會測試過所有的輸入數值組合，然後找出所有
可能的解。 
在不斷重複的系統模擬過程中，每進行一次系統模擬的動作，變數中的機率分配
的函數就會以抽樣的方式，產生一個新值。此種抽出一個新值的動作，就是模擬風險
的方式。當變數值都給定後，再代入一般的最佳化流程中，經過電腦運算後，所得到
的目標值，就是在不確定環境中有考量到風險的存在而求出的，所以蒙地卡羅模擬可
以用在包含不確定因素的最佳化求解過程中，但是會出現可能解的組合急遽增加的問
題，所以當系統模擬和基因演算法結合時，即可快速的往期望的解空間方向去模擬含
有不確定因素的最佳化問題[Silva ＆ Kirner, 1997; Putro et al., 1999]。 
2.6 基因演算法結合系統模擬 
系統模擬具有彈性高、運作速度快以及可模擬敏感度分析的優點，但系統模擬也
存在著無法考慮到所有參數的範圍值及其所有可能的組合、初始參數難以設定的問
題。而基因演算法本身對於多維解空間的強大搜尋能力，可利用來找出最適當的參數
值以及不同參數間的最佳組合。因此若能讓系統模擬結合基因演算法，不僅可以彌補
基因演算法所欠缺的模擬機制，適切表達問題的高度不確定性，並大幅提高系統的容
錯能力，系統模擬結合基因演算法可以使得這兩種方法更能發揮彼此的優點，不僅建
構出一個符合真實世界的具體模型，更能進一步找到最適的決策資訊。 
採用系統模擬與基因演算法結合的流程架構，可參考如圖 9 所示，其步驟說明如
下： 
(1) 描述不確定性因素的特性，找出其所適合的機率分配，並決定模擬後「目標值」
的統計參數 (例如平均值、標準差)。 
(2) 決定輸入的變數有哪些，並設定可調整變數的值域範圍。 
(3) 利用基因演算法產生一組新的可調整變數族群。 
(4) 評估新種族群的適合度，經由再生、交配、突變等過程，以產生更好的新族群。 
(5) 測試新族群是否滿足目標條件，若不符合回到步驟4。 
 17
在暸解上述的流程之後，如將上述方法應用於印刷電路板產業的產品組合的問題
上，故首先需求取產品組合與企業利潤之間之關係函數。因為從經濟學的角度來看，
產品利潤與市場需求量有著密不可分的關係，當市場上產品供給數量供過於求，價格
必定下跌；反之，若出現供不應求的情況時，則價格會因此上漲。因此，在此初始階
段須求取兩者的關係函數。 
當產品需求量與產品利潤的迴歸式建構完成後，接著就可以進入下一步驟，建構
系統模擬模型部份。在這一部份，我們將印刷電路板產業本身的不確定因素，包括：
產品價格制定、訂單流失率、產能提昇成本等，及周邊的環境因素，包括：景氣指標、
同業競爭等項目一併列入考慮。其中景氣指標係指根據過去多次景氣的情況，選擇一
些對景氣變動反應敏感之項目，在這裡我們選擇物價指標做為代表，以反映當時景氣
狀況及其未來動向。 
在上述諸多不確定因素中有數項乃是人為難以掌控，這些對於印刷電路板產業營
收會有很大的影響，因此對這些因素我們採用統計的分配方式，對不同的因素套用不
同的分配模式，以使本模式能接近真實世界的運作模式，客觀的呈現印刷電路板產業
實際獲利的情況。例如：某產品類別的市場需求量，這一因素即使在其他因素固定下，
仍是一個波動的狀態，如果使用平均數或是眾數代替之，往往不能真實呈現此一參數
的真實影響，故在本模式中，以常態分配代表市場需求量的變動。而另外像產能提昇
成本，也是必須採用統計分配的因素。最後就是需要調整以使結果最佳化的因素－產
品組合之規劃，對這些因素，我們採用基因演算法以求其最佳的參數設定。 
2.7 多目標基因演算法： 
在 2.2 節中提及的基因演算法中，僅有一組的適應值函數(Fitness Function)，用
來評估這個演化世代的優劣，而這也代表在同一個問題中只能同時存在一個目標，如
此就限制了基因演算法的應用範圍了，因為在現實的環境中，要去求出一個問題的最
佳化時，常常不是一個最佳化值就可以代表這整個問題的結果，反倒是會需要很多的
變數共同來決定這問題的最佳化結果。例如廣告採買策略最佳化[陳有賢, 2003]、小區
域電力負載移轉最佳化[高傳詔, 2003]、多目標排程之發展與應用[王治元, 2004]、
IMOEA 對隨選視訊系統做最佳化設計[林哲生, 2004]……等，應用範圍十分廣大。 
但是在多目標的最佳化問題中，是幾乎找不到一個真正的最佳化值，原因是各個
單一目標值都要求要最佳化，可是每一個要求的數值大小，度量單位，求解最大值或
是最小值的方向都各有不同，數值之間容易造成衝突，所以要決定一個整體的適應函
數值是非常困難的，但是有幾個簡單的方法可以來解決多目標基因演算法之方法： 
（１） 權重法(Weighting Method) [ M. Tadahiko, 1995]透過給定一個固定之權值給各
個適應函數後，再利用加權計算的方式，將多個適應函數值轉換成一個單一的
 19
   iR  為第 i個亂數值，介於 0 與 1 之間  
   n   為某一個適應函數的號碼   
最後再利用演算法找出各個隨機權重的最佳解，因此在求解的過程中可以針對整
個可能的解空間進行搜尋，最後可以產生一個解集合稱為柏拉圖前緣的曲面，最
佳解就會在這個曲面上。 
假設決策者需要同時考慮「時間」和「成本」兩個目標，且希望得到的解答能滿
足最小「時間」和最小「成本」兩目標值，如圖 12 所示，此兩目標所形成的為柏拉
圖最佳解前緣： 
 
                                               （資料來源：劉慧敏，民國 91 年） 
圖 12 柏拉圖最佳解前緣概念圖 
圖 12 中灰色部分代表可行解區域，各點皆為可能的解。其中 A 點相較於其他點
成本最低、花費時間最長；相對的，C 點的成本最高、花費時間最短。雖然 A 點或 C
點各有一個目標值勝過對方，但因決策者不清楚兩目標之間的相對重要性為何，故無
法比較 A 點或 C 點的好壞。若在此抽樣區域中已經找不到任何點其兩目標值皆大於 A
點和 C 點，則 A 點和 C 點即為柏拉圖最佳解，或稱為非超越解（Non-dominated 
solutions），而其他類似的點，如 B 等這些點形成圖 12 虛線部分的柏拉圖最佳解前緣。 
圖中還有其他不在虛線上的點，如以 D 點與 A 點做比較，會發現 D 點效用不比
A 點差，因為 D 點的花費時間比 A 點短，但是成本比 A 點高。然而 D 點並非柏拉圖
最佳解，原因是解答空間中存在 B 點，其兩個目標值都較 D 點小；E 點也有類似的情
況。D 點和 E 點即是所謂的被超越解（Dominated solutions）或較差解（Inferior 
solutions）。 
由於抽樣區域的不同，上述柏拉圖最佳解前緣可能是區域的柏拉圖最佳解前緣
（Local Pareto-optimal front），而非全域的柏拉圖最佳解前緣（Global Pareto-optimal 
front），亦即全域的柏拉圖最佳解必定是非超越解，但是非超越解不見得是全域的柏
 21
模式函數（Multimodal Function）的分享函數方法後，才陸續有學者發表其他 MOGA
的實作方法。在自然界中每類生物都有其生存之條件，稱為 niches，代表一組環境特
徵或位置，每種生物所需要的 niches 不盡相同，自然藉此維持各生物族群的穩定。將
此觀念延伸至基因演算法上，就變成了在不同解答範圍（niches）中，各維持一特定
數目的子族群染色體（species）。為了促使子族群的產生，其作法為強迫某一染色體
所得到的適應值，與其他位於同一 niche 的個體分享。然而許多問題對資源的定義並
不清楚，故使用染色體之間的距離來決定是否該與對方分享適應值，這種維持物種穩
態的方法，稱為「分享函數」（sharing function）。使用分享函數方法可以維持族群
多樣化。然而，此法最困難的地方是計算參數。根據 Deb & Goldberg[1989]所提出計
算的方法，會發現計算該參數時，必須事先知道整個解答空間大致上會分成幾個
niches，而且各 niches 之間最好不要相互重疊；並且也有些研究指出實行分享函數方
法時，族群數最好大一點才有效果。事實上，除了 Schaffer[1985]之 VEGA 未使用分
享函數的概念外，其他幾個重要的 MOGA 實作方法，都將分享函數應用於染色體適
應值的給定上，藉此維持族群的多樣性，幫助搜尋非超越解。 
多目標基因演算法多年來已被應用在解決各類的問題，如 Abraham [2005] 應用
於指數預測，以求解最小；Mukerjee [2002] 等人以多目標最佳化建構銀行貸款資金分
配，在銀行需維持足夠資金及限制曝露利率風險之條件下，以最大利率報酬及最小風
險為多目標函數，建議資金分配之類別及金額；Schlottmann [2004] 等人以 
Multi-Objective Evolutionary Algorithm (MOEA) 及問題別區域搜尋 (problem-specific 
local search) 建構風險－收益分析法以建立銀行的貸款分配；Santos [2004] 等人以極
值風險分析法之尾部風險值做為投資組合之風險評估，提出最佳化預期報酬及尾部風
險之多目標模型；Ong [2005] 等人以 MOEA 為多目標演算法，混合期望報酬率、關
聯係數風險 (Relation Risk) 及不確定風險 (Uncertainty Risk) 為多目標，經實證結果
證實，可提供較彈性及正確的投資組合配置，解決小樣本資料下無法建構效率前緣的
問題；Subbu [2005] 等人以 PSEA 為多目標演算法解決非線性或高度複雜之線性問
題，提出以帳面收益率為報酬率、變異數及風險值為多目標函數，並以  Target 
Objectives Genetic Algorithm (TOGA)，加強搜尋解的品質。 
2.8 最佳化 
最佳化為一種從問題中找出一個最佳解的程序。其中問題的可行解空間可能非常
的大。大部分的最佳解問題都包含許多的變數，而這些變數受限於所知道的一些限制
式。舉例來說，一個公司可能會有三個製造工廠，每一家工廠生產不同的產品，而生
產出來產品的數量也不一樣。每一家工廠生產每一樣產品都有其成本，例如工廠運送
產品到門市店的運費。另外，每家工廠的產能也都不盡相同。 那麼到底應該讓每一
家工廠生產怎樣的產品組合，以滿足每一家零售商的需求，且運輸成本能達到最小，
這就是一種典型的最佳化問題。 
 23
3. 研究方法 
在本計劃之第三年研究中，我們加入了多目標最佳化的概念，於此本研究將以
VEGA 來實作多目標產品組合最佳化，幫助印刷電路板廠商建構同時滿足多樣化目標
的最佳產品組合策略。如圖 6，首先介紹此研究方法之整體架構，亦即以多目標基因
演算法為基礎之方法運作流程。 
整體架構說明如下： 
(1) 依需求給定產能限制、各產品種類利潤、期間產品市場需求等參數，並選擇數個
產品生產目標。 
(2) 在不改變條件架構下，系統只對產品組合的參數部分編碼，使VEGA以步驟1中所
選的各個目標為適應函數，進行產品組合參數最佳化評估。 
(3) 採移動視窗（Sliding window）的訓練方式，使VEGA選出之多組最佳產品組合策
略，個別進行選擇產品組合，並回測其策略績效。 
(4) 將所有產品組合策略結果彙總，進行下列兩種評比方式，比較在同一生產期間，
兩種研究方法個別產生之產品組合方式與多目標基因演算法所產生之產品組合
方式之間的績效差異，用以驗證本架構是否能滿足實務需求： 
y 與單使用基因演算法產生之產品組合策略績效作比較。 
y 與以基因演算法結合系統模擬的方法產生之產品組合策略績效作比較。 
(5) 就實驗結果分析其特性，最後歸納整理而得研究結論。 
 25
3.1 目標函式與限制式 
  本研究所使用到之變數所代表之意義，如下表所示： 
 
表 1 變數符號表 
i 料號編號 
j 生產流程編號 
n 料號總數 
k 生產流程總數 
xi 對 ith 料號的供應數量 
pi ith 料號的利潤 
mi ith 料號的市佔率目標供給量 
di ith 料號的市場需求量 
aij ith 料號在 jth 生產流程的單位產能需求 
oij ith 料號在 jth 生產流程的委外產能 
tij ith 料號在 jth 生產流程的單位委外成本 
I
jc  j
th 生產流程的總廠內(in-house)產能 
O
jc  jth 生產流程的總委外產能 
 
Objective： 1 1 1
1
.......................................................................(1)
( )............................................................................
n n k
i i ij ij
i i j
n
j i ij
i
Max x p o t
Min c x a
= = =
=
⋅ − ⋅
− ⋅
∑ ∑∑
∑
1
..(2)
k
j=
⎧⎪⎪⎨⎪⎪⎩ ∑
                
s.t.  
     
1
                                  1,...,                                                                     (3)
                        1,..., 
i i i
n
I O
i ij j j
i
m x d i= n
x a c c j = k                     
=
≤ ≤ ∀
⋅ ≤ + ∀∑ (4)                                                 
    
 本研究除了將應用一般的基因演算法來規劃產品組合最佳化，及找出最適之 xi 
以達到公式 (1) 最大化與公式 (2) 之最小化。此外，為了考量某些參數值的不確定性
本質，因此本研究同時進行不考慮風險和考慮風險這兩種情況。 
基因演算法本身為一最佳化求解工具，基因演算法在尋找最佳解時，每次係以一
個族群（Population）為單位，因此可平行搜尋數個答案，且 GA 的運算過程大多會加
入隨機值的影響，因此有較高的機會避開區域最佳解（Local optimal）的陷阱。GA 的
限制在搜尋解答空間時，不保證一定可以找到真正的最佳解，而是在搜尋最佳解到某
 27
3.2 實驗設計 
由於印刷電路板產業的不穩定性，有不少風險因素會影響到最佳的決策制定過
程，像是動態的市場需求量，生產不良率等等，而要考量以上的不確性因素，就必須
使用模擬的技術來給不確定性因素一個模擬後符合機率分配的數值。所以在下圖本研
究之實驗流程中，我們會分別就具風險因素考量和不具風險因素考量兩大方向，來設
定各類料號的生產不良率與市場需求量，以期能更實際地模擬企業真正的運作狀況。 
 
圖 11 研究流程圖 
 
3.2.1 實驗資料 
在本研究中，一間位於桃園之印刷電路板廠商，提供我們產品料號的生產資訊，
和生產委外的相關指導資訊，包括了如何選擇委外廠商等等。不過就如同台灣的其他
企業一樣，要獲取該企業核心競爭力的產品相關資料，像是工廠的生產產能，或是訂
單的詳細資訊等，在實際與其交涉下，是有實作上的困難，因此我們在此假設一些我
們所需要的資訊，像是市場需求量、市場佔有率、每個產品料號的利潤、料號的種類，
以及工廠本身的產能限制和委外廠商的產能限制，和委外的單位成本及委外決策等實
驗必備資訊。 
五百項共九大類料號資訊 
各類料號相對應生產流程、 
利潤及市佔目標量 
委外廠商製程能力、各料號委外
單位成本及產能大小 
生產線產能資訊 
不具風險因素考量 
各類料號統一設定 
生產不良率 = 17% 
市場需求量 = 預測量定值 
具風險因素考量 
相對應於各類料號設定 
生產不良率 = 常態分配 (17%, σ2) 
市場需求量 = 常態分配 (預測量定值, σ2) 
基     因     演     算     法 
不具風險考量下之最佳化產品組合 具風險考量下之最佳化產品組合 
 29
表 3 (a) 無風險考量下之模擬實驗設定 
料號類別 市場需求量因子之假設值 生產不良率因子之假設值 
IC 板 µ = 預測值 µ = 18% 
高階行動電話 µ = 預測值 µ = 17% 
低階行動電話 µ = 預測值 µ = 15% 
伺服器主機板 µ = 預測值 µ = 14% 
LCD µ = 預測值 µ = 13% 
網路設備 µ = 預測值 µ = 14% 
IA µ = 預測值 µ = 12% 
筆記型電腦 µ = 預測值 µ = 13% 
個人電腦 µ = 預測值 µ = 11% 
 
表 3 (b) 具風險考量下之模擬實驗設定 
料號類別 市場需求量因子之假設值 生產不良率因子之假設值 
IC 板 µ = 預測值 σ = 預測值× 0.15 
µ = 18% 
σ = 2% 
高階行動電話 µ = 預測值 σ = 預測值× 0.25 
µ = 17% 
σ = 3% 
低階行動電話 µ = 預測值 σ = 預測值× 0.2 
µ = 15% 
σ = 3% 
伺服器主機板 µ = 預測值 σ = 預測值× 0.07 
µ = 14% 
σ = 2% 
LCD 
µ = 預測值 
σ = 預測值× 0.12 
µ = 13% 
σ = 3% 
網路設備 µ = 預測值 σ = 預測值× 0.07 
µ = 14% 
σ = 2% 
IA 
µ = 預測值 
σ = 預測值× 0.1 
µ = 12% 
σ = 2% 
筆記型電腦 µ = 預測值 σ = 預測值× 0.15 
µ = 13% 
σ = 1% 
個人電腦 µ = 預測值 σ = 預測值× 0.05 
µ = 11% 
σ = 1% 
µ：平均值 σ：變異數 
 
 
 
 
 31
4. 結果與討論 
由於此次的目標有兩個，因此找到的結果不像前兩年計畫有只有一個的目標，分
別是（1）所有產品生產的利潤總和與（2）工廠設備之剩餘產能，這兩個目標彼此是
有牴觸的，因為如前所述將產品外包生產對公司也許反而能減少成本，但若希望讓工
廠的剩餘產能越少越好，相對的代表委外的數量要減少，則可能讓總利潤變少。本論
文在兩種風險考量之實驗各執行五次，下面所列出之結果是從五次實驗中挑選出表現
較好的 20 組可能的結果以供選擇（所列之結果根據”所有產品生產的利潤總和”由大
到小排序）： 
表 5 (a)  無風險考量下之模擬實驗的結果 
所有產品生產的利潤總和 工廠設備之剩餘產能 
82893856 2680483589 
82893661 2681354961 
82584176 2682609450 
82454216 2682630660 
82315432 2682831190 
82309744 2682107596 
82282104 2681528053 
82266616 2681730820 
82242104 2681728053 
82186848 2683686660 
82129928 2682213589 
82061896 2682757057 
82031128 2682546771 
81831064 2682893310 
81767624 2682558210 
81734256 2682712849 
81690880 2682483589 
81658136 2683911940 
81570232 2682289150 
81565248 2683758590 
表 5 (b)  具風險考量下之模擬實驗的結果 
所有產品生產的利潤總和 工廠設備之剩餘產能 
82818080 5363868190 
82663992 5363078540 
82566752 5364479645 
 33
 
圖 13 具風險考量下之實驗結果 
圖 14 顯示出無風險考量下之實驗中表現最好的一次實驗之適應值變化情形，分別
以兩個 Y 軸來代表兩個目標，左邊為利潤，右邊為剩餘產能，由圖可看出兩個目標
之值皆在兩百代左右時趨於穩定。圖 15 顯示出具風險考量下之實驗中表現最好的一次
實驗之適應值變化情形，由圖可看出利潤在三百五十代左右趨於穩定，而剩餘產能則
在三百代左右趨於穩定。 
圖 14 無風險考量下之適應值變化情形 
 35
5. 總結 
在印刷電路板產業激烈競爭的今日，廠商為求獲取更多收益、增加市場佔有率，
其作法絕非為跟上市場需求而盲目地擴充產能；必須對市場現況、趨勢作一通盤了解，
了解生產符合市場需求並且能帶來最大收益的產品組合是更重要的。 
本研究第一年之計畫為根據單一目標找出能創造最大利潤的產品組合且未加入風
險考量，所得到的結果較不符合現實環境的情況；第二年之計畫之目標與第一年相同，
差別在於加入了風險考量，這使得結果雖然比第一年差但卻較符合實際情況；第三年
之計畫為了更符合實際情況，因而將工廠剩餘產能最小化當作第二個目標，並同時對
無風險考量和具風險考量兩種情況做實驗，結果與前兩年相比結果較差，但卻是最符
合實際情況的結果。 
本研究利用多目標基因演算法所找出之有效、正確的產品組合策略讓廠商在相同
的產能條件下，將市場需求、產品利潤、剩餘產能等目標作一協調，使得最終生產的
產品不僅能在短程中為廠商帶來利潤，並且有助其長期於整體產業中競爭力的提昇。
而加入風險評估和同時考量不同的目標的用意，都是能夠使研究成果更符合、適用於
現實，對實務應用、決策支援上的幫助亦更加明顯。 
由於本研究所蒐集之資料實為該 PCB 公司的一小部份，真實資料不只 500 種料
號和 90 種流程，因此可預期問題會更為複雜，且本研究目前僅考量兩個目標，但實
際上需要考量的目標可能不下數十個，因此在如何在合理的時間中找到此複雜問題的
可行解也成為我們未來努力的方向。 
 
 
 
 
 
 
 
 37
7. Dhar V., Stein R., “Intelligent Decision Support Methods – The Science of Knowledge 
Work,” Prentice Hall, 1975. 
8. Ellis K. P., Vittes F. J., and Kobza J. E., IEEE Transactions on Electromagnetics 
Packaging Manufacturing, Vol.24, No.3, July 2001. 
9. Fonseca C. M., Fleming P. J., “Multiobjective Genetic Algorithms,” The Institution of 
Electrical Engineers, 1993. 
10. Goldberg D. E., Richardson J., “Genetic Algorithms with Sharing for Multimodal 
Function Optimization,” Proceedings of the Second International Conference on 
Genetic Algorithms, pp.41-49, 1987. 
11. Hillier Lieberman, “Introduction to linear programming,” McGRAW – HILL, 1990. 
12. Holland J. H., “Adaptation in Natural and Artificial Systems,” University of Michigan 
Press, 1975. 
13. Horn J., Nafpliotis N. and Goldberg D. E., “A Niched Pareto Genetic Algorithm for 
Multiobjective Optimization”Proceedings of the 1994 IEEE International Conference 
on Evolutionary Computation (ICEC’94), pp.82-87, 1994. 
14. Katharine R., Haberle and Graves R. J., “Cycle Time Estimation for Printed Circuit 
Board Assemblies,” IEEE Transactions on Electronics Packaging Manufacturing, Vol. 
24., No. 3, July 2001. 
15. Khoo L. P., Ng T. K., “A genetic algorithm-based planning system for PCB component 
placement,” Int. J. Production Economics 54, 1998. 
16. Lieberman R. C., Carmon T., “On Capacity Moldling for Production Planning with 
Alternative Matching Types,” IIE Transactions, Vol.24, No.4, pp.62-72, 1992. 
17. Mukerjee, A., Biswasa, R., K. Deb, A. P. Mathurc, “Multi-objective evolutionary 
algorithms for the risk-return trade-off in bank loan management,” International 
Transactions In Operational Research, pp. 583-597, 2002. 
18. Ong C. S., Huang, H. J., Tzeng, G. H., “A novel hybrid model for portfolio selection,” 
Applied mathematics and computation, Vol. 169, pp.1195-1210, 2005. 
19. Pong M. H., Wu X., Lee C. M., and Qian Z., “Reduction of Crosstalk on Printed Circuit 
Board Using Genetic Algorithm in Switching Power Supply,” IEEE Transactions on 
Industrial Electronics, Vol.48, No.1, February 2001. 
20. Popa I., Lita I., and Chita A. M., “The Concepts Methods And Technics For The 
Electronic Testability Implementation,” 24th International Spring Seminar on 
Electronics Technology, May 2001. 
21. Regué J. R., Ribó M., Garrell J. M., and Martín A., “A Genetic Algorithm Based 
Method for Source Identification and Far-Field Radiated Emissions Prediction From 
Near-Field Measurements for PCB Characterization,” IEEE Transactions on 
Electromagnetic Compatibility, Vol.43, No.4, November 2001. 
22. Santos, J. R., Haimes, Y. Y., “Applying the Partitioned Multiobjective Risk Method 
(PMRM) to Portfolio Selection,” Risk Analysis, Vol. 24, No. 3, pp. 697-713, 2004. 
