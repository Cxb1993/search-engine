 1
摘要 
中文摘要 
關鍵詞：高頻譜影像、目標偵測、訊號子空間投影法、部份濾波法、電腦叢集平行
計算系統。 
高頻譜影像具有更多的光譜波段數目和較高的空間及光譜解析度，因此比多頻
譜影像提供了更豐富及細緻的地表資訊，對於目標偵測與影像分類也有較好的辨識
能力。但是高頻帶數和高解析度也意味著高資料量，如何在龐大的資料量裡，發展
一高效的目標物辨識和影像分類技術，就變得相當重要。本計畫第一年的研究乃針
對高頻譜影像，提出以訊號子空間投影法為基礎之高效目標偵測研究。為了提昇高
頻譜影像目標偵測的效能，我們依據高頻譜影像頻帶具有高相關的特性，提出部份
濾波法來減少目標偵測的計算複雜度。 
首先提出訊號子空間投影法(Signal Subspace Projection, SSP)進行影像目標
偵測研究，此法以高頻譜影像所對應的訊號子空間為基礎，透過子空間轉換萃取重
要的特徵資訊，並以對應特徵為基礎設計最佳的濾波器，進行影像目標偵測。為了
進一步降低SSP法的計算複雜度，並充分利用高頻譜影像頻帶間的高相關性，我們提
出一結合部分濾波和訊號子空間的投影法(SSP) 以減少頻帶數量達到降低原來濾波
器設計的計算量。此技術先以聚類頻帶分群法將相關性高的頻帶快速的聚集為一群
組。接著，將高頻譜影像分群處理，針對每一群組，以SSP法設計最佳的部份濾波器，
再結合各群組的部份濾波器進行目標偵測。 
由於部份濾波法具可平行處理的結構，我們以個人電腦建構叢集式平行計算系
統來實現部份濾波法，以進一步提昇高頻譜影像處理的效能。模擬結果顯示，本研
究所提部份濾波法，除了可減少原來濾波器法於高頻譜影像處理的計算量，也提高
了目標偵測和影像分類的效能。此外，藉由建置的電腦叢集進行平行處理除了可快
速驗證部份濾波法的效能，並明顯的提昇高頻譜影像於目標偵測的處理速度。 
 
 
 
 3
報告內容 
一、 前言 
 
隨著遙測科技的進步，遙測影像的光譜波段數目，愈來愈多，空間和光譜的解
析度愈來愈高，此高光譜影像相對的比多頻譜影像提供了更精確和豐富的資訊與辨識
能力。然而高光譜也對應產生巨量資料，造成影像分類和目標偵測困難度增加和處理
效能不佳。若將處理多頻譜影像分類和壓縮法應用於高光譜影像，往往效果不甚理
想。因此，針對高光譜影像的特性，發展一高效的影像分類法和目標偵測技術，以提
高影像分類精確度的研究，透過此技術提供不同應用領域，如農、林、礦等自然資源
開發，有用的資訊，實為遙測應用的基礎。此外，如何減緩龐大的影像資料量所帶來
的計算複雜度，也是目前高頻譜影像處理極為迫切的研究主題。 
本計畫第一年的研究乃針對高頻譜影像提出一結合部分濾波和訊號子空間的投
影法以提升目標偵測的精確度，並降低原來以濾波器法為基礎之目標偵測法的計算
量。此外，我們建置電腦叢集平行計算系統來實現部份濾波法，以進一步提昇高頻譜
影像目標偵測的效能。 
 
 
二、 研究目的 
本計畫擬依據高頻譜影像的特性，如高光譜波段數目、高光譜波段和空間資料相
關性等，發展可平行處理的目標偵測和影像分類技術。藉此技術來提升影像目標偵測
和分類的精確性，降低影像分類的計算複雜度，並達到高效影像分類的目的。此外，
我們以個人電腦建構叢集式平行計算系統實現並驗證所提的影像目標偵測技術。 
本研究所提出高頻譜影像目標偵測研究達到下列目標： 
 研究可依高頻譜影像頻帶資料的相關性，萃取影像特徵的訊號子空間投影法。 
 研究一聚類頻帶分群法可依高頻譜影像頻帶資料的相關性將相關性高的頻帶快
速的聚集為一群組。 
 研究一結合部分濾波法和訊號子空間投影法，改善影像目標偵測的效率。 
 以部分濾波為架構進行影像分類，以達高效訊號處理之目的。 
 建構PC Cluster叢集的平行計算系統。 
 以平行計算系統實現並驗證研究的影像目標偵測和分類之平行演算法。 
  
  
三、 文獻探討 
目前高頻譜影像處理的技術，著重於兩個方面，第一為在不影響重要訊息的條
件下減少資料维度；第二為將光譜影像加以分類或估測其所含物質的含量。有關減
少影像資料維度的研究主要分為二大類，一是特徵選取[1]，即從光譜中選出較重要
的光譜波段；另一為特徵萃取[2, 3]，是將現有光譜經由轉換萃取其特徵，其中主
要成分分析法(principal component analysis，PCA)是利用線性轉換的方法保留重
要的成分來進行資料分析。 
關於目標物偵測之研究， [4]利用正交子空間投影法(Orthogonal Subspace 
 5
四、 研究方法 
本研究針對高頻譜影像，發展以訊號子空間投影法為基礎且可平行處理之目標
偵測和影像分類技術。此技術充分利用高頻譜影像光譜波段間的相關性，來移除光
譜波段間資料之冗餘性，以提升影像分類和目標偵測的準確度。此法可依循序的資
料進行影像特徵的萃取，可在不需預知背景或雜訊的情況下，以部份濾波架構來減
緩雜訊的隨機效應，達到改善影像分類和目標偵測精確度。此外，研究所提之演算
法具計算量少、快速收斂等優點，除可達高效訊號處理的目的，也非常適合以平行
處理的架構實現。本計畫透過與台北科技大學電子系張陽郎教授的合作，在海洋大
學通訊與導航系建構一平行計算系統。藉由此平行計算系統實現所提結合部分濾波
和訊號子空間投影法，並驗證其影像平行處理的效能。 
 
(A) 訊號子空間投影法 
我們首先提出以訊號子空間投影來設計最佳的濾波器以進行目標偵測。 
考慮以線性混合模型表示高頻譜影像資料，並將影像資料分解為目標和背景資
料，表示如下： 
 d d b bX=S α S α n                  (1) 
(1)式中，  dS 和 bS 為目標物和背景的特徵向量所形成的矩陣， dα 和 bα 為目標物和
背景的反射係數，n為雜訊成份。 
以Wiener濾波器理論偵測高頻譜影像目標 dα ，其最佳權重為， 
do SRw
1               (2) 
(2)式中, ][ TE XXR  為影像資料的自相關矩陣。Wiener濾波器權重計算需要進行
反矩陣計算，在光譜波段數目很多時，其計算複雜度也相對增加。 
文獻[4]提出正交子空間投影法(OSP)，利用一可移除背景訊號的矩陣
H
bbosp SSIP  ，來除去背景干擾，在最佳濾波器輸出訊雜比的條件下設計濾波器權
重， 
dosposp SPw               (3) 
以進行目標偵測。此法雖不需執行反矩陣計算，但須先預知背景訊號的特徵 bS 。為
改善正交子空間投影法(OSP)須先預知背景資訊的限制， Te-Ming Tuzya提出雜訊子
空間投影法(NSP)[6]。將資料自相關矩陣R 特徵分解為 
T
nnn
T
sss EΛEEΛER            (4) 
其中 sE 為矩陣R 對應到目標和背景之特徵向量所形成的矩陣，而 nE 為對應到雜訊n之特
徵向量所形成的矩陣。 sΛ 和 nΛ 為對應到目標及背景資料和雜訊之特徵值所形成的矩
陣。假設目標物的能量非常弱，雜訊子空間投影法(NSP) 利用雜訊子空間來計算最
佳權   
d
T
NNnsp SEEw              (5) 
雜訊子空間投影法的優點為不需要知道背景特徵 bS 先前的資訊，另外也不需做反矩
 7
kG 群集的核心頻帶 k ，其中 th 表頻帶合併為同一群組的臨界值。為了選擇合適的
門檻值，我們定義一成本函數，在最大成本函數的條件下，選擇最佳的門檻值 th 。
成本函數的定義如下： 
 

P
l
GGth ll WEJ 1
][)(                        (10) 
其中，
lG
E   代表第 l 個群集內各頻帶相關係數的平均值，  E 為期望值， lGW 為
對應第 l群頻帶的權重，定義為 LmW lGl / ， tm 表全部的頻帶數， lm 表第 l 群頻帶
的頻帶數， p 為頻帶分群的總群數。(圖二)為高頻譜AVIRIS影像所對應成本函數值
的曲線圖。我們取對應到最大成本函數值的 th 來做為頻帶分群的門檻值，由(圖二)
可看出門檻值約介於0.85~0.86之間。為了找出各群集的初始核心頻帶，我們選取的
準則是以同一群集內與各頻帶相關性最高的頻帶作為該群集代表核心頻帶。研究所
提聚類頻帶分群法的步驟說明如下：  
 
Step1. 計算高頻譜影像頻帶間的相關係數矩陣。 
Step2. 選取頻帶合併同一群組的門檻值 th 。 
Step3. 尋找出各群組之初始核心頻帶 k ， Pk ,...,1 。 
Step4. 以 k 為核心生成聚類群組 kG ，並且重新計算各群組之核心。 
Step5. 重覆Step4，直到各群組不再改變，並將與各群皆不相近之頻帶移至最後，稱
為剩餘頻帶。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖一 高頻譜影像(AVIRIS)的     圖二 高頻譜 AVIRIS 影像成本函數圖 
相關係數矩陣 
 
 9
接著，我們結合部份濾波和訊號子空間投影法。第 i 個頻帶群組資料 ix 其對應
的自相關矩陣 iR ，可表示為 TnininiTsisisiTiii E EΛEEΛExxR  ][ ， siE 和 niE 為矩
陣 iR 對應訊號和雜訊子空間之特徵向量所形成的矩陣， siΛ 和 niΛ 為對應到訊號和雜
訊子空間之特徵值所形成的矩陣。利用雜訊子空間與目標物訊號為互相垂直的特
性，則第 i  個部份濾波器之權重為 
isid
T
isisisid
T
inininid
T
isisisdiiio ,,,
1
,,,,
1
,,,,
1
,,
1
, wsEΛEsEΛEsEΛEsRw  
                    (14) 
is,w 為部份濾波結合訊號子空間投影法所算出的最佳權重。 
 
(D) 高頻譜影像目標偵測之平行處理研究 
為解決高頻譜影像處理所需高計算量的問題，本研究透過平行處理技術，以建
構個人電腦叢集式的平行處理系統實現所提的部份濾波法，以降低高頻譜影像目標
偵測所需之計算量。 
本研究使用利用五台個人電腦以電腦叢集架構來建置平行處理系統，其中由一
台雙核心CPU的Intel Xeon E3110 3.0GHz作為Server，四台雙核心CPU的Intel Core2 
Duo E8400 3.0GHz分別為Node 01、Node 02、Node 03、Node 04。以乙太網路(Ethernet)
利用RJ-45網路線和路由器(Router)作連接而形成區域網路，其架構如(圖四)所示，
實際建置的平行處理系統如(圖五)所示。                
軟體部分，我們利用 Matlab 提供的 Parallel Computing Toolbox(PCT)和 Matlab 
Distributed Computing Engine(MDCE)兩套軟體[15]，使用分散式運算實現部份濾波
法的平行處理。利用 PCT 可在多核心和多處理器電腦上使用 Matlab 執行任務及資
料平行計算，而無需為特定的硬體和網路架構編寫程式，藉此可將串列 Matlab 應用
程式轉換為並行 Matlab 應用程式。MDCE 提供基本的排程器(Scheduler)功能：
MathWorks Job Manager，來管理、監視、分配工作至多個不同硬體與軟體資源。利
用 Matlab 建置電腦叢集以進行平行處理的架構，如(圖六)所示。 
 由(圖六)可知Server需安裝PCT與MDCE，而Node安裝MDCE即可。Client利用
PCT撰寫平行處理程式，透過Scheduler分配給予各個Worker運算，其運算結果由
Scheduler作接收，等接收全部Worker的結果後，再將運算結果傳送給Client。 
 我們以建置電腦叢集系統來實現以部份濾波法進行高頻譜影像目標偵測之平行
處理。配合平行計算系統的Node數量，將AVIRIS影像依頻帶分群方式分為四個群
組，再將各群組資料以任務平行模式傳送給每一Node執行部份濾波的平行計算。當
所有Node執行完成時，其運算結果會透過Scheduler傳送至Client，再將各Node執行
部份濾波的結果 iy 結合得到(12)式的濾波結果  
p
i
iyy
1
。利用電腦叢集系統之平行
處理方式可以降低高頻譜影像處理所需耗費的時間。 
 11
五、 電腦模擬結果 
本節將以電腦模擬驗證本研究所提部份濾波法於高頻譜目標偵測的效能。實驗
中所採用的衛星影像為AVIRIS的影像，其頻帶數目為224，影像大小為200x200個像
素。 
首先，我們針對AVIRIS影像一如圖七(a)，依其對應之頻帶相關係數，以圖二決
定的門檻值 0.85th  作為頻帶合併的準則。經聚類頻帶分群後所對應的頻帶自相關
係數矩陣以圖七(b)的影像顯示，對應前四個群組所分配的頻帶如表一所示。此頻帶
分群的結果和文獻[16]針對AVIRIS影像的分群結果很近似，但[16]的頻帶分群和影
像無關，而本研究所提的聚類頻帶分群法可依影像之內容進行頻帶分群，且可適用
於不同的高頻譜影像。 
接著，我們將本本研究所提的訊號子空間投影法和部份濾波結合訊號子空間投
影法與韋恩濾波器法和雜訊子空間投影法比較；此外並將本研究所提部份濾波分別
與韋恩濾波器法和雜訊子空間投影法結合，以檢驗部份濾波法於目標偵測的效能。 
模擬中將針對顯著的地形特徵，如建築物、植被和水等進行目標偵測。實驗中，針
對不同的目標特徵隨機選取100取樣點進行濾波器設計，而目標偵測門檻值選取是利
用矩量保持法[17]來自動選擇其門檻值。目標特徵為建築物和水的偵測結果如圖八
和圖九所示。比較圖八和圖九可知利用濾波器法進行影像目標偵測時，以訊號子空
間投影法的偵測效果優於韋恩濾波器法和雜訊子空間投影法;而比較各種不同部份
濾波法，可知使用部份濾波結合韋恩濾器法與部份濾波結合雜訊子空間投影法的偵
測效果優於原來濾波器法。針對圖八(a) AVIRIS影像(二)以各種不同濾波法所偵測
的結果與人工選取的目標，進行比對並計算偵測錯誤率，經過100次的Monte Carlo
測試，平均錯誤率如表二所示。 
 最後，我們以建置的平行計算系統來實現論文所提的部份濾波法並進行目標偵
測的實驗。首先將圖八(a) AVIRIS影像(二)依頻帶分群方式分為四個群組，再將各
群組資料以任務平行模式傳送給每一Node執行部份濾波的平行計算。為檢驗平行計
算系統使用的Node數對平行處理效能的影響，實驗中執行測試A，B，C和D分別對應
平行計算系統的Node數為1、2、3和4。由各測試的執行時間計算速度提昇[18] 
1 NS T T   顯示於表三，其中 1T 為單顆CPU所需花費時間，而 NT 為 N 顆CPU所花
費的時間。由表三可知當Monte Carlo執行次數愈多時，平行處理的效益愈好，速度
提昇值愈大。但是在執行使用Node數為3和4的測試時，兩者的速度提昇值相差甚
小，這是因為頻帶分群不均勻而導致。若頻帶分群能夠均勻分配，使得平行計算系
統上各個Node得到相同的資料量，則平行處理的效能將更佳。 
 13
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖八  偵測目標為建築物的結果，(a) AVIRIS影像(二)，(b)人工選取的目標影像，
(c)韋恩濾波器法，(d)雜訊子空間投影法，(e)訊號子空間投影法，(f)部份濾波結
合韋恩濾波器法，(g)部份濾波結合雜訊子空間投影法，(h)部份濾波結合訊號子空
間投影法 
(a) (b)
(c) (d) (e)
(f) (g) (h)
 15
表三 速度提昇值比較 
速度提昇值(S) Monte Carlo 
執行次數 Nodes 數=2 Nodes 數=3 Nodes 數=4 
1 1.05 1.12 1.14 
10 1.09 1.14 1.14 
100 1.26 1.34 1.36 
1000 2.08 2.26 2.28 
2000 2.32 2.50 2.53 
4000 2.50 2.76 2.66 
6000 2.51 2.83 2.84 
8000 2.61 2.88 2.93 
10000 2.63 2.92 3.00 
 
 
六、 結論 
本計畫針對高頻譜影像發展一可平行處理的目標偵測技術，藉此技術來提
升影像目標偵測的精確性，並降低其計算複雜度。首先，提出訊號子空間投影
法設計最佳的濾波器，以進行影像目標偵測。此法以高頻譜影像所對應的訊號
子空間為基礎，透過子空間轉換萃取重要的特徵資訊，並以對應特徵為基礎設
計最佳的濾波器。接著，我們提出一結合部分濾波和訊號子空間的投影法降低
原來濾波器設計的計算量。此法，先以聚類頻帶分群法將將具高相關性的頻帶
群聚為一群組，針對每一群組以訊號子空間投影法設計最佳的部份濾波器，再
結合各群組的部份濾波器進行目標偵測。藉此將原來濾波器設計拆成由各群組
的部分濾波器合成，以減少頻帶數量達到降低目標偵測的計算量。模擬結果顯
示部份濾波法在目標偵測的錯誤率也較原本的濾波器法低。最後，我們以個人
電腦建構平行計算系統來實現部份濾波法，以進一步提昇高頻譜影像處理的效
能。模擬結果顯示，本研究所提部份濾波法，除了可減少原來濾波器法於高頻
譜影像處理的計算量，也提高了目標偵測的效能和處理速度。 
 
七、 參考文獻 
[1] S. B. Serpico and L. Bruzzone, “A new search algorithm for features election in 
 hyperspectral remote sensing images,” IEEE Trans. Geosci. Remote Sensing, vol. 
 39, no. 7, pp. 1360–1367, 2001. 
[2] L. M. Bruce, C. H. Koger, and J. Li, “Dimensionality reduction of hyperspectral data 
using discrete wavelet transform feature extraction,” IEEE Trans. Geosci. Remote   
Sensing, vol. 40, no. 10, pp. 2331–2338, 2002. 
[3] P. Bajcsy and P. Groves, “Methodology for hyperspectral band selection,” 
 17
計畫成果自評 
(A) 本研究已完成下列目標： 
(1) 本研究提出萃取影像特徵的訊號子空間投影法，改善影像目標偵測的精確度。 
(2) 本研究依高頻譜影像頻帶資料的相關性，提出聚類頻帶分群法將將具高相關性
的頻帶群聚為一群組，藉此減少高頻譜影像頻帶數。 
(3) 提出具平行處理架構的結合部分濾波法和訊號子空間投影法，改善影像目標偵
測的效率。 
(4) 個人電腦模擬測試完成。 
(5) 建構電腦叢集的平行計算系統。 
(6) 平行計算系統模擬測試完成。 
 
(B) 計畫執行過程中的困難及未來努力方向 
本計劃目前建置的平行計算系統僅使用四個 Node，未來可增加平行處理系
統的 Node 數量或利用 GPU 擁有大量的處理器特性搭配 CUDA 技術進行平行處
理，以提昇運算效能。 
 
(C )本研究執行的研究內容與原提計畫相符，並得到許多有興趣的結果。目前，已
有部分結果發表於國際會議論文 
Lena Chang , Ching-Min Cheng and Yang-Lang Chang, “An efficient hierarchical 
hyperspectral image classification using binary quaternion-moment-preserving 
thresholding technique,” Proc. 2009 IEEE International Geoscience and Remote 
Sensing Symposium (IGARSS’2009), Seato , WA, USA. 
 
近期正進行數據整理，擬將本計畫執行結果發表在學術期刊上。 
 
‧Finite Set Statistics 
‧Target Tracking 
‧Distributed Fusion 
‧Image Processing and Fusion 
‧Nonlinear Filtering 
‧Multistatic Tracking 
‧Data Fusion on Networks 
‧Classification 
‧Detection and Tracting 
‧Sensor Networks 
‧Situation Awareness 
‧Applications 
 
與筆者研究領域有關的是 Target Tracking, Classification 和 Image Processing and 
Fusion 等主題。 
   
在 Target Tracking 場次中，學者 Lawrence Stone 提出 Likelihood Ratio Detection 
and Tracking (LRDT)方法，不同於一般對目標物分別進行的偵測及估測，此法以衍生
Bayesian 法同時進行目標物的偵測及參數估測。特別是在低訊雜比和高 clutter density
下，一般偵測及估測法的效能都會變得很差，但 LRDT 法藉由引進無目標物存在的狀
態，導出遞回 Bayes Markov 判斷法則可改善目標物追蹤效能。另外，論文 “ A 
Scalable Method of Tracking Targets with Dependent Distributions”藉由考慮量測和目標資
料關連性(measurement-to-target associations)所產生的目標狀態間相關性，來提高多目標
追蹤的準確度。此外，作者在最小 information lost 的條件下建立目標集合的 disjoint 
trees，以減少目標追蹤的 swapping 次數。而筆者所提論文 “Adaptive Target Tracking for 
Wideband Sources in Near Field” 也在此場次中發表。非理想訊號源通常會造成現有方位
估測法效能衰減，此問題近年來也深受學界矚目，我們針對此研究主題，提出訊號子空
間校正法，將寬頻近場訊號轉為理想的窄頻遠場訊號，此法可有效且同時估測和追蹤寬
頻近場訊號源的方位和距離，並減少計算複雜度。 
 
在 Classification 場次中，論文 “GMTI and IMINT data fusion for multiple target 
tracking and classification” 利用 GMTI (Ground Moving Target Indicator) and IMINT 
(IMagery INtelligence)來追蹤地表多目標，此法考慮道路網路訊息並熔合資料訊息屬性
類別，藉此強化目標辨別度來改善追蹤效能。在 Distributed Fusion 場次中，論文 
“Estimation of the Degree of Independent Information in Distributed Data Fusion Systems”考
慮 local information 來建置分散資料熔合系統，提出事前資料熔合演算法估測於分散資
料熔合系統各節點的相關。 
 
2. 此次會議中發表之論文很多是學界和政府單位合作之成果，且大部分為一研究團
隊。相較之下，台灣從事相關研究者多為單打獨鬥，因此研究成果之貢獻亦較小，
且研究心得亦較無法傳承及累積，實在非常可惜，這對國家及學術界而言均為資源
浪費。希望有關單位能參考國外情形，訂定具體辦法，使政府或國防單位多支援學
術界之研發工作，而學術界研究亦可配合政府或國防單位需求。此外，希望政府也
能多投入些資源從事相關之研究，以提昇並增強我國防科技之發展力。 
 
3. 國內學術研究環境，近年來在國科會的倡導及補助下，已獲不少的提昇與改善。由    
    國人主辦之國際會議亦愈來愈多，但相較於外舉辦之國際會議所參與之國際知名學  
    者專家，國內仍稍嫌不足，建議今後國內主辦之國際會議應廣泛邀請國外知名學者， 
    並予以適當補助。藉此，除可吸收國外經驗、成果，提昇我學術形象，並可使國內 
    學者、研究生有機會獲得國際交流機會並增廣見聞。 
 
 
 (四) 攜回資料名稱 
 Fusion 2009 CD-ROM 一片 
 
 
 
 
