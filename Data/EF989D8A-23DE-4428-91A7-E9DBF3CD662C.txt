 II
行政院國家科學委員會補助專題研究計畫 ■ 成 果 報 告   □期中進度報告 
 
單封裝系統訊號完整性之前瞻整合研究-子計畫二:單封裝系
統高速互連結構設計資料庫之研究與建立 
Time-Domain Methods for Synthesizing Broadband 
Macro-Models of Coupled Interconnects in High-Speed 
Digital Circuits 
計畫類別： □個別型計畫  ■整合型計畫 
計畫編號：NSC 96－2221－E－002－082－ 
執行期間： 2007 年 08 月 01 日至 2008 年 07 月 31 日 
 
計畫主持人：吳宗霖 教授 
共同主持人： 
計畫參與人員：  
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
本成果報告包括以下應繳交之附件： 
□赴國外出差或研習心得報告一份 
□赴大陸地區出差或研習心得報告一份 
□出席國際學術會議心得報告及發表之論文各一份 
□國際合作研究計畫國外研究報告書一份 
處理方式：除產學合作研究計畫、提升產業技術及人才培育研究計畫、
列管計畫及下列情形者外，得立即公開查詢 
          □涉及專利或其他智慧財產權，□一年□二年後可公開查詢 
          
執行單位：國立台灣大學電機工程學系暨研究所 
中   華   民   國  2008  年   10  月   20  日 
 IV
 
Contents 
 
Abstract .................................................................................................... i 
Contents ................................................................................................. iii 
List of Figure ........................................................................................... v 
List of Tables ............................................................................................ x 
 
1 Introduction .............................................................................. 1 
1.1 Research Motivations.......................................................................................1 
1.2 Literature Survey .............................................................................................1 
1.3 Contributions....................................................................................................3 
1.4 Chapter Outline ................................................................................................5 
 
2 Time-Domain Measurement and FDTD Method ............................. 6 
2.1 Time-Domain Reflectometry (TDR) Theory ...................................................6 
2.1.1 One-port measurement ............................................................................6 
2.1.2 Two-port measurement .........................................................................10 
2.1.3 Differential measurement ......................................................................12 
2.2 Finite-Difference Time-Domain (FDTD) Method .........................................15 
 
3 Broad-Band Models Extraction of the Multi-Conductor Coupled 
Interconnect ....................................................................................... 21 
3.1 Layper Peeling Technique (LPT) ...................................................................21 
3.2 Multi-Dimensional Deconvolution Theory (MDA) .......................................25 
3.3 Examples ........................................................................................................33 
 VI
 
List of Figures 
 
2.1.1 The diagram of Time-Domain Reflectometry (TDR) .........................................6 
2.1.2 The typical waveform shapes of TDR ................................................................7 
2.1.3 Virtual lumped interconnect discontinuities .......................................................8 
2.1.4 TDR responses of capacitive and inductive discontinuities................................8 
2.1.5 TDR measurement responses of two types of transmission lines (a) test 
transmission line structures (b) voltage waveforms (c) impedance waveforms 
  ............................................................................................................................9 
2.1.6 The diagram of Time-Domain Reflectometry (TDR) .......................................10 
2.1.7 (a) the neighboring through-hole vias (b) TDT waveforms of through-hole vias 
with different signal rising time. ...................................................................... 11 
2.1.8 Differential TDR waveforms ............................................................................12 
2.1.9 Differential TDR measurement for package .....................................................12 
2.1.10 (a) test example of differential line (b) differential mode impedance profile 
measured by TDR (c) common mode impedance profile measured by TDR 
 ..........................................................................................................................13 
2.1.11 Equivalent lumped model of the differential pair ...........................................14 
2.2.1 Space lattice diagram of field placement in a unit cell .....................................16 
2.2.2 One dimensional space-time chart by the leapfrog arrangement ......................17 
2.2.3 Absorbing boundary ..........................................................................................17 
2.2.4 Resistive voltage source ....................................................................................18 
2.2.5 Simulated TDR-response by FDTD ..................................................................19 
2.2.6 The comparison of signal rising-time ...............................................................19 
2.2.7 FDTD processing flowchart ..............................................................................20 
 
 VIII
compensation (b) with capacitor compensation ...............................................38 
 
3.3.9 The equivalent distributed SPICE model of the coupled lines with the symmetric 
ground slot .......................................................................................................38 
3.3.10 The synthesized impedance profile of Z11 and Z21 of each CCTL unit along the 
signal trace .......................................................................................................39 
3.3.11 Even-odd mode impedance profile. It can divide into five regions with: A: 
non-coupled region, B: transition region at the 90 degree bend, C: uniform 
coupled region, D: slot region, and E: uniform coupled region with open load .. 
 ..........................................................................................................................39 
3.3.12 Return current diagrams of symmetric ground-slot (a) even mode current, (b) 
odd-mode current .............................................................................................40 
3.3.13 Even-odd mode impedance profile with capacitor compensation ..................41 
3.3.14 The modeling structure of the three conductor coupled lines with W=1.51mm, 
g=0.753mm in FR4 board with the dimension of 5.42cm× 3.81cm× 0.8mm ..... 
 ..........................................................................................................................41 
3.3.15 The equivalent distributed SPICE model of the three conductor coupled lines with 
a perfect ground plane ......................................................................................42 
3.3.16 The impedance profile with mutual- and self-impedance. It can divide into four 
regions with: A: non-coupled region, B: transition region at the 90 degree bend, C: 
uniform coupled region, and D: open region ...................................................43 
3.3.17 The comparison of the time-domain response by between the FDTD simulation 
and the extracted model (a) V11 and V21, (b) V22 and V13 .................................44 
3.3.18 The comparison of the frequency response between the FDTD simulation and the 
extracted model (a) S11 magnitude, (b) S11 phase .............................................45 
3.3.19 The comparison of the frequency response between the FDTD simulation and the 
extracted model (a) S21 magnitude, (b) S21 phase .............................................45 
3.3.20 The comparison of the frequency response between the FDTD simulation and the 
extracted model (a) S31 magnitude, (b) S31 phase .............................................45 
 X
direct FDTD simulated results .........................................................................68 
4.7.10 Comparison of S11 between the extracted model and FDTD simulation ........68 
4.7.11 Comparison of S21 between the extracted model and FDTD simulation ........69 
4.7.12 Comparison of S31 between the extracted model and FDTD simulation ........69 
4.7.13 Comparison of S41 between the extracted model and FDTD simulation ........70 
4.7.14 The eigenvalues of the proposed macro-π models of the differential vias .....70 
 
 
 
List of Tables 
 
 
4.1 Extracted poles of asymmetric vias from macro-π model representations ..........60 
4.2 Extracted residues of asymmetric vias from macro-π model representations .....60 
4.3 Extracted Lump-elements of asymmetric vias from macro-π model representations
..........................................................................................................................64 
4.4 Extracted poles of of differential via from macro-π model representations ........66 
4.5 Extracted residues of differential via from macro-π model representations ........66 
4.6 Extracted lump-elements of differential via from macro-π model representations .
............................................................................................................................6
 2
Rational function representation of single-ended or coupled interconnects 
calculated from the S-parameter or impedance matrix is another important approach to 
obtain the equivalent models [18]-[25]. The equivalent circuits were constructed of 
traditional lump devices (R, L, C), controlled sources, or ideal transformers [18]-[22] 
from the pole-residue representations. Dispersive single-ended transmission line was 
discussed and modeled by the per-unit-length (p.u.l) impedance (R, L) or admittance (C, 
G) from the series first-order Debye-type rational functions [23]. Multi-port dispersive 
transmission lines were considered in [24], [25], but the proposed 
transmission-line-oriented lump-models are efficiently for the uniform distributed 
transmission lines without including the parasitic effect, such as bended transmission 
line or via transient. The macro-models extracted from the pole-residual representations 
usually have the advantages of broadband response and high accuracy, but the stability 
and passivity of the models have to be ensured. The stability of the models can be 
achieved by having the stable modes with the poles in the left half of the s plane and the 
criterion for passivity is all eigenvalues of the real part of the admittance matrix of the 
models are positive or zero [26], [27].  
Most of the techniques described previously are based on frequency-domain 
measurement or simulation [28]-[31]. Time-domain technique is the other important 
topic for equivalent model extraction in high-speed digital circuits. From the sequence in 
time-domain, the informations caused by the discontinuities can be easily obtained. 
Time-domain measurement by Time-Domain Reflectometry (TDR) or time-domain 
numerical simulation, like Finite-Difference Time-Domain (FDTD) method, are two 
popular approaches. TDR employs a step source with fast rising edge (ps). The position 
and characterization of the discontinuities can be detected by the reflection wave. The 
coupling behavior between neighboring interconnects can also be determined by the 
time-domain transmission (TDT) measurement. Several works based on the layer 
peeling technique (LPT) have been contributed to the equivalent model extraction from 
the time-domain data [32]-[34], but they all focus on a single interconnect. The 
impedance profile of any non-uniform transmission line can be extracted from the 
 4
parameters. In this approach, only one excitation source is needed. According to the 
scattered voltage waveform in time-domain at each port with changing the excitation 
port respectively, the macromodel using cascaded coupled transmission line (CCTL) 
systems can be efficiently synthesized by the MDA. The stability and passivity are kept 
for the macromodel because each synthesized unit is in passive causal mode. The 
proposed approach can be applied to the time-domain data either from TDR 
measurement or FDTD simulation. This approach is suitable both in asymmetric and 
symmetric interconnects, such as the asymmetric ground plane effect, differential pair, 
or transmission bus. The correlation between even/odd mode impedance and the 
proposed model is also formulated [40]. This model has the advantage of good accuracy 
and broadband response although the loss factor is not considered. 
Another topic in this dissertation is focused on the development of a time-domain 
approach to construct the equivalent model of through-hole vias based on a broadband 
macro-π model. The generalized pencil of matrix method (GPOM) [50]-[55] is 
employed to construct the time-domain step response of the differential vias using the 
rational functions, according to either the measured or simulated time-domain 
reflected/transmitted waveforms. The macro-π model in terms of the rational functions 
pairs is obtained through a two-port ABCD matrix transformation [56]. The order of the 
macro-π model can be minimized using an order reduction procedure without losing the 
accuracy according to the residue criterion. Finally, an equivalent lumped circuit of the 
macro-π model is synthesized by a systematic lumped-circuit extraction technique 
(SLET) [51], [57]. The passivity and stability of the extracted models based on the 
proposed approach can be assured by the passivity definition. Symmetric or asymmetric 
through-hole vias can be applied in the proposed method.  
1.4 Chapter Outline 
In chapter 2, TDR/TDT operation and FDTD method for simulating the TDR 
behavior will be briefly introduced. In chapter 3, layer peeling technique for 
single-ended interconnect is reviewed. A novel time-domain algorithm based on the 
 6
Chapter 2  
Time-Domain Measurement and FDTD Method 
 
 
Time-Domain Reflectometry (TDR) has popularly used to characterize the signal 
integrity (SI) [61]-[67] of board, package, connector, or other interconnects, due to the 
very fast signal rising time (ps). The designer can perform the SI analysis, such as 
impedance design, crosstalk, or ringing effect, direct from the TDR measurement. 
Full-wave simulation like Finite-Difference Time-Domain (FDTD) based on Maxwell’s 
equations is one of the most popular methods to solve the electromagnetic problems. It 
is very helpful to correctly predict the time-domain or frequency-domain behaviors in 
the design level with a careful structure modeling. The operation theory of TDR and 
FDTD method for simulating the TDR behavior will be introduced. 
 
 
2.1 Time-Domain Reflectometry (TDR) Theory 
 
2.1.1 One-port measurement 
TDRV
stepV rV
stT eDR p rV V V= +
DUT     Time-DomainReflectometry (TDR)
 
Fig. 2.1.1 The diagram of Time-Domain Reflectometry (TDR). 
 
Fig. 2.1.1 shows the function of TDR measurement. TDR is composed of a step 
generator and a sampling circuit. The step source (Vstep(t)) with the signal rising-time τ is 
injected into the device under test (DUT), and the reflected wave caused by the 
discontinuity is detected and denoted as Vr(t). VTDR(t) is the summation of the step 
 8
shunt capacitor appears the dip variation. The positive reflection coefficient caused by 
series inductor appears a peak variation, as shown in Fig. 2.1.4, is contrary to be 
observed. 
0Z 0Z
0Z0Z
C
L  
Fig. 2.1.3 Virtual lumped interconnect discontinuities. 
 
0
stepV
capacitive dip
0
stepV
inductive peak
 
Fig. 2.1.4 TDR responses of capacitive and inductive discontinuities. 
 
Fig. 2.1.5(a) shows two types of the manufactured transmission lines with different 
line impedance. The voltage waveforms measured by TDR (HP 54750A) is shown in Fig. 
2.1.5(b). The characterization of the transmission line can be judged easily and the 
impedance profile of the DUT can be obtained by direct measurement, shown in Fig. 
2.1.5(c) or through the layer peeling technique (LPT), which will be described in next 
chapter. 
 10
The integration formulations corresponding to the impedance profile are in general 
adopted to evaluate the value of lump element of discontinuity from the TDR 
measurement with the advantage of easy implementation. The formulations are derived 
as   
 
2
1 0
1 1
2 ( )
t
t
C dt
Z t
= ⋅∫  (2.1.2a) 
2
1
0
1 ( )
2
t
t
L Z t dt= ⋅∫  (2.1.2b) 
 
where the Z0(t) is the impedance profile in time-domain, t1 and t2 are the time instants at 
the boundary of positive or negative glitch. The factor 1/2 is due to the round-trip 
propagation time. Although the integration formulations provide a quick and simple 
method to calculate the lump element values, the accuracy will decrease when the 
reflected waveform (or impedance profile) becomes complicated.  
 
 
2.1.2 Two port measurement 
stepV rV
TDTV
Coaxial cable
    Time-Domain 
Reflectometry (TDR) DUT
 
Fig. 2.1.6 The diagram of Time-Domain Reflectometry (TDR). 
 
Two-port measurement is another important application for the TDR/TDT 
measurement. The crosstalk noise between the neighboring interconnects, like package 
leads, connector pins, or neighboring transmission lines, can be easily detected by 
Time-domain transmission (TDT) measurement. Fig. 2.1.6 shows the TDT measurement 
setup. The step source (Vstep = 0.2) with signal rising-time (τ) is injected into the DUT 
 12
Differential signal is very useful for high speed digital circuit design to achieve 
higher noise immunity. Differential mode signal means that the signals are driven with 
equal magnitude and 180o out of phase. Fig. 2.1.8 shows the excited differential mode 
source of TDR without a terminated load. The measurement setup of Differential TDR is 
shown in Fig. 2.1.9. 
 
 
Fig. 2.1.8 Differential TDR waveforms. 
 
V +
V −
Differential TDR 
 measurement
   Time-Domain  
Reflectometry (TDR)
Fi
g. 2.1.9 Differential TDR measurement for package.  
 
Differential- and common-mode impedance measured by Differential TDR can be 
used to characterize the coupling between the lines. A test differential pair in FR4 board, 
as shown in Fig. 2.1.10(a) with the line width 2.68mm and line space 1mm is measured 
by the Differential TDR. The impedance profile shown in Fig. 2.1.10(b) is kept about 
100Ω below 0.25ns and in Fig. 2.1.10(c) kept about 25Ω due to the non-coupled 
terminated coaxial cables (50Ω). The region above 0.5ns is the designed differential pair.   
0 2E-010 4E-010 6E-010 8E-010
t (s)
-0.2
0
0.2
0.4
0.6
V T
D
R
+
Differential mode 
V+
V-
-0.6
-0.4
-0.2
0
0.2
VTD
R
-
 14
The relationships between differential and odd, common and even mode 
impedances are concluded as 
 
     2differential oddZ Z= ⋅  (2.1.3a) 
/ 2common evenZ Z=  (2.1.3b) 
 
The corresponding lump model (Ls, Lm, Cs, and Cm) of the differential pair is shown 
in Fig. 2.1.11. 
sL
sL
mL
sC
sC
mC
 
Fig. 2.1.11 Equivalent lumped model of the differential pair. 
 
The values of the lumped elements can be obtained from the even (common) and 
odd (differential) mode impedance profile and the corresponding propagation time, 
expressed as [40] :      
( )1
2s even even odd odd
L Z t Z t= +  (2.1.4a) 
( )1
2m even even odd odd
L Z t Z t= −  (2.1.4b) 
1
2
odd even
m
odd even
t tC
Z Z
⎛ ⎞= −⎜ ⎟⎝ ⎠  (2.1.4c) 
1
2
odd even
total s m
odd even
t tC C C
Z Z
⎛ ⎞= + = +⎜ ⎟⎝ ⎠  (2.1.4d) 
where event and oddt  are the propagation time of even mode and odd mode signal, 
respectively.  
 16
( ) ( )1 1/ 2 1/ 2 1/ 2 1/ 2_ , , _ , , _ 1, , _ , , _ , 1, _ , ,n n n n n nz i j k z i j k y i j k y i j k x i j k x i j kt tE E H H H Hx yε ε+ + + + ++ +Δ Δ= + − − −Δ Δ  (2.2.2f) 
 
where ,  ,  x y zΔ Δ Δ is the space increments, tΔ  is the time increment, n is the time step.  
 
The arrangement of E-field and H-field in space and time are shown in Fig. 2.2.1 
and Fig. 2.2.2, respectively. Equation (2.2.2) states that each of the E-field and H-field at 
any space lattice in next time step depends on the adjacent points and its previous value. 
It is noted that the numerical stability should be enforced for any spatial mode.  The 
stability condition is derived as: 
 
max
2 2 2
1 1
1 1 1
t
v
x y z
Δ ≤
+ +Δ Δ Δ
 (2.2.3) 
where vmax is maximum propagation speed. Usually, the value of vmax is set equal to the 
light speed ( 0 01/c μ ε= ).  
 
E i j kx ( , , )
E i j kz ( , , )
E i j ky ( , , )+1
E i j kz ( , , )+1
E i j kx ( , , )+1
E i j kz ( , , )+ +1 1
E i j ky ( , , )+1
E i j ky ( , , )+ +1 1
E i j kx ( , , )+ +1 1
H i j ky ( , , )
H i j ky ( , , )+1
H i j kx ( , , )
H i j kx ( , , )+1
H i j kz ( , , )
H i j kz ( , , )+1
E i j ky ( , , )
E i j kz ( , , )+1
x
yz
Δx
Δz
Δy
 
Fig. 2.2.1 Space lattice diagram of field placement in a unit cell. 
 
 18
1 1/ 20 0
, , , , , ,
0 0
1/ 20
0
1
2| | |
1 1
2 2
             
1
2
n n ns r r
z i j k z i j k i j k
s r s
ns r
S
s r
t z t
R x yE E Ht z t z
R x y R x y
t
R x y Vt z
R x y
ε ε ε ε
ε ε ε
ε ε
ε ε
+ +
+
Δ Δ Δ⎛ ⎞ ⎛ ⎞−⎜ ⎟ ⎜ ⎟Δ Δ= + ∇×⎜ ⎟ ⎜ ⎟Δ Δ Δ Δ⎜ ⎟ ⎜ ⎟+ +⎜ ⎟ ⎜ ⎟Δ Δ Δ Δ⎝ ⎠ ⎝ ⎠
Δ⎛ ⎞⎜ ⎟Δ Δ+ ⎜ ⎟Δ Δ⎜ ⎟+⎜ ⎟Δ Δ⎝ ⎠
 (2.2.4) 
where the inner resistance sR  is 50Ω , SV  is a step source with the signal rising time tr 
(10% ~ 90%). The expression of SV  modeled in FDTD is 
 
2( ) 0.4 1 expS
r
n tV t
t
⎡ ⎤⎛ ⎞− ⋅ ⋅ Δ= −⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦  (2.2.5) 
 
where n is time step in FDTD and tr is the corresponding rising time of the step input. 
 
sR
rt
sV
Resistive voltage
       source
10% ~ 90%  
Fig. 2.2.4 Resistive voltage source. 
 
FDTD simulation is employed in this work for the purpose of replacing the TDR 
measurement because it has been shown that the simulated reflected time-domain 
voltage waveform can be very consistent with a real measurement by TDR if the 
excitation source in (2.2.5) can be carefully modeled in the FDTD simulation. A test 
example of 50Ω transmission line in PCB board (εr = 4.3) with the dimension of 
 20
        
Begin
Define grid
Calculate non-time varying 
           parameters
Update E-field at all points
Update source conditions
Update boundary conditions
Update H-field at all points
Saving Data
timestep?n =
End
DFT
Frequency response
1n n= +
 
Fig. 2.2.7 FDTD processing flowchart. 
 
 22
1x
1Z
dT
1, j
a−
1, j
b−
( )I t
2x
2Z
dT
3x
dT
ix
iZ
dT
,i j
a−
,i j
b−
,i j
b +
,i j
a+
, 1i j
b +
+
, 1i j
a +
+
( )V t
0Z 2Z1
Z
1X 2X 3X
X←Δ →
1iZ +
1ix +( )inV t
sZ
Observed point
Distance along line
Im
pe
da
nc
e
Fi
g. 3.1.1 The discrete non-uniform transmission line diagram with the composed of 
equal-length uniform sections. 
 
, where Vin(t) is the excitation step source and Zs is the source impedance. And its 
discretized representation is 
( )2 .jI I j t= Δ  (3.1.3) 
The voltage and current at the observation point can be transformed as 
right-traveling and left-traveling waves: 
1,
1
2
j
j j s
s
V
a I Z
Z
− ⎡ ⎤= +⎢ ⎥⎢ ⎥⎣ ⎦
 (3.1.4a) 
1,
1
2
j
j j s
s
V
b I Z
Z
− ⎡ ⎤= −⎢ ⎥⎢ ⎥⎣ ⎦
 (3.1.4b) 
At any junction ix x=  the waves are designated as shown in Fig. 3.1.1, ,i ja−  
being the right-traveling wave at location ix ε− , and ,i ja+  the right-traveling wave at 
ix ε+ , where 0ε → . The left-traveling waves ,i ja−  and ,i jb−  are similarly defined, 
 24
impedance and the same propagation time. The simulated or measured voltage wave 
(VTDR) shows in Fig. 3.1.2(b) at the observed point is needed for the LPT to extract the 
impedance profile. The calculated line impedance profile by LPT is quite coincident 
with the designed one, as shown in Fig. 3.1.2(c). 
 
70 Ohm 100 Ohm 40 Ohm50 Ohm 50 Ohm
1 ns 1 ns 1 ns0.4 V
TDRV
 
(a) 
0 1 2 3 4 5 6 7
t (ns)
0.05
0.1
0.15
0.2
0.25
0.3
V T
D
R
 (v
ol
t)
 
(b) 
0 1 2 3 4 5 6 7
t (ns)
20
30
40
50
60
70
80
90
100
110
Li
ne
 Im
pe
da
nc
e 
(O
hm
)
 
(c) 
Fig. 3.1.2 Test example of Layer Peeling Algorithm (a) the schematic line impedance (b) 
time domain voltage profile (c) calculated impedance profile. 
 26
at the near-end of conductor n (or port n), where 1,  2,   n N= L , and 1,  2,   m N= L . For 
convenience of following macromodel extraction, all the near and far ends of the 
multi-conductor transmission system are terminated with 50Ω loads. 
 
GND
1nV2nVnnVnNV
12iN
Near End
Far End
rε
Fig. 3.2.2 The schematic non-uniform N+1 multi-conductor coupled interconnects. 
 
To fit the time-domain response of the N+1-conductor coupled interconnects, we use 
the configuration-oriented coupled transmission lines (CCTL) as a unit basis (or a section) to 
construct the macromodel of general coupled interconnects. By cascading several CCTL 
section with different propagation characteristics, arbitrary time-domain response waveform 
can be synthesized. The reason we call macromodel is that each CCTL unit is not necessary 
to correlate with physical structure of the coupled interconnects at each corresponding 
cross-section. Fig. 3.2.3 shows a CCTL unit for the N+1-conductor coupled interconnects. It 
consists of M  ideal transmission lines of the same length xΔ and propagation 
delay /t x vΔ = Δ , where ( 1) / 2M N N= +  and v  is the propagation velocity of the CCTL 
section. The characteristic impedance of the M transmission lines at section i is denoted as 
i
nmZ ( 1,  2,  ,  n N= L  and  ,  1,  ,  m n n N= + L ) which represents the impedance between 
conductor n and m if n m≠  and the impedance between conductor n and the conductor 0 
(reference ground) if n m= . 
 28
The MDA is used to synthesize the corresponding propagation characteristics of each 
CCTL according to the scattered voltage waveform ( )mnV t  with ,  1,  2,   n m N= L . We 
first decompose the time-domain voltage waveform at the conductor m to the right-traveling 
( , )mnVR x t  and left-traveling ( , )mnVL x t  voltage wave, where the step source is excited at 
conductor n and x  is the position of the transmission system. As shown in Fig. 3.2.4, the 
right- and left-traveling voltage wave at the junction between the 1inmZ
−  and inmZ  
transmission lines, where 1 , 2,   ,  m N= L , can be discretized as 
 
( , ) ( ,  ( 2( 1)) )mnVL i j VL x i x t i j tε− = = Δ − = + − Δ  (3.2.1a) 
( , ) ( ,  ( 2( 1)) )mnVL i j VL x i x t i j tε+ = = Δ + = + − Δ  (3.2.1b) 
( , ) ( ,  ( 2( 1)) )mnVR i j VR x i x t i j tε− = = Δ − = + − Δ  (3.2.1c) 
( , ) ( ,  ( 2( 1)) )mnVR i j VR x i x t i j tε+ = = Δ + = + − Δ  (3.2.1d) 
 
where 0ε →  and the source is excited at port n with n = 1, 2, …, N.  
 
Form the continuity of voltage and current at conductor m (or port m) between sections 
1i −  and i , we have 
 
( , ) ( , ) ( , ) ( , )mn mn mn mnVL i j VR i j VL i j VR i j
− − + ++ = +  (3.2.2a) 
1( ( , ) ( , )) / ( ( , ) ( , )) /
Ni i
kmn mn mm mn kn km
k m
VR i j VL i j Z VR i j VR i j Z− − − −=≠
− + −∑  
k=1
k m
- ( ( , ) ( , )) /N imn kn kmVL i j VL i j Z
− −
≠
−∑  
1 1
1=( ( , ) ( , )) / ( ( , ) ( , )) /
Ni i
kmn mn mm mn kn km
k m
VR i j VL i j Z VR i j VR i j Z+ + + + + +=≠
− + −∑  
1
k=1
k m
- ( ( , ) ( , )) /N imn kn kmVL i j VL i j Z
+ + +
≠
−∑         
(3.2.2b) 
Applying equations (3.2.2a) and (3.2.2b) from port 1 to port N , i.e., 1 , 2,   ,  m N= L , 
a transfer matrix form of voltage variables ( , )nVR i j
+  and ( , )nVL i j
+  can be expressed as    
                
 30
1
1i iZ Z P Q
−
−=  (3.2.6) 
 
where 1 2( ,  ,  ,  )NP p p p= …  with column vector ( ,1) ( ,1)n n np VR i VL i− −= − and 
1 2( ,  , ,  )NQ q q q= L  with column vector ( ,1) ( ,1)n n nq VR i VL i− −= + . 
 
At this point, equation (3.2.6) has presented how to synthesize the impedance matrix 
iZ  of section i  by the first interval time-domain incident wave (or right-traveling) and 
reflected wave (or left-traveling wave) with varying excitation port from 1 to N. We have 
also derived the equations such that, given the right- and left-traveling waves to the left of 
any junction i , we can calculate the right- and left-traveling waves to the right of the 
junction by (3.2.3) if the impedance matrix 1iZ −  and iZ  are known. What remains now is 
to relate the right- and left-traveling waves at junction i  to those at junction 1i + . 
Since the translation by xΔ along any of the iZ  section corresponds to a time shift of 
 t±Δ  for the right ( )t−Δ  and left ( )t+Δ  traveling waves. Using the indexing from (3.2.1), 
we obtain  
 
( 1, ) ( , )n nVR i j VR i j
− ++ =  (3.2.7a) 
( 1, ) ( , 1)n nVL i j VL i j
− ++ = +  (3.2.7b) 
  
,where 1,  2,  3,  ,  j L i= −L  and L is the sampling numbers of the excitation or response 
waveform at the near end of the multi-conductors system. 
 
This completes the derivations for deconvolution of one layer of the multi-conductors 
transmission lines and a translation to the next junction. The entire process is summarized in 
the following algorithm: 
(a) Simulating the time-domain near-end responses of the N+1 multi-conductors 
system with locating the excitation source from port 1 to N, respectively. 
Recording all the voltage waveforms ( )mnV t  with the exciting port n = 1, 2… N, 
and the receiving port m = 1, 2… n.  
 32
can be derived as  
 
112even comZ Z Z= =  (3.2.8a) 
( )11 21 21 111 / 22odd diffZ Z Z Z Z Z= = +  (3.2.8b) 
 
where Z11 and Z21 are the same with the definition in Fig 3.2.5. The flow-chart of 
modeling extraction procedure is shown in Fig. 3.2.6.  
 
1
1i iZ Z P Q
−
−=
1
1 12 2 2 22 1 2 1
( , ) ( , )
( , ) ( , )
n n
i i i iN N N Nn nN N
VR i j VR i jI I I I
Z Z Z ZVL i j VL i j
−+ −
+ −− −× ×× ×
⎡ ⎤ ⎡ ⎤⎡ ⎤ ⎡ ⎤=⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥− −⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦⎣ ⎦ ⎣ ⎦
    mnV ⇒
0A known   ,    1Z i =
( , )
( , )
nn
nn
VR i j
VL i j
−
−
1,2,....,
1,2,....,
n N
m N
=
=
( 1, ) ( , )
( 1, ) ( , 1)
n n
n n
VR i j VR i j
VL i j VL i j
− +
− +
+ =
+ = +
Begin
Calculate the impedance matrix
       of next CCTL section
Calculate the boundary voltage relation matrix at
                  the junction of CCTL
Update time and position sequence
          of the voltage matrix
?i N=
End
1i i= +
 
Fig. 3.2.6 The modeling extraction procedure of MDA.  
3.3 Examples 
 34
0.1215mm, Δz = 0.1mm, and Δt = 0.18ps. A step resistive voltage source of amplitude 
0.4V and rise time 45ps is excited at port 1 and port 2, respectively. The time-domain 
scattered data 11( )V t , 22 ( )V t  and 21( )V t  simulated by FDTD are used to synthesize the 
macro-model of the asymmetrical differential pair. Fig. 3.3.2 shows the corresponding 
CCTL unit consisting of three coupled transmission lines (M = 3).  
 
 
1 11 , id iT Z
1 21 , id iT Z
1 22 , id iT Z 12 122, id iT Z+ +
1
2
1
21, id iT Z+ +
1
2
1
11, id iT Z+ + 11 , 
i n
dn
i nT Z+ +
21 , i ndn i nT Z+ +
22 , i ndn i nT Z+ +
SR
SR
LR
LR
Fig. 3.3.2 The equivalent distributed SPICE model of the coupled lines with the 
asymmetric ground slot. 
 
 
Fig. 3.3.3 The synthesized impedance profile of Z11, Z22, and Z21 of each CCTL unit 
along the signal trace. 
 
 
Fig. 3.3.3 shows the synthesized impedance profile of Z11, Z22 and Z21 of each 
0 0.03 0.06 0.09 0.12 0.15 0.18 0.21 0.24 0.27
t(ns)
0
30
60
90
120
150
O
hm
 ( 
Z1
1 
&
 Z
22
 )
Z11
Z22
0
100
200
300
400
500
O
hm
 (Z21)
Z21
 36
in time- and frequency-domain. The time-domain responses ( 11( )V t , 22 ( )V t  and 21( )V t ) 
of the cascaded models are calculated in the SPICE as shown in Fig. 3.3.4. The coupling 
ratio of ground slot can be enhanced to 22.5% in 45ps signal rising time. The agreement 
is quite consistent with the results simulated by FDTD method. Fig. 3.3.5(a) and (b) 
show the amplitude and phase of 11( )S f , respectively. The results calculated both by 
the macromodel and FDTD method are presented for comparison. The agreement 
between them is good in broadband frequency from DC to 7 GHz. The accuracy of the 
extracted model for other port ( 21( )S f and 22( )S f ) is also good, as shown in Fig. 3.3.6 
and 3.3.7, respectively. The reason we show the frequency response only up to 7 GHz is 
that the rise time of the excitation source is rt = 45ps, where the bandwidth of the signal 
source is about 0.35/ 7.7rt ≅ GHz. The higher frequency response can be obtained if the 
macromodel is synthesized using faster rising edge source. 
 
 
0 1 2 3 4 5 6 7
GHz
-70
-60
-50
-40
-30
-20
-10
0
10
dB
        S11
simulation
extracted model
0 1 2 3 4 5 6 7
GHz
-200
-150
-100
-50
0
50
100
150
200
de
g
        S11
simulation
extracted model
     (a)                                   (b) 
Fig. 3.3.5 The comparison of the frequency response up to 7 GHz between the FDTD 
simulation and the extracted model (a) S11 magnitude, (b) S11 phase. 
 
 
 
 
 38
using the equation (3.2.8), even-mode and odd mode impedance profile can be 
directly calculated and shown in Fig. 3.3.11.  
 
   
L
1W
2W
1g
2g
Near End Far End
port2port1
GND
GND slit
 
Near End
port1
GND
L
1g
2g
Far End
port2
1W
GND slit
capacitor
2W
 
(a)                               (b) 
Fig. 3.3.8 The modeling structure of the differential pairs crossing symmetrical 
ground slot with W1 = 2.96mm, W2 =2.4mm, g1 = 1.2mm, g2 = 1.48mm, L = 18.4mm 
in FR4 board with the dimension of 11cm× 8.5cm× 1.6mm (a) without capacitor 
compensation (b) with capacitor compensation. 
 
SR
SR
LR
LR1 11 , id iT Z
1 21 , id iT Z 12 121, id iT Z+ +
1
2
1
11, id iT Z+ + 11 , 
i n
dn
i nT Z+ +
21 , i ndn i nT Z+ +
1 11 , id iT Z 12 111, id iT Z+ + 11 , i ndn i nT Z+ +
Fig. 3.3.9 The equivalent distributed SPICE model of the coupled lines with the 
symmetric ground slot. 
 
The even/odd mode impedance profiles can be divided into five regions (A to E) 
in Fig. 3.3.11. In region A, even/odd mode impedance is kept at 50Ω with the 
negligible mutual coupling between two traces. Region B is the transient due to the 
90-degree bend. Region C and E are the uniform coupling region, where two traces 
are in parallel with even and odd mode impedance uniformly kept at about 64Ω and 
43.5Ω, respectively. The values of evenZ  and oddZ  calculated by the software 
 40
As shown in Fig. 3.3.12, the return current diagram simulated by the FDTD 
method on the ground plane can also show the difference of the impedance mismatch 
between the even and odd modes. It is seen that significant portion of the even-mode 
signal is reflected by the slot. Contrary to even-mode signal, most of the odd-mode 
signal is smoothly passed the slot due to the virtual ground between the differential 
pairs. It is thus reasonable that the signal integrity of the differential type signal is less 
sensitive to the disturbance of the referenced ground. 
   
(a) 
   
(b) 
Fig. 3.3.12 Return current diagrams of symmetric ground-slot (a) even mode current, 
(b) odd-mode current.  
 
Adding a SMT capacitor between two sides of the etched slot beneath the two 
traces, as shown in Fig. 3.3.8(b), can provide a low impedance path for 
high-frequency transient current on the ground plane. The signal quality can be kept 
with the shorter return path. The impedance profile of the even and odd mode signal is 
shown in Fig. 3.3.13. Compared with even-mode impedance in Fig. 3.3.11, it is seen 
that Zeven has relatively smaller variation about 15% at the slot discontinuity because 
of the improved return path on the ground plane. Zodd is almost the same with the 
previous case without adding capacitors. The value of the capacitor used in this 
example is 1 nF.         
 42
designed as 50Ω. It is a case of four-conductor transmission line with geometrical 
symmetry to the center trace (N = 3). As shown in Fig. 3.3.15, the macromodel of the 
parallel traces can be synthesized by cascading the CCTL units with M = 6.The 
time-domain scattered data at the near-ends 11 33( ) ( )V t V t= , 12 23( ) ( )V t V t= , 22 ( )V t , 
and 13 ( )V t  are recorded based on the FDTD simulation with the excitation of 
resistive step voltage source of 45ps rise time. The FDTD variables are Δx = Δy = 
0.251mm, Δz = 0.2mm, and Δt = 0.3ps. Following the model extraction procedures 
described in section 3.2, the self-impedance ( 11 33Z Z=  and 22Z ) and mutual- 
impedance ( 12 32Z Z=  and 13Z ) can be synthesized and are shown in Fig. 3.3.16.  
 
sR
sR
sR
 , 22  n i nT Z +
 , 11  n i nT Z +
 , 12   n i nT Z +
 , 13   n i nT Z +
 , 23   n i nT Z +
 , 33  n i nT Z +
2 ,
1
12  iT Z +
2 ,
1
11  iT Z +
2 ,
1
13  iT Z +
2 ,
1
22  iT Z +
2 ,
1
23  iT Z +
2 ,
1
33  iT Z +1 , 33   iT Z
1 , 23   iT Z
1 , 22   iT Z
1 , 13   iT Z
1 , 12   iT Z
1 , 11   iT Z
LR
LR
LR
 
Fig. 3.3.15 The equivalent distributed SPICE model of the three conductor coupled lines 
with a perfect ground plane. 
 
As shown in Fig. 3.3.16, the impedance profiles can be divided into four regions (A 
to D). Region A is the region where the mutual coupling between any two traces is 
negligible. Therefore, it is seen that at this region the self-impedance for each trace is kept 
at 50Ω and the mutual impedance is approaching infinity. Region B is the transition 
region, where trace 1 and 3 have 90-degree bend and trace 2 is kept straight. At this region 
11Z  and 33Z  are changed to about 40Ω due to the bending effect and oscillate to about 
60Ω due to the coupling effect of neighboring traces. 22Z  is directly transited to 70Ω. 
Region C is the uniform coupling region, where three traces are in parallel. It is seen that 
Z11 and Z22 are uniformly kept at about 60Ω and 70Ω, respectively. The last region is the 
 44
macromodel can well predict the broadband behavior from DC to 7GHz. It is 
emphasized that the proposed MDA can synthesize an appropriate macromodel by 
cascading several CCTL units based on the time-domain scattered voltage waves. 
Only one excitation source is needed for extracting the models. The geometrical 
structures of the coupled interconnects need not to be known in advance. Therefore, 
this approach is suitable to be applied in the TDR measurement for establishing the 
models of the coupled interconnects. 
 
 
(a) 
 
(b) 
Fig. 3.3.17 The comparison of the time-domain response by between the FDTD 
simulation and the extracted model (a) V11 and V21, (b) V22 and V13. 
 46
 
0 1 2 3 4 5 6 7
GHz
-70
-60
-50
-40
-30
-20
-10
0
10
dB
        S22
simulation
extracted model
(a) 
0 1 2 3 4 5 6 7
GHz
-200
-150
-100
-50
0
50
100
150
200
de
g
        S22
simulation
extracted model
(b) 
Fig. 3.3.21 The comparison of the frequency response between the FDTD simulation 
and the extracted model (a) S22 magnitude, (b) S22 phase. 
 
 
3.4 Summary 
Based on the scattered time-domain voltage either measured by TDR or simulated 
by FDTD, a multi-dimensional deconvolution algorithm (MDA) is proposed to synthesize 
the broadband macromodel of the multi-conductor high-speed interconnects. The MDA 
construct the macromodel by cascading multiple CCTL units with corresponding 
impedance matrix distributions. Although the CCTL unit is a coupled interconnect model 
under the assumption of homogeneous transmission lines, it has been shown that the 
macromodel based on the CCTL unit can well predict both the frequency- and 
time-domain responses of the inhomogeneous coupled interconnects. Even/odd mode 
impedance can be also synthesized from the proposed model. Three examples have been 
used to demonstrate the validity of the proposed approach. The test examples show good 
accuracy in broadband frequency from DC up to 7GHz and also excellent time-domain 
behavior with fast rise time of about 45ps. The macromodel is suitable for applying in the 
SPICE simulation of high-speed digital circuits.  
 
 
 
 
 48
way. As shown in Fig. 4.1.2(a), the two traces both on top and bottom layers are 
designed to connect to the vias in opposite direction for decreasing the mutual 
coupling. One of the trace on the top layer is for source excitation (port 1), and the 
other trace is for receiving the time-domain responses (port 2). The bottom two 
traces are terminated to the ground (port 3 and port 4). It is assumed that these four 
traces connecting the differential via have the same characteristic impedance Z0 (= 50
Ω). This setup is valid for the differential vias model extraction either from the 
FDTD simulation or the TDR/TDT measurement. Fig. 4.1.2(b) shows the proposed 
equivalent macro-π model of the differential via and the corresponding ports. M1, M2, 
and M3 are the modules of the equivalent macro-π model that can characterize the 
broadband responses of the vias and their mutual coupling. Our goal is to synthesize 
the equivalent circuits of M1, M2, and M3 from the time-domain voltage waveforms 
responded at port1 and port2, respectively. 
 
 
shorting vias
Differential via
S
G
IC
G
S
ICThrough-hole via
 
Fig. 4.1.1 The schematic diagram of general through-hole vias in multilayer board. 
 
 50
1
( ) exp( )
mn
i i
mn mn mn
L
i
y t r p t
=
= −∑  (4.2.1) 
where m, n = 1 or 2, imnr  and imnp are the residues and poles in the Z planes, and Lmn 
is the number of exponential term synthesized by the GPOM. The objective of the 
GPOM is to find the best estimates of Lmn, imnr , and imnp  with 1,  ...,  mni L= . 
 
 
4.3  Synthesis of Equivalent Macro-π Model 
The corresponding impulse responses of the differential via in frequency 
domain are obtained through the Laplace transformation of (4.2.1) as the rational 
functions    
1
( )
mnL i
mn
mn i
i mn
rs s
s p
ξ
=
= +∑  (4.3.1) 
The relationship between two-port ABCD matrix [56] and the impulse response 
in (4.3.1) is defined as  
11 22 12 21 11 22 12 21
0
21 21
11 22 12 21 11 22 12 21
0 21 21
(1 )(1 ) (1 )(1 )
2 2
1 (1 )(1 ) (1 )(1 )
2 2
Z
A B
C D
Z
ξ ξ ξ ξ ξ ξ ξ ξ
ξ ξ
ξ ξ ξ ξ ξ ξ ξ ξ
ξ ξ
+ − + + + −⎡ ⎤⎢ ⎥⎡ ⎤ ⎢ ⎥=⎢ ⎥ − − − − + +⎢ ⎥⎣ ⎦ ⎢ ⎥⎣ ⎦  
 (4.3.2) 
and the correlation of each macro-module (M1, M2, and M3) and ABCD matrix is 
derived as 
[ ]1 2 3 1 1 1, , , ,D AM M M B B B
− −⎡ ⎤= ⎢ ⎥⎣ ⎦  (4.3.3) 
Substituting (4.3.2) in (4.3.3), the corresponding macro-π models with three 
macro-modules M1, M2, and M3 can be derived as     
 
 52
( ) 0 1
0 1
1
1
0 1
1 10 1 1
*
1
1 1 1
( )
( )           
( )
(
)             
i i
i i
k k
i
i
k
N i N i
k k
i i i i
k kk k k
r D r D
N i
k
ii i
k k k
r D
r rM s s
s s j
r K
s j
s α α β
α β
= =
≥ ≥
=
≥
+ + +
+ −
= +
+ +
∑ ∑
∑
% %
%
%
 (4.4.2) 
The order of the modules are then reduced to 0 12
i iN N+% % . 
 
4.5  Systematic lumped-model extraction technique (SLET) 
The final step is to synthesize the equivalent lumped circuits of the order-reduced 
macro-π modules. ( )iM s%  in (4.4.2) can be re-arranged as 
 
0 1
2
1 1
0 0
( )( )
( )
i i
K K
i i i
i i
i ii i i
q v
q rs v P sM s s s K
s h s u s m Q s= => >
+= + + ++ + +∑ ∑%  (4.5.1)  
 
where iq , ih , ir , iv , iu , im  are real numbers and i = 1, 2, or 3. The corresponding 
circuit models for the first-order term in the first summation of (4.5.1) can be realized 
by a parallel connection of series R-C, as shown in Fig. 4.5.1(a), with 
 
1/Ci iR q=  (4.5.2a) 
1/( )i i CiC h R= ⋅  (4.5.2b) 
 
The equivalent circuits of the second-order terms in the second summation of 
(4.5.1) are shown in Fig. 4.5.1(b) with corresponding values derived as 
 
/i i iC v m=  (4.5.3a) 
( / ) /Ci i i i iR u r C v= −  (4.5.3b) 
1/Li i CiR r R= −  (4.5.3c) 
/( )i Li i i iL R r C m= ⋅ ⋅  (4.5.3d) 
 54
VCi(s) in Fig. 4.5.2(a) and VLi(s) in Fig. 4.5.2(b) are the voltage drop crossing on 
the corresponding capacitor and inductor, respectively. 
 
iC
2 ( )
iC
V s
( ) 
iC
V s+ −
iC
R
 
(a) 
iC
R
2 ( )
iL
V s
iL
R
iC
 ( ) 
iC
V s+ −
2 ( )
iC
V s ( ) 
iL
V s+ −
iL
 
(b) 
Fig. 4.5.2 Two types of VCVS models extracted from the pole-residue representation. 
 
Finally, each of the corresponding macro-element can be realized by the parallel 
connection in the form of Fig. 4.5.3. 
 
2 ( )LV s
2 ( )CV s
( )CV s
( )LV s2 ( )CV s
( )CV s
 
Fig. 4.5.3 The schematic macro-module constructed by the parallel termination of 
equivalent SPICE model. 
 56
 
  
Begin
Simulation / measurement
      TDR/TDT data
Step response
Matrix Pencil Method
Macro-PI model
Order-reduction
Passivity
SLET
Frequency-domian responseTime-domian response
End
Full Wave simulator  /
      measurement 
Fig. 4.6.1 Modeling extraction flowchart 
 
 
 
 58
can be reduced to 15 ( 10 1N =  and 21 7N = ), 13 ( 10 1N =  and 21 6N = ), and 16 
( 10 2N =  and 21 7N = ), respectively, with the criterion parameter D = 3.8%. Table 
4.1 and Table 4.2 list the corresponding poles and residues of the order-reduced 
macro-π models for asymmetric vias, respectively. The equivalent lumped circuits of 
the asymmetric via is then extracted by SLET and shown in Fig. 4.7.2.  
 
1M
2M
3M
 +
−
 +
−
 +
−
 +
−
 +
−
 +
−
 +−  +−
 +−
 
Fig. 4.7.2 The equivalent macro-π model extracted from the pole-residue 
representation by SLET. 
 
To evaluate the accuracy of the extracted macro-π model, both time-domain and 
frequency-domain responses of the model are compared with the full-wave 
simulations by 3D-FDTD method. Commercial tool (Advanced Design System, ADS) 
is used to simulate time- and frequency-domain responses of extracted SPICE- 
compatible models. Fig. 4.7.3(a) shows the TDR response at port 1 (V11) from initial 
to 80ps with the step excitation with 10τ = ps. The capacitive dip around 45ps with 
minimum voltage about 0.15V is caused by the via holes. It is seen that the extracted 
macro-π models well predict the time-domain behavior of the asymmetric via. Fig. 
 60
 
Table 4.1 
Extracted poles of asymmetric vias from macro-π model representations 
 
1M% (1e+011) 
Pole 
2M% (1e+011) 
Pole 
3M% (1e+011) 
Pole 
1
01α 5.1096 201α 5.1096 301α 8.3710 
1
11α 1.5955 211α 1.5955 302α 5.1096 
1
11β 7.9864 211β 7.9864 311α 1.5955 
1
12α 0.8641 212α 2.1342 311β 7.9864 
1
12β 7.3833 212β 5.9983 312α 0.8967 
1
13α 2.1342 213α 1.1515 312β 6.8248 
1
13β 5.9983 213β 4.4666 313α 2.1342 
1
14α 1.1515 214α 1.7385 313β 5.9983 
1
14β 4.4666 214β 2.2865 314α 1.1515 
1
15α 1.7385 215α 1.2799 314β 4.4666 
1
15β 2.2865 215β 2.3400 315α 1.7385 
1
16α 1.2799 216α 0.3897 315β 2.2865 
1
16β 2.3400 216β 2.5007 316α 1.2799 
1
17α 0.3897  316β 2.3400 
1
17β 2.5007  317α 0.3897 
  317β 2.5007 
 
Table 4.2 
Extracted residues of asymmetric vias from macro-π model representations 
 
1M% (1e-004) 
Residue 
2M% (1e-004) 
Residue 
3M% (1e-004) 
Residue 
1
01r  -96.8229 
2
01r -82.365 
3
01r 26.329 
1
11r  -9.5467 - j4.3530 
2
11r 20.047 - j19.977
3
02r 44.505 
1
12r  2.5531 - j15.167 
2
12r 76.636 - j80.007
3
11r 7.7464 + j8.0971 
1
13r  72.715 - j103.24 
2
13r 2.9817 - j152.40
3
12r 0.9414 - j8.4494 
1
14r  3.1566 - j161.88 
2
14r 10.302 + j51.566
3
13r -37.837 + j45.504 
1
15r  -20.042 - j5.5743 
2
15r -67.575 - j9.6783
3
14r -1.5333 + j78.500 
1
16r  7.9483 - j13.779 216r 4.2237+ j24.305 315r 23.058 - j3.1228 
1
17r  -0.9408 - j39.557  
3
16r -4.8570 + j16.236 
  317r -24.817 + j57.437 
 
 62
 
(a) 
 
(b) 
Fig. 4.7.5 Comparison of S-parameters between the extracted model and FDTD 
simulation (a) S22 (b) S31. 
 
To check the passivity of the models, two eigenvalues ( 1λ  and 2λ ) of the real 
part of the admittance matrix of the models as shown in (4.6.2) are calculated from 
DC to 30GHz and are shown in Fig. 4.7.7. It is seen that both eigevalues are positive 
in the interested frequency range. It means that the extracted models are passivity 
below the frequency 30GHz. The passivity criterion at higher frequency is not 
discussed here because the models are synthesized by the step excitation source of 
effective bandwidth 30GHz. Table 4.3 list the corresponding lump elements of the 
macro-π models. 
0 5 10 15 20 25 30
GHz
-70
-60
-50
-40
-30
-20
-10
0
S2
2 
(d
B
)
3D-FDTD S22
extracted model mode 44
-200
-150
-100
-50
0
50
100
150
200
S22 (deg)
0 5 10 15 20 25 30
GHz
-20
-15
-10
-5
0
5
S3
1 
(d
B
)
3D-FDTD S31
extracted model mode 44
-200
-150
-100
-50
0
50
100
150
200
S31 (deg)
 64
Table 4.3  
Extracted Lump-elements of asymmetric vias from macro-π model representations 
 
1M%  2M%  3M%  
1C 6.8309e-014 1C 6.4310e-014 1C 3.1452e-015 
1CR 15.2105 1CR 16.1539 1CR 379.808 
1LR 1568.74 1LR 1660.7 2C 8.7101e-015 
1L 6.8143e-011 1L 7.2377e-011 2CR 224.691 
2C 1.1925e-014 2C 3.2923e-014 3C 2.3225e-015 
2CR 144.612 2CR 104.962 3CR -225.869 
2LR 484.448 2LR 380.371 3LR 871.327 
2L 9.0779e-010 2L 2.8852e-010 3L 8.7627e-010 
3C 3.0771e-014  4C 2.4696e-015 
3CR 18 42.643 VCVS 4CR 88.1043 
3LR -5357.04 3C 3.8462e-015 4LR 5222.8 
3L 5.1138e-010 3CR -533.678 4L 8.4037e-010 
 3LR 783.093 5C 9.4826e-015 
VCVS 3L 1.2307e-009 5CR 318.662 
4C 1.5075e-015 4C 1.5608e-014 5LR -450.806 
4CR 947.486 4CR -222.669 5L 8.8751e-010 
4LR -1471.23 4LR 287.911 6C 7.9866e-015 
4L 2.8092e-009 4L 6.9746e-010 6CR -348.639 
5C 3.9732e-015 5C 1.6119e-014 6LR 565.477 
5CR -137.249 5CR -121.41 6L 3.9576e-009 
5LR 2095.65 6C 1.7949e-014 7C 4.1826e-014 
5L 4.8736e-010 6CR 389.213 7CR 73.3804 
6C 2.2897e-014 6LR -463.204 7LR -274.852 
6CR -114.42 6L 4.9027e-009 7L 5.0917e-010 
6LR 183.182 7C 1.8463e-014  
6L 2.8702e-010 7CR -104.582 VCVS 
7C 1.8949e-014 7LR 1288.36 8C 3.3125e-014 
7CR -103.281 7L 9.2019e-010 8CR -31.3644 
8C 1.1536e-014   8LR -3229.43 
8CR -0.236111   8L 1.4052e-010 
8LR -249.237   9C 1.2429e-014 
8L 1.0496e-009   9CR -201.119 
    9LR -828.313 
    9L 9.1000e-010 
 
 66
Table 4.4 
Extracted poles of of differential via from macro-π model representations 
 
1M% ( = 2M% ) (1e+011) 
Pole 
3M% (1e+011) 
Pole 
1
01α  3.3286 301α  5.9098 
1
11α  2.5833 302α  3.3286 
1
11β  9.0923 311α  2.5833 
1
12α  2.2702 311β  9.0923 
1
12β  7.5842 312α  1.2470 
1
13α  0.5353 312β  9.0994 
1
13β  4.4913 313α  2.2702 
1
14α  1.5264 313β  7.5842 
1
14β  1.9752 314α  2.0750 
 314β  6.7664 
 315α  0.5353 
 315β  4.4913 
 316α  2.5626 
 316β  2.6140 
 317α  0.3554 
 317β  2.66734 
 318α  1.5264 
 318β  1.9751 
 
Table 4.5 
Extracted residues of differential via from macro-π model representations 
 
1M% ( = 2M% ) (1e-004) 
Residue 
3M% (1e-004) 
Residue 
1
01r  -29.9897 
3
01r 52.8014 
1
11r  26.484 + j48.272
3
02r 14.9948 
1
12r  41.394 + j16.832
3
11r -13.242 - j24.136
1
13r  9.7821 + j90.016
3
12r 1.5887 + j8.0486
1
14r  -52.828 + j61.372
3
13r -20.697 - j8.4160
1
15r   
3
14r -8.9489 + j11.220
1
16r   315r -4.8910 - j45.008
1
17r   
3
16r 32.711 - j5.7212 
 317r -44.7663+ j68.845
 318r 26.414 - j30.686
 68
 
Fig. 4.7.9 Comparison of time-domain response between the extracted lumped model 
and the direct FDTD simulated results. 
 
Fig. 4.7.9 shows the TDR waveform at port1, V11(t) = V22(t), and TDT 
waveform at port2, V21(t) = V12(t), calculated both by the extracted broadband model 
and the 3D-FDTD simulation. It is found that the synthesized macro-π model can 
well predict the time-domain behavior of the differential via. The coupled noise (V21) 
between these two vias reaches about 0.03V for the 10ps rise-time step excitation. 
This noise is larger than the previous asymmetric via case due to the longer via 
length in four-layer structure. 
 
 
Fig. 4.7.10 Comparison of S11 between the extracted model and FDTD simulation. 
0 5 10 15 20 25 30
GHz
-70
-60
-50
-40
-30
-20
-10
0
10
S1
1 
(d
B
)
3D-FDTD S11
extracted model S11
-200
-150
-100
-50
0
50
100
150
200
S11 (deg)
0 10 20 30 40 50 60 70 80
t (ps)
0
0.05
0.1
0.15
0.2
0.25
V 1
1 
(v
ol
t)
3D-FDTD
extracted model
-0.02
-0.01
0
0.01
0.02
0.03
0.04
V12  &
 V
21  (volt)
 70
 
Fig. 4.7.13 Comparison of S41 between the extracted model and FDTD simulation. 
 
0.1 1 10
GHz
0.02
0.025
0.03
0.035
0.04
0.045
0.05
Ei
ge
nv
al
ue
Differential via
λ1
λ2
 
Fig. 4.7.14 The eigenvalues of the proposed macro-π models of the differential vias. 
 
 
4.8 Summary 
A novel systematic time-domain approach is proposed for synthesizing the 
SPICE-compatible circuits of the differential vias based on a broadband macro-π 
model. According to either the measured or simulated time-domain waveforms, the 
GPOM method is employed to construct the time-domain step response of the 
0 5 10 15 20 25 30
GHz
-80
-70
-60
-50
-40
-30
-20
-10
0
S4
1 
(d
B
)
3D-FDTD S41
extracted model S41
-200
-150
-100
-50
0
50
100
150
200
S41 (deg)
 72
Chapter 5  Conclusion and result of project 
 
 
In this project, two time-domain algorithms based on the scattered time-domain 
waveforms are proposed to extract the equivalent models for high-speed interconnects. 
The first approach described in chapter 2 is to synthesize the broadband macromodel 
of the multi-conductor high-speed coupled interconnects. The MDA constructs the 
macromodel by cascading multiple CCTL units with corresponding impedance matrix 
distributions. Both the frequency- and time-domain responses of the coupled 
interconnects can be well predicted. The second approach focuses on the modeling of 
through-hole vias based on a broadband macro-π model. GPOM method is employed 
to construct the time-domain step response by the rational functions. The macro-π 
model in terms of the rational functions is obtained through a two-port ABCD matrix 
transformation. The order of the macro-modules can be further reduced according the 
residue criterion without losing the accuracy. The order-reduced rational functions for 
the macro-modules are finally used to synthesize the equivalent lumped circuits by the 
SLET. The passivity and the stability of the extracted models can be assured based on 
this time-domain approach. The accuracy of the proposed SPICE-compatible models 
is also checked both in time- and frequency-domain by comparing with the 3-D 
FDTD simulations. In general, the transmission line oriented model for 
multi-conductor interconnects or the macro-π model for differential via holes 
extracted by the proposed algorithms can maintain a broadband accuracy and good 
transient behaviors. It’s also easily incorporated into the SPICE-compatible 
commercial tools to perform the SI simulation with active devices. 
  
 
 
 
 
 
 74
[8] K. Naishadharn, “Experimental equivalent-circuit modeling of SMD inductors for 
printed circuit applications,” IEEE Trans. Electromagnetic Compatibility, vol. 43, 
pp. 557-565, Nov. 2001. 
[9] P. L. Werner, R. Mittra, and D. H. Werner, “Extraction of equivalent circuits for 
microstrip components and discontinuities using the genetic algorithm,” IEEE 
Microwave and Guided Wave Letters, vol. 8, pp. 333-335, Oct. 1998. 
[10] D. H. Kwon, J. Kim, K. Kim, S. C. Choi, J. H. Lim, J. H. Park, L. Choi, S. W. 
Hwang, and S. H. Lee, “Characterization and modeling of a new via structure in 
multilayered printed circuit boards,” IEEE Trans. Components and Packaging 
Technologies, vol. 26, pp. 483-489, June 2003. 
[11] F. Jun, J. L. Drewniak, and J. L. Knighten, “Lumped-circuit model extraction for 
vias in multilayer substrates,” IEEE Trans. Electromagnetic Compatibility, vol. 45, 
pp. 272 - 280, May 2003. 
[12] J. G. Yook, L. P. B. Katehi, K. A. Sakallah, R. S. Martin, L. Huang, and T. A. 
Schreyer, “Application of system-level EM modeling to high-speed digital IC 
packages and PCBs,” IEEE Trans. Microwave Theory Tech., vol. 45, pp. 
1847-1856, 1997.. 
[13] P. A. Kok and D. De Zutter, “Least-square estimation of the equivalent circuit 
parameters of a via-hole from a TDR reflectogram, including on-board rise time 
and delay estimation,” IEEE Trans. Components, Hybrids, and Manufacturing 
Technology, vol. 16, pp. 292-299, May 1993. 
[14] E. Laermans, J. De Geest, D. De Zutter, F. Olyslager, S. Sercu, and D. Morlion, 
“Modeling complex via hole structures,” IEEE Trans. Advanced Packaging, vol. 
25, pp. 206-214, May 2002. 
[15] H. Zhu, A. R. Hefner, Jr., and J. S. Lai, “Characterization of power electronics 
system interconnect parasitics using time domain reflectometry,” IEEE Trans. 
Power Electronics, vol. 14, pp. 622-628, July 1999. 
[16] W. B. Kuhn, Xin He, and M. Mojarradi, “Modeling spiral inductors in SOS 
processes,” IEEE Trans. Electron Devices, vol. 51, pp. 677-683, May 2004. 
 76
[26] B. Gustavsen and A. Semlyen, “Enforcing passivity for admittance matrices 
approximated by rational functions,” IEEE Trans. Power Systems, vol. 16, pp. 
97-104, Feb. 2001. 
[27] S. H. Min and M. Swaminathan, “Construction of broadband passive 
macromodels from frequency data for simulation of distributed interconnect 
networks,” IEEE Trans. Electromagnetic Compatibility, vol. 46, pp. 544 - 558, 
Nov. 2004. 
[28] M. Sung, W. Ryu, H. Kim, J. Kim, and J. Kim, “An efficient crosstalk parameter 
extraction method for high-speed interconnection lines,” IEEE Trans. Advanced 
Packaging, vol. 23, pp. 148-155, May 2000. 
[29] J. G. Nickel, D. Trainor, and J. E. Schutt-Aine, “Frequency-domain-coupled 
microstrip-line normal-mode parameter extraction from S-parameters,” IEEE 
Trans. Electromagnetic Compatibility, vol. 43, pp. 495-503, Nov. 2001. 
[30] C. T. Tsai and W. Y. Yip, “An experimental technique for full package inductance 
matrix characterization,” IEEE Trans. Components, Hybrids, and Manufacturing 
Technology, vol. 19, pp. 338-343, May 1996. 
[31] A. Sutono, N. G. Cafaro, J. Laskar, and M. M. Tentzeris, “Experimental 
modeling, repeatability investigation and optimization of microwave bond wire 
interconnects,” IEEE Trans. Advanced Packaging, vol. 24, pp. 595-603, Nov. 
2001. 
[32] S. C. Burkhart, R. B. Wilcox, “Arbitrary Pulse Synthesis via Nonuniform 
Transmission lines,” IEEE Trans. Microwave Theory Tech., vol. 38, pp. 
1514-1518, Oct. 1990. 
[33] C. W. Hsue and T. W. Pan, “Reconstruction of nonuniform transmission lines 
from time-domain reflectometry,” IEEE Trans. Microwave Theory Tech., vol. 45, 
pp. 32 –38, Jan. 1997. 
[34] C. Schuster and W. Fichtner, “Signal Integrity Analysis of Interconnects Using 
the FDTD Method and a Layer Peeling Technique,” IEEE Trans. Electromagnetic. 
Compatibility, vol. 42, pp. 229-233, May 2000. 
 78
[44] C. Schuster, G. Leonhardt, and W. Fichtner, “Electromagnetic simulation of 
bonding wires and comparison with wide band measurements,” IEEE Trans. 
Advanced Packaging, vol. 23, pp. 69-79, Feb. 2000. 
[45] F. Alimenti, P. Mezzanotte, L. Roselli, and R. Sorrentino, “Modeling and 
characterization of the bonding-wire interconnection,” IEEE Trans. Microwave 
Theory Tech., vol. 49, pp. 142-150, Jan. 2001. 
[46] F. Xiao, W. Liu, and Y. Kami, “Analysis of crosstalk between finite-length 
microstrip lines: FDTD approach and circuit-concept modeling,” IEEE Trans. 
Electromagnetic. Compatibility, vol. 43, pp. 573-578, Nov. 2001. 
[47] P. C. Cherry and M. F. Iskander, “FDTD analysis of high frequency electronic 
interconnection effects,” IEEE Trans. Microwave Theory Tech., vol. 43, pp. 
2445-2451, Oct. 1995. 
[48] E. X. Liu, E. P. Li, L. W. Li, and Zhongxiang Shen, “Finite-difference 
time-domain macromodel for simulation of electromagnetic interference at 
high-speed interconnects,” IEEE Trans. Magnetics, vol. 41, pp. 65-71, Jan. 2005. 
[49] T. L. Wu, C. C. Kuo, C. C. Wang, S. M. Wu, and C. P. Hung, “A novel 
time-domain algorithm for synthesizing broadband macromodels of coupled 
interconnects,” IEEE Trans. Advanced Packaging, vol. 27, pp. 224-232, Feb. 
2004. 
[50] T. K. Sarkar and O. Pereira, “Using the Matrix Pencil to Estimate the Parameters 
of a Sum of Complex Exponentials,” IEEE Antenna and Propagation Magazine, 
vol. 37, pp. 48-55, 1995. 
[51] T. L. Wu, C. C. Kuo, H. C. Chang, and J. S. Hsieh, “A novel systematic approach 
for equivalent model extraction of embedded high-speed interconnects in time 
domain,” IEEE Trans. Electromagnetic Compatibility, vol. 45, pp. 493-501, Aug. 
2003. 
[52] M. L. Crow and A. Singh, “The matrix pencil for power system modal 
extraction,” IEEE Trans. Power Systems, vol. 20, pp. 501-502, Feb. 2005. 
 80
[62] F. Caignet, S. Delmas-Bendhia, and E. Sicard, “The challenge of signal integrity 
in deep-submicrometer CMOS technology,” IEEE Proceedings, vol. 89, pp. 
556-573, April 2001. 
[63] M. S. Sharawi, “Practical issues in high speed PCB design,” IEEE Potentials, vol. 
23, pp. 24-27, April-May 2004. 
[64] I. Novak, B. Eged, and L. Hatvani, “Measurement and simulation of crosstalk 
reduction by discrete discontinuities along coupled PCB traces,” IEEE Trans. 
Instrumentation and Measurement, vol. 43, pp. 170-175, April 1994. 
[65] R. Goyal, “Managing signal integrity [PCB design],” IEEE Spectrum, vol. 31, pp. 
54-58, March 1994. 
[66] M. Nourani and A. R. Attarha, “Detecting signal-overshoots for reliability 
analysis in high-speed system-on-chips,” IEEE Trans. Reliability, vol. 51, pp. 
494-504, Dec. 2002. 
[67] P. J. Restle, K. A. Jenkins, A. Deutsch, and P. W. Cook, “Measurement and 
modeling of on-chip transmission line effects in a 400 MHz microprocessor,” 
IEEE Journal Solid-State Circuits, vol. 33, pp. 662-665, April 1998. 
[68] K. Yee, “Numerical solution of inital boundary value problems involving 
maxwell's equations in isotropic media,” IEEE Trans. Antennas and Propagation, 
vol. 14, pp. 302-307, May 1966. 
[69] J. P. Berenger, “Perfectly matched layer for the FDTD solution of wave-structure 
interaction problems,” IEEE Trans. Antennas and Propagation, vol. 44, pp. 
110-117, Jan. 1996. 
[70] Z. Wu and J. Fang, “Numerical implementation and performance of perfectly 
matched layer boundary condition for waveguide structures,” IEEE Trans. 
Microwave Theory Tech., vol. 43, pp. 2676-2683, Dec. 1995. 
[71] R. Mittra and U. Pekel, “A new look at the perfectly matched layer (PML) 
concept for the reflectionless absorption of electromagnetic waves,” IEEE 
Microwave and Wireless Components Letters, vol. 5, pp. 84-86, March 1995. 
 
 
 
A Novel Broadband Common-mode Filter for 
High-speed Differential Signals 
 
Wei-Tzong Liu, Tzu-Wei Han, Tzong-Lin Wu 
 
Department of Electrical Engineering and 
Graduate Institute of Communication Engineering 
National Taiwan University 
Taipei 10617 , Taiwan 
 
 
Abstract— A novel low-cost filter design for 
common-mode noise suppression in high-speed 
differential signals is proposed. It is realized by 
periodically etching the dumbbell-shape defected 
ground structure (DGS) to perturb the return current of 
the common-mode noise. A transmission-line model for 
the proposed structure is also developed with good 
agreement to the full-wave simulation and measurement 
result. It is found that over 20dB of common-mode noise 
suppression can be achieved over a wide frequency 
ranges from 3.3 to 5.7 GHz with 3 cascaded DGS cells, 
while the differential signals still keep good signal 
integrity in eye-pattern observation.  
 
Index Terms— Signal integrity, common-mode filter, 
EMI, defected ground plane, differential signal. 
I. INTRODUCTION 
ifferential signals have played an important role 
in high-speed digital circuits because of their 
high immunity to noise, low crosstalk, and low 
electromagnetic interference (EMI). Several 
high-speed serial link formats, such as PCI Express II, 
Gigabit Ethernet, or OC-192, have the data rates over 
5 Gbps under the differential signal transmission. 
However, in practical circuits, the common- mode 
noise (CMN) due to the timing skew or amplitude 
unbalance along the differential signal paths is 
unavoidable. These above GHz CMN will degrade the 
signal integrity or power integrity of the high-speed 
circuit system. Furthermore, the EMI issue caused by 
the common-mode noise radiation through the I/O 
cables connected to the differential signals could also 
be significantly serious. 
Several approaches have contributed to the CMN 
suppression for the differential signals. The 
common-mode choke using the high permeability 
ferrite cores is one of the most general approaches 
[1]-[3]. This approach is valid only at MHz frequency 
range. Another drawback is the difficulty of reducing 
the size of this common-mode choke using the ferrite 
material. The compact device is important in the high 
density digital circuits. A miniaturized common-mode 
suppression filter was proposed based on the 
multi-layer low-temperature co-fire ceramic (LTCC) 
[4]. The filtering band reaches about 1 GHz with 
compact device size, but the cost is high for the LTCC 
fabrication. 
 
In this letter a novel broadband common-mode 
filter for GHz differential signals is proposed by using 
periodical defected-ground structures (DGSs). The 
unit-cell of the differential signals with 
dumbbell-shaped defected-ground structure can be 
considered as a parallel L and C circuits for the 
common-mode signals but as an ideal short for the 
differential ones. By suitable geometry design of the 
dumbbell-shaped structure, the proposed embedded 
filter behaves broadband and efficient suppression for 
the common-mode noise while still maintaining a good 
signal quality for the differential components. 
Compared to previous CMN suppression approaches, 
the proposed approach has the advantages of low cost, 
wideband suppression in GHz range, good 
compatibility to the standard printed circuit board or 
packaging process. 
II. DESIGN CONCEPT AND MODELING 
 Fig. 1(a) shows the proposed common-mode filter. 
I t  i s  des igned by periodical ly  etching the 
dumbbell-shaped structure on the ground plane 
underneath the differential lines. To avoid the 
e x c i t a t i o n  o f  c o m m o n - m o d e  n o i s e ,  t h e 
dumbbell-shaped DGS is kept in symmetry to the 
central line of two signal lines. As shown in Fig. 1(a), 
two dumbbells are designed as a square with side 
length Kd . An etched slit with length Wd and gap width 
Sd is used to connect two dumbbells. Because 
differential signal is propagated in the odd mode, 
relatively low current density will return through the 
ground plane. The degradation of the differential 
signals caused by the DGS will be relatively small. 
However, the return current of common-mode (or 
even-mode) will pass through the ground plane, and 
the DGS would have significant effect on this type of 
signals. As shown in Fig. 1(b), the unit-cell of the 
proposed filter for the common-mode can be modeled 
D 
with the solid ground plane (reference board) and with 
the DGS filter (filter board) are both measured for 
comparison. To excite the common-mode noise, a 
signal skew is created by designing a delay line (10 
mm) on one of the differential lines as shown in the 
inset of Fig. 3. Two pulse trains of 800 mV 
peak-to-peak voltage and 8 Gbps are differentially 
launched into port 1 and port 2 by the pattern 
generator (Agilent N49001A). The output waveforms 
are measured at port 3 and port 4 using digital 
oscilloscope (Agilent DAJ-86100C), respectively. The 
common-mode noise (Vcommon) is defined as the half of 
the sum of the measured voltage at these two output 
ports. It is observed from Fig. 3 that the peak-to-peak 
output common-mode voltage for the reference board 
is 412 mV, but it is reduced to 64 mV employing the 
proposed DGS filter. Over 80% improvement is 
achieved. Fig. 4 shows the measured differential 
eye-pattern with 1V amplitude in 8Gbps. The 
maximum eye opening is 830 mV for the reference 
board and 746 mV for the filter board.  
 
(a) 
 
(b) 
Fig. 4. The measured differential eye pattern for (a) reference board and (b) 
proposed structure. 
 
The maximum eye width and jitter is almost the same 
for both boards. It is proved in time-domain that the 
proposed embedded filter behaves excellent 
performance in common-mode noise suppression 
while good differential signal quality is preserved. 
IV. PARAMETER DESIGN 
 
 
Fig. 5 common-mode transmission loss with the dumbbell size changed 
from 4mm, 6mm, to 8mm. 
 
 
Two parameters will dominantly affect the 
stopband behavior for the common-mode suppression 
filter. One the dumbbell size (Kd) and the other one is 
the number of unit cell. Fig. 5 demonstrates 
common-mode transmission loss with the dumbbell 
size changed from 4mm, 6mm, to 8mm. The stopband 
is moved to lower frequency with no significant 
variation on the bandwidth as Kd is increased. It is 
clearly found the lower side cutoff frequency for the 
stopband can change from 3.3GHz to 1.9GHz as Kd is 
increased from 4mm to 8mm. The reason can be 
intuitively understood by the LC resonator shown in 
Fig. 1(b). Increasing Kd will increase the return 
current loop path, and thus increase the effectively 
inductance of the resonator.  
Fig. 6 shows the effect of the unit-cell number on 
the stopband behavior. It is clearly seen that both 
stopband bandwidth and the band depth are increased 
as the cell number is increased from one to four. The 
bandwidth is less than 300MHz for only one unit-cell. 
As the cell number is increased, it becomes a periodic 
structure, which causes the bandwidth enhancement.  
 
 
 
 
0 2 4 6 8 10
-40
-30
-20
-10
0
  Kd=4mm
  Kd=6mm
  Kd=8mm
S C
C
21
(d
B
)
Frequency(GHz)
April 30, 2004 20:45 Research Publishing: Trim Size: 8.50in x 11.00in (IEEE proceedings) emc08:P205
The Effects on SI and EMI for Differential Coupled Microstrip 
Lines over LPC-EBG Power/Ground Planes 
Cheng-Hung Shih, Guang-Hwa Shiue¡ﬂ, Tzong-Lin Wu and Ruey-Beei Wu
Department of Electrical Engineering, National Taiwan University, Taipei, Taiwan, R.O.C.
¡ﬂDepartment of Electronic Engineering, Chung Yuan Christian University, Taipei, Taiwan, R.O.C. 
E-mail: sgh@cycu.edu.tw¡ﬂ, wtl@cc.ee.ntu.edu.tw and rbwu@ew.ee.ntu.edu.tw
SS1: Power integrity and EMC for advanced packages
Abstract ¡— A power/ground planes design for efficiently
eliminating the ground bounce noise (GBN) in high-speed
digital circuits is proposed by using low-period coplanar
electromagnetic band-gap (LPC-EBG) structure. However, it 
is unavoidable the signals will cross the LPC-EBG power
plane. In this paper, the effects of signal integrity (SI) and
electromagnetic interference (EMI) for differential coupled
microstrip lines over the LPC-EBG power/ground planes will
be investigated. The resonant frequency of LPC-EBG power
plane will be picked up and appear in the radiation. The band-
gap frequencies of LPC-EBG power plane will loss in weakly
coupling case of differential lines at the received end. Further,
the more coupling factor of differential lines is the less noise
of SI and EMI is. The simulated results based on full-wave
simulator will provide a good reference for the design of
differential coupled microstrip lines over LPC-EBG
power/ground planes.
Index Terms ¡Gsimultaneous switching noise (SSN), signal integrity
(SI), electromagnetic interference (EMI), electromagnetic bandgap 
(EBG), slot, ground bounce noise(GBN).
I. INTRODUCTION
Recently, a new idea for eliminating the GBN is proposed
by using a photonic band-gap (PBG) [1] or electromagnetic
band-gap (EBG) structure on the ground plane to form a high-
impedance surface (HIS) [2],  [3].  Further,  a novel
power/ground planes design using a low-period coplanar EBG 
structure (LPC-EBG) has been proposed to eliminate of the
GBN on the power/ground planes of the high-speed digital
circuits. The key features of this new concept is keeping solid
or continuous for the ground plane and designing the LPC-
EBG structure on the power plane as shown in Fig. 1(a)
[4].However, it is unavoidable that the signals will cross the
embedded EBG or LPC-EBG power plane.
 Although, different EBG structures have been proposed to 
reduce the GBN, the signals crossing the EBG structures will
also result in signal integrity and EMI problems because of
the etched reference plane for the EBG structure [5]. The
signal integrity analysis of striplines between two parallel
planes with an EBG structure has been investigated. It is
shown that, within the stop-band, the signal transmission
h
h
GND
LPC EBG
Power Plane

Differential coupled
microstrip lines
(a)
120mm
90mm
1p
2p
w d
l
(b)
Fig. 1. Structure of differential coupled microstrip lines over LPC-
EBG power plane(a)3-D view (b)top view. 
0 1 2 3 4 5
-120
-100
-80
-60
-40
-20
0
S2
1 
[dB
]
Frequency [GHz]
Fig. 2. Simulated transmission coefficient (|S21|) of the LPC-EBG 
power/ground planes. 
2008 Asia-Pacific Sympsoium on Electromagnetic Compatibility &
164 19th International Zurich Symposium on Electromagnetic Compatibility, 19–22 May 2008, Singapore
April 30, 2004 20:45 Research Publishing: Trim Size: 8.50in x 11.00in (IEEE proceedings) emc08:P205
19th International Zurich Symposium on Electromagnetic Compatibility, 19–22 May 2008, Singapore
0 1 2 3 4 5
-2
-1
0
Sd
2d
1 
[dB
]
Frequency [GHz]
 EBG/k=0.095
 EBG/k=0.19
 EBG/k=0.38
 solid plane/k=0.095
 solid plane/k=0.19
Fig. 3. Simulated differential-to-differential return loss for
differential coupled microstrip lines over LPC-EBG power plane, 
with coupling coefficient as a parameter.
0 1 2 3 4 5
-100
-80
-60
-40
-20
0
Sc
2d
1 
[dB
]
Frequency [GHz]
 EBG/k=0.095
 EBG/k=0.19
 EBG/k=0.38
 solid plane/k=0.095
 solid plane/k=0.19
Fig. 4. Simulated differential-to-common mode conversion for
differential coupled microstrip lines over LPC-EBG power plane, 
with coupling coefficient as a parameter.
IV. RADIATION EFFECTS
    The single and differential signals propagate on microstrip
structures over split power or ground plane will result in
electromagnetic radiation [10]. In this paper, the structure,
differential coupled microstrip lines over LPC-EBG power
plane, will occur the signals cross the slots of LPC-EBG
power plane. So, the EM radiation effects need be investigated
in this structure. Fig. 5 shows the comparison of simulated
results of maximum EM radiation at distance is 3m for single
and differential coupled microstrip lines with different
coupling coefficients over LPC-EBG and solid power plane.
It is evident from Fig. 5 that the stronger the coupling factor,
the smaller the EM radiation is. The EM radiation of single
line is larger than differential lines over LPC-EBG
0 1 2 3 4 5
0
20
40
60
80
100
|E|
,
m
ax
 [d
bu
v/
m
]
Frequency [GHz]
 EBG/k=0.095
 EBG/k=0.19
 EBG/k=0.38
 solid plane/k=0.095
 solid plane/k=0.19
 solid plane/k=0.38
 EBG/single line
Fig. 5. Simulated maximum electric field radiation at distance is 3m 
for differential coupled microstrip lines over LPC-EBG power plane, 
with coupling coefficient as a parameter.
power plane. However, regardless of single or differential
lines, the EM radiation is larger at those resonant frequencies
of LPC-EBG than other frequencies.
For the weakly coupling, k=0.095 and 0.19, the EM radiation
will become larger than the strong coupling, k=0.38. And, the
difference of EM radiation between differential coupled
microstrip lines with k=0.38 over LPC-EBG and solid power
plane is small except at those resonant frequencies of LPC-
EBG. Further, for the weakly coupling, such as k=0.095, 0.19,
the difference of EM radiation between LPC-EBG and solid
power plane is little. It is observed that the larger the coupling
factor, the smaller the peak amplitudes of EM radiation at
those resonant frequencies will be, especially for the
frequencies over 2GHz. The EM radiations also fall off
significantly for larger coupling coefficient of differential
traces in Fig. 5.
Furthermore, the difference of EM radiation for differential
traces over solid plane with different coupling factors is small.
Hence, most of the EM radiation effects mostly comes from
LPC-EBG power/ground planes for this structure.
VI. EXPERIMENT VALIDATION
Using the same structure and dimension in Fig.1, the
comparisons of results of differential-to-differential return
loss and maximum electric field radiation between simulation
and measurement for differential coupled microstrip lines with
coupling coefficient is 0.19 over LPC-EBG power plane are 
shown in Figs. 6 and 7, respectively. The simulated results
agree favorably with measured data for differential-to-
differential return loss at low frequencies, exhibits small
deviation of about 1dB at 5GHz. The comparison is in general
good for maximum electric field radiation (at distance of 3m)
in the frequency range above 2.5GHz. These experiments
support the importance of the strong coupling for reducing SI
and EMI impact on the differential signals using LPC-EBG
plane as return path.
166
出席國際學術會議心得報告 
                                                             
 
計畫編號 96-2221-E-002-082 
計畫名稱 
單封裝系統訊號完整性之前瞻整合研究-子計畫二:單封裝系統高速互連結 
構設計資料庫之研究與建立(3/3) 
出國人員姓名 
服務機關及職稱 
吳宗霖，台大電機系，教授 
會議時間地點 韓國，濟洲島  November 12 (Mon.)-14 (Wed.), 2007 
會議名稱 IEEE Asian Solid-State Circuits Conference (A-SSCC 2007) 
發表論文題目 Pannel Discussion 
 
 
參加會議經過及心得 
本人此次受要韓國 KAIST 大學 prof. Joungho Kim 之邀，擔任 IEEE A-SSCC 研討會之 pannel 
discussion 之主講人之一，主題為 SoC or Sip for Ubiquitous Wireless Communications 。
希望能對 SoC 設計之社群說明 SiP 的重要性。此會從 11/12 到 11/14 一共 3天，在有東方夏
威夷之稱的韓國濟洲島舉行。第一天有兩位 keynote speakers 一是 LG 的 CEO，另一位是 SSCC
的 president。都對未來 SoC 的發展趨勢提出前瞻的看法。當天中午有一 Industry Forum 相
當有趣，邀集 Intel Sun 等重量級廠商談他們在 SoC 上的最新進展，吸引不少人，值得我們
辦活動時學習。 
第二天下午為 pannel discussion，我們這一場來了近 150 位聽眾，大家為未來 SoC 及 SiP
的發展做了深入的討論，是一場高水準的討論會。 
2Issues in SiP
• System in package (SiP) integrate many 
sorts of technologies, so it will face many 
new obstacles never seen before in 
electrical design. 
• They could be
• Intra-system high-frequency noise coupling and 
crosstalk
• Interference and immunity (EMC) issues.
• Signal integrity and design of (differential) 
interconnection 
• Power integrity and design for SiP
RF DieDigital Processor Die Memory Die
Antenna 1 Antenna 2Decoupling Capacitor
Signal Layer
Signal Layer
Power Layer
Ground Layer
Mutual coupling 
and
Noise interference
Ground b nced 
noise 
and radiatio
Noise Issue in SiP
