 3
Abstract 
The goal of the present proposal is to numerically investigate the evolution of 
magnetic domains of magnetostrictive materials. The boundary element method 
together with the fast Fourier transform is applied to compute the magneto-elastic 
interaction in the non-periodic setting. In addition, the parallel computation is also 
established in the simulation of microstructure of martensitic materials. The reason 
behind it is that the evolution equations of both materials are quite similar; moreover, 
the mathematical structure of martensitic materials is less complicated than that of 
magnetostrictive materials. It is expected that this preliminary study of parallel 
computation can be further applied to the simulation of magnetic domains in 
deformable ferromagnetic materials.  
 
 
 
Keyword：Magnetostriction、Stress-induced Magnetic Field、Micromagnetics 、
Parallel Computation,  
 
 5
6-1 單機版與平行版兩種兄弟晶、平均應變為零之模擬 ............................89 
6-2 單機版與平行版兩種兄弟晶、平均應變不為零之模擬 ........................93 
6-3 單機版與平行版之計算效率比較 ............................................................98 
第７章 結論 .............................................................................................................100 
第８章 自評與建議 .................................................................................................101 
參考文獻 ...................................................................................................................104 
附錄A FFTW & FFTW_MPI之使用 ..................................................................109 
附錄B 磁力耦合有限域褶積形式展開計算之說明.............................................114 
附錄C 邊界元素法之上下標詳細說明.................................................................118 
附錄D 快速傅立葉轉換應用於有限域與無限域褶積問題.................................123 
 
 7
之微結構排列，這是因為麻田散鐵在微結構演化方程式上與鐵磁材料具有諸多類
似之處，但其數學結構相較於鐵磁材料較為容易入手。因此本報告在平行演算部
份，將以麻田散鐵為例，將其微結構演算改寫成為平行化架構藉此提昇其效率與
網格切分數，而在後續之研究則可以將此平行演算架構應用於磁致伸縮材料上
面。 
 
 
 
 
 9
1-3 簡介 FFTW(Fast Fourier Transform in the West) 
於 1865 年 Gauss 就提出如何以更快的方式進行傅立葉轉換的計算，但直到
1965 年由 Cooley 與 Tukey 發表一系列關於快速傅立葉轉換的論文後，並且由於
計算機能力的加強，使得其轉換標本個數增大，因此快速傅立葉轉換才開始正式
受到重視。 
  FFTW(Fast Fourier Transform in the West)是一個用來計算DFT(Discrete 
Fourier Transform)的C語言函式庫，是目前世界上公認最快速的傅立葉轉換軟
體。而FFTW的創始人是 1997 年MIT的兩位博士生Matteo Frigo與Steven G. 
Johnson[21]所發展的，並且榮獲 1999 年的Wilkinson數值軟體獎(J. H. Wilkinson 
Prize for Numerical Software)。而FFTW如此快速的最大原因則在於它將
Divide-and-conquer的演算法以Dynamic-programming方式來找出最佳解，並且產
生出一組適合此解的程式碼以進行快速傅立葉轉換。本研究中所使用的為
FFTW2.15 的版本，而這也是目前唯一有支援MPI平行運算的快速傅立葉轉換。
而更多關於FFTW的資訊可以在他們的網頁取得。網址如下。 
http://www.fftw.org/ 
 11
1-5 文獻回顧 
在微觀磁學中最早為Landau & Lifshitz[19]在 1935 年提出了磁域理論，而W. 
F. Brown[3]則在微觀磁學一書中利用磁化向量的連續理論解釋了磁域壁的形成
是因為降低能量的必然結果。 
不考慮磁力耦合效應上，有Nakatani以有限差分法進行二維與三維的軟磁材
料模擬，而H. F. Schmidts與H. Kronmuller[25]則是建立了二維的鐵磁材料數值模
擬演算法，並且推導出二維的消磁張量之解析公式；J. Newell等人則計算了三維
立方格點的消磁張量形式，由其格點對稱性使得電腦數值計算更有效率，A. 
Hubert和W. Rave[29]則是以三維模擬架構分析了單軸材料在不同的材料尺寸和
磁異向性場強度下，其能量最小時的磁化向量分佈狀態。 
而在考慮磁力耦合效應上，有Fumio[20]在 1984 提出磁記憶薄膜因應力所產
生之消磁場理論，Jeong和Bogy[14]則是提出縱向記憶薄膜因逆磁致伸縮效應所
產生的消磁效應理論，Voltairas、Fotiadis與Massalas[30],[31]則以平面應變形式假
設整個磁性材料受到均勻應變場研究外力對此磁性材料一維之磁化向量翻轉和
磁滯現象之影響，DeSimone和James[5]則考慮了應變諧和條件，而Shu et al[37]
則是將整個磁致伸縮應變能與外應力勢能納入考慮，並且將應變諧和條件配合
Wu, et al[32],[33]所發展之BEM並且以平均應力形式求解整個磁性薄膜問題。   
Wechsler[22]的團隊，Bowles和MacKenzie[7]兩人最早提出麻田散鐵的結晶
學理論，在當時此理論就已提供麻田散鐵材料重大的研究成果。Ball和James[8],[9]
在基於能量最小的情形之下，提出了一理論方法來作為『單晶』麻田散鐵各種不
同相場之排列的模型。而後Bhattacharya分別與Kohn[15],[16]以及Shu[34]繼續沿
用此方法進行『多晶』麻田散鐵材料之研究。因相變所引發的應力會決定相變的
路徑，Khachaturyan[1]提出一套基於彈性力學的能量函數，當能量為最小值時可
證實在早期的結晶學理論中結果的正確性。彈性能量函數能夠藉由不同組合兄弟
晶的排列情形來達成最小值。Roytburd[2]也有做過類似的研究Wang等人
[10],[11],[12]則利用相場模擬法對於單晶材料的壓電和界電性質進行研究。Zhang
 13
第２章 理論架構-磁致伸縮材料 
 在磁致伸縮材料研究中，我們採用 LLG 方程式進行我們的微結構演化模
擬。其中我們利用能量極小原理配合變分推導出各個能量項之等效磁場，而後利
用邊界積分方程式計算其磁力耦合問題，並且藉由平均應力提高其準確度。 
2-1 數學模型 
考慮磁致伸縮材料在內部存有許多磁化向量，並且外部環境存在外加磁場
(applied magnetic field)和應力場(stress field)，我們能夠將總自由能寫成以下形
式： 
 
E( ) { ( ) ( ) ( ) ( ) ( ) ( )}dex an de Zee s apW W W W W W
Ω
= + + + + +∫m m m m m m m x  (2.1) 
而各項的能量密度分別是 
( )exW m ：磁交換能量密度 
( )anW m ：磁異向性能量密度 
( )deW m ：消磁能量密度 
( )ZeeW m ：外加磁場能量密度 
( )sW m ：磁致伸縮應變能量密度 
( )apW m ：外應力勢能密度 
而我們的m 代表的是材料的自發磁化向量。 
 
I. 磁交換能量密度(exchange energy density) 
 { }2 2 2 21 2 3W ( ) A Aex m m m= ∇ = ∇ + ∇ + ∇m m   
A 為磁交換勁度常數(exchange stiffness constant)，和材料有關。而在 A>0 時，此
項能量會促使相鄰磁化向量指向同一方向，而使得磁交換能為 0 以達到最穩定狀
 15
此軸通常是與六邊形垂直的中心軸，其磁異向性能量密度為 
( ) ( ) 22 20 1 2W ( ) 1 1an K K K⎡ ⎤ ⎡ ⎤= + − ⋅ + − ⋅ +⎣ ⎦ ⎣ ⎦m m n m n L        (2.3) 
其中n代表的是磁易軸方向的單位向量， iK 的定義則與立方材料相
同。 
 
圖 2-2 磁易軸示意圖 
III. 消磁能量密度(demagnetization energy density) 
 0
1( )
2
de deW μ= − ⋅m M H  (2.4) 
0μ 為導磁係數(permeability)， deH 則經由解以下的馬克思威爾方程式得到 
 
2
2 3
        x
0        x \
U
U R
⎧∇ = ∇⋅ ∈Ω⎨∇ = ∈ Ω⎩
M
 (2.5) 
其中 
 de U= −∇H  (2.6) 
 ( ) 1 ( ) ( )4U d dSπ ′ ′Ω ∂Ω
⎡ ⎤′ ′ ′ ′−∇ ⋅ ⋅′ ′= +⎢ ⎥′ ′− −⎣ ⎦∫ ∫
M x M x nx x
x x x x  (2.7) 
上式為三維的磁純量位能形式，其中 x 為場點的位置向量， ′x 為源點的位
置向量。而 ( )′ ′∇ ⋅M x 為體磁荷， ( )′ ′⋅M x n 為面磁荷。 
 
 17
2-2 能量極小原理 
 而在定義完我們各個能量項之後，我們便可以利用『變分法』(calculus of 
variation)來求得能量極小時的條件。 
 
首先我們將總能量寫成各個能量的分項，如下式 
 ex an de Zee s apE E E E E E E= + + + + +  (2.12) 
接著我們對上式取變分可得 
 ex an de Zee s apE E E E E E Eδ δ δ δ δ δ δ= + + + + +  (2.13) 
將各個能量項做以下分析： 
I. 磁交換能量項 
 
( ), ,
, ,
, ,
2
2 2
ex ex
i j i j
p q p q
p q q p p qq p
E W d
Am m d
Am m d
Am n m dS Am m d
δ δ
δ
δ
δ δ
Ω
Ω
Ω
∂Ω Ω
=
=
=
= −
∫
∫
∫
∫ ∫
x
x
x
x
 (2.14) 
II. 磁異向性能量項 
 ( )
( )
3
1
3
1
1
2
2
ex an
i i j j i i
i i p p p
E W d
K m m m m m m d
K m m m m m d
δ δ
δ
δ
Ω
Ω
Ω
=
⎡ ⎤= −⎢ ⎥⎣ ⎦
= −
∫
∫
∫
x
x
x
 (2.15) 
 
 19
3
3
2
2
2
2
2
2
1
1
1
1
1
1
de de
s
s
s
s R
s R
s
de
d d
M
Ud
M
Ud
M
U Ud
M
U Ud
M
U d
M
d
δ δ
δ
δ
δ
δ
δ
δ
Ω Ω
Ω
Ω
Ω
Ω
⋅ = ⋅
= − ⋅ ∇
= − ⋅∇
= − ∇ ⋅∇
= − ∇ ⋅ ∇
= − ∇ ⋅
= ⋅
∫ ∫
∫
∫
∫
∫
∫
∫
m h x M H x
M x
M x
x
x
M x
h m x
 
IV. Zeeman 能量項 
 ( )20
2
0
Zee Zee
ext
s i i
ext
s p p
E W d
M m h d
M h m d
δ δ
δ μ
μ δ
Ω
Ω
Ω
=
= −
= −
∫
∫
∫
x
x
x
 (2.18) 
V. 磁致伸縮應變能量與外應力勢能量項 
 
( )
( )( )
( )
( )
0 0
0
0
0
1
2
s ap s ap
ext
ijkl ij ij kl kl ij ij
ij
ijkl kl kl p
p
ext
rsij ij ij rs rs
E E W W d
C d
C m
m d
C
δ δ δ
δ ε ε ε ε σ ε
ε ε ε δ
ε ε σ δε
Ω
Ω
Ω
+ = +
⎛ ⎞= − − −⎜ ⎟⎝ ⎠
⎧ ⎫∂− −⎪ ⎪⎪ ⎪∂= ⎨ ⎬⎪ ⎪⎡ ⎤+ − −⎪ ⎪⎣ ⎦⎩ ⎭
∫
∫
∫
x
x
x
 (2.19) 
接著我們將 1=m 的限制條件納入考慮 
 0E Iδ λδ+ =  (2.20) 
其中λ為 Lagrange multiplier，而 I 則為 
 21
2-3 演化方程式 
在磁致伸縮材料中我們是以 LLG 方程式(Landau-Lifshitz-Gilbert Equation)來
描述微觀磁學中磁化向量演化。而此方程式最基本的出發點是角動量和磁矩之間
的交互作用，如下 
 50 1.105 10 ( )2
eff
e
ge mgm A s
γ
μγ
= − ×
= = × × ⋅
m m H&
 (2.26) 
其中γ 是旋轉磁率(gyromagnetic ratio)， g 是約等於 2 的常數。而此式子是
描述磁化向量m 繞著有效磁場 effH 旋轉的動態行為。以此式子為基礎，在引入
一個經驗上得無因次常數α，α 稱為阻尼係數(damping coefficient)。加上α 後磁
性材料的動態行為可由下式描述： 
 ( )eff effddt γ γα= − × − × ×m m H m m H  (2.27) 
上式即為 LLG 方程式。LLG 方程式亦隱含能量最小原理，當 0eff× =m H 時，m
隨著時間的變化量等於 0，此意味著系統達到穩定狀態，而在前一節我們可以知
道這是能量相對最小的狀態。 
 23
2-4 以邊界積分方程式解磁力耦合問題 
在本問題中，問題之物理量都是以應力、應變的形式出現，因此我們選用
Strain Based BEM 來解決我們的問題。而此套方法則是使用 Traction & 
Displacement gradient 為邊界值之方法。 
團隊之前的研究中，我們知道於不考慮徹體力(body force)的情況下，我們的
邊界積分方程式為 
 ( ) ( ) ( ) ( ) ( ), ,n l
c
z z z d
s s s
β ζ ζ ζ ζ σ∂ ∂ ∂⎡ ⎤= −⎢ ⎥∂ ∂ ∂⎣ ⎦∫
u U Wt d  (2.28) 
 ( ) ( ) ( ) ( ) ( ), ,T n l
c
z z z d
s s
ζ ζ ζ ζ σ⎡ ⎤∂ ∂= − −⎢ ⎥∂ ∂⎣ ⎦∫
W Vt t d  (2.29) 
 
圖 2-4 有限彈性體 
其中 ( )1 2,ξ ξ 為邊界上的點，而 1 2iζ ξ ξ= + 則是此點所對應到複數平面上的
點， 2 21 2d d dσ ξ ξ= + 。u 代表位移， ( )n ζt 則是在 ( )1 2,ξ ξ 以法向量n 之極小
線段的曳引力(traction)，而 ( )l ζd 則是在 ( )1 2,ξ ξ 以切線向量 l之極小線段的位移
梯度(displacement gradient)， l ∂= ∂ud l 。而 ( )1 2,x x 則是在彈性體內的求解點，
1 2z x ix= + 則是此點對應到複數平面上的點，s 是 ( )1 2,x x 上求解點的曲線方向，
 25
 
圖 2-5 無限彈性體受均勻應變場 
如上圖，考慮一無限彈性體於區域於 D− 存在一均勻應變場 0ε ，而在外部區域
D+ 則無應變。此問題的組成律如下 
 ( )0,ij ijkl k l klC uσ ε= −  (2.33) 
我們令 ,ij ijkl k lC uσ =% 、 0 0ij ijkl klCσ ε= 我們在邊界上可以得到 
 
( )
( )( )
( )
0
0
0 0
0 0
0
0
0
0
ij ij j
ij ij ij j
ij ij j ij j
i ij j
ij j i
n
n
n n
t n
n t
σ σ
σ σ σ
σ σ σ
σ
σ
+ −
+ −
+ −
− =
⇒ − − =
⇒ − + =
⇒ − + =
⇒ =
% %
% %  (2.34) 
因此我們可以知道均勻應變場 0ε 相當於在邊界上有等效曳引力 0t 。而因為此源
點 0t 所造成的彈性體內任一場點的位移梯度以及曳引力可由下列複數積分邊界
而得 
 ( ) ( ) 0,z z d
s s
ζ σ
Γ
∂ ∂ ′=∂ ∂∫u U t  (2.35) 
 27
我們便可以將(2.28)，(2.29)兩條邊界積分方程式以(2.35)，(2.36)來加以修正，並
且取主值後，就可以得到考慮數個徹體力區域的彈性體邊界積分方程式 
 
( ) ( ) ( ) ( ) ( )
( ) 0
1
, ,
                 ,
i
si
n l
c
B
n
i
z z z d
s s s
z d
s
β ζ ζ ζ ζ σ
ζ σ
= ∂Ω
∂ ∂ ∂⎡ ⎤=℘ −⎢ ⎥∂ ∂ ∂⎣ ⎦
⎡ ⎤∂ ′+ ℘⎢ ⎥∂⎢ ⎥⎣ ⎦
∫
∑ ∫
u U Wt d
U t
 (2.38) 
 
( ) ( ) ( ) ( ) ( )
( ) ( )
( )
0
0
1
,
,
                                   ,
i
si
T
n
c
l
TB
n
i
z
sz z z d
z
s
z d
s
ζ ζ
β γ χ σ
ζ ζ
ζ σ
= ∂Ω
⎡ ⎤∂ −⎢ ⎥∂+ = −℘ ⎢ ⎥∂⎢ ⎥⎢ ⎥∂⎣ ⎦
⎡ ⎤∂ ′+ ℘⎢ ⎥∂⎢ ⎥⎣ ⎦
∫
∑ ∫
W t
t t
V d
W t
 (2.39) 
 
 
 29
第３章 數值方法-磁致伸縮材料 
 在磁致伸縮材料中，我們將會先介紹 OOMMF 程式計算時所採用的兩個
ODE 數值解法，接著介紹我們邊界元素法之離散形式，接著將自發性應力項之
影響以褶積形式展開，並且配合高斯積分以及快速傅立葉轉換解決非周期性褶積
問題。 
3-1 數值積分法 
LLG 方程式為一階的 ODE，如同第三章的說明，LLG 方程式如下： 
 ( )            eff eff
s
d
dt M
γ γα= − × − × × =m Mm H m m H m  (3.1) 
我們可以知道 effH 為m 的函數，因此 LLG 方程式本身為以下形式： 
 ( )d f
dt
=m m  (3.2) 
 ( )0 initialt t= =m m  (3.3) 
這是一個標準的微分方程初值問題，而在本程式中 1主要是以『二階預測－修正
法』來對時間 t做疊代，並且當達到收斂條件後停止疊代，而收斂條件為： 
 
eff
eff
eff
sM
ε× <
=
m h
Hh
 (3.4) 
而為一趨近於『0』之值，在我們的計算流程中，設定的為1e-4。 
然而當『二階預測－修正法』在疊代過程中，因某些限制而無法進行時(如
0t t= )，我們將採用『四階 Runge-Kutta 法』進行疊代。 
A. 二階預測－修正法 
預測子(predictor)： 
 ( ) ( )31 132pn n n nt f f O t+ −Δ+ − + Δm = m  (3.5) 
修正子(corrector)： 
                                                 
1 Object Oriented MicroMagnetic Framework，美國國家標準局發展並公開於網際網路上的程式
碼。 
 31
3-2 能量的離散形式 
磁致伸縮材料中，我們有四種基本的自由能形式，分別為磁交換能量、磁異
向性能量、外加磁場能量與消磁能量，除此之外我們也將磁致伸縮應變能量也考
慮進去。而在數值模擬計算中，我們將材料模擬成由極小的正方形格點形式組成。 
I. 磁交換能 
 { }2 2 2 21 2 3exE A d A m m m d
Ω Ω
= ∇ = ∇ + ∇ + ∇∫ ∫m x x  (3.8) 
我們將各個磁向量梯度展開為 
 
22 2
2 1 1 1
1
1 2 3
22 2
2 2 2 2
2
1 2 3
22 2
2 3 3 3
3
1 2 3
m m mm
x x x
m m mm
x x x
m m mm
x x x
⎧ ⎛ ⎞⎛ ⎞ ⎛ ⎞∂ ∂ ∂⎪ ∇ = + + ⎜ ⎟⎜ ⎟ ⎜ ⎟∂ ∂ ∂⎪ ⎝ ⎠ ⎝ ⎠ ⎝ ⎠⎪ ⎛ ⎞⎛ ⎞ ⎛ ⎞∂ ∂ ∂⎪∇ = + +⎨ ⎜ ⎟⎜ ⎟ ⎜ ⎟∂ ∂ ∂⎝ ⎠ ⎝ ⎠ ⎝ ⎠⎪⎪ ⎛ ⎞⎛ ⎞ ⎛ ⎞∂ ∂ ∂⎪ ∇ = + + ⎜ ⎟⎜ ⎟ ⎜ ⎟⎪ ∂ ∂ ∂⎝ ⎠ ⎝ ⎠ ⎝ ⎠⎩
 (3.9) 
而在數值計算中，格點的尺寸在三個方向分別為 1xΔ 、 2xΔ 、 3xΔ ，因此我
們能夠將 21m∇ 的離散形式寫為 
 
22 2
2 3 11 1 2 1
1
1 2 3
mm mm
x x x
⎛ ⎞⎛ ⎞ ⎛ ⎞ ΔΔ Δ∇ = + + ⎜ ⎟⎜ ⎟ ⎜ ⎟Δ Δ Δ⎝ ⎠ ⎝ ⎠ ⎝ ⎠  (3.10) 
接著我們將磁化向量以第 i 個和第 i+1 個點離散表示 
 ( )
2 2
1,1 ,11 1
1 1
2 2 2
1,1 ,1 1,1 1,1 ,1 ,1
2 2
1 1
2
i i
i i i i i i
m mm
x x
m m m m m m
x x
+
+ + +
−⎛ ⎞ ⎛ ⎞Δ →⎜ ⎟ ⎜ ⎟Δ Δ⎝ ⎠ ⎝ ⎠
− + += =Δ Δ
 (3.11) 
而
2
1 2
1
m
x
Δ⎛ ⎞⎜ ⎟Δ⎝ ⎠ 和
2
1 3
1
m
x
Δ⎛ ⎞⎜ ⎟Δ⎝ ⎠ 也可以做類似的展開，且因為 1=m ，故能
將這三項合併 
 33
 
2
0 0
2 2 2
2 2 2
0 1 2 3
1 2
2
ex
ex
s s
s
W A
M M
A
M x x x
μ μ
μ
∂= − = ∇∂
⎛ ⎞∂ ∂ ∂= + +⎜ ⎟∂ ∂ ∂⎝ ⎠
H m
m
m m m  (3.16) 
考慮其中一項為 
 
22 22
31 2
1 2 32 2 2 2
1 1 1 1
1,1 ,1 1,1 1,2 ,2 1,2
1 22 2
1 1
1,3 ,3 1,3
32
1
2 2
2
i i i i i i
i i i
mm m
x x x x
m m m m m m
x x
m m m
x
+ − + −
+ −
∂∂ ∂∂ = + +∂ ∂ ∂ ∂
− + − += +Δ Δ
− ++ Δ
m e e e
e e
e
 (3.17) 
由於 3x 方向不分割且 1 2x xΔ = Δ ，因此我們最後得到磁交換場的離散形式為 
 ( )2
0 1
2 4ex j i
j NNs
A
M xμ == −Δ ∑H m m  (3.18) 
接著考慮『8 鄰近格點法』，因此最後磁交換場的離散形式為 
 ( )2
0 1
2 8
3
ex
j i
j NNNs
A
M xμ == −Δ ∑H m m  (3.19) 
 
II. 磁異向能 
 ( )an anE W d
Ω
= ∫ m x  (3.20) 
而在[37]中我們得知對於立方材料(cubic material)其能量密度為 
 ( ) ( ), 2 2 2 2 2 2 2 2 20 1 1 2 2 3 1 3 2 1 2 3W ( )an cubic K K m m m m m m K m m m= + + + + +m L  (3.21) 
接著忽略高次項以及常數項後，其能量離散形式為 
 ( )an,cubic 2 2 2 2 2 2i 1 ,1 ,2 ,2 ,3 ,1 ,3i i i i i i
i
E K V m m m m m m= + +∑  (3.22) 
而對單軸材料(uniaxial material)其能量密度為 
 2 40 1 2W ( ) sin sin
an K K Kθ θ= + + +m L  (3.23) 
 35
 ( ) ( )14
s
U dSπ ′∂Ω
′ ′⋅ ′= ′−∫ M x nx x x  (3.30) 
而消磁場為 
  
 de U= −∇H  (3.31)
  
而考慮另一磁性材料體積為v，且材料內部的磁化向量亦為單一方向，則此
料內部由 ( )U x 所引發的平均消磁場 deH 為 
 
( )
( )
1
1
1
4
de U d
v
U dS
v
d
d
vπ
Ω
∂Ω
′∂Ω ∂Ω
= −∇
=
′ ′⋅−= ′−
∫
∫
∫ ∫
H x
n
M x S
S
x x
 (3.32) 
因此我們能夠定義出消磁張量(demagnetizing tensor) N 
 
( )
11 12 13
21 22 23
31 32 33
1 1
4
de
N N N
N N N d d
v
N N N
π ′∂Ω ∂Ω
′= −
⎡ ⎤⎢ ⎥ ′⇒ = =⎢ ⎥ ′−⎢ ⎥⎣ ⎦
∫ ∫
H NM x
N S S
x x
 (3.33) 
因此我們的消磁能為 
 0
1
2
de deE dμ
Ω
= − ⋅∫M H x  (3.34) 
而其離散形式為 
 0
1
2
de de
i i
i
E μ= − ⋅∑M H  (3.35) 
 
V. 外應力勢能、磁致伸縮應變能與其引發之有效磁場 
 37
3-3 邊界元素法  
 
圖 3-2 BEM 模型分割示意圖 
從圖中我們可以看出我們將彈性體邊界分割成 N 個直線線段組成，並且每
一線段上得『位移梯度』和『曳引力』視為常數，此值以該線段『中點』的值代
表。而同樣將徹體力區域的邊界分成 n 個直線線段組，而徹體力區域邊界 si∂Ω 每
一線段的『等效曳引力』也視為常數，而此值也以該線段『中點』的值代表。 
在上一章中我們得到兩個邊界積分方程式。 
 
( ) ( ) ( ) ( ) ( )
( ) 0
1
, ,
                 ,
i
si
n l
c
B
n
i
z z z d
s s s
z d
s
β ζ ζ ζ ζ σ
ζ σ
= ∂Ω
∂ ∂ ∂⎡ ⎤=℘ −⎢ ⎥∂ ∂ ∂⎣ ⎦
⎡ ⎤∂ ′+ ℘⎢ ⎥∂⎢ ⎥⎣ ⎦
∫
∑ ∫
u U Wt d
U t
 (3.40) 
 
( ) ( ) ( ) ( ) ( )
( ) ( )
( )
0
0
1
,
,
                                   ,
i
si
T
n
c
l
TB
n
i
z
sz z z d
z
s
z d
s
ζ ζ
β γ χ σ
ζ ζ
ζ σ
= ∂Ω
⎡ ⎤∂⎢ ⎥∂+ = −℘ ⎢ ⎥∂⎢ ⎥−⎢ ⎥∂⎣ ⎦
⎡ ⎤∂ ′+ ℘⎢ ⎥∂⎢ ⎥⎣ ⎦
∫
∑ ∫
W t
t t
V d
W t
 (3.41) 
接著我們將(3.40)離散化 
 39
因此(3.43)便可以表示為 
 ( )12
2
,
k
k
t T
t
z d
s
ζ σ+ ∗ ∗∂ ⎡ ⎤= ℜ =⎣ ⎦∂∫ U AG A U  (3.47) 
同樣的 
 ( )12
2
,
k
k
t T
t
z d
s
ζ σ+ ∗ ∗∂ ⎡ ⎤= ℜ =⎣ ⎦∂∫ W AG B W  (3.48) 
 ( )12
2
,
k
k
t T
t
z d
s
ζ σ+ ∗ ∗∂ ⎡ ⎤= ℜ =⎣ ⎦∂∫ V BG B V  (3.49) 
而 ∗G 則為一描述『源點』對『場點』影響的函數。 
 
而在一般彈性力學問題中，邊界條件為位移或者曳引力二選一，因此在邊界
上只會有一半的位移、曳引力是已知數，另一半則為未知數。因此先利用邊界積
分方程式求解邊界上的未知數。 
我們將所求的點取在離散化邊界的線段元素中點，則可以求出在此點上的未
知邊界條件，因此我們邊界積分方程式的離散形式可寫為 
 
( ) ( )
( )
( )( )
( ) ( ) ( ) ( )( ) ( )( )
0
1 1 1 1
0
1 1 1 1
                 1, 2, ,
      1, 2, ,
b
b
N N B n
b
fs l fs n fq ns s qs s b q
N N B nT T b
n fs l ns sfs fq qs s b q
f N
f N
∗ ∗ ∗
= = = =
∗ ∗ ∗
= = = =
= + =
= + =
∑ ∑ ∑∑
∑ ∑ ∑∑
W d U t U t
W t V d W t
L
L
(3.50) 
其中下標 f 代表邊界上的場點，s 代表積分邊界上的源點，q 代表積分徹體力區
域邊界 si∂Ω 的源點。而當 f s≠ 、 f q≠ 時，我們能夠將矩陣 fs∗U fs∗V fs∗W 寫成以
下形式 
 
T
fs fs
T
fs fs
T
fs fs
∗ ∗
∗ ∗
∗ ∗
⎡ ⎤= ℜ⎣ ⎦
⎡ ⎤= ℜ⎣ ⎦
⎡ ⎤= ℜ⎣ ⎦
U AG A
V AG B
W BG B
 (3.51) 
其中 
 41
nt 。因此最後的離散形式為 
 
( ) ( ) ( ) ( )( )( )
( ) ( ) ( ) ( ) ( ) ( )( )( )
0
1 1 1 1
0
1 1 1 1
v
v
N N B n
b
fs n fs l fq ns s qs s b q
N N B nT T b
n n fs l ns sfs fq qs s b q
z
s
z
∗ ∗ ∗
= = = =
∗ ∗ ∗
= = = =
∂ = − +∂
= − + −
∑ ∑ ∑∑
∑ ∑ ∑∑
u U t W d U t
t W t V d W t%
 (3.54) 
其中真實的曳引力為 0= −t t t% 。而整個應力與應變的關係式為下。 
 
( ) ( ) ( )( )
( ) ( )( ) ( )
0 0 90
0 90 90
1 2 1
2 1 2
1
2
1
2
l l l
l l l
d d d
d d d
⎡ ⎤+⎢ ⎥= ⎢ ⎥⎢ ⎥+⎢ ⎥⎣ ⎦
ε  (3.55) 
 
( ) ( )
( ) ( )
90 0
90 0
1 1
2 2
n n
n n
t t
t t
⎡ ⎤−⎢ ⎥= ⎢ ⎥−⎣ ⎦
σ  (3.56) 
而在整個問題中，是在探討薄膜問題，因此我們能夠將應力假設為『平面應
力』是適用的。因此在計算 0t 時也做了些許化簡，因此我們的自發性應變形式
改為 
 
2
100 1 111 1 2
0
2
111 1 2 100 2
3 1 3
2 3 2
3 3 1
2 2 3
m m m
m m m
λ λ
ε
λ λ
⎡ ⎤⎛ ⎞−⎜ ⎟⎢ ⎥⎝ ⎠⎢ ⎥= ⎢ ⎥⎛ ⎞−⎢ ⎥⎜ ⎟⎝ ⎠⎣ ⎦
 (3.57) 
而等效曳引力 0t 則為 
 0 0 0t = σ n = Cε n  (3.58) 
而應變梯度則為 
 
100 1 111 2 111 1
0
1 2
111 2 111 1 100 2
3 33 0
2 2
3 30 3
2 2
m
m m m
m m m
λ λ λ
λ λ λ
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥∇ = +⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦
ε e e  (3.59) 
 43
3-4 褶積形式之應力 
根據[46]，首先我們先將最後一項單獨取出 
 ( ) ( )( )( ) 0
1 1
vB n T b
n nfq qb q
∗
= =
= −∑∑t W t%  (3.60) 
在整個數值模擬中，我們是切分 N N× 個『正方形』網格。在上式中
( )
1
vn
q=
∑ 代
表正方形網格四個邊界( 0 ,90 ,180 , 270o o o o )，
1
B
b=
∑ 則是對應於整個 N N× 個徹體
力區域，因此也能夠將此寫成
1 1
N N
r s= =
∑∑ ，接著我們將 ∗W 做以下的分析。 
 
( )
( )
( ) ( )
( ) ( )
( )
( )
( ) ( ) ( ) ( )
( ) ( )
( )
( )
( ) ( )
( )
1 12
1
2
1 ln ,
1 1 1 11 2 2ln ,
1 1
2 2
1 11 2 2ln
1
2
T
ff s
n n n
n s f s
n n n
f
n nn
s
n n n
f
nn
s
n
diag
i
i p j r p s
diag
i i p j r p s
i r p j s
diag
i i r
ζ ζ ζ
π ζ ζ ζ
ζ
π ζ
ζ
π ζ
∗ ∗
+ +
∗
+
⎡ ⎤= ℜ⎣ ⎦
⎡ ⎤⎛ ⎞−⎢ ⎥⎜ ⎟= − ⎢ ⎥⎜ ⎟−⎝ ⎠⎣ ⎦
⎡ ⎤⎛ ⎞+ Δ + + Δ − + Δ − + Δ⎢ ⎥⎜ ⎟= − ⎢ ⎥⎜ ⎟+ Δ + + Δ − Δ − Δ⎢ ⎥⎝ ⎠⎣ ⎦
− − Δ + − − Δ= − − +
W AG B
G
)
)
)
)
)
) ( ) ,12
1, 2,3
np j s
n
⎡ ⎤⎛ ⎞⎢ ⎥⎜ ⎟⎢ ⎥⎜ ⎟Δ + − + Δ⎢ ⎥⎝ ⎠⎣ ⎦
=
(3.61) 
因此我們能夠修正為 
 ( ) ( )( ) 0( , ) ( , ) ( , )
1 1 1
vn N N T
n i j i r j s n r sfq q
q r s
∗
− −
= = =
= −∑∑∑t W t%  (3.62) 
而此項應力便以褶積形式(convolution form)呈現，則我們便能夠以快速傅立葉轉
換配合高斯積分進行此項應力值的計算。 
 45
因此我們最後只需要對 ∗G 進行積分即可。因此我們先考慮平均化積分。 
 
1 2
1 2
1 2
1 2
1
1
r
rfs
r
fs
r
r fs
r
x xp
s sdiag g
i p
x xp
s sdiag g
i p
ξ ξπ
σ σ
ξ ξπ
σ σ
∗
∂ ∂⎛ ⎞+⎜ ⎟∂ ∂= − ⎜ ⎟∂ ∂⎜ ⎟+∂ ∂⎝ ⎠
∂ ∂⎛ ⎞+⎜ ⎟∂ ∂= − ⎜ ⎟∂ ∂⎜ ⎟+∂ ∂⎝ ⎠
G
 (3.68) 
因為我們切分的網格為正方形，因此 1 2r
x xp
s s
∂ ∂+∂ ∂ 、
1 2
rp
ξ ξ
σ σ
∂ ∂+∂ ∂ 皆為常數可提
出於積分外。因此最後我們所要考慮的積分為 r fsg 。而此積分我們則利用『高
斯積分法』求解。 
 
二維高斯積分公式為 
 ( ) ( )1 1
1 1
1 1
, ,
n n
i j i j
i j
f d d w w fξ η ξ η ξ η− − = =∑∑∫ ∫    (3.69) 
其中 iw 為權重係數(weighting conefficients)， ( ),i jξ η 則為網格內的座標點，而整
個點取的愈多其值愈接近該積分的正確值。而在程式中， ∗G 只和整個網格有關
係，因此只需要在程式一開始求出並且儲存起來便可以不再重複計算。也不會因
為高斯積分而改變其褶積形式，因此便能以快速傅立葉轉換配合高斯積分進行其
有限域的計算，而整個形式便如以下。 
 
( , )
1 1
( , )
1 1
( , )
1 1
n n
i j i j
i j
n n
i j i j
i j
n n
i j i j
i j
w w
w w
w w
∗
= =
∗
= =
∗
= =
∑∑
∑∑
∑∑
W
V
U
 (3.70) 
 
 47
3-6 快速傅立葉轉換解有限域褶積應力問題 
根據[46]與附錄 D 我們能夠以延伸褶積函數的方法，使整個褶積形式成為一
週期性問題，在取出正確的部份即可得到我們所要求的有限域褶積函數。因此在
磁力耦合問題中，將邊界元素法代入平均應力中可得到下式。 
 ( ) ( )( ) 0( , ) ( , ) ( , )
1 1 1
vn N N T
n i j i r j s n r s qfqq r s
∗
− −
= = =
⎡= − ⎣∑∑∑t W t%  (3.71) 
接著我們將上式以四個邊界拆開則可以得到 
 
( ) ( )
( ) ( )
( ) ( )
( ) ( )
0
( , ) ( , ) 001 1
0
( , ) ( , ) 90901 1
( , )
0
( , ) ( , ) 1801801 1
0
( , ) ( , ) 2702701 1
N N T
i r j s n r s
fr s
N N T
i r j s n r s
fr s
n i j N N T
i r j s n r s
fr s
N N T
i r j s n r s
fr s
∗
− −
= =
∗
− −
= =
∗
− −
= =
∗
− −
= =
⎧ ⎫⎡⎪ ⎪⎣⎪ ⎪⎪ ⎪⎡+⎪ ⎪⎣⎪ ⎪= −⎨ ⎬⎪ ⎪⎡+ ⎣⎪ ⎪⎪ ⎪⎪ ⎪⎡+ ⎣⎪ ⎪⎩ ⎭
∑∑
∑∑
∑∑
∑∑
W t
W t
t
W t
W t
oo
oo
oo
oo
%
 (3.72) 
 
其中0 ,90 ,180 , 270o o o o代表的是每個網格的四個邊界，而 nt 在計算上是將之分為
0
nt o 、 90nt o ，而這兩個資訊就可以讓我們知道這個網格內所有的應力狀態。因此
實際上在做計算時我們是以高斯積分法先行計算出 ,i r j s
∗
− −W ，而後再將
0
nt o 與
90
nt o 分別對於0 ,90 ,180 , 270
o o o o四個網格邊界先行加總後再進行傅立葉轉換，即
可得到我們的應力部份。將整個計算展開即為以下兩個式子。 
 
0 00
0 00
011 121
1
0
1 1 1 21 222 2 ( , )( , )( , )
T
B N N
q r s r s qi r j si j
fq
W Wt t
W Wt t
∗
= = = − −
⎛ ⎞⎡⎡ ⎤ ⎡ ⎤ ⎛ ⎞⎡ ⎤⎜ ⎟⎢⎢ ⎥ ⎢ ⎥ ⎜ ⎟= ⎢ ⎥⎜ ⎟⎢ ⎜ ⎟⎢ ⎥ ⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎣ ⎦ ⎢⎣⎝ ⎠
∑∑∑ o oo
o oo
%
% (3.73) 
 49
第４章 數值模擬結果-磁致伸縮材料 
 在磁致伸縮材料中，先針對不同點之高斯積分進行比較。接著本文將針對兩
種性質的材料進行模擬與分析。並且對於此兩種材料進行不同尺寸與相同尺寸不
同網格數之模擬與分析比較。而本文中所模擬之結果皆為一個『部份』分佈，而
真實情況則為多個『部份』分佈之隨機組成。 
4-1 高斯積分之比較 
在本文中是採用高斯積分來計算平均應力，因此積分點數的選擇將會影響整
個模擬出來的結果正確性以及其精確度。接下來我們將針對積分點數的選擇做以
下分析。而參考座標系如圖 7-1 為 [ ]1 110=e 、 [ ]2 001=e 、 3 110⎡ ⎤= ⎣ ⎦e ，並稱
此座標系為『twin』。 
 
 
首先我們先以同樣的隨機初始條件 A 做四邊拘束且無外加磁場狀態的
Terfenol-D 薄膜之模擬，在此座標系下其設定條件如下 
( )11 2
5
12
4
31
Total size = 640 640 10 
Cell size = 10 10 10 
1.3222 0.4163 0
0.4163 1.1330 0 10
0 0 0.4870
8 10
9 10
6 10
s
nm
nm
NC m
AM m
JA m
JK m
−
× ×
× ×
⎡ ⎤⎢ ⎥= ×⎢ ⎥⎢ ⎥⎣ ⎦
= ×
= ×
= − ×
 
 51
 
圖 4-3 傳統平均法之模擬結果 
 
圖 4-4 以四點高斯積分之模擬結果 
 53
所需時間。 
 Time(second) Iteration Total Exchange Anisotropy Demag Elastic 
傳統法 13286 2993 27645 1747 15235 8090 2573 
四點 2340 2594 27646 1747 15234 8091 2574 
九點 2494 2578 27645 1747 15234 8090 2574 
二十五點 2806 3010 27645 1747 15234 8090 2574 
表 4-1 各個方法之能量密度表 
傳統法為顏睿亨 [43]於『磁性薄膜磁力互動模型分析與數值模擬之研究』中所使
用的非快速演算法之結果。其中Iteration為疊代次數，Time為模擬完成所花費的
總時間，而各個能量項的單位為 3J m 。從表中我們可以發現，從四點到九點甚
至到二十五點，我們各個能量可以說是與傳統非快速演算法所計算出來的近乎完
全一樣，但是整個計算速度卻大幅上升。而其中特別值得注意的是疊代次數在 9
點的時候為最低。接著我們在以另外一個隨機的初始條件同樣的條件下再進行我
們的分析比較。 
 
 
 
 
 55
 
圖 4-9 以四點高斯積分之模擬結果 
 
圖 4-10 以九點高斯積分之模擬結果 
 57
好的選擇。因此在這之後我們所討論的問題，都將採用九點高斯積分法來進行其
數值模擬。 
 
 59
 
圖 4-13 640 640 10 nm× × 之模擬結果 
 
圖 4-14 1280 1280 10 nm× × 之模擬結果 
 
 
 61
4-3 Terfenol-D 不同網格數之分析 
接下來我們將比較同樣為640 640 10 nm× × 的大小，而整個網格切分為
64 64× 與128 128× 網格數之下，對於我們最後模擬的結果有何影響，並且驗
證其正確性。 
網格切分數 Time(second) Total Exchange Anisotropy Demag Elastic 
64 64×  2494 27645 1747 15234 8090 2574 
128 128×  11495 27719 1708 15586 8068 2593 
表 4-4 不同網格切分數模擬結果之能量密度表 
 
首先我們可以發現，在能量密度上面我們總能量與各個能量分項其能量密度
約略相同。再來由整個模擬出來的結果我們可以發現我們的磁域數目是相等的，
而其整個磁域分佈也一致。因此我們在正確性上面可以說是再次獲得驗證。而在
所花的時間上面卻差了 4.61 倍的時間，因此我們可以得到以下結論。 
 
『對於 Terfenol-D 材料而言，單元網格的大小以10 10 10 nm× × 是最有效率的
作法。』 
 
 
 
 
 63
4-4 1 0K > 之材料不同尺寸之分析 
接著我們對 1 0K > 之材料薄膜進行模擬，其材料係數設定如下。 
( )11 2
6
11
5
31
111
3
100
0.7184 0.3184 0
0.3184 0.7184 0 10
0 0 012300
1.432 10
1 10
2 10
0
2.64 10
s
NC m
AM m
JA m
JK m
λ
λ
−
−
⎡ ⎤⎢ ⎥= ×⎢ ⎥⎢ ⎥⎣ ⎦
= ×
= ×
= ×
=
= ×
 
而此材料與 Terfenol-D 最大的不同在於此材料的 1 0K > ，則此材料之磁易軸方
向為[ ]100 、[ ]010 、[ ]001 三個方向。而 111 0λ = 則會使得整個自發性應變為[ ]100 、
[ ]010 兩個方向。因此與麻田散鐵材料相同，兩個磁易軸向的磁域其夾角將會為
45o 、135o。而參考座標系如圖 7-17 為 [ ]1 100=e 、 [ ]2 010=e 、 [ ]3 001=e 。 
 
圖 4-17  1 0K > 磁易軸方向示意圖 
接 下 來 我 們 將 針 對 320 320 10 nm× × 、 640 640 10 nm× × 以
128 128× 網格切分數進行模擬。 
 65
 
圖 4-18 320 320 10 nm× × 之模擬結果 
 
圖 4-19 640 640 10 nm× × 之模擬結果 
 67
 
圖 4-20 320 320 10 nm× × 以128 128× 網格數之模擬結果 
 
圖 4-21 320 320 10 nm× × 以64 64× 網格數之模擬結果 
 69
一次疊代計算時間(second) 
網格數 
傳統方法 快速傅立葉法 
32 32×  0.55 0.33 
64 64×  4.54 1.03 
128 128×  無法計算 
(需要 32G 記憶體) 
6.57 
表 4-7 快速演算法與傳統平均法之一次疊代時間表 
 
 
 
 
 71
為，當 A 為正值，此時能量會促使相鄰元素之內變數值相同，使得能量交
換為零，以達成最穩定狀態。反之當 A 為負值時，相鄰元素之內變數差值
必須為最大(0 或者 1)，使能量達到負的最大值。才能使得此項的能量為最
低。 
 
圖 5-1 最小壁能量密度示意圖 
 
II. 異向性能量密度(anisotropy energy density) 
 2 2W ( ) (1 ) 0a i iκμ μ= − >μ  (5.3) 
κ 為材料常數且大於 0，因此能量項在 μ 為 0 或者 1 的時候，會使得
W ( ) 0a μ =% ，則此項能量為最小。 
 
III. 彈性力學能量密度(elastic energy density) 
應力： ( )∗= −σ C ε ε  
應變： 1( ) ( )
2
T= ∇ +∇ε μ μ μ  
其中 ∗ε 為本徵應變(eigenstrain)，而我們則可以得到以下的彈性力學能量密
度 
 
1W ( ) ( )
2
elas ∗ ∗= − −ε ε C ε ε   (5.4) 
 
接著我們以變分法來推導初期演化方程式，首先我們將總能量寫成各個能量的總
和，如以下式子： 
 wa a elasE E E E= + +  (5.5) 
 73
 
1 2
i i
x xj jside side
μ μ∂ ∂=∂ ∂  (5.8) 
所以在沿著邊界積分一圈回到原點後則會使得 
 ( ) 0i j i
j
n ds
x
μ δμ
∂Ω
∂ =∂∫  (5.9) 
II. 異向性能量項 
 { }2 22 (1 ) 2 (1 )
2 (1 )(1 2 )
a a
a
i
i
i i i i
i i i
E W d
W d
d
d
δ δ
δμμ
κμ μ κμ μ
κμ μ μ
Ω
Ω
Ω
Ω
=
∂= ∂
= − − −
= − −
∫
∫
∫
∫
x
x
x
x
 (5.10) 
 
 75
 22A
a
i i
i i
WF εμ μ μ
∗∂ ∂= ∇ − + ⋅∂ ∂σ  (5.17) 
F 稱為熱力學驅動力(thermodynamic driving force)，而在演化結束之後，必須使
得 F 等於零。而經由能量對時間做一次微分可得以下式子 
 ( )( )
2 0
dE E d
dt t
L d
L d
δ
δΩ
Ω
Ω
∂= ∂
= −
=− ≤
∫
∫
∫
μ x
μ
F F x
F x
 (5.18) 
因此在整個演化過程中我們可以保證總自由能是遞減狀態的。接著我們假設兩種
兄弟晶的變形如下圖所示，我們可以使用一個變數μ來描述 
 
圖 5-3 兩種兄弟晶之麻田散鐵變形示意圖 
我們的 (1)ε 與 (2)ε 可以表示成 
 (1) (2)
0 - 0
=     =
0 - 0
α α
α α
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦ε ε  (5.19) 
其中α 為一常數，因此我們可以用下式描述每個元素的本徵應變 
 
( )
( )
(1) (2)( )= + 1-
0 - 0
= + 1-
0 - 0
μ μ μ
α αμ μα α
∗
⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦
ε ε ε
 (5.20) 
 
(2)ε
 77
 
( ) ( ) ( )
[ ] [ ]
2
11 22- 1- 1- 2 -
= 0,1 x 0,1
D
t
μ αμ μ μ μ σ σκ
∂ = ∇ +∂
Ω
 (5.26) 
  
而整個應力的計算我們首先將彈性力學的平衡方程式(equilibrium equation)寫成
下面的式子 
 ( ) 0∗∇ ⋅ = ∇ ⋅ − =σ C ε ε  (5.27) 
我們首先假設應變是週期性，然而位移場卻不能確定也為週期性，是故我們必須
先將應變分解成為 
 
⎧ = +⎪⎨ = −⎪⎩
ε ε ε
ε ε ε
%
%  (5.28) 
其中 ε 為平均應變，並且 0=ε% 。而我們對本徵應變做相同的分解 
 
0        
∗ ∗ ∗
∗
⎧ = +⎪⎨ =⎪⎩
ε ε ε
ε
%
%  (5.29) 
因此應力就可以表示成為以下的形式 
 
( )
( ) ( )
∗
∗ ∗
= −
= − + −
σ C ε ε
C ε ε C ε ε% %
 (5.30) 
其中 ε 以及 ∗ε 是常數，所以彈性力學平衡方程式便可以寫成 
 ( ) 0∗∇ ⋅ − =C ε ε% %  (5.31) 
而此時必定會有一位移場u%會滿足以下式子 
 ( )12 T= ∇ +∇ε u u% % %  (5.32) 
並且在所有邊界為固定的邊界條件之下 0=ε ，最後應力可以表示成以下 
 ( )∗ ∗= − + −σ C ε C ε ε% %  (5.33) 
而研究薄膜受本徵應變影響的問題時，我們可以將彈性力學平衡方程式以二
 79
接著我們將(5.35)、(5.36)、(5.37)帶入(5.38)可以得到 
 
11,1 12,2 1 11,1 12,2
21,1 22,2 2 21,1 22,2
e e
e e
f
f
σ σ σ σ
σ σ σ σ
∗ ∗
∗ ∗
⎧ + = = +⎪⎨ + = = +⎪⎩  (5.39) 
經由(5.39)式左邊兩項可得 
 
( )
( )
11,1 22,1 12,2 1
12,1 11,2 22,1 2
2 2
2 2
f
f
λ μ ε λε με
με λε λ μ ε
⎧ + + + =⎪⎨ + + + =⎪⎩
 (5.40) 
接著我們對(5.40)取傅立葉轉換，以符號上面加上～表示為做傅立葉轉換函數。 
 
( )( ) ( ) ( )
( ) ( ) ( )( )
1 1 11 1 22 2 12
2 1 12 2 11 2 22
2 2 2 2 2
2 2 2 2 2
f i i i
f i i i
λ μ πω ε λ πω ε μ πω ε
μ πω ε λ πω ε λ μ πω ε
⎧ = + + +⎪⎨ = + + +⎪⎩
% % % %
% % % %  (5.41) 
1ω 和 2ω 代表的是在傅立葉空間的變數，接著我們將上式表示成矩陣形式 
 
( ) ( ) ( )
( ) ( )
11
1 1 2 1
22
22 2
12
i2 +2 i2 4i
=
4i i2 +2
f
f
επω λ μ λ πω μπω εμπω λ πω λ μ ε
⎧ ⎫⎡ ⎤ ⎧ ⎫⎪ ⎪ ⎪ ⎪⎢ ⎥ ⎨ ⎬ ⎨ ⎬⎢ ⎥ ⎪ ⎪⎪ ⎪ ⎩ ⎭⎣ ⎦ ⎩ ⎭
% %
% %
%
 (5.42) 
其中我們的應變以位移來表示 
 
( )
11 1,1
22 2,2
12 1,2 2,1
=               
=              
1= +
2
u
u
u u
ε
ε
ε
⎧⎪⎪⎨⎪⎪⎩
 (5.43) 
接著將(5.43)取傅立葉轉換 
 
( )
( )
( )
11 1 1
22 2 2
12 2 1 1 2 2 1 1 2
= 2                                           
= 2                                          
1= 2 + 2 = +
2
i u
i u
i u i u i u i u
ε πω
ε πω
ε πω πω πω πω
⎧⎪⎪⎨⎪⎪⎩
% %
% %
% % % % %
 (5.44) 
並且在將此式以矩陣形式表示 
 81
最後我們就可以得到應力σ%與本徵應力 ∗σ% 的關係式 
 ( )-1= - =∗ ∗⎡ ⎤⎣ ⎦σ CB ECB E I σ Sσ% % %  (5.52) 
而我們的轉換矩陣S經由數學運算後可得 
 ( )
( ) ( )
( ) ( )
( ) ( )
4 2 2 2 2 2 3
2 1 2 2 1 2 1 2
2 2 2 4 2 2 3
1 2 1 1 1 2 1 22
1 2 3 3 2 2 2 2
1 2 1 2 1 2 1 2 1 2
- - 2 1
1= - - 2 1
+
- - -2 1
ω νω ω ω ω νω ν ωω
ω ω νω ω νω ω ν ω ωω ω ωω νω ω ωω ω νω ν ω ω
⎡ ⎤+ + +⎢ ⎥⎢ ⎥+ + +⎢ ⎥⎢ ⎥+⎣ ⎦
S  (5.53) 
最後我們將(5.52)取傅立葉逆轉換則可以得到應力值 
 
5-2 平行化架構與數值方法 
我們將演化方程式表示成以下式子 
 2i i i ( )D ft
μ μ∂ = ∇ +∂ μ  (5.54) 
兩種兄弟晶時，我們的 i ( )f μ 為 
 ( ) ( ) ( )11 22( ) ( ) - 1- 1- 2 -if f αμ μ μ μ σ σκ= = +μ  (5.55) 
接著我們對(6.1)取傅立葉轉換後可得 
 2Dk f
t
μ μ∂ = +∂
% %%  (5.56) 
其中 
 ( )2 2 2 21 2-4k k kπ= +  (5.57) 
而 1k 與 2k 是傅立葉空間的變數。因此我們將演化方程式從偏微分方程式轉換為
一常微分方程式，接著我們使用半隱性法(semi-implicit method)將拉普拉斯
(Laplace)項的 μ% 以第 n+1 個時間點代入，而 f% 則是用第 n 個時間點代入來計算
此一常微分方程式。因此我們將(5.54)寫成離散形式 
 83
 
22
2
x y
μ μμ ⎛ ⎞Δ Δ⎛ ⎞∇ = + ⎜ ⎟⎜ ⎟Δ Δ⎝ ⎠ ⎝ ⎠  (5.63) 
接著我們使用中央差分(central difference)的離散形式，於是我們可以將
2
x
μΔ⎛ ⎞⎜ ⎟Δ⎝ ⎠ 與
2
y
μ⎛ ⎞Δ⎜ ⎟Δ⎝ ⎠ 表示成以下式子 
 
( )
( )
222 2 2
1, -1,1, -1, 1, 1, -1, -1,
2 2
222 2 2
, 1 , -1, 1 , -1 , 1 , 1 , -1 , -1
2 2
-- - 2
2 4 4
-- - 2
2 4 4
i j i ji j i j i j i j i j i j
i j i ji j i j i j i j i j i j
x x x x
y y y y
μ μμ μ μ μ μ μμ
μ μμ μ μ μ μ μμ
++ + +
++ + +
⎧ +⎛ ⎞Δ⎛ ⎞⎪ → = =⎜ ⎟⎜ ⎟⎪ Δ Δ Δ Δ⎝ ⎠⎪ ⎝ ⎠⎨⎪ +⎛ ⎞⎛ ⎞Δ → = =⎪ ⎜ ⎟⎜ ⎟Δ Δ Δ Δ⎪⎝ ⎠ ⎝ ⎠⎩
(5.64) 
而 ,i jμ 代表的是在第 i、 j 個網格點的位置上的μ 值。我們所切分的網格為
正方形網格，因此 x xΔ = Δ = Δ，是故我們能夠將(6.11)展開為 
 ( )2 2 2 2 21, 1, -1, -1, , 1 , 1 , -1 , -121 - 2 - 24 i j i j i j i j i j i j i j i jμ μ μ μ μ μ μ μ μ+ + + +∇ = + + +Δ  (5.65) 
我們可以得知壁能的離散形式為 
 
2 2
1, 1, -1, -1,
2 2 2
, 1 , 1 , -1 , -1
- 2
4 - 2
i j i j i j i jwa
i j i j i j i j i j
AE
μ μ μ μ
μ μ μ μ
+ +
+ +
⎛ ⎞+⎜ ⎟= ⎜ ⎟Δ + +⎝ ⎠
∑∑  (5.66) 
II. 異向性能 
異向性能的形式為 
 ( )22 1-anE dκμ μ
Ω
= ∫ x  (5.67) 
因此我們可以直接離散化，故我們可以得知異向性能的離散形式為 
 ( )22, ,1-an i j i j
i j
E κ μ μ= ∑∑  (5.68) 
III. 彈性力學能 
彈性力學能的形式為 
 ( ) ( ) ( ) ( )1 1- - = - -2 2elasE C d d∗ ∗ ∗ ∗Ω Ω= ⋅ ⋅∫ ∫ε ε ε ε x ε ε σ σ x  (5.69) 
 85
5-3 平行架構 
平行架構最主要可以分為兩個部份，其一為『資料傳輸』(communication)，
另一部份則為『平行化的計算』，因此我們將從這兩個部份來說明我們的平行架
構。 
I. 資料傳輸 
在整個計算過程內，假設我們有 N 個計算節點，因此我們將整個問題『等
分』切分為 N 個計算區塊。而整個計算中需要資料傳輸的部份主要有二項。 
 
圖 5-5 n 等分示意圖 
其一為疊代過程中需要取出我們每個網格第 n 與第 n+1 步計算出的差
值 μΔ 中的最大值 maxμΔ ，因此我們先個別找出每個計算節點上的最大
,maxNμΔ 差值，接著使用 MPI_Allgather 點對點資料傳輸進行最大值 maxμΔ
的判讀，並且將 maxμΔ 傳輸給所有的計算節點使得每個計算節點對於收斂
條件的判讀一致。 
 87
 
圖 5-7 MPI_Send、MPI_Recv 資料傳輸示意圖 
II. 平行計算 
在我們的計算中，實際上所需要計算的演化方程式以及壁能量、異向性能
量與彈性力學能量。 
A. 演化方程式 
在式子中要求得 1nμ +% ，我們必須有 nμ% 以及 nf% 的資訊，而 nf% 為我們所
必須計算得出。得知 nf% 是由內變數 iμ 以及應力 ijσ 組成，其中 nf% 與內
變數 iμ 為資料平行(Data Parallel)的演算法，因此我們只需要依照我們
所切分的區域分配給所屬的計算節點進行計算即可。而應力 ijσ 則是經
過快速傅立葉轉換後於傅立葉空間進行運算後再以傅立葉逆轉換後求
得。而關於平行化快速傅立葉轉換的資料配置請參閱附錄 A。  
B. 壁能量 
在式子中我們得知要計算第 i， j 個點的能量，則我必須獲得此點周圍
四點的μ 值資訊，因此我們便利用圖 5-7 的資料傳輸方法進行資料傳
輸。如圖中所示，我們的平行方法是在 x 方向進行等分，而有限差分
在計算第 i， j 個點的能量時需要 1i + 、 1i − 個點的資訊，因此在每個
計算節點的邊界上，我們預先設置一個存放資料的空間(虛線部份)，
並且同時將邊界上的資訊(灰底部份)傳輸給周圍的計算節點使用，如
Process n Process n+1 Process n-1  Process N 
 89
第６章 平行化架構下之模擬結果---以麻田散鐵為例 
接下來將針對平行架構與單機版之麻田散鐵微結構演化，進行模擬分析，有
無外加應變、有外加應變兩種情況，最後在分析平行化與單機版之優劣分析。 
6-1 單機版與平行版兩種兄弟晶、平均應變為零之模擬 
在我們的研究中，麻田散鐵微結構於立方晶轉換到四方晶結構的相變，首先
考慮到 ( ) 0ε =x 也就是平均應變為零，而 1( ) ( )f f d
Ω
= Ω ∫x x x，Ω 為體積。 
結果表示： 
 
(1)
(2)
       
(1 )
ε μ
ε μ
⎧ =⎨ = −⎩  (6.1) 
(1)ε 代表的為 x 軸向應變之兄弟晶， (2)ε 代表的為 y 軸向應變之兄弟晶。 
 
數值設定： 
網格切割數 N=512 
時間步長 0.1tΔ =  
收斂條件 35 10ε −= ∗  
計算節點數量[ ]2,4,8  
材料參數： 
3
5
3
11
2
10
0.0002( )
10 ( )
2.2 1.0 0
1.0 2.2 0 *10 ( )
0 0 0.6
JD m
J
m
NC m
α
κ
−=
=
=
⎡ ⎤⎢ ⎥= ⎢ ⎥⎢ ⎥⎣ ⎦
 
 
 91
圖 6-2 初始條件 A 
 
圖 6-3 微結構模擬結果。左為單機版、右為平行版之計算結果 
 
圖 6-4 初始條件 B 
 93
6-2 單機版與平行版兩種兄弟晶、平均應變不為零之模擬 
從演化方程式中我們可以看出 
 11 22t
μ σ σ∂ ≈ −∂  (6.5) 
而在平衡狀態下，我們逐漸給予一平均應變 
[ ]
0 0
0
0.1 ,0.2 1
m
a
a
ε
α α α
⎡ ⎤= ⎢ ⎥⎣ ⎦
= L
 
則會使得 (1) 0ε μ= → 、 (2) (1 ) 1ε μ= − → ，而整個微結構則會逐漸改變成為
(2)ε ，最後將只有 y 向的應變。接下來我們將加上平均應變過程中的微結構一一
展示。 
 
圖 6-6 加平均應變 22 0.2ε α= 之微結構圖。左為單機版、右為平行版 
 95
我們可以發現在加上一平均應變 22ε 之後確實使得 (1) 0ε μ= → 、
(2) (1 ) 1ε μ= − → 到了最後整個微結構只剩下單純的 (2)ε 兄弟晶。而這是因為整
個微結構必須符合 ( ) mε ε=x ，因此當我們施加至 22 1.0ε α= 之後，整個微結
構便成為了單純的 (2)ε 兄弟晶結構了。 
 
 
接下來同樣的我們將給予的平均應變改為 
[ ]
0
0 0
0.1 ,0.2 1
m a
a
ε
α α α
⎡ ⎤= ⎢ ⎥⎣ ⎦
= L
 
這將會使得 (1) 1ε μ= → 、 (2) (1 ) 0ε μ= − → ，而整個微結構則會逐漸改變成為
(1)ε ，最後將會只有 x 向的應變。而我們同樣的將加上平均應變過程中的微結構
一一展示。 
 
 
 
 
 
 
 
 
 
 
 97
 
圖 6-11 加平均應變 11 1.0ε α= 之微結構圖。左為單機版、右為平行版 
同樣的我們可以也發現在加上一平均應變 11ε 之後確實使得 (1) 1ε μ= → 、
(2) (1 ) 0ε μ= − → 到了最後整個微結構只剩下單純的 (1)ε 兄弟晶。而這是因為整
個微結構必須符合 ( ) mε ε=x ，因此當我們施加至 11 1.0ε α= 之後，整個微結
構便成為了單純的 (1)ε 兄弟晶結構了。 
 99
其中ψ 為計算效率，σ 為程式不可平行運算之部份，ϕ為程式可平行運算之部
份，κ為資料傳輸所需要的時間， ,n p 則為整個網格數目以及計算節點的數量。 
因此我們可以得知當n增加時我們的σ 需要的時間為 ( )2nΘ 、ϕ所需的時
間為 ( )logn n pΘ 、κ 所需的時間為 ( )( )logn p pΘ ，因此當我們的 p 固
定住，我們可以發現可平行化的部份所需的時間成長速度大幅度領先於傳輸所需
時間。因此當未來需要做到更大的網格切分數、多個兄弟晶之變化或者當問題要
擴展到三維問題的時候，我們整個效率將會有更好的表現。 
 101
第８章 自評與建議 
本計畫因為數值模擬研究，故無專利申請，而所完成的結果為： 
 
1. 開發出一套新的磁力互動模型及其演算法，可精確計算磁致伸縮應變能，並
成功地模擬微磁域之演化。 
2. 成功地引入快速演算法（FFT）計算非周期性邊界條件之磁致伸縮應變能 (文
獻上指出應用快速演算法（FFT）計算在周期性邊界條件之磁致伸縮應變能
已於 2005 年為其他研究團隊發表) 。因此預計本研究成果將成為該領域首次
將快速演算法應用於有界物體磁致伸縮應變能之計算上，現正在整理研究成
果，並撰寫中。 
3. 學習暨應用平行演算法於材料微結構之數值模擬上。初步上以麻田散鐵(非磁
性材料)為例，將其微結構演算改寫成為平行化架構，藉此提昇其效率與網格
切分數，並且得到了高效率。之後將此為基礎則，再行應用於磁致伸縮材料
微磁域之模擬上。 
 
綜合前面各節所討論之內容，建議未來可朝下列各點持續努力： 
1. 平行演算法的改進 
在目前的平行演算法中，我們是使用多個計算節點並行計算的方式，然而此方
法卻不能保證每個計算節點都以 100%的工作效率進行計算，因此我們能夠改以
Manager/Worker 形式的平行演算法讓 Manager 動態的分配工作給予閒置的 Worker
進行計算，以確保每個計算節點都以 100%的效率進行計算。 
 103
4. 三維方向的研究 
在本研究團隊中，我們目前所做的研究都拘限於薄膜或二維問題上，但是三微
方向的研究卻也是我們重視並且想從事的研究，在之前我們因受限於其計算量大幅
度的上升而無法進行相關的研究，但如今我們成功的架構出二維麻田散鐵材料的平
行演算法並且獲得了高效率。因此我們能夠以此為基本架構，並將其延伸至三維問
題上。 
 
 105
Phase – field simulation. Acta Mater.,53：2495-2507. 
[13] J. X. Zhang and L. Q. Chen.(2005). Phase – Field Model for ferromagnetics 
Shape Memory Alloys. Phil. Mag. Letters.,85：533-541. 
[14] Jeong, T. G. & Bogy, D. B.(1995). Demagnetization Due to Inverse 
Magnetostriction Effect in Longitudinal Thin Film Media, IEEE Transaction on 
Magnetics.,31：1007-1012. 
[15] K. Bhattacharya and R. V. Kohn.(1996). Symmetry, Texture and the 
Recoverable Strain of Shape Memory Polycrystals. Acta Matter.,44：529-542. 
[16] K. Bhattacharya and R. V. Kohn.(1997). Elastic Energy Minimization and the 
Recoverable Strains of Polycrystalline Shape Memory Materials. Arch. Rat. 
Mech. Anal.,139：99-180. 
[17] K. Bhattacharya., A. DeSimone, K. F. Hane, R. D. James, and C. J. 
Palmstrm.(1999). Tents and Tunnels on Martensitic Films. Materials Science and 
Engineering A., 273：685-689. 
[18] K. Bhattacharya and R. D. James.(1999). A Theory of Thin Films of Martensitic 
Materials with Applications to Microactuators. J. Mech. Phys. Solids.,47：
531-576. 
[19] Landau, L. D. & Lifshitz, E.(1935). On the Theory of the Dispersion of 
Magnetic Permeability in Ferromagnetic Bodies, Physikalische Zeitschrift der 
Sowjetunion.,8：153-169. 
[20] Izawa, F.(1984). Theoretical Study on Stress-Induced Demagnetization in 
Magnetic Recodeing Media, IEEE Transaction on Magnetics., Mag-20：523-528. 
[21] Matteo Frigo, Steven G. Johnson.(2003).FFTW User’s Manual 2.1.5. 
[22] M. Wechsler, D. Libermann, and T. Read.(1953). On the Theory of the 
formation of Martensite. Trans. AIME.,197：1503-1515. 
[23] Michael J. Quinn.(2003). PARALLEL PROGRAMMING in C with MPI and 
 107
Anisotropy Elasticity, Journal of Applied Mechanics.67：618-621. 
[34] Y. C. Shu and K. Bhattacharya.(1998). The Influence of Texture on the 
Shape-Memory Effect in the Polycrystals. Acta Mater.,46：5457-5473. 
[35] Y. C. Shu.(2000). Heterogeneous Thin Films of Martensitic Materials. Arch. 
Rational Mech. Anal.,153：30-39. 
[36] Y. C. Shu.(2002). Shape-Memory Micropumps. Materials Transactions.,43：
1037-1044. 
[37] Y. C. Shu., Lin, M. P. & Wu. K. C.(2004). Micromagnetic Modeling of 
Magnetostrictive Materials under Intrinsic Stress. Mechanics of Materials. 
[38] Y. Wang and A. G. Khachaturyan.(1997). Three-Dimensional Field Model and 
Computer Modeling of Martensitic Transformations, Acta Mater.,45：759-773. 
[39] Y. M. Jin, A. Aretmev and A. G. Khachaturyan.(2001). Three Dimensional 
Phase Field Model of low Symmetry Martensitic Transformation in 
Polycrystal：Simulations of 2ξ′  Martensite in AuCd Alloys. Acta Mater.,49：
2309-2320. 
[40] Y. M. Jin, A. Aretmev and A. G. Khachaturyan.(2002). Three Dimensional 
Phase Field Model and Simulation if Cubic→tetragonal Martensitic 
transformation in polycrystal. Phil. Mag. A.,82：1249-1270. 
[41] Y. M. Jin and A. G. Khachaturyan.(2002). Phase field microelasticalty theory of 
dislocation dynamics in a polycrystal：model and three – dimensional simulations. 
Phil. Mag. Letters.,81：607-616. 
[42] 徐建輝.(2007).新式相場模擬法應用於麻田散鐵微結構之研究.台灣大學應
用力學研究所碩士論文. 
[43] 顏睿亨.(2003).磁性薄膜磁力互動模型分析與數值模擬之研究.台灣大學應
用力學研究所碩士論文. 
 109
附錄 A FFTW & FFTW_MPI 之使用 
  在計算中使用的二維快速傅立葉轉換是使用 FFTW2.15 版本，其內容分為單
機版的正轉換、逆轉換，以及平行版的正轉換、逆轉換，而所使用的語法如下： 
I. 單機版正逆轉換 
#include <fftw.h> 
{ 
 fftw_complex in[N*M], out[N*M]; 
 fftwnd_plan p; 
 …. 
 p = fftw2d_create_plan(int nx, int ny, fftw_direction dir, int flags); 
 …. 
 fftwnd_one(p, &in, &out); 
 …. 
 fftwnd_destroy_plan(p); 
} 
以上為一個單機版 2 維傅立葉轉換的 code，其中 in、out 是大小為 N*M
的複數矩陣，用以存放轉換前後的資料。而 p 則是決定我們轉換的方法以
及方向，fftw_direction 為正/逆(FFTW_FORWARD/FFTW_BACKWARD)
轉 換 ， flags 可 以 決 定 是 否 在 執 行 以 前 先 尋 找 最 佳 轉 換 方 法
(FFTW_MEASURE/FFTW_ESTIMATE)，如果尋找最佳轉換方法，則會在
創建 fftw_plan 的時候花費較多的時間，比較適合之後有多次轉換的情況。 
 
 
 
 
 111
度。如果是一維度轉換，此維度數量必須是總運算器數量平方的整
數倍。 
II. 請使用 FFTW_TRANSPOSED_ORDER 為轉換的變數，這將使用
MPI 內建的函式 MPI_Alltoall 而去取得一個更加的效率。 
III. 在大多數的情況下，使用 workspace(out-place)進行轉換將會有更佳
的效率。 
IV. 請對運算的 cluster 進行實驗，以找出最佳的轉換分配。可以使用
內建的 fftw_mpi_test 來幫助你進行轉換實驗。 
 113
圖 A-2 矩陣 Transposed order 示意圖 
而在 Transposed Mode 的時候我們會將整個計算節點所對應的資料做一次
Transpose，因此我們的計算節點矩陣結構會變成以上的樣子，而此時我們計算節
點上面的矩陣編號變為 i*Ny+j，而對應到整個大矩陣的編號則會變成
j*Nx+i+(id-1)* xNΔ ，也就是整個反過來，而從這邊我們便可以清楚的知道正確
的矩陣對應配置了。 
 115
0 0
90 90
180 180
270 270
1 12 2 22
1 11 2 12
1 12 2 22
1 11 2 12
  
      
          
     
t t
t t
t t
t t
σ σ
σ σ
σ σ
σ σ
= − = −⎧ ⎧⎪ ⎪= =⎪ ⎪⎪ ⎪⎨ ⎨= =⎪ ⎪⎪ ⎪= − = −⎪ ⎪⎩ ⎩
o o
o o
o o
o o
 
因此我們將應力項次展開寫成 
 
0 0
0 0
0 0
0 0
011 1212 1
0
1 1 122 21 22 2( , ) ( , )( , )
011 12
1
0
21 22 2 ( , )( , )
0
T
B N N
q r si j r s qi r j s
fq
T
r si r j s
f
W W t
W W t
W W t
W W t
σ
σ
∗
= = = − −
∗
− −
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞− ⎡ ⎤⎡ ⎤ ⎜ ⎟⎢⎢ ⎥ ⎜ ⎟= ⎢ ⎥⎢ ⎥ ⎜ ⎟⎢ ⎜ ⎟− ⎢ ⎥⎣ ⎦ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞⎡ ⎤⎜ ⎟⎢⎢ ⎥ ⎜= ⎢ ⎥⎜ ⎟⎢ ⎜⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
∑∑∑ o o
o o
o o
o o
o
%
%
0 0
0 0
0 0
0 0
1 1
0
011 12
1
0
1 1 21 22 2 ( , ) 90( , )
90
011 12
1
0
21 22 2 ( , ) 180( , )
180
N N
r s
T
N N
r s r si r j s
f
T
r si r j s
f
W W t
W W t
W W t
W W t
= =
∗
= = − −
∗
− −
⎟⎟
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞⎡ ⎤⎜ ⎟⎢⎢ ⎥ ⎜ ⎟+ ⎢ ⎥⎜ ⎟⎢ ⎜ ⎟⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞⎡ ⎤⎜ ⎟⎢⎢ ⎥ ⎜ ⎟+ ⎢ ⎥⎜ ⎟⎢ ⎜ ⎟⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
∑∑
∑∑
o
o o
o o o
o
o o
o o o
o
0 0
0 0
1 1
011 12
1
0
1 1 21 22 2 ( , ) 270( , )
270
N N
r s
T
N N
r s r si r j s
f
W W t
W W t
= =
∗
= = − −
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞⎡ ⎤⎜ ⎟⎢⎢ ⎥ ⎜ ⎟+ ⎢ ⎥⎜ ⎟⎢ ⎜ ⎟⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
∑∑
∑∑ o o
o o o
o
 
0 0
0 0
011 12
12
0
1 1 21 22 22 ( , )( , )
0
T
N N
r s r si r j s
f
W W
W W
σ
σ
∗
= = − −
⎛ ⎞⎡⎡ ⎤ ⎛ ⎞⎡ ⎤−⎜ ⎟⎢⎢ ⎥ ⎜ ⎟= ⎢ ⎥⎜ ⎟⎢ ⎜ ⎟−⎢ ⎥ ⎣ ⎦⎜ ⎟ ⎝ ⎠⎣ ⎦⎢⎣⎝ ⎠
∑∑ o o
o o
o
 
 117
( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
( )
0 0
0 0
0
0 0
22 21 12 22 22( , ) ( , ) ( , )( , ) ( , )1 1 0 0
0 0
21 11 22 12( , ) ( , )( , ) ( , )1 1 90 90
21 12
( , ) 180
N N
i j r s r si r j s i r j sr s f f
N N
r s r si r j s i r j sr s f f
i r j s f
W W
W W
W
σ σ σ
σ σ
σ
− − − −= =
− − − −= =
− −
⎧ ⎫⎪⎡ ⎡ ⎪− = − + −⎨ ⎬⎢ ⎢⎣ ⎣⎪ ⎪⎩ ⎭
⎧ ⎫⎪⎡ ⎡ ⎪+ +⎨ ⎬⎢ ⎢⎣ ⎣⎪ ⎪⎩ ⎭
⎡+ ⎢⎣
∑∑
∑∑
o o
o o
o o
o o
o
o
%
( ) ( ) ( )
( ) ( ) ( ) ( )
0
0 0
0 0
22 22( , ) ( , )( , )1 1 180
0 0
21 11 22 12( , ) ( , )( , ) ( , )1 1 270 270
N N
r s r si r j sr s f
N N
r s r si r j s i r j sr s f f
W
W W
σ
σ σ
− −= =
− − − −= =
⎧ ⎫⎪ ⎡ ⎪+⎨ ⎬⎢⎣⎪ ⎪⎩ ⎭
⎧ ⎫⎪⎡ ⎡ ⎪+ − + −⎨ ⎬⎢ ⎢⎣ ⎣⎪ ⎪⎩ ⎭
∑∑
∑∑
o
o
o o
o o
 
而另一方向之應力也可以由同樣的方法展開，則這些就和附錄 D 的有限域
褶積問題形式相等，因此我們便能以 Padding 的方法以快速傅立葉轉換處理有限
域褶積問題，就能夠得到每一個徹體力區域所造成的完整應力資訊。 
 119
( )
( )
( ) ( )
( ) ( )
( )
( )
( ) ( )
( ) ( )
1 12
1 1 1
1
21 1 1
1 12
2 2 2
1
22 2 2
ln ,
1
ln
ff s
s f s
fs
ff s
s f s
diag
i
ζ ζ ζ
ζ ζ ζ
π ζ ζ ζ
ζ ζ ζ
+ +
+
∗
+ +
+
⎡ ⎤⎛ ⎞−⎢ ⎥⎜ ⎟⎢ ⎥⎜ ⎟−⎝ ⎠⎢ ⎥= − ⎢ ⎥⎛ ⎞−⎢ ⎥⎜ ⎟⎢ ⎥⎜ ⎟−⎝ ⎠⎣ ⎦
G
)
)
)
)
 
為敘述場點與源點相對位置關係的函數， 
因此我們的 fs∗G 會有對應問題整體邊界以及對應每個源點邊界的兩種形式。 
 
圖 C-2 整體之邊界與場點示意圖，灰底為場點元素，箭頭為源點邊界元素。 
 
 
圖 C-3 源點之邊界與場點示意圖，灰底為場點元素，箭頭為源點邊界元素。 
 
0
1t o  
0
2t o
90
1t o  
90
2t o  
0
1t o  
0
2t o
90
1t o  
90
2t o  
 121
 
圖 C-5 源點邊界元素與場點示意圖，灰底為場點。 
因此當我們的 fs∗G 為敘述一個源點與所要計算之場點的位置關係函數時，我們能
夠這樣展開 fs∗G 。→方向為0o ，↑方向為90o，←方向為180o，↓方向為 270o 。 
( )
( ) ( )
( ) ( )
( ) ( )
( ) ( )
1 0 1 0 1 1 1
1 0 1 0 4 1 4
0
2 0 2 0 1 2 1
2 0 2 0 4 2 4
cos sin
ln ,
cos 0 sin 01
cos sin
ln
cos 0 sin 0
f f
fs
f f
p x p y x p y
p x p y x p y
diag
i p x p y x p y
p x p y x p y
θ θ
π θ θ
∗
⎡ ⎤⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟+ + − +⎢ ⎥⎝ ⎠= − ⎢ ⎥⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥+ + − +⎝ ⎠⎣ ⎦
G o
o o
o o
 
( )
( ) ( )
( ) ( )
( ) ( )
( ) ( )
1 0 1 0 2 1 2
1 0 1 0 1 1 1
90
2 0 2 0 2 2 2
2 0 2 0 1 2 1
cos sin
ln ,
cos90 sin 901
cos sin
ln
cos90 sin 90
f f
fs
f f
p x p y x p y
p x p y x p y
diag
i p x p y x p y
p x p y x p y
θ θ
π θ θ
∗
⎡ ⎤⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟+ + − +⎢ ⎥⎝ ⎠= − ⎢ ⎥⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥+ + − +⎝ ⎠⎣ ⎦
G o
o o
o o
 
( )
( ) ( )
( ) ( )
( ) ( )
( ) ( )
1 0 1 0 3 1 3
1 0 1 0 2 1 2
180
2 0 2 0 3 2 3
2 0 2 0 2 2 2
cos sin
ln ,
cos180 sin1801
cos sin
ln
cos180 sin180
f f
fs
f f
p x p y x p y
p x p y x p y
diag
i p x p y x p y
p x p y x p y
θ θ
π θ θ
∗
⎡ ⎤⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟+ + − +⎢ ⎥⎝ ⎠= − ⎢ ⎥⎛ ⎞+ + − +⎢ ⎥⎜ ⎟⎜ ⎟⎢ ⎥+ + − +⎝ ⎠⎣ ⎦
G o
o o
o o
 
0
1t o  
0
2t o
90
1t o  
90
2t o  
0 0( , )x y  
1 1( , )x y
2 2( , )x y3 3( , )x y  
4 4( , )x y  
 123
附錄 D 快速傅立葉轉換應用於有限域與無限域褶積問題 
『無限域週期展開之褶積函數』 
假設 ( , )g x y 為一在 x及 y 方向都為週期 T 的週期性函數，而我們所要計算的
褶積問題為 
- -
- -
( , ) ( - , - ) ( , )
( , ) ( - , - )
( , ) ( , )
h x y f x y g d d
f g x y d d
f x y g x y
ξ η ξ η ξ η
ξ η ξ η ξ η
∞ ∞
∞ ∞
∞ ∞
∞ ∞
=
=
= ∗
∫ ∫
∫ ∫  
因為 ( , )g x y 為週期性函數，因此我們能夠展開為傅立葉級數 
( ) ( )2 - 2 -
- -
( - , - )
k x n y
i i
T T
kn
k n
g x y C e e
π ξ π η
ξ η ∞ ∞
= ∞ = ∞
= ∑ ∑  
於是我們能夠將問題改寫成 
2 2 2 2- -
- -
- -
( , ) ( , )
kx ny k ni i i i
T T T T
kn
k n
h x y C e e f e e d d
π π π ξ π η
ξ η ξ η∞ ∞ ∞ ∞∞ ∞= ∞ = ∞= ∑ ∑ ∫ ∫  
接著我們定義 
2 2- -
- -
( , )
k ni i
T T
knD f e e d d
π ξ π η
ξ η ξ η∞ ∞∞ ∞≡ ∫ ∫  
於式整個問題便能改寫成 
2 2
- -
2 2
- -
( , )
kx nyi i
T T
kn kn
k n
kx nyi i
T T
kn
k n
h x y C D e e
H e e
π π
π π
∞ ∞
= ∞ = ∞
∞ ∞
= ∞ = ∞
=
=
∑ ∑
∑ ∑
 
其中 
kn kn knH C D=  
接著我們將[ ]0,T 的範圍切分成 N 等分，並且取每個網格的中點為我們計算的點 
 125
驗證結果 
我們將以以下範例來驗證平行版快速傅立葉轉換使用之正確性，假設我們現
在有兩函數分別為 
2 2
1( , )      
( , ) ( ) ( )
f x y
x y
g x y Sin x Cos y
⎧ =⎪ +⎨⎪ =⎩
 
我們直接將此褶積計算後可得 
( , )
( , ) ( , )
2 ( ) ( )
h x y f g
f x y g d d
Sin x Cos y
ξ η ξ η ξ η
π
∞ ∞
−∞ −∞
= ∗
= − −
=
∫ ∫  
knC 可由 ( , )g x y 之離散點帶入 FFTW 得到，而 knD 則是經由 ( , )f x y 代入上一
小節計算得出 
2 2- -
2 2- -
2 2
1
2
k ni i
T T
knD e e d d
k n
π ξ π η
ξ ηξ η
π
∞ ∞
∞ ∞= +
= +
∫ ∫
 
而 k、n 是傅立葉空間的變數，在快速傅立葉轉換中所使用的座標排列方式為下
圖所示 
 
k=1 k=2    ….    k=Nx/2  ..… k=-2  k=-1 
n=0     
n=1 
 
. 
. 
. 
n=Ny/2 
 
. 
. 
. 
 127
0
2
4
6
8
0
2
4
6
8
−1.5
−1
−0.5
0
0.5
1
1.5
FFTW−iFFTW parallel solution
 
圖 D-3 快速傅立葉解曲面圖 
從整個曲面上來看，用平行化快速傅立葉轉換所得到的解與解析解是非常相
似的。而我們更進一步在
3, ,
2 2
x π ππ= 的地方比較每一個點的數值。 
 
 
 
 129
0 1 2 3 4 5 6 7
−0.08
−0.06
−0.04
−0.02
0
0.02
0.04
0.06
0.08
Exact solution
FFTW−iFFTW parallel solution
 
圖 D-6 
3
2
x π= 處之比較圖 
 
 131
2 1 2 1
0 0
( , ) ( - , - ) ( , )
N N
i j i r j s r s
r s
h x y g x y fξ η ξ η− −
= =
= ∑ ∑% %%  
於是我們同樣的也獲得一個新的函數 [ ] [ ]( , ) 0, 2 0, 2h x y T T∈ ×% ，接著我們比較
( , )h x y% 與 ( , )h x y 在[ ] [ ]0, 0,T T× 的性質。 
[ ] [ ]
2 1 2 1
0 0
1 1
0 0
1 1
0 0
( , ) ( - , - ) ( , )
( - , - ) ( , )      0, 0,
( - , - ) ( , )
( , )
N N
i j i r j s r s
r s
N N
i r j s r s
r s
N N
i r j s r s
r s
i j
h x y g x y f
g x y f T T
g x y f
h x y
ξ η ξ η
ξ η ξ η
ξ η ξ η
− −
= =
− −
= =
− −
= =
=
⇒ ∈ ×
=
=
∑ ∑
∑∑
∑∑
% %%
%%
 
在這邊我們利用了圖一所示意的性質，因為 ( , )f ξ η% 在不屬於 [ ] [ ]0, 0,T T× 的區
域均為 0，因此我們可以將此離散形式改成
2 1 2 1 1 1
0 0 0 0
N N N N
r s r s
− − − −
= = = =
⇒∑ ∑ ∑∑ ，而在此區域內
( , ) ( , )f fξ η ξ η= % ， ( , ) ( , )g gξ η ξ η= % ，是故我們在 [ ] [ ]0, 0,T T× 的區域內時
( , ) ( , )i j i jh x y h x y=% 。因此在整個數值計算上我們便可以利用此方法來計算我們
的有限域褶積問題。 
 133
來計算有限域褶積積分，藉此驗證以快速傅立葉轉換計算有限域褶積積分的正確
性。 
0
0.2
0.4
0.6
0.8
1
0
0.5
1
−3
−2
−1
0
1
2
3
Numerical integral solution
 
圖 D-8 Matlab 數值積分之曲面圖 
 135
0 10 20 30 40 50 60 70
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
x = 1/4
Numerical integral solution
FFT solution
 
圖 D-10 
1
4
x = 處之比較圖 
0 10 20 30 40 50 60 70
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
x = 1/2
Numerical integral solution
FFT solution
 
圖 D-11 
1
2
x = 處之比較圖 
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 95-2221-E-002-231 
計畫名稱 磁致伸縮材料微磁學數值模擬之研究(2/2) 
出國人員姓名 
服務機關及職稱 
舒貽忠副教授  /  台大應用力學研究所 
會議時間地點 95 年 11 月 5 日起至 95 年 11 月 10 日止 /  CHICAGO, USA 
會議名稱 2006 美國機械工程師學會國際學術大會 
發表論文題目 Steady State Response of a Piezoelectric Power Harvesting System 
 
一、參加會議經過 
此學術會議為美國機械工程師學會(ASME) 2006 年度大會，內容包羅萬象，其中與本人
專長相關的為固體力學 (Solid Mechanics) 與能量擷取 (power harvesting) 。該學術會議
整合跨領域之學者，共同探討固體力學與微型壓電發電模組的最新發展與整合契機。因
此在起程前，特別反覆練會議中的講稿，以利會議進行。 
 
二、與會心得 
近年來由於再生能源議題不斷受到重視與多點分佈無線監測網路的迅速發展，如何有效
的供給這些數目龐大自主性微感測器所需要之能源，是首要面對的棘手問題。隨著無線
通訊技術的成熟和低功率消耗電路的迅速發展，將環境中潛在能源轉化為電能已是自我
供電系統中不可或缺的一環。 其中利用智慧型材料作為能量轉換機制的能量擷取器，
並供給足夠的用電量的概念不再是遙不可及。然而預達到此一目標的前提是這些能量擷
取器必須在最佳化設計下運作，這正是本人發表之會議論文所探討之研究課題。除此之
外，亦參與不少與磁性材料相關之講習會(session) ，並與多位學者共同探討新一代鐵磁
形狀記憶合金的最新趨勢，實受益良多。 
 
 
Piezoelectric Vibrator
Ce VcR
+
_
Figure 1. A typical AC-DC harvesting circuit.
Analytic Analysis
A piezoelectric energy harvester is modeled as a
mass+spring+damper+piezo structure together with a sim-
plified energy harvesting system schematically shown in Figure
1 [7, 10, 11]. It consists of a piezoelectric element coupled to
a mechanical structure and is connected to a storage circuit
system. In this approach, an effective mass M subjected to an
applied forcing function Ft is bounded on a spring of effective
stiffness K, on a damper of coefficient η, and on a piezoelectric
element characterized by effective piezoelectric coefficient Θ
and capacitance Cp.
Let u be the displacement of the mass M and Vp the voltage
across the piezoelectric element. The governing equations of the
piezoelectric vibrator can be described by [7, 11, 17]
Mu¨tηu˙tKutΘVpt  Ft (1)
Θu˙tCp ˙Vpt It (2)
where It is the current flowing into the circuit and
Ft  F0 sinwt (3)
with F0 the constant magnitude and w (in radians per second) the
angular frequency of vibration.
The common approach to have the stable output DC voltage
is to assume that the filter capacitor Ce is large enough so that
the rectified voltage Vc is essentially constant [10]. Specifically,
Vct  VctVripple where Vct and Vripple are the average
and ripple of Vct, respectively. This average Vct is inde-
pendent of Ce provided that the time constant RCe is much larger
than the oscillating period of the generator [3]. The magnitude
of Vripple, however, depends on Ce and is negligible for large Ce.
Under this hypothesis, Vct  Vct, and therefore in the fol-
lowing, we use Vc, instead of Vct, to represent the average of
Vct for notation simplicity.
The rectifying bridge shown in Figure 1 is assumed to be
perfect here. Thus, it is open circuited if the piezo voltage V p
is smaller than the rectified voltage Vc. As a result, the current
flowing into the circuit vanishes, and this implies ˙Vpt varies
proportionally with respect to u˙t as seen from (2). On the other
hand, when Vp reaches Vc, the bridge conducts and the piezo
voltage is kept equal to the rectified voltage; i.e., Vp  Vc. Fi-
nally, the conduction in the rectifier diodes is blocked again when
t
t
t i
t f
V (t)p
Vc
-Vc
u(t)
u0
-u0
T
2
t i
t f
Figure 2. Typical waveforms of displacement ut and piezo voltage
Vpt of the power harvesting circuit.
the absolute value of the piezo voltage Vpt starts decreasing.
Typical waveforms of ut and Vpt satisfying these properties
are schematically shown in Figure 2.
To solve (1)-(2) connected to an AC-DC circuit shown in
Figure 1, we first determine the relation between the average
value of the rectified voltage and displacement magnitude. From
Figure 2, the steady-state solution of ut is assumed to take the
following form
ut  u0 sinwtθ (4)
with u0 the constant magnitude. Let T  2πw be the period of
vibration, and ti and t f be two time instants (t f  ti  T2 ) such
that the displacement u undergoes from the minimumu 0 to the
maximum u0 as illustrated in Figure 2. Assumed that ˙Vp  0
during the semi-period from t i to t f . It follows that
 t f
ti
˙Vptdt 
VcVc 2Vc. Note that Ce ˙Vct VcR  0 for ti  t  t
 during
which the piezo voltage Vp  Vc and It  Ce ˙Vct  VcR for
t  t  t f during which the rectifier conducts. The integration
of (2) from time ti to t f therefore gives
Vc 
wΘR
wCpR π2
u0 (5)
since the average current flowing through the capacitance Ce is
zero; i.e.,
 t f
ti Ce ˙Vctdt  0 at the steady-state operation [3, 10].
2 Copyright c 2006 by ASME
Short Circuit Resonance
Uncoupled Solution
In-Phase Solution
Analytic Solution
0 1 2 3 4 5 6 7 8 9 10
Normalized Resistance
2.5
2.25
2
1.75
1.5
1.25
1
0.75
0.5
0.25
0
N
o
rm
a
li
z
e
d
V
o
lt
a
g
e
0 1 2 3 4 5 6 7 8 9 10
Normalized Resistance
Uncoupled Solution
In-Phase Solution
Analytic Solution
N
o
rm
a
li
z
e
d
V
o
lt
a
g
e
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Open Circuit Resonance
(a) (c)
Short Circuit Resonance
Uncoupled Solution
In-Phase Solution
Analytic Solution
0 1 2 3 4 5 6 7 8 9 10
Normalized Resistance
8
7
6
5
4
3
2
1
0
N
o
rm
a
li
z
e
d
P
o
w
e
r
Open Circuit Resonance
Uncoupled Solution
In-Phase Solution
Analytic Solution
0 1 2 3 4 5 6 7 8 9 10
Normalized Resistance
2.5
2.25
2
1.75
1.5
1.25
1
0.75
0.5
0.25
0
N
o
rm
a
li
z
e
d
P
o
w
e
r
(b) (d)
Figure 4. Model comparisons for medium k
2
eζ . We use ke  04 and ζ  003

k2eζ  533

. (a) and (b) are the normalized voltage and power versus
normalized resistance operated at Ωsc while (c) and (d) are those operated at Ωoc.
in terms of non-dimensionless parameters can be shown to be
V unc 

rΩ
rΩ π2

k2e

4ζ2Ω21Ω22
	
1
2
 (11)
Pun 
1


rΩ π2
2
k2eΩ2 r

4ζ2Ω21Ω22
	
 (12)
The uncoupled model assumes that the electromechanical
coupling is very weak or the vibration amplitude is independent
of the equivalent resistive load R. If the coupling is not so weak,
Guyomar et al [3] have provided a new approach to estimate the
average harvested power. Indeed, they have assumed that the ex-
ternal forcing function and the velocity of the mass are in-phase.
As a result, the normalized voltage V c and power P from the in-
phase analysis can be shown to be
V inc 

r
rΩ π2

k2e

2ζ 2k2e r
rΩ π2 2
	
 (13)
Pin 
1


rΩ π2
2
k2e r

2ζ 2k2e r
rΩ π2 2
	2  (14)
Small k
2
eζ
Suppose that k
2
eζ  1. Thus, the shift in frequency fromΩ sc
to Ωoc is not pronounced. Let the applied frequency ratio Ω be
operated between Ωsc and Ωoc. The power P derived from the
4 Copyright c 2006 by ASME
selecting the suitable operating point close to Ωsc since the har-
vested power has a peak around there. However, the in-phase
model fails to predicting the effect of the optimal selection of
operating frequency to generate the desired properties.
Conclusions
We study the optimal AC-DC power output for a vibrating
piezoelectric generator connected to an energy harvesting cir-
cuit. In contrast with estimates obtained by the uncoupled and
in-phase assumption [3, 10], we show that the power extraction
depends on the input vibration characteristics (frequency and ac-
celeration), the mass of the generator, the electric load, the natu-
ral frequency, the mechanical damping ratio, and the electrome-
chanical coupling coefficient of the system.
We compare our approach to others proposed based on the
uncoupled and in-phase assumptions. Figure 4 demonstrates that
the conventional uncoupled model is suitable provided that the
ratio k
2
eζ  1 while the discrepancies among these distinct ap-
proaches become significant when k
2
eζ increases. We also perform
a series of experiment to evaluate these models. We find our pro-
posed analytic model is in excellent agreement with experiment
as shown in Figure 5. The in-phase solutions, however, overes-
timate the measured voltage and power, and underestimate the
optimal load compared with experimental observations.
We particularly study the important case which has been ne-
glected by most current optimization schemes. If the shift in de-
vice natural frequency is pronounced and the quality factor of the
system is large, Figure 6 show that the harvested power has two
optimums evaluated at ropt1 Ω
opt
1  and r
opt
2 Ω
opt
2  where Ω
opt
1 is
close to Ωsc and the electric load ropt1 is very small while Ω
opt
2
is close to Ωoc and ropt2 is large. Several design guidelines in-
cluding enhancing the efficiency of charging a battery directly
are suggested according to these predictions.
Acknowledgments
We thank Profs. K. C. Wu and C. K. Lee for their con-
stant encouragement and support. We are glad to acknowledge
National Science Council for support under the grant No NSC
95-2221-E-002-231 and Ministry of Economic Affair for support
under grant No 94-EC-17-A-05-S1-017 (WHAM-BioS).
REFERENCES
[1] N. E. duToit, B. L. Wardle, and S. G. Kim. Design Consid-
erations for MEMS-Scale Piezoelectric Mechanical Vibra-
tion Energy Harvesters . Integrated Ferroelectrics, 71:121–
160, 2005.
[2] N. G. Elvin, A. A. Elvin, and M. Spector. A Self-Powered
Mechanical Strain Energy Sensor. Smart Materials and
Structures, 10:293–299, 2001.
[3] D. Guyomar, A. Badel, and E. Lefeuvre. Toward En-
ergy Harvesting Using Active Materials and Conversion
Improvement by Nonlinear Processing. IEEE Transac-
tion on Ultrasonics, Ferroelectrics, and Frequency Control,
52:584–595, 2005.
10−4
10−2
100
102
104
0.8
1
1.2
1.4
1.6
1.8
0
0.4
0.8
1.2
1.6
2
2.4
Normalized
Resistance
Normalized
Frequency
N
or
m
al
iz
ed
   
Po
we
r
(a)
10−4
10−2
100
102
104
0.8
1
1.2
1.4
1.6
1.8
0
0.4
0.8
1.2
1.6
2
2.4
Normalized
Resistance
Normalized
Frequency
N
or
m
al
iz
ed
   
Po
we
r
(b)
Figure 6. Model comparisons for large k
2
eζ . We use ke  114 and
ζ 003

k2eζ  433

. The normalized power is plotted against the nor-
malized electric resistance and frequency in (a) and (b) calculated based
on the analytic model and in-phase assumption.
[4] Y. B. Jeon, R. Sood, J. H. Jeong, and S. G. Kim. MEMS
Power Generator with Transverse Mode Thin Film PZT.
Sensors and Actuators A, 122:16–22, 2005.
[5] S. Kim, W. W. Clark, and Q. M. Wang. Piezoelectric En-
ergy Harvesting with a Clamped Circular Plate: Analy-
sis. Journal of Intelligent Material Systems and Structures,
16:847–854, 2005.
[6] S. Kim, W. W. Clark, and Q. M. Wang. Piezoelectric En-
ergy Harvesting with a Clamped Circular Plate: Experi-
mental Study. Journal of Intelligent Material Systems and
Structures, 16:855–863, 2005.
[7] E. Lefeuvre, A. Badel, C. Richard, and D. Guyomar. Piezo-
electric Energy Harvesting Device Optimization by Syn-
chronous Electric Charge Extraction. Journal of Intelligent
Material Systems and Structures, 16:865–876, 2005.
[8] G. A. Lesieutre and C. L. Davis. Can a Coupling Coeffi-
cient of a Piezoelectric Device be Higher than Those of its
Active Material? Journal of Intelligent Material Systems
and Structures, 8:859–867, 1997.
[9] T. H. Ng and W. H. Liao. Sensitivity Analysis and Energy
Harvesting for a Self-Powered Piezoelectric Sensor. Jour-
nal of Intelligent Material Systems and Structures, 16:785–
797, 2005.
[10] G. K. Ottman, H. F. Hofmann, A. C. Bhatt, and G. A.
6 Copyright c 2006 by ASME
