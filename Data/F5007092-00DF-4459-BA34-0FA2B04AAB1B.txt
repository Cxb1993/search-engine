 I
中文摘要 
 
在本計劃中，我們探討無線感測網路之分散式偵測／估計技術，並發展出相
關六個相關的節能與效能提升技術。在第一年的研究中，我們討論無線感測網路
分散式偵測之節能問題，並提出兩個節能針對分散式偵測之資料擷取與融合方
法：基於瞬間觀測品質之功率分配技術及結合截斷循序機率比率測試法之循序融
合技術；此二技術可以在維持相同偵測效能的條件下，大幅降低每個感測節點的
平均功率消耗量，進而延長感測網路之生命期。在第二年的研究中，我們討論無
線感測網路之多重訊號源分散式估計問題，並提出兩個多重訊號源分散式估計方
法：基於期望值-最大化演算法之多重訊號源分散式估計法及基於高斯信賴傳播
演算法之多重訊號源分散式估計法；此二技術可以克服不同訊號源所產生的相互
干擾，並且多重訊號源都可達到相當好的估計效能。在第三年的研究中，我們討
論將分散編碼的概念應用至無線感測網路之分散式估計問題，以改善分散式估計
效能並降低每一個節點的傳輸位元數目；我們提出兩個分散編碼之分散式估計方
法：基於重複編碼之合作式訊息聚集技術及基於低密度產生矩陣碼之合作式訊息
聚集技術。此二技術可以讓每一個節點的傳輸位元數目降低至一個位元，而仍然
保持相當好的估計效能。  
 
關鍵詞：無線感測網路、分散式估計、分散式偵測、循序性資訊融合、可能性比
值、瞬間觀測品質、多重訊號源估計、最大似然、期望值-最大化、信賴傳播、
分解因子圖、低密度產生矩陣碼。  
 
 III
目        錄 
 
1. Introduction..............................................................................................................1 
1.1. Energy Efficient Distributed Detection Schemes for WSNs (The first year).....1 
1.2. Distributed Estimation Schemes for Multi-source Estimation in WSNs (The 
second year) .............................................................................................................2 
1.3 Distributed Coding for Distributed Estimation in WSNs (The third year) ........5 
2. Power Allocation Based on Instantaneous Observation Quality for Distributed 
Detection in WSNs ..................................................................................................8 
2.1. System Model ....................................................................................................8 
2.2. Scheme A .........................................................................................................10 
2.3. Scheme B ......................................................................................................... 11 
2.4. Scheme C......................................................................................................... 11 
2.5. Simulation Results and Discussion .................................................................13 
2.6. Summary .........................................................................................................16 
3. Sequential Fusion with Truncated SPRT for Event Detection in WSNs ...............18 
3.1. System Model ..................................................................................................18 
3.2. Centralized Detection with Truncated SPRT ..................................................20 
3.3. Decentralized Detection with Truncated SPRT ..............................................22 
3.4. Simulation Results...........................................................................................25 
3.5. Summary .........................................................................................................28 
4. Distributed Multi-source Estimation based on EM Algorithm..............................29 
4.1. System Model ..................................................................................................29 
4.2. Centralized EM-based Multi-source Estimation (CEMMSE) Algorithm........32 
4.3. Decentralized EM-based Multi-source Estimation (DEMMSE) Algorithm....34 
4.4. Performance Evaluation .................................................................................37 
4.5. Summary .........................................................................................................41 
5. Distributed Multi-source Estimation based on Gaussian Belief Propagation 
Algorithm...............................................................................................................42 
5.1. System Model ..................................................................................................42 
5.2. GaBP-based Multi-source Estimation (GaME) Scheme.................................43 
5.3. The Problem of Convergence..........................................................................45 
5.4. Condensed-GaME (C-GaME) scheme............................................................45 
5.5. Convergence Ensured-GaME (CE-GaME) Scheme .......................................46 
 V
圖表目錄 
 
Fig. 2-1.  System model for distributed detection in WSNs. .......................................8 
Fig. 2-2.  Achieved DEP versus the desired DEP with the number of nodes 100N  .
......................................................................................................................................14 
Fig. 2-3.  Power ratio for the proposed schemes with the number of nodes 100N  .
......................................................................................................................................15 
Fig. 2-4.  Achieved DEP versus the desired DEP for Scheme C with the number of 
nodes 100N  , 500 or 900.........................................................................................16 
Fig. 2-5.  Power ratios for Scheme C with the number of nodes 100N  , 500 or 900.
......................................................................................................................................16 
Fig. 3-1.  System model for decentralized detection in WSNs. .................................19 
Fig. 3-2.  The markov chains for D-TSPRT at the fusion center. ..............................24 
Fig. 3-3.  Average number of transmissions versus the detection error probability for 
C-TSPRT. .....................................................................................................................26 
Fig. 3-4.  Average number of transmissions versus the detection error probability for 
D-TSPRT......................................................................................................................27 
Fig. 4-1.  The sensing model for distributed multi-source estimation. ......................30 
Fig. 4-2.  Average estimation performance for the centralized scenario with the 
number of sources 3M   and various numbers of nodes N . .................................38 
Fig. 4-3.  Average estimation performance for the centralized scenario with the 
number of sources 3M  , the number of nodes 4N  , 16 or 64 and various 
connection probabilities conP . .....................................................................................39 
Fig. 4-4.  Average estimation performance for the decentralized scenario with the 
number of sources 3M  , the number of representation levels 2K  , and various 
numbers of nodes N . .................................................................................................39 
Fig. 4-5.  Average estimation performance for the decentralized scenario with the 
number of sources 3M  , the number of nodes 16N  , and various numbers of 
representation levels K . .............................................................................................40 
Fig. 4-6.  Average estimation performance for the decentralized scenario with the 
number of representation levels 8K , the number of nodes 16N  , and various 
numbers of sources M . ..............................................................................................41 
Fig. 5-1.  Factor graph representation for the considered multi-source estimation 
problem in WSNs.........................................................................................................42 
Fig. 5-2.  Average MSE versus the observation SNR for the connection probability 
0.25conP ....................................................................................................................48 
Fig. 5-3. Numbers of iterations performed in the GaME and C-GaME schemes 
corresponding to Fig. 5-2.............................................................................................48 
 VII
8L  , and 100K  . ....................................................................................................85 
 
Table 6-1.  The quantization codewords generated by binary encoding (BE) and 
binary-reflected Gray encoding (BRGE) with 4L  . ................................................55 
 
 2
transmitting the local decision. Under a desired performance criterion, specified as the detection 
error probability (DEP), the nearly optimal power allocation function can be derived off-line and 
pre-implemented in each node before network deployment. Since the transmission power is well 
controlled by the instantaneous observation quality, the total energy consumption can be 
significantly reduced, achieving the same DEP.  
 
1.1.2.  Truncated Sequential Probability Ratio Test (TSPRT) Fusion Scheme 
For the problem of event detection, the sequential probability ratio test (SPRT) has been 
proven that the average number of required samples is much less than the fixed sample size (FSS) 
detector for achieving the same false alarm and miss detection probabilities [5]. In [6], SPRT is 
applied at the sensor node, and an iterative algorithm is proposed to find the thresholds for the 
local decision rule. However, due to sensor nodes are generally subject to a stringent energy 
constraint and have weak computation capability, this approach is not suitable for WSNs. Hence, 
in this work, we suggest that SPRT should be performed at the fusion center which is more 
powerful for computation and with a loose energy constraint. The fusion center can sequentially 
accumulate the information forwarded by sensor nodes, and broadcast a termination message to 
stop the transmission of all remaining nodes when enough information has been acquired for 
decision-making. Thus the average number of messages forwarded by sensor nodes, as well as 
the average energy consumption of nodes, can be significantly reduced. For the conventional 
SPRT, the number of samples is assumed to be infinite and the sequential test process is stopped 
when the accumulated information exceeds one of the predetermined thresholds corresponding to 
the desired performance. Nevertheless, the number of sensor nodes is generally limited and the 
fusion process should be modeled as the truncated SPRT (TSPRT) process. In this work, we 
investigate the sequential fusion under two different scenarios, centralized and decentralized, 
depending on the information available at the fusion center. The performance of sequential fusion 
for both centralized and decentralized environments is well examined, and the analytical 
approaches for finding the corresponding thresholds are proposed.  
  
1.2.  Distributed Estimation Schemes for Multi-source Estimation in WSNs (The second year) 
In the second year of this project, we focus on the problem of distributed multi-source 
estimation in WSNs. Two fusion schemes for distributed multiple sources estimation in WSNs are 
proposed: the EM algorithm-based scheme and the Gaussian belief propagation algorithm-based 
scheme. One of the most interesting applications in WSNs is distributed estimation, where 
spatially distributed sensors are deployed over the sensing area to estimate for a desired unknown 
 4
proposed for the estimation of multiple deterministic targets in WSN, where the environment is 
assumed to be centralized and no observation noise is taken into consideration. The final estimate 
is obtained by numerical searching in the non-closed-formed marginal distribution, resulting in a 
very high computational complexity.  
 
1.2.1.  Distributed Multi-source Estimation Scheme Based on EM Algorithm 
The multi-source estimation problem can be possibly solved by using some standard 
estimation approaches, such as the minimum mean square error (MMSE) estimator; nevertheless, 
the computational complexity is very high and grows exponentially with the network size, i.e. the 
number of nodes in the network. To facilitate multi-source distributed estimation in WSNs, an 
effective and low complex algorithm is highly desirable. Our goal is to propose an effective 
algorithm feasible for the estimation of multiple mixture deterministic signal sources under a 
scenario having a FC and considering noisy observation and quantization. Especially, under the 
assumption of stringent energy and bandwidth constraints, each node forwards only one 
observation, with the quantization of limited number of bits, to the FC for estimation. 
Maximum-likelihood (ML) is an effective estimator, providing good estimation performance in 
sense of minimizing mean square error (MSE). However, because of the mixture of multiple 
signals, the desired parameters cannot be observed directly and the desired likelihood function 
cannot be evaluated easily. The EM algorithm is an iterative method that provides an ML estimate 
of the desired parameters by iteratively applying the following two steps: expectation (E-step) 
and maximization (M-step) [22]. By regarding the observations at nodes as the observable but 
incomplete data, the multi-source estimation problem in WSNs could be solved by using the EM 
algorithm. In this work, we proposed the EM-based multi-source estimation schemes for both the 
centralized and decentralized scenarios. In the centralized scenario, the FC can receive the 
real-valued observations at nodes, corresponding to the best achievable estimation performance. 
Whereas, in the decentralized scenario, only the quantized version of the observation at each node 
is forwarded to the FC, thereby quantization noise is introduced degrading the estimation 
performance.  
 
1.2.2.  Distributed Multi-source Estimation Scheme Based on GaBP Algorithm 
When dealing with a problem corresponding to a complicated global function with many 
variables, we can factor the global function into a product of multiple local functions, each of 
which depends solely on a subset of the variables. This kind of factorization can be represented 
by a bipartite graph called a factor graph. To solve a complicated problem represented by a factor 
 6
[31]-[33], universal decentralized estimation schemes were proposed for noisy sensing 
environments with an unknown probability density function (PDF) of the observation noise. 
Noise-corrupted observations and imperfect communication channels were jointly considered in 
[16], and a decentralized estimation scheme was proposed based on the maximum likelihood (ML) 
method. Under the assumption that the FC does not have full knowledge of the statistics of the 
observation noise and communication noise, the expectation-maximization (EM) algorithm was 
employed for the incomplete data estimation problem [17]. In [18], optimization of the number of 
quantization bits and energy allocation across the quantization bits were investigated by 
considering noisy observations and imperfect information transmission. 
 
1.3.1.  Cooperative Information Aggregation Scheme Based on Repetition Coding 
Theoretically, applying one-bit quantization at each node should reduce the energy 
consumption and communication bandwidth requirement substantially, since only one binary 
symbol is sent per node. However, the achievable estimation performance is strictly limited in 
practical situations. On the other hand, using multi-bit quantization can improve the estimation 
performance at the cost of increasing energy and communication load. Because there are 
numerous nodes available in a WSN, each node can apply a multi-bit quantizer for source 
encoding of the observation signal but still only select one bit for forwarding to the FC in order to 
minimize the energy consumption and communication load. Then, the FC reconstructs the 
multi-bit quantization codeword, by aggregating all the bits forwarded cooperatively by the nodes, 
for final estimation. In this work, we propose cooperative information aggregation (CIA) 
approaches for distributed estimation by using multi-bit quantization at each node; however, only 
one bit is chosen from the resultant quantized observation at each node for transmission to the FC. 
We consider the impact of both noisy observation channels and imperfect communication 
channels. Two estimators are devised, in consideration of trade-off between the estimation 
performance and the computational complexity, as the fusion rules performed at the FC. 
Moreover, a suboptimal arrangement for the bits transmitted cooperatively by all nodes is 
proposed for each estimator. As a result, all the transmitted bits can be aggregated successfully 
and fused to generate the estimated result at the FC. 
 
1.3.2.  LDGM-CIA Scheme Based on the Low-density Generator Matrix Codes 
The CIA scheme proposed in the previous work is based on repetition codes. Now, we try to 
apply systematic codes to the CIA scheme in order to further improve the estimation performance. 
Low-density parity check (LDPC) codes were widely used in many applications because of their 
 8
2. Power Allocation Based on Instantaneous Observation Quality for 
Distributed Detection in WSNs 
2.1.  System Model 
In the distributed detection problem, we consider a wireless sensor network consisting of a 
finite number of sensor nodes N . Each sensor node performs the same functions of sensing and 
data processing, testing two statistical hypotheses, 0H  versus 1H , with the prior probabilities 
denoted as 0 0( )P H   and 1 1( )P H  , respectively, as shown in Fig. 2-1. The observation ky  
obtained at node k , under each of the two hypotheses, is given by  
0 0
1 1
:
:
k k
k k
H y v
H y v


   
, for 1, 2, ,k N  , 
where i ,  0,1i , is the signal of the hypothesis iH  to be detected, and kv  is the 
observation noise assumed to be independent and identically distributed (i.i.d.) Gaussian with 
zero mean and variance 2 . Without loss of generality, we set the determined signals under 
hypotheses 0H  and 1H  as 0 1    and 1 1  , respectively. Correspondingly, the observation 
signal-to-noise ratio (SNR) is defined as [36]  
2 2 2
o 1 0( ) 4      . 
2~ (0, )kv N 
Fusion 
center
= ,
1,2, ,
k k k kr g u w
k N

 
2~ (0, )k kw N 
0 1/H H
Communication
Channels
Observation
Channels
Node 1y1
y2
yN
Observation
Noise
Communication
Noise
g1u1
g2u2
gNuN
Observation
Signal
Transmitted
Signal
Node 2
Node N
Source
 
Fig. 2-1.  System model for distributed detection in WSNs. 
 
Due to the bandwidth limitation of the communication channel between sensor nodes and 
the fusion center, we assume that each node transmits the quantized binary decision to the fusion 
center, i.e.,  1, 1ku     representing 0H  and 1H , respectively. For node k , based on the 
maximum a posteriori probability (MAP) test to minimize the probability of decision error, the 
 10
could be more reliable and a high transmission power should be applied in order to resist the 
communication channel noise. On the other hand, if the instantaneous observation quality is low, 
the observation is regarded as less reliable and a small transmission power is applied in order to 
save energy consumption. According to (2-3), the instantaneous observation quality of ky  can 
be related to the LLR k  as 
 
 
 
 1 00 1
|
log log
|
k
k k
k
P y H P H
P y H P H
      .                   (2-4) 
Obviously, the optimal power allocation function is a nonlinear function of k . Here we 
apply a multi-degree polynomial to approximate the transmission power as  
 22 ( )k k kg          ,                       (2-5) 
where ,   and   are the coefficients to be determined, which can be figured out under a 
desired DEP. In this paper, we consider three different power allocation schemes based on (2-5). 
To minimize the total energy consumption with a constraint of the required DEP, the power 
allocation problem can be formulated as a constrained optimization problem. The corresponding 
coefficients in (2-5) can then be solved by the Lagrangian function and Karush-Kuhn-Tucker 
(KKT) conditions [38].  
 
2.2.  Scheme A ( 2 2( )A kg   ) 
 In Scheme A, the applied power allocation function is 2 2( )A kg   , which is irrelevant to 
k . This is the so-called equal power scheme, since all nodes transmit with the same power. 
From (2-2), the decision rule at the fusion center can be re-written as  
  1
01
<
1 H
H
N
A k k
k
r u w
N
 

 . 
Correspondingly, the false alarm probability at the fusion center can be derived as  
   
 
0 0
2
1
0
ˆ 1 | |
                    (2 )   (1 )
A A
N
N N i i
k f fk
i
P u H P r H
N
Q N i N P P
i

   
  
            
       (2-6) 
and the miss probability at the fusion center can be derived as 
   
 
1 1
2
1
0
ˆ 1 | |
                     (2 )   (1 ) ,
A A
N
N i N i
k m mk
i
P u H P r H
N
Q i N N P P
i

   
   
            
       (2-7) 
where ( )Q   is the Q -function. Hence, we have the DEP at the fusion center as 
 12
and 
   
   
2
2 2 2
0 02 2
1
2
2 2 2
1 12 2
1
1 4| 4 1 |
1 4| 4 1 |
N
C f f k k k
k
N
C m m k k k
k
Var r H P P Var u H
N
Var r H P P Var u H
N
  
  


                          


,       (2-13) 
where 0[ ]k kE u H , 1[ ]k kE u H , 0[ ]k kVar u H  and 1[ ]k kVar u H  can be easily 
calculated based on the fact 2
2 k
k
y     and the conditional distributions 
 2 21 2
0 2
1( )
2
y
kf y H e


   and  2 21 21 2
1( )
2
y
kf y H e


  . 
Consequently, this power allocation problem can be formulated as a constrained 
optimization problem shown as 
   2 21 1
,
min  ( ) min ( )
. . .
N N
C k C kk k
e C e
E g E g
s t P P
 
       

                 (2-14) 
The expected transmission power of a node  2( )C kE g    is given by 
    22 2 2 2 2 2
3
4 2( ) ( 2 )
                          2 2 ,
C k k
k k
E g E
E E
     
 
                 
        
          (2-15) 
where kE    ,  kE   and 3kE     can also be easily calculated based on 0( )kf y H  and 
1( )kf y H . 
It has been verified that the objective function  21 ( )N C kk E g     in (2-14) is a convex 
function. From (2-11), (2-12), (2-13) and (2-15), the Lagrangian function L  can be written as 
   2 0 10 1
1 0 1
, , , ( )
N
C k e
k
Na NaL E g Q Q P
b b
      

                     ,         (2-16) 
where 0   is the Lagrange multiplier, and 
 14
0 1 1 2   , and the local observation SNR is assumed to be 3dBo  . The variance of 
channel noise 2k  is drawn randomly from the Rayleigh distribution with the probability density 
function   2 222 xxf x e   , 0x  , where 2 2  . The performance of Scheme A is used as 
the benchmark, and a power ratio, defined as 
total transmission power in  100%
total transmission power in  j
Scheme j
Scheme A
   , 
where  ,j B C , is introduced as a measure of power saving efficiency. If the power ratio j  
is smaller than 100% , it implies that Scheme j  is more energy efficient than the equal power 
scheme achieving the same DEP.  
Since an approximation of Cr  based on CLT is applied in (2-11), the achieved DEP may 
deviate from the desired DEP. We examine the approximation accuracy of DEP in Fig. 2-2, which 
shows the actually achieved DEP versus the desired DEP for the number of nodes 100N  . For 
Scheme A, the actually achieved DEP is the same as the desired DEP, since no approximation is 
applied. For Scheme B or Scheme C, however, the actually achieved DEP is slightly worse than 
the desired DEP due to the approximation error of CLT, especially for the case with a lower value 
of desired DEP.  
 
Desired DEP
A
ch
ie
ve
d 
D
EP
10
-5
10
-4
10
-3
10
-2
10
-110
-5
10
-4
10
-3
10
-2
10
-1
10
0
Scheme A
Scheme B
Scheme C
 
Fig. 2-2.  Achieved DEP versus the desired DEP with the number of nodes 100N  . 
 
Fig. 2-3 shows the power ratio versus the desired/achieved DEP for the number of nodes 
 16
at least more than 20 % of energy can be saved by applied the proposed Scheme C for different 
network sizes.  
 
10-5 10-4 10-3 10-2 10-1
10-5
10-4
10-3
10-2
10-1
100
N = 900
N = 500
N = 100
Desired DEP
A
ch
ie
ve
d 
D
EP
 
Fig. 2-4.  Achieved DEP versus the desired DEP for Scheme C with the number of nodes 
100N  , 500 or 900. 
10
-5
10
-4
10
-3
10
-2
10
-140
45
50
55
60
65
70
75
80
Desired/Achieved DEP
Po
w
er
 R
at
io
 (%
)
N = 900, Actual
N = 500, Actual
N = 100, Actual
N = 900, Approximated
N = 500, Approximated
N = 100, Approximated
 
Fig. 2-5.  Power ratios for Scheme C with the number of nodes 100N  , 500 or 900. 
 
2.6.  Summary  
 In this work, we have proposed the nearly optimal power allocation schemes based on the 
instantaneous observation quality for distributed detection in WSNs. The proposed power 
 18
3. Sequential Fusion with Truncated SPRT for Event Detection in WSNs  
3.1.  System Model 
We consider a wireless sensor network consisting of a finite number of sensor nodes 0n . 
Each sensor node performs the same functions of sensing and data processing, testing two 
statistical hypotheses, 0H  versus 1H , with the prior probabilities denoted as 0  and 1 , 
respectively. We assume that the observations are independent and identically distributed (i.i.d.) 
across different sensor nodes and k , for  0,1k  , is the signal of the hypothesis kH  to be 
detected. Then the observation ix  obtained at node i  can be expressed as 
0 0
1 1
:
:
i i
i i
H x w
H x w


   
, for 01,2, ,i n  , 
where iw  is the observation noise assumed to be i.i.d. Gaussian with zero mean and variance 
2 . Hence, the probability distribution function (pdf) for the hypothesis kH  can be represented 
as 
2( ) ~ ( , )k i kf x N   . 
Correspondingly, the observation signal-to-noise ratio (SNR) is defined as [36] 
 2 21 0oSNR     .                            (3-1) 
The observations of nodes are then forwarded to a fusion center for the final decision. The 
fusion model could be centralized or decentralized, depending on the information available at the 
fusion center. For centralized detection, the observed signal is directly forwarded to the fusion 
center without any distortion. On the other hand, for decentralized detection, the observation of 
each node is first quantized, i.e. transformed into a finite alphabet message, and then forwarded to 
the fusion center. Shown in Fig. 3-1 is the system model for decentralized detection in WSNs. For 
node i , the quantized observation signal is ( )i iu x , where ( )   is the quantization rule or 
the local decision rule. The quantized message is sent to the fusion center through a discrete 
memoryless channel perturbed by additive white Gaussian noise (AWGN) with the transition 
probability defined by ( )i ip y u , where iy  is the signal received at the fusion center 
corresponding to node i . It is assumed that the communication channels for different nodes are 
orthogonal to each other and thus no mutual interference is introduced. Moreover, a feedback 
channel from the fusion center to all sensor nodes is available for the fusion center to broadcast 
the termination message, which stops the transmission process of all nodes.  
 
 20
processed, each node forwards the observation to the fusion center sequentially. Based on (3-2), 
when the accumulated information exceeds one of the thresholds, the fusion center makes a final 
decision, and then broadcasts a termination message to stop the transmission process of 
remaining nodes for energy saving. If none of the thresholds is exceeded, the fusion center 
proceeds to the reception of the message of the subsequent node. However, if none of the 
thresholds is exceeded after all available sensing messages have been received, the fusion center 
will make a final decision based on all available messages. The major issue left is to find the 
thresholds, in terms of minimizing the number of message transmissions from nodes to the fusion 
center, that achieve/approach the target performance, i.e. the desired fP  and mP . 
 
3.2.  Centralized Detection with Truncated SPRT 
For centralized detection, the fusion center can access all of the observations without any 
distortion, i.e., each node can transmit the original observed signal through a noise-free 
communication channel with infinite bandwidth. At the fusion center, centralized detection with 
truncated SPRT (C-TSPRT) is performed. For 0n n , C-TSPRT is performed similar to the 
conventional SPRT based on (3-2). If C-TSPRT does not lead to a termination with final decision 
for 0n n , then all the observations are used for decision-making based on 
0
0
11
01
log , is choosen
log , is choosen
n
ii
n
ii
Z A H
B Z H


     

 ,                     (3-4) 
where iZ , the LLR of the observation ix , is defined as 
 
  2 21 0 1 01
2
0
2 ( )( )
log
2
ii
i
i
xf x
Z
f x
   

    , 
and the fusion threshold is  0 1log /   . 
 It is possible that the non-truncated process leads to a correct decision while the truncated 
process leads to an incorrect decision, since the number of available nodes is limited to 0n . This 
happens only when C-TSPRT does not lead to a termination for 0n n  and (3-4) is applied. 
Conditioning on 0H , We define 0 0( )n  as the probability that the truncated process leads to a 
decision of 1H , while the non-truncated process leads to 0H . Similarly, 1 0( )n  is defined as 
the probability, conditioning on 1H , that the truncated process leads to a decision of 0H , while 
the non-truncated process leads to 1H . Moreover, we define 0( )n  and 0( )n  as the false 
alarm and miss detection probabilities for C-TSPRT. Subsequently, the upper bounds for 0( )n  
 22
1 A
B


  .                             (3-7) 
Therefore, from (3-5), (3-6) and (3-7), the upper bounds of 0( )n  and 0( )n  can be obtained 
as 
2 2 2 2
0 1 0 0 1 0
0
0 1 0 0 1 0
( ) 2 log ( ) 21( )
( ) ( )
n A n
n Q Q
A n n
           
                   
         (3-8) 
and 
2 2 2 2
0 1 0 0 1 0
0
0 1 0 0 1 0
log ( ) 2 ( ) 2
( )
( ) ( )
B n n
n B Q Q
n n
           
                   
.         (3-9) 
According to (3-8) and (3-9), the desired thresholds A  and B  can be easily determined 
for a target decision error performance    0 0( ), ( ) ,f mn n P P   . If the number of nodes 0n  
approaches to infinity, (3-8) and (3-9) degenerate to (3-7), which are the upper bounds for the 
conventional SPRT with infinite samples.  
 
3.3.  Decentralized Detection with Truncated SPRT 
In practical situations, the communication channel is noisy and with only limited available 
bandwidth. Thus centralized detection cannot be performed at the fusion center, and decentralized 
detection should be applied. Furthermore, due to energy limitation in sensor nodes, the 
observation message generally contains only a few bits. To minimize energy consumption, we 
assume that each node employs a one-bit quantizer with the output message  1, 1iu    , 
representing the hypotheses 1H  and 0H , respectively. The local decision rule for node i , based 
on the maximum a posteriori probability (MAP) test, is 
 
 1 01 0
1, if log P( | ) P( | ) 0
( )
1, if log P( | ) P( | ) 0
i i
i i
i i
H x H x
u x
H x H x
     
.                  (3-10) 
Furthermore, the communication channel is assumed to be a binary symmetric channel (BSC), 
where the crossover probability is denoted as cp . Therefore, the conditional probabilities of the 
received signal at the fusion center are 
1 1 1
0 0 0
P( 1 | ) (1 ) (1 )
P( 1 | ) (1 ) (1 )
i c c
i c c
p y H p p p p
q y H p p p p
             
,               (3-11) 
where 1 1P( 1 | )ip u H    is the probability, conditioning on 1H , that the local decision is 
1iu   ; and 0 0P( 1 | )ip u H    is the probability, conditioning on 0H , that the local decision 
 24
process stay at state   and does not absorb at states A  or B  within 0n  steps, all 
conditioning on 1H . 
 
(a) For the hypothesis 0H . 
 
(b) For the hypothesis 1H . 
Fig. 3-2.  The markov chains for D-TSPRT at the fusion center. 
 
In (3-14) and (3-15), the closed-forms of the first term can be derived based on the 
gambler’s ruin problem [41]. Accordingly, we have  
0
0
1
1
( ) 1 ( ) 2 ( ) 2 1
1
1
( ) 1 ( ) 2 ( ) 2 1
1
( ) 2 (1 ) cos sin sin
( ) 2 (1 ) cos sin sin
n A B
a n n A n A n
A H
kn A
A B
a n n B n B n
B H
k
k k AkP A B q q
A B A B A B
k k BkP A B p p
A B A B A B
  
  
    

    

           
       
 

 
 


 
 

      
      
0n
n B


        


,  (3-16) 
where 
, 0
( )
0 , 0
x x
x
x
   
. However, it is very difficult to obtain the closed-forms of the second 
and third terms in (3-14) and (3-15). Therefore, we release the condition “does not absorb at 
states A  or B  within 0n  steps” to obtain the available upper bounds. For the second term, we 
derive the upper bounds as 
   
 
   
 
0
0 0
0
0
0
0 0
1
0
1 ( ) 2
( )
2
1 ( ) 2
( )
2
ˆ (1 )
ˆ (1 )
A n A
n n ina i
iA H
i n
B n B
n n ina i
iB H
i n
P C q q
P C p p




  


     
   


     
    


 

 

,    (3-17) 
where ( )x  is the indicator function defined as 0
0
( ) 1, ( ) is even
( ) 0, ( ) is odd
x x n
x x n


   
. For the third term, 
0 1 2 -1-2 AA-1B B+1 ……
1-q 1-q 1-q 1-q
q q 
1 1
1-q 1-q 
q q 
1-q 
q q q 
0 1 2 -1-2 AA-1B B+1 ……
p p p p p 
1 1
p p 
1-p 1-p1-p 1-p 1-p 1-p 1-p 
 26
performance in the simulation. We define the normalized errors in the false alarm and miss 
probabilities as 
  
  
0
0
c c c
f f
c c c
m m
n P P
n P P


 
 
    
.      (3-23) 
When the upper threshold A   and the lower threshold 0B  , we have the normalized 
errors 0c   and 0c  . However, with acceptable performance degradation, we can use 
the upper bounds of 0( )n  and 0( )n  in (3-8) and (3-9) to find the thresholds, in order to save 
the number of transmissions, i.e., the energy consumption, in the network.  
Fig. 3-3 shows the average number of transmissions versus the target detection error 
probability, with different desired normalized errors. We can find that C-TSPRT needs less 
average number of transmissions for approaching the optimal performance with all the 
observations are transmitted. With less than 1% of performance degradation, more than 40 % of 
energy consumption can be efficiently saved.  
 
10
-4
10
-3
10
-2
10
-120
40
60
80
100
120
140
160
Bayesian
C-TSPRT
C-TSPRT )10,10( 11   cc  
)10,10( 22   cc  
A
ve
ra
ge
 N
um
be
r o
f T
ra
ns
m
iss
io
ns
Detection Error Probability  
Fig. 3-3  Average number of transmissions versus the detection error probability for C-TSPRT. 
 
 For decentralized detection, if the messages of all sensor nodes are used for decision-making 
at the fusion center, the minimum detection error probability can be obtained by using the 
Bayesian hypothesis testing [42] with the corresponding false alarm probability dfP  and miss 
probability dmP  as  
 28
3.5.  Summary 
 We have proposed the sequential fusion scheme for events detection in WSNs. The TSPRT 
process is performed at the fusion center, and the message forwarding process from nodes to the 
fusion center is terminated when enough information has been acquired for decision-making. As a 
result, the energy consumption for message forwarding can be significantly reduced. Furthermore, 
for both centralized and decentralized detection, the analytical methods for finding the 
corresponding thresholds achieving the desired performance are derived. According to the 
simulation results, the proposed scheme can greatly reduce the average number of messages 
forwarded by sensor nodes, as well as the average energy consumption of nodes, when compared 
to the non-sequential fusion scheme approaching the same detection performance. 
 
 30
the decentralized scenario, the observation signal nX  is quantized to obtain a quantized version 
nU , mapping to a modulation symbol nI  with a finite alphabet size. Then, the symbol nI  is 
forwarded to the FC. Based on the observation messages transmitted by all nodes, the FC 
estimates the set of desired signals θˆ . For simplification, in this work, the communication 
channels from all nodes to the FC are assumed to be perfectly orthogonal and error free, which 
can be achieved via employing some well-known error protection techniques. As a result, in the 
centralized scenario, an exactly replicate of the observation signal nX  can be obtained at the FC; 
while in the decentralized scenario, the received modulation symbol nˆI  is equal to the symbol 
nI  transmitted by node ns , implying that the reconstructed signal ˆ nU  is exactly equal to nU .  
 
(a) Centralized scenario
(b) Decentralized scenario
O
bs
er
va
tio
n
C
ha
nn
el
s
Si
gn
al
 S
ou
rc
es
s1
sN
s2
w1
w2
wN
Z1
Z2
ZN C
om
m
un
ic
at
io
n
C
ha
nn
el
s
X1
X2
XN
D
ec
od
er
U1
U2
UN
Quantizer Modulator
I1
I2
IN
Î1
Î2
ÎN
… …
Fu
si
on
 A
lg
or
ith
m
Û1
Û2
ÛN
Fusion Center
1
2
M
… … … … …
2ˆ
ˆ
M
…
1ˆ
O
bs
er
va
tio
n
C
ha
nn
el
1
2
M
s1
sN
s2
w1
w2
wN
Z1
Z2
ZN
Fu
si
on
A
lg
or
ith
m
2ˆ
ˆ
M
X1
X2
XN
X1
X2
XNSi
gn
al
 S
ou
rc
es
… …
Fusion Center
……
1ˆ
…
 
Fig. 4-1  The sensing model for distributed multi-source estimation. 
 
In the decentralized scenario, we assume that the number of representation levels of the 
quantized signal is K , corresponding to a 2log K -bit symbol. For simplicity, we apply the 
uniform quantization method at sensor nodes. Because of the unequal mixing coefficients in the 
observation channels of different nodes, the step-size of the quantizer for node ns  is set to be 
( ) ( )U
n
L
n nB B
K
 ,                              (4-4) 
depending on the bounds of the observation signal at each node. Then, the quantization rule is 
expressed as 
 32
square of the mixing gain, of m  that couples to the observed signal at node ns . Hence, we set 
the variance of ,n m  as 2 2 2, ,n m n m n    with 2 2, , ,1Mn m n m n jja a   , where 2,1 1M n mm   . 
Accordingly, we can define a set of random variables  1 2 TNY Y Y Y , where 
,1 ,2 ,n n n n MY Y Y   Y   is a row vector, i.e.,  
1 1,1 1,
,1 ,
M
N N N M
Y Y
Y Y
               
Y
Y
Y

   

, 
to represent the set of all observations at the FC. Note that X  is the set of observable but 
incomplete data, and Y  is the set of unobserved but complete data. 
 
4.2.  Centralized EM-based Multi-source Estimation (CEMMSE) Algorithm 
In the centralized scenario, the FC can receive the real-valued observation signal nX  of 
each node. According to (4-9), the hidden observation ,n mY  is a Gaussian distributed random 
variable with mean 
, ,n mY n m m
a   and variance 
,
2 2
,n mY n m
  , given a set of source signals 
 1 2 TM  θ  . By treating ,n mY , for 1, ,n N  , as independent random variables, we 
have the log-likelihood function corresponding to Y  expressed as  
 
,
1
,
1 1
ln ( ; ) ln ( ; )
ln ( ; ).
n
n m
N
n
n
N M
Y n m m
n m
f f
f Y 

 




Y YY θ Y θ
                (4-10) 
where ( ; )
n n
fY Y θ  is the joint pdf of nY , considered as a function of the unknown source signals 
θ . Then, substituting the distribution of ,n mY  into (4-10), we obtain 
     
 
2 2
, , , ,
1 1 1 1
2 2
0 , , ,
1 1
ln ( ; ) ln 2 ln 2
C 2 .
N M N M
n m n m n m m n m
n m n m
N M
n m n m m n m
n m
f MN Y a
Y a
   
 
   
 
    
  
 

Y Y θ
      (4-11) 
where    0 ,1 1C ln 2 lnN M n mn mMN        is a constant irrelevant to Y  and θ .  
According to the E-M algorithm, each iteration consists of two steps: the expectation step or 
so-called E-step, and the maximization step or so-called M-step. Assume that we are currently at 
the i -th iteration and the corresponding estimate of θ  is ( ) ( ) ( ) ( )1 2ˆ ˆ ˆ ˆ
Ti i i i
M     θ  .  
1) E-step: 
 34
 
 
,( ) ( ) ( )
, , , ,1
( ) 2 ( )
, , ,1
ˆ ˆˆ
ˆ ˆ
Mn mi i i
n m n m m n m n n j jj
n
Mi i
n m m n m n n j jj
Y a X a
a X a
  
  


   
  


                 (4-17) 
and  
 ( ) ( ) 2 2 2 2, , , , ,
1 1
ˆ ˆln ; ; 2
N M
i i
n m n m m n m n m m n m
n m
E f a Y a   
 
      Y Y Y θ X θ .           (4-18) 
2) M-step: 
In the M-step, a new estimate of the parameters that maximizes the conditional expectation 
of the log-likelihood function ln ( ; )fY Y θ , given X  and ( )ˆ iθ , is found. Note that the modified 
log-likelihood function ln ( ; )f Y Y θ  is equivalent to the log-likelihood function ln ( ; )fY Y θ  in 
the sense of maximization with respect to θ . Hence, the new estimate of the parameters is given 
by  
 ( 1) ( )ˆ ˆarg max ln ( ; ) ;i iE f      Y Yθθ Y θ X θ ,                   (4-19) 
where  1 2 TM     θ   is a specific set of the parameters. By differentiating 
( )ˆln ( ; ) ; iE f   Y Y Y θ X θ  with respect to m , we have  
( ) ( ) 2 2 2
, , , , ,
1 1
ˆ ˆln ( ; ) ;
N N
i i
n m n m n m m n m n m
n nm
E f a Y a    
        Y Y Y θ X θ .           (4-20) 
Then, setting the differentiation equal to zero, we obtain the new estimate of m  that maximizes 
the conditional expectation of the log-likelihood function as  
( 1) ( ) 2 2 2
, , , , ,
1 1
ˆ ˆ
N N
i i
m n m n m n m n m n m
n n
a Y a  
 
            .                  (4-21) 
We can repeat these two steps, i.e., (4-17) and (4-21), until a convergence criterion is met, 
and the final estimate is the latest version of θˆ .  
 
4.3.  Decentralized EM-based Multi-source Estimation (DEMMSE) Algorithm 
In the decentralized scenario, the observation signals are quantized before transmission, and 
the FC can only recover the quantized version nU  of the observation signal forwarded by node 
ns . After all the quantized messages  1 2, , , NI I II   have been received at the FC, the 
log-likelihood function of I  becomes 
    , 1 , , ,1 1
1 1
1; erf erf ,;
2 2 2
   
 
  
 
                   
   n nn
M MN N
n I n m m n I n m mm m
I n
n n n n
a a
f f II θI θ   (4-22) 
 36
normalization factor. We define ( )Ln nn nII B
     and ( ) 1( )L n nn nI B I      as the lower and 
upper boundaries of the quantum interval of nI . On condition that the quantized observation 
message is nI , n n nX Z w   must be within the interval  ,n nI I  . From the fact that nZ  and 
nw  are independent, the term ( )n n nE Z Q X I     in (4-26) is obtained by 
   
( )
( )
( )
( )
( ) ( ) ( )
erf erf ( )( ) 2 ( ) 2
2
U
n n
L n n n
n n
U
n
L n n
n
B I z
n n n w Z IB I z
B
Z In n n nB
E Z Q X I z f w dw f z dz
z f z dzI z I z 




 
     
     
 

   (4-28) 
and the term 2 ( )n n nE Z Q X I    in (4-26) is given by 
   
( )
( )
( )
( )
2 2
2
( ) ( ) ( )
erf erf ( ) ,( ) 2 ( ) 2
2
U
n n
L n n n
n n
U
n
L n n
n
B I z
n n n w Z IB I z
B
Z In n n nB
E Z Q X I z f w dw f z dz
z f z dzI z I z 




 
    
     
 

  (4-29) 
where the normalized factor 
nI
  is  
   
( )
( )
( )
( )
( ) ( )
1 erf erf ( ) .( ) 2 ( ) 2
2
U
n n
Ln n n
n n
U
n
L n
n
B I z
I w ZB I z
B
Zn n n nB
f w dw f z dz
f z dzI z I z 




 
 
    
 

         (4-30) 
Consequently, the conditional noise power 2 ( )n nI  can be obtained by using (4-26)-(4-30). Note 
that 2 ( )n nI  depends on the system parameters and the received message nI  only. Hence all 
possible values of 2 ( )n nI , corresponding to all possible values of nI  (i.e., 0,1, , 1K  ), can 
be calculated and tabulated beforehand at the FC when the system parameters are available.  
By approximating the total noise nv  as a zero-mean Gaussian random variable and 
applying (4-7), we can approximate the log-likelihood function of the reconstructed observations 
X , given a set of quantized messages I , as  
   2 2,1
1
ln ( ; ) ln 2 ( ) 2 ( )
N
M
n n n n m m nm
n
nf N I X a I      X X θ I    .        (4-31) 
Similarly, we define 1 2
T
N   Y Y Y Y    , where ,1 ,2 ,n n n n MY Y Y   Y    , as a set of complete 
data. Hence we have the relation 
,
1 1
,
M M
n m mn n mn
m m
X v Ya 
 
    ,                        (4-32) 
where , , ,n m n m n mmY a     with ,n m  denoting the hidden noise. The variance of ,n m  is set as 
 38
between the estimates obtained in two successive iterations, i.e.,  2( 1) ( )1 ˆ ˆM i im mm M   , is less 
than the threshold 802 . For performance comparison, the estimation performance of a single 
signal source, i.e., under the scenario without mutual interference, based on a single observation 
is shown as a baseline. In the centralized scenario, the baseline performance is equal to the 
observation noise power; while, in the decentralized scenario, the baseline performance suffers 
from both the observation noise and quantization noise.   
Fig. 4-2 shows the average estimation performance of the centralized scenario with the 
number of sources 3M   and various numbers of nodes N . By applying the proposed 
CEMMSE algorithm, the mutual interference between different source signals can be eliminated 
successfully, and all the unknown parameters can be well estimated with very good accuracy. The 
average MSE is inverse proportional to the observation SNR and the increase in the number of 
nodes N  can significantly improve the estimation performance. Compared to the performance 
baseline, the performance of 4N   is worse because of the insufficiency of the number of 
nodes. 
 
-20 -10 0 10 20 30 40 50
10-7
10-6
10-5
10-4
10-3
10-2
10-1
100
Observation SNR (dB)
A
ve
ra
ge
 M
ea
n 
Sq
ua
re
 E
rr
or
N = 4
N = 16
N = 64
Baseline
 
Fig. 4-2  Average estimation performance for the centralized scenario with the number of 
sources 3M   and various numbers of nodes N . 
 
Fig. 4-3 compares the average estimation performance of the centralized scenario with 
different connection probabilities conP . The number of sources is 3M   and the numbers of 
nodes are 4N  , 16 and 64. We observe that the increase in the connection probability degrades 
the estimation performance, since the mutual interference is stronger for the situation with a high 
connection probability.  
 40
Fig. 4-5 shows the average estimation performance of the decentralized scenario with the 
number of sources 3M   and the number of nodes 16N  . Four numbers of representation 
levels, 2K  , 4, 8 and 16, are investigated, corresponding to the one-bit, two-bit, three-bit and 
four-bit quantizers. The increase in the number of representation levels can reduce the 
quantization noise power, thereby significantly improving the estimation performance. However, 
the performance of decentralized environments is upper-bounded by that of centralized 
environments  
 
-20 -10 0 10 20 30 40 50
10-4
10-1
100
10-2
Observation SNR (dB)
A
ve
ra
ge
 M
ea
n 
Sq
ua
re
 E
rr
or
10-3
K = 2
K = 4
K = 8
K = 16
Individually Quantized
Centralized
 
Fig. 4-5  Average estimation performance for the decentralized scenario with the number of 
sources 3M  , the number of nodes 16N  , and various numbers of representation levels K . 
 
Fig. 4-6 shows the average estimation performance for the decentralized scenario with the 
number of nodes 16N  , the numbers of representation levels 8K , and various numbers of 
sources M . Since the mutual interference is more severe for the  The increase in the number of 
sources will degrade the estimation performance since the mutual interference is proportional to 
the number of sources.  
 
 42
5. Distributed Multi-source Estimation based on Gaussian Belief Propagation 
Algorithm 
5.1.  System Model 
The system model considered in this work is the same as the centralized scenario for 
distributed multi-source estimation, as shown in Fig. 4-1. For the considered multi-source 
estimation scenario, we can construct a factor graph, as shown in Fig. 5-1, to represent the 
observations and desired source signals. There are two kinds of nodes: the variable nodes   1Mm mv   
denoting the estimated parameters, and the factor nodes   1Nn nf   representing the observations at 
sensor nodes [23]. Furthermore, let nV  denote the index set of variable nodes mv  that connect to 
factor node nf , and mF  the index set of factor nodes nf  that connect to variable node mv . In 
general, the factor graph is a fully connected bipartite graph, since each observation is a linear 
combination of all the desired parameters; hence, we have  1, 2, ,nV M  , for 1, ,n N  , 
and  1, 2, ,mF N  , for 1, ,m M  . However, if the mixing gain ,n ma  is small enough or 
equal to zero, the corresponding edge can be removed.   
 
1X
1v
Factor
nodes
Variable
nodes 2v Mv
2X NX
1f 2f Nf
Observations
1ˆ 2ˆ ˆMEstimation  
Fig. 5-1  Factor graph representation for the considered multi-source estimation problem in 
WSNs.  
 
The belief propagation (BP) algorithm, also known as the sum-product algorithm, is an 
efficient and powerful method for computing various marginal functions derived from the global 
function [23]. The approach reduces the computational complexity of solving a complicated 
problem, such as the deterministic vector-matrix linear equation shown in (4-3). In a factor graph, 
 44
where y  is a dummy variable, 2 2
1
11
K
y
k k
    and 2 21
K
k
y y
k k
    . In addition, we also have 
the property that  
   
   
   
2 2 2
1 2
22 2 2
1 2
22 2 2
2
exp 2 ,
exp 2 exp 2
exp 2 exp 2
y
y
x x y
x y dy
x y y dy
x y dy
   
    
    






    
           
             




           (5-5) 
where 
2 2
1 2
2 2 2
1 2
y
y
x      
   , 
2
2
2 2 2
1 2
11   
     
, x y  , 2 2 2 21 2x      and   is a 
constant irrelevant to the variables x  and y . Since the last integral term in (5-5) is equivalent 
to the integration of a Gaussian pdf, (5-5) can be rewritten as 
     2 22 2 21 2exp 2 , exp 2y x xx y dy x                     ,        (5-6) 
where   is a constant.  
According to (5-1) and (5-4), the message passed from variable node mv  to factor node nf  
can be calculated as  
   2 2
,
, ,
m n k m k m m n m n
m
v f f v f v v f v f
k F k n
        
 
    ,             (5-7) 
where 2 2
,
11
m n
m k m
v f
k F k n f v
       and 2 2, k mm n m n m k m
f v
v f v f
k F k n f v
  

 
  
  . Similarly, according to (5-2) 
and (5-3), the message passed from factor node nf  to variable node mv , given the observation 
nX , is calculated as  
 
 
2
2
,~
,exp 2n m k nn
nm
n kf v n n v fk V
k V k m
k
v
X a v      
        ,           (5-8) 
where   is a normalization constant for obtaining a pdf. By applying (5-6) iteratively, the 
message (5-8) can be rewritten as 
 2,n m n m n mf v f v f v      ,                           (5-9) 
where , ,
,
n m k n
n
f v n v f n m
k V k m
n kX aa  
 
      and 
2 2 2 2 2
, ,
,
n m k n
n
f v n n k v f n m
k V k m
a a   
 
     . 
Note that the message passed by each node is only the corresponding mean and variance.  
By applying (5-7) and (5-9), the message updating of the GaME scheme can be performed 
easily. By checking the difference in the mean at each variable node between two successive 
 46
T0.298 0.469 0.582 0.334 0.579 0.640 0.783 0.567 0.602 0.305
0.661 0.064 0.423 0.432 0.760 0.209 0.680 0.794 0.050 0.874
0.284 0.988 0.515 0.225 0.529 0.379 0.461 0.059 0.415 0.015
      
A     (5-11) 
in which the 1st, 2nd, 6-th, 8-th, 9-th and 10-th rows satisfy the constraint in (5-10), then the 
reduced mixing matrix is chosen as 
T0.298 0.469 0.640 0.567 0.602 0.305
0.661 0.064 0.209 0.794 0.050 0.874
0.284 0.988 0.379 0.059 0.415 0.015
       
A ,               (5-12) 
where the dominant entry in each row vector is marked by underline. By applying A  in the 
GaBP algorithm, the probability of convergence can be greatly improved. This scheme is referred 
to as the C-GaME scheme. 
 
5.5.  Convergence Ensured-GaME (CE-GaME) Scheme 
Although applying the C-GaME scheme did improve the convergence probability, it is still 
possible that the GaBP algorithm diverges in some scenarios. To completely ensure the 
convergence in the estimation, we further propose the CE-GaME scheme. The concept is to 
construct multiple square mixing matrices satisfying the strictly diagonally dominant property, by 
using the reduced mixing matrix A  obtained in the C-GaME scheme. In the reduced mixing 
matrix A , the row vectors with the dominant entry located at the same position are grouped to 
form M  groups, corresponding to the M  possible positions of the dominant entry. Then, one 
row vector is chosen from each group to form an M M  square mixing matrix iA ; obviously, 
iA  is strictly diagonally dominant, implying the convergence of the GaBP algorithm. For 
example, according to the reduced mixing matrix A  shown in (5-12), we have the three groups 
of row vectors as  
T T
1 2
0.640 0.602 0.298 0.567 0.305
0.209 0.050 , 0.661 0.794 0.874
0.379 0.415 0.284 0.059 0.015
                
G G , and 
T
3
0.469
0.064
0.988
      
G .       (5-13) 
Then, 6 square mixing matrices, iA  for 1, , 6i   , with the strictly diagonally dominant 
property can be obtained, e.g., 
T
1
0.640 0.298 0.469
0.209 0.661 0.064
0.379 0.284 0.988
       
A .                       (5-14) 
By using the square mixing matrix iA , the GaME scheme can be applied with the guarantee of 
 48
0 5 10 15 20 25 30
10-4
10-3
10-2
10-1
100
Observation SNR (dB)
A
ve
ra
ge
 M
ea
n 
Sq
ua
re
 E
rr
or
GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
C-GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
 
Fig. 5-2  Average MSE versus the observation SNR for the connection probability 0.25conP . 
Fig. 5-3 shows the numbers of iterations performed in the GaME and C-GaME schemes 
corresponding to Fig. 5-2. It is found that the number of required iterations in the GaME scheme 
is much larger than that in the C-GaME scheme, since more nodes is incorporated in the 
estimation in the GaME scheme.  
 
0 5 10 15 20 25 300
5
10
15
20
25
Observation SNR (dB)
A
ve
ra
ge
 N
um
be
r o
f I
te
ra
tio
ns
GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
C-GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
 
Fig. 5-3  Numbers of iterations performed in the GaME and C-GaME schemes corresponding to 
Fig. 5-2. 
 
Fig. 5-4 shows the convergence probability versus the connection probability conP  of the 
original mixing matrix A  for the observation SNR OSNR 30 dB. We compare only the 
GaME and C-GaME schemes. It is observed that C-GaME can greatly improve the convergence 
 50
 
Fig. 5-6 shows the average MSE versus the connection probability conP  for the observation 
SNR OSNR 30 dB. For the GaME scheme, good estimation performance can be achieved if the 
GaBP algorithm converges. However, the GaME scheme may diverge when the connection 
probability conP  is quite large. On the other hand, for the C-GaME scheme, the estimation 
performance degrades significantly, especially for a very high connection probability conP . 
Recalling the results shown in Fig. 5-4, although the convergence probability of C-GaME is quite 
large for a very high connection probability conP , the estimation performance is degraded 
severely. Furthermore, the numbers of iterations performed in the GaME and C-GaME schemes, 
corresponding to Fig. 5-6, are shown in Fig. 5-7.  
 
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
10-4
10-3
10-2
10-1
100
A
ve
ra
ge
 M
ea
n 
Sq
ua
re
 E
rr
or
GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
C-GaME
M = 3, N = 25
M = 5, N = 25
M = 5, N = 50
Connection Probability  
Fig. 5-6  Average MSE versus connection probability conP  for the observation SNR 
OSNR 30 dB.  
 
 52
6. Cooperative Information Aggregation for Distributed Estimation in 
Wireless Sensor Networks  
6.1.  System Model 
The considered system model is comprised of K  sensor nodes and one FC, as shown in Fig. 6-1. At 
each observation interval, each node makes a noisy local observation formulated as  
, 1, 2, ,k kx n k K    ,                         (6-1) 
where   denotes the unknown parameter to be estimated; and kn  is the observation noise, which is 
assumed to be AWGN with zero mean and variance 2 . The local observation kx  is bounded by 
 ,W W , where W  is a predetermined value corresponding to the possible range of  . The 
observation signal-to-noise ratio (SNR), which indicates the observation quality, is defined as follows: 
 2 2O 10SNR 10log W  .                          (6-2) 
Each node quantizes the local observation into L  bits by using a uniform quantizer. According to the 
local observation SNR, the optimal quantization bit length L  can be determined by applying the 
following formula [15]: 
 2logL W     .                             (6-3) 
The quantization step size is then determined as 2 2 1LW   .  

1 1x n   1L x 1O 1c
1c
k kx n   L kx kO kc
K Kx n   L Kx KO Kc
kc
Observation
Channels
Kc
 ˆ f  c
Sensor Node 1
Sensor Node k
Sensor Node K
FC
Communication
Channels
 
Fig. 6-1  The system model for WSNs. 
 
At each observation interval, the L -bit local observation vector of node k  is generated. It is 
expressed as  
  ,1 ,2 ,, , , , 1, 2, ,Tk L k k k k Lx O O O k K     O   ,                 (6-4) 
where  L   denotes the L -bit uniform quantizer, and ,1kO  is the most significant bit (MSB) of kO . 
 54
c  received at the FC, there are lR  bits, which are accumulated from lR  nodes, corresponding 
to the l -th quantized information bit for the estimation of  . Note that the bit transmitted by 
each node can be predetermined based on the resource allocation vector R , so no real-time 
computation is required.  
 
1,1O 1,2O 1,3O 1,lO 1,LO
2,1O 2,2O 2,3O 2,lO 2,LO
1 ,1R
O
1 ,2R
O
1 ,3R
O
1,R l
O
1 ,R L
O
1 1,1R
O  1 1,2RO  1 1,3RO  1 1,R lO  1 1,R LO 
1,1KO  1,2KO  1,3KO  1,K lO  1,K LO 
1O
2O
1R
O
1 1R O
1K O
,1KO ,2KO ,3KO ,K lO ,K LOKO
1 2,1R
O  1 2,2RO  1 2,3RO  1 2,R lO  1 2,R LO 1 2R O
1c
2c
1R
c
1 1R
c 
1Kc 
B
SC
: bits selected for transmission
FCSensor Nodes
: bits received at the FC
1 2R
c 
Kc
 
Fig. 6-2  The mapping between the K -bit codeword and the transmitted bit at each node. 
 
In addition, note that the transmitted codeword c  is not error-free compared with the 
quantization version of the desired parameter  , since the local observation at each node is 
corrupted by observation noise. The codeword c  received at the FC contains the errors present 
in c  as well as those caused by the communication channels. To alleviate the impact of the 
observation noise, we utilize binary-reflected Gray encoding (BRGE) [45], instead of the widely 
used binary encoding (BE), in the quantization and de-quantization processes. Under BRGE, the 
observation vectors of two successive quantization levels only differ by one bit, whereas several 
bits may differ between two neighboring quantization codewords under BE, as shown in Table 
6-1 with 4L  . The attractive one-bit difference property of BRGE is very useful in reducing the 
discrepancy among the observation vectors produced by the quantization process. Moreover, 
using BRGE in the quantization and de-quantization processes does not incur any extra cost, and 
the technique can be applied to any quantization bit length. 
The design of the fusion rule  f   and determination of the resource allocation vector R  
are also critical issues in the proposed schemes. In the following sub-sections, we propose two 
fusion rules and discuss their corresponding resource allocation strategies. 
 
 56
 In the aggregated observation vector ˆ ( )O R , the decision error probability of each 
information bit depends to a large extent on the resource allocated to it. The objective of resource 
optimization is to find the optimal resource allocation vector 1 2, , ,
T
LR R R   R    , subject to the 
total bit constraint 
1
L
ll
R K   , in order to minimize the mean square error (MSE) of AHDE. 
The desired unknown parameter   can be represented as n    , where   denotes the 
quantization version of  , and n  represents the quantization noise. The value of   
corresponds to the value of the L -bit exact observation vector  1 2( ) , , , TL LO O O  O  . 
Since the best performance that can be achieved by AHDE is to perfectly reconstruct the exact 
quantization version of   at the FC, i.e., letting ˆ ( ) O R O , AHDE does not have the ability to 
eliminate noise induced by the quantization process. In other words, AHDE’s best estimation 
performance is  . As a result, the objective of optimizing the resource allocation of AHDE is 
equivalent to minimizing the MSE between ˆ( ) R  and  . Therefore, the optimization of 
resource allocation for AHDE is formulated as follows: 
  2
1
ˆmin ( ( ) )
s.t. 0,
.
l
L
l
l
g E
R
R K
 

   


R
R R
                     (6-9) 
Because the value of 2ˆ( ( ) ) R  cannot be determined easily, we transform 2ˆ( ( ) )E    R  
into an analyzable form for optimization and propose a suboptimal resource allocation (SORA) 
strategy for AHDE. First, we define a Bernoulli random variable  ˆ 0,1l l le O O   , where 
1le   represents that a flip occurs at the l -th bit between ˆ ( )O R  and O , and 0le   
contrarily represents the agreement at the l -th bit. Note that the square error 2ˆ( ( ) ) R  
depends on the flip pattern. Based on the average square error induced by a flip, we simply 
approximate the objective function as  
 
1
( ) 1
L
l l
l
g P e 

   RR ,                          (6-10) 
where  1lP e R  is the average flipping probability of the l -th bit, and l  is the average 
square error caused by the flip of the l -th bit. The optimization problem is then reformulated as 
 58
expression in (6-14). Let r n k   represent the number of failures in n  trials, and let 
1q p   be the failure probability of each trial. Then, we define  ; ,Bf r n q  and  ; ,BF r n q  
as the PDF and the complementary CDF (CCDF) respectively of the binomial distribution of the 
parameters r , n , and q . So long as r nq ,  ; ,BF r n q  is upper-bounded by the summation 
of an infinite geometric series with the ratio  1 r nq rp  , i.e. [40]:  
   ; , ; ,B B rpF r n q f r n q r nq   .                      (6-15) 
Note that (6-15) is equivalent to the CDF of k  and can be rewritten as  
   ; , ; ,B B rpF k n p f k n p r nq  ,                     (6-16) 
where k n r np    since it is assumed that r nq  in the derivation of (6-15). Then, by 
expressing k  in (6-16) as n , where p   is the fraction of successes in n  trials, and 
applying Stirling’s approximation for factorials in  ; ,Bf n n p , we can derive the following 
excellent approximation of  ; ,BF n n p  [46]: 
   
 
   
 11 2; , 1
1 2 1
nH
nn
BF n n p p pp n
    
     ,            (6-17) 
where ( )H   denotes the binary entropy function. According to (6-14), we have 0.5   and 
 1 ( ) 0.5c l   , which is guaranteed in most scenarios. Therefore,  1lP e R  can be 
approximated as 
      
22 1 ( )
1 ( ) 1 ( )
0.5 1 2 ( )
l
l
R
Rc
l c c
l c
l
P e l l
R l
   
       R .              (6-18) 
The average square error l  caused by the flip at the l -th bit is derived as follows. 
Assuming that level q  is the correct quantization level, we denote ,q ld  as the distance, 
measured in the quantization step size  , between the q -th level and the resultant level by 
flipping the l -th quantized information bit. By taking the average over 2L  possible quantization 
levels, we derive the average square error as  
  22 1 ,0 2L Ll q lq d   .                        (6-19) 
Table 6-1 exhibits an example of BRGE and BE with the quantization bit length 4L  , and the 
corresponding distances ,q ld  of BRGE are presented. Because of the symmetry of BRGE 
codewords, the distances ,q ld  of BRGE are also symmetric for different quantization levels. 
 60
the KKT condition (6-28) and satisfy the equality constraint 
1
L
ll
R K   . According to the 
complementary slackness condition in (6-26), we can infer that the multiplier * 0,l l   . From 
(6-28), we have 
         
2 2 2
*1 1 1 1
2 1 2 3 2
2 2ln 2 2 ln 2
2( ) 2( )
l l ll l l
R R RR R R
l l
C l C l C l C l
C l v
R R
            
    
  .     (6-29) 
Through some manipulation, R  can be obtained by solving the following equations: 
      *2 1 21 1 2
1
12 ( ) ln 2 , 1, ,
2
0
ll
RR
l
l
L
ll
vC l R C l l L
R C l
R K


           
  

.          (6-30) 
Specifically, R  is a function of the system parameters K ,  , L , and c . It can be calculated 
based on the system parameters by solving (6-30). In the following, the proposed AHDE based on 
SORA is referred to as HDE-SORA. 
Proposition 1: The objective function of (6-23) is convex with respect to 
 1 2, , , TLR R RR  . Therefore, the suboptimal resource allocation vector R  can be solved via 
some convex optimization approaches. 
Proof: The proof of Proposition 1 is detailed in Appendix. 
 
6.3.  Aggregation Maximum Likelihood Estimator (AMLE) 
To further improve the estimation performance, we incorporate maximum likelihood 
estimation (MLE) [48] in our proposed CIA approach to make the best use of the information 
codeword c  received at the FC. First, for ease of explanation, the formula for the codeword c  
sent collaboratively by all nodes, i.e., (6-5), is rewritten in another form:  
 1 2, , , TLc c c c ,                            (6-31) 
where ,1 ,2 ,, , , l
T
l l l l Rc c c  c    represents the set of lR  bits sent by lR  different nodes, all of 
which correspond to the l -th quantized information bit. Given the desired parameter  , the 
conditional probability mass function (PMF) of lc  can be derived easily as follows: 
      ,, 1
1
1
l
l kl k
R
cc
l l l
k
p q q   

    c ,                    (6-32) 
where  lq   denotes the conditional probability, given  , that the transmitted bit , 1l kc  , 
which is acquired by 
 62
   AMLEˆ( ) arg max .f L   R c c                         (6-40) 
The estimation performance of the AMLE also depends to a large extent on the resource 
allocation vector R . Because (6-40) cannot be expressed in a closed-form, the MSE of AMLE 
can not be derived easily and it is very difficult to discover the optimal resource allocation vector 
for AMLE. To resolve this problem, we propose a suboptimal hybrid resource allocation (SHRA) 
strategy for AMLE. The rationale for SHRA is based on a trade-off between two extreme cases. 
The first case assumes that a sufficiently large number of nodes are available and the 
communication channels are ideal. As a result, the information codeword transmitted 
collaboratively by all nodes is not corrupted by the communication channels, and therefore 
abundant amount of information can be aggregated at the FC. Based on the properties of the 
adopted BRGE, each quantized information bit divides the whole observation range  ,W W  
into multiple segments, and each quantized information bit contributes a different estimation 
resolution in the LLF of  . We use  ,l kL c   to denote the LLF contributed by the bit ,l kc , 
corresponding to the l -th quantized information bit received at the FC for a given  . Fig. 6-3 
shows an example of  ,l kL c   with the system parameters 10W  , 1  , and 4L  . Fig. 
6-3(a) illustrates  ,l kL c   for 1, , 4l    with 0c  . Specifically, the LLF of the MSB (i.e., 
1l  ) has the coarsest estimation resolution, while the LLF of the LSB (i.e., 4l  ) has the finest 
resolution. Moreover, the amount of resource allocated to a specific quantized information bit 
indicates the selectivity of the LLF of that bit. At the FC, the LLFs contributed by all quantized 
information bits are accumulated to resolve the uncertainty caused by the observation noise, as 
shown in (6-38)-(6-39). Since different quantized information bits in AMLE complement each 
other in terms of the information provided, the optimal resource allocation for this case tends to 
distribute the resource bits equally among different quantized information bits.  
On the other hand, the opposite case assumes that only a limited number of nodes are 
available and the communication channel quality is poor. In this case, the information codeword 
transmitted collaboratively by all nodes is degraded by the unreliable communication channels, 
and the amount of information contributed by each quantized information bit is very scarce. As a 
result, the LLF corresponding to each quantized information bit becomes flat and lacks of 
discriminability for different values of  , as shown in Fig. 6-3(b), where it is assumed that 
0.4c  . Therefore, AMLE’s performance is severely degraded, and the gain derived by adopting 
MLE is hardly noticeable, so that the performance of AMLE approaches that of AHDE. 
Consequently, the optimal resource allocation for AMLE in this case tends to follow the 
 64
1 2 1 1 2 2, , , , , ,
T T
L L LR R R R R R R R R          R
        ,             (6-41) 
where lR  and lR  are the numbers of resource bits allocated by ERA and HDE-SORA 
respectively, and both correspond to the l -th quantized information bit. For ERA, it is obvious 
that  1lR K L   for 1, ,l L  ; and for HDE-SORA, lR  can be determined by solving 
(6-30) subject to the modified resource constraint 
1
L
ll
R K    . 
 The resource allocation vector R

 depends completely on the hybrid ratio  . To find the 
optimal hybrid ratio  , the regular testing approach is applied and the value that achieves the 
best MSE performance is adopted as the optimal ratio. Based on  , the resource allocation 
vector R

 for SHRA can be predetermined. Fig. 6-4 shows the result of the optimal hybrid ratio 
  for SHRA. The system parameters are set at 10W  , 0.3   and 6L  ; the BSC 
crossover probability c  varies from 0c   to 0.4c  ; and the number of nodes K  varies 
from 100K   to 1000K  . We find that the optimal hybrid ratio   ranges from 0.2 to 1. The 
ratio is proportional to c , but inversely proportional to K . It can also be seen that the resource 
allocation for SHRA and HDE-SORA is the same when the communication channel quality is 
poor or there are insufficient number of nodes. In the following, the proposed AMLE based on 
SHRA is referred to as MLE-SHRA. 
 
 
Fig. 6-4  The results of regular testing for CIA-MLE with 10W  , 0.3  , and 6L  . 
 
6.4.  Simulation Results 
In the simulations, we evaluate the MSE performances of the proposed CIA schemes based 
on the AHDE and AMLE estimators, designated as CIA-HDE and CIA-MLE respectively. For 
 66
of communication errors, since the MSE caused by the errors in the more significant bits is much 
larger.  
The normalized MSE (NMSE) performance of the CIA schemes with different resource 
allocation policies is shown in Fig. 6-5(b). We observe that ERA outperforms SRA when 
0.28c  , whereas SRA outperforms ERA when 0.28c  . However, HDE-SORA and 
MLE-SHRA, proposed for CIA-HDE and CIA-MLE respectively, outperform both SRA and 
ERA for all c  values. Fig. 6-5(c) compares the NMSE of the CIA schemes, AQ-ML, and 
QBLUE. In an ideal communication channel, i.e., 0c  , the AQ-ML and QBLUE schemes 
perform very well; however, when the communication channel is imperfect, the NMSE 
performance degrades rapidly as c  increases. When 0.01c  , the proposed schemes 
significantly outperform the AQ-ML and QBLUE schemes. Because CIA-MLE applies the ML 
concept, it always outperforms CIA-HDE. Moreover, the latter’s performance is always bounded 
by that of QSE, since it cannot reduce the quantization noise. In contrast, CIA-MLE is not 
bounded by QSE when 0.2c   because of the advantage provided by the ML concept. Note 
that the total numbers of bits transmitted in an observation interval are 300, 300 and 1800 for CIA, 
AQ-ML and QBLUE, respectively. This shows the superiority of the CIA schemes in the aspect 
of energy consumption and communication load.  
 
1 2 3 4 5 6
1 2 3 4 5 6
1 2 3 4 5 6
0  
0.2
0.4
0.6
0
0.2
0.4
0.6
0
0.2
0.4
0.6
SRA
ERA
HDE-SORA
MLE-SHRA
0.05c 
0.25c 
0.4c 
Quantized Information Bit Index l
Fr
ac
tio
n 
of
 A
llo
ca
te
d 
R
es
ou
rc
e
SRA
ERA
HDE-SORA
MLE-SHRA
SRA
ERA
HDE-SORA
MLE-SHRA
 
(a) Comparison of the resources allocated to different quantized information bits. 
 
 68
HDE-SORA and MLE-SHRA are the best resource allocation strategies for the CIA-HDE and 
CIA-MLE schemes respectively. Finally, Fig. 6-6(c) compares the NMSE of the CIA schemes, 
AQ-ML, and QBLUE. We find that CIA-MLE outperforms QSE provided that the number of 
nodes is large enough.  
 
1 2 3 4 5 6
1 2 3 4 5 6
1 2 3 4 5 6
0
0.2
0.4
0.6
0
0.2
0.4
0.6
0
0.2
0.4
0.6
100K 
500K 
1000K 
Quantized Information Bit Index l
Fr
ac
tio
n 
of
 A
llo
ca
te
d 
R
es
ou
rc
e
SRA
ERA
HDE-SORA
MLE-SHRA
SRA
ERA
HDE-SORA
MLE-SHRA
SRA
ERA
HDE-SORA
MLE-SHRA
 
(a) Comparison of the resources allocated to different quantized information bits. 
 
100 200 300 400 500 600 700 800 900 1000
10-4
10-3
10-2
10-1
100
N
M
SE
Sensor Node Number K
HDE-SRA
HDE-ERA
HDE-SORA
MLE-SRA
MLE-ERA
MLE-SHRA
 
(b) Comparison of NMSE for the CIA schemes with different resource allocation policies. 
 70
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4
10-4
10-3
10
-2
10-1
100
101
HDE-SORA-BE
MLE-SHRA-BE
HDE-SORA-BRGE
MLE-SHRA-BRGE
QSE
N
M
SE
BSC Crossover Probability c  
(a) Comparison of NMSE for various c  with 300K  . 
100 200 300 400 500 600 700 800 900 1000
10-4
10-3
10-2
10-1
100
10
1
HDE-SORA-BE
MLE-SHRA-BE
HDE-SORA-BRGE
MLE-SHRA-BRGE
QSE
N
M
SE
Sensor Node Number K  
(b) Comparison of NMSE for various K  with 0.3c  . 
Fig. 6-7  Performance comparison of the BE and BRGE encoding approaches for the CIA schemes with 
10W  , 1   and 4L  . 
 
In a WSN, nodes may die unexpectedly due to the depletion of their energy, which 
inevitably impacts the system’s estimation performance. We therefore examine the flexibility of 
CIA schemes in dealing with the unpredictable death of nodes. Fig. 6-8 shows the impact of node 
death on the NMSE performance. Let   denote the ratio of dead nodes; then the total number 
of nodes that die is K . In the simulation, each node is assigned a bit for transmission according 
to the resource allocation policies, and K  nodes are chosen at random from the K  nodes as 
the dead nodes in order to evaluate the impact of unpredictable node death on the proposed 
schemes. In addition, to ensure the comparison is fair, the number of nodes available for 
estimation in AQ-ML and QBLUE, is also reduced from K  to  1 K . In Fig. 6-8, the system 
 72
6.5.  Summary 
 Under the consideration of observation noise and communication errors, we have proposed 
the CIA schemes to address the distributed estimation problem in WSNs. At each node, a 
multi-bit quantizer is used to quantize the observation signal. However, to minimize the energy 
consumption and communication load, each node forwards only one bit to the FC, thereby 
prolonging the network lifetime. To reduce the codeword discrepancy among different quantized 
observations, BRGE is used as the quantization codeword encoding strategy, instead of the 
widely used BE. We also introduced two estimators and their corresponding fusion rules. The 
AHDE scheme yields an adequate estimation performance with quite low fusion complexity; 
while the AMLE scheme achieves an excellent estimation performance with higher 
computational complexity. Note that no information exchange is required among the nodes 
during the estimation procedure. Furthermore, the arrangement of the bit transmitted by each 
node is also addressed and formulated as a resource allocation problem. Because of the very high 
computational complexity of finding the optimal solution, we designed a suboptimal resource 
allocation strategy called HDE-SORA for CIA-HDE and a suboptimal hybrid resource allocation 
policy called MLE-SHRA for CIA-MLE. Hence, the selection of the quantized information bit 
for transmission at each node can be predetermined, and there is no need for real-time 
calculation. 
The estimation performance of the proposed CIA schemes was investigated under different 
scenarios. The simulation results show that the CIA schemes can handle both observation noise 
and communication errors effectively. Moreover, their estimation performance is superior to that 
of AQ-ML and QBLUE under scenarios with imperfect communication channels. The schemes 
also maintain an excellent estimation performance when some nodes die unexpectedly. In sum, 
the proposed CIA schemes are effective and flexible, and they are suitable for practical 
environments in which there are communication errors and unexpected death of nodes.  
 
6.6.  Appendix: Proof of Proposition 1 
According to (6-25), the first derivative of ( )l lg R , with respect to lR , is derived as  
          
     
2 2 2
1 1 1 1
2 1 2 3 2
2
( )( )
2 ln 2 2 ln 2 2
2
, , ,
l l ll l l
l l
l l
l
R R RR R R
l l
a l b l
g Rg R
R
C l C l C l C l
C l
R R
C l l R l R 
  
           
    
    (6-42) 
 74
7. LDGM Code-Based Cooperative Information Aggregation for Distributed 
Estimation  
In this work, the system model is the same as that considred in Scetion 6.1, as shown in Fig. 
6-1. The CIA scheme is applied as shown in Fig. 6-2. LDGM codes are basically a particular 
instance of LDPC codes, since their sparse generator matrices in systematic form also imply 
sparse parity check matrices. Even if the ability of error correction of LDGM codes is not as 
excellent as that of LDPC codes [35], the former are more fitting for our CIA scheme. The reason 
is twofold: one is that the distance of different codewords generated by LDPC codes is very large 
in general. It is due to the dense generator matrices of LDPC codes which are capable to perform 
close to the Shannon capacity limit as shown by Mackey in [35]; the other is the fact that the 
input of the encoder at each node, i.e. the local quantized observation, is noise-corrupted, and 
which means the information bits forwarded by the nodes are chosen from the codewords 
produced by diverse encoder inputs. That is to say, the presence of the observation noise will 
innately induce large amount of errors in the codeword collaboratively formed by all nodes in 
case of the LDPC code is employed, and lead to ineffective error correction. Therefore, we adopt 
the LDGM code with its satisfactory error correction capability at the nodes and the FC in this 
work. LDGM codes can be decoded by using the Sum Product Algorithm (SPA) as well as LDPC 
codes, and the kernel of LDGM codes is the construction of the low-density generator matrix. 
Generally the advantage of LDGM codes over LDPC codes is the much simpler encoding 
procedure owing to the sparsity of the generator matrix; however, while applying the LDGM 
code in the CIA scheme, the encoding complexity at nodes can be further lessened since the 
encoding operation at each node involves merely the corresponding column vector of the 
generator matrix but not the entire matrix.  
 
7.1.  Design for the Generator Matrix of the LDGM Code 
Denote the CIA scheme applying the LDGM code proposed in this work as the CIA-LDGM 
scheme, and the according generator matrix to be designed as 1 2g gkL K K
   G G G G G 
      , 
where gK

 is the column size of G

 and will be properly determined later. The element in the 
l -th row and the k  -th column of G  is termed ,l kg  . First, to construct G

 in a systematic 
form, i.e.  g gLL K L K L      G I P 
 
, we have  1 2 L L   G G G I    where I  represents an identity 
matrix, and then our focus of design is the parity check part P

 of the generator matrix G

. With 
the systematic form of G

, the parity check matrix used for decoding at the FC is denoted as H

 
 76
the number of systematic bits involved in the generation of a parity check bit and thus have the 
following proposition. 
Proposition 2: In the design of P

, we induce the column weighting constraint that 
,
1
1 2, for 1, ,
L
l k g
l
g k L K

      ; that is to say, maximally two enabled entries are assigned in 
any column of P

. The number of total applicable combinations of the two enabled entries can 
then be derived as 2C
L . With the initialization of P

 explained in Proposition 1, the primarily 
enabled entry in each column of P

 has already been specified, therefore the next step is 
attempting to assign the other enabled entry in the corresponding column.  
Definition 2: The enabled entries of P

 which will be designated below are termed the 
secondarily enabled entries hereafter. 
On the designation of the secondarily enabled entries, two important factors have to be taken 
into account: the first one is the average error probabilities    1 , ,o o L   shown in (9) which 
are caused by the presence of the observation noise. It can be straightforward inferred that 
     1 2o o o L     , i.e. the MSB of the quantized observation is the most reliable, 
whereas the LSB is the least reliable. That is to say, 1,kg 
  is always the most preferable entry to 
be set as the secondarily enabled entry in column k  , yet ,L kg   is the most unfavorable; the 
other factor is the possible formation of the short cycles. In the past literature [35], [49]-[51], the 
existence of the short cycles in the parity check matrix, especially cycles of length 4, was shown 
to prevent the SPA decoding from converging and significantly deteriorate the error correction 
performance. Thus, the presence of the short cycles has to be excluded from the design of the 
parity check matrix. The definition of cycle of length 4 is that two rows or columns have more 
than one “1” in common [51], as diagrammed in Fig. 7-1. In the following, the cycle of length 4 
is abbreviated as the cyele-4 for convenience. In our case, it can be deduced that the formation of 
cycle-4 should be avoided on the construction of P

, since the existence of cycle-4 in P

 of G

 
implies the existence of cycle-4 in TP

 of H

. Based on the aforementioned two factors, we 
induce the following proposition regarding the designation of the secondarily enabled entries in 
P

, and thereby the resultant P

 can be guaranteed to be free from cycle-4. 
 78
combinations and it can be represented as 
       2arg min : Ls ukK k N k C R .                       (7-5) 
sK  can then be discovered via numerical methods. The values of sK  for different scenarios are 
presented in Fig. 7-2 with the system parameters 10W  , 0 ~ 0.3c  , while 0.01   and 
0.05   respectively. It can be observed that generally sK  is getting higher as c  becomes 
larger. In case of K  is large enough to exhaust all the 2C
L  combinations, it is desired to 
segment the K  nodes into several sensor groups to constitute the spatial diversity, and each one 
is with the same group size gK

. All sensor groups then use the identical generator matrix 
gL KG 

, 
and which also implies only one parity check matrix has to be stored at the FC for performing the 
SPA decoding procedure. To be adaptive to the varied number of nodes K , we conclude the 
proper determination of the group size gK

 as the following proposition. 
Proposition 4: Without loss of generality, the determination of the column size gK

 of G

 
in our proposed CIA-LDGM scheme can be expressed as 
 
if 
,
otherwise
g s
s
g s
K K K K
r K K
K K
        

 ,                       (7-6) 
where  , sq K K     is the number of sensor groups, moreover,  ,q a b  and  ,r a b  
represent the quotient and the remainder produced from the operation of dividing a  by b  
respectively.  
 
0 0.05 0.1 0.15 0.2 0.25 0.3
50
100
150
200
250
300
350
400
450
500
550
BSC Crossover Probability c
0.05, 8L  
0.01, 10L  
K s
 
Fig. 7-2  The values of sK  with 10W  , 0 ~ 0.3c   and 0.01   or 0.05. 
 80
system. In the case of gK K 

, then the gK K 

 nodes are regarded as the virtual nodes 
which represent that those nodes actually never exist, and consequently the information bits 
corresponding to the virtual nodes are absent and will be randomly chosen from “0” and “1” at 
the FC for the purpose of codeword decoding. Without loss of generality, the number of virtual 
nodes is denoted as v gK K K 
  and can be derived as  
 
   
,
,
, 0
s
v g s
s
s s s
r K K
K K K K K
r K K
K K K r K K K
             
           

,                 (7-7) 
and  
 
   
,
,
1 ,
s
v g s
s
s s s
r K K
K K K K K
r K K
K K K r K K K
             
              

.          (7-8) 
From (7-7) and (7-8), it can be found that there are 1  virtual nodes in the system at most. By 
equally distributing the virtual nodes to all sensor groups, we can conclude that there are at most 
1  sensor groups each with one virtual node. Regarding the production of the transmitted bit 
kc
  for node k , the rule can be generally expressed as 
   
  
,
, 1
if k
otherwise
g
v g g
k k v gk K
k k k K K K
c K K
c

    
        
O G
O G

 
 
 ,                     (7-9) 
where           , , ,1 , 1 , ,1I Ia b f r a b r a b f r a b b      .  
Let  1 2, , , , ,k Kc c c c    c       denote the information codeword collaboratively constructed 
by all nodes and arrived at the FC after undergoing the BSCs, and k S  denote the set consisted 
of nodes that apply column k G

 of G

 in the generation of their respective transmitted bit. 
Without loss of generality, k S  can be represented as 
1 2
k k k  S S S , and 
    
     
1
2
:1 s.t. ,
: , s.t. , 1
k v g g
k v g v g g
k k K K k K k
k K K k K k K K K k




                   
S
S
 
   .      (7-10) 
Then, we define the vector of log likelihood ratio (LLR) calculated from c  as 
       1 , 2 , , , , gk K      γ   , and  k   is determined by 
 82
however, a fixed significance based strategy for the transmitted bits arrangement is suggested in 
UDES without adapting to the system conditions. In the QBLUE scheme, each node makes a 
local estimation by applying the L -bit probabilistic quantizer, and all the L  bits are forwarded 
to the FC. The number of transmitted bits in QBLUE is L  times that of our CIA scheme. The 
setting of the system parameters throughout our simulation is 10W  , c  ranging from 0 to 0.3, 
and K  ranging from 50 to 300. In order to maintain a sufficient message length of quantization 
to provide an adequate number of row position combinations of the primarily enabled entries and 
the secondarily enabled entries for CIA-LDGM,   is set to 0.01 and 0.05, and which represents 
L  is set to 10 and 8 respectively according to (2).  
Fig. 7-5 compares the MSE performance of the CIA-RPT scheme and the CIA-LDGM 
scheme with the system parameters 10W  , 50 ~ 300K  , 0 ~ 0.3c  , while 0.01   and 
0.05   respectively. Fig. 7-5(a) is the performance of the case that 0.01   and the message 
length of quantization is accordingly set to 10L  . We can observe that for the case of fewer 
number of nodes, say 50K  , CIA-LDGM can considerably outperform CIA-RPT if 0.125c  , 
otherwise CIA-RPT becomes more efficient than CIA-LDGM. However, it can be also noticed 
that the predominant region of CIA-LDGM in terms of c  extends as the increase of K . More 
specifically, CIA-LDGM is shown to perform better than CIA-RPT as long as 0.3c   
providing 300K  . Therefore, CIA-LDGM is shown to more efficiently overcome the poor 
quality of communication channels than CIA-RPT does, providing sufficiently large number of 
nodes, and thereby the effectiveness of the proposed CIA-LDGM scheme is corroborated. Fig. 
7-5(b) compares the CIA-RPT scheme and the CIA-LDGM scheme under a worse observation 
condition, say 0.05  , and the message length of quantization is 8L  . The same 
phenomenon can still be perceived that the achievement of CIA-LDGM under the worse 
condition of communication channels can be enhanced, and the outperformance in comparison 
with CIA-RPT can be retained providing that sufficient number of nodes is available.  
 
 84
larger number of nodes that incurs much more number of short cycles within the parity check 
matrix. The performance of the scenario that 0.05   and 8L   is presented in Fig. 7-6(b), 
where CIA-LDGM is still demonstrated to considerably outperform CIA-LDGM-RDN 
throughout the considered values of K  and c . By comparing Fig. 7-6(a) with Fig. 7-6(b), we 
can perceive that CIA-LDGM-RDN with 0.01   and 0.1c   surprisingly outperform 
CIA-LDGM-RDN with 0.05   and 0.1c   in some values of K . It is owing to that the 
sensor grouping policy elaborated in Proposition 4 results in more sensor groups in the latter than 
that of in the former, which also implies that the latter scenario possesses smaller column size of 
the generator matrix than the former scenario, and therefore reduce the number of short cycles so 
that the impact caused by the presence of short cycles can be lessened.  
10-7
10-6
10-5
10-4
10-3
10-2
10-1
100
101
50 100 150 200 250 300
Sensor Node Number K
N
M
SE
LDGM, 0.1c 
LDGM, 0.2c 
LDGM, 0.3c 
LDGM-RDN, 0.1c 
LDGM-RDN, 0.2c 
LDGM-RDN, 0.3c QSE
 
(a) 0.01  , 10L  . 
50 100 150 200 250 300
Sensor Node Number K
10-5
10-4
10-3
10-2
10-1
100
101
N
M
SE
LDGM, 0.1c 
LDGM, 0.2c 
LDGM, 0.3c 
LDGM-RDN, 0.1c 
LDGM-RDN, 0.2c 
LDGM-RDN, 0.3c QSE
 
(b) 0.05  , 8L  . 
Fig. 7-6  Comparison between the CIA-LDGM scheme and the CIA-LDGM-RDN scheme. The system 
parameters are 10W  , 50 ~ 300K  , and 0.1 ~ 0.3c  . 
 86
bandwidth in the CIA scheme is still preserved, moreover, the capability of information 
protection and error correction collaboratively achieved by all the nodes is enhanced in the 
proposed CIA-LDGM scheme. With the better error correction ability benefited from the 
utilization of the LDGM code, the encoding complexity at the nodes can be still very low thanks 
to the innate distributed message encoding process in the CIA scheme. The design for the sparse 
generator matrix of the LDGM code is discussed and the advised construction is proposed in this 
work. Under the scenarios of adequate observation quality at the nodes that result in sufficient 
message length of quantization, we have shown that the proposed CIA-LDGM scheme can 
indeed considerably outperform the existing CIA-RPT scheme and the other considered 
approaches via the extensive simulation results. Besides, the effectiveness of the suggested 
construction of the generator matrix in the CIA-LDGM scheme is exhibited as well. 
 
 88
9. References 
[1] J. F. Chamberland and V. V. Veeravalli, “Wireless Sensors in Distributed Detection 
Applications,” IEEE Signal Process. Mag., vol. 24, pp. 16–25, May 2007. 
[2] T. Wimalajeewa and S. K. Jayaweera, “Optimal Power Scheduling for Data Fusion in 
Inhomogeneous Wireless Sensor Networks”, in Proc. IEEE Int. conf. on  Advanced Video 
and Signal based Surveillance (AVSS’06), pp. 73–73, Nov. 2006. 
[3] T. Wimalajeewa and S. K. Jayaweera, “PSO for constrained optimization: optimal power 
scheduling for correlated data fusion in wireless sensor networks,” IEEE Personal, Indoor 
and Mobile Radio Comm., pp. 1–5, Sept. 2007. 
[4] X. Zhang, H.V. Poor and M. Chiang, “Power Allocation in Distributed Detection with 
Wireless Sensor Networks,” IEEE Military Communications Conference (MILCOM), pp. 
1–7, Oct. 2006. 
[5] A. Wald, Sequential Analysis, Dover, New York, 1947. 
[6] L. Yu and A. Ephremides. “Detection Performance and Energy Efficiency of Sequential 
Detection in a Sensor Network,” in Proc. of Int. conf. on System Sciences. 
[7] A. Ribeiro and G. B. Giannakis, “Bandwidth-constrained distributed estimation for wireless 
sensor networks - Part I: Gaussian PDF,” IEEE Trans. Signal Process., vol. 54, no. 3, pp. 
1131–1143, Mar. 2006. 
[8] A. Ribeiro and G. B. Giannakis, “Bandwidth-constrained distributed estimation for wireless 
sensor networks - Part II: Unknown probability density function,” IEEE Trans. Signal 
Process., vol. 54, no. 7, pp. 2784–2796, Jul. 2006. 
[9] J. Wu, Q. Huang, and T. Lee, “Minimal energy decentralized estimation via exploiting the 
statistical knowledge of sensor noise variance,” IEEE Trans. Signal Process., vol. 56, no. 5, 
pp. 2171–2176, May 2008. 
[10] J. Wu, Q. Huang, and T. Lee, “Energy-constrained decentralized best-linear-unbiased 
estimation via partial sensor noise variance knowledge,” IEEE Signal Process. Lett., vol. 15, 
pp. 33–36, 2008. 
[11] J.-J. Xiao, S. Cui, Z.-Q. Luo, and A. J. Goldsmith, “Power scheduling of universal 
decentralized estimation in sensor networks,” IEEE Trans. Signal Process., vol. 54, no. 2, pp. 
413–422, Feb. 2006. 
[12] J. Li and G. AlRegib, “Rate-constrained distributed estimation in wireless sensor networks,” 
IEEE Trans. Signal Process., vol. 55, no. 5, pp. 1634–1643, May 2007. 
[13] Z.-Q. Luo, “An isotropic universal decentralized estimation scheme for a bandwidth 
constrained ad hoc sensor network,” IEEE J. Sel. Areas Commun., vol. 23, pp. 735–744, Apr. 
 90
Networks,” IEEE Signal Processing Lett., vol. 15, pp. 533–536, 2008. 
[28] J. Li and G. AlRegib, “Network Lifetime Maximization for Estimation in Multihop Wireless 
Sensor Networks,” IEEE Trans. Signal Process., vol. 57, no. 7, pp. 2456–2466, Jul. 2009. 
[29] H. Li and J. Fang, “Distributed adaptive quantization and estimation for wireless sensor 
networks,” IEEE Signal Processing Lett., vol. 14, no. 10, pp. 669–672, Oct. 2007. 
[30] J. Fang and H. Li, “Distributed adaptive quantization for wireless sensor networks: From 
delta modulation to maximum likelihood,” IEEE Trans. Signal Process., vol. 56, no. 10, pp. 
5246–5257, Oct. 2008. 
[31] Z.-Q. Luo, “An isotropic universal decentralized estimation scheme for a bandwidth 
constrained ad hoc sensor network,” IEEE J. Sel. Areas Commun., vol. 23, pp. 735–744, Apr. 
2005. 
[32] Z. Luo, “Universal decentralized estimation in a bandwidth constrained sensor network,” 
IEEE Trans. Inf. Theory, vol. 51, pp. 2210–2219, Jun. 2005. 
[33] Z.-Q. Luo and J.-J. Xiao, “Decentralized estimation in an inhomogeneous sensing 
environment,” IEEE Trans. Inf. Theory, vol. 51, no. 10, pp. 3564–3575, Oct. 2005. 
[34] R. G. Gallager, Low-Density Parity-Check Codes. Cambridge, MA: MIT Press, 1963. 
[35] D. J. C. MacKay, “Good error-correcting codes based on very sparse matrices,” IEEE Trans. 
Inf. Theory, vol. 45, no. 2, pp. 399-431, 1999. 
[36] G. Ferrari and R. Pagliari, “Decentralized binary detection with noisy communication links,” 
IEEE Trans. on Aerospace and Electronic Systems, vol. 42, no. 4, pp. 1554–1563, Oct. 
2006. 
[37] B. Chen, R. Jiang, T. Kasetkasem, and P. Varshney, “Channel aware decision fusion in 
wireless sensor networks,” IEEE Trans. Signal Process., vol. 52, no. 12, pp. 3454–3458, 
Dec. 2004. 
[38] E. K. P. Chong and S. H. Zak, An Introduction to Optimization, Second Edition, Wiley, 
2001. 
[39] H. Stark and J. W. Woods, Probability and Random Processes with Applications to Signal 
Processing, 3rd ed. Upper Saddle River, NJ: Prentice-Hall, 2002. 
[40] W. Feller, An Introduction to Probability Theory and Its Applications, 2nd ed, New York: 
Wiley, 1971, vol. II. 
[41] H. Stark and J. W. Woods, Probability and Random Processes with Application to Signal 
Processing, 3rd Prentice Hill, 2002. 
[42] H.V. Poor, An Introduction to Signal Detection and Estimation. New York: Springer-Verlag, 
1988. 
 92
10. Self-evaluation 
The major goal of this project is to study the distributed detection/estimation technologies 
for wireless sensor networks in order to reduce energy consumption and improve performance. 
Six techniques, relating to energy efficient distributed detection, distributed multi-source 
estimation and distributed coded distributed estimation, are proposed, which can significantly 
improve the detection/estimation performance and reduce the energy consumption at nodes. 
These research results completely fit in with the proposal of this project. Parts of these outcomes 
have been accepted or submitted to international journals and conferences for publication. 
Currently, four SCI journal papers and four international conference papers have been published. 
Other research outcomes are under preparing for submission. Furthermore, this project has 
trained more than 10 MS students and 4 Ph.D. students.  
 
 94
Ping_f            PIN     8 
 
' -----[ Constants ]------------------------------------------------------- 
 
#SELECT $STAMP 
  #CASE BS2, BS2E 
    Trigger     CON     5                       ' trigger pulse = 10 uS 
    Scale       CON     $200                    ' raw x 2.00 = uS 
  #CASE BS2SX, BS2P, BS2PX 
    Trigger     CON     13 
    Scale       CON     $0CD                    ' raw x 0.80 = uS 
  #CASE BS2PE 
    Trigger     CON     5 
    Scale       CON     $1E1                    ' raw x 1.88 = uS 
#ENDSELECT 
RawToIn         CON     889                     ' 1 / 73.746 (with **) 
IsHigh          CON     1                       ' for PULSOUT 
IsLow           CON     0 
 
' -----[ Variables ]------------------------------------------------------- 
 
rawDist_r         VAR     Word                    ' raw measurement 
inches_r          VAR     Word 
rawDist_l         VAR     Word                    ' raw measurement 
inches_l          VAR     Word 
rawDist_f         VAR     Word                    ' raw measurement 
inches_f          VAR     Word 
counter           VAR     Word 
 
' -----[ EEPROM Data ]----------------------------------------------------- 
 
' -----[ Initialization ]-------------------------------------------------- 
 
FREQOUT 4, 2000, 3000 
'Reset: 
 ' DEBUG CLS,                                            ' setup report screen 
 '       "Time_r (uS).....       ", CR, 
 '       CR, 
 '       CR, 
 96
'      GOSUB Right_Correction 
'    ELSEIF (inches_l - inches_r > 2 AND inches_l - inches_r < 7  ) THEN 
'      GOSUB Left_Correction 
'    ELSE 
'      GOSUB Forward 
'    ENDIF 
'  DEBUG SDEC inches_f, CR, 
'        SDEC inches_r, CR, 
'        SDEC inches_l, CR,CR 
'    DEBUG CRSRXY, 15, 3,                        ' update report screen 
'          DEC rawDist_r, CLREOL, 
'          CRSRXY, 15, 4, 
'          DEC inches_r, CLREOL, 
'          CRSRXY, 15, 5,                        ' update report screen 
'          DEC rawDist_l, CLREOL, 
'          CRSRXY, 15, 6, 
'          DEC inches_l, CLREOL, 
       'PAUSE 50 
  LOOP 
  END 
 
' -----[ Subroutines ]----------------------------------------------------- 
 
' This subroutine triggers the Ping sonar sensor and measures 
' the echo pulse.  The raw value from the sensor is converted to 
' microseconds based on the Stamp module in use.  This value is 
' divided by two to remove the return trip -- the result value is 
' the distance from the sensor to the target in microseconds. 
 
Get_Sonar: 
  'Right 
  Ping_r = IsLow                                  ' make trigger 0-1-0 
  PULSOUT Ping_r, Trigger                         ' activate sensor 
  PULSIN  Ping_r, IsHigh, rawDist_r                 ' measure echo pulse 
  rawDist_r = rawDist_r */ Scale                    ' convert to uS 
  rawDist_r = rawDist_r / 2                         ' remove return trip 
  'Left 
  Ping_l = IsLow                                  ' make trigger 0-1-0 
  PULSOUT Ping_l, Trigger                         ' activate sensor 
 98
'  FOR counter = 1 TO 32    'back 
'  PULSOUT 13, 650 
'  PULSOUT 12, 850 
'  PAUSE 20 
'  NEXT 
'  FOR counter = 1 TO 22    'right 
'  PULSOUT 13, 850 
'  PULSOUT 12, 850 
' PAUSE 20 
'  NEXT 
'  FOR counter = 1 TO 32    'forward 
'  PULSOUT 13, 850 
'  PULSOUT 12, 650 
'  PAUSE 20 
'  NEXT 
' RETURN 
Turn_Left: 
'  FOR counter = 1 TO 20    'back 
'  PULSOUT 13, 650 
'  PULSOUT 12, 850 
'  PAUSE 20 
'  NEXT 
  DEBUG "l" ,CR, LF 
  FOR counter = 1 TO 22    'left 
  PULSOUT 13, 650 
  PULSOUT 12, 650 
  PAUSE 20 
  NEXT 
  FOR counter = 1 TO 20    'forward 
  PULSOUT 13, 850 
  PULSOUT 12, 650 
  PAUSE 20 
  NEXT 
  RETURN 
Forward_Turn_Right: 
  DEBUG "r" ,CR, LF 
  FOR counter = 1 TO 40    'forward 
  PULSOUT 13, 850 
  PULSOUT 12, 650 
 100
  PULSOUT 13, 850 
  PULSOUT 12, 850 
  PAUSE 20 
  NEXT 
  RETURN 
===================================================================== 
===================================================================== 
Data Collection Unit  
===================================================================== 
Matlab Codes 
===================================================================== 
%Original Rout 
 
clear all; 
clc; 
  
SSS=instrfind; 
if (isempty(SSS) ~= 1) 
    fclose(SSS); 
    delete(SSS); 
    clear SSS; 
    clear all; 
end 
  
StepNum = 1; 
X(1) = 0; 
Y(1) = 0; 
Direction = 'N'; 
fid = fopen('C:\tst.txt', 'r'); 
  
while (1) 
    C = fscanf(fid,'%c', 1); 
        switch (C) 
            case 'r' 
                C 
                StepNum = StepNum + 1; 
                switch (Direction) 
                    case 'N' 
                         X(StepNum) = X(StepNum - 1) + 0.01; 
                         Y(StepNum) = Y(StepNum - 1); 
                        Direction = 'E'; 
 102
                        Direction = 'N';   
                        plot(X,Y, '-o'); 
                end 
            case 'i' 
                C 
                StepNum = StepNum + 1; 
                switch (Direction) 
                    case 'N' 
                         X(StepNum) = X(StepNum - 1); 
                         Y(StepNum) = Y(StepNum - 1) -0.01; 
                        Direction = 'S'; 
                        plot(X,Y, '-o'); 
                    case 'S' 
                         X(StepNum) = X(StepNum - 1); 
                         Y(StepNum) = Y(StepNum - 1) +0.01; 
                        Direction = 'N'; 
                        plot(X,Y, '-o'); 
                    case 'W' 
                         X(StepNum) = X(StepNum - 1) + 0.01; 
                         Y(StepNum) = Y(StepNum - 1); 
                        Direction = 'E'; 
                        plot(X,Y, '-o'); 
                    case 'E' 
                         X(StepNum) = X(StepNum - 1) - 0.01; 
                         Y(StepNum) = Y(StepNum - 1); 
                        Direction = 'W'; 
                        plot(X,Y, '-o'); 
                end 
            otherwise 
                StepNum = StepNum + 1; 
                switch (Direction) 
                    case 'N' 
                        X(StepNum) = X(StepNum - 1); 
                        Y(StepNum) = Y(StepNum - 1) + 0.1; 
                        plot(X,Y, '-o'); 
                    case 'S' 
                        X(StepNum) = X(StepNum - 1); 
                        Y(StepNum) = Y(StepNum - 1) - 0.1; 
                        plot(X,Y, '-o'); 
 104
手控車 (Wireless Gesture-controlled Car) 
===================================================================== 
Remote Unit 
===================================================================== 
BS2 Codes 
 
' {$STAMP BS2} ' Stamp directive. 
' {$PBASIC 2.5} ' PBASIC directive. 
' -----[ Variables ]---------------------------------------------------------- 
LED          PIN       15 
pulseCount   VAR       Word                    ' Stores number of pulses. 
instruction  VAR       Byte 
LedToggle    VAR       Byte 
' -----[ Initialization ]----------------------------------------------------- 
FREQOUT 4, 2000, 3000 ' Signal program start/reset. 
' -----[ Main Routine ]------------------------------------------------------- 
LedToggle=0 
 
INPUT 7                                        ' assign 3 input to receive 
INPUT 8                                        ' serial signal from zigbee 
INPUT 9 
 
Main: 
IF (IN7=0) AND (IN8=0) AND (IN9=1) THEN        'if the input matches the state 
instruction="L"                                'do the assigned instruction 
ELSEIF (IN7=0) AND (IN8=1) AND (IN9=0) THEN 
instruction="R" 
ELSEIF (IN7=0) AND (IN8=1) AND (IN9=1) THEN 
instruction="A" 
ELSEIF (IN7=1) AND (IN8=0) AND (IN9=0) THEN 
instruction="B" 
ELSEIF (IN7=1) AND (IN8=0) AND (IN9=1) THEN 
instruction="V" 
ELSEIF (IN7=1) AND (IN8=1) AND (IN9=0) THEN 
instruction="W" 
ELSEIF (IN7=1) AND (IN8=1) AND (IN9=1) THEN 
instruction="E" 
ENDIF 
 
IF (LEDToggle=0)  THEN                         'when the input triggers 
HIGH LED                                       'shimmering the LED 
 106
FOR pulseCount = 1 TO 1 
PULSOUT 13, 730                                'send 1.46ms pulse to pin 13 
PULSOUT 12, 770                                'send 1.54ms pulse to pin 12 
NEXT 
RETURN 
' -----[ Subroutine - Backward ]---------------------------------------------- 
BackwardA: 
FOR pulseCount = 1 TO 40                       'loop 40times 
PULSOUT 13, 850                                'send 1.7ms pulse to pin 13 
PULSOUT 12, 650                                'send 1.3ms pulse to pin 12 
NEXT 
RETURN 
 
BackwardB: 
FOR pulseCount = 1 TO 1 
PULSOUT 13, 770                                'send 1.54ms pulse to pin 13 
PULSOUT 12, 730                                'send 1.46ms pulse to pin 12 
NEXT 
RETURN 
' -----[ Subroutine - Left_Turn ]--------------------------------------------- 
Left_Turn: 
FOR pulseCount = 1 TO 40                       'loop 40times 
PULSOUT 13, 800                                'send 1.6ms pulse to pin 13 
PULSOUT 12, 800                                'send 1.6ms pulse to pin 12 
NEXT 
RETURN 
' -----[ Subroutine ¡V Right_Turn ]-------------------------------------------- 
Right_Turn: 
FOR pulseCount = 1 TO 40                       'loop 40times 
PULSOUT 13, 700                                'send 1.4ms pulse to pin 13 
PULSOUT 12, 700                                'send 1.4ms pulse to pin 12 
NEXT 
RETURN 
 
===================================================================== 
Control Unit 
===================================================================== 
BS2 Codes 
 
'   {$STAMP BS2} 
'   {$PBASIC 2.5} 
 108
    FOR axis = XAxis TO ZAxis 
    GOSUB Get_H48C 
 
    dValue = rvCount                            ' display vRef count 
    dValue = axCount                            ' display axis count 
    mVolts = rvCount ** Cnt2Mv                  ' convert vref to mv 
    mVolts = axCount ** Cnt2Mv                  ' convert axis to mv 
 
    IF (axCount >= rvCount) THEN 
      gForce = (axCount - rvCount) ** GfCnv     ' positive g-force 
    ELSE 
      gForce = -((rvCount - axCount) ** GfCnv)  ' negative g-force 
    ENDIF 
    IF ((ABS(gForce) > 80)) THEN                'if abs value of g force>0.8g 
      IF (axis = 2) THEN                        'and if axis = z 
        IF (axCount < rvCount) THEN             'and if g force is negative 
          SELECT rawForce                       'detect the bending sensor 
 
          CASE 6000 TO 9000 :                 'If the discharge time is between 
                                                'the range of 20000us to 32000us 
          temp="W"                              'then change the temp to sign "W" 
          IF NOT(temp=state) THEN               'If the state is different from temp 
          state="W" 
          SEROUT 16,16468,["W"]                 'then send out sign "W" to zigbee 
          ENDIF 
 
          CASE 9000 TO 25000 :                 'If the discharge time if in range 
          temp="V" 
          IF NOT(temp=state) THEN 
          state="V" 
          SEROUT 16,16468,["V"]                 'send out "V" if different from temp 
          ENDIF 
 
          CASE 0 TO 6000 :                     'If the discharge time if in range 
          temp="E" 
          IF NOT(temp=state) THEN 
          state="E" 
          SEROUT 16,16468,["E"]                 'send out "E" if different from temp 
          ENDIF 
 110
        ENDIF 
      ENDIF 
    ENDIF 
 
  NEXT 
  PAUSE 10                                      ' wait for 10ms 
  GOTO Main                                      ' loop again 
 
' -----[ Subroutines ]----------------------------------------------------- 
Get_H48C: 
  LOW CS 
  SHIFTOUT Dio, Clk, MSBFIRST, [%11\2, VRef\3]  ' select vref register 
  SHIFTIN  Dio, Clk, MSBPOST, [rvCount\13]      ' read ref voltage counts 
  HIGH CS 
  PAUSE 1 
  LOW CS 
  SHIFTOUT Dio, Clk, MSBFIRST, [%11\2, axis\3]  ' select axis 
  SHIFTIN  Dio, Clk, MSBPOST, [axCount\13]      ' read axis voltage counts 
  HIGH CS 
  RETURN 
' ------------------------------------------------------------------------- 
==================================================================== 
 
IEEE SIGNAL PROCESSING LETTERS, VOL. 17, NO. 1, JANUARY 2010 99
Sequential Fusion for Distributed Detection
Over BSC Channels in an Inhomogeneous
Sensing Environment
Yuh-Ren Tsai, Member, IEEE, and Li-Cheng Lin, Student Member, IEEE
Abstract—In this work, we propose a sequential fusion scheme
for distributed detection in an inhomogeneous sensing environ-
ment. More specifically, the transmissions of sensors are ordered
according to the observation quality and the communication
channel quality to reduce energy consumption in wireless sensor
networks. We devise the corresponding stopping and decision
rules, as well as two transmission ordering rules, based on the
log-likelihood ratio and mutual information, respectively. The
simulation results demonstrate that the proposed scheme can
reduce the required number of transmissions substantially, while
achieving the same detection performance as the conventional
maximum a posteriori probability fusion scheme.
Index Terms—Distributed detection, sequential fusion, wireless
sensor network (WSN).
I. INTRODUCTION
O NE of the important applications in wireless sensor net-works (WSNs) is event detection, where spatially dis-
tributed sensors are deployed over the sensing area to test some
statistical hypotheses. For example, a WSN can be used for
fire detection with the observation signal being the temperature,
or for intrusion detection with the observation signal being the
sound level. Each sensor collects data about the event of interest
and transmits its observation or local decision to a fusion center
(FC) through the communication channel. The FC then makes a
final decision based on the data received from sensors, and trig-
gers an appropriate action. Sensors are small, low-cost compo-
nents that are typically subject to a stringent energy constraint;
hence, energy conservation is a crucial issue in WSNs. Since the
energy consumption of sensing and data processing is generally
much less than that of message transmission [1], minimizing
the number of transmissions can save a significant amount of
energy and thereby prolongs the network lifetime. In [2], [3],
the sensors’ transmissions are ordered according to the infor-
mativeness of the observations, and the corresponding stopping
and decision rules are proposed to reduce energy consumption.
However, those works assume that there is a perfect commu-
nication channel between the sensors and the FC, ignoring the
Manuscript received August 06, 2009; revised September 14, 2009. First pub-
lished October 16, 2009; current version published November 04, 2009. This
work was supported in part by the National Science Council of Taiwan under
Grant NSC 97-2221-E-007-074-MY3. The associate editor coordinating the re-
view of this manuscript and approving it for publication was Dr. Tan F. Wang.
The authors are with the Institute of Communications Engineering, National
Tsing Hua University, Hsinchu, 300 Taiwan (e-mail: yrtsai@ee.nthu.edu.tw;
d939606@oz.nthu.edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/LSP.2009.2034552
transmission error that is intrinsic to wireless communications.
Furthermore, they only consider a homogeneous sensing envi-
ronment in which all sensors are perturbed by the same level of
observation noise.
In this work, we propose a novel sequential fusion scheme for
distributed detection that considers both the observation quality
and communication quality under an inhomogeneous sensing
environment [4], in which the sensors experience different levels
of observation noise. The communication channel is assumed to
be a binary symmetric channel (BSC) with limited bandwidth.
To facilitate sequential fusion at the FC, we devise new stop-
ping and decision rules, and propose two transmission ordering
rules based on the log-likelihood ratio (LLR) and mutual infor-
mation (MI), respectively. Our proposed scheme bases solely
on the channel statistics, i.e., the observation signal-to-noise
ratios (SNRs) and the channel crossover probabilities. Hence,
the transmission order can be determined and scheduled ap-
propriately after the network’s deployment. We prove that the
proposed scheme requires a smaller number of transmissions,
but can still attain the same detection performance as the con-
ventional maximum a posteriori probability (MAP) scheme in
which all sensors forward their messages to the FC. The results
of simulations demonstrate that the MI-based rule outperforms
the LLR-based rule in terms of the average number of trans-
missions for the case with unequal prior probabilities of the hy-
potheses.
The remainder of this paper is organized as follows. The
system model is presented in Section II. In Section III, we
propose our sequential fusion scheme for distributed detection.
We discuss the simulation results in Section IV, and summarize
our conclusion in Section V.
II. SYSTEM MODEL
Consider a WSN with sensors, denoted by for
, deployed to test two hypotheses, (event present) and
(event absent), whose prior probabilities are
and respectively. Each sensor collects a noisy
observation described by
,
,
where and are known constants and . The obser-
vation noises , for , are assumed to be indepen-
dent Gaussian random variables with zero mean and variance
. Hence, the probability distribution function of the observa-
tion under hypothesis can be represented by
, where . The SNR of the observation signal
is defined as [5].
To reduce the complexity and the communication load on the
network, each sensor sends a quantized message, that maps the
observation to a finite alphabet, to the FC via the communication
1070-9908/$26.00 © 2009 IEEE
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 03:29 from IEEE Xplore.  Restrictions apply. 
TSAI AND LIN: SEQUENTIAL FUSION FOR DISTRIBUTED DETECTION OVER BSC CHANNELS 101
Fig. 1. Example of the stopping and decision rules.
Because , we have . Moreover, from
(2) and the identity , we have
where the inequality holds due to the fact that the Q-function
is a strictly decreasing function and . Hence, we have
and
. In other words, the LLR of the decoded message
is always non-negative, i.e., . Similarly, it
can be proved that the LLR of the decoded message is
always non-positive, i.e., .
The transmission process is terminated if the detection deci-
sion will not be changed even if all the remaining mes-
sages disagree with the current-state decision. Hence, if
and , we have
(11)
where the first inequality holds due to the fact that
and . Similarly, if and
, we have
(12)
From (11) and (12), we conclude that the final decision made by
our proposed sequential fusion scheme is the same as that made
by (3), i.e., its detection performance is equivalent to that of the
conventional MAP scheme.
So far, we have not specified any rules for deciding the trans-
mission order. By applying the proposed stopping and decision
rules, however, the average number of transmissions can be re-
duced to below the maximum value , even if the local mes-
sages are transmitted in a random order. To achieve the max-
imum power saving, the transmission order should be well de-
signed and should consider the reliability of the decoded mes-
sages because the environment is inhomogeneous. Thus, in the
following subsections we propose two rules for determining the
transmission order of sensors.
B. LLR-Based Transmission Rule
Since the likelihood ratio test is applied at the FC, the sensors
that can contribute a large LLR should transmit their observation
messages earlier than those which can only contribute a small
LLR. However, before the FC receives an observation message,
Fig. 2. Detection error probability versus the total number of sensors with    
 and    .
it is not aware of the corresponding LLR contributed to the de-
cision rule. Therefore, based on the local observation SNR and
the communication channel quality, we define the LLR-based
metric as
(13)
which is the expected absolute value of the LLR. The probabil-
ities of and are given by
(14)
and
(15)
respectively. Equations (6), (7), (14), and (15) can be used to
evaluate the LLR-based metric defined in (13). Then, the mes-
sages are transmitted in a descending order according to the
LLR-based metric.
C. Mutual Information-Based Transmission Rule
In the considered binary hypothesis testing problem, multiple
binary random variables received at the FC are used to make the
final decision. Since MI is a measure of the amount of informa-
tion that one random variable contains about another random
variable, it can be used as a metric to decide the transmission
order that makes more valuable information to be accumulated
as quickly as possible. In this work, the desired binary random
variable is . Considering that the binary random
variable , corresponding to node , is received
at the FC. Then, the MI between and can be defined as
follows [7]:
(16)
The MI measures how much the uncertainty about
can be reduced by knowing . The probabilities and
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 03:29 from IEEE Xplore.  Restrictions apply. 
IEEE COMMUNICATIONS LETTERS, VOL. 14, NO. 10, OCTOBER 2010 945
Optimal Power Allocation for Decode-and-Forward Cooperative Diversity
Under an Outage Performance Constraint
Yuh-Ren Tsai, Member, IEEE, and Li-Cheng Lin, Student Member, IEEE
Abstract—In this work, we study the problem of optimal power
allocation for decode-and-forward cooperative communications.
From the perspective of service quality, rather than minimize
the outage probability as much as possible, our goal is to
use the minimum power to maintain the outage performance
below a specific threshold and thereby conserve the power/energy
resource. We investigate two scenarios, a system with diversity
and a system without diversity, and propose efficient schemes
for finding the optimal power allocation under an outage perfor-
mance constraint.
Index Terms—Cooperative diversity; power allocation; decode-
and-forward; outage probability.
I. INTRODUCTION
IN mobile radio environments, the received signal suffersfrom propagation loss, shadowing effects and fast multipath
fading effects. Multipath fading may lead to large variations
in the received signal power in a short period, and thus
have a strong impact on the decoded performance and system
throughput. Diversity combining is an efficient technique that
can mitigate the performance degradation caused by multipath
fading. By exploiting the broadcast nature of the wireless
medium, cooperative diversity is a promising technique that
can achieve space diversity. Under the decode-and-forward
cooperative diversity approach [1], the information transmitted
from a source to a destination is also received by a relay node.
After successfully decoding the signal, the relay node forwards
the same information as a diversity duplicate to the destination.
Since power is a scarce radio resource, the strategy used
to allocate power between the source and the relay nodes
has attracted a considerable amount of attention in recent
years [2]-[4]. Most works in the literature focus on finding
the power allocation that minimizes the outage probability
subject to a total power constraint. In this study, we consider
the problem from a different perspective. In terms of service
quality, instead of minimizing the outage probability as much
as possible, our goal is to minimize the power required to
maintain the outage performance below a specific threshold
and thereby conserve the power/energy resource. To the best
of our knowledge, no previous studies have proposed an
optimal/minimum power allocation strategy to achieve the
desired outage performance.
In this work, we assume that instantaneous channel gains
follow the Rayleigh distribution. However, in practice, the
Manuscript received March 5, 2010. The associate editor coordinating the
review of this letter and approving it for publication was A. Sprintson.
This work was supported in part by the National Science Council, Taiwan,
R.O.C., under Grant NSC 97-2221-E-007-074-MY3.
The authors are with the Institute of Communications Engineering,
National Tsing Hua University, Hsinchu 30013, Taiwan (e-mail: yrt-
sai@ee.nthu.edu.tw).
Digital Object Identifier 10.1109/LCOMM.2010.091010.100361
s
r
dPs
Pr
msd
msr mrd
ρs
ρr s
r
dPs
Pr
msr mrd
ρr
System with diversity System without diversity
Source
Destination
Relay
Fig. 1. System model for cooperative communications.
instantaneous channel state information (CSI) of all channels
may not be available to determine the optimal/minimum power
allocation, so we assume that only the mean channel gains are
available. Under this assumption, we derive the solution for
optimal/minimum power allocation to attain a specific outage
probability.
II. SYSTEM MODEL AND PROBLEM FORMULATION
Our system model is shown in Fig. 1. We investigate
two scenarios, a system with diversity and a system without
diversity, using the fixed relaying cooperative diversity pro-
tocol proposed in [1]. Under the protocol, the source node
𝑠 transmits the information to the destination 𝑑; then the
relay node 𝑟, operating in the half-duplex mode, cooperates to
forward the information by the decode-and-forward approach.
Let ℎ𝑠𝑑 , ℎ𝑠𝑟 and ℎ𝑟𝑑 denote, respectively, the instantaneous
channel gains of the 𝑠 − 𝑑, 𝑠− 𝑟 and 𝑟 − 𝑑 links, which are
Rayleigh distributed random variables. Correspondingly, the
normalized power gains of the channels, which are normalized
to the received noise power, are exponentially distributed
random variables whose means are assumed to be 𝑚𝑠𝑑, 𝑚𝑠𝑟
and 𝑚𝑟𝑑. We assume that only the means of the power gains
are available to the optimization of power allocation. Under
the cooperative protocol, we denote the power allocated to 𝑠
and 𝑟 as 𝑃𝑠 and 𝑃𝑟 respectively.
The objective is to minimize the total power consumption
subject to the outage probability constraint 𝜌𝑡ℎ at the desti-
nation. Because of the fading effect, an outage occurs at a
receiver when the received signal-to-noise power ratio (SNR)
is below a threshold 𝛾𝑡ℎ. For the direct transmission link 𝑠−𝑑,
the average received SNR is ¯𝑠𝑑 = 𝑃𝑠𝑚𝑠𝑑 and the outage
probability is expressed as
𝜌𝑠(𝑃𝑠) = Pr(𝛾𝑠𝑑 < 𝛾𝑡ℎ) = 1− exp(−𝛾𝑡ℎ/¯𝑠𝑑), (1)
where 𝛾𝑠𝑑 is the instantaneous SNR of link 𝑠 − 𝑑 and Pr(⋅)
is the probability function. Similarly, for a relay packet to be
decoded successfully at the destination, the two transmissions
through the concatenate links 𝑠 − 𝑟 and 𝑟 − 𝑑 must be
successful. The outage probability of the relay transmission
path is expressed as follows:
𝜌𝑟(𝑃𝑠, 𝑃𝑟) = 1− exp [−𝛾𝑡ℎ(1/¯𝑠𝑟 + 1/¯𝑟𝑑)] , (2)
1089-7798/10$25.00 c⃝ 2010 IEEE
TSAI and LIN: OPTIMAL POWER ALLOCATION FOR DECODE-AND-FORWARD COOPERATIVE DIVERSITY UNDER AN OUTAGE PERFORMANCE . . . 947
T
he
 tr
an
sm
is
si
on
 p
ow
er
 o
f 
th
e 
re
la
y 
no
de
 P
r
The transmission power of the source node Ps
Eq. (9)
Eq. (8)
0 5 10 15 20 25 30 35 40
0
5
10
15
20
25
30
35
40
Eq. (8) – case I
Eq. (8) – case II
ρth = 0.05ρth = 0.1
Eq. (9) – case I
Eq. (9) – case II
optimal power allocation
obtained by (10) and (14) 
Fig. 2. Determination of the optimal power allocation for the system with
diversity under the outage probability threshold 𝜌𝑡ℎ = 0.1 or 0.05.
It is also straightforward to show that the inequality constraint
is active, i.e., 𝜌′(𝑃 ∗𝑠 , 𝑃
∗
𝑟 ) − 𝜌𝑡ℎ = 0. Based on the outage
probability constraint, the relation between 𝑃𝑠 and 𝑃𝑟 is
𝑃𝑟 =
−𝛾𝑡ℎ/𝑚𝑟𝑑
𝛾𝑡ℎ/𝑃𝑠𝑚𝑠𝑟 + ln (1− 𝜌𝑡ℎ) . (16)
Similarly, to minimize the total transmission power, we dif-
ferentiate 𝑃𝑠 + 𝑃𝑟 with respect to 𝑃𝑠 and set the result equal
to zero. Therefore, we have
−𝑚𝑠𝑟/𝑚𝑟𝑑
[1 + 𝑃 ∗𝑠𝑚𝑠𝑟 ln (1− 𝜌𝑡ℎ)/𝛾𝑡ℎ]2
+ 1 = 0. (17)
Note that (10) and (14) degenerate to (16) and (17), respec-
tively, when 𝑚𝑠𝑑 = 0, i.e., when the direct transmission
link 𝑠 − 𝑑 does not exist. Solving (17) for 𝑃 ∗𝑠 , under the
constraint that 𝑃 ∗𝑠 must be always positive, we derive the
feasible solution of the optimal transmission power 𝑃 ∗𝑠 as
𝑃 ∗𝑠 = −𝛾𝑡ℎ
(√
𝑚𝑠𝑟/𝑚𝑟𝑑 + 1
)/
[𝑚𝑠𝑟 ln (1− 𝜌𝑡ℎ)]. (18)
Correspondingly, substituting (18) into (16), the optimal trans-
mission power 𝑃 ∗𝑟 is
𝑃 ∗𝑟 = −𝛾𝑡ℎ
(√
𝑚𝑟𝑑/𝑚𝑠𝑟 + 1
)/
[𝑚𝑟𝑑 ln (1− 𝜌𝑡ℎ)]. (19)
IV. NUMERICAL RESULTS
Figure 2 shows the optimal power allocation for the system
with diversity, where the outage probability threshold 𝜌𝑡ℎ =
0.1 or 0.05. We investigate two cases. It is assumed that the
corresponding mean power gains are 𝑚𝑠𝑑 = 1, 𝑚𝑠𝑟 = 5 and
𝑚𝑟𝑑 = 0.5 in Case I; and 𝑚𝑠𝑑 = 1, 𝑚𝑠𝑟 = 5 and 𝑚𝑟𝑑 = 10
in Case II. The SNR threshold is set as 𝛾𝑡ℎ = 5dB for both
cases. We evaluate the results of (8) and (9) and determine the
optimal power allocation (𝑃 ∗𝑠 , 𝑃
∗
𝑟 ) by finding the intersection
of the two lines representing (8) and (9). The optimal power
allocation (𝑃 ∗𝑠 , 𝑃 ∗𝑟 ) can also be obtained by using (10) and
(14) in order to reduce the computational complexity. We
find that the two approaches yield the same optimal power
allocation result.
Figure 3 shows the optimal transmission power versus the
outage threshold 𝜌𝑡ℎ. The desired outage probability thresh-
old varies from 10−3 to 0.5. When the outage probability
constraint is relaxed, the transmission power requirement
O
pt
im
al
 tr
an
sm
is
si
on
 p
ow
er
Outage probability threshold ρth
Non-cooperation
region
103
102
101
1
10-3 10-2 10-1 1
103
102
101
1
10-3 10-2 10-1 1
System with Diversity System without Diversity
Required power for
direct transmission
case I
case II 
Ps + Pr* *
Ps
*
Pr
*
case I
case II 
Ps + Pr* *
Ps
*
Pr
*
Fig. 3. Optimal transmission power versus the outage probability threshold
𝜌𝑡ℎ.
is reduced significantly. Moreover, the transmission power
required in Case I is much greater than that in Case II because
a worse channel condition is applied in Case I. Note that, in the
system with diversity, there is no cooperation in Case I when
𝜌𝑡ℎ approaches 1. This is because the channel condition on the
relay transmission path is poor; thus, the relay transmission
yields no diversity gain under a large 𝜌𝑡ℎ.
V. CONCLUSION
In contrast to previous works, which try to solve the
power allocation problem by minimizing the outage prob-
ability subject to a total power constraint, we propose an
optimal/minimum power allocation strategy for decode-and-
forward cooperative diversity under an outage performance
constraint. For the system with diversity, conventional convex
optimization techniques cannot be used because the formu-
lated constrained optimization problem is not convex. Hence,
we present an efficient method that exploits the relation
between the power allocations of the source and relay nodes
to reduce the computational complexity. On the other hand,
for the system without diversity, closed-form expressions are
derived for efficient evaluation of the optimal power allocation.
ACKNOWLEDGEMENT
The authors would like to thank the anonymous reviewers
for their valuable comments and suggestions.
REFERENCES
[1] J. N. Laneman, D. N. C. Tse, and G. W. Wornell, “Cooperative diversity
in wireless networks: efficient protocols and outage behavior,” IEEE
Trans. Inf. Theory, vol. 50, no. 12, pp. 3062-3080, Dec. 2004.
[2] M. O. Hasna and M.-S. Alouini, “Optimal power allocation for relayed
transmissions over Rayleigh fading channels,” IEEE Trans. Wireless
Commun., vol. 3, no. 6, pp. 1999-2004, Nov. 2004.
[3] J. Luo, R. S. Blum, L. J. Cimini, L. J. Greenstein, and A. M. Haimovich,
“Power allocation in a transmit diversity system with mean channel gain
information,” IEEE Commun. Lett., vol. 9, no. 7, pp. 616-618, July 2005.
[4] J. Luo, R. S. Blum, L. J. Cimini, L. J. Greenstein, and A. M. Haimovich,
“Decode-and-forward cooperative diversity with power allocation in
wireless networks,” IEEE Trans. Wireless Commun., vol. 6, no. 3, pp.
793-799, Mar. 2007.
[5] A. Neumaier, Introduction to Numerical Analysis. Cambridge Univ.
Press, Cambridge, 2001.
CHEN and TSAI: LOCATION PRIVACY IN UNATTENDED WIRELESS SENSOR NETWORKS UPON THE REQUIREMENT OF DATA SURVIVABILITY 1481
messages corresponding to the event source. Kamat et al.
also proposed the phantom routing protocol, which adopts
the concepts of random walks and flooding routing [5], to
resist against the adversary. In [6], by utilizing path diver-
sity and fake packet injection to mislead adversaries, Jian
et al. proposed the location privacy routing (LPR) protocol
to protect the location of a receiver, such as the location
of a soldier that collects data by portable devices. In [7],
Mehta et al. discussed location privacy under the situation
that adversaries have enough power to eavesdrop on all the
data diffusing in the entire network, coining the term “global
eavesdroppers.” Mehta et al. proposed periodic collection and
source simulation to throw off such global eavesdroppers. In
[8], Shao et al. investigated the scenario that an adversary
randomly compromises sensors and then records the pre-
distributed key materials in them. As a result, the adversary
can identify the location of a desired source node by checking
if the compromised detection node has stored the same key
material.
In this work, we focus on the issue of location privacy when
data replication is utilized for increasing data survivability
in an UWSN. We consider a new kind of adversary that
attempts to find out the location of a critical node according
to the locations where data replicas are stored. Although the
strategy of data replication can improve the data survivability
in UWSNs, the increase in the number of data replicas may
degrade the location privacy of the critical nodes, thereby
impacting the data collection performance of the system.
Hence, the trade-off between data survivability and location
privacy is essential and worthy to study. Specifically, we make
the following contributions in this work:
1) We investigate the relation between data survivability
and source location privacy when the data replication
strategy is applied.
2) We propose multiple location estimation schemes, in-
cluding the coordinate median, average of overlapping
area, and expectation-maximization algorithms, for the
determination of the source location based on the loca-
tions of the compromised sensors storing data replicas.
We demonstrate the trade-off relation in a grid-based
UWSN using the location estimation algorithms.
3) The analytical results of the proposed location estima-
tion schemes are presented for performance evaluation.
In addition, simulation results are provided for the
discussion of the influence of the system parameters on
source location privacy.
The remainder of this paper is organized as follows. Section
II presents the models and basic assumptions applied in this
work. Then, we describe the algorithms used to estimate the
source location in Section III. Section IV discusses the tradeoff
between location privacy and data survivability. Simulation
results are provided in Section V for performance evaluation.
Finally, we summarize our conclusions in Section VI.
II. PRELIMINARIES
A. System Model
We assume that the UWSN comprises an MS and two
types of sensors. Some of the sensors are critical sensors
which can acquire specific and important sensing data; while
the other type of sensors are normal sensors that perform
the functionalities of data storage and message routing. It is
further assumed that a typical adversary cannot distinguish the
critical sensors from normal sensors before compromising a
node. In the UWSN, there are three main types of entities:
the MS, sensors, and data replicas. The main underlying
assumptions regarding to these three types of entities are
presented as follows:
1) MS: The mobile sink visits the UWSN periodically with
a fixed time period. At each visiting interval, the MS collects
all data stored in the sensors. For secure access, the MS shares
with each individual sensor a unique secret, which is used
for data verification and mutual authentication between the
MS and a sensor. Upon data collection, the MS informs each
sensor to erase the data stored in it for re-initialization.
2) Sensors/critical sensors: The sensors are deployed on
the sensing area in the form of a two-dimensional unit grid.
The i-th sensor is deployed at a unique point (xi, yi), where
xi, yi ∈ N+. We assume that each sensor has no knowledge of
the locations of other sensors and the communication radius
of each sensor is the same as the distance between it and its
nearest neighbor. As a result, the network maintains no routing
table and each sensor only connects to its one-hop neighbors.
We also assume that each sensor has enough storage to store
the data replicas forwarded by other critical sensors. In order
to enhance data survivability from being compromised by
adversaries, a critical sensor delivers multiple replicas of the
acquired data to multiple normal sensors by h-hop random
walks. For each data replica distribution, a source node or
an intermediate node randomly forwards the data replica to
one of its one-hop neighbors (i.e., the one-hop neighbor on
the east, north, west, or south). A data replica is concatenated
with a hop counter initially set to h. When receiving a data
replica, a sensor checks to see if the value of the hop counter
is equal to zero. If it is not, the sensor subtracts 1 from the
hop counter and then forwards the data replica to a randomly
chosen neighbor. However, if the hop counter is equal to
zero, the sensor stores the data replica in its memory awaiting
the collection of the MS. We assume that the value of h is
predetermined and is the same for all data replicas.
3) Data replicas: Inside a data replica, there is no informa-
tion related to the location of the corresponding critical source.
This assumption can be easily achieved by anonymity tech-
niques, such as the pseudo-identification technique [9]−[11].
When the MS collects the data, it can use the shared secret to
reproduce the pseudo-identification for data verification. We
assume that the pseudo-identification in a data replica will be
cleared when the data replica has been forwarded to the MS
or other sensors. Furthermore, we assume that a data replica
will never be stored in the source node or any other sensors
which have already stored the same data replica. In addition,
the storage of data replicas will obey the move-once (MO)
strategy defined in [4] in order to reduce the communication
load in the UWSN.
Figure 1 shows an example of the considered system model.
There are two critical nodes respectively located at point (3,
6) and (7, 5) in the UWSN. Each data replica generated by
a critical node is disseminated by 5-hop random walks. For
CHEN and TSAI: LOCATION PRIVACY IN UNATTENDED WIRELESS SENSOR NETWORKS UPON THE REQUIREMENT OF DATA SURVIVABILITY 1483
TABLE I
SUMMARY OF NOTATIONS
Ni Number of nodes in the UWSN
(xi, yi) Location of sensor Ni, xi, yi ∈ N+ and i = 1,· · ·, N
r Number of data replicas for an acquired data
r˜ Number of data replicas that has been captured by the ADV
S Source node of interest to the ADV
(xs, ys) Location presentation of S
J Number of compromised sensors that store data replicas of
the data acquired by S
Ωj Compromised sensors that store data replicas of the data
acquired by S
h Number of random-walk hops for a data replica
and expectation-maximization (EM) estimation approaches.
For convenience, we list the notations used in the rest of this
paper in Table I.
Since the data replicas generated by a source node S are
disseminated by h-hop random walks, the location of a node
that storing a data replica must satisfy a h-hop constraint. For
a possible data replica storage node located at (x˜j , y˜j), the
following relation must be satisfied:
h− |xs − x˜j | − |ys − y˜j | = 2a, (2)
where a is a non-negative integer and 2a < h. Accordingly,
the probability that the sensor located at (x˜j , y˜j) stores a data
replica is [13], [14]
P (h; (x˜j , y˜j) ; (xs, ys)) = (1/4)
h
Chm˜j−|xs−x˜j |C
h
m˜j , (3)
where m˜j = (h + |xs − x˜j |+ |ys − y˜j |)/2 , and Chm˜j denotes
the number of all m˜j-element combinations of h objects.
Figure 3 shows an example of the probability mass function
(PMF) of the node location where a data replica is stored for
the case with N = 81, h = 4 and S located at (5, 5). The
sensors having the same probability of storing a data replica
are shown by using the same color.
A. Random Guess (RG) Location Estimation Algorithm
The simplest approach for the ADV to find the location
of an interested node is random guess. In other words, the
ADV randomly chooses a sensor in the UWSN as a possible
candidate of S. The RG algorithm is used as the baseline
for performance comparison. Since a candidate is chosen
randomly, the probability of the ADV choosing a specific
sensor as the possible candidate is 1/N . Let the node located
at
(
xˆ
(RG)
s , yˆ
(RG)
s
)
be chosen as a candidate of the interested
critical sensor S, which is actually located at (xs, ys). Then,
the average distance d¯(RG) between the candidate and S can
be expressed as
d¯(RG) =
∑
xs∈X
ys∈Y
∑
xˆ(RG)s ∈X
yˆ(RG)s ∈Y
(∣∣∣xˆ(RG)s − xs∣∣∣+ ∣∣∣yˆ(RG)s − ys∣∣∣)
×Pr
[
(xs, ys) ,
(
xˆ
(RG)
s , yˆ
(RG)
s
)]
,
(4)
1
2
3
4
5
6
7
8
9
1
2
3
4
5
6
7
8
9
0
0.02
0.04
0.06
0.08
y
i
P
ro
b
ab
il
it
y
 o
f 
st
o
ri
n
g
 a
 d
at
a 
re
p
li
ca
(4,4)
(6,6)
x
i
(6,4)
Fig. 3. The probability distribution of a sensor storing a data replica
disseminated by a source located at (5,5) through 4-hop random-walks.
where Pr
[
(xs, ys) ,
(
xˆ
(RG)
s , yˆ
(RG)
s
)]
is the join probability
of the locations of S and the chosen candidate, X is a set
of all xi, and Y is a set of all yi. Since the selection of
the candidate is independent to the location of S, we have
the join probability Pr
[
(xs, ys) ,
(
xˆ
(RG)
s , yˆ
(RG)
s
)]
= 1/N2
by assuming that the location of S is uniformly distributed
within the sensing area.
B. Coordinate Median (CM) Location Estimation Algorithm
If some data replicas corresponding to the same source node
S are acquired, the ADV can use the location information of
Ωj , i.e., the compromised sensors storing the data replicas
of S, to enhance the accuracy of the location estimate of S.
Recalling that the data replicas are disseminated by h-hop
random-walks, the ADV can consider a possible candidate
for S as the node located at the mean of the geographic
locations of all nodes Ωj . This approach is referred to as the
CM algorithm. For example, the ADV already compromised
three sensors storing the corresponding data replicas, which
are Ω1, Ω2 and Ω3 located respectively at (1, 3), (5, 6), and
(7, 8). Then, based on the CM algorithm, the ADV will choose
the sensor located at ((1 + 5 + 7)/3  , (3 + 6 + 8)/3 ) =
(5, 6) as the possible candidate for S, where · denotes the
ceiling function. Recalling Figure 3, we observe that the nodes
located at points symmetric to the location of S have the same
probability of storing a data replica. Hence, it is probable
that the actual storage nodes Ωj are distributed at locations
symmetric to the location of S. As a result, the mean of the
coordinates of all nodes Ωj may be a good estimate of the
location of S.
To simplify the derivation of the average distance between
the location estimate and the desired source node, we translate
the coordinate system to make the source node located at the
origin. Let the pairs (x˜j , y˜j), for 1 ≤ j ≤ J , be the locations
of the compromised sensors that store the data replicas. By
applying (3), the probability that the locations of Ωj are equal
to a specific set Γ = {(x˜1, y˜1), (x˜2, y˜2), · · · , (x˜J , y˜J)}, where
(x˜i, y˜i) = (x˜j , y˜j) for i = j, 1 ≤ i, j ≤ J , is
f(Γ) =
J !
J∏
j=1
(1/4 )hChm˜jC
h
m˜j−|x˜j |
∑
A
J∏
j=1
(1/4 )hCh
m˜′j
Ch
m˜′j−|x˜′j|
, (5)
CHEN and TSAI: LOCATION PRIVACY IN UNATTENDED WIRELESS SENSOR NETWORKS UPON THE REQUIREMENT OF DATA SURVIVABILITY 1485
contour of the intersection area is determined by the following
four linear equations:⎧⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎩
y = −x + h + min
1≤j≤J
(x˜j + y˜j)
y = −x− h + max
1≤j≤J
(x˜j + y˜j)
y = x− h− min
1≤j≤J
(x˜j − y˜j)
y = x + h− max
1≤j≤J
(x˜j − y˜j)
. (10)
The obtainment of (10) is due to the fact that the location
of the source node must be within all the possible areas
corresponding to all nodes Ωj; thus, the contour of the
overlapping area must be constructed by the line equations in
(9) that are closest to the origin (i.e., the source node). Based
on (10), the intersection area is a parallelogram surrounded by
the lines defined in (10), and the corresponding vertices are
the intersection points. Note that the geographic median of
all nodes within the intersection area are equal to that of all
vertices. As a result, the ADV can choose the node closest
to the geographic median of all vertices as the candidate
node. Let θ1, θ2, θ3 and θ4, which are respectively located
at (xθ1 , yθ1), (xθ2 , yθ2), (xθ3 , yθ3) and (xθ4 , yθ4), be the four
vertices of the intersection area. Then, based on (10), we have⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
(xθ1 , yθ1) =
(
1
2 [max (x˜j + y˜j) + min (x˜j − y˜j)] ,
1
2 [−2h + max (x˜j + y˜j)−min (x˜j − y˜j)]
)
(xθ2 , yθ2) =
(
1
2 [2h + min (x˜j + y˜j) + min (x˜j − y˜j)] ,
1
2 [min (x˜j + y˜j)−min (x˜j − y˜j)]
)
(xθ3 , yθ3) =
(
1
2 [min (x˜j + y˜j) + max (x˜j − y˜j)] ,
1
2 [2h + min (x˜j + y˜j)−max (x˜j − y˜j)]
)
(xθ4 , yθ4) =
(
1
2 [−2h + max (x˜j + y˜j) + max (x˜j − y˜j)] ,
1
2 [max (x˜j + y˜j)−max (x˜j − y˜j)]
)
(11)
Hence, the location estimate of S is obtained by(
xˆ(AOA)s , yˆ
(AOA)
s
)
=
(⌈∑4
i=1
xθi/4
⌉
,
⌈∑4
i=1
yθi/4
⌉)
(12)
and the distance between the candidate node and the source
node S is
d(AOA)(Γ) =
∣∣∣xˆ(AOA)s ∣∣∣+ ∣∣∣yˆ(AOA)s ∣∣∣ . (13)
Based on (5) and (13), the average distance between the
location estimate and the exact source location by using the
AOA scheme is expressed as
d¯(AOA) =
h∑
x˜1=−h,y˜1=−h
(|x˜1|+|y˜1|)∈H
· · ·
h∑
x˜J=−h,y˜J=−h
(|x˜J |+|y˜J |)∈H
f(Γ)d(AOA)(Γ),
(14)
where |x˜j |+ |y˜j | ∈ H is the same as the definition shown in
(8).
We summarize the procedure of the AOA algorithm as
follows:
1: INPUT: the possible topology of the UWSN, h, and
[(x˜1, y˜1), · · · , (x˜J , y˜J)]
2: SET Overlap = Possible area induced by (x˜1, y˜1)
3: for j = 2 to J do
4: Overlap = Overlap
⋂
(Possible area induced by
(x˜j , y˜j))
5: end for
6: find the coordinate median node of Overlap as the possible
candidate
D. Expectation-Maximization Based Location Estimation Al-
gorithm
To protect the critical sensors from being compromised, the
UWSN will try the best to conceal the routing parameters
from being eavesdropped by using data encryption techniques.
Under this assumption, the ADV cannot learn about the
routing parameters for the forwarding of data replicas, and
the above-mentioned AOA algorithm is no longer applicable.
The expectation-maximization (EM) algorithm was proposed
for the incomplete data estimation problem, which provides a
maximum-likelihood (ML) estimate of the desired parameters
by iteratively applying the following two steps: expectation
(E-step) and maximization (M-step) [12]. Under the assump-
tion that the ADV does not have the routing parameter, the
ADV can regard the locations of the compromised nodes
Ωj as the observable but incomplete data, and h as the
unobserved data which is assumed to be an integer in the
range {1, 2, · · · , hmax}, where hmax denotes the maximum
possible value of the parameter h. Then, the ADV can estimate
the location of the critical sensor S by using the EM algorithm.
1) Evaluation of Likelihood Function: For simplification,
the locations of the source node S and a node Ωj , storing a
data replica corresponding to the desired sensor S, are denoted
as Ls = (xs, ys) and Lj = (x˜j , y˜j), respectively. Given Ls
and according to (3), the distribution of Lj is expressed as
P (h; Lj; Ls) = (1/4)
h
Chm˜j−|xs−x˜j|C
h
m˜j , (15)
where m˜j = (h + |xs − x˜j |+ |ys − y˜j|)/2 . Under the as-
sumption of independence in the dissemination of different
data replicas, the likelihood function for a set of observed
locations of Ωj , for 1 ≤ j ≤ J , is represented by
P (h; Γ; Ls) =
J∏
j=1
P (h; Lj ; Ls)
=
J∏
j=1
(
1
4
)h
Chm˜j−|xs−x˜j |C
h
m˜j
,
(16)
where Γ = {(x˜1, y˜1), (x˜2, y˜2), · · · , (x˜J , y˜J)} denotes the
set of observed locations of Ωj .
According to the E-M algorithm, each iteration consists of
two steps: the expectation step or so-called E-step, and the
maximization step or so-called M-step. Assume that we are
currently at the -th iteration and the corresponding estimate
of the source location is Lˆ()s = (xˆ
()
s , yˆ
()
s ).
2) E-step: In the E-step, the conditional expectation of
the likelihood function, given a set of observation Γ and the
current estimate Lˆ()s , is evaluated as
Q(+1)
(
L′s; Lˆ
()
s
)
= E
h
˛
˛
˛Γ;Lˆ
()
s
[P (h; Γ; L′s)]
=
hmax∑
h=1
{
J∏
j=1
P (h; Lj; L′s)
}
×Pr
(
h|Γ; Lˆ()s
)
,
(17)
CHEN and TSAI: LOCATION PRIVACY IN UNATTENDED WIRELESS SENSOR NETWORKS UPON THE REQUIREMENT OF DATA SURVIVABILITY 1487
is the probability mass function of the estimation performance,
which can be evaluated by the results derived in Section
III or obtained via simulation results. Finally, according to
(21) and (23), the tradeoff between location privacy and data
survivability can be investigated. We show the results of
tradeoff and comparison in Section V.
V. PERFORMANCE EVALUATION
In this section, we provide the analytical and simulation
results to investigate the location estimation performance and
the tradeoff between location privacy and data survivability.
The estimation performance is measured by the distance
between the location estimate and the exact location of the
source node, referred to as the candidate-source distance (in
hops). The simulation results are obtained by averaging the
outcomes of 50000 realizations. The simulation environment
and parameters are described as follows:
1) Network: There are totally 10000 sensors deployed at a
sensing area with 100× 100 regular grids. The distance
between any two neighboring nodes is assumed to be
1. Thus, for the location of a node (xi, yi), we have
1 ≤ xi ≤ 100 and 1 ≤ yi ≤ 100, for 1 ≤ i ≤ 10000.
2) Source node: The location of the desired source node
is randomly chosen in each realization. We assume that
the source node location is away from the boundary of
the sensing area.
3) Data Replica: We assume that different data replicas
corresponding to the same acquired data are stored in
different nodes via random-walk dissemination. If a data
replica is finally forwarded back to the source node,
the source node restarts the random-walk dissemination
until the replica is stored in another sensor without
having stored a replica of the same data.
4) Random-walk dissemination: The number of random-
walk hops h chosen in the simulation ranges between 10
and 30. Since the value of h depends on the network size
and the affordable communication load, a larger value of
h could be used for a very large network. For each hop,
the dissemination direction is randomly chosen from the
four directions (the east, west, north and south).
5) Adversary: Without loss of generality, we assume that
the ADV can compromise a node in each epoch, i.e.,
k = 1, and the number of epochs v between two
consecutive visits of the MS is set to be a variable for
performance evaluation. If no data replica is captured,
the ADV randomly chooses a node in the network to
compromise. If only one data replica is obtained, the
location of the node storing the data replica is chosen
as the candidate node. However, if two or more data
replicas are available, the ADV can apply the above-
mentioned location estimation algorithms to obtain a
candidate for the desired source node.
Figure 6 shows the cumulative distribution function (CDF)
of the location estimation performance for different estimation
schemes under the assumption that the number of captured
data replicas is equal to 3, i.e., r˜ = 3. The location estimation
performance is measured by the candidate-source distance (in
hops). Two scenarios are investigated: h = 15 and h = 30.
0 1 2 3 4 5 6 7 8 9
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Candidate-Source Distance (hops)
C
u
m
u
la
ti
v
e
 D
is
tr
ib
u
ti
o
n
 F
u
n
c
ti
o
n
Simulation
CM, h = 15 
CM, h = 30
AOA, h =15
AOA, h = 30
EM, h = 15
EM, h = 30
Analytical
CM, h = 15 
CM, h = 30
AOA, h =15
AOA, h = 30
h = 30
h = 15
Fig. 6. The cumulative distribution function of candidate-source distance for
various location estimation schemes with r˜ = 3.
For the CM and AOA schemes, both the derived analytical
results and simulation results are presented; while for the
EM scheme, only the simulation results are available. We
observe that the analytical results fit in with the simulation
results very well, showing the consistency of our results.
The CM and EM schemes show the estimation performance
slightly better than that of the AOA scheme. It is interesting
to note that the CM and EM schemes do not require the
information of the routing parameter, i.e., the value of h,
in the estimation process. Moreover, the CM scheme is the
simplest approach for location estimation. This implies that
an ADV shall use the CM scheme for location estimation,
in order to reduce the computational complexity and achieve
a good performance. In addition, the increase in the number
of hops for replica dissemination can significantly degrade
the estimation performance. An UWSN can increase the hop
number to improve location privacy at the cost of increasing
the communication load in the entire network.
Figure 7 shows the simulation results of the location esti-
mation performance (in CDF) for different estimation schemes
under the assumption that the hop number is h = 15. The
number of captured data replicas is assumed to be equal to
3 or 5. The CM and EM schemes still outperform the AOA
scheme for different numbers of captured data replicas. If more
data replicas are captured by an ADV, the location estimation
performance can be significantly improved; that is, the location
privacy is degraded. Furthermore, the performance of the EM
scheme is superior to that of the CM scheme for the case
with 5 captured data replicas. However, the computational
complexity of the EM scheme is much higher.
To improve location privacy, the UWSN may apply random
hops for the dissemination of different replicas. Figure 8 shows
the CDF performance comparison of the random-hop approach
and the fixed-hop approach. For the random-hop approach, the
hop number of a data replica is individually and randomly
chosen and is uniformly distributed in [10, 30]. In the CM
scheme, the information of the hop number is unnecessary
and assumed to be unknown to the ADV; while, in the AOA
scheme, we assume that the ADV only knows the maximum
CHEN and TSAI: LOCATION PRIVACY IN UNATTENDED WIRELESS SENSOR NETWORKS UPON THE REQUIREMENT OF DATA SURVIVABILITY 1489
0 500 1000 1500 2000 2500 3000 3500 4000 4500 5000
0
10
20
30
40
50
60
Number of Compromised Nodes
A
v
er
ag
e 
C
an
d
id
at
e-
S
o
u
rc
e 
D
is
ta
n
ce
 (
h
o
p
s)
h = 30, r = 3
h = 15, r = 3
h = 30, r = 5
h = 15, r = 5
Random Guess
90% Confidence Interval 
Fig. 11. The average location estimation performance versus the number of
nodes compromised by the ADV.
Number of Compromised Nodes
A
v
e
r
a
g
e
 
L
o
c
a
t
i
o
n
 
P
r
i
v
a
c
y
0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000
-7
-6
-5
-4
-3
-2
-1
0
No. of replicas = 2 
No. of replicas = 3
No. of replicas = 4
No. of replicas = 5 
No. of replicas = 6 
Fig. 12. The average location privacy versus the number of nodes compro-
mised by the ADV.
mean value in order to show the reliability of our simulation
results. The impact of the number of total data replicas on
location privacy is shown in Figure 12. The evaluation of
average location privacy is based on (23). When the number
of compromised nodes increases, location privacy degrades
quickly since the probability that multiple data replicas are
captured by an ADV increases as well. If more data replicas
are distributed by the source node, more location information
is exposed to the ADV; thus, the degradation in location
privacy is more severe.
Finally, we investigate the tradeoff between location privacy
and data survivability in Figure 13. Recalling Figure 9, under
a requirement of data survivability, the maximum tolerable
number of compromised nodes during the time interval be-
tween two consecutive visits of the MS depends only on the
number of data replicas generated by the source node. If more
data replicas are generated for each acquired data, the UWSN
can tolerate more nodes compromised by the ADV. However,
if location privacy becomes an important issue, the maximum
tolerable number of compromised nodes must be reduced to
prevent the degradation in location privacy. Figure 13 shows
2 3 4 5 6
2000
2500
3000
3500
4000
4500
5000
5500
6000
Number of Generated Data Replicas
M
ax
. 
T
o
le
ra
b
le
 N
u
m
b
er
 o
f 
C
o
m
p
ro
m
is
ed
 N
o
d
es
Consider data survivability only
Consider both data survivability
and location privacy
Fig. 13. The maximum tolerable number of compromised nodes under the
requirements of the data survival probability PS(r) ≥ 0.95 and average
location privacy P¯L(r) ≥ −4.
the maximum tolerable number of compromised nodes under
the requirements of the data survival probability PS(r) ≥ 0.95
and average location privacy P¯L(r) ≥ −4. If we consider
data survivability only, more data replicas can improve the
resistance to the attack from the ADV. However, if both data
survivability and location privacy are considered, the optimal
number of generated data replicas is r = 3.
VI. CONCLUSION
In UWSNs, one of the major concerns is the data surviv-
ability and the data replication strategy has been proposed
to increase data survivability. However, the distribution of
multiple data replicas may expose the location information of
some critical nodes. Hence, the ADV can use some location
estimation schemes to locate the source node corresponding
to the same data replicas, and then attack it in order to
cause severe damage to the network. In this work, we have
proposed three location estimation algorithms, the CM, AOA
and EM approaches, based on the location of the captured
data replicas. The analytical results of the CM and AOA
estimation performance are derived. According to the ana-
lytical and simulation results, the three location estimation
schemes achieve almost the same performance. From the
viewpoint of the ADV, the CM scheme shall be applied, since
it has the lowest computational complexity. Furthermore, the
tradeoff between location privacy and data survivability is well
investigated. If both location privacy and data survivability are
major concerns, only a limited number of data replicas shall
be generated by a source node. In addition, under the specific
requirements of data survivability and location privacy, the
optimal number of data replicas can be derived based on our
results, which provides best resistance to the attack from the
ADV.
ACKNOWLEDGMENT
The authors would like to thank the anonymous reviewers
for their valuable comments and suggestions.
3876 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
Cooperative Information Aggregation for Distributed
Estimation in Wireless Sensor Networks
Yuh-Ren Tsai, Member, IEEE, and Cheng-Ju Chang, Student Member, IEEE
Abstract—The performance of distributed estimation in wireless
sensor networks (WSNs) is affected by observation noise, commu-
nication errors and the noise caused by the inevitable quantiza-
tion process. Reducing the number of transmitted bits per node
can minimize the energy consumption and communication load,
thereby prolonging the network lifetime. However, reducing the
number of transmitted bits has a significant impact on the esti-
mation performance. In this work, we propose cooperative infor-
mation aggregation (CIA) approaches for distributed estimation
that consider the above-mentioned issues jointly. Under the pro-
posed schemes, a multi-bit quantizer is used to generate the local
observation codeword at each node. Then, each node only trans-
mits one predesigned bit of the derived codeword to the fusion
center (FC). At the FC, the information bits transmitted cooper-
atively by all nodes are aggregated and fused to obtain the estima-
tion result. We design two estimators: an aggregation hard decision
estimator (AHDE) and an aggregation maximum-likelihood esti-
mator (AMLE). Predetermining the transmitted bit at each node
is formulated as a constrained optimization problem for resource
allocation and the corresponding suboptimal resource allocation
policies are proposed. The simulation results demonstrate that the
proposed schemes can overcome the impact of observation noise
and communication errors effectively.
Index Terms—Distributed estimation, imperfect channel, max-
imum-likelihood estimation (MLE), wireless sensor network
(WSN).
I. INTRODUCTION
E MERGING wireless sensor network (WSN) technologiesare being utilized in a wide variety of applications, such
as environmental surveillance, target locating and tracking,
home automation, personal health care and remote parameter
detection. One of the most interesting applications of WSNs is
distributed estimation, where spatially distributed sensors are
deployed over the sensing area to estimate for an unknown signal
based on noise-corrupted observations. Each node collects
data about the desired signal and transmits the data to a fusion
center (FC) via the communication channel. The FC then makes
a final estimation based on the data received from all nodes in the
area. In general, sensors are small, low-cost components that are
typically subject to a stringent energy constraint; hence, energy
Manuscript received August 27, 2010; revised February 15, 2011; accepted
April 22, 2011. Date of publication May 12, 2011; date of current version July
13, 2011. The associate editor coordinating the review of this manuscript and
approving it for publication was Dr. Biao Chen. This work was supported in part
by the National Science Council, Taiwan, R.O.C., under Grant NSC 97-2221-E-
007-074-MY3.
The authors are with the Institute of Communications Engineering, National
Tsing Hua University, Hsinchu 30013, Taiwan (e-mail: yrtsai@ee.nthu.edu.tw;
d949602@oz.nthu.edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TSP.2011.2153847
conservation is a crucial issue in WSNs. Since the energy con-
sumption of sensing and data processing is generally much less
than that of message transmission by a sensor [1], minimizing
the number of transmission bits could save a significant amount
of energy and thereby prolong the network lifetime.
Because of the energy constraint and the limited communi-
cation bandwidth, several distributed estimation schemes have
been proposed in recent years. The issue of prolonging the life-
time of WSNs was investigated in [2]–[5] through single-layer
design or cross-layer optimization. In [6]–[8], a one-bit quantizer
was applied to nodes so that each node only needs to transmit
one bit to represent the estimation result. The strategy saves
energy and communication bandwidth; however, selection of the
optimal quantization threshold highly depends on the unknown
parameter that to be estimated and selection of an inappropriate
threshold results in considerable performance degradation. To
address the problem, [9] and [10] proposed adaptive quantization
schemes that dynamically adjust the quantization threshold
so that it gradually approaches an optimal value and a good
estimation performance is achieved. However, under the above
schemes, information exchange among nodes is essential,
which increases the communication overhead.
In [11] and [12], the best linear unbiased estimator (BLUE)
[13] was applied as the fusion rule for decentralized estima-
tion under the scenario that the exact observation noise variance
is unknown at the FC. A tradeoff between the number of ac-
tive nodes and the message length of quantization, under a total
transmission bit rate constraint in the quasi-BLUE approach,
was discussed in [14] without considering the imperfect com-
munication channels. The optimization of the message length
of quantization and the transmission power allocation was in-
vestigated in [15] and [16]. A decentralized estimation scheme
was proposed in [17] based on the maximum-likelihood (ML)
method; however, the one-bit quantizer was applied and con-
sequently there existed the problem of quantization threshold
selection. The expectation-maximization (EM) algorithm was
employed for the incomplete data estimation in [18] providing
that only partial knowledge of the statistics of the observation
noise and communication noise is known at the FC.
Theoretically, applying one-bit quantization at each node
should reduce the energy consumption and communication
bandwidth requirement substantially, since only one binary
symbol is sent per node. However, the achievable estimation per-
formance is strictly limited in practical situations. On the other
hand, using multi-bit quantization can improve the estimation
performance at the cost of increasing energy and communi-
cation load. Because there are numerous nodes available in
a WSN, each node can apply a multi-bit quantizer for source
encoding of the observation signal but still only select one bit
1053-587X/$26.00 © 2011 IEEE
3878 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
Considering imperfect propagation effects, the communica-
tion channel between each node and the FC is modeled as a
binary symmetric channel (BSC) with the same crossover prob-
ability . After passing through the BSC, the information code-
word received and aggregated at the FC is expressed as
(6)
The FC subsequently generates the final estimation outcome,
denoted as , via the estimation process described by
(7)
where represents the fusion rule.
In this work, we propose two fusion rules for distributed es-
timation at the FC in consideration of trade-off between the es-
timation performance and computational complexity. To opti-
mize the estimation performance, the selection of transmitted
bits at nodes must be well-designed and the received bits must
be reorganized at the FC. The bit selection process can be for-
mulated as a resource allocation problem. Under the assump-
tion that the system parameters, namely, , , , , and ,
are available at the FC, the resource allocation strategies for
the two proposed estimators can be predetermined and no in-
formation exchange is required among the sensor nodes. More-
over, considering large-scale sensor networks, we assume that
the message length is much smaller than the number of nodes,
i.e., .
III. COOPERATIVE INFORMATION AGGREGATION
SCHEMES AND OPTIMIZATION
Since the proposed schemes consider the effects of observa-
tion noise and communication errors, the bits selected for trans-
mission must be able to cope with the two impacts in order to
improve the estimation performance. We define the resource al-
location vector as , where denotes
the number of nodes that choose the th bit in their observa-
tion vectors to forward to the FC. The total resource constraint
must be satisfied by the design of . Without
loss of generality, we assume that node forwards the th bit
in the observation vector to the FC for
. As shown in Fig. 2, nodes 1 to forward the first
bit, i.e., the MSB, in their respective observation vectors, then
nodes to forward the second bit in their vec-
tors and so on. In the codeword received at the FC, there are
bits, which are accumulated from nodes, corresponding
to the th quantized information bit for the estimation of . Note
that the bit transmitted by each node can be predetermined based
on the resource allocation vector , so no real-time computa-
tion is required.
In addition, note that the transmitted codeword is not error-
free compared with the quantization version of the desired pa-
rameter , since the local observation at each node is corrupted
by observation noise. The codeword received at the FC con-
tains the errors present in as well as those caused by the com-
munication channels.
To alleviate the impact of the observation noise, we utilize
binary-reflected Gray encoding (BRGE) [25], instead of the
widely used binary encoding (BE), in the quantization and
Fig. 2. The mapping between the  -bit codeword and the transmitted bit at
each node.
TABLE I
THE QUANTIZATION CODEWORDS GENERATED BY BINARY ENCODING (BE)
AND BINARY-REFLECTED GRAY ENCODING (BRGE) WITH    
de-quantization processes. Under BRGE, the observation vec-
tors of two successive quantization levels only differ by one
bit, whereas several bits may differ between two neighboring
quantization codewords under BE, as shown in Table I with
. The attractive one-bit difference property of BRGE is
very useful in reducing the discrepancy among the observation
vectors produced by the quantization process. Moreover, using
BRGE in the quantization and de-quantization processes does
not incur any extra cost and the technique can be applied to any
message length.
The design of the fusion rule and determination of the
resource allocation vector are also critical issues in the pro-
posed schemes. In the following subsections, we propose two
fusion rules and discuss their corresponding resource allocation
strategies.
A. Aggregation Hard Decision Estimator
The first proposed fusion rule, called the aggregation hard
decision estimator (AHDE), is quite intuitive and simple. The
FC uses the information codeword collected from all nodes
to reconstruct the -bit aggregated observation vector
. Based on the resource allocation vector ,
there are bits that correspond to the th bit of the aggregated
observation vector. A straightforward way to decide the value
3880 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
to the FC and the value of is determined according to the
majority principle, the statistics of in (12) can be derived as
follows:
(16)
where is the floor function; and represents the
cumulative density function (CDF) of the binomial distribution
with the total number of Bernoulli trials, the success proba-
bility of each trial and the number of successes in trials.
To ensure that the optimization problem in (13) is solvable,
we need to further simplify the expression in (16). Let
represent the number of failures in trials and let
be the failure probability of each trial. Then, we define
and as the PDF and the complemen-
tary CDF (CCDF) respectively of the binomial distribution of
the parameters , and . So long as , is
upper-bounded by the summation of an infinite geometric series
with the ratio , i.e., [26]
(17)
Note that (17) is equivalent to the CDF of and can be rewritten
as
(18)
where since it is assumed that in
the derivation of (17). Then, by expressing in (18) as ,
where is the fraction of successes in trials and ap-
plying Stirling’s approximation for factorials in ,
we can derive the following excellent approximation of
[27]:
(19)
where denotes the binary entropy function. According to
(16), we have and , which is guaran-
teed in most scenarios. Therefore, can be approxi-
mated as
(20)
The average square error caused by the flip at the th bit is
derived as follows. Assuming that level is the correct quan-
tization level, we denote as the distance, measured in the
quantization step size , between the th level and the resultant
level by flipping the th quantized information bit. By taking the
average over possible quantization levels, we derive the av-
erage square error as
(21)
Table I exhibits an example of BRGE and BE with the message
length and the corresponding distances of BRGE are
presented. Because of the symmetry of BRGE codewords, the
distances of BRGE are also symmetric for different quanti-
zation levels. Therefore, to calculate , we only need to consider
the values of , for . In the desired interval
, the values of for the th quantized in-
formation bit can be expressed as
(22)
Subsequently, the calculation of can be reformulated from
(21) as
(23)
Finally, based on (20) and (23), the objective function of (13)
can be approximated by
(24)
and the optimization problem for the suboptimal resource allo-
cation vector is reformulated as
(25)
To simplify the notation of the following derivation, we define
two functions and with respect to as
(26)
Then, we rewrite the objective function as
(27)
The Karush–Kuhn–Tucker (KKT) conditions [28] for are
(28)
(29)
3882 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
Fig. 3.        with the system parameters  ,   , and    .
(a)        for        with   . (b)       for        
with   	.
and the communication channels are ideal. Based on the prop-
erties of the adopted BRGE, each quantized information bit di-
vides the whole observation range into multiple seg-
ments and each quantized information bit contributes a different
estimation resolution in the LLF of . We use to de-
note the LLF contributed by the bit , corresponding to the
th quantized information bit received at the FC for a given .
Fig. 3 shows an example of with the system parame-
ters , and . Fig. 3(a) illustrates
for with . Specifically, the LLF of the MSB
(i.e., ) has the coarsest estimation resolution, while the
LLF of the LSB (i.e., ) has the finest resolution. Moreover,
the amount of resource allocated to a specific quantized infor-
mation bit indicates the selectivity of the LLF of that bit. At the
FC, the LLFs contributed by all quantized information bits are
accumulated to resolve the uncertainty caused by the observa-
tion noise. Since the LLFs contributed by different quantized
information bits provide different resolutions and selectivity on
the desired parameter , the FC needs to accumulate all the LLFs
in order to discover the most probable value of . As a result,
for AMLE, the optimal resource allocation in this case tends to
distribute the resource bits equally among different quantized
information bits.
Fig. 4. The results of regular testing for the CIA-MLE approach with  ,
  	, and    	.
On the other hand, the opposite case assumes that only a
limited number of nodes are available and the communication
channel quality is poor. In this case, the information codeword
transmitted collaboratively by all nodes is degraded by the un-
reliable communication channels. As a result, the LLF corre-
sponding to each quantized information bit becomes flat and
lacks of discriminability for different values of , as shown in
Fig. 3(b), where it is assumed that . Therefore, AMLE’s
performance is severely degraded so that the performance of
AMLE approaches that of AHDE. Consequently, the optimal
resource allocation for AMLE in this case tends to follow the
HDE-SORA policy discussed in Section III-B. Based on the
above two extreme cases, the proposed SHRA combines equal
resource allocation (ERA) and HDE-SORA and applies them
adaptively according to the number of available nodes and the
condition of communication channels.
In SHRA, all nodes are divided into two groups, one of which
follows ERA and the other follows HDE-SORA. We define the
hybrid ratio as the proportion of total available re-
source bits that follows HDE-SORA. Based on a specific value
of , the resource allocation vector for SHRA can be expressed
as follows:
(39)
where and are the numbers of resource bits allocated
by ERA and HDE-SORA respectively and both correspond to
the th quantized information bit. For ERA, it is obvious that
for ; and for HDE-SORA, can
be determined by solving (32) subject to the modified resource
constraint .
To find the optimal hybrid ratio , the regular testing ap-
proach is applied and the value that achieves the best MSE per-
formance is adopted as the optimal ratio.
Based on , the resource allocation vector for SHRA can
be predetermined and no on-line calculation is required. Fig. 4
shows the result of the optimal hybrid ratio for SHRA. The
system parameters are set at , and ; the
BSC crossover probability varies from to ;
and the number of nodes varies from to .
3884 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
Fig. 6. Performance of the compared approaches for various   with   ,
   ,    , and    . (a) Comparison of the resources allocated
to different quantized information bits. (b) Comparison of NMSE for the CIA
schemes with different resource allocation policies. (c) NMSE comparison of
the CIA schemes, AQ-ML, QBLUE, and UDES.
is always bounded by that of QSE, since it cannot reduce the
quantization noise. In contrast, CIA-MLE is not bounded by
QSE when because of the advantage provided by the
ML concept. Note that the total numbers of bits transmitted
in an observation interval are 300, 300, 1800, and 300 for
CIA, AQ-ML, QBLUE, and UDES, respectively. This shows
Fig. 7. Performance of the compared approaches for various with   ,
   ,    , and     . (a) Comparison of the resources allocated
to different quantized information bits. (b) Comparison of NMSE for the CIA
schemes with different resource allocation policies. (c) NMSE comparison of
the CIA schemes, AQ-ML, QBLUE, and UDES.
the superiority of the CIA schemes in the aspect of energy
consumption and communication load.
Theoretically, an increase in the network size, i.e., the number
of nodes, should gradually improve the estimation performance.
Fig. 7 shows the estimation performance under different net-
work sizes, with the parameter settings , ,
3886 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
Fig. 10. Performance comparison of the BE and BRGE encoding approaches
for the CIA schemes with     ,    , and    . (a) Comparison of
NMSE for various  with   . (b) Comparison of NMSE for various
with    .
both CIA-HDE and CIA-MLE. The major difference between
BRGE and BE is that BRGE guarantees a one-bit difference
between two adjacent codewords, whereas, in BE, there may
be a multi-bit discrepancy between neighboring codewords. As
a result, under BE, the discrepancies due to the presence of
observation noise among the quantization codewords generated
by nodes become more conspicuous, leading to performance
degradation.
In a WSN, nodes may die unexpectedly due to the depletion
of their energy, which inevitably impacts the system’s esti-
mation performance. We therefore examine the flexibility of
CIA schemes in dealing with the unpredictable death of nodes.
Fig. 11 shows the impact of node death on the NMSE perfor-
mance. Let denote the ratio of dead nodes; then the total
number of nodes that die is . In the simulation, each node
is assigned a bit for transmission according to the resource
allocation policies and nodes are chosen at random from
the nodes as the dead nodes in order to evaluate the impact
of unpredictable node death on the proposed schemes. In ad-
dition, to ensure the comparison is fair, the number of nodes
available for estimation in AQ-ML, QBLUE, and UDES, is
Fig. 11. Performance of the compared approaches for variouswith    ,
    and    . (a) Comparison of NMSE for various  with   . (b)
Comparison of NMSE for various  with    .
also reduced from to . In Fig. 11, the system
parameters are set at , , and ; and the
ratio of dead nodes is assumed to be , , or
. Fig. 11(a) shows the outcomes for various values of
with ; and Fig. 11(b) compares for various values
of with . We find that increasing from
to only results in slight performance degradation for
both CIA-HDE and CIA-MLE. The results demonstrate that
the proposed schemes are flexible and capable of handling un-
predictable node death effectively. In other words, the superior
estimation performance can be maintained even if some nodes
are dead.
According to the simulation results, CIA-MLE significantly
outperforms CIA-HDE in the estimation performance. Never-
theless, the difference in computational complexity between the
two CIA schemes shall be considered for practical applications.
Based on the average run time of each fusion scheme, we find
that the computational complexity of CIA-MLE-SHRA is about
1.5 times that of CIA-HDE-SORA for ; however, if the
message length increases to , the complexity ratio will
increases dramatically to 6.7.
3888 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 59, NO. 8, AUGUST 2011
[8] J. Fang and H. Li, “Hyperplane-based vector quantization for dis-
tributed estimation in wireless sensor networks,” IEEE Trans. Inf.
Theory, vol. 55, no. 12, pp. 5682–5699, Dec. 2009.
[9] H. Li and J. Fang, “Distributed adaptive quantization and estimation
for wireless sensor networks,” IEEE Signal Process. Lett., vol. 14, no.
10, pp. 669–672, Oct. 2007.
[10] J. Fang and H. Li, “Distributed adaptive quantization for wireless
sensor networks: From delta modulation to maximum likelihood,”
IEEE Trans. Signal Process., vol. 56, no. 10, pp. 5246–5257, Oct.
2008.
[11] J. Wu, Q. Huang, and T. Lee, “Minimal energy decentralized estimation
via exploiting the statistical knowledge of sensor noise variance,” IEEE
Trans. Signal Process., vol. 56, no. 5, pp. 2171–2176, May 2008.
[12] J. Wu, Q. Huang, and T. Lee, “Energy-constrained decentralized
best-linear-unbiased estimation via partial sensor noise variance
knowledge,” IEEE Signal Process. Lett., vol. 15, pp. 33–36, 2008.
[13] S. M. Kay, Fundamentals of Statistical Signal Process.: Estimation
Theory. Upper Saddle River, NJ: Prentice-Hall, 1993.
[14] J. Li and G. AlRegib, “Rate-constrained distributed estimation in wire-
less sensor networks,” IEEE Trans. Signal Process., vol. 55, no. 5, pp.
1634–1643, May 2007.
[15] J.-J. Xiao, S. Cui, Z.-Q. Luo, and A. J. Goldsmith, “Power scheduling
of universal decentralized estimation in sensor networks,” IEEE Trans.
Signal Process., vol. 54, no. 2, pp. 413–422, Feb. 2006.
[16] X. Luo and G. B. Giannakis, “Energy-constrained optimal quantization
for wireless sensor networks,” EURASIP J. Adv. Signal Process., vol.
2008, pp. 1–12, 2008.
[17] T. C. Aysal and K. E. Barner, “Constrained decentralized estimation
over noisy channels for sensor networks,” IEEE Trans. Signal Process.,
vol. 56, no. 4, pp. 1398–1410, Apr. 2008.
[18] T. C. Aysal and K. E. Barner, “Blind decentralized estimation for
bandwidth constrained wireless sensor networks,” IEEE Trans. Wire-
less Commun., vol. 7, no. 5, pp. 1466–1471, May 2008.
[19] Z.-Q. Luo, “Universal decentralized estimation in a bandwidth
constrained sensor network,” IEEE Trans. Inf. Theory, vol. 51, pp.
2210–2219, Jun. 2005.
[20] Z.-Q. Luo, “An isotropic universal decentralized estimation scheme for
a bandwidth constrained ad hoc sensor network,” IEEE J. Sel. Areas
Commun., vol. 23, pp. 735–744, Apr. 2005.
[21] Z.-Q. Luo and J.-J. Xiao, “Decentralized estimation in an inhomoge-
neous sensing environment,” IEEE Trans. Inf. Theory, vol. 51, no. 10,
pp. 3564–3575, Oct. 2005.
[22] T.-Y. Wang, L.-Y. Chang, D.-R. Duh, and J.-Y. Wu, “Fault-tolerant de-
cision fusion via collaborative sensor fault detection in wireless sensor
networks,” IEEE Trans. Wireless Commun., vol. 7, no. 2, pp. 756–768,
Feb. 2008.
[23] T.-Y. Wang, L.-Y. Chang, and P.-Y. Chen, “A collaborative sensor-
fault detection scheme for robust distributed estimation in sensor net-
works,” IEEE Trans. Commun., vol. 57, no. 10, pp. 3045–3058, Oct.
2009.
[24] T.-Y. Wang, Y. S. Han, P. K. Varshney, and P.-N. Chen, “Distributed
fault-tolerant classification in wireless sensor networks,” IEEE J. Sel.
Areas Commun., vol. 23, no. 4, pp. 724–734, Apr. 2005.
[25] F. Gray, “Pulse code communication,” U.S. Patent 632 058, Mar. 17,
1953.
[26] W. Feller, An Introduction to Probability Theory and Its Applications,
2nd ed. New York: Wiley, 1971, vol. 2.
[27] A. R. Meyer and R. Rubinfeld, Mathematics for Computer Science.
Cambridge, MA: Massachusetts Inst. of Technol., 2008.
[28] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge,
U.K.: Cambridge Univ. Press, 2003.
Yuh-Ren Tsai (M’01) received the B.S. degree in
electrical engineering from National Tsing Hua Uni-
versity, Hsinchu, Taiwan, in 1989 and the Ph.D. de-
gree in electrical engineering from National Taiwan
University, Taipei, Taiwan, in 1994.
From 1994 to 2001, he was a Researcher in the
Telecommunication Laboratories of Chunghwa
Telecom Company, Limited, Taiwan. Since 2001,
he has been with the Department of Electrical
Engineering and the Institute of Communications
Engineering at National Tsing Hua University,
Hsinchu, Taiwan, where he is currently an Associate Professor. His research
interests include wireless transmission, sensor networks, mobile cellular
systems, and cryptography.
Cheng-Ju Chang (S’08) received the B.S. degree
in electrical engineering from Tamkang University,
Taipei, Taiwan, in 2001 and the M.S. degree in
communications engineering from National Tsing
Hua University, Hsinchu, Taiwan, in 2003. Currently,
he is working towards the Ph.D. degree with the
Institute of Communications Engineering, National
Tsing Hua University, Hsinchu, Taiwan.
His research interests include wireless communi-
cations, resource allocation, distributed estimation
and detection, and sensor networks.
at node k, under each of the two hypotheses, is given by{
H0 : yk = θ0 + vk
H1 : yk = θ1 + vk
, k = 1, 2, · · · , N,
where θi, i ∈ {0, 1}, is the signal of the hypothesis Hi to
be detected, and vk is the observation noise assumed to be
independent and identically distributed (i.i.d.) Gaussian with
zero mean and variance σ2. Without loss of generality, we set
the determined signals under hypotheses H0 and H1 as θ0 =
−1 and θ1 = 1, respectively. Correspondingly, the observation
signal-to-noise ratio (SNR) is defined as [5]
ρo
Δ= (θ1 − θ0)2
/
σ2 = 4
/
σ2.
Due to the bandwidth limitation of the communication
channel between sensor nodes and the fusion center, we
assume that each node transmits the quantized binary decision
to the fusion center, i.e., uk ∈ {−1,+1} representing H0
and H1, respectively. For node k, based on the maximum a
posteriori probability (MAP) test to minimize the probability
of error, the local decision rule is
λk
Δ= log
P (yk|H1)
P (yk|H0)
H1≥
<
H0
τ. (1)
The decision uk = +1 is sent if λk ≥ τ , or the decision is
uk = −1 for λk < τ , where λk is the LLR of the observation
yk and τ = log (π0/π1). Correspondingly, the false alarm
probability Pf and miss probability Pm, for the local decision
of node k, are defined as{
Pf = P (uk = +1|H0)
Pm =P (uk = −1|H1) , k = 1, 2, · · · , N.
At each sensor node, the quantized local decision is amplified
with a gain gk for transmission and the received signal at the
fusion center is modeled as
rk = gkuk + wk, k = 1, 2, · · · , N,
where wk is the additive communication channel noise as-
sumed to be Gaussian with zero mean and variance δ2k.
To simplify the analysis, the effect of propagation loss is
incorporated within the channel noise term. If the path loss
of a node is large, the corresponding signal to noise power
ratio at the fusion center will be small and a large value of
δ2k is applied. Whereas, if the path loss of a node is small, a
small value of δ2k is applied. To model a randomly distributed
network, the variance δ2k is assumed to be drawn randomly
from the Rayleigh distribution [2]. At the fusion center, the
equal gain combining (EGC) fusion rule [6], which requires
minimum amount of information, is adopted. Thus the decision
rule at the fusion center is
Λ =
1
N
∑N
k=1
rk
H1≥
<
H0
τ. (2)
The final decision uˆ = +1 is determined if Λ ≥ τ , or the final
decision is uˆ = −1 if Λ < τ .
2
~ (0, )kv N σ
Fusion 
center
= ,
1,2, ,
k k k kr g u w
k N
+
= 
2
~ (0, )k kw N δ
0 1/H H
Communication
Channels
Observation
Channels
Node 1y1
y2
yN
Observation
Noise
Communication
Noise
g1u1
g2u2
gNuN
Observation
Signal
Transmitted
Signal
Node 2
Node N
Source
Fig. 1. System model for distributed detection in WSNs.
III. LLR BASED POWER ALLOCATION SCHEMES
At each sensor node, to realize the observation quality
based power allocation, the transmission gain gk must follow
a specific power allocation rule depending on the quality of
the observation signal of node k. Based on the concept of
minimizing the local decision error probability, we define the
instantaneous observation quality corresponding to a specific
observation yk as
Γk =
∣∣∣∣log P (H1|yk)P (H0|yk)
∣∣∣∣ . (3)
For an observation with a large value of Γk, it is highly
probable that the local decision based on this observation
is correct. Hence, if the instantaneous observation quality
is high, the observation could be more reliable and a high
transmission power should be applied in order to resist the
communication channel noise. On the other hand, if the
instantaneous observation quality is low, the observation is
regarded as less reliable and a small transmission power is
applied in order to save energy consumption. According to
(1) and (3), the instantaneous observation quality of yk can be
related to the LLR λk as
Γk =
∣∣∣∣log P (yk|H1)P (yk|H0) − log
P (H0)
P (H1)
∣∣∣∣ =
∣∣∣∣2ykσ2 − τ
∣∣∣∣ . (4)
Obviously, the optimal power allocation function is a nonlinear
function of Γk. Here we apply a multi-degree polynomial to
approximate the transmission power as
g2(Γk) = (α + β
√
Γk + γΓk + · · ·)2, (5)
where α, β and γ are the optimal coefficients to be determined,
which can be figured out under a desired DEP. In this paper,
we consider three different power allocation schemes based
on (5). To minimize the total energy consumption with a
constraint of the required DEP, the power allocation problem
can be formulated as a constrained optimization problem.
The corresponding coefficients in (5) can then be solved
2
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:48 from IEEE Xplore.  Restrictions apply. 
It has been verified that (14) is a convex optimization
problem. From (11), (12), (13) and (15), the Lagrangian
function L can be written as
L (α, β, γ, μ) =
N∑
k=1
E
[
(gC(Γk))
2
]
+μ
{
π0Q
(
Nd0
e0
)
+ π1Q
(
Nd1
e1
)
− P¯e
}
,
(16)
where μ ≥ 0 is the Lagrange multiplier, and
d0 = τ − E [r¯c|H0] ,
d1 = E [r¯c|H1]− τ,
e0 = N
√
V ar [r¯c|H0],
e1 = N
√
V ar [r¯c|H1].
Then, the KKT conditions are given as
1. 2α + 2βE
[√
Γk
]
+ 2γE [Γk]
−μπ0 e
2
0(1−2Pf )−Nd0(4αPf (1−Pf )+βa0+γb0)√
2πe30
e
− (Nd0)2
2e2
0
−μπ1 e
2
1(1−2Pm)−Nd1(4αPm(1−Pm)+βa1+γb1)√
2πe31
e
− (Nd1)2
2e2
1 = 0,
2. 2αE
[√
Γk
]
+ 2βE [Γk] + 2γE
[√
Γ3k
]
+μπ0
e20E[
√
Γkuk]+Nd0(βV ar[
√
Γkuk]+αb0+γc0)√
2πe30
e
− (Nd0)2
2e2
0
−μπ1 e
2
1E[
√
Γkuk]−Nd1(βV ar[
√
Γkuk]+αb1+γc1)√
2πe31
e
− (Nd1)2
2e2
1 = 0,
3. 2αE [Γk] + 2βE
[√
Γ3k
]
+ 2γ
(
4
σ2 +
(
2
σ2 − τ
)2)
−μπ0 2e
2
0−Nd0(4γ+σ2(αb0+γc0))√
2πe30
e
− (Nd0)2
2e2
0
−μπ1 2e
2
1−Nd1(4γ+σ2(αb1+γc1))√
2πe31
e
− (Nd1)2
2e2
1 = 0,
4. μ
{
π0Q
(
Nd0
e0
)
+ π1Q
(
Nd1
e1
)
− P¯e
}
= 0,
5. π0Q
(
Nd0
e0
)
+ π1Q
(
Nd1
e1
)
− P¯e ≤ 0.
Hence, we can solve the coefficients α, β and γ that satisfy
the above KKT conditions, and all nodes transmit with the
power follow the power allocation function g2C(Γk).
It must be noted that the corresponding coefficients of the
power allocation function can be figured out off-line and then
are implemented within each node. After network deployment,
each node can control the transmission power based on the
embedded power allocation function and the instantaneous
observation.
IV. SIMULATION RESULTS AND DISCUSSION
In the simulation, we assume that the prior probabilities
of H0 and H1 are equal, i.e., π0 = π1 = 1/2, and the
local observation SNR is assumed to be ρo = 3dB. The
variance of channel noise δ2k is drawn randomly from the
Rayleigh distribution with the probability density function
f (x) = xη2 e
−x2/2η2
, x ≥ 0, where η2 = 2/π. The perfor-
mance of Scheme A is used as the benchmark, and the power
ratio, defined as
ζj =
total transmission power in Schemej
total transmission power in SchemeA
× 100%,
where j ∈ {B,C}, is introduced as a measure of power saving
efficiency. If the power ratio ζj is smaller than 100%, it implies
that Scheme j is more energy efficient than the equal power
scheme achieving the same DEP.
Since an approximation of r¯C based on CLT is applied in
(11), the achieved DEP may deviate from the desired DEP.
We examine the approximation accuracy of DEP in Fig. 2,
which shows the actually achieved DEP versus the desired
DEP for the number of nodes N = 100. For Scheme A, the
actually achieved DEP is the same as the desired DEP, since no
approximation is applied. For Scheme B or Scheme C, however,
the actually achieved DEP is slightly worse than the desired
DEP due to the approximation error of CLT, especially for the
case with a lower value of desired DEP.
Desired DEP
A
ch
ie
v
ed
 D
EP
Scheme A
Scheme B
Scheme C
-110-5 10-4 10-3 10-2 10
10-5
10-4
10-3
10-2
10-1
Fig. 2. The actually achieved DEP versus the desired DEP with the number
of nodes N = 100.
Fig. 3 shows the power ratio versus the desired/achieved
DEP for the number of nodes N = 100. For the solid lines
noted by “Approximated”, the X-axis is the desired DEP,
which is theoretically achievable based on the CLT approxi-
mation. However, according to Fig. 2, we have addressed that
the actually achieved DEP is worse than the desired DEP for
Scheme B and Scheme C. By using the results shown in Fig.
2, we have the dash lines, noted by “Actual”, with the X-
axis being the actually achieved DEP and the corresponding
power ratios are obtained by compared with Scheme A with the
actually achieved DEP. Therefore, we can find that the power
ratios of the approximated results are slightly smaller than the
actual results. According to the actual results, the proposed
schemes can save more than 20 % of energy for P¯e = 10−1
and more than 35 % of energy for P¯e = 10−4. Moreover, it
is found that Scheme B and Scheme C have almost the same
performance. This implies that Scheme B can be applied in
order to reduce the computational complexity at sensor nodes.
4
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:48 from IEEE Xplore.  Restrictions apply. 
Sequential Fusion with Truncated SPRT for Event
Detection in Centralized and Decentralized Wireless
Sensor Networks
Yuh-Ren Tsai and Li-Cheng Lin
Institute of Communications Engineering
National Tsing Hua University
101, Sec. 2, Kuang-Fu Rd., Hsinchu 300, Taiwan
Email: yrtsai@ee.nthu.edu.tw
Abstract—In this work, the sequential fusion scheme is used
to save the energy consumption for events detection in wireless
sensor networks (WSNs). The fusion center (FC) sequentially
accumulates the information forwarded by nodes, and broadcasts
a termination message to stop the transmission of nodes when the
accumulated information is enough for decision-making. Thus
the average number of forwarded messages, as well as the
average energy consumption, can be significantly reduced. Since
the number of sensor nodes is generally limited, the truncated
sequential probability ratio test (TSPRT) is applied at the FC.
The main goal of this paper is to propose analytical approaches,
for both centralized and decentralized detection, to determine
the thresholds for TSPRT. According to the simulation results,
with little performance degradation, the average number of
transmissions can be greatly reduced compared with the non-
sequential fusion scheme.
Index Terms—Sequential detection; wireless sensor network
(WSN); decentralized detection; fusion.
I. INTRODUCTION
Detection of events is an important application for wireless
sensor networks (WSNs), where geographically distributed
sensor nodes are deployed over the sensing area. Each node
collects the data related to the interesting event and then
forwards its observation or local decision to the fusion center
(FC) through the wireless communication channel. The FC
makes a global decision based on the messages received from
the sensor nodes, and possibly triggers an appropriate action.
Since energy is usually the scarcest resource for sensor nodes,
efficient use of energy is one of the critical issues for WSNs.
Due to that the energy consumption for sensing and data pro-
cessing is generally less than that for message transmissions
[1], one of the major tasks is to reduce the average number of
transmissions, under a predetermined performance constraint,
for preserving the available energy and prolonging network
lifetime.
For the problem of event detection, the sequential probabil-
ity ratio test (SPRT) has been proven that the average number
of required samples (or observations) is much less than the
fixed sample size (FSS) detector for achieving the desired false
†This work was supported in part by the National Science Council, Taiwan,
R.O.C., under Grant NSC 97-2221-E-007-074-MY3.
alarm and miss probabilities [2]. In [3], SPRT is applied at the
sensor node, and an iterative algorithm is proposed to find the
thresholds for the local decision rule. However, this approach
is not suitable for WSNs because sensor nodes are generally
subject to a stringent energy constraint and weak computation
capability. In this work, we suggest SPRT is performed at
the FC which is more powerful for computation and with a
loose energy constraint. The FC sequentially accumulates the
information forwarded by nodes, and broadcast a termination
message to stop the transmission of all remaining nodes when
enough information has been acquired for decision-making.
Thus the average number of forwarded messages, as well as
the average energy consumption, can be significantly reduced.
For conventional SPRT, the number of samples is assumed
to be infinite and the sequential test process is stopped when
the accumulated information exceeds one of the thresholds
predetermined by the desired performance. Nevertheless, since
the number of nodes is generally limited in WSNs, the
truncated SPRT (TSPRT) is applied where the decision rule is
given when all of the observations have been received but
the threshold has never been exceeded. The main goal of
this paper is to propose an analytical approach to determine
the thresholds for TSPRT when the desired performance is
given. We investigate the sequential fusion under two different
scenarios, centralized and decentralized, depending on the
information available at the FC. The performance of sequential
fusion for both centralized and decentralized environments is
examined in simulations.
The remainder of this paper is organized as follows. Prob-
lem statement is given in Section II. In section III, we propose
the analytical approaches to determine the thresholds for
the centralized and decentralized detection with TSPRT. The
simulation results are presented in Section IV; and finally, the
conclusion is offered in Section V.
II. PROBLEM STATEMENT
A. System Model
Consider a wireless sensor network with a finite number
of sensor nodes n0. Each sensor node performs the same
functions of sensing and data processing for testing two
978-1-4244-2515-0/09/$25.00 ©2009 IEEE
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:38 from IEEE Xplore.  Restrictions apply. 
decision, since the number of available observations is limited
to n0. Hence, the false alarm and miss probabilities, defined
as α(n0) and β(n0), respectively, are bounded by [2]{
α(n0) ≤ α + ρ0(n0)
β(n0) ≤ β + ρ1(n0) , (5)
where α and β are the achieved false alarm and miss proba-
bilities for the non-truncated SPRT with thresholds A and B.
ρ0(n0) is the probability, condition on H0, that the truncated
process leads to a decision of H1, while the non-truncated
process leads to H0. Similarly, ρ1(n0) is the probability,
condition on H1, that the truncated process leads to a decision
of H0, while the non-truncated process leads to H1. Since it
is very difficult to determine the value of ρ0(n0) and ρ1(n0),
the upper bounds can be expressed as
ρ0(n0) ≤ P
(
Λ ≤ (θ1−θ0)
∑n0
i=1
xi−n0(θ21−θ20)/2
σ2 ≤ logA
∣∣∣∣H0
)
= Q
(
σ2Λ+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
−Q
(
σ2 log A+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
(6)
and
ρ1(n0) ≤ P
(
logB ≤ (θ1−θ0)
∑n0
i=1
xi−n0(θ21−θ20)/2
σ2 < Λ
∣∣∣∣H1
)
= Q
(
σ2 log B+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
−Q
(
σ2Λ−n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
,
(7)
respectively, where Q(·) is the Q-function. Also, recalling (3),
the upper bounds of α and β are given by
α ≤ 1/A, β ≤ B (8)
Therefore, from (5)-(8), the upper bounds of α(n0) and β(n0)
can be obtained as
α(n0) ≤ 1A + Q
(
σ2Λ+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
−Q
(
σ2 log A+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
) (9)
and
β(n0) ≤ B + Q
(
σ2 log B+n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
−Q
(
σ2Λ−n0(θ1−θ0)2/2√
n0(θ1−θ0)σ
)
.
(10)
Accordingly, the desired thresholds A and B can be
determined for a target decision error performance
(α(n0), β(n0)) = (Pf , Pm).
B. Decentralized Detection with Truncated SPRT
In practical situations, the communication channel is noisy
and with limited available bandwidth. Thus decentralized
detection is applied at the FC. Furthermore, due to energy
limitation, we assume that each node employs a one-bit quan-
tizer with the output message ui ∈ {+1,−1}, representing the
hypotheses H1 and H0, respectively. The local decision rule
0 1 2-1-2 ……
1-q 1-q1-q1-q
q q
1
11-q 1-q
qq
1-q
qqq
A A-1 B  B+1 
(a) For the hypothesis H0
0 1 2-1-2 ……
1
1
p p ppp p p
1-p 1-p 1-p1-p1-p 1-p 1-p
B  B+1  A A-1 
(b) For the hypothesis H1
Fig. 2. The markov chains for D-TSPRT at the fusion center.
for node i, based on the maximum a posteriori probability
(MAP) test [5], is
ui = γ(xi) =
{
+1, if log (P(H1|xi)/P(H0|xi)) ≥ 0
−1, if log (P(H1|xi)/P(H0|xi)) < 0 .
(11)
Assume that the communication channel is a binary symmet-
ric channel (BSC) with the crossover probability pc, where
pc = P (yi = +1 |ui = −1) = P (yi = −1 |ui = +1). The
conditional probabilities of the received signal at the FC are{
p = P(yi = +1|H1) = p1(1− pc) + (1− p1)pc
q = P(yi = −1|H0) = p0(1− pc) + (1− p0)pc , (12)
where p1 = P(ui = +1|H1) and p0 = P(ui = −1|H0).
At the FC, decentralized detection with truncated SPRT (D-
TSPRT) is performed. For n < n0, D-TSPRT makes a decision
based on the rule
n∑
i=1
yi
⎧⎨
⎩
≥ A˜, H1 is chosen
≤ B˜, H0 is chosen
else, n = n + 1
, (13)
where integers A˜ and B˜ are the upper threshold and lower
threshold, respectively. If D-TSPRT does not lead to a termi-
nation with final decision for n < n0, then all the observations
are used for decision-making based on⎧⎨
⎩
Γ <
∑n0
i=1 yi ≤ A˜, H1 is chosen
B˜ ≤∑n0i=1 yi < Γ, H0 is chosen∑n0
i=1 yi = Γ, H1 or H0 is chosen equiprobably
, (14)
where
Γ = 2× Λ + n0 log(q/(1− p))
log(pq/(1− q)(1− p)) − n0.
The remaining question is how to determine the thresholds A˜
and B˜ to satisfy the desired false alarm and miss probabilities.
As shown in Fig. 2, the D-TSPRT process at the FC can
be modeled as markov chains [6], where the zero state is the
initial state and the thresholds A˜ and B˜ are the absorbing
states. The false alarm probability αd(n0) for D-TSPRT with
n0 nodes can be expressed as
αd(n0) = P
(a)
A˜|H0 + P
(na)
ΓA˜|H0 + P
(na)
Γ|H0
/
2 (15)
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:38 from IEEE Xplore.  Restrictions apply. 
with little performance degradation. Also, if we can tolerate
more performance degradation, the more transmission energy
consumption can be saved.
B. Simulation Results for D-TSPRT
For decentralized detection, if the messages of all sensor
nodes are used for decision-making at the FC, the minimum
detection error probability can be obtained by using the
Bayesian hypothesis testing, where the corresponding false
alarm probability P df and miss probability P dm are given by
P df =
∑n0
i=(Γ+n0)/2+η(Γ) C
n0
i (1− q)iqn0−i
+η(Γ)
(
1
2C
n0
(n0+Γ)/2
(1− q)(n0+Γ)/2 q(n0−Γ)/2
)
(24)
and
P dm =
∑n0
i=(−Γ+n0)/2+η(Γ) C
n0
i p
i(1− p)n0−i
+η(Γ)
(
1
2C
n0
(n0+Γ)/2
p(n0+Γ)/2 (1− p)(n0−Γ)/2
)
(25)
Similar to C-TSPRT, we set (P df , P dm) as the target perfor-
mance in the simulation and the normalized errors are defined
as {
εdα = (αd (n0)− P df )/P df
εdβ = (βd (n0)− P dm)/P dm
(26)
From (20) and (26), by setting A˜ = n0 and B˜ = −n0, we
have the normalized errors εdα = 0 and εdβ = 0. However,
with acceptable performance degradation, we can use the
upper bounds of αd(n0) and βd(n0) in (20) to determine
the thresholds for energy saving. Fig. 4 shows the average
number of transmissions versus the detection error probability,
with different desired normalized errors. We can find that D-
TSPRT needs less average number of transmissions for ap-
proaching the optimal performance where all the observations
are transmitted. With 0.1% of performance degradation, about
50% of transmission energy consumption can be efficiently
saved. Also, if more degradation can be tolerated, the more
transmission energy consumption can be saved.
V. CONCLUSION
We have proposed the sequential fusion scheme for events
detection in WSNs. The TSPRT is performed at the FC
where the transmission of sensor node is halted for saving
the transmission energy if the enough information has been
collected. For both centralized and decentralized detection,
the analytical methods for finding the thresholds for TSPRT
are given. The simulation results show that on average the
proposed schemes require the fewer transmissions compared
with the non-sequential fusion scheme for approaching the
same detection error probability.
REFERENCES
[1] B. M. Sadler, “Fundamentals of energy-constrained sensor network
systems” IEEE Aerosp. Electron. Syst. Mag, vol. 20, no. 8, pp. 17-35,
Aug. 2005.
[2] A. Wald, Sequential Analysis, Dover, New York, 1947.
10-4 10-3 10-2 10-1
20
40
60
80
100
120
140
160
Bayesian
C-TSPRT
C-TSPRT 1 1( 10 , 10 )c cα βε ε− −≤ ≤
2 2( 10 , 10 )c cα βε ε− −≤ ≤
A
ve
ra
ge
 N
um
be
r o
f T
ra
n
sm
iss
io
ns
Detection Error Probability
Fig. 3. The average number of transmissions versus the detection error
probability for C-TSPRT.
10-5 10-4 10-3 10-2 10-1
20
40
60
80
100
120
140
160
Detection Error Probability
A
ve
ra
ge
 N
um
be
r o
f T
ra
n
sm
iss
io
ns Bayesian
D-TSPRT
D-TSPRT 1 1( 10 , 10 )d dα βε ε− −≤ ≤
2 2( 10 , 10 )d dα βε ε− −≤ ≤
Fig. 4. The average number of transmissions versus the detection error
probability for D-TSPRT.
[3] L. Yu and A. Ephremides. “Detection Performance and Energy Ef-
ficiency of Sequential Detection in a Sensor Network” in Proc. of
International Conference on System Sciences, Hawaii , Jan. 2006.
[4] G. Ferrari and R. Pagliari, “Decentralized binary detection with noisy
communication links” IEEE Trans. on Aerospace and Electronic Sys-
tems, vol. 42, no. 4, pp. 1554-1563, Oct. 2006.
[5] H.V. Poor, An Introduction to Signal Detection and Estimation, New
York: Springer-Verlag, 1988.
[6] H. Stark and J. W. Woods, Probability and Random Processes with
Application to Signal Processing, 3rd Prentice Hill, 2002.
[7] W. Feller, An Introduction to Probability Theory and Its Applications,
2nd ed, New York: Wiley, 1971, vol. II.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:38 from IEEE Xplore.  Restrictions apply. 
 .
 
.
 
.
 
.
 
.
 
.
1,1c
N Nx nθ= +
k kx nθ= +
 
.
 
.
 
.
 
.
 
.
 
.
1 1x nθ= +
( )1ˆ ˆLQθ −= b
2(0, )N σ cε
1,1c 
θ
Source
Fusion Center
Sensor Node 1
Observation 
Channel
Communication 
Channel
Quantization ( )1LQ x Selection of transmitted bit
,k kc
Sensor Node k
Quantization ( )L kQ x Selection of transmitted bit
,N Nc
Sensor Node N
Quantization ( )L NQ x Selection of transmitted bit
,k kc 
,N Nc 
Hard Decision 
and 
Dequantization
Fig. 1. The considered system model for WSNs.
III describes the proposed scheme and the optimization of
the resource allocation problem. In Section IV, the numerical
results of the optimal resource allocation policy and the
simulation results of the MSE performance are presented.
Finally, the conclusion is drawn in Section V.
II. SYSTEM MODEL AND PROBLEM FORMULATION
The considered WSN system model is depicted in Fig. 1,
which consists of N sensor nodes and one FC. At each ob-
servation interval, each node makes a noisy local observation
xk = θ + nk for k = 1, 2, · · · , N , where θ is the unknown
desired parameter and nk denotes the observation noise which
is assumed to be additive white Gaussian noise (AWGN)
with zero mean and variance σ2. The observation noises
are assumed to be independent and identically distributed
(i.i.d.) for all nodes. The local observation xk is bounded by
[−W, W ], where W is a pre-determined value corresponding
to the possible range of θ.
For band-limited transmission, each node quantizes the local
observation into L bits by using the midtread uniform quan-
tizer. According to the observation quality, the quantization bit
length L is properly determined by applying the policy shown
in [6], i.e.
L = log2 (W/σ) . (1)
The quantization step size can then be determined as Δ =
2W
/(
2L − 1). For node k, the quantized information bits can
be expressed as
bk = QL (xk)
= [bk,1, bk,2, · · · , bk,L]T , k = 1, 2, · · · , N, (2)
where QL (·) denotes the operation of L-bit midtread uniform
quantizer, and bk,1 represents the most significant bit (MSB).
In order to save the energy consumption and bandwidth
expense, only one bit is transmitted from each node in our
proposed scheme. Thus we can deduce that the total received
bits available for distributed estimation at the FC is equal to
the number of sensor nodes N .
The communication channel between each node and the FC
is modeled as the binary symmetric channel (BSC) with the
identical crossover probability εc. All the system parameters,
including N , W , σ, L and εc, are assumed to be available.
However, any information exchange among the sensor nodes
is not allowed. Moreover, it is reasonable to assume that the
quantization bit length must be much smaller than the number
of nodes, i.e. L  N .
III. THE PROPOSED SCHEME AND OPTIMIZATION
In this section, we present the procedure of our proposed
distributed estimation scheme and derive the optimal solution
of the resource allocation problem formulated within it.
A. The Proposed Scheme
To improve the estimation performance and to resist the
errors through BSCs, it is highly desirable to have unequal
protection for the quantized information bits with different
importance. In this work, we apply the repetition code through
all nodes for information protection, and each quantization bit
is repeated to a specific length. In other words, at each node,
the L-bit quantized local observation is extended to an N -bit
codeword by a pre-determined formulation and then only one
bit is chosen from the N -bit codeword for transmission.
The mapping from the L-bit local observation to an N -bit
codeword can be regarded as a resource allocation problem.
Assuming that the resource allocated to the l-th information
bit is Rl bits, where Rl is an integer for l = 1, 2, · · · , L, we
have the constraint
∑L
l=1 Rl = N . Specifically for node k, the
N -bit codeword can be expressed as
Ck = [ck,1, ck,2, · · · , ck,N ]T , (3)
where the first R1 bits, i.e. {ck,1, · · · , ck,R1}, are all equal to
the MSB bk,1, the following R2 bits are all equal to bk,2, and
so on. Then only one bit in Ck is chosen for transmission, and
the N nodes are designed to transmit different codeword bits
in order to cooperatively form the complete N -bit codeword
at the fusion center. It should be noted that the mapping
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:39 from IEEE Xplore.  Restrictions apply. 
and
E [el] = P (el = 1)
= 1− FB (Rl/2 ; Rl, ε′c(l))
= FB (Rl/2 ; Rl, 1− ε′c(l)) ,
(13)
where FB(·) denotes the cumulative density function (CDF) of
the Binomial distribution, and · denotes the floor function.
Since Δ and L are fixed and known parameters, the optimiza-
tion problem becomes
min
L∑
l=1
FB (Rl/2 ; Rl, 1− ε′c(l))× 22(L−l)
s.t.
L∑
l=1
Rl = N.
(14)
By applying the Stirling’s approximation and some derivations,
the FB(·) can be upper bounded [9] as
FB (αn; n, p) ≤ 1−α1−(α/p) · 2
n·H(α)√
2πα(1−α)n
· pαn · (1− p)(1−α)n ,
(15)
where H (·) is the binary entropy function, α represents the
fraction of flips in n Bernoulli trials, and α < p. By setting
α = 0.5, (15) can be used to bound the FB(·) in (14) providing
that ε′c(l) < 0.5, which is loose and can be guaranteed. Finally
our optimization problem is re-formulated as
min f0 (R) =
L∑
l=1
0.5×2Rl×
√
((1−ε′c(l))·ε′c(l))Rl×22(L−l)√
0.5πRl×[1−(0.5/(1−ε′c(l)))]
s.t. fl (R) = −Rl ≤ 0, for l = 1, · · · , L,
h (R) =
L∑
l=1
Rl −N = 0.
(16)
The Karush-Kuhn-Tucker (KKT) conditions [10] of (16) are⎧⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
−Rl ≤ 0, λl ≥ 0, −λlRl = 0, l = 1, · · · , L
L∑
l=1
Rl −N = 0
∇f0 (R) +
L∑
l=1
λl∇fl (R) + v∇h (R) = 0
, (17)
where ∇ denotes the gradient function, and v is a constant
which is chosen such that
∑L
l=1 Rl−N = 0. We can infer that
λl = 0, ∀l, from the complementary slackness condition [10]
of (17), and then R can be obtained by solving the following
equations:⎧⎪⎪⎪⎨
⎪⎪⎪⎩
RlC1(l) + ln
(
2RlC1(l)−1
(Rl)
1.5
)
= ln
(
−2v
C2(l)
)
C1(l) = ln
(
2
√
ε′c(l) (1− ε′c(l))
)
C2(l) = π
−0.5·22(L−l)−0.5
1−(0.5/ε′c(l))
, (18)
where C1 (l) and C2 (l) are constants for each l. Since
the objective function shown in (16) can be shown to be
convex with respect to R = [R1, R2, · · · , RL]T , the global
optimum can therefore be found easily. The optimal resource
allocation R can be calculated in advance, providing that all
the necessary system parameters are known. Then the mapping
between quantization information and the N -bit codeword, as
well as the indices of transmission bits for all nodes, can be
determined beforehand.
IV. SIMULATION RESULTS
In this section, we provide the simulation results
to compare the estimation performance among differ-
ent resource allocation policies in our proposed co-
operative information aggregation scheme (CIA) which
are the significance based resource allocation (CIA-
SBRA) whose policy is {Rl = 2−l ·N : l = 1, · · · , L},
the equal resource allocation (CIA-ERA) whose policy is
{Rl = N/L : l = 1, · · · , L}, and the optimal resource al-
location (CIA-ORA) derived in our work. The other estimator
to provide the performance lower bound is the quantized
source estimator (QSE) whose estimation immediately comes
from the quantized version of the desired signal, i.e. the only
imperfection is the quantization noise. Besides, the perfor-
mances of the one bit adaptive quantization approach with
fixed step size (OBAQ) proposed in [2] and the quasi-BLUE
scheme (QBLUE) proposed in [5] are given for comparison as
well. Our simulations are accomplished under the conditions
W = 10, σ = 0.3, and L = 6, i.e. the observation
signal-to-noise ratio (OSNR) is 30 dB since its definition is
OSNR = 10 log10
(
W 2
/
σ2
) [5]. It should be noted that L = 6
is the optimal quantization bit length shown in [5] for the
considered case of OSNR=30 dB, and the step size used in
OBAQ is set to Δs = 1.
Fig. 3(a) shows the fraction of allocated resource of CIA-
SBRA, CIA-ERA and CIA-ORA under the system parameters
W = 10, σ = 0.3, L = 6, N = 100, and εc = 0.01, 0.2 and
0.4 respectively. We can observe that the CIA-ORA allocates
more resource to the less significant bits when εc = 0.01,
and increases the resource allocated to the more significant
bits while εc is getting higher. The corresponding normalized
MSE (NMSE) performances versus varying εc are given in
Fig. 3(b), where we can find that the CIA-ERA works better
than the CIA-SBRA in case εc is quite low, but the CIA-
SBRA performs better than the CIA-ERA in the contrary case.
However, the CIA-ORA always outperforms the CIA-SBRA
and the CIA-ERA in the overall considered range of εc, and
it can provide better NMSE performance than the OBAQ and
the QBLUE as well.
The fraction of allocated resource of CIA-SBRA, CIA-ERA
and CIA-ORA under the system conditions W = 10, σ = 0.3,
L = 6, εc = 0.3, and N = 100, 500 and 1000 respectively
are illustrated in Fig. 4(a). We can see that the CIA-ORA
focuses on the protection for the more significant bits in the
case N = 100, and it gradually enhances the protection for
the less significant bits while N is getting larger, i.e. more and
more resource is given. Fig. 4(b) depicts the corresponding
NMSE performances versus varying N . It can be found that
the CIA-ORA works better than the CIA-SBRA, the CIA-
ERA, the OBAQ, and the QBLUE in the overall considered
range of N . The QBLUE apparently lacks the ability to resist
the high εc and can not benefit from the increasing resource
number. Oppositely, the CIA-ORA can effectively eliminate
the detrimental effect caused by the observation noises and the
transmission errors, and performs close to the QSE as long as
Authorized licensed use limited to: National Tsing Hua University. Downloaded on February 8, 2010 at 23:39 from IEEE Xplore.  Restrictions apply. 
Cooperative Information Aggregation based
Distributed Sequential Estimation in Wireless
Sensor Networks
Cheng-Ju Chang and Yuh-Ren Tsai
Institute of Communications Engineering
National Tsing Hua University
101, Sec. 2, Kuang-Fu Rd., Hsinchu 300, Taiwan
Email: yrtsai@ee.nthu.edu.tw
Abstract—The cooperative information aggregation (CIA)
scheme for distributed estimation was proposed in our past
research considering the realistic wireless sensor network (WSN)
environments. In the existing CIA scheme, a multi-bit quantizer
is applied at all nodes, however, each node only transmits one pre-
determined bit of its quantized observation to the fusion center
(FC) to economize the energy expense and the communication
bandwidth. In this work, the CIA based distributed sequential
estimation (CIAS) scheme is proposed. In the proposed CIAS
scheme, an instruction message is designed to be sent from the
FC to the nodes sequentially to guide each node’s transmitted bit
selection. By sequentially polling the information bits from the
nodes, the vote processes performed at the FC for the data fusion
may be early terminated depending on the accumulative received
information bits, and thereby numerous resource bits can be
conserved in the estimation procedure. We design two algorithms
for the CIAS scheme as well to pursue the promotion of energy
conservation and estimation achievement. In the simulation
results, considerable energy saving and estimation performance
improvement in the proposed CIAS scheme are demonstrated,
in comparison with the existing CIA scheme.
Index Terms—Wireless sensor network (WSN); distributed
sequential estimation; imperfect channel.
I. INTRODUCTION
Distributed estimation is one of the most interesting appli-
cations in emerging wireless sensor network (WSN) technolo-
gies. Under the constraints of limited energy and communica-
tion bandwidth of sensors, a number of distributed estimation
methods have been proposed. In [1], a one-bit quantizer was
applied so that each node only transmits one bit to represent its
observation. However, selection of the appropriate quantization
threshold highly depends on the unknown parameter that to be
estimated. To address the problem, [2] and [3] proposed adap-
tive quantization schemes to dynamically adjust the quantiza-
tion threshold so that it gradually approaches an optimal value
and a good estimation performance is achieved. However,
information exchange among nodes is essential in the adaptive
quantization schemes, which increases the communication
overhead. Based on the best linear unbiased estimator (BLUE)
[4], a quasi-BLUE approach was proposed in [5] and [6].
†This work was supported in part by the National Science Council, Taiwan,
R.O.C., under Grant NSC 97-2221-E-007-074-MY3.
In [7] and [8], universal decentralized estimation schemes
were proposed for noisy sensing environments. Considering
the noisy observations and imperfect communication channels
in realistic WSN environments, the cooperative information
aggregation (CIA) scheme was proposed in our previous work
[9]. In the existing CIA scheme, a multi-bit quantizer is
applied at all nodes, however, only a pre-determined bit of
the quantized observation is transmitted from each node to
the FC. The information bits cooperatively sent by all nodes
are finally aggregated at the FC and fused via the majority
principle based vote processes to reconstruct the quantization
codeword and generate the estimate. No information exchange
among the nodes is required in the CIA scheme.
In this paper, we propose a CIA based distributed sequential
estimation (CIAS) scheme. In the CIAS scheme, an instruction
message is designed to be sent from the FC to the nodes
sequentially to instruct each node’s selection of its transmitted
bit. Thus, the vote processes can be possibly terminated early
depending on the accumulative received information bits as
long as the majority criterion is achieved, and then numerous
resource bits can be saved in the estimation procedure. Two
algorithms are designed for the CIAS scheme to conserve the
energy consumption and improve the estimation performance
compared with the existing CIA scheme.
The rest of this paper is organized as follows. Section II
shows the considered system model. Section III first introduces
the existing CIA scheme, and then elucidates the proposed
CIAS scheme and the two algorithms designed for it. In
Section IV, the simulation results to evaluate the performance
of the CIAS scheme are presented. Finally, the conclusion is
drawn in Section V.
II. SYSTEM MODEL
The considered WSN system model is depicted in Fig.
1, which comprises K sensor nodes and one FC. At each
observation interval, each node makes a noisy observation
xk = θ + nk for k = 1, 2, · · · ,K, where θ is the unknown
desired parameter to be estimated, and nk denotes the obser-
vation noise which is assumed to be additive white Gaussian
noise (AWGN), independent and identically distributed (i.i.d.)
978-1-61284-231-8/11/$26.00 ©2011 IEEE
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2011 proceedings
where PR (el = 1) is the average flipping probability of the
l-th bit, and δl is the average square error caused by the
flip of the l-th bit. For the l-th quantized information bit
of node k, the average error probability caused by the ob-
servation noise can be calculated by εo (l)
Δ= P (Ok, l =
Ol) = 2l−1
/
W
∫W
0
Q ((W − x)/σ) dx, where Q(u) =(
1
/√
2π
) ∫∞
u
e−t
2/2dt. To facilitate the analysis, the obser-
vation channel is deemed noise free in the derivation, and the
effect of observation noise is merged into the communication
channels. Thus, the communication channels are regarded as
a set of equivalent BSCs whose crossover probabilities ε′c(l),
for l = 1, · · · , L, are higher than the original value εc. ε′c(l)
can be obtained by
ε′c (l) = (1− εo(l))× εc + εo(l)× (1− εc)
= εc + (1− 2εc)× εo(l)
> εc, l = 1, · · · , L,
(4)
where the inequality holds when 0 ≤ εc < 0.5. According
to the majority principle, the statistics of el in (3) can
be derived as PR (el = 1) = FB (	Rl/2
 ; Rl, 1− ε′c(l)),
where FB (k; n, p) represents the cumulative density function
(CDF) of the binomial distribution, n is the total number of
Bernoulli trials, p is the success probability of each trial,
and k is the number of successes in n trials. By applying
the Stirling’s approximation for factorials and the excellent
upper bound of binomial CDF [11], PR (el = 1) can be
approximated as
PR (el = 1) ≈ 2
Rl [1− ε′c(l)] [ε′c(l) (1− ε′c(l))]Rl/2√
0.5πRl [1− 2ε′c(l)]
. (5)
The average square error δl caused by the flip at the l-th bit
is derived as follows. Assuming that level q is the correct
quantization level, we denote dq,l as the distance, measured
in the quantization step size Δ, between the q-th level and
the resultant level by flipping the l-th bit. Table I shows
an example of dq,l in BRGE with L = 3. Because of the
symmetry of BRGE codewords, we only need to consider the
values of dq,l, for 0 ≤ q ≤ 2L−l − 1, in the calculation of δl.
Consequently, the calculation of δl can be expressed as
δl =
∑2L−l−1
q=0 (dq,l ·Δ)2
2L−l
=
(
22(L−l+1) − 1)
3
Δ2, (6)
where dq,l = 2L−l+1−2q−1, for 0 ≤ q ≤ 2L−l−1. Based on
(5) and (6), the objective function of (3) can be approximated
and the optimization problem is reformulated as
R˜ Δ= arg min
R
g¯(R) =
L∑
l=1
(
2Rl [1−ε′c(l)][ε′c(l)(1−ε′c(l))]Rl/2√
0.5πRl[1−2ε′c(l)]
× [(22(L−l+1) − 1)Δ2/3])
s.t. μl (R) = −Rl ≤ 0, for l = 1, · · · , L,
h (R) =
L∑
l=1
Rl −K = 0.
(7)
The objective function of (7) can be easily shown to be
convex. Therefore, the suboptimal resource allocation vector
R˜ can be solved via the convex optimization [12] approaches.
Through some manipulation, R˜ can be obtained by solving
the following equations:⎧⎪⎨
⎪⎩
2R˜lC1(l)
R˜l/2(R˜l)−1/2
[
ln
(
2
√
C1 (l)
)
− 1
/
2R˜l
]
= −v∗/C2 (l), l = 1, · · · , L∑L
l=1 R˜l −K = 0
,
(8)
where C1 (l) and C2 (l) are defined as{
C1(l) = εc′(l) (1− εc′(l))
C2(l) =
[1−εc′(l)][(22(L−l+1)−1)Δ2/3]√
0.5π[1−2εc′(l)]
. (9)
Therefore, R˜ can be pre-determined according to the system
parameters. Note that R˜ in the CIA scheme does not change
during the estimation procedure.
C. CIA based Distributed Sequential Estimation (CIAS)
Scheme
The operation of our proposed CIA based distributed se-
quential estimation (CIAS) scheme is diagrammed in Fig.
2. In the CIAS scheme, the default resource allocation is
following the suboptimal strategy R˜ derived in Section III.B.
An instruction message is designed to be sent from the FC
to the nodes sequentially to instruct each node’s transmitted
bit selection, i.e. each node waits for the instruction message
from the FC to choose the transmitted bit from its observation
vector. At the FC, the received bits from the nodes representing
their l-th quantized information bit are fused to yield Oˆl, via
the majority vote. We denote V Pl as the vote process to yield
Oˆl, for l = 1, · · · , L. In V Pl, the FC sequentially sends the
instruction message to the nodes within the R˜l nodes to acquire
the l-th bits of their observation vectors. Denote N0 (n) and
N1 (n) as the accumulative amount of symbol ”0” and symbol
”1” respectively after polling the l-th bit of the n-th node in
the R˜l nodes. V Pl can be early terminated for n < R˜l as
long as the criterion N0 (n) > R˜l
/
2 or N1 (n) > R˜l
/
2 is
reached, i.e. the value of Oˆl can be decided to be ”0” or ”1”
accordingly and the remaining R˜l−n nodes in V Pl are saved.
If the value of Oˆl can not be settled until n = R˜l, i.e. all the
R˜l nodes are consumed, then no any resource node is saved
in V Pl.
V Pl is executed for l = 1, · · · , L at the FC to generate the
aggregated observation vector Oˆ, then the de-quantization op-
eration is applied to Oˆ to produce the estimation result. Since
each vote process can be immediately terminated providing the
termination criterion is satisfied, a great amount of resource
bits can be saved in the whole estimation procedure. It should
be noticed that the FC usually possesses much more sufficient
energy supply than the nodes, so the instruction message sent
by the FC in our design of the proposed CIAS scheme will not
lead to a heavy burden of the whole system. The details of the
two algorithms designed for the CIAS scheme are explained
in the following sub-sections.
D. Energy Saving (ES) Algorithm
The first algorithm we designed for the CIAS scheme is the
energy saving (ES) algorithm. Basically, the design orientation
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2011 proceedings
1 2 3 4 5
0
20
40
60
1 2 3 4 5
0
20
40
60
1 2 3 4 5
0
20
40
60
Quantized Information Bit Index l
A
ve
ra
ge
 
Fr
ac
tio
n 
of
  C
o
n
su
m
ed
 
Re
so
u
rc
e 
(%
) CIA-SORA
CIAS-SORA-ES
CIAS-SORA-PI
CIA-SORA
CIAS-SORA-ES
CIAS-SORA-PI
CIA-SORA
CIAS-SORA-ES
CIAS-SORA-PI
0cε =
0.2cε =
0.4cε =
Fig. 5. The comparison of average fraction of
consumed resource for each quantized information bit.
A
ve
ra
ge
 
Fr
ac
tio
n 
of
 T
ot
al
 C
o
n
su
m
ed
 
Re
so
u
rc
e 
(%
)
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.465
70
75
80
85
90
95
100
BSC Crossover Probability εc
CIA-SORA
CIAS-SORA-PI
CIAS-SORA-ES
Fig. 6. The comparison of average fraction of
total consumed resource.
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.410
-4
10-3
10-2
10-1
100
N
M
SE CIA-SRA
CIA-ERA
CIA-SORA
CIAS-SORA-PI
CIAS-SORA-ES
AQ-ML
QBLUE
BSC Crossover Probability εc
Fig. 7. The comparison of NMSE among the
considered schemes.
increases as εc raises from 0 to 0.4, i.e. the protection for more
significant bits is enhanced under a poor channel condition.
The average fraction of consumed resource for each quantized
bit in CIAS-SORA-ES is lower than that of CIA-SORA, since
the conserved resource of each vote process in CIAS-SORA-
ES will not be relocated. In CIAS-SORA-PI, less resource
is spent to transmit more significant bits, and more resource
is spent to transmit less significant bits, compared with CIA-
SORA. It results from the remaining resource rearrangement
strategy in the PI algorithm, i.e. the conserved resource in
earlier vote processes is relocated to later vote processes.
The comparison of average fraction of total consumed
resource versus εc is depicted in Fig. 6. CIA-SORA is shown
to always consume 100% of total resource. We can find that
CIAS-SORA-ES simply spends 67% to 87% of total resource
as εc raises from 0 to 0.4, while CIAS-SORA-PI spends 84%
to 99%. Saving the total consumed resource is equivalent to
saving the total energy expenditure, therefore, it is shown
that CIAS-SORA-ES can greatly save the energy expense and
CIAS-SORA-PI can slightly economize the energy consump-
tion, compared with CIA-SORA.
Figure 7 shows the normalized MSE (NMSE) performance
versus εc among the considered schemes. CIA-SORA is shown
to outperform CIA-SRA and CIA-ERA, proving the effective-
ness of the suboptimal resource allocation. CIAS-SORA-ES
keeps the same performance as CIA-SORA since the majority
principle is followed in each vote process. Besides, CIAS-
SORA-PI is demonstrated to perform better than CIA-SORA
thanks to the reallocation of conserved resource. Both AQ-ML
and QBLUE can perform excellently when εc = 0, however,
the raise of εc incurs severe performance degradation. The
performance of CIA-SORA is superior to AQ-ML and QBLUE
if εc > 0.02. Observing the results provided in Fig. 6 and
Fig. 7, we can conclude that CIAS-SORA-ES can economize
13% to 33% of energy expenditure without any performance
deterioration comparing to CIA-SORA, whereas CIAS-SORA-
PI can improve the estimation performance of CIA-SORA with
at most 16% energy conservation.
V. CONCLUSION
In this work, we have proposed the CIAS scheme for
distributed sequential estimation based on the existing CIA
scheme. In the proposed CIAS scheme, the FC sequentially
sends an instruction message to the nodes for instructing each
node’s transmitted bit selection. Based on the accumulative
information bits polling from the nodes, the vote processes
performed at the FC can be possibly terminated early without
exhausting all allocated resource, and thus numerous resource
nodes can be conserved accordingly. The ES algorithm and
the PI algorithm were designed for the CIAS scheme. In
comparison with the existing CIA scheme, the provided sim-
ulation results have demonstrated that the ES algorithm can
significantly reduce the energy consumption without impacting
the estimation performance, whereas the PI algorithm can
meliorate the estimation performance along with slight energy
saving.
REFERENCES
[1] A. Ribeiro and G. B. Giannakis, ”Bandwidth-constrained distributed
estimation for wireless sensor networks - Part I: Gaussian PDF,” IEEE
Trans. Signal Process., vol. 54, no. 3, pp. 1131-1143, March 2006.
[2] H. Li and J. Fang, ”Distributed adaptive quantization and estimation for
wireless sensor networks,” IEEE Signal Processing Lett., vol. 14, no.
10, pp. 669-672, Oct. 2007.
[3] J. Fang and H. Li, ”Distributed adaptive quantization for wireless sensor
networks: From delta modulation to maximum likelihood,” IEEE Trans.
Signal Process., vol. 56, no. 10, pp. 5246-5257, Oct. 2008.
[4] S. M. Kay, Fundamentals of Statistical Signal Process.: Estimation
Theory. Upper Saddle River, NJ: Prentice-Hall, 1993.
[5] J.-J. Xiao, S. Cui, Z.-Q. Luo, and A. J. Goldsmith, ”Power scheduling
of universal decentralized estimation in sensor networks,” IEEE Trans.
Signal Process., vol. 54, no. 2, pp. 413-422, Feb. 2006.
[6] J. Li and G. AlRegib, ”Rate-constrained distributed estimation in wire-
less sensor networks,” IEEE Trans. Signal Process., vol. 55, no. 5, pp.
1634-1643, May 2007.
[7] Z. Luo, ”Universal decentralized estimation in a bandwidth constrained
sensor network,” IEEE Trans. Inf. Theory, vol. 51, pp. 2210-2219, Jun.
2005.
[8] Z.-Q. Luo and J.-J. Xiao, ”Decentralized estimation in an inhomoge-
neous sensing environment,” IEEE Trans. Inf. Theory, vol. 51, no. 10,
pp. 3564-3575, Oct. 2005.
[9] Y.-R. Tsai and C.-J. Chang, ”Distributed Estimation with Cooperative
Information Aggregation in Wireless Sensor Networks,” in IEEE 70th
Vehicular Technology Conference, VTC2009-Fall, 2009.
[10] F. Gray, ”Pulse code communication” U.S. patent no. 2,632,058, March
17, 1953.
[11] W. Feller, An Introduction to Probability Theory and Its Applications,
vol. 2, 2nd ed. New York: Wiley, 1971.
[12] S. Boyd and L. Vandenberghe, Convex Optimization, Cambridge, U.K.:
Cambridge Univ. Press, 2003.
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2011 proceedings
 2
今年的會議地點選在日本東京的秋葉原 (Akihabara) 國際會議廳 (Convention Hall) 舉
行，從十月十四日 (星期二) 起至十月十六日 (星期四) 止，為期共三天。此次會議亦
同時與另外一個通訊相關領域的國際學術研討會 – The 7th International Conference on
Optical Internet (COIN 2008) 一起舉行，主要探討光纖網路與有線寬頻網路之傳輸技術
與應用等相關議題，參加會議者可以自由選擇此二個研討會的議程自由參加。 
我們的論文是在 APCC 2008 會議中以口述發表 (Oral presentation) 的方式來進
行論文發表，時間安排在十月十六日上午的 16-AM2-C: Channel Estimation 2。每個
Session 均安排有五篇論文進行發表，因此，整個會議共有 205 篇論文於 APCC 2008 
進行發表。而在 COIN 2008 國際研討會則共有 85 篇論文進行發表。此外，於十月十
五日上午則進行 Keynote Session，共邀請三位 Keynote Speakers 進行演講。 
為了解舉行會議當地的情況，我於十月十三日上午 (星期一) 當天早上出發前往日
本東京，抵達成田機場之後，還必須坐約二小時的巴士前往東京市區。對於我而言，
比較有興趣的相關議題為： 
z MIMO  
z Ad Hoc and Sensor Networks  
z UWB  
z Channel Estimation  
z Broadcasting Technologies  
z Mobile Ad Hoc Network  
因此參加這些議題相關的發表會議，了解到了許多相關領域的研究方向與研究現況。
 
四、心得 
 
綜觀此次會議的發表論文內容，論文議題涵蓋主要都在通訊技術相關議題，而無
線通訊系統相關議題又遠較有線通訊系統相關議題為多，可以說反映出現今不同研究
領域的活躍程度。相較於其他更大型的國際學術研討會而言，其規模也稍微小了一點，
因此論文議題涵蓋也較為受限。不過，通訊技術相關領域的重要議題也都有包括，參
與此次會議也的確吸收到不少新技術的知識，對於未來的技術發展趨勢也有更進一步
的了解，對於未來的研究工作將有相當多的助益。 
另外，在 Keynote Session 中有相當有趣的演講議題，特別是第二位演講者 Prof. 
Byeong Gi Lee (IEEE Fellow)，他演講題目為 “Era of Convergence and Launching of 
KCC”，說明韓國通訊委員會 (Korea Communications Commission, KCC) 的設立目的與
工作目標。KCC 於 2008 年二月設立，其重要工作目標之一是面對寬頻無線網路普及
化後的新情勢。由於寬頻無線網路 (例如 WiMAX 或是 3GPP-LTE 系統) 普及化是可以
預期的，且即將來臨，因此整個無線服務傳播模式即將改變，其中最重要的改變可能
就是通訊 (Communication) 與廣播 (Broadcasting) 服務的整合問題。由於寬頻無線網
路的普及，無線廣播服務開始可以藉由以前傳統認知的通訊系統 (例如細胞式行動通訊
系統) 來提供服務，不可避免的通訊系統與廣播系統的界線開始模糊，因此如何在相關
法規上面進行修正將成為重要的課題。 
Proceedings of APCC2008 copyright (c) 2008 IEICE 08 SB 0083
MLSD Coupled with LMMSE Channel
Estimation for OFDM in Time-variant Channels
Yuh-Ren Tsai* and Hsien-Yun Chung
Institute of Communications Engineering
National Tsing Hua University
Hsinchu 30013, Taiwan
Email: yrtsai@ee.nthu.edu.tw
Abstract—For OFDM systems, high user mobility induces
time-variation of channel response over symbol duration,
causing orthogonality destruction and introducing inter-
carrier interference (ICI) among subcarriers. To enhance
the performance, sequence detection schemes have been
proposed with the availability of corresponding channel
state information (CSI), which is generally obtained via
channel estimation using some inserted preamble symbols.
However, bandwidth efficiency is significantly degraded and
long latency is introduced. In this work, without the need
of inserting preamble symbols, we propose a linear min-
imum mean square error (LMMSE) channel estimation
method coupled with the Viterbi-algorithm based maximum-
likelihood sequence detection (MLSD) scheme to improve
bandwidth efficiency and to minimize the detection latency.
Hence this proposed scheme can be applied to real-time,
delay-sensitive applications. Compared to other pilot-based
ICI mitigation methods, our scheme has better performance,
as well as better bandwidth efficiency.
I. INTRODUCTION
Orthogonal frequency division multiplexing (OFDM) is
a promising technique for wireless mobile communication
systems in order to meet the demands for high spectral
efficiency and high data rate transmission. In OFDM sys-
tems, the cyclic prefix (CP) is inserted between successive
OFDM symbols to eliminate the effect of inter-symbol
interference (ISI) and to maintain the orthogonality among
different subcarriers when the channel response is time-
invariant. For high user mobility, however, the channel
response may become time-variant over symbol duration
and the orthogonality among subcarriers is destroyed,
which results in intercarrier interference (ICI) severely
degrading receiving performance.
Some works have discussed the effects of ICI in a
time-variant channel. In [1], [2], ICI was modeled as an
additive white Gaussian random process and a theoretical
analysis for the error floor due to ICI on the symbol-
error rate was presented. The universal upper bounds on
total ICI power were derived in [3], and the exact bounds
were derived in [4]. An analysis on the ICI generation
mechanism was presented in [5] facilitating further un-
derstanding about power spread of each subcarrier due to
Doppler frequency shift. The matched-filter bound (MFB),
corresponding to the best possible receiving performance
that can be achieved over a given channel, for OFDM in
time-selective, frequency-flat Rayleigh fading channel was
evaluated [6], [7]. Similar works over doubly dispersive
channels were derived in [4], [8].
Several methods have been proposed in recent years
to eliminate the ICI caused by time-variant channels. An
ICI self-cancellation coding and a partial response coding,
originally proposed to suppress the ICI caused by carrier
frequency offset (CFO) in [9], [10], have been introduced
to combat the ICI caused by Doppler frequency shift
in [11], [12]. Jeon et al. proposed a method under the
assumption that Doppler spread and delay spread are both
small [13]. Mostofi et al. introduced a piece-wise linear
model to approximate the time variation characteristics for
the normalized Doppler frequency less than 0.1 [14]. A
minimum mean square error (MMSE) equalization with
successive interference cancellation (SIC) and a simpli-
fied linear MMSE equalization with parallel interference
cancellation (PIC) were proposed in [15] and [4], re-
spectively. In [5], [16], [17], based on the philosophy
of maximizing the signal-to-interference-plus-noise ratio
(SINR), the methods applying window preprocessing and
a bank of linear time-variant (LTV) filters were presented.
Hou and Chen designed a modified PIC mechanism with
less noise enhancement for a channel with linearly varying
response [18]. An ICI mitigation method relying on basis
expansion model (BEM) was proposed in [19]. A modified
maximum-likelihood sequence detection (MLSD) scheme
was proposed in [20], which utilizes adaptive T-algorithm
to reduce complexity but sacrifices bandwidth efficiency in
acquiring full knowledge of channel response to compute
the threshold.
Most of the previous works assume that full channel
state information (CSI), i.e. the frequency-domain channel
gains of all subcarriers, is available. This assumption is
too ideal and cannot be easily achieved. The correspond-
ing channel gains can be possibly obtained by using
multiple preamble OFDM symbols accomplished with
MMSE estimation. However, this approach has very high
computational complexity and may significantly degrade
the bandwidth efficiency to 50%. Furthermore, this ap-
proach also induces extra latency and thus makes real-time
demodulation impossible. In this work, we investigate the
ICI elimination performance of Viterbi-algorithm based
MLSD scheme for OFDM systems in time-variant chan-
nels. Furthermore, we devise a channel estimation scheme,
based on the linear minimum mean square error (LMMSE)
concept, coupled with MLSD to improve bandwidth effi-
ciency and to realize real-time demodulation.
II. SYSTEM MODEL
A. OFDM System Model
The propagation channel is assumed to be the well-
known wide sense stationary uncorrelated scattering (WS-
Authorized licensed use limited to: National Tsing Hua University. Downloaded on May 21, 2009 at 04:26 from IEEE Xplore.  Restrictions apply.
Proceedings of APCC2008 copyright (c) 2008 IEICE 08 SB 0083
the size of signal constellation is 2M . Define μ()k+Q =∣∣∣∣∣Yk − ∑m∈Ωk (Heq)k,mX˜
()
m
∣∣∣∣∣
2
as the branch metric and
Ψ()k+Q =
∑
j μ
()
j as the path metric corresponding to the
surviving sequence  at epoch k + Q, where X˜()m is the
corresponding data symbol within this surviving sequence
and μ()j is the corresponding branch metric at epoch j.
Repeating the metric calculation process until epoch N , all
the surviving path metrics corresponding to the Ns states
can be evaluated. Subsequently, the surviving path with the
minimum metric is chosen as the decision data sequence
Xˆ.
B. LMMSE Channel Estimation
To eliminate the ICI caused by a time-variant channel,
precise estimation of the channel gain corresponding to
the desired signal on each subcarrier is not sufficient; the
channel gains corresponding to all ICI signals interfering
on a subcarrier must be also correctly determined. In
other words, all the elements in the equivalent time-variant
channel matrix Heq, or at least the elements (Heq)k,m
for m ∈ Ωk and k = 0, · · · , N − 1, must be accurately
determined.
Based on the Viterbi decision algorithm, we propose
an LMMSE scheme estimating the equivalent frequency-
domain channel tap gains on each state, by exploiting the
frequency-domain autocorrelation property and building a
first-order Gauss-Markov autoregressive process for each
tap. The proposed LMMSE channel estimation scheme
employs no preamble OFDM symbol, but only a fraction
of pilot subcarriers in each OFDM symbol. Thus the
impact on the overall bandwidth efficiency is minimized.
Moreover, channel estimation is processed concurrently
with the detection, making it applicable for real-time appli-
cations. Since only the channel gains corresponding to the
desired signal and the major ICI are incorporated within
the Viterbi algorithm, we focus only on the determination
of the major channel gains, i.e. the elements (Heq)k,m for
m ∈ Ωk and k = 0, · · · , N − 1.
Define the frequency-domain correlation coefficient be-
tween (Heq)k,m and (Heq)k′,m′ , where k′ = 〈k + υ〉N
and m′ = 〈m + υ〉N , as
Rk,m (υ)
=
E[((Heq)k,m−E[(Heq)k,m])((Heq)k′,m′−E[(Heq)k′,m′ ])
∗]
E[((Heq)k,m−E[(Heq)k,m])((Heq)k,m−E[(Heq)k,m])∗] ,(12)
which is assumed to be available for the desired receiver.
It is noted that Rk,m (−υ)=Rk,m (υ)∗ for all υ. Then the
autoregressive model for (Heq)k′,m′ is given as
(Heq)k′,m′ = Rk,m (υ) (Heq)k,m + ηk′,m′ , (13)
where ηk′,m′ is the innovation term assumed to be a
Gaussian random variable with zero mean and variance
σ2k′,m′ =
E[((Heq)k′,m′−E[(Heq)k′,m′ ])((Heq)k′,m′−E[(Heq)k′,m′ ])
∗]
−E[((Heq)k,m−E[(Heq)k,m])((Heq)k′,m′−E[(Heq)k′,m′ ])
∗].
(14)
According to (9) and (13) the frequency-domain received
signal can be rewritten as
Yk =
∑
m∈Ωk
[Rk′′,m′′ (υ) (Heq)k′′,m′′ + ηk,m]Xm
+
∑
m/∈Ωk
(Heq)k,mXm + Wk,
(15)
where k′′ = k − υ and m′′ = m− υ.
To estimate the channel gains at epoch i, we take the
received signals of 2Q + 1 successive subcarriers (i.e.,
Y〈i−2Q〉N , · · · , Yi taken from subcarrier 〈i− 2Q〉N to
subcarrier i) into consideration, since all the data symbols
related to these received signals are currently available
for the correct surviving path in MLSD detector (i.e.,
X〈i−3Q〉N , · · · ,X〈i+Q〉N ). Consequently, we have 2Q+1
linear equations corresponding to the correct surviving
path expressed as
Yi =
[
Y〈i−2Q〉N Y〈i−2Q+1〉N · · · Y〈i−1〉N Yi
]T
Δ= AiHi + Θi + Γi + Wi
= AiHi + Γ˜i + Wi,
(16)
where (Ai)p,q = X〈i−3Q−2+p+q〉NRi,〈i−Q−1+q〉N (p −
2Q − 1) for 1 ≤ p ≤ 2Q + 1 and 1 ≤ q ≤ 2Q + 1,
Hi = [(Heq)i,〈i−Q〉N · · · (Heq)i,i · · · (Heq)i,〈i+Q〉N ]T
is the estimated channel gain vector corresponding to the
desired signal and the major ICI on subcarrier i, Θi is an
error vector due to the approximation of the autoregressive
model, Γi is the residual ICI vector, Wi is the frequency-
domain AWGN vector, and Γ˜i = Θi + Γi. By applying
the LMMSE estimator, the estimated frequency-domain
channel gain vector can be obtained as
Hˆi = CHiYiC
−1
YiYi
Yi, (17)
where CHiYi = E
[
(Hi − E [Hi]) (Ai (Hi − E [Hi]))H
]
is the covariance matrix between Hi and Yi, CYiYi =
AiE
[
(Hi − E [Hi]) (Hi −E [Hi])H
]
AHi +CΓ˜iΓ˜i+N0I
is the auto-covariance matrix of Yi with I denoting
the (2Q + 1) × (2Q + 1) identity matrix, and
CΓ˜iΓ˜i = diag
(
σ2i−2Q, · · · , σ2i
)
with σ2j denoting
the average residual signal power on subcarrier j,
including the residual ICI and the innovation error.
Since the total received signal power is fixed for the
data sequence X〈i−3Q〉N , · · · ,X〈i+Q〉N , we have the
following constraint [4]
CΓ˜iΓ˜i+diag
(
AiE
[
HiHHi
]
AHi
)
=
(
L−1∑
l=0
σ2hl
)
·I, (18)
where σ2hl is the average signal power corresponding to
each tap of delay spread. Accordingly, CΓ˜iΓ˜i can be
obtained via (18) based on the channel statistics, which
are assumed to be available based on the channel types.
To combine with a Viterbi decoder, for each surviving
path the LMMSE channel estimator uses 4Q+1 successive
data symbols to form matrix Ai, including 4Q latest data
symbols stored within each surviving sequence and the one
for current state. The (2Q+1)-tap channel gains obtained
from LMMSE estimator in each state are then applied to
compute the branch metric of each state at current epoch.
The same operation is processed for all states and repeated
at each epoch until epoch N − 1.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on May 21, 2009 at 04:26 from IEEE Xplore.  Restrictions apply.
Proceedings of APCC2008 copyright (c) 2008 IEICE 08 SB 0083
Bi
t E
rr
o
r 
Ra
te
 
(B
ER
)
SNR (dB)
BEM (α = 5/8)
Piece-wise approx. (α = 3/4)
LMMSE/MLSD (α = 8/9, Q = 2)
LMMSE/MLSD (α = 3/4, Q = 2)
MMSE with perfect CSI (Q = 2)
MLSD with perfect CSI (Q = 2) With perfect CSI
Pilot-based
channel estimation
0 5 10 15 20 25 30
10-1
10-2
10-3
10-4
Fig. 2. BER performance comparison for f¯d = 0.05 in a multipath
Rayleigh fading channel with L = 3.
B
it 
Er
ro
r 
R
at
e 
(B
ER
)
SNR (dB)
With perfect CSI
Pilot-based
channel estimation
0 5 10 15 20 25 30
10-1
10-2
10-3
10-4
BEM (α = 5/8)
Piece-wise approx. (α = 3/4)
LMMSE/MLSD (α = 8/9, Q = 2)
LMMSE/MLSD (α = 3/4, Q = 2)
LMMSE/MLSD (α = 3/4, Q = 3)
MMSE with perfect CSI (Q = 2)
MLSD with perfect CSI (Q = 2)
Fig. 3. BER performance comparison for f¯d = 0.3 in a multipath
Rayleigh fading channel with L = 3.
increase in computational complexity. A tradeoff between
bandwidth efficiency and computational complexity can be
made under a target BER performance.
V. CONCLUSION
In this work, we have proposed an LMMSE channel es-
timation method coupled with the Viterbi-algorithm based
MLSD scheme for OFDM systems in a time-variant chan-
nel. Without the need of inserting any preamble OFDM
symbols, the proposed scheme employs only a fraction
of pilot subcarriers in each OFDM symbol, significantly
improving the overall bandwidth efficiency. Moreover,
channel estimation is processed concurrently with the data
detection, making it feasible for real-time, delay-sensitive
applications. Compared to other pilot-based ICI mitigation
methods, our scheme has better receiving performance,
as well as better bandwidth efficiency. Furthermore, by
incorporating more ICI subcarriers into consideration, the
performance of the proposed scheme can be significantly
improved at the cost of increasing computational complex-
ity.
ACKNOWLEDGMENT
This work was supported in part by the National Science
Council, Taiwan, R.O.C., under Grant NSC 96-2219-E-
007-006.
REFERENCES
[1] M. Russell and G. L. Stuber, ”Interchannel interference analysis of
OFDM in a mobile environment,” in Proc. IEEE Veh. Tech. Conf.,
vol. 2, pp. 820-824, 1995.
[2] P. Robertson and S. Kaiser, ”The effects of Doppler spreads in
OFDM(A) mobile radio systems,” in Proc. IEEE Vehicular Tech-
nology Conf., Fall, pp. 329-333, 1999.
[3] Y. Li and L. J. Cimini, ”Bounds on the interchannel interference of
OFDM in time-varying impairments,” IEEE Trans. Commun., vol.
49, pp. 401-404, Mar. 2001.
[4] X. Cai and G. B. Giannakis, ”Bounding performance and suppressing
intercarrier interference in wireless mobile OFDM,” IEEE Trans.
Commun., vol. 51, pp. 2047-2056, Dec. 2003.
[5] P. Schniter, ”Low-complexity equalization of OFDM in doubly
selective channels,” IEEE Trans. Signal Processing, vol. 52, pp.
1002-1011, Apr. 2004.
[6] F. Ling, ”Matched-filter bound for time-discrete multipath Rayleigh
fading channels,” IEEE Trans. Commun., vol. 43, pp. 710-713, Feb.-
Apr. 1995.
[7] W. Burchill and C. Leung, ”Matched filter bound for OFDM on
Rayleigh fading channels,” Electron. Letters, vol. 31, pp. 1716-1717,
Sept. 1995.
[8] N. J. Bass and D. P. Taylor, ”Matched filter bounds for wireless
communication over Rayleigh fading dispersive channels,” IEEE
Trans. Commun., vol. 49, pp. 1525-1528, Sept. 2001.
[9] Y. Zhao and S. G. Haggman, ”Intercarrier interference self-
cancellation scheme for OFDM mobile communication systems,”
IEEE Trans. Commun., vol. 49, pp. 1185-1191, July 2001.
[10] Y. Zhao, J.-D. Leclercq and S. G. Haggman, ”Intercarrier inter-
ference compression in OFDM communication systems by using
correlative coding,” IEEE Commun. Letters, vol. 2, pp. 214-216,
Aug. 1998.
[11] Y. Zhang and H. Liu, ”Frequency-domain correlative coding for
MIMIO-OFDM systems over fast fading channels,” IEEE. Commun.
Letters, vol. 10, pp. 347-349, May 2006.
[12] H. Zhang and Y. Li, ”Optimum frequency-domain partial response
encoding in OFDM system,” IEEE Trans. Commun., vol. 51, pp.
1064-1068, July 2003.
[13] W. G. Jeon, K. H. Chang, and Y. S. Cho, ”An equalization technique
for orthogonal frequency-division multiplexing systems in time-
variant multipath channels,” IEEE Trans. Commun., vol. 47, pp. 27-
32, Jan.1999.
[14] Y. Mostofi and D. C. Cox, ”ICI mitigation for pilot-aided OFDM
mobile systems,” IEEE Trans. Wireless Commun., vol. 4, pp. 765-
774, Mar. 2005.
[15] Y.-S. Choi, P. J. Voltz, and F. A. Cassara, ”On channel estimation
and detection for multicarrier signals in fast and selective Rayleigh
fading channels,” IEEE Trans. Commun., vol. 49, pp. 1375-1387,
Aug. 2001.
[16] P. Schniter and S. H. D’Silva, ”Low-complexity detection of OFDM
in doubly-dispersive channels,” in Proc. Asilomar Conf. Signals,
Syst., Comput., Nov. 2002.
[17] A. Stamoulis, S. N. Diggavi, and N. Al-Dhahir, ”Intercarrier
interference in MIMO OFDM,” IEEE Trans. Signal Processing, vol.
50, pp.2451-2464, Oct. 2002.
[18] W.-S. Hou and B.-S. Chen, ”ICI cancellation for OFDM commu-
nication systems in time-varying multipath fading channels,” IEEE
Trans. Wireless Commun., vol. 4, pp. 2100-2110, Sep. 2005.
[19] D. Hu, L. He and L. Yang, ”Estimation of rapidly time-varying
channels for OFDM systems,” IEEE ICASSP, vol. 4, pp. IV357-
IV360, 2006.
[20] S.-J. Hwang and P. Schniter, ”Efficient Sequence Detection
of Multicarrier Transmissions over Doubly Dispersive Channels,”
EURASIP Journal on Applied Signal Processing, vol. 2006, pp. 1-
17, 2006.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on May 21, 2009 at 04:26 from IEEE Xplore.  Restrictions apply.
 1
□ 赴國外出差或研習 
□ 赴大陸地區出差或研習 
■ 出席國際學術會議 
□ 國際合作研究計畫出國 
心得報告 
計 畫 名 稱 無線感測網路之分散式偵測
與估測技術研究（3/3） 
計 畫 編 號 NSC 97-2221-E-007-074 
-MY3 
報 告 人 
姓 名 蔡育仁 
服 務 機 構
及 職 稱清華大學 通訊工程研究所
會議/訪問時間 
 地點 
100 年 6 月 4 日至 100 年 6 月 10 日   
日本, Japan, 京都, Kyoto 
會 議 名 稱 IEEE International Conference on Communications (ICC 2011) 
發表論文題目 Cooperative Information Aggregation based Distributed Sequential Estimation in Wireless Sensor Networks（檢附論文檔案） 
一、主要任務摘要（五十字以內） 
 
赴日本京都參加國際研討會 “IEEE International Conference on Communications
(ICC 2011)” 並發表論文；另外，透過參與其他論文的發表，觀摩世界各地的研究趨勢。
 
二、對計畫之效益（一百字以內） 
 
發表由國科會補助計畫的研究論文，可增加台灣與本校在國際學術研究上的能見
度；此外，並可以瞭解目前國際學術研究的動態與趨勢，吸收新知並尋找未來的研究
議題與研究方向。 
 
三、經過 
 
IEEE International Conference on Communications 是從 1965 年開始創立的國際學
術研討會，也是IEEE Communications Society 最主要的國際研討會。此國際學術研討會
主要是提供全球消息理論與通訊技術相關之研究發展人員，一個開放的技術發表、討
論平台，提供最新的技術研究現況與發展訊息。ICC的主辦單位為IEEE Communications 
Society，今年並由 IEICE (Institute of Electronics, Information and Communication 
Engineers) Communications Society 協辦。今年的會議地點選在日本京都市的京都國際
會議廳 (Kyoto International Conference Center) 舉行，從六月五日 (星期日) 起至六月
九日 (星期四) 止，為期共五天。為了參與六月五日的議程，我於六月四日上午 (星期
六) 當天早上出發前往日本京都，抵達關西機場之後，還必須坐約一個半小時的日本西
部鐵路前往京都市區。第一天為短期課程 (Tutorial)，共有十五個課程可供選擇，參加
的課程是Vehicular Networking。晚上則為接待晚會 (Welcome Reception)。第二天早上
為會議開幕式與主旨演講 (Keynotes)。接下來就是主要的研討會議論文發表。 
 
研討會內容主要探討涵蓋所有通訊技術相關的議題，包括十二個專題論文集
(Symposium): Symposium on Selected Areas in Communications: Access Systems and 
 3
 
四、心得 
 
綜觀此次會議的發表論文內容，論文議題涵蓋相當廣泛，此乃是因為通訊領域的
技術發展相當蓬勃，新的系統與新的技術概念不斷的被加入通訊技術的研究發展中，
而傳統重要的技術系統仍不斷的在發展中，例如傳統的正交分頻多工 (OFDM) 系統、
合作式通訊  (Cooperative Communications) 系統、無線感測網路  (Wireless Sensor 
Network)、認知無線電網路 (Cognitive Radio Network)、電子健康 (e-Health) 系統等
等，其中較為特別的是賽局理論 (Game Theory) 被廣泛的應用至相當多領域的技術研
究，雖然有些領域技術的應用並不成熟與恰當，但是可以預見的是，賽局理論的應用
會是相當受到重視的，未來也應該會有相當程度的發展。參與此次會議也的確吸收到
不少新技術知識，對於未來的技術發展趨勢也有更進一步的了解，對於未來的研究工
作將有相當多的助益。另外，此次會議美中不足的一點，就是有不少論文的作者此次
並未親自前往會場進行論文發表，有很少的部分缺席，但是有不少的論文是請其他人
代為報告，或是採取影音預錄檔案的方式來進行報告，如此的報告實在是效果不彰，
減損了整個會議的發表品質。究其缺席的原因，應該都是因為日本東北大地震所引發
核能災變的原因，雖然會議地點在日本關西地區，且核能災變已經有相當程度的控制，
但是仍讓許多人感到疑慮而缺席會議。 
 
由於此次是本人第一次以海報發表的型式進行論文發表，發現與聽眾的互動比較
良好，可以讓發表者能夠針對聽眾對於論文本身比較不瞭解的部分提出更詳盡的解
釋，也讓發表者能夠更即時的獲得聽眾對於該研究的建議與意見。而海報內容的設計，
除了要能夠簡潔清楚的表現出該研究主題與主要貢獻之外，字型的大小與內容安排也
相當重要，重點的強調是否恰當更是具有決定性的影響。除了專業領域的收穫之外，
在京都當地也可以發現該國對於古蹟保存與都市發展的良好規劃，古蹟保存可以不影
響都市現代化的發展，只要有良好與有遠見的規劃與決心，兩者是可以共存的，使得
京都成為一個相當現代化的大城市，但是卻擁有相當良好的觀光資源。 
 
五、建議與結語 
 
通訊網路／系統是一個十分重要且長久持續發展的技術領域，尤其是無線通訊網
路／系統相關技術。除了傳統的技術領域之外，未來認知無線電網路 (Cognitive Radio 
Network)、電子健康 (e-Health) 系統、與賽局理論 (Game Theory) 的技術應用，都將
會是相當重要的議題；而在實際的無線通訊系統中，LTE 系統的重要性將持續增加。
 
六、攜回資料 
 
會議議程一份，會議論文USB隨身碟一個。 
 
 
 
 5
 
 
 
 
 
 
 
 
 
 
 
附件: 發表論文 
 
Cooperative Information Aggregation based Distributed Sequential 
Estimation in Wireless Sensor Networks 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
θ1 1x nθ= + ( )1L xΨ 1O 1c
k kx nθ= + ( )L kxΨ kO kc
K Kx nθ= + ( )L KxΨ KO Kc
Observation
Channels
Sensor Node 1
Sensor Node k
Sensor Node K
1c ′
kc ′
Kc ′
( )ˆ fθ ′= c
FC
Communication
Channels
Fig. 1. The considered system model for WSNs.
for all nodes with zero mean and variance σ2. The local
observation xk is bounded by [−W, W ], where W is a pre-
determined value corresponding to the possible range of θ.
Each node first quantizes its observation into L bits by using
a uniform quantizer. According to the observation quality,
the quantization bit length L is appropriately determined by
applying the rule shown in [8] as L = log2 (W/σ), and the
quantization step size can be acquired as Δ = 2W
/(
2L − 1).
For node k, the local observation vector is expressed as
Ok = ΨL (xk)
= [Ok, 1, Ok, 2, · · · , Ok, L]T , k = 1, 2, · · · , K, (1)
where ΨL (·) denotes the L-bit uniform quantizer, and Ok,1 is
the most significant bit (MSB) of Ok. Each node is assumed to
transmit only one bit of its observation vector to the FC. The
communication channels are modeled as the binary symmetric
channels (BSCs) with identical crossover probability εc. Let ck
denote the information bit forwarded by node k, and c′k denote
the corresponding bit passing through the BSC and received
by the FC, then the information codeword aggregated at the
FC can be expressed as c′ = [c′1, c′2, · · · , c′K ]T . Finally,
the FC fuses c′ to yield the estimation result denoted as θˆ.
III. THE CIA SCHEME AND THE PROPOSED CIA BASED
DISTRIBUTED SEQUENTIAL ESTIMATION SCHEME
In this section, we first introduce the CIA scheme and the
corresponding optimization process, and then elucidate the
proposed CIAS scheme with two algorithms designed for it.
A. The CIA Scheme
Define the resource allocation vector as R =
[R1, R2, · · · , RL]T , where Rl denotes the number of
nodes that forward the l-th bit in their observation vectors
to the FC. The total resource constraint
∑L
l=1 Rl = K
must be satisfied by the design of R. Without loss of
generality, we assume that, for node k which satisfies∑l−1
j=1 Rj < k ≤
∑l
j=1 Rj , it forwards the l-th bit Ok,l in the
observation vector Ok, to the FC. To alleviate the impact of
the presence of observation noise, the binary-reflected Gray
encoding (BRGE) [10], is utilized in the quantization and
de-quantization processes, instead of the widely used binary
encoding (BE). Under BRGE, the observation vectors of two
successive quantization levels only differ by one bit, as the
example shown in Table I with L = 3.
TABLE I
THE QUANTIZATION CODEWORDS GENERATED BY BINARY ENCODING
(BE) AND BINARY-REFLECTED GRAY ENCODING (BRGE) WITH L = 3.
Quantization
level
Quantization codeword encoding strategy
BE BRGE
O1 O2 O3 O1 O2 O3
dq, l
l = 1 l = 2 l = 3
q = 0 0 0 0 0 0 0 7 3 1
q = 1 0 0 1 0 0 1 5 1 1
q = 2 0 1 0 0 1 1 3 1 1
q = 3 0 1 1 0 1 0 1 3 1
q = 4 1 0 0 1 1 0 1 3 1
q = 5 1 0 1 1 1 1 3 1 1
q = 6 1 1 0 1 0 1 5 1 1
q = 7 1 1 1 1 0 0 7 3 1
The FC uses the information codeword c′ collected from all
nodes to reconstruct the L-bit aggregated observation vector
Oˆ =
[
Oˆ1, Oˆ2, · · · , OˆL
]T
. The way to decide the value of
Oˆl, for 1 ≤ l ≤ L, is to make a hard decision by the majority
vote based on the corresponding Rl received bits. Clearly,
Oˆ depends on the resource allocation vector R, i.e. Oˆ(R).
Finally, the FC yields the estimate via the de-quantization
applied to Oˆ(R), and the fusion rule can be expressed as
θˆ(R) = f (c′) = Ψ−1L (DHD (c
′)) = Ψ−1L
(
Oˆ(R)
)
, (2)
where DHD(·) denotes the hard decision function to construct
Oˆ(R), and Ψ−1L (·) is the L-bit de-quantization operation.
B. Optimization Process in the CIA Scheme
The objective of optimization is to find the optimal resource
allocation vector R˜ =
[
R˜1, R˜2, · · · , R˜L
]T
, subject to the
constraint
∑L
l=1 R˜l = K, in order to minimize the estimation
mean square error (MSE). The unknown parameter θ can
be represented as θ = θΨ + nΨ, where θΨ denotes the
quantized version of θ, and nΨ represents the quantization
noise. The value of θΨ corresponds to the value of the L-bit
exact observation vector O = ΨL(θ) = [O1, O2, · · · , OL]T .
Note that the best achievable performance at the FC is
θΨ, i.e. to perfectly reconstruct the exact observation vector
O. As a result, the objective function of optimization is
equivalent to minimize the MSE between θˆ(R) and θΨ, i.e.
E
[
(θˆ(R)− θΨ)2
]
. Because the value of (θˆ(R)− θΨ)2 can
not be determined easily, E
[
(θˆ(R)− θΨ)2
]
is transformed
into an analyzable form for optimization and a suboptimal
resource allocation (SORA) strategy is derived as follows.
First, we define a Bernoulli random variable el =∣∣∣Oˆl −Ol∣∣∣ ∈ {0, 1}, where el = 1 represents that a flip occurs
at the l-th bit between Oˆ(R) and O, and el = 0 contrarily
represents the agreement at the l-th bit. Based on the average
square error induced by a flip, we simply approximate the
objective function and formulate the optimization problem as
min
R
g¯(R) =
L∑
l=1
PR (el = 1)× δl
s.t. Rl ≥ 0,
L∑
l=1
Rl = K,
(3)
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2011 proceedings
FC
t
: The nodes consumed in VPl: Instruction message sent by the FC
: Information bit sent by the node : The nodes saved in VPl
VP1 VP2
Nodes:
1
ˆO 2ˆO
:      is yieldedˆlO
1n 1 1n + 1R 1 1R +1 1 2R n+ 1 2 1R n+ + 1 2R R+ 
Fig. 2. The diagram of the proposed CIAS scheme.
of the ES algorithm is to save the energy expenditure as much
as possible without impacting the estimation performance.
Accordingly, once the early termination occurs in a vote
process, the remaining nodes wherein will be immediately
conserved. Denote KEl as the number of nodes spent in
V Pl, then totally K −
∑L
l=1 KEl nodes are economized in
one estimation procedure by applying the ES algorithm. The
operation of the ES algorithm can be described in Fig. 3.
E. Performance Improving (PI) Algorithm
The other algorithm is the performance improving (PI) al-
gorithm. In the PI algorithm, the nodes conserved in each vote
process will be relocated to the subsequent vote processes, in
order to achieve the objective of improving estimation perfor-
mance. Denote V Pi as the i-th vote process for i = 1, · · · , L,
and l = 1, · · · , L as the index of quantized information bit.
KPi represents the number of nodes consumed in V Pi and
R˜(i) =
[
R˜
(i)
1 , R˜
(i)
2 , · · · , R˜(i)L
]T
is the resource allocation
vector in V Pi, where R˜(1) = R˜ for V P1. If KPi < R˜
(i)
i
after the termination of V Pi, it implies that R˜(i)i −KPi nodes
are saved in V Pi and can be rearranged for the following vote
processes. In this case R˜(i+1)l = 0, for l = 1, ..., i, and the
value of R˜(i+1)l for l = i+1, ..., L can be obtained by solving
the following equations modified from (8):⎧⎪⎪⎪⎨
⎪⎪⎪⎩
2R˜
(i+1)
l C1(l)
R˜
(i+1)
l
/
2
(
R˜
(i+1)
l
)−1/2
·
[
ln
(
2
√
C1 (l)
)
−1
/
2R˜(i+1)l
]
= −v∗/C2 (l), l = i + 1, · · · , L∑L
l=i+1 R˜
(i+1)
l = K −
∑i
l=1 KPl
.
(10)
Specifically, for the case of KPi < R˜
(i)
i in V Pi, the remaining
K − ∑il=1 KPl nodes will be reallocated to forward the
(i + 1)-th to L-th quantized information bits. In case of
for l = 1 to L do
n ← 1, V Pl ← false.
while (n ≤ R˜l and V Pl = false) do
FC polls the l-th bit from the n-th node of the R˜l nodes.
if N0 (n) > R˜l
/
2 then
Oˆl ← 0, KEl ← n, V Pl ← true.
else if N1 (n) > R˜l
/
2 then
Oˆl ← 1, KEl ← n, V Pl ← true.
else if n = R˜l then
Oˆl ← 0 or Oˆl ← 1 equiprobably, KEl ← R˜l, V Pl ← true.
else
n ← n + 1.
Fig. 3. Energy saving algorithm.
KPi = R˜
(i)
i after the termination of V Pi, then R˜(i+1) = R˜(i).
Although the PI algorithm relocates the saved nodes in each
vote process, finally some nodes can still be conserved if the
early termination occurs in the last vote process. The operation
of the PI algorithm can be represented as Fig. 4.
IV. SIMULATION RESULTS
In this section, we provide the simulation results to assess
the achievement of the proposed CIAS scheme in aspects
of the energy consumption and the estimation performance.
For the existing CIA scheme, the estimation performances
of two different resource allocation strategies are provided
to compare with the suboptimal strategy designated as CIA-
SORA: The significance based resource allocation designated
as CIA-SRA where Rl = 2−lK, for l = 1, · · · , L; and
the equal resource allocation designated as CIA-ERA where
Rl = K/L, for l = 1, · · · , L. Since the default resource
allocation in the proposed CIAS scheme is following CIA-
SORA, we designate the ES algorithm and the PI algorithm as
CIAS-SORA-ES and CIAS-SORA-PI respectively. For CIAS-
SORA-ES and CIAS-SORA-PI, the fraction of consumed
resource for the l- th quantized information bit to total resource
in one estimation procedure can be expressed as KEl/K
and KPl/K respectively; and the fraction of total consumed
resource for estimation is expressed as
∑L
l=1 KEl
/
K and∑L
l=1 KPl
/
K respectively. Thus, through making the Monte
Carlo simulation, the average fraction of consumed resource
for each quantized information bit and the average fraction of
total consumed resource can be obtained as the indicators of
average energy consumption. The estimation performances of
the adaptive quantization approach with maximum likelihood
estimation (AQ-ML) proposed in [3] and the quasi-BLUE
approach (QBLUE) proposed in [6] are also given for compar-
ison. The parameter settings in our simulations are W = 10,
σ = 0.5, K = 100, and L = 5.
In Fig. 5, the comparison of average fraction of consumed
resource for each quantized information bit is presented, for
εc = 0, 0.2, and 0.4 respectively. For CIA-SORA, we can find
that the resource allocated to more significant quantized bits
R˜(1) ← R˜.
for i = 1 to L do
n ← 1, V Pi ← false.
while (n ≤ R˜(i)
i
and V Pi = false) do
FC polls the i-th bit from the n-th node of the R˜(i)
i
nodes.
if N0 (n) > R˜(i)i
/
2 then
Oˆi ← 0, KPi ← n, V Pi ← true.
else if N1 (n) > R˜(i)i
/
2 then
Oˆi ← 1, KPi ← n, V Pi ← true.
else if n = R˜(i)
i
then
Oˆi ← 0 or Oˆi ← 1 equiprobably, KPi ← R˜
(i)
i
, V Pi ← true.
else
n ← n + 1.
if (KPi < R˜
(i)
i
) then
R˜
(i+1)
l
← 0, for l = 1, ..., i.
Calculate R˜(i+1)
l
from (10), for l = i + 1, ..., L.
else
R˜(i+1) ← R˜(i).
Fig. 4. Performance improving algorithm.
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2011 proceedings
 
YRTsai  
寄件者: "ICC'11 AHSM" <boukerch@site.uottawa.ca>
日期: 2011年3月2日 上午 08:59
收件者: "Cheng-Ju Chang" <d949602@oz.nthu.edu.tw>
副本: "Yuh-Ren Tsai" <yrtsai@ee.nthu.edu.tw>; <boukerch@site.uottawa.ca>
主旨: [ICC'11 AHSM] Your paper 'Cooperative Information Aggregation based Distributed Sequential Estimation in 
Wireless Sensor Networks' has been accepted
b第 1 頁 (共 1 頁)(B)
2011/10/21(B)b
Dear ICC 2011 Symposium Presenters,
 
Thank you very much for having registered for ICC 2011. 
 
We finalized the submission of the final camera ready papers. The submission ratio 
is 98.5 %.  To fill the void for those missing papers, we moved some papers from 
the poster sessions into the lecture style (oral) sessions within each symposium.  
We also coordinated the overlapped papers appropriately to avoid the conflicts; we 
had requested all the authors to let us know if they had the overlapped 
presentations via the acceptance letter and subsequent reminders. 
 
Please confirm your current presentation schedule according to the “Advance 
Symposium Program” at the ICC 2011 website: 
 
http://www.ieee-icc.org/advance_symposium_program.php 
 
In addition you can see the “Author Presentation Guidelines” at the ICC 2011 
website: 
http://www.ieee-icc.org/author_presentation_guidelines.php 
 
Please prepare your presentation materials according to the guidelines. 
 
We are looking forward to seeing you in Kyoto. 
 
Best regards, 
 
Koichi Asatani, ICC 2011 Executive Chair 
Kazuo Hagimoto, ICC 2011 TPC Chair 
Hiromi Ueda, ICC 2011 TPC Vice-Chair 
Abbas Jamalipour, ICC 2011 TPC Vice-Chair 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：蔡育仁 計畫編號：97-2221-E-007-074-MY3 
計畫名稱：無線感測網路之分散式偵測與估測技術研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 9 9 100%  
博士生 2 2 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 4 4 100%  
研究報告/技術報告 0 0 100%  
研討會論文 4 4 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
