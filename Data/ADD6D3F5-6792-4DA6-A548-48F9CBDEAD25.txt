結合LQG與輸入估測法於電子元件主動最佳熱控制之研究 
 
摘要 
    本文提出應用適應性輸入估測法(AIEM)結合線性二次型高斯問題(LQG)最佳化控制，
藉量取電子元件外部或邊界某點可量測之溫度，即時逆向估算求得未知輸入熱通量，提供
最佳化控制之散熱機制參數設計。其中適應性輸入估測法運用於估算電子元件之即時熱通
量，進而解算電子元件內部之溫度場分布情形。而 LQG控制理論運用在對受控系統進行散
熱控制。本研究發展適應性輸入估測法結合 LQG控制器將可有效快速對元件進行熱控制，
並達到預期之控制目標，快速精確之最佳散熱控制器，對於產品保護或操作環境溫度之控
制可提供即時有效監控，未來可應用於產品熱加工、散熱裝置研發測試，具廣泛應用價值。 
關鍵字:適應性輸入估測法、線性二次型高斯問題 
 
ABSTRACT 
  This research proposes a combined method of the adaptive input estimation method (AIEM) 
and the linear quadratic Gaussian problem (LQG). This method is adopted used to improve the 
heat-dissipating technique of electronic devices. The AIEM can estimate the real-time heat flux 
produced by the electronic device effectively. On the other hand, the LQG controller offers the 
optimal heat-dissipating control to the heat flux and intends to reach an optimal state of the 
heat-dissipating system equipped on the electronic device. By combining the LQG controller and 
AIEM, the performance and the reliability of the electronic devices can be highly enhanced in the 
future developments.  
Keyword: Adaptive input estimation method (AIEM), Linear quadratic gaussian problem 
 
1. 前言 
    隨著時代的進步，就電腦的中央處理器 (Central Processing Unit, CPU)而言，自 1971
年第一顆微處理器問世到現今具有雙核心 64位元效能 CPU的誕生，運算速度已從MHz進
化到 GHz的層級。在持續發展更高效能的中央處理器的過程中，所面臨最大的衝擊便是熱
效應的阻礙，突顯出相關熱處理問題的重要性。    現今電子元件具高效能運算能力，另
強調輕、薄、短、小的訴求，但熱效應問題始終是研發成功與否的關鍵性問題，由相關統
計資料顯示，電子元件的失效因素，有 55%的比例是來自於溫度的影響，要克服此一問題，
必須要能充分掌握熱效應的產生，若能透過一套完整且穩定之溫度量測模式，將系統可能
產生之熱效應狀態先期掌握，再以最佳化控制之方式來應對此一熱效應的問題，相信必能
兼顧效能、成本及可靠度等訴求。 
    電子元件溫度主要來自內部核心，其熱效應問題可假設在邊界條件及物理性質未知狀
況下，透過實驗量取一組溫度數據，逆向求解其未知邊界條件或物理性質，其相關概念於
1957年由俄國Shumakov首先應用[1]，稱之為逆向熱傳導問題(Inverse Heat Conduction 
Problem, IHCP)。後續由Tuan等人於1996年成功地推導出線上輸入估測法則(On-line, Input 
Estimation Method)[2]，應用於圓柱座標逆向熱傳導問題之未知熱通量估算[3]，並於1997年
發表適應性強健權重函數 γ 值之論著，更進ㄧ步強化了適應性輸入估測法(Adaptive Input 
Estimation Method, AIEM)之可靠度[4]。Chen於2002年應用適應性輸入估測法求解未知熱通
量與溫度場分佈，以及接觸熱傳導係數之估算[5]。適應性輸入估測法可有效並即時精確估
 1
離散狀態方程式為： 
( ) ( -1) ( -1) ( -1) ( -1)X k X k u k q k kω= Φ + Λ + Γ +                             (7) 
1 2 3 1( ) [    ]
T
n nX k T T T T T−= "                                          (8)  
A te ∆Φ =                                                        (9)  
( 1)
exp[ ( )]
k t
k t
A k t Gdτ τ
+ ∆
∆
Λ = ∆ −∫                                         (10)  
( 1)
exp[ ( )]
k t
k t
A k t Bdτ τ
+ ∆
∆
Γ = ∆ −∫                                         (11) 
其中 是狀態轉移矩陣， 、 分別為相對於 及 之係數矩陣， 是確定性輸入序
列， 是控制項序列，
Φ Γ Λ ( )q k ( )u k ( )q k
( )u k ( )kω 是程序雜訊輸入向量，其統計特性假設均值為零的白色高斯
雜訊(Gaussian white noise with zero mean)，而其變異量(Variance)為 { ( ) ( )}T
kj
E k j Qω ω = δ ， kjδ 表
系統脈衝函數(Impulse function)。量測方程式(5)時間離散化如下： 
( ) ( ) ( ) ( )Z k H k X k kν= +                                              (12) 
其中 ( )Z k 是在時間 k τ⋅ ∆ 時之觀測向量(Observation vector)， H 為量測矩陣(Measurement 
matrix)， ( )kν 是量測雜訊向量假設均值為零的白色高斯雜訊，變異量為 { ( ) ( )}T kjE k j Rν ν δ= 。 
 
3. AIEM結合 LQG之控制器設計 
在(7)式中，若熱通量 或其強度已知時，以線性二次高斯控制法，即可獲得良
好的最優控制。但受控系統存在一時變之熱源輸入q(k)項時，若以結合卡爾曼濾波器與LQG
調節器之最優控制法，將無法對於時變熱源之受控系統獲得最優化散熱機制之設計，針對
此項缺點，本研究提出一合成控制法則，在演算程序上運用分離定理[14]，考慮外加時變確
定性輸入項，在對受控系統作用之情況下進行散熱控制，u(k)為待求之最優控制項，因此，
控制問題須同時考慮參數估測及最優控制兩部分，在此，將考慮二次型指標函數和高斯分
佈白色噪音干擾的隨機最優控制問題。 
( ) = 0q k
    適應性輸入估測法為卡爾曼濾波器與遞迴式最小平方演算法組合而成，當系統輸入為
未知時變熱通量與散熱控制量，利用量測的溫度數據與估測溫度值之誤差所產生的更新剩
餘值為性能指標，藉由遞迴式最小平方演算法，進而精確地估算出未知時變熱通量。卡爾
曼濾波器在程序誤差變異量 KQ 及量測誤差變異量 KR 之設定下運作，詳細之推導請參考[15]。 
(一)卡爾曼最優預測方程式如下： 
( ) ( ) ( ) ( ) ( ) ( ) ([ ˆ1 1, 1ˆ ˆk k k k k k K k Z k H k X k kX X+ = Φ + − + − − )]1                    (13) 
( ) ( ) ( ) ( )1ˆZ k Z k H k k kX− −=                                          (14) 
( ) ( ) ( ) ( ) ( ) ( ) ( )[ ] 11, 1 1T T KK k k k P k k H k H k P k k H k R −= Φ + − − +              (15) 
( ) ( ) ( ) ( )/ 1 T Ks k H k P k k H k R= − +                                         (16) 
( ) ( ) ( ) ( ) ( ) ( ) ( )
( ) ( ) ( )[ ] ( ) ( ) ( ) ( ) ( )1
1 1, 1, 1,
                     1 1 1, 1, 1,
1 1T T
T T
K K
k k k kP k k k k P k k k k H k
H k P k k H k R k P k k k k k k Q k k
P
H−
+ = Φ + Φ + Φ +
− + − Φ + + Γ + Γ +
− −−
T
 (17) 
( 1ˆ k kX + )為最佳狀態預測值， ( )Z k 為狀態量測值與估算值之誤差，代表剩餘值更新序列， ( )K k
為卡爾曼增益(Kalman gain)， 是更新共變異矩陣(Innovation covariance matrix)，( )S k P則為
濾波器誤差共變異量矩陣(filtering error covariance matrix)。 
(二)遞迴式最小平方演算法如下： 
( ) ( )[ 1 ]B k H M k I= Φ − + Γ                                                (18) 
( ) ( )[ ] ( )[ 1 ]M k I K k H M k I= − Φ − +                                         (19) 
( ) ( ) ( ) ( ) ( ) ( ) ( ) 11 11 1T Tb b bK k P k B k B k P k B k s kγ γ −− −= − − +⎡⎣ ⎤⎦                          (20) 
 3
其中 為離散形式的黎卡提方程式（Ricatti Equation）的解，黎卡提方程式如下所示： 
2 ( )P k
1
2 2 2 2 2 2 1( ) { ( 1) ( 1) [ ( 1) ] ( 1)} ,
T T TP k P k P k P k Q P k Q k N−= Φ + − + Λ Λ + Λ + Λ + Φ + <      (31) 
( )
2
P N 之邊界條件為 ( )
2 0
P N Q= ， ，依照(31)式，從( / ) 1fN t t= ∆ + k N= 逆向算到 ，可得
數列值。利用適應性輸入估測法估算出
1k = 2 ( )P k( )qˆ k 並結合 (26)式，以獲得最優狀態預測值
ˆ (k kχ −1)，並代入(29)式中，即為結合適應性輸入估測法與 LQG 之主動式控制器設計之最
佳控制。 
    為能顯現結合適應性輸入估測法與 LQG之主動式控制器設計演算架構之整體性，以一
同時具有輸入干擾時變熱通量 及散熱控制量 之隨機干擾作用下線性離散系統模型
（system model），並結合適應性輸入估測法（Adaptive Input Estimation Method）與 LQG（The 
Linear Quadratic Regulator）控制法，可以圖 2控制流程圖表示之。 
( )ˆ kq ˆ( )u k
 
( )H k
( )w k
( )kΓ
( )1,k kΦ +
( )1,k kΛ +
( )v k
( )1X k + ( )X k
( )exactq k
( )K k
( )ˆ 1X k k −
( )qˆ k
( )ˆ 1Z k k −
( )1Z k k −
( )uˆ k +
+ +
+
+
+
+
++
+
+ +
−
( )qˆ k+( )uˆ k
( )ˆ 1X k k+ ( )Z k
( )rK k−
( )kΓ
( )H k
( )1,k kΦ +
( )1,k kΛ +
圖2. LQG結合AIEM控制流程圖 
 
對於晶體於系統運作過程中所產生未知強度之確定性熱通量輸入項作用於熱導體 0x = 處，
熱導體另一端 x L= 處則為銜接某種散熱裝置所構成的強制對流邊界條件（或控制項 
），結合適應性輸入估測法與 LQG 之主動式控制器設計法則，在執行估測運算時，需
與相關參數初始值配合。 
ˆ( )u k
 
4. 結果與討論 
    為驗證本文提出 LQG 結合適應性輸入估測法對電子元件產生之熱通量估測及最佳散
熱控制法之效率與精度，以不同時變熱通量來驗證本論文所用演算法估算之準確度，模擬
量測溫度熱電耦置於外壁之 處，取樣時間33 10L −= × m 0.01secdt = ，模擬時間 ，空間離
散間隔
300secft =
52 10x m−∆ = × ，對流係數 ，系統模式誤差變異量為 ，量測誤差變
異 量 ，
2 0
10 /airh W m C= × 410Q −=
2 610R σ −= = σ 為 標 準 偏 差 量 ， 卡 爾 曼 濾 波 器 之 初 始 條 件
[ ]( 1 / 1) 0 0 ... 0 TX − − = , ，遞迴式最小平方法之初始條件為3( 1/ 1) [10 ]P diag− − = ˆ( 1) 0q − = ，
與 為零的矩陣， 與8( 1) 10
b
P − = ( 1)M − ( )1 / 1P − − ( 1)bP − 值一般設定為非常大的值，主要是將初始
誤差視為非常大，使輸入估算器能夠經過短暫暫態反應時間而快速收斂，進而穩定的追蹤
時變參數 ，模擬量測溫度數據之獲得，係先假設一恰當值 作為功率晶體產生之熱通
量，再由 LQG計算控制散熱量，時間導數採用前向差分，經由直接熱傳導解法求解溫度場
之分佈，再藉由所求得溫度場加上量測誤差，作為模擬熱電耦量測之溫度。 
exactq
( , ) ( , )  a aZ t x T t x ω σ= +                                             (32) 
    本文之模擬架構設計是以量測溫度點於 CPU外壁與強制對流邊界處，模擬不同時變熱
通量以方波輸入估算如(33)式所示： 
 5
圖 4.及圖 5.分別為透過 RRMSE 進行參數設定模擬，因重視整體系統之累加誤差項 及能
量控制項 為最佳化控制之參數取向，採固定 參數值進行模擬。經圖 4.之 RRMES
模擬顯現 與 之關聯特性，當 值越小、 值越大的趨勢下，可獲得較佳之控制性能。
圖 5.則是將 與 之值固定，對 進行 RRMSE 數值模擬，明顯可獲得當
時，控制效能已達極致。 
1Q
2Q 0 0.1Q =
1Q 2Q 2Q 1Q
0 0.1Q = 2 0.0001Q = 1Q
1 100000Q =
    由圖 6.中以不同 對 CPU 輸入時變熱通量進行最佳化熱控制性能比
較，結果顯示與圖 5.模擬狀況相符，經此驗證過程後將可獲得 之最佳控制效能參數
值。於獲得最佳控制效能 參數值後，可進一步驗證適應性輸入估測法結合 LQG 控
制器之效能，並與傳統 LQG控制器進行分析比較。圖 7.為 CPU熱通量最佳熱控制結果顯
示，適應性輸入估測法結合 LQG控制器之最佳控制效果較傳統 LQG控制器反應快且較為
精確。 
1 1,  1000,  100000Q =
0 1 2
, ,Q Q Q
0 1 2
, ,Q Q Q
0 50 100 150 200 250 30040
42
44
46
48
50
52
54
56
58
60
Time(sec) 
Te
m
pe
ra
tu
re
 ( 
0 C
 )
Q0=0.1         
Q1=100000  
Q2=0.0001   
LQG
LQG+AIE
圖 7.輸入方波 CPU熱通量最佳熱控制結果比較 圖 8.輸入方波 CPU溫度最佳熱控制效果比較 
 
圖 8.為 CPU溫度最佳熱控制效果展示，因傳統 LQG控制器存有未知項輸入無法獲知的問
題，故其控制反應較為遲緩，然而，藉由適應性輸入估測法可即時估算未知輸入量，並結
合 LQG控制器計算出最佳熱控制之散熱控制量，將可達到快速精確之散熱效果。由模擬結
果驗證，本文提出之適應性輸入估測法結合 LQG控制器之最佳控制合成法則，適合應用於
具時變或瞬變特性且未知之系統模式中，最佳化控制問題的處理。 
 
5. 結論 
    未來電子產品將持續朝向高功率、高效能及輕薄短小的方向發展，現今電子產品已被
要求體積小、功能強、運算效率快，惟熱量亦隨之大幅提昇，容易超過元件最高容許操作
溫度，造成損毀，本文發展適應性輸入估測法結合 LQG控制器將可有效快速對元件進行熱
控制，並達到預期之控制目標，快速精確之最佳散熱控制器，對於產品保護或操作環境溫
度之控制可提供即時有效監控，未來可應用於產品熱加工、散熱裝置研發測試，具廣泛應
用價值。 
 
6.自評 
   本研究成功提出應用適應性輸入估測法(AIEM)結合最佳化控制(LQG)，藉量取電子元件
外部或邊界某點可量測之溫度，即時逆向估算求得未知輸入熱通量，提供最佳化控制之散
熱機制參數設計。本研究成果亦投稿以及發表於以下之期刊與研討會: 
 7
