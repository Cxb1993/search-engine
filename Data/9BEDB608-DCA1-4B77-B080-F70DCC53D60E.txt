合結果對不同模組的影像做套合，最後得到第二種套合結果。 
我們使用以特徵為基礎的套合方法來達到目標。第一步從兩張影像中取出特
徵點。因為這些特徵點並不只是從胚胎取出，也有從影像中的其他物體取出，所
以我們使用群集演算法來移除由其他物體取出的特徵點。我們的套合方法分成初
始和改進兩個部份，其流程如圖一： 
 
圖一 特徵套合架構流程 
3-1-1  特徵套合流程 
 觀察兩張原始的圖，影像強度方法(Intensity Base)是利用兩張圖裡面，物體
相同的部分必須要有相似的灰階值，才可以達到套合的效果。但是由兩張圖得
知，物體相同的部分，由於受到偏壓的影響，導致灰階值的差距很大，並不相同。
雖然灰階值有所差異，但是胚胎基本的形狀和輪廓都相同，因此可以使用特徵方
法來解決套合問題。以下為套合步驟方法: 
步驟 1. 擷取角落特徵(Extract corner features) 
 使用 RPI 中的程式對影像取角落特徵(corner feature)，使得所取的角落特徵
如圖二所示： 
圖二  標記為角落特徵(corner feature) 
步驟 2. 初步的套合(Initialization) 
移除分離物(Remove outlier) 
 因為影像中除了胚胎，也包含了液泡或其他不屬於胚胎的物體，所以在取特
徵時，同時也會對這些胚胎以外的物體取特徵。若在做套合的同時加上這些不屬
3-1-2  精密的套合 
步驟 3. 擷取面的特徵(Extract face features) 
 完成初步的套合後，雖然套合方向大致正確，但是我們需要更精密的套合結
果，接下來必須取不同特徵來改善結果。於是繼續使用 RPI 中的面的特徵(faces 
features)。在非胚胎的部分取到面的特徵，必須將這些特徵去除並保留胚胎內的
特徵。在此可以利用先前角落特徵的資訊，首先以之前求出的一階矩法為中心，
以多邊形離一階矩法最遠的距離為半徑，在此圓內面的特徵保留下來，其餘的去
除，結果如圖五： 
圖五  去除胚胎外的雜訊 
步驟 4. 精密的套合(Refinement) 
 在這個步驟裡，使用點對線(point to line)的觀念來做改善。這個觀念主要是
解決如何從線上的某一點，移動到對應到這條線上的另一點，在此的方法就是由
另外兩條線再找出兩組對應點，來幫助對齊。 
 利用上個步驟得到的面的特徵，它們包含了各自的位置和法線的資訊，因此
可以利用這些資訊完成點對線的對應。改善後的結果如圖六所示： 
圖六  套合結果 
3-2 自動偵測細胞數 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
     
     
圖八  (a)原圖(b)中值濾波器(c)形態學開放運算(d)梯度各向異性擴散濾波器 
3-2-2 細胞邊緣偵測 
邊緣偵測(Edge Detection) 
經過雜訊去除的圖片需要再執行邊緣偵測， 找出細胞之間的邊作為橢圓偵
測的依據。起初利用常見的邊緣偵測的方式如 :canny edge detection、sobel 
detection 結果都不適合胚胎細胞邊的偵測，會連塊狀雜訊都偵測出來。觀察胚胎
影像發現胚胎內的細胞邊有類似血管樹狀的性質，可以利用血管偵測法的方式，
找出周圍最類似血管的部份，利用 Michal Sofka， Charles V. Stewart 的 Likelihood 
Ratio Vesselness (LRV)方法， 找出與血管最相似性質的邊將會被偵測出來。因此
選擇來做為細胞邊緣偵測的方法。比較如下圖九: 
   
(a)                   (b)                   (c) 
圖九  (a)梯度各向異性擴散濾波器(b)Canny Edge Detection(c)LRV 
3-2-3 橢圓偵測 
橢圓偵測(Ellipse Detection) 
   
(a)                      (b) 
   
(c)                     (d) 
胞數方面切割如圖十一所示： 
 
圖十  (a)套合結果(b)套合結果方塊比較圖 
 
(a) 
 
(b) 
圖十一  (a)人工圈選的細胞(b)程式執行結果 
五、具體成果與未來工作 
本研究預計以二年的時間研發完成應用於醫學上自動胚胎細胞數偵測。第一
年著重於多模組型式的套合及細胞邊緣的切割，並發展有效且快速的演算法，包
含影像的特徵擷取和套合方法與找出橢圓細胞的方法。第二年目標在完成多模組
型式的套合驗證及配合套合結果驗證細胞的切割並且完成細胞數量的計算，最後
整合所有系統功能完成系統測試。以下是我們研究完成項目及下年度工作要項。 
1.完成工作項目 
本計劃全程計二年，第一年完成的工作及具體成果包括： 
a.完成差別干擾對比顯微鏡(DIC)影像對差別干擾對比顯微鏡(DIC)套合，完成
同一種模組型式套合。 
b.驗證差別干擾對比顯微鏡(DIC)影像套合正確性，完成相同模組型式上的套
合驗證。 
c.去除細胞周圍雜訊，找出適合細胞邊緣切割方法，完成胚胎內細胞分割。 
2.預計下年度工作項目 
contrast microscopy to produce accurate cell counts in live mouse 
embryos,” Master’s thesis, Northeastern University, 2005. 
[11] D. Hogenboom, C. DiMarzio, T. Gaudette, A. Devaney, and S. Lindberg, 
“Three-dimensional images generated by quadrature interferometry,” Optics 
Letters, 23:783–785, 1998. 
[12] D. Townsend, G. L. C. DiMarzio, and M. Rajadhyaksha, “Multimodal 
optical microscope for imaging biological systems.” In Proceedings SPIE 
Conference on Three-Dimensional and Multidimensional Microscopy: 
Image Acquisition and Processing XII, volume 5701, pages 136–145, 2005. 
[13] Dimarzio, “Optical quadrature interferometer,” united states patent 6020963, 
2000. 
[14] Richard Alan Peters, A New Algorithm for Image Noise Reduction using 
Mathematical Morphology, IEEE TRANSACTIONS ON IMAGE 
PROCESSING. VOL. 4. NO. 5. MAY 1995 
[15] Robert A. McLaughlin “Randomized Hough Transform: Better Ellipse 
Detection.” TENCON '96. Proceedings. IEEE TENCON on Digital Signal 
Processing Applications, vol. 1, pp. 409-414, Nov. 1996 
[16] Michal Sofka, and Charles V. Stewart “Retinal Vessel Extraction Using 
Multiscale Matched Filters, Confidence and Edge Measures.” IEEE 
Transactions on medical imaging, vol. 25, no. 12, December 2006. 
 
