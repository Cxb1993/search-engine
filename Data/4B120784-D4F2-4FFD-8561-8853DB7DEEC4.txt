 2
cussed weaknesses and transformation of bound-
ary-fitted grid, this study will parallelized the FA 
programming code to get the most advantage of 
high speed calculation. We only report here our 
first-year’s achievement. 
Keywords: finite-analytic method, pseudo-spectral 
element method, discretization, eigenfunction, 
parallel computing 
二、計畫緣由與目的 
「有限解析離散法」 (finite-analytic discreti-
zation method，以下簡稱FA 法)係於1980年代由
美國愛荷華大學機械系陳景仁(Ching-Jen Chen)
教授的研究群(約有超過十位PhD研究人力)開始
發展，至1984年Chen,CJ & Chen,HC(陳漢欽)教授
共同發表在J. Computational Physics[12]後，其離
散形式大致已趨成熟，其後之發展大抵為應用在
各類複雜流場與熱傳問題之細節處理，並配合各
種數值技巧：包括如三維離散式的簡化，改變元
素邊界函數與形狀、紊流模式、矩陣疊代SOR 技
巧、貼壁格網局部轉換、移動邊界處理、變數耦
合處理如Navier-Stokes方程使用SIMPLER/PISO 
技巧與非交錯(unstagger)網格等等。FA 法演進至
今，已具備可被應用於求解複雜波流場熱質傳輸
問題的完整架構*。FA法的離散關係使用局部解
析解的技巧，不但解決了許多「對流-擴散傳輸」
(convection-diffusion transport)型態流場方程式
(如NS方程式)所遭遇的「非線性對流」引致的困
難，而且亦提供與其他數值技巧容易搭配的彈
性，因此是這個方法成功最核心的關鍵技術。然
而，任何一個優良的數值方法，尤其是最具基礎
部分的離散近似關係，都應隨末端應用的需求與
效率精度的提昇目標，進行更精緻深入的改良與
演進，才能被廣泛接受及延伸應用。在主持人沿
用多年此離散法的經驗與了解，自覺尚有許多待
改進之處可以再深入研究，這是本研究計畫所欲
探討者。為了說明本研究的研究動機與具體目
標，有必要先回顧原有離散方法簡述其概要概念
並據此討論其缺點，至於本方法應用細節與實作
部分可參考本計畫書所列之文獻，以節省篇幅。 
常被普遍使用的有限解析離散法主要用於離
散「對流-擴散傳輸」偏微方程式(convection - 
diffusion transport PDE，除此外尚有其他求解雙
曲線形PDE 或非線性代數式等之應用)，這是典
型描述不可壓縮黏性流場的Navier-Stokes方程組
形態的處理，因此工程應用上自有其重要性而無
須贅言。此處將以二維流場為例來說明，可避免
繁複枝節的數學列式，而能清楚凸顯重要概念。
考慮二維對流-擴散傳輸方程式 
2 2 2x yA B S       (1) 
下標表示對其微分，非穩項可包含於源項S。上
式中A=A(, x, y), B=B(, x, y), S=S(, x, y)，但經
局部線性化(local linearization)處理後，在很小的
元素中可將此三量皆視為常數(通常以欲求節點P
處變數P之近似值AP, BP, SP，或選擇區域的平均
值 , ,A B S 表之)，這是第一個近似假設。欲離散
連續的PDE式(1)在−h ≤ x ≤ h,− k ≤ y ≤ k的元素
中，即將其表示為代數式 
P nb P Pnb C S    (2) 
若使用3x3格點構成之元素時，上式含下標nb者
代表在x = ±h, y = ±k邊界上的八個節點(三維
3x3x3元素則為邊界上的二十六個節點)之值；而P 
點位於局部原點，為欲求之變數節點，各節點變
數的權重係數Cnb 與源項之係數CP 即為FA係
數。欲解析求解式(1)就必須先建立並滿足元素四
邊的邊界條件以得唯一解。求解步驟包含: 
(a) 因各元素邊界上都包含有三個節點，所以在
每個邊界上都可以建立一個連續內插函數，
使其滿足此三個節點的變數值，而每個邊界
上的內插函數就是式(1)的邊界近似條件。例
如：在y = k邊界(N)上，若 , ,NE NW NC   代表
在x=h, −h, 0 三個節點之變數值，則可建立內
插函數 ( ) ( , , , )N NE NW NCx f x    作為邊界
近似條件。 
(b) 將式(1)搭配任一個內插得到的邊界條件並與
其他三個邊界上之均勻(為零)邊界條件而構
成一組完整的邊界值問題(BVP)以求解。例
如：其中一個BVP為求解(1) (x, y)使其滿足式
(1)與邊界條件 (1) ( ) ( , , , )NE NW NCN x f x     
(1) (1) (1)( ) ( ) ( ) 0E WS x y y     (含下標N, S, E, W
之量分別代表y= k, −k, x=h, −h 之邊界量。) 
 4
加總項數減少(即較快收斂速率)。相對的，一般
的離散法如有限差分法，有限元素法與有限體積
法任意假設近似函數就顯得無效率。HC Chen 提
議使用線性與指數所組合之內插函數作為邊界
條件，改善了過去使用二次多項式或片段
(piecewise)多項式為內插函數時所產生FA 係數
為負值的情形，這已經是屬於較高層次的技術
了，但仍免不了有高頻震盪(數值Gibbs 現象)的
缺點。相對而言，HC Chen 這種離散方式亦存在
一些缺點：例如較大的對流係數(因為流場很大的
Re 數以及極小的格網尺度)使得離散必須使用特
徵線的觀念處理(HC Chen 只用到一階)而常喪失
精度；較大 (約超過兩個量階次 )網距長寬比
(aspect ratio)的格網將減緩收斂速率與精度；無法
直接表示變數之導數而不利於Neumann 或混合
形之邊界條件等的應用；無法直接估算誤差指標
以供調適格網(adaptive grid)或多重格網(multigrid)
細化策略與評估的應用；局部線性化與邊界內插
函數的精度改進；不規則(irregular)格網的應用限
制；配合平行計算的考量必須重新變更級數形避
免相依性(recurrence)等等，尚有其他流場應用的
一些問題凡是NS 方程式可能遭遇的，在FA 法
都應會遇到，本計畫書僅略舉數端以視端倪。這
些缺點部分與近似假設的限制有關，有些卻無關
於解析解本身而在於表示的函數形式的不當，使
其在計算某些流況產生效率不彰或精度不足的
問題，甚或因為強烈非線性的物理特性而必須被
迫調整格網粗細密度配置，方能獲至合理精確的
結果。與近似假設的限制有關者較易理解，殊不
贅言；而函數形式不當者則須詳加細論。此乃因
解析解雖既只是所求問題唯一的函數值，但使用
不同正交函數展開時，各有不同計算的精度與效
率求得。例如一個實函數，可以用Fourier-sine 或
cosine 之 級 數 表 示 ， 也 可 以 用 多 項 式 或
Chebyshev 級數表示，甚或可用更複雜的
Fourier-Langrange 級數或Fourier-Bessel 級數或
任何正交的超越函數表示，但各種展開係數An 
之漸近行為(asymptotic behavior)與達到足夠精度
所需之項數N 各不相同，因此收斂速率、精度與
計算效率皆因此而各不相同。再者，理論上FA 法
既是局部解析解，應可自動因應非線性的特性並
給于上述所有之資訊，以合理表現方程式所描述
物理現象的離散關係(因此優於其他離散法)。然
而解析解以三角函數級數形態表示易因精度不
足而產生震盪(如非週期邊界條件以具週期性之
正交函數展開更為顯著，數值耗散與頻散引起的
振幅與相位誤差、或者在不連續的奇異點處如角
落產生Gibbs 現象等都是產生震盪之來源)。且
HC Chen 因推導過程為簡化解析關係而直接帶
入所求(中央)格點原點座標，導致只能獲得最後
的離散權重(FA)係數，而無法求得其他變數導數
的近似關係等等，都造成使用上的不便。再者FA 
係數因Fortran 雙精度實數計算時，浮點及指數位
數的限制(例如指數之冪數過大超過浮點界線時
就無法運算等)，加上不良的計算法則(algorithm,
如級數中各數列極大與極小值相減喪失有效精
度等)，使FA 係數計算精度嚴重喪失的問題；另
外，級數陣列若未兼顧使用Fortran 90/95 記憶動
態分配(dynamic allocation 或pointer)及儲存位置
連續性等程式技巧，與善用現行CPU 使用序列
(sequential)或多平行緒(multithread)技術計算，配
合現有平行程式庫(如MPI)併合網路資料傳輸等
之考量等等，這些因素均影響FA 法在高速與高 
精度計算效率的提升的運用，所以有再深入研究
的必要性。 
三、計畫內容與方法概述 
本研究成果報告僅包含第一年時程之工作
內容。以下簡略介紹工作內容與使用方法： 
a. 先就目前 FA 級數解進行全面測試。因構成級
數有幾個主要參數如Ah, Bk, h/k 等影響級數型
態加總(有E2與 E2兩種級數和各影響FA 係數)
的選擇，當Ah 與Bk 其一較大時，特徵值nh 
與nk必須足夠大才能使式(4) 中E2 與E2之數
列逐漸變小而達收斂。為了達到此目的，通常
會選擇指數較大者之級數加總使其儘速趨於
零，然而正負交替的數列常使有效位數因而減
小(如兩數量相當的數字相減使有效位數減少
等)，因此導致級數和成為極小負值，對h/k 或
Ah/BK 或大或小(如處理高雷諾數極薄邊界層
時，格網長寬比可大到100 倍甚或更大的情形
常會發生此種情況)有極大影響。將這些形成問
題的參數範圍先區隔出來，並推斷較佳的計算
程序使其保持精度。 
 6
2 2
1 1 2 /[( ) ( ) ]nAh Ah h     
因此，在y=k處,w(2)(x, k)=0,由 (1) ( , ) ( )Nw x k w x 可
得An與An之關係 
/ sinh 2BKn n nA A e k . 
同理，在y=-k處,w(2)(x, -k)=0,由 (1) ( , ) ( )Sw x k w x   
( ) [ ( ) ]Bk Ax Ax AxS S S SC Sw x e a e b xe a e      
1
sin ( )Bk n n
n
e B x h

 
 
式中 2( 2 ) /(4sinh ),S SE SW SCa Ah      
[ coth ( 2 )]/ 2S SE SW SE SW SCb Ah h          . 
因此， 
/ sinh 2BKn n nB B e k  
1
0 1[( 1) ( )]
n
n S S SC SB a b a         (11) 
其他邊界E,W條件的轉換類同但影響w(2) 
( ) [ ( ) ]Ah By By ByE E E EC Ew y e a e b ye a e       
1
sin ( )Ah n n
n
e C y k

    
( ) [ ( ) ]Ah By By ByW W W WC Ww y e a e b ye a e      
1
sin ( )Ah n n
n
e D y k

    
式中 
/ sinh 2Ahn n nC C e h  , / sinh 2Ahn n nD D e h   
2( 2 ) /(4sinh ),E SE NE ECa Bk      
2( 2 ) /(4sinh ),W SW NW WCa Bk      
[ coth ( 2 )]/ 2E NE SE NE SE ECb Bk k          , 
[ coth ( 2 )]/ 2W NW SW NW SW WCb Bk h          , 
1
0 1[( 1) ( )]
n
n E E EC EC a b a        , 
1
0 1[( 1) ( )]
n
n W W WC WD a b a        . 
使用兩個函數形w(1), w(2)來替代原來HC Chen的
四個函數E, W, N S的目的，係簡化FA係數權
重關係有很大的便利處，因為N S或E S均有共同
對應的均勻邊界條件(如式(7) w(1)或w(2)中之An, 
Bn 或 Cn, Dn均有共用sine函數與特徵函數及特
徵值)且其Fourier轉換係數相同(An, Bn有相同o, 
1；對應的Cn, Dn有相同o, 1)，有利於直接在推
導時可以消去含級數項的係數，因此可以獲得比
HC Chen論文中更精簡的推導關係。 
此處若依HC Chen的方法代入(0,0)座標，則
可直接獲得FA係數。但如前所述，欲求邊界導數
與元素內部任何一位置之內插值(事實上，這已是
解析解的函數值了，但因解析解是由滿足近似之
邊界條件與線性化方程式求解獲得，故仍用內插
值稱之，較具普遍化。) 
1. 邊界導數值/y：(僅考慮/y在y=k邊界) 
由式(5)對y微分 
2 2( , ) ( ) 2( )
Ax Byw Bgx y Bw e
y y A B
        (12) 
式中 
(1) (2)w w w
y y y
       
(1)
[ cosh ( ) cosh ( )]sin ( )n n n n n n
w A y k B y k x h
y
           
(2)
[ sinh ( ) sinh ( )]cos ( )n n n n n n
w C x h D x h y h
y
              
此時An, Bn, Cn, Dn已經求出。所以，以 y = k代入
(11)中就得到N邊界導數值 
2 2
( , ) { ( ) [ cosh2 ]sin ( )
[ sinh ( ) sinh ( )]cos2 }
2( )
Ax Bk
N n n n n n
n n n n n n
x k e Bw x A k B x h
y
BgC x h D x h k
A B
   
   
    
        


 (13) 
這些項的計算可以直接使用程式序列計算，但較
無效率。如同HC Chen計算FA係數時，使用特殊
解 1  與 Bx Ay    來找出級數的簡化關係，
我們也可由這些特殊解的導數 / 0,  or y A   來
獲得簡化關係，可以表示為單獨一個級數的關
係，而且是元素內各格點P與nb的權重和。因為
過程十分繁瑣(但不困難)，而且列式甚佔篇幅，
因此在此精簡報告就不一一列出；但式(13)及相
