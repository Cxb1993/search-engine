2摘要
本研究利用李群打靶法進行壓電致動系統之磁滯動態反算，該反算法則只需利用壓電定位
平台的位移響應、平台參數與輸入電壓訊號等即可反算磁滯動態，不需要磁滯數學模式，因
此可以免去複雜的磁滯建模過程。其次吾人可以利用反算所得到的磁滯動態位移進行反向前
饋補償，以消弭壓電致動器的磁滯效應，除了前饋補償外，本研究並整合比例與積分回授控
制，以克服定位平台的動態以及系統模式不確定性的影響。數值模擬顯示本研究所提出的方
法可以精確求得壓電系統的磁滯動態，另外利用反算求得的磁滯動態也能有效削減磁滯非線
性對控制系統的不利影響。
關鍵詞：磁滯非線性、壓電致動系統、李群打靶法、反向前饋補償。
Abstract
In this study, the Lie-group shooting method is adopted to estimate nonlinear time-varying
hysteresis observed in the piezoelectric-actuated system. The method calculates the nonlinear
hysteretic dynamics using the system response, system parameters and the knowledge of control
input. Therefore, complicated mathematical model which has often been applied to capture
hysteresis can be saved. In order to compensate for nonlinear hysteretic effects, the calculated
hysteretical displacement can be used to implement an inverse feedforward compensator. In
addition, the compensator is integrated with the regular PI controller to overcome modeling
uncertainty and disturbances. Numerical investigations indicate that the proposed scheme can not
only capture nonlinear hysteretical features but also improve the tracking performances of the
piezoelectric-actuated system.
Keywords: Lie-group shooting method, inverse feedforward compensation, nonlinear hyeteresis,
piezoelectric-actuated systems
ㄧ、簡介
近年來由於奈米科技的快速發展，半導體產業、生物科技產業、光電產業及精密製造業
等，都朝著更精密與更微小尺度的方向演進，間接造成精密定位技術的需求。在許多精密定
位控制的技術與設備中，以壓電材料為致動器的系統，由於其快速反應特性，加上體積小、
重量輕、解析度高與剛性強的優點，近年來被廣泛應用於精密定位平台上。雖然壓電致動器
具有前述各項優點，但壓電材料卻存有磁滯(hysteresis)非線性，壓電材料的磁滯現象會直接影
響壓電致動平台之定位精度，另外由於磁滯非線性行為不僅與輸入電壓有關，也與輸入頻率
有關。因此嘗試利用數學模式來完整表達壓電致動平台的動態行為，並非易事。這也導致以
模式為基礎的控制法則常需複雜的數學模式與計算，使得控制器的設計平添困難與複雜度。
鑑於磁滯非線性會影響壓電致動平台之控制精度，不同的控制法則被研究學者提出，藉
以克服前述磁滯衍生不利於定位控制的因素。這些控制方法基本上分成以模式為基礎的控制
法則，以及不需模式的控制法則。以模式為基礎的控制法則，透過對磁滯非線性的了解建立
磁滯數學模式，著名的磁滯數學模式包括 Preisach 模式[1-2]、Bouc-Wen 數學模式[3-5]，其他
有關磁滯非線性的數學模式建立文獻可以參考[6-7]。其次我們可以利用這些數學模式建立起
反磁滯效應的補償法則，最後利用這些反磁滯補償消除磁滯非線性對系統的不利影響。利用
Preisach 數學模式進行磁滯補償的研究報告除了[1-2]外，尚有[8]。此外利用 Bo-Wen 數學模式
進行磁滯非線性補償的研究報告則有[9-11]。
雖然利用前述幾個磁滯數學模式進行反磁滯補償之控制器設計，並非不可能，控制效果
亦可達到一定的程度，但是其缺點有下列二項。首先前述磁滯數學模式均有相當的複雜性，
因此欲求得其相對應的反磁滯數學模式有一定的困難度；其次，由於壓電致動器的磁滯行為
相當複雜，不僅為輸入振幅的函數，同時亦為輸入方向與頻率的函數，因此磁滯行為不僅具
有非線性特質，亦具有時變特性。依據上述，計畫主持人曾於[12]中提出利用函數近似法來
捕捉同時具有時變與非線性特性的磁滯行為，[12]中顯示以函數近似法不但可以有效捕捉時
4d
th
trr f
)(ˆ
)(  (4)
kbsms
kd
2 
hrre)(tr )(t
圖二 整合反向前饋補償與 PI 回授控制之壓電定位平台控制方塊圖
方程式(4)中之最後一項即為反向磁滯補償部分。依據上述並參考[9-11]之作法，吾人可以得
到方程式(5)所示之控制輸入。不過與前述參考文獻不同，本計畫並未採用觀測器來估測 )(th ，
而是利用李群打靶法來估測。
  d
th
deKteKtr ip
)(ˆ
)()()(  (5)
方程式(5)中 pK 與 iK 分別代表比例與積分控制器之參數值，另外 d 之物理意義同於方程式
(1)、(2)中之內涵。下一節中我們將開始介紹如何利用李群打靶法進行磁滯動態位移之估測。
三、李群打靶法應用於壓電磁滯動態反算與控制
本計畫所使用之李群打靶法主要是參考劉進賢教授所提出並發表於[12,13,15]之方法，所
謂李群打靶法[15]包含二個主要數值運算方法，其一是保群算法，劉教授將原作用於歐式空
間 (Euclidean space)的非線性系統以增加一個時間維度的方式，將其轉換至閔氏空間
(Minkowski space)的類線性系統，再以投影的方法映射至歐氏空間解決問題，此數值方法稱
為保群算法(group-preserving scheme)。另外，對於二次或高次常微分方程式或非線性微分方
程式的邊界值問題，我們可以先假設某初始條件，並將原問題轉為初始值問題，再利用解初
值問題的方法，如泰勒級數法、尤拉法、Runge-Kutta 法等，將假設解求得後，與對應的邊界
值比較，若假設解比邊界值大，重新設一較小的初始條件，反之，則重設較大的初始條件。
如此反覆求解直到假設解與邊界值之誤差在極小範圍內，此一方法因需反覆修正，因此又稱
為打靶法或試誤法。
參考[15]的作法我們首先可以將方程式(1)改寫為
ftt0thm
k
tr
m
kd
m
k
m
b  )()(  (6)
0tatA0 0 )( (7)
0tatB0 0 )( (8)
結構振動系統之反算問題如上列方程式所示，我們可以將時變函數 )(th 視為未知，其他的參
數與時變函數視為已知，另外假設系統的位移響應可以量測得到，於是吾人可以利用在時間
],0[ ftt 內所量測到之位移響應 )(t 與輸入電壓 )(tr 來估測未知之時變磁滯動態 )(th ，並記為
)(ˆth 。依據李群打靶法我們其次將二階常微分方程式(ODE)轉換成偏微分(PDE)形式，此步驟
需引入空間轉換，因此令
)()1(),( txtxu  (9)
6至於最佳之 fx 值可以利用下列作法決定。首先選定一個 ux 值代表 fx 值的變動範圍，其次
選定 ),0( uf xx  ，並且針對每一個 fx 值將其代入(19)式後，計算 ih 。其次，我們將方程式(14)
對 x積分，從 0x 積分到 fxx ，並注意方程式(9)之內涵，因此得到下列之 fiu 值
        



 



  iiii1i1ii1i2ffif
f
i hm
k
r
m
kd
m
k
tm
b
2
t
1
x2x
2
1
x1u  (20)
利用各項已知值透過上式計算出來之 fiu ，與已知的邊界值 ifx1 )(  進行比較，當其總和誤差
為最小時，此時之 fx 值即為最佳之選擇。亦即最佳之 fx 值須滿足下式
  


n
i
if
f
ixx
xu
uf 1
2
),0(
1min  (21)
最佳 fx 值求到後，再利用方程式(19)即可順利估測磁滯動態位移函數 ih 或 )(th ，不過估測所
得的結果在下一節中均將記為 )(ˆth 。在下一節中，我們將利用數值模擬方式驗證本計畫所提
之方法是否能確實捕捉磁滯動態，進而改善壓電致動平台之控制性能。
四、控制器性能驗證
在本節中我們將進行控制器的性能驗證，此處的驗證方式是採用數值模擬方式。首先我
們將利用方程式(1)(2)產生系統的位移響應 )(t 、控制輸入 )(tr 與磁滯動態響應 )(th ，利用前
二項訊號，吾人可以反算系統的磁滯動態響應 )(ˆth ，此項反算結果可以用來與系統的實際磁
滯動態進行比較，以了解李群打靶法捕捉磁滯動態的能力。其次，反算所得的磁滯動態將被
用來削減系統的磁滯效應，以增進壓電定位系統的控制精度。表一顯示本節進行數值模擬時
所使用之定位平台與磁滯模式的參數值，利用表一所示之系統參數進行數值模擬，當參考輸
入為 100sin(210t)時，吾人得到圖三所示之磁滯動態響應與反算結果比對。觀察圖三吾人可
以發現除了暫態響應時， )(th 與 )(ˆth 二者稍有差別外，一旦系統進入穩態狀況後，二者幾乎
沒有誤差，因此觀察圖三，吾人可以了解李群打靶法在這一個例子中，可以十分有效的捕捉
壓電致動器的磁滯動態響應。
表一 壓電致動系統與磁滯數學模式之參數值
m 0.35 kg  0.04
b 61.9 N-s/m d 5.0
k 510095 . N/m  0.2742
其次我們將反算所得到的磁滯動態整合至 PI 回授控制中，以觀察前饋補償器壓抑磁滯動
態影響之效果，結果得到圖四所示之結果。觀察圖四可以發現加入前饋補償器後，確實可以
提高系統的控制精度，其改善幅度約為 13%。此處整體的追跡誤差約為 1%左右。
其次我們驗證參考輸入為步級函數時整体控制器設計或磁滯反算的效果，此項驗證作業
結果顯示於圖五中，圖五上圖所顯示的是磁滯動態位移的反算結果，其中實線式系統實際的
磁滯動態位移變化， )(th ，另外虛線則為利用李群打靶法所計算得到的磁滯動態， )(ˆth 。透
過此圖，吾人可以發現除了暫態以外，穩態狀況下反算結果與實際結果完全一致。另外，圖
五下圖所顯示的是純 PI 控制的結果 )(t1 、整合 PI 控制與反磁滯前饋的控制結果 )(t2 以及系
統的參考輸入 )(tr ，觀察此圖吾人可以發現不論是純 PI 控制或 PI 加反磁滯前饋補償均能有
效消弭磁滯非線性的不利影響，若不考慮暫態部份，則穩態誤差約為 1%，不過此種情況反磁
滯前饋補償對系統穩態誤差的改善並不明顯，其主要原因在於穩態時磁滯衍生的動態位移接
近零，且為常數，因此對控制精度影響不大。
8圖五 輸入為步級函數(step function)之控制結果；上圖：虛線為慈滯動態函數之反算結果
)(ˆth ，實線為系統之磁滯響應 )(th 。下圖：虛線( )(t2 )為 PI 加前饋補償、長點線( )(t1 )為純
PI 之控制結果，另外實線( )(tr )為參考輸入。
五、討論與結論
本計畫提出以李群打靶法返算壓電致動系統的非線性磁滯動態位移，並據以設計反磁滯
前饋補償器，以消弭磁滯非線性效應對壓電磁滯系統的不良影響。為了找尋反算法則我們首
先將二階微分方程式轉換成拋物線型的偏微分方程式，其次利用線性數值方法將此偏微分方
程式離散成常微分方程組。其次利用保群數值解法，求出常微分方程組的解，並以試誤法求
出最佳的數值參數後，反算吾人所需之磁滯動態位移響應變數。
數值模擬結果顯示本計畫所提出的方法可以有效捕捉盜壓電致動器的非線性磁滯動態，
另外透過整合 PI 回授控制，吾人發現以反算所得的結果進行前饋補償可以有效提高系統的追
跡誤差，其中在 10Hz 的弦波測試範例中整體的追跡精度可以提高 13%，另外在方波測試訊
號中，李群打靶法依然有效捕捉磁滯動態，不過穩態控制精度的改善情形則比較不明顯。
六、參考文獻
[1]. G. Song, J. Zhao, X. Zhou and A. De Abreu-García, 2005,“Tracking control of a piezoceramic
actuator with hysteresis compensation using inverse Preisach model,”IEEE Transactions on
Mechatronics, Vol.10(2), pp.198-209.
[2]. Y.-S. Kung and R.-F. Fung, 2004, “Precision control of a piezoceramic actuator using neural
network,” ASME Journal of Dynamic Systems, Measurement, and Control, Vol.126,
pp.235-238.
[3]. Y. K. Wen, 1976, “Method for random vibration of hysteretic systems,”Journal of the
Engineering Mechanics Division, Vol. 102(2), pp.249-263.
1國科會補助專題研究計畫項下出席國際學術會議心得報告
日期： 99 年 10 月 25 日
1. 出席會議經過
本次參加由日本岡山大學工學院所主辦的國際建模、識別與控制研討會，主要用意在多認
識一些亞太地區地同行，尤其是日本與中國地區的學者教授。除了發表個人的學術研究成果
外，另外一方面也籌劃邀請國際學者前來本院參加研討會或專題演講。到達大會會場為大會
第一天，報到完畢後即親自與本次大會主席服務於岡山大學的 Prof Deng 見面，並交換名片，
隨後即參加當日的專題演講與分組研討活動。圖一至三分別顯示大會會場入口、專題演說現
場等場景，另外圖四則顯示本次参與交流所交換的各地學者名片。
圖一：大會會場入口
計畫編號 NSC 98－2221－E－131－014
計畫名稱 應用李群打靶法於壓電致動平台之磁滯動態反算與控制研究
出國人員
姓名
梁晶煒
服務機構
及職稱
明志科技大學機械工程
系
會議時間
99年7月17日至
99 年 7月 19 日
會議地點 日本岡山縣岡山大學
會議名稱
2010 International Conference on Modelling, Identification and Control.
發表論文
題目
FAT-based adaptive sliding-mode control augmented with fuzzy compensation
for piezoelectric-actuated X-Y table system.
附件三
3圖四 本次大會中親自交流的中國與國內學者
5應允前來交流，擬於明年度教學卓越計畫或向國科會與教育部申請國際交流計畫，安排前述
學者前來本校交流訪問並進行專題演講，以加強本院之國際化交流活動辦理。目前提出邀請
並獲正面回應的學者包括京都大學杉江俊治教授、岡山大學鄧明聰教授，其中杉江俊治教授
為國際知名期刊 Automatica 的編輯(associate editor)同時也是 IEEE 與 SICE 二個學會的
Fellow。另外鄧教授為國際期刊 International Journal of Advanced Mechatronics 的主編。
3. 預期成效
未來若能順利邀請幾位國際知名學者前來本校交流，相信可以增進本院國際化的深度，
同時透過學術交流活動，未來以可能派遣研究生或大學部學生，前往這些學校進行學術交流
活動。
4. 攜回資料
本次會議後所攜回資料包括大會會議論文摘要集、論文光碟、岡山大學學系組織改組規
劃以及該校招生宣導活動作法等參考資料。
98年度專題研究計畫研究成果彙整表 
計畫主持人：梁晶煒 計畫編號：98-2221-E-131-014- 
計畫名稱：應用李群打靶法於壓電致動平台之磁滯動態反算與控制研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
