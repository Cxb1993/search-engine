  
 II 
Abstract 
 
The purpose of this project is to study and improve the security of the Mobile Ad Hoc Network (MANET) 
and, its extension, the Vehicular Ad Hoc Network (VANET). There are two contributions in this project: the 
first is to solve the problem of detecting and preventing forged routing packets within MANET. The other is to 
provide information security in VANET. 
We referred to Prof. Adrian Perrig’s TESLA architecture and provided a secure mechanism to improve 
the routing process in AODV (Ad hoc On-demand Distance Vector) protocol. Since current intrusion detecting 
techniques can not protect MANET from forged routing information attacks, we design a specification-based 
detection system suited for the framework of MANET to prevent this problem.  
From the MANET experimental results, we extend the main idea to design a VANET intrusion detection 
model which can detect the forged routing attack and ensures the integrity of transmitted packet. 
 
Keywords: Mobile Ad Hoc Network, Vehicular Ad Hoc Network, TESLA, AODV and intrusion 
detection system (IDS). 
 IV 
圖 目 次 
 
圖 1 AODV 的 Finite State Machine .................................................................................. 12 
圖 2 AODV 加上 SIDM 處理 RREQ 封包之流程圖 ........................................................ 13 
圖 3 AODV 加上 SIDM 處理 RREP 封包之流程圖 ........................................................ 14 
圖 4 平均封包送達率比較圖(MANET) ............................................................................ 16 
圖 5 平均路由位元量比較圖(MANET) ............................................................................ 16 
圖 6 路由延遲比較圖(MANET) ........................................................................................ 17 
圖 7 惡意節點佔總節點數 10%的 PDR 情形(MANET) .................................................. 17 
圖 8 惡意節點佔總節點數 20%的 PDR 情形(MANET) .................................................. 18 
圖 9 惡意節點佔總節點數 33%的 PDR 情形(MANET) .................................................. 18 
圖 10 平均封包送達率比較圖(VANET) ............................................................................. 19 
圖 11 平均路由位元量比較圖(VANET) ............................................................................. 19 
圖 12 路由延遲比較圖(VANET) ......................................................................................... 20 
圖 13 惡意節點比例與 PDR 比較圖(VANET) .................................................................... 20 
 
 1 
1. 前言 
隨意網路為行動通訊開啟了另一使用環境，其安全性議題於近年來備受專家學者的重視，以下分
別介紹研究計畫相關之背景，分為行動隨意網路、車載隨意網路及入侵偵測系統三部分。 
1.1. 行動隨意網路(Mobile Ad Hoc Network, MANET) 
隨意網路的研究最早起源於1968年夏威夷大學的Norman Abramson教授與他的研究生所研究出來
的 ALOHAnet [1]，目的用以連結夏威夷各個島嶼上的大學。雖然 ALOHAnet 是以固定式 Single-Hop
無線網路分封交換的形式所建置，而且並沒有支援路由的功能，但是其概念影響了電腦網路通訊的研
究，最主要的影響對象就是 70 年代美國的軍事領域。 
美國國防部 DARPA(Defense Advanced Research Projects Agency)在 1972 年時，開始資助研究
PRNET (PacketRadio Network)專案，為了讓訊息能夠在戰場上不受固定或有線基礎設備限制下運作，
因此結合了 ALOHAnet 與 CSMA (Carry Sense Multiple Access)的概念，提供了 Multi-Hop 無線通訊的
能力。之後 DARPA 於 1983 年資助了 SURAN(Survivable Adaptive Network)研究計畫：在數以千百的體
積小、低耗電、低成本之設備上提供無線網路通訊的功能。 
隨意網路為吸收了以上研究計劃概念與成果後，逐漸成形的一種網路技術。直到 IEEE(Institute of 
Electrical and Electronics Engineers)發佈 IEEE 802.11 標準時，Ad-Hoc 這個名詞才正式問世。隨著隨意
網路的應用與研究越來越成熟，IETF(Internet Engineering Task Force)遂成立了 MANET 工作小組，負責
MANET 相關通訊協定的標準制定工作[2]。 
MANET 是一種行動式無線區域網路，對使用者提供一個可在行動中使用點對點傳輸的電腦網路。
其架構由一群行動電腦所組成，透過 Multi-Hop Ad-Hoc 連結成無線區域網路，其中部分的行動電腦具
備伺服器功能以及連接無線網路的能力，稱為行動閘道器(Mobile Gateway)。各個行動電腦之間可藉由
高速的無線區域網路進行即時多媒體網路通訊，如受環境阻隔，可藉左右鄰近節點間接傳送信號，以
克服環境阻礙[3-5]。 
隨意網路具有共享無線網路頻寬、動態拓撲與節點間相依合作等特性，其單點傳播(Unicast)的無線
隨意網路的路由策略可分成下列兩種： 
主動式(Proactive) 
每個節點都要有到網路上任一節點的路由，又稱 table-driven。但由於無線隨意網路頻寬有限、移
動性高，因此網際網路的傳統主動式路由協定不完全適用於無線隨意網路，已經有一些經過改良
效率的通訊協定如：OLSR(Optimized Link State Routing)[3]與 TBRPF(Topology Dissemination Based 
on Reverse-Path Forwarding)。 
回應式(Reactive) 
又稱 On-demand routing，只尋找有需要的路由，雖然在首次尋找耗時較多，可能造成封包延遲，
但相較於主動式，因為通訊只涉及少數節點，可省去一些不必要的路由維護。適合偶發且一旦發
生則有大量流量(traffic)的使用環境，通訊協定如：DSR(Dynamic Source Routing)、AODV(Ad hoc 
On-demand Distance Vector)[5]。 
1.2. 車載隨意網路(Vehicular Ad Hoc Network, VANET) 
針對不同用途與需求，隨意網路也隨著使用環境而有所變更，例如為了克服環境上的限制而蒐集
資料所使用的感測網路(Sensor Network)，或運用於車輛上之車載隨意網路。其中，VANET 技術逐漸成
熟於 2003 年，IEEE 的短距離無線通訊(Dedicated Short Range Communications, DSRC)研究團隊針對「行
 3 
改或是濫用合法使用者的權限，如非法執行管理者權限的程式，加密技術就無法防範這些內部發起的
攻擊(Insider Attack) [13]-[17]。入侵偵測就是為了防範這些新的網路攻擊而產生的技術。 
根據系統架構，入侵偵測系統可分為： 
網路型(Network based IDS) 
網路型入侵偵測系統監聽網路訊息內容，以找出可疑及非法的網路訊息，一般都是放在區域網路
的 Gateway 或是系統的網路進出口。 
主機型(Host based IDS) 
主機型入侵偵測系統是和系統核心(Kernel)整合在一起，類似防毒軟體的做法，監聽系統核心的運
作，找出非法的系統程式運行。 
根據偵測方式，入侵偵測系統可分作： 
特徵比對型 (Signature-based Intrusion Detection System) 
可稱作 Rule Based IDS 或 Policy Based IDS，亦可稱為誤用偵測(Misuse detection)。該偵測方式針
對已知攻擊，分析攻擊的特徵，再運用這些特徵建立資料庫，監控和比對即時網路訊息的內容。 
異常偵測型 (Anomaly-based Intrusion Detection System) 
該偵測方式運用資料探勘(Data Mining)、統計或各類演算法進行分析與定義正常與異常行為，而不
是只描述固定的攻擊特徵。 
除上述偵測方式，2005 年美國加州大學戴維斯計算機安全實驗室(UC Davis Computer Security 
Laboratory)所提出的規範型入侵偵測系統(Specification based Intrusion Detection Approach)[18]-[20]，此
新型入侵偵測方法會事先定義通訊協定上需遵守之規範，只要遵守規範之節點與傳輸封包皆視為正
常，於偵測驗證上不需要消耗大量運算，適合無中央控管(Centralized Point)特性與低運算量之
MANET。下表 2 為三種入侵偵測方法與是否適用於隨意網路之比較敘述： 
表2 三種入侵偵測技術之比較[20] 
項
次 
入侵偵
測技術 偵測方式 是否適用於隨意網路 
1 特 徵 比
對型 
需先建立比對資料庫，對已知特徵
之入侵偵測有效 
MANET 無固定特徵點，特徵比對無法有效進
行入侵偵測 
2 異 常 偵
測型 
需對使用者之正常與異常行為作分
類，對異常行為之入侵偵測有效 
MANET 使用者的行為難以分類，且異常偵測
無法偵測隨意網路上偽造封包的攻擊 
3 規範型 針對不同協定特性之網路環境定義
正常運作規範，對不合規範之入侵
偵測有效 
可針對不同協定定義規範，適合 MANET 
 
 5 
表3 隨意網路特性與入侵偵測系統需求[20] 
項次 隨意網路特性 隨意網路之入侵偵測系統需求 
1 新型態網路攻擊 可偵測偽造封包等攻擊方法 
2 分散式的網路環境 可行且有使用者擴充性之架構 
3 動態且不可預測之網路拓樸 有效且可即時更新狀態 
4 不穩定之無線網路傳輸 可容忍封包遺失 
5 頻寬限制與計算考量 低訊息交換量與計算量 
6 無可信賴之管理者 自動與即時性的路由恢復機制 
2.2. 確保行動車載網路安全 
同樣是植基於隨意網路技術，因此，MANET 上的安全問題也將成為 VANET 上的隱憂。此外，車
載的特性也可能產生新的安全漏洞，例如以定位系統為基礎的路由傳輸協定，可能遭受惡意使用者對
行車定位的資訊任意擷取與竄改。本計畫第二個目的為解決車載網路可能遭受之入侵問題，將 2.1 小
節研究 MANET 所得之入侵偵測技術運用於 VANET。 
VANET 為 MANET 運用於車輛等快速移動之節點，然而兩者間仍存在一些差異性(詳見 1.2 節與表
1)，因此要引用 MANET 之入侵偵測技術，需考量下列三項主要差異點： 
網路拓撲(Network topology) 
MANET 之節點可移動於任何地方，例如智慧型手機或筆記型電腦即可視為一個節點，其網路拓
墣是隨機變化的，沒有固定的形式；而 VANET 之節點為行駛於街道上的車輛，其網路拓撲會隨著
行駛路徑而變化。 
移動速度(Mobility) 
MANET 之節點通常為智慧型手機或筆記型電腦這類的小型行動運算設備，大多為使用者所隨身
攜帶的，因此節點的移動速度即為人的移動速度；而 VANET 之節點為車輛，車輛行駛時通常擁有
相對較高的移動速度。 
路由方向(Direction) 
VANET 會因為車輛高速行駛於不同方向，而造成資料傳輸上的遺失與延遲。路由技術的設計時，
必須考量節點的路由方向不同(逆向車輛或轉彎)；此外，VANET 的路由方向也有一致性(同向車
輛)，不似 MANET 無方向性之限制。 
本計畫目的之二為考量比較 VANET 與 MANET 之差異性後，針對其限制與不同點，修改並建立
適合 VANET 之規範型入侵偵測與回復系統。 
 
 7 
偵測工作，負責該群的安全防護。此外，亦有不少入侵偵測方法是結合統計與機率的概念而設計出來
的，如：Sun 等學者[42]提出一個基於馬可夫鏈與異常偵測演算法的入侵偵測模型。 
隨意網路具有高度動態拓撲的特性，因此上述兩類傳統入侵偵測方法，並不適合運用於隨意網路。
因此，研究分散式系統的專家學者便提出了規範的概念(specification concept)，根據傳輸協定定義出正
常行為的規範，而違反規範的行為則被視為惡意的攻擊行為。Ko 等學者[43]首先提出此種規範概念，
並且運用此概念來維護分散式系統的安全。Huang 與 Lee 兩位學者[44]混合了規範與統計學等兩種方法
來偵測入侵攻擊，透過有線狀態機(finite state automaton)可以建立起符合正常使用者的行為模型，另
外，根據傳輸協定的規範與透過統計方法所得到的特徵則被用來設計偵測模型。 
綜觀以上三類防護安全的方法，我們採用規範概念來設計適用於隨意網路的入侵偵測系統來達成
本研究計畫之目的。 
 9 
此攻擊可以造成大範圍的路由損害，由於是為他人散佈的資料，內容不應更動，所以能以加密方
式進行資料簽章以確保資料完整性。其保護方式和認證身分類似，但鑰匙的管理會因為其完全分
散式的架構變得較為複雜。 
攻擊者偽造自身發布的路由資訊 
此攻擊方式所影響的路由資訊限於攻擊者相關的路由，根據偽造的資訊，攻擊者可以增加或減少
和自己有關的路由，網路攻擊所造成傷害仍然嚴重，可以達到與前兩者類似的效果。由於隨意網
路之路由拓樸可能不斷改變，偵測這種攻擊變成相當困難，防禦此攻擊模型是本計畫研究之重點。 
針對上述 4 種攻擊模型，本計畫將進行更進一步分析探討：第一種攻擊方式與網路路由通訊協定
無關，可能阻斷與攻擊者相連的封包傳輸服務，攻擊者可以選擇性的不合作，例如隨機選擇時間或對
象，或是專門針對某些服務或路由，造成部分封包傳輸的不穩定。 
第二至四種的攻擊方式可以任意修改網路拓撲，造成大範圍傷害，其攻擊方式是竄改路由資訊，
因此和網路路由通訊協定直接相關，攻擊內容需依據通訊協定作修改。第二種方法可以假冒任一節點，
發布其路由資訊，可以直接偽造此節點的網路拓樸。 
第三種方法可以偽造遠端節點的路由資訊以竄改其網路拓樸，所造成影響多半是受害者三個以上
節點距離的網路拓樸。 
第四種方法可以偽造自身發布的路由資訊，以此擴大攻擊者的網路拓樸影響力，其結果將誘使其
他節點增加經過攻擊者的路由數量。雖然攻擊方式較為間接且隱密，但是攻擊影響力不下於前兩種攻
擊。 
4.1.3. 分散式入侵偵測系統架構 
由於隨意網路是完全分散式的網路架構，入侵偵測系統也必須是分散式的。每個節點(或車機)必須
都有獨立運作的入侵偵測系統。偵測系統會監聽所保護的路由通訊協定的訊息，並運用對應的偵測標
準，偵測可能的網路攻擊。當偵測到不法攻擊時，系統會自動攔截不正確的訊息，修正為正確的路由
訊息，再導入路由通訊協定模組。如此，路由通訊協定就能產生正確的路由表，以保障路由正常運作。 
在偵測攻擊時，入侵偵測系統可能需要從其他節點取得額外的及時路由資訊，以運用偵測標準判
定當時所監看到的路由資訊是否正確；本計畫所設計之入侵偵測機制即採用合作式(cooperative)：利用
1 hop 與 2 hop 鄰近之節點間交換訊息，來驗證路由資訊是否為正常或遭受偽造。因為攻擊者常利用節
點無法直接得到(即訊號範圍以外)的路由資訊，如兩個節點(2 hops)距離以外所傳送的路由訊息，以此
攻擊者可假造與遠端節點相關的路由資訊來進行網路攻擊。所以分散式入侵偵測系統必須採用合作式
資訊交換通訊協定，以取得足夠之路由資訊來偵測網路攻擊。 
4.1.4. 規範型入侵偵測模型 
由於目前有線網路上常用之特徵比對型與異常偵測型入侵偵測技術不適用於隨意網路(詳見 1.3 小
節與表 2)，本計畫將參考美國加州大學戴維斯計算機安全實驗室所提出的規範型入侵偵測系統[20]之
作法：定義「正常」的網路運作模式，不在所定義的運作模式之內的，皆視為有問題的惡意封包。 
定義了正常的網路運作模式之後，規範型入侵偵測系統便可以在不影響網路的傳輸協定下，確保
偵測防護等工作可以正常地運行。即使是不同的網路系統與通訊協定，也能針對不同的環境特性來分
析正常的運作模式，加以定義出「正常的規範」以偵測含有惡意之連線與傳輸。於本研究中，採用 Finite 
State Machine 來分析傳輸協定的步驟與特性，定義出符合該傳輸協定的規範，運用於入侵偵測模型的
建立。因此，規範型入侵偵測系統能夠準確預防潛在網路攻擊，無論攻擊者如何基於網路弱點來改變
其網路攻擊特徵，規範型入侵偵測系統都能成功地偵測與預防，並且針對所偵測到的攻擊進行反應。 
 11 
表4 攻擊手法與分類[12] 
           分類 
攻擊手法 Insider / Outsider
Malicious /
Rational Active / Passive 
偽造資訊 Insider Rational Active 
竄改位置資訊 Insider Rational Active 
假冒合法使用者 Insider Malicious and Rational Active 
阻斷服務 Insider and 
Outsider Malicious Active 
身分揭露 Insider and 
Outsider Rational Passive 
 
 13 
則是明確地定義出路由協定中，重要的欄位參數值應該遵循的規範。目前本研究定義出 5 項規範來防
制 bogus information 的攻擊，日後可依據需求而繼續新增不同的規範以防制新發現的攻擊手法。 
表5 AODV 之規範 
編號 規範內容 
SP1 前一個節點屬於後一個節點的鄰居清單(neighbor list)；且後一個節點亦包含於前
一個節點的鄰居清單。 
SP2 RREQ packet 的 ID 需一致 
SP3 Sequence Number 需一致 
SP4 Hop count 逐漸增加 (累加 1) 
SP5 TTL (Time to Live)逐漸減少 (遞減 1) 
 
根據表 5 所定義的規範，我們提出了 PTF(Previous Two Forwards)演算法：比對前兩個節點所分別
傳送的封包，以檢查比對是否有遵循所定義的規範。此外，我們設計了符合 AODV 傳輸協定之規範式
入侵偵測模組(Specification -based IDM，SIDM)，SIDM 檢查比對 RREQ 與 RREP 封包的流程分別詳見
圖 2 與圖 3，當節點收到封包後，將去檢查封包內容是否遵守所定義的規範，當封包內容違反規範時，
SIDM 便發出警訊(alerm)告知接收節點。 
Received RREQ
alarm = False
Discard msg
have seen || ttl = 0
node X = dest
Relay RREQ Init RREP
No
No
Yes
No Yes
SIDM
if ( SP1 violation ||
SP2 violation ||
SP3 violation ||
SP4 violation ||
SP5 violation )
HC++ Yes Listen 
node X
 
圖2 AODV 加上 SIDM 處理 RREQ 封包之流程圖 
 15 
各項參數 參數值 
Antenna Height (m) 1.5 
表7 行動隨意網路模擬參數設定 
各項參數 內容 
模擬時間 1000 秒 
地圖大小 600 m * 600 m 
節點數 100 
傳輸範圍 250m 
移動模型 (Mobility model) Random Waypoint 
節點暫停時間 2 秒 
節點移動速度 0-20 m/s 
封包傳輸類別 Constant Bit Rate 
封包大小 512 bytes 
封包傳輸率 4 pkts/s 
5.2.2. 實驗場景 
在本研究計畫中，我們採用三項評估項目來測試所提出 SIDM 的可行性。 
平均封包送達率(Average Packet Delivery Ratio) 
指得是封包接收量與封包傳送量的比率。 
平均路由位元量(Average Routing Byte Overhead) 
路由的封包(訊息)位元量與所有封包(訊息)位元量的比值。 
平均路由延遲(Average Routing Delay) 
從起始節點產生 RREQ 封包，到起始節點收到目的節點的 RREP 封包的所需平均時間。其中包含
了封包超過了 TTL 而重傳 RREQ 的等待時間。 
除了可行性的測試評估外，亦針對 bogus information 的攻擊，進行安全性的防護測試。從 100 個
節點中，隨機選出 10%、20%及 33%等不同比例的節點數，擔任惡意節點的角色，其中惡意節點會竄
改 Hop count 與 Sequence Number，進而欺騙其他節點，讓路由路徑經過惡意的節點。當路由路徑經過
惡意節點，該惡意節點便可以等待 data packet 傳送時，進行竊聽、竄改或丟棄等攻擊。 
5.2.3. 實驗結果 
可行性的實驗於每種速度進行 10 次實驗後取平均，實驗結果詳見圖 4 至圖 6。其中從圖 4 可得知，
我們所提出的方法PTF-AODV之封包送達率與原本的AODV差不多，而圖5可以看出，因為PTF-AODV
多傳了前一個節點的路由封包，且為了安全上的考量，有加入鄰居清單的運用，因此，平均路由位元
量較原本的 AODV 較多；而計算上要比對兩個封包的欄位值，平均路由延遲也較長，比較結果詳見圖
6。 
 
 17 
 
圖6 路由延遲比較圖(MANET) 
圖 7 至圖 9 分別表示惡意節點在所有的節點(100 個模擬節點)中佔了 10%、20%及 33%(即 10 個、
20 個、33 個惡意節點)情況下的平均封包送達率比較。其中藍色曲線表示原本的 AODV 路由協定於無
惡意節點的環境下，不同移動速度所得到的平均封包送達率；而紅色與綠色分別表示有採用 SIDM 與
未採用 SIDM 的 AODV 遭受惡意節點的攻擊結果。從模擬結果圖可以看出，未採用 SIDM 的 AODV
遭受惡意節點的攻擊下，平均封包送達率有顯著的下降，而有採用 SIDM 的 AODV 即使遭受到惡意節
點的攻擊，仍然可以保持不錯的封包送達率。 
於 PTF 演算法中，中繼節點不只傳送原本 AODV 路由所需要的封包，亦傳送了前一個傳送節點所
送來的封包，因此傳送的路由訊息量較多。此外，PTF 演算法，需要比對前兩個節點所傳送的封包內
的欄位值是否有遵循表 5 所定義的 AODV 規範，造成平均路由延遲較長。雖然付出了訊息量較大與傳
輸時間較長的代價，但可以達到安全性的防護。 
 
圖7 惡意節點佔總節點數 10%的 PDR 情形(MANET) 
 
 19 
各項參數 內容 
紅燈暫停時間 10 秒 
節點移動(最高)速度 5, 10, 15, 20, 25 m/s 
封包傳輸類別 Constant Bit Rate 
封包大小 512 bytes 
封包傳輸率 4 pkts/s 
5.3.2. 實驗場景 
與 5.2 小節一樣，採用封包送達率、路由位元量及路由延遲等三項評估項目來測試所提出 SIDM 於
車載環境的可行性。 
5.3.3. 實驗結果 
圖 10 至圖 12 可看出，我們所提出的方法與原始 AODV 的封包送達率差不多，而路由位元量較大
且路由延遲時間較長，原因與 5.2.3 小節所分析結論相同；我們的方法採用了 PTF 演算法，為了安全性
的防護而付出了傳輸量較大與計算時間較長的代價。 
 
圖10 平均封包送達率比較圖(VANET) 
 
圖11 平均路由位元量比較圖(VANET) 
 21 
6. 結論 
行動隨意網路與一般有線網路有別，不具有基礎設施與集中式管理的架構，且路由與封包的傳送
都基於節點互相信任的前提下，才能使行動隨意網路正常運作。因此行動隨意網路在安全性上具有弱
點，易遭攻擊者所利用。 
本計劃針對目前隨意網路中，具有代表性的 AODV 路由協定，定義出適合的入侵偵測規範，並將
規範式入侵偵測概念運用於行動隨意網路，達到路由資訊的安全性防護。針對 AODV 路由協定的特性，
我們亦提出了 PTF 演算法來驗證比較節點間傳送封包的完整性。此外，設計出來的規範式入侵偵測模
組，透過實驗模擬證明，亦可以運用於車載網路環境下。 
本研究計畫的成果，證明規範式入侵偵測系統適合運用於隨意網路的環境，透過驗證封包的完整
性，可判斷路由封包是否遭受竄改，進而防制惡意節點的攻擊。 
 
 23 
[18]C. Y. Tseng, P. Balasubramanyam, C. Ko, R. Limprasittiporn, J. Rowe, and K. Levitt, “A 
Specification-Based Intrusion Detection System For AODV,” In Proceedings of the ACM Workshop on 
Security in Ad Hoc and Sensor Networks (SASN’03), Oct. 2003. 
[19]C. Y. Tseng, T. Song, P. Balasubramanyam, C. Ko and K. Levitt, “A Specification-based Intrusion 
Detection Model for OLSR,” Proceeding of the 8th International Symposium, Recent Advances in 
Intrusion Detection (RAID), Seattle, WA, Sep. 7-9, 2005. 
[20]C. Y. Tseng, S. H. Wang, C. Ko, and K. Levitt, “DEMEM: Distributed Evidence-driven Message 
Exchange intrusion detection Model for MANET,” Proceeding of the 9th International Symposium, 
Recent Advances in Intrusion Detection (RAID), Hamburg, Germany, Sep. 20-22, 2006.  
[21]C. Lochert, M. Mauve, H. Fera, and H. Hartenstein, “Geographic routing in city scenarios,” 
ACMSIGMOBILE Mobile Computing and Communications, vol. 9, no. 1, pp.69-72, 2005. 
[22]K. Sanzgiri, B. Dahill, B. N. Levine, C. Shields and El. M. Belding-Royer, “A Secure Routing Protocol 
for Ad Hoc Networks,” In Proceedings of IEEE ICNP, 2002. 
[23]V. Naumov and T. Gross, “Connectivity-Aware Routing (CAR) in Vehicular Ad Hoc Networks,” IEEE 
International Conference on Computer Communications (INFOCOM), pp.1919-1927, May 2007. 
[24]Y. S. Chen, Y. W. Lin and C. Y. Pan, “A Diagonal-Intersection-Based Routing Protocol for Urban 
Vehicular Ad Hoc Networks,” Telecommunication System, 2009. 
[25]T. Taleb, E. Sakhaee, A. Jamalipour, K. Hashimoto, N. Kato and Y. Nemoto, “A Stable Routing Protocol 
to Support ITS Services in VANET Networks,” IEEE Transactions on Vehicular Technology, vol. 56, no. 
6, pp. 337-347, 2007. 
[26]W. Sun, H. Yamaguchi, K. Yukimasa, and S. Kusumoto, “GVGrid: A QoS Routing Protocol for Vehicular 
Ad Hoc Networks,” IEEE International Workshop on Quality of Service (IWQoS), pp. 130-139, June 
2006. 
[27]M. G. Zapata and N. Asokan, “Securing Ad hoc Routing Protocols,” In Proceedings of the 2002 ACM 
Workshop on Wireless Security (WiSe 2002), pp.1-10, Sep. 2002. 
[28]S. Yi, P. Naldurg and R. Kravets, “Security-aware Routing Protocol for Wireless Ad Hoc Networks,” In 
Proceedings of ACM MobiHoc 2001, Oct. 2001. 
[29]B. Awerbuch, D. Holmer, C. Nita-rotaru and H. Rubens, “An on-demand secure routing protocol resilient 
to byzantine failures,” In ACM Workshop on Wireless Security (WiSe), Atlanta, Georgia, 2002.  
[30]A. Perrig, R. Canetti, J. D. Tygar and D. Song, “The TESLA Broadcast Authentication Protocol,” In 
Cryptobytes (RSA Laboratories, Summer/Fall 2002), 5(2):2-13, 2002. 
[31]L. Zhou and Z. J. Haas, “Securing ad hoc networks,” IEEE Network Mag., vol. 13, no. 6, 1999. 
[32]A. Khalili, J. Katz, and W. A. Arbaugh, “Towards secure key distribution in truly ad-hoc networks,” in 
Proceeding, IEEE Workshop Security Assurance Ad Hoc Network, 2003. 
[33]J. Biswas, and S.K. Nandy, “Efficient Key Management and Distribution for MANET,” IEEE 
International Conference on Communications (ICC '06), 2006. 
[34]P. Sasikumar, C. Vivek, and P. Jayakrishnan, “Key-Management Systems in Vehicular Ad-Hoc 
Networks,” International Journal of Computer Applications, Vol. 10, No. 1, November 2010. 
[35]M. Guerrero Zapata and N. Asokan, “Securing Ad hoc Routing Protocols,” Proc. 1st ACM Wksp. 
Wireless Sec., pp. 1–10, Sept. 2002. 
[36]D. Cerri, A. Ghioni and C. P. di Milano, “Securing AODV: the A-SAODV secure routing prototype,” 
 25 
8. 附件 
8.1. 附件 1 國科會補助專題研究計畫成果報告自評表 
8.2. 附件 2 已發表論文-植基於 AODV 繞徑協定之車載隨意網路弱點分析 
 附件 2-1 
附件2 已發表論文-植基於 AODV 繞徑協定之車載隨意網路弱點分析 (資訊安全通訊) 
植基於AODV繞徑協定之車載隨意網路弱點分析 
林孝青1、曾俊元2、張威威3、莊東穎4、林輝堂5  
1,5成功大學電機與通信工程研究所 
2,3,4台北大學資訊工程研究所 
1gookey22@gmail.com 
2tsengcyt@gm.ntpu.edu.tw 
3miya@mail.ntpu.edu.tw 
4juang@gm.ntpu.edu.tw 
5htlin@mail.ncku.edu.tw 
 
摘要 
車載隨意網路(VANETs)是基於無線網路技術所延伸發展的特殊網路，本身具有無線網路設備，因
此車輛在行駛時，無需透過無線基地台，便可以動態地與鄰車建立連線；此種特性與無線隨意網路
(MANETs)相符，因此VANETs的路由方式可與MANETs相互結合發展，然而目前VANETs的通訊協定
尚未完全發展成熟，相較之下MANETs的通訊協定已發展一段時間，較為完善，並且已有專家學者致
力於改良AODV通訊協定以運用於VANETs上，因此本論文藉由AODV運行於VANETs環境下進行安全
性探討。本論文針對AODV通訊協定進行安全性之弱點分析，研究路由封包欄位可能遭受的威脅，利
用分析所得之弱點資訊，將四種路由封包可能遭受的威脅分為轉發、自行發送及不轉發三種。最後在
VANETs環境下，分析模擬黑洞攻擊及自私節點攻擊，藉實驗分析證實我們的論點無誤，並得知上述
攻擊對於VANETs的影響情形。 
關鍵詞：車載隨意網路、無線隨意網路、AODV、安全性、黑洞攻擊、自私節點攻擊 
 
 
壹、前言 
行動隨意網路(Mobile Ad Hoc Networks，MANETs)是由一群能夠自由移動的行動裝置組合而成，
無需透過固定的網路設備來傳遞訊息；利用各個行動通訊節點(mobile nodes)之間的聯繫，得以相互傳
遞資訊。而MANETs的組成，至少需要兩個以上的行動無線通訊節點建構，進而組成無基地台式的網
路環境(Infrastructureless)。 
車載隨意網路(Vehicular Ad-hoc Networks，VANETs)可視為MANETs的延伸運用，其特色與
MANETs大致相同，但仍存在速度與方向性等相異點。如：VANETs的行動節點為車輛，需遵守道路的
行進方向；而MANETs的行動節點並無方向性限制，運用上更為靈活。因此在一般情況下，MANETs
的通訊協定也可應用於VANETs上。 
VANETs 應用範疇包含了行車安全服務，例如前方交通事故通知，若事故發生時，能夠立刻發送
 附件 2-3 
警告等顯示資訊，這些資訊都是要讓所有道路使用者知道的，因此沒有機密性可言。 
(e)隱私性(Privacy) 
在車輛的通訊能力上，可能會揭露一些關於駕駛者的個人資訊，例如識別ID、速度、位置、移
動方向等隱私，雖然VANETs各項應用皆具備訊息認證及安全訊息的不可否認性的需要，但是
使用者的隱私也應該要作適當的保護。 
(f)以IEEE802.11無線網路技術為基準(IEEE 802.11-based wireless technology) 
VANETs的通訊標準802.11p是依據IEEE802.11的標準來做修改的。 
(g)較低的電源及處理限制(Less power and processing constraints) 
相較於行動電話(mobile phone)和感測節點(sensor node)，車輛具有更強大的能力處理電力及記
憶容量等問題，因此對於車輛而言，電源並非主要問題。 
(h)時間同步問題(Clock synchronization) 
假設未來車載通訊系統中，每一部車輛皆具備GPS系統，節點(車輛)本身具備了絕對的時間資
訊，因此節點之間時間同步是非必需性的。 
(i)存在強制執行法的機制(Existing law enforcement mechanisms) 
存在的強制執行法能夠幫助VANETs的安全，如果攻擊者能夠很明確的被識別，其法律程序有
助於處罰攻擊者及有效抑制犯罪的作用。 
2.2 VANETs的安全威脅與攻擊分類 
目前VANETs可能會遭受的威脅大致上可分為三種：第一種是針對VANETs安全應用攻擊，此種威
脅可能引發災難與生命威脅的攻擊，與使用者人身安全有關。第二種是針對付費服務應用攻擊，此種
威脅可能導致交易的欺騙、駕駛者及乘客等機密資訊被竊取。第三種是針對隱私權攻擊，此種威脅可
能洩漏行車動向、駕駛人與乘客等使用者所隱藏的資料。針對上述的三項威脅，可依照攻擊方法的特
性進行分類，M. Raya等人[14,15,16]提出攻擊分類準則如下： 
(a)Insider / Outsider 
可分為內部(Insider)成員及外部(Outsider)成員：內部成員被認證為網路的合法成員，被允許與
網路間成員通訊，且擁有合法的public key；外部成員則被視為外部入侵者。 
(b)Malicious / Rational 
分為惡意(Malicious)攻擊和理性(Rational)攻擊：惡意攻擊的主要是傷害網路的成員或攻能，並
非尋求個人利益；理性攻擊的行為是為了尋求特定利益，因此攻擊目標較有限且有目標性。 
(c)Active / Passive 
分為主動(Active)攻擊與被動(Passive)攻擊：主動攻擊行為會產生實際的封包與訊號；被動攻擊
則指通訊過程中進行封包竊聽。 
由於VANETs環境下沒有集中式管理的角色，因此訊息在節點間傳輸，便有機會受到惡意節點竄
改，可能遭受的攻擊如下： 
(a)偽造資訊(Bogus information) 
藉由錯誤訊息，來影響其他成員之行為，造成攻擊。 
(b)竄改位置資訊(Cheating with positioning information) 
捏造假的車輛速度、位置、車輛資訊，企圖造成欺騙。例如車禍發生，卻竄改資訊，顯示其不
在場。 
(c)假冒合法使用者(Masquerade) 
攻擊者利用偽造的身分資料來偽裝成合法的使用者。 
(d)阻斷服務(Denial of Service) 
 附件 2-5 
表二: AODV路由表之欄位 
Destination IP Address 
Destination Sequence Number 
Hop Count 
Next Hop 
Precursor List 
Expire Time 
以下以兩個小節來分析探討AODV繞徑協定與弱點：3.1小節說明路徑搜尋與維護，3.2小節進行弱
點分析。 
3.1 路徑搜尋與維護 
當來源節點想要傳資料給目的節點時，若是來源節點的路由表中，沒有通往目的節點的路徑時，
或者是路徑已經過期了，來源節點就會廣播RREQ封包，中繼節點在收到RREQ時，會先判斷是否為自
己所廣播之RREQ，是的話則丟棄封包；若不是的話，會利用RREQ的ID和Originator IP Address為索引，
查詢是否有接收過相同的RREQ封包。若先前已收過相同的封包，則丟棄，若沒收過，則收下此RREQ
封包。中繼節點在收下RREQ封包後，會依照下列步驟找尋路徑： 
(1)確認自己的路由表中是否存在反向路徑(Reverse Route)的Entry： 
若沒有存在反向路徑的Entry，則建立；建立反向路徑的目的在於之後讓此中繼節點能回傳RREP
封包到來源節點。 
(2)檢查自己的路由表內對應此RREQ的內容： 
如果節點本身Entry內的Destination Sequence Number小於RREQ內的Originator Sequence 
Number，或者是兩者一樣大，但本身路由表內紀錄的Hop Count數字較大，則節點會用RREQ
內的訊息取代Entry內的資訊。 
(3)確認自己是否有到目的節點的路徑： 
若此中繼節點具有可達目的節點之路徑，且RREQ封包尚未到達目的節點，則此中繼節點可以
代替目的節點回傳RREP給來源節點。若中繼節點沒有到達目的節點的路徑，則會紀錄反向路
徑，並將此RREQ繼續轉發下去，直到有任一中繼節點知道到目的節點的路徑，或目的節點收
到RREQ為止。目的節點收到許多RREQ後，會從眾多路徑選擇一條最短路徑，並以Unicast方
式回覆RREP封包至來源節點，路徑便建立完成了。 
 附件 2-7 
 
圖三：RERR message 
如圖三所示，節點b與節點c原為鄰居節點，而在節點c移動過後，節點b便離開了節點c的涵蓋範圍，
因此，節點b會判斷無法與節點c連線。節點b先將節點c從鄰居清單移除，再查詢路由表中是否存在Next 
Hop為c的Precursor List，若有存在，節點b會發送RERR的給Precursor List的節點S，其中RERR的
Unreachable Destination IP Address包含了節點c和節點D。節點b在收到節點c傳來的RERR，則會開始查
詢路由表是否有節點c與節點D為Destination IP Address、且Next Hop為節點b的Entry，如果有的話，則
刪除Entry，並將RERR轉發給上游節點，各中繼節點依此步驟轉發RERR，直到傳至節點S後才結束路
徑維護。 
3.2 弱點分析 
根據上一小節繞徑協定，可得知在AODV建立及維護路徑時，訊息傳遞資訊主要倚賴RREQ、
RREP、RERR、Hello等訊息。本節依照上述四類封包的特性，進行弱點分析，如表三。 
表三：封包類型與弱點分析 
封包類型 弱點分析 
RREQ 1.節點使用Broadcast方式傳送RREQ給各個節點；Broadcast送出時，不會確認接收
者是否有接收到，所以惡意節點在接收到RREQ後若不轉發，發送者並無法得知。
2.轉送時，惡意節點可以丟棄或竄改資訊。 
3.接收節點利用RREQ ID與Originator IP Address辦別此封包是否已接收過；惡意節
點可以竄改RREQ ID後再轉發，讓其他接收節點收到時認為此惡意RREQ為另一
不同的RREQ。 
4.Originator Sequence Number在訊息封包傳遞中，為維護節點資訊的新舊而存在：
Sequence Number越大，表示資訊程度越新，優先權也越高；惡意節點可以將
Sequence Number竄改為一極大值，使得其他接收節點認為此惡意RREQ資訊程度
新而優先考量，並移除舊的正常RREQ。 
5.Hop Count記載來源端到目前節點的中繼節點數，Hop Count越小表示所需中繼節
點越少，優先權大於Hop Count較大者；惡意節點轉發時竄改Hop Count為1，使
 附件 2-9 
表四：訊息欄位對RREQ、RREP、RERR的影響 
 ID 
Sequence 
Number 
Hop Count TTL 
RREQ √ √ √ √ 
RREP × √ √ × 
RERR × √ × × 
 
以下將分別討論四項訊息欄位對於三種封包之影響情形。 
4.1.1 ID 
在建立路徑的時候，行動節點會收到許多的RREQ封包，為了避免重複收下相同封包而造成耗費頻
寬、資源浪費…等，行動節點會利用RREQ ID和Originator IP Address做為索引，來分辨是否有收過此
RREQ，若惡意節點可以竄改RREQ ID，讓此RREQ看起來像是另外一個新的RREQ，使得節點重複接
收，造成浪費資源。 
4.1.2 Sequence Number 
Sequence Number越大代表資訊程度越新，兩個節點在相同條件之下，若其中一者的Sequence 
Number較大，則會被選為中繼節點。換句話說，當攻擊者將本身的Sequence Number設定成為較大數值
時，來源節點會選擇攻擊者為中繼節點，而在繞徑過程當中必會經過惡意節點，達到攻擊者的目的。
在AODV當中，攻擊者竄改Sequence Number之後，造成的影響如下： 
(a) Attack to Sequence Number of RREQ 
在AODV建立路徑的過程中，RREQ訊息封包是以廣播(broadcast)的方式傳送給各個節點，因
此，當惡意節點RREQ的Originator Sequence Number竄改後，也會被廣播出去，造成其他行動
節點接收到錯誤的RREQ訊息，甚至也轉發廣播出去，而影響到正常的繞徑建立。 
(b) Attack to Sequence Number of RREP 
中繼節點在收到RREQ後，若已知目的節點路徑之相關資訊時，會以Unicast的方式回覆RREP
給廣播該RREQ的節點。此時，若惡意節點竄改Destination Sequence Number後，也回傳RREP
給相同的節點，則在與中繼節點相同條件下，惡意節點則會被來源節點選為繞徑上的中繼節
點。此外，RREP是以Unicast的方式回傳，因此竄改後影響的範圍與RREQ相較之下較小。 
(c) Attack to Sequence Number of RERR 
在路徑維護當中，每個節點都會定期發送Hello訊息，若在一定時間內沒有收到鄰居節點的Hello
訊息，表示鄰居節點已不在傳輸範圍之內。此時行動節點會廣播RERR訊息，告訴其他節點此
失效路徑。假設惡意節點可以到達目的節點，而惡意節點竄改Sequence Number後，並廣播RERR
訊息表示惡意節點到目的節點的路徑已失效，便會造成所有要透過惡意節點到達目的節點的所
有節點，必須選擇其他花費較多時間的路徑。 
4.1.3 Hop Count 
數字越小代表到達目的節點所需的中繼節點越少，兩個節點在相同條件之下，若其中一者的Hop 
Count較小，則會被選為中繼節點，也就是說當攻擊者將本身的Hop Count設定為1，來源節點會選擇攻
擊者為中繼節點，而達到在繞徑過程當中必須經過攻擊者的目的。若惡意節點將自己的Hop Count設為
1，使得來源節點誤以為經過惡意節點之後，就可以到達目的節點，因此在路徑選擇上，便會挑選惡意
節點做為繞徑時的中繼節點。在AODV當中，RREQ與RREP兩種封包都會選擇較短的傳輸路徑，因此
 附件 2-11 
惡意節點以Broadcast方式自行發送假的RREQ，並且將此RREQ訊息封包的Originator IP Address
和Originator Sequence Number設定為別的行動節點，假裝是收到來自於某行動節點的RREQ訊
息並轉發，將此假冒的RREQ廣播傳送出去，其餘節點收到該RREQ後，而回傳RREP給被假冒
的節點(受害節點)，造成受害節點接收到不需要的封包訊息，消耗資源與頻寬。 
(b)Active Sending Attack of RREP 
惡意節點可以自行發送假的RREP訊息給鄰居節點，使得鄰居節點相信且更新來自於惡意節點
的RREP，並再轉發回傳給其他節點，讓路徑建立時發生錯誤。 
(c)Active Sending Attack of RERR 
RERR封包訊息主要是將失效的路徑發送出去，讓收到訊息的行動節點刪除此路徑Entry。針對
此特性，惡意節點可發送假RERR訊息，告訴鄰居節點經過某節點的路徑失效，讓受害節點無
法加入繞徑，造成孤立情形。 
(d)Active Sending Attack of Hello 
前述的三種自行發送攻擊指的是來源節點即為惡意節點，而主動發送封包進行攻擊。但Hello 
Message的自行發送攻擊指的是「不發送訊息」(即與原本主動發送Hello Message相反)。Hello 
Message原本為各行動節點主動發送，若不定期發送，便可使得鄰居節點不知道本身的存在，
進而將自己隱藏起來形成自私節點。 
4.2.3不轉發攻擊 
(a)Non-forwarding Attack of RREQ 
當節點收到RREQ後，會再利用Broadcast方式將此RREQ轉發給其他節點。因此，惡意節點可
採取不轉發攻擊，使得RREQ轉發出去的範圍縮減。但即使惡意節點不協助轉發RREQ，其他
鄰近的正常節點亦會協助轉發，因此不轉發RREQ造成的傷害較為輕微。若周圍的正常節點數
較多，更可以忽略單一惡意節點的不轉發攻擊所造成的影響。 
(b)Non-forwarding Attack of RREP 
當節點收到RREP的時，會利用Unicast回傳給發送RREQ的上個節點。若惡意節點此時將RREP
丟棄不回傳，則會造成該條路徑的失敗，造成阻斷攻擊，損害程度較丟棄RREQ和RERR嚴重
許多。 
(c)Non-forwarding Attack of RERR 
RERR訊息封包的功用在於通知網路上的節點某路徑已損毀，無法到達目的節點。由於RERE
是採用Broadcast方式傳送，若惡意節點不協助轉發RERR訊息，周圍其他的正常節點也會協助
轉發，因此不會造成太大的影響。此外，在AODV的機制中，RERR訊息廣播出去後，並沒有
要求收到節點的需要回應ACK訊息[6]，因此RERR訊息採用UDP方式進行廣播，在沒有被轉發
的情況，也可以被視為正常。 
伍、攻擊實現及分析 
  本篇論文針對於具有 Insider、Rational 及 Active 等特性之攻擊進行實現與分析，主要有黑洞攻擊
(Black hole)、中間人攻擊(Man in the middle attack)、氾濫式攻擊(Flooding attack)、蟲洞攻擊(Worm hole)
等攻擊[1,2,11,21,22,23]。其中黑洞攻擊是威脅性和危害性最大的攻擊之一，因為黑洞攻擊可以不必入
 附件 2-13 
 
圖四：實驗模擬流程圖 
 
表七：RREQ訊息正常傳送行動節點資訊 
node ID SN HC TTL 
1 437 1642 1 19 
2 437 1642 2 18 
3 437 1642 3 17 
4 437 1642 4 16 
5 437 1642 5 15 
6 437 1642 6 14 
7 437 1642 7 13 
8 437 1642 8 12 
9 437 1642 9 11 
10 437 1642 10 10 
11 437 1642 11 9 
12 437 1642 12 8 
13 437 1642 13 7 
14 437 1642 14 6 
15 437 1642 15 5 
… 437 1642 … … 
 附件 2-15 
 
圖五：黑洞攻擊模擬圖 
 
表九：黑洞攻擊路徑節點資訊 
node ID SN HC TTL 
1 437 1642 1 19 
2 437 1642 2 18 
3 437 1642 3 17 
4 437 1642 4 16 
5 437 1642 5 15 
6 437 1642 6 14 
7 437 1642 7 13 
8 (Malicious) 2000 999999 1 19 
9 437 1642 9 11 
9 2000 999999 2 18 
10 2000 999999 3 17 
11 2000 999999 4 16 
12 2000 999999 5 15 
13 2000 999999 6 14 
14 2000 999999 7 13 
15 2000 999999 8 12 
 
5.3自私節點攻擊 
在 MANETs 環境下，除繞徑選擇外，節點的硬體資源、頻寬與電力問題皆相當重要，針對有限資
源情況，便衍生了自私節點(selfish node)的攻擊。自私節點為了保留行動裝置的資源、縮減記憶體佔用
 附件 2-17 
node SN HC TTL 
8(Malicious) 759 8 12 
9 759 9 11 
10 759 10 10 
11 759 11 9 
12 759 12 8 
13 759 13 7 
14 759 14 6 
15 759 15 5 
 
陸、結論 
本研究說明了 VANETs 環境下的威脅，與可能遭受的攻擊方法；並針對 AODV 通訊協定中所用到
的四種封包之重要資訊欄位進行弱點分析，亦將發送攻擊分成三類進行說明；最後於 VANETs 環境上
運行 AODV 通訊協定，進行黑洞攻擊與自私節點攻擊兩種手法，驗證先前所探討的弱點分析是正確的。 
預期日後將會有更適合運行於 VANETs 環境的通訊協定，亦會有更安全的防護機制或方法來抵禦
更多元化的惡意攻擊。而本論文所用來分析協定中重要的資訊欄位之探討方法，可運用於其他被動式
路由協定，或延伸運用於分析其他 MANETs 或 VANETs 的通訊協定，以更清楚暸解弱點所在，進而提
高安全性。 
 
[誌謝] 
本論文是國科會研究計劃「入侵偵測與預防於行動與車載網路之研究」 ( 計劃編號 NSC 
99-2221-E-006-107-MY3)的部分研究成果，感謝國科會的贊助。 
 
 
參考文獻 
 
[1]Bala, M. Bansal, J. Singh, “Performance Analysis of MANET under Blackhole Attack,” Proceedings of the 
2009 First International Conference on Networks & Communications-Netcom, pp.141-145, 2009. 
[2]N. Bhalaji and A. Shanmugam, “Association between nodes to Combat Blackhole attack in DSR based 
MANET,” In Proceedings of Sixth IEEE-IFIP International Conference on WOCN, Egypt, 2009. 
[3]Y. S. Chen, Y. W. Lin and C. Y. Pan, “A Diagonal-Intersection-Based Routing Protocol for Urban Vehicular 
Ad Hoc Networks,” Telecommunication System, 2009. 
[4]E. Fonseca and A. Festag, “A Survey of Existing Approaches for Secure Ad Hoc Routing and Their 
Applicability to VANETS,” NEC Technical Report NLE-PR-2006-19, Mar. 2006. 
[5]Y. C. Hu, A. Perrig and D. B. Johnson, “Ariadne: A Secure On-Demand Routing Protocol for Ad hoc 
Networks,” in Proceedings of the Eighth Annual International Conference on Mobile Computing and 
 附件 2-19 
and Communications Review, Volume 6, Number 3, Jul. 2002. 
[23]J. Zhao and G. Cao, “VADD: Vehicle-Assisted Data Delivery in Vehicular Ad Hoc Networks,” in 
Proceedings of the 25th Conference on Computer Communications (IEEE INFOCOM 2006), Barcelona, 
Spain, Apr. 2006.  
 
 
 
 
Cloud Services  
Reijo M. Savola  
 
3. Software Vulnerability Discovery Model for Prediction  
Fang Song, Li-Na Bo, Ji-Zhou Sun, Ya-Ping Zhang  
 
4. A Malware Detection System Using Data Mining Techniques  
Usukhbayar.B, Uitumen.J, Nyamjav.J  
 
5. Speaker Identification  
Dalaijargal Purevsuren, Nyamjav Jambaljav 
 
 7 月 10 日: 
大會第二天一早，會議主要由國內各知名大學學者發表其在資安領域
所專研之研究成果，使得讓本人對於目前資安研究趨勢更掌握了方向。其
會議主要內容如下 
1. An Improved System for Authenticating Remote Users in Multi-Server 
Architecture  
Cheng-Chi Lee, Iuon-Chang Lin  
2. 7. A Proposal on ARP Spoofing Protection Schema Jin-Cherng Lin, Men-Jue Koo, 
Cheng-Sheng Wang  
3. Two-Stage Template Matching Method for Object Detection  
Chao-Feng Tseng, Jia-Wei Luo, Yen-Tai Lai  
4. The Analysis and Identification of P2P Botnet's Traffic Flows Wernhuar Tarng, 
Li-Zhong Den, Kuo-Liang Ou, Kun-Ming Yu  
5. A Fast Learning Vector Quantization Algorithm for Ophthalmological MRI 
Segmentation  
Wen-Liang Hung  
6. Design of a computational model for health management Wen-Fong Wang, 
Sheng-Jia Shih, Ching-Sung Lu 
 
下午則是輪到本人進行 Oral presentation，在報告後，有許多學者向我請問
一些研究上的問題，使我獲益良多。此 session 上還有其他知名的學者也被
邀請前來發表 paper。其中，最讓我印象深刻的有 
 
7. Efficient Polynomial-Time Algorithms for Variants of the Multiple Constrained 
LCS Problem Hsing-Yen Ann, Chang-Biau Yang, Chiou-Ting Tseng  
8. Frequent Itemset Prediction Approach to Distributed Mining of Maximal 
 
 
Behavioral Analysis of An HTTP Botnet in An 
Experimental Testbed 
 
 Hui-Tang Lin1,2, Ying-You Lin1, Wen-Chun Chang1, Jyun-Hao Li1, Chu-Sing Yang1,2 
1Institute of Computer and Communication Engineering, National Cheng Kung University, Taiwan (R.O.C.) 
2 Department of Electrical Engineering, National Cheng Kung University, Taiwan (R.O.C.) 
E-mails: 1{htlin, q3897107, q36981076 }@mail.ncku.edu.tw; 
 
Abstract–As network attacks are becoming more frequent, 
Botnet network attacks have become foremost among 
information security concerns. Since the Botnet anti-detection 
functions have become mature, the virtual machine environment 
platforms generally used to analyze the virus’ behavior have 
become ineffective. To monitor malicious software behaviors, an 
experimental platform needs to analyze these behaviors and 
collect data from both host and network sides. Accordingly, this 
study develops a test environment for analyzing the botnet 
behavior using the Testbed@TWISC platform. In the developed 
environment, BlackSun Botnet is used as a HTTP botnet case 
study to observe the source code, host and network-side traffic 
behaviors of the malicious software. Through extensive test 
results, the data communications between a Botmaster and bots 
can be collected, which benefits developing botnet detection 
mechanisms.                      
 
Keywords–Botnet; network security; Botnet; TWISC, Testbed; 
 
I. INTRODUCTION 
The rapid development of internet applications in recent 
years has produced multiple convenient network services, such 
as online transaction, internet bank and shopping online. 
Meanwhile, the rise of various blogs and social networking 
sites has served to strengthen interpersonal relationships. 
Besides traditional network attack methods, hackers also 
launch new types of network attacks against newly-emerging 
network applications. 
Botnets [8]  are presently the largest type of the network 
attacks, according to the statistics by Symantec [6] . In 2011, 
Taiwanese networks infected with Botnets ranked third in the 
world. Thus, attacks by Botnets have become a major security 
concern. Since Bots possess anti-detection functions such as 
encryption and obfuscation, a lifelike experiment environment 
is needed for further analysis on Botnets, so as to circumvent 
its anti-detection function. Meanwhile, the behaviors of the 
Botnet could be reproduced through the experiment 
environment for observation and analysis to determine the 
characteristics of the Botnet for the host and network-side 
defenses.           
This study considered HTTP Botnet – BlackSun [4]  as the 
main research target and used Testbed@TWISC as the 
experiment environment to reproduce the behaviors of Botnets 
in a controlled environment.     
The remainder of this paper is organized as follows. Section 
II introduces the experimental platform of Botnet (Botnet), 
HTTP Botnet-BlackSun and Testbed@TWISC [7] . Section III 
discusses the behavioral analysis based on the observational 
results of BlackSun on Testbed@TWISC platform. Section IV 
describes the results after the behavior reproduction of 
BlackSun. Section V gives conclusions and suggestions to 
future studies. 
 
 
II. RELATED WORKS 
A. Botnet 
A Botnet, also known as zombie network or robot network, 
is a new type of attack mode evolved from the traditional 
malicious software, such as virus, Trojan and worms. 
Equipped with high controllability, a Botnet allows attackers to 
manipulate infected hosts to launch attacks. A Bot is a program 
controlled by defined commands to execute preset functions 
automatically. A Botnet consists of many infected computers 
(Bots) and is controlled by a malicious entity (Botmaster) 
through communication protocols such as IRC, P2P and HTTP 
to launch attacks. The Botnets of these three transmission 
protocols are described as follows [10] , [13] :                
 IRC Botnet: IRC provides online chat functionality. 
IRC Botnet uses IRC protocols for communication. The 
Botmaster uses a IRC server as the Control and 
Command (C&C) server. When connected successfully 
with an IRC server, the Bot would join the chat channel 
pre-established by the Botmaster and wait for further 
commands. After executing the command, the Bot sends 
the results back to the chat channel of the IRC Server. 
Since the source code of IRC Bots can be acquired easily, 
hackers can create a new Bot through slight modification. 
Thus IRC Botnets are presently the most common in 
Botnet attacks.             
 P2P Botnet: P2P is the network protocol applying 
Peer-to-Peer. The network topology of P2P networks is 
random, thus there is no need to worry if a C&C server 
crashes. P2P uses a file sharing mechanism, where the 
Bot downloads specific command files with a pull 
command. Since P-2-P Botnet has no central server, the 
command cannot be transmitted to all the Bots at the 
same time. Thus, it may not be effective in launching a 
DDoS attack.            
 HTTP Botnet: since the IRC Botnet is common, the 
firewalls of many institutions block this protocol. 
Accordingly, many Botnets have switched to the HTTP 
network protocol and use pull commands to break 
through the firewall. This kind of Botnet uses a Web 
server as the C&C Server. Since most firewalls do not 
block the outgoing web packets, Bots can establish 
linkages with C&C Server and communicate with the 
Botmaster via sending web packets. 
 
Basically, HTTP Botnet attacks are divided into three phases 
[12] : active infection phase, joining Botnet phase and control  
Table 1 Comparisons of information security experimental platforms 
 Advantages Disadvantages Experimental platform model 
Traditional 
experimental platform 
Using of real machines High cost, with time and spatial limit, unable to store the 
experiment environment effectively, unable to manage effectively  
Mutual connection of real 
equipments 
Simulation Low cost Low reality due to simulation on software level Network Simulator Version 2 
Virtual Machine Avoiding computer damage and 
able to establish restore point 
Limited efficiency due to hardware simulation by software VMware Workstation 
Simulation High reality, without time or 
spatial limit 
High cost  Emulab(Testbed@TWISC), 
PlanetLab 
Real network 
environment 
Completely real Information security experiment would affect the normal network 
using 
Real network environment 
 
 
Fig. 3 Experiment environment of HTTP BlackSun Botnet on 
Testbed@TWISC, setting of network topology 
 
D. Testbed@TWISC 
Testbed@TWISC adopted Utah University’s Emulab 
Testbed technology and Emulab [3]  software. The Project 
integrated software and firmware with hardware developed in 
Taiwan to create an environment with emulation capability for 
conducting network security experiments. The testbed not only 
provides the required resources, isolation and convenience for 
conducting security experiments but also has the storability to 
allow rapidly repeating various security scenarios for 
conducting experiments. All the above operations can be easily 
conducted through a Web interface. At present, 
Testbed@TWISC established by National Cheng Kung 
University is the world third largest Emulab Testbed platform, 
which has 206 nodes available for use. 
 
III. ESTABLISHMENT OF HTTP BOT BLACKSUN ON THE 
TWISC EXPERIMENTAL PLATFORM 
A. Experimental environment 
This study used AppServ to integrate Apache, PHP, MySQL 
and phpMyAdmin. The relevant environment settings are as 
follows: 
 Web Server: Apache 
 Web Language: PHP4 
 Database: MySQL 
 Database administration: phpMyAdmin 
 Windows OS 
As shown in Fig. 3, five main computers, with roles of 
BotMaster, WEBCC, BOT1, BOT2 and Victim were created 
for this study. The BotMaster was used to spread malicious  
 
Fig. 4 HTTP BlackSun Botnet Process Configure Diagram 
 
software to infect the normal hosts. In Fig. 3, BOT1 and BOT2 
were the infected computers and The Botmaster issues remote 
commands to control these bots to attack the victim with 
DDoS. Table 2 shows the list of main experiment resources for 
Testbed@TWISC. 
 
B. Experimental process and behavioral analysis 
The Botmaster can utilize social engineering to induce the 
users to execute the simulated HTTP Botnet zombie virus 
through the user negligence. For the Windows system, the 
Windows Kernel API is used to provide low level services. 
API calling addresses provided by the Windows system were 
recorded in the System Service Dispatch Table (SSDT), and 
then the malicious software can obtain the address of system 
core functions and authorization elevation. As shown in Fig. 4, 
the malicious software obtained the address of system core 
functions from the infected hosts, elevated its operational 
authorization and called the AddSelfToRun function to copy 
the program to the file folder c:\WINDOWS\system32\. It 
establishes the executable file duplicate of the malicious 
software blacksun.exe and then writes the directory address of 
the malicious software executable file into the directory of 
registry keys 
 
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Window
s\CurrentVersion\Run.  
 
Thus, the infected hosts will automatically reload the 
zombie virus upon restart and ensure the execution of zombie  
 
Fig. 7. Bot attack traffic indication 
 
Fig. 1. Indication of attack traffic suffered by Victim 
 
(6) carry out DDoS attacks on the Victim host (see Fig. 7 
and 8). 
 
C. Application of HTTP Bot BlackSun on the TWISC 
experimental platform 
 
Testbed@TWISC provides the experimental environment 
for network attack and defense, validation system experiment 
and data analysis experiment. In this study, the attack 
experiment is treated as the principal for behavior reproduction 
of malicious software and observation of malicious behaviors 
to be as the teaching materials for information security attack 
and defense system and equipment test.    
For example, the following attack conditions (Fig. 9) was 
used for attack system testing. HTTP Botnet – BlackSun was 
used as the tool for DDoS attack against the Victim. The 
procedure was as follows: 
(1) Primary infection would generate a Bot binary file and 
upload it to FTP/HTTP Server. Infected hosts attempt to 
infect other hosts in all local area networks. 
(2) The command would be transmitted through the C&C 
Server to the Bots for preparation of DDoS attack. 
(3) After receiving the commands, the Bots would launch 
DDoS attack against Victim (Fig. 10). 
 
IV. CONCLUSIONS AND FUTURE WORKS 
According to the experimental results, the zombie virus 
was high risk, the following characteristics of which were 
summarized: 
 
Fig. 9 Conditions of attack system 
 
 
Fig. 2 Command package observation Conclusions and 
Future Works 
 
 From the study, the source codes of different zombie 
viruses had similar concealing characteristics;   
 It had rapid variation capacity and extensibility, which 
could be amplify to different attack behaviors from the 
source code;  
 Source codes of different zombie viruses might have the 
similar characteristics.  
However, package characteristics could not be observed 
from the network-side traffic, since it is interspersed with the 
normal HTTP traffic. Therefore, the malicious and normal 
traffic are difficult to analyze. 
Therefore, there are two avenues for future research. The 
first is the establishment of a complete attack and defense 
analysis system. At present, the attack system has been 
completed and the defense system is still experimental. 
Secondly, analysis and research on multiple defining 
characteristics would be continued. The single characteristics 
used presently proved difficult to detect Botnets, thus the 
modes of Botnets must be observed and analyzed from 
multiple dimensions.    
 
ACKNOWLEDGEMENT  
This research was supported by a grant from the National 
Science Council, Taiwan, Republic of China, under grants No. 
NSC 100-2219-E-006-001, 99RA21, and NSC 
99-2221-E-006-107-MY3, for which we are grateful. 
 
REFERENCES 
 
[1]  AppServ Network, http://www.appservnetwork.com/. 
[2]  CERT, “Denial of Service Attacks,” 
http://www.cert.org/tech_tips/denial_of_service.html. 
[3]  Emulab, http://www.emulab.net/. 
[4]  HACKFORUMS, http://www.hackforums.net/. 
[5]  Paul Barford, Vinod Yegneswaran. An Inside Look at Botnets. In 
Computer Sciences Department University of Wisconsin, Madison. 
[6]  Symantec, "Internet Security Threat Report, Volume 16", 
http://www.symantec.com/business/threatreport/index.jsp#. 
[7]  Testbed@TWISC - Network Simulation Testbed Home, 
http://testbed.ncku.edu.tw/index.php3. 
[8]  Wiki website, “Botnet,” http://en.wikipedia.org/wiki/Botnet. 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/26
國科會補助計畫
計畫名稱: 入侵偵測與預防於行動與車載網路之研究
計畫主持人: 林輝堂
計畫編號: 99-2221-E-006-107-MY3 學門領域: 資訊安全
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
除了部分成果已發表於資訊安全通訊期刊(Communication of CCISA, vol. 17, 
no.1, pp. 16-66, 2011.)外，亦有部分成果已撰寫成論文，投稿標的為 IEEE 
Transaction on Vehicular Technology 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
