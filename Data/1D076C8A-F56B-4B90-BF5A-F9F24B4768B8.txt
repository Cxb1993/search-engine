 -2-  
 
圖 1.1. 品質特性與結構參數值關係圖。黑色曲線理想值高但穩定度差。 
本計畫針對 DLS 缺點，應用田口直交表技術於光學設計，以達更有效率及體系之
穩建設計法。 
 
二、研究方法 
本計畫主旨為應用田法直交表技術，探索成像及非成像結構因子與系統品質
之關係，並達成穩建化之產品設計。計畫執行期兩年，第一年以田口直交表分析
技術的建立及鏡頭應用為主，包含：(A)構建直交表格及實驗數據分析程式(B)構建
以外部程式控制光學軟體之自動化程式(C)以田口法探索因子效應。 
田口設計的工具之一為直交表，每一緃行可於置一個結構參數或結構參數之
交互作用，數字代表該參數設計值(水準)編號；每一橫行代表一個實驗的參數設定
值組合。如圖2.1所示之L27(313)共有13個3水準直行及27種實驗組合。直交表的大小
由實驗參數個數及水準數而定。我們建構了各種直交表及實驗數據分析程式，直
交表包含 )2( 34L 、 )2( 78L 、 )3( 49L 、 )2( 1112L 、 )2( 1516L 、 )4(' 516L 、 )32( 7118 ×L 、 )5( 625L 、
)3( 1327L 、 )2( 3132L 、 )42(' 9132 ×L 、 )32( 121136 ×L 、 )32(' 13336 ×L 、 )52( 11150 ×L 、
)32( 25154 ×L 、 )2( 6364L 、 )4(' 2164L 、 )3( 4081L 等，如有進一歩需求，可再建立適當之
 -4-  
 
圖 2.3 應用 Excel 控制 Code V 光學軟體，傳回鏡頭像差，再圖列於右下方。 
 
 
圖2.4 應用Excel將計算所得數據做後續處理。 
 
光學系統於優化設計完成之後，可得到一組滿足工程師指定評價標準之最佳
區域解。接下來是公差分析的部份。光學系統之各零件參數(例如鏡片半徑、厚度、
折射率)在製造時都會偏離設計值，組裝時亦不能完全達設計規格，品質特性也因
此脫離理想設計值。光學工程師必需了解工廠在各種製造組裝上之技術能力，並
 -6-  
3.1. 第一次田口分析 
因子及水準值配置。先經由Code V的公差分析找出13個對成像品質(MTF)影響
較大的因子，定義鏡頭公差水準數為3水準[3.1] [3.2]，如表3.1所示。其中各類公差
定義為[3.3][3.4]： 
(1) DLF：面型公差，鏡面曲率半徑與標準原器間之干涉條紋數。 
(2) DLT：鏡片厚度公差，為兩個光學面間距誤差，可以是單一零件厚度或者兩零
件間距。 
(3) DLN：折射率公差鏡片材質不均勻度的折射率公差。  
(4) DSY：組裝上下偏移公差。 
(5) BTY：組合傾斜公差，表若干組合鏡面之共同傾斜度。 
表 3.1. 鏡頭公差及水準數 
 
先不考慮各公差因子間的交互作用，因 13 個公差因子之總自由度為 26，採用 L27
直交表分析。鏡頭公差因子在 L27 直交表配置如表 3.2 所示。 
 -8-  
視場回應表。如表3.6至表3.8所示。在表3.6軸上視場回應表上，最佳水準組合
為A2B3C2D1E2F2G2H3I2J2K3L1M2；表3.7之0.7視場回應表上，最佳水準組合為
A1B3C1D1E2F3G3H1I2J2K2L1M2；表3.8全視場回應表上，最佳水準組合
A1B2C1D2E2F3G2H1I2J2K1L1M2。 
表 3.6. 軸上視場回應表。 
 
表 3.7. 0.7 視場回應表。 
 
表 3.8. 全視場回應表。 
 
第一次各視場變異數分析。如表3.9至3.11所示。在表3.9變異數分析上，以B、
D、E、M公差因子的貢獻度遠比其他因子大；表3.10變異數分析上，以A、B、L、
M公差因子的貢獻度遠比其他因子大；表3.11變異數分析上，以A、B、L、M公差
因子的貢獻度遠比其他因子大。經由表3.9~11的變異數分析，對貢獻度大的因子結
予較緊的公差，使成像品質更好[3.2]。 
 -10-  
3.2第二次田口分析 
經由第一次各視場變異數分析，發現A、B、L、M因子對0.7視場及全視場的
貢獻度比其他的因子大，和軸上視場E因子的貢獻度比其他因子大，故以A，B，E，
L，M因子再加上I因子判斷交互作用。 
軸上視場的交互作用，如圖3.2~4所示。 
20.000
25.000
30.000
35.000
40.000
45.000
50.000
E1 E2 E3
I1
I2
I3
    
20.000
22.000
24.000
26.000
28.000
30.000
32.000
34.000
36.000
38.000
40.000
E1 E2 E3
L1
L2
L3
 
圖 3.2. EXI 交互作用。                        圖 3.3 . EXL 交互作用。 
20.000
25.000
30.000
35.000
40.000
45.000
50.000
I1 I2 I3
L1
L2
L3
 
圖 3.4 IXL 交互作用。 
0.7視場的交互作用，如圖3.5~7所示。 
20.000
25.000
30.000
35.000
40.000
45.000
50.000
55.000
E1 E2 E3
I1
I2
I3
    
20.000
25.000
30.000
35.000
40.000
45.000
50.000
55.000
E1 E2 E3
L1
L2
L3
 
圖 3.5. EXI 交互作用。                           圖 3.6. EXL 交互作用。 
 -12-  
度為24，故採用L27直交表分析。公差因子的配置如表3.13所示。 
表 3.12. 鏡頭結構公差及水準數 
 
表 3.13. L27 因子配置。 
 
各視場直交表如表3.14至16所示。表3.14軸上視場直交表，最佳水準組合為
A1B2E2I2L1M1(實驗次數13)；表3.15之0.7視場直交表，最佳水準組合為
A3B3E1I1L3M3(實驗次數3)；表3.16全視場直交表，最佳水準組合為
A2B3E2I2L2M2(實驗次數14)。 
表 3.14. 軸上視場。          表 3.15. 0.7 視場。          表 3.16. 全視場。 
       
 -14-  
表 3.21. 0.7 視場變異數分析。 
 
表 3.22. 全視場變異數分析 
 
結論：經由第三次田口法的變異數分析在軸上、0.7、全視場中可以看出因子
間交互作用的貢獻度影響遠大於主要因子之影響，本研究成功找出現有的光學軟
體所無法得到因子間的交互作用。 
本部份詳細內容列於李依霖碩士論文[3.5]，另刊行於會議論文[3.6]。 
 
4. 厚透鏡三階單色像差之變化演算法 
前述範例展現了田口法在已知結構的實際鏡頭之應用。然而，在設計一顆全
新鏡頭或修改已知鏡頭的某些鏡組時，我們需要的是在尚不知具體結構參數值的
情形下，先給予一穩定之起始布局。據此，我們研究出一種新型虛擬厚透鏡組模
型，可精準模擬真實厚透鏡組之初階與三階單色像差特性，在不需給予真實透鏡
結構的情況下直接研究厚鏡組像差隨入射光變化之特性。此虛擬鏡組內部包含三
 -16-  
鏡組予以適當加厚，最後再以優化程式進一歩修改結構以增進像質。優化程式並
非萬能，它只能將原結構之潛力發揮出來，拙劣的初始結構無法得到高品質的優
化成果。 
有時工程師需會面對厚透鏡組問題，例如修改現有變焦鏡頭中的某一鏡組，
保持其初階結構但賦予新的像差特性，以增進系統整體像質。這種情況下，需了
解厚透鏡組像差隨入射光組態而改變的方式。知名光學軟體 Code V ®(Optical 
Research Associates Inc)採用基於Walther [4.2~4]虛擬光線追跡法之光學鏡組(lens 
module)來模擬厚透鏡組之初階及像差特性[4.5]。初階參數用以決定近軸入出射光
線的高度與角度之相依性。Code V ®的lens module鏡組初階參數包含厚度、焦距
(MFL)、前焦距 (MFF)及後焦距(MBF)。設定MFF及MBF等同於設定前後主平面位
置。像差方面先設定成像縮小率(MRD)、入瞳位置(MEN)、入瞳直徑(MED)及最大
視場(MFD)四個參數值，再給予對應之六個Seidel像差值。依據以上設定參數，Code 
V 可計算出任意入射近軸光條件下，鏡組對系統像差之影響力。此功能非常益於
光學鏡頭設計之初始佈局，Park and Shannon [4.6]展現了應用四個lens modules於變
焦鏡頭設計之方法。然而，Code V的方法仍存在若干不便與缺陷：(1) 物體不能在
無限遠或前焦點處，即MRD不能為零或無限大，必需用一極小或極大之值模擬(2)
無法直接用法物方遠心鏡組，因為其入瞳位置及孔徑均為無限大。同樣的必需用
較大數值取代(3)無焦鏡組之焦距及前後焦距均為無限大，此時Code V的 MFL、
MFF及MBF為無效參數，不能正確計算光線出射高度及角度(4) Code V雖能計算鏡
組對系統像差之影響，例如點列圖(Spot diagram)或垂軸像差曲線(Ray aberration 
curves)，但無法直接給出鏡組在特定組態下之像差值，此資訊卻是光學設計時關
注的焦點。 
本研究開發出一種別於Code V的新式虛擬厚透鏡組，可完全模擬真實鏡組之
初階與三階單色像差性質。此虛擬厚透鏡組內部包含三個薄透鏡組(圖4.2)，各薄鏡
 -18-  
 
圖 4.1. 薄透鏡組模型，像差隨入射邊緣光及主光線之高度及角度而變 
 
 
圖 4.2. 內含三薄透鏡之虛擬鏡組模型 
 
 
圖 4.3. 聚焦鏡組模型 
 -20-  
總和與真實透鏡有相同之值。接著，由組態二之入射條件，計算光線行經每一薄
透鏡之高度及角度，應用薄透鏡像差變換公式[4.1]計算薄透鏡個別新像差及總和，
列於表4.3。比較最後一欄與表4.1第三欄，可知本模型所預期之像差與真實透鏡之
像差完全相同。 
第二範例展示如何應用此演算法來最佳化變焦系統在參考組態之像差設定
值。圖4.7為由雙厚透鏡組構成之有限距變焦系統，物像總長120mm、像高5 mm、
光圈直徑5mm且固定於第一鏡組前端、二光學組態放大率分別為-1及-0.5。假設兩
個鏡組具有相同結構，初階參數為f=30、d=20、δ =5及 'δ =-5。間距d0、 d1、d2可
由典型變焦公式[4.7]求得。令第一鏡組在第一組態之入射光條件為參考組態，則此
時之像差值應設為多少才能使系統有最好之平均成像品質？ 
 
表 4.1. 圖 4.6 鏡組於二個光學組態之像差。 
像差 光學組態 1 光學組態 2 
S1 -0.000957597 -0.00966773 
S2 -0.00249863 0.0117646 
S3 -0.01697 -0.0381275 
S4 -0.0649725 -0.0268528 
S5 0.825262 0.0777384 
S6 -3.33372 -0.0504529 
 
 -22-  
 
圖 4.7. 有限距變焦系統架構。 
 
表 4.4. 圖 4.7 變焦系統於優化前之像差、畸變及優化函數值。 
 光學組態 1 光學組態 2 
像差係數 鏡組 1 鏡組 2 總和 鏡組 1 鏡組 2 總和 
S1 0 -0.00561600 -0.00561600 -0.00040008 -0.00159383 -0.00199392
S2 0 -0.00999200 -0.00999200 0.00170579 -0.00379657 -0.00209078
S3 0 -0.01332622 -0.01332622 0.00146975 -0.00451043 -0.00304068
S4 0 0 0 0 0 0 
S5 0 -0.00190726 -0.00190726 0 0.01168768 0.01168768
S6 0 -0.00169534 -0.00169534 0 0.00165441 0.00165441
畸變 - - 0.19% - - -1.21% 
優化函數值 = 2.24284 
 
表 4.5. 圖 4.7 變焦系統於優化後之像差、畸變及優化函數值。 
 光學組態 1 光學組態 2 
像差係數 鏡組 1 鏡組 2 總和 鏡組 1 鏡組 2 總和 
S1 0 0.00205808 0.00205808 0.00033237 0.00358955 0.00392192 
S2 -0.00160262 -0.00144285 -0.00304546 0.00082626 -0.00157007 -0.00074381 
S3 -0.00453659 -0.00231733 -0.00685391 0.00515546 -0.00446792 0.00068754 
S4 -0.00181356 -0.00181356 -0.00362711 -0.00168293 -0.00168293 -0.00336587 
S5 -0.01641455 0.01541455 -0.001 -0.01467346 0.01563678 0.00096331 
S6 0 0.02979534 0.02979534 0 0.00397591 0.00397591 
畸變 - - 0.1% - - -0.1% 
優化函數值 = 0.408987 
