coupled and tightly coupled. The loosely coupled 
approach is to integrate SIP-NEMO into IMS； the 
tightly coupled approach is to enhance IMS with 
network mobility support. The objectives of our 
proposed interworking architectures are to achieve 
service continuity, power saving, less signaling 
transmission and lower network bandwidth consumption. 
We have accomplished the initial design in the basic 
scenarios, and developed the more strict procedures 
on the refined network architectures and components. 
We have also proposed a decentralized secure handover 
scheme for service continuity in IMS-based networks: 
Decentralized Service Continuity (DSC). The DSC 
improves the efficiency of the handover process from 
the aspects of load distribution. The novelty of the 
DSC is that the P-CSCF in IMS is enhanced as a 
distributed application server with third party call 
control (3PCC) for handling the handover. Moreover, 
the DSC integrates a secure context transfer 
mechanism to the P-CSCF to get the context 
information of a newly attached UE and guarantee the 
confidentiality and the integrity. In addition, a 
centralized service continuity scheme, abbreviated as 
CSC, has been proposed as an alternative to handover 
in the IMS. The CSC treats handover as a service in 
the IMS network. Its architecture and operation are 
based on service invocation. The service continuity 
procedure is performed by an application server 
called CSC AS. In addition, a variant of the CSC, 
denoted by CSC*, is derived by adopting the E-IMS AKA 
with one-pass authentication for achieving the 
acceleration of IMS registration during the handover. 
Analytical results show that both schemes could 
shorten the handover latency significantly, as 
compared with the standard IMS-based service 
continuity. 
英文關鍵詞： Session Initiation Protocol, IP Multimedia Subsystem, 
Network Mobility, Interworking, Service Continuity, 
Handover. 
 
尚須解決的問題以及面臨的挑戰。 
而在 Tightly  Coupled 架構中，我們設計的目標為提出一個 IMS‐based  Network 
Mobility。此 interworking 的概念是利用 IMS 架構來設計 network  mobility，首先是考量
減少網路信令傳輸與節省網路頻寬使用的好處，將為每台車所形成的 mobile network佈
建一個特別的元件 Super User Agent (SUA)，作為車上使用者對外的閘道；為了讓使用者
無論是否在車上，都能一樣享有所訂購的 IMS多媒體服務，在訊息運作流程設計上也需
與原先服務觸發機制配合，以達到服務不中斷  (service continuity)；而且，訊息流程的設
計要儘可能與原先 IMS 上各元件的功能與運作邏輯相容  (compatibility)，我們將在特定
的元件上設計 tunnel 的機制。由於本計劃將提出的 Tightly Coupled架構，新增 network 
mobility 部分是利用既有的 IMS 網路架構去佈建的，為了讓佈署 IMS 系統的電信網路業
者有較大的支援意願，我們除了研究移動網路內的使用者註冊與通話建立流程，也將 IMS
的安全，以及計費機制納入考量，並針對移動網路的 handoff 最佳化進行探討，最後我
們將分析我們設計的架構及運作機制是否達到 interworking scenarios定義的目標。 
三、 文獻探討 
 IP Multimedia Subsystem 
IMS是實現固網行動融合(Fixed Mobile Convergence；FMC)以及三網合一服務(Triple 
Play Services)的網路架構核心，提供強大的服務支援。在 3GPP 23.228 [1]有對此架構做詳
細介紹，主要定義下列元件: Call Session Control Function (CSCF)、Application Server (AS)、
Home Subscriber Server (HSS)和Multimedia Resource Function (MRF)。 
目前已經有一些研究在探討 IMS 的 3GPP‐WLAN  interworking[4,  5]、 security 
association[6]、optimized mobility management[7]、simultaneous mobility[8]，以及 handoff 
over heterogeneous accesses[9]。 
 MIP-NEMO 
IETF 針對 NEtwork  MObility 議題制定以 MIPv6 為基礎的 Network  Mobility  Basic 
Support標準文件[10]，由於MIPv6‐NEMO 承襲MIPv6 的 bi‐directional tunnel 機制，因此
有MIPv6的傳輸路徑過長，封包標頭(header)過大的問題[11]，造成傳輸效能上的限制，
雖然已有文獻提出改善作法[12,  13]，若是考慮到 VoIP 或是其他即時多媒體傳輸服務的
需求，則尚有進步空間。 
 SIP-NEMO 
SIP‐NEMO 和MIPv6‐NEMO不同的是 SIP在多媒體資料傳輸是以 end‐to‐end 方式，走
的是最佳化的路徑，不需透過 HA的轉送，也沒有因為 tunnel 而產生的非最佳路徑傳輸
(sub‐optimal  routing)、封包標頭過大(header  overhead)，以及 HA的存活(survivability)問
題。因此，在傳輸即時多媒體封包時的效能表現上會比MIPv6來的較好。另外，在移動
網路的階層式架構之下  (移動網路中的移動網路，意即巢狀結構)，SIP‐NEMO 也考慮到
兩個 clients皆處於同一個巢狀的移動網路下的情況，並透過 Record‐Route 的運用提供了
-2-
未來我們將以先前論文[15]中的 Tightly  Coupled架構設計，考量使用者 IMS服務的
觸發、安全性等因素，加以修改，並且提出更完善的作法。依照 3GPP 標準[1]，IMS 在
使用者註冊時會 challenge 使用者，利用 Authentication and Key Agreement Version 1 with 
Message  Digest  Algorithm  5  (AKAv1‐MD5)來達到認證，在我們[15]中的架構設計尚未完
備，因此我們將會針對此問題來做更深研究的探討，修改先前的架構，使這個
interworking架構更為完善。 
 Tightly Coupled 架構的設計考量 
在建立以 IMS為基礎的移動架構之前，必需要考慮一些需求。這裡有兩個 UA和 SUA
獨立的網路。他們可以獨立運作，但如果這兩個網路在支援網路移動的環境下相互運
作，將會遭遇一些問題，例如：authentication、security association、mobility management
和 service continuity。當我們佈建 Tightly Coupled 架構時，將會謹慎處理上述這些條件。
表 2為 Tightly Coupled架構和 IMS的需求比較。 
表 2、Comparison of Requirements between Tight Coupling and IMS 
                      Network Types 
Requirements  Tight Coupling  3GPP IMS 
Authentication  S‐CSCFUA/HSSUA  S‐CSCFUA/HSSUA 
Security Association  UA↔SUA、SUA↔P‐CSCFSUA UA↔P‐CSCFUA 
Location Management  HSSUA  HSSUA 
Handoff Management  SUA  UA 
Service Continuity  iFC Creation Procedure  3GPP Support 
五、 結果與討論 
在本年度，我們已分別就這兩種架構探討基本的註冊、通話建立、節點移動、網路
移動，以及服務召請(service  invocation)等運作來驗證其可行性，目標是希望能達到省
電、服務不中斷、較少的信令傳輸，以及較低的頻寬消耗。其中，我們為加速 IMS子系
統 mid‐session macro‐mobility 效能，在新舊網路 P‐CSCFs之間，以 context  transfer方式
縮短重建時間，提出一個非集中式的安全換手重建機制(decentralized secure handover；
DSC)。DSC 是將 P‐CSCF加以強化，使它具備第三方通話控制(third party call control；3PCC)
能力，並且支援 secure context transfer。由這些分散佈建的 P‐CSCF負責兼任換手重建伺
服器的角色，可以避免換手重建服務過度集中特定伺服器的問題，達到負載分散(load 
distribution)的效果。另外，DSC 特別重視安全性(security)，在 UE 換手重建 session 的過
程，達到系統的機密性(confidentiality)與完整性(integrity)。 
 Loosely Coupled 架構的四種通話建立流程 
我們提出了兩項假設：1) 假設 UA1 和 UA2 可以在 IMS 與 SIP‐NEMO 之間漫遊，而
在通話建立的過程中；2) 假設 UA1為 Originating User Agent，而 UA2為 Terminating User 
Agent。圖 1為此 Interworking架構中，四種通話建立情況的流程圖。 
-4-
 Tightly Coupled 架構的四種通話建立流程 
在 Tightly  Coupled 架構中，MN 和 CN 建立通話總共會有 4 種可能的情形，如圖 3
所示。假設條件如下：1) MN為 originating user agent且 CN為 terminating user agent；
2) MN與 CN皆可以在 IMS以及 IMS‐based NEMO環境中任意移動。 
P-CSCFUA1 S-CSCFUA1
I-CSCFUA1HSSUA1
Originating UA's IMS
I-CSCFUA2
HSSUA2
Terminating UA's IMS
Terminating SUA's IMS
UA1
UA2
UA2
Interrogating
Network
S-CSCFUA2 P-CSCFUA2ASUA1
ASUA2
1.a 1.b
2.a
3.a
3.b 3.c
3.d
8.a
8.b
8.c
P-CSCFSUA1SUA1UA1 S-CSCFSUA1
I-CSCFSUA1HSSSUA1
P-CSCFSUA2I-CSCFSUA2
SUA2UA2HSSSUA2
S-CSCFSUA2
ASSUA1 ASSUA2
2.b
4.a 4.b
5.b5.a
6.a 6.c6.b
8.d
9.a
9.b 9.c
9.d 11.a
11.b
11.c
Originating SUA's IMS
UA1
7.a 7.b 10.b10.a
 
圖 3、The Signaling Flow of Session Establishment in the Tightly Coupled Architecture   
 Tightly Coupled Optimized Node/ Network Mobility 
關於 Tightly Coupled架構上移動的議題，如果 handoff的過程中使用的 P‐CSCF改變，
我們也將採用 context transfer機制，把 context參數從舊的 P‐CSCF轉移到新的 P‐CSCF，
也平行的執行 3PCC 與重新註冊去重建進行中的 session。此機制也可以應用在 SUA 與
P‐CSCF之間。流程步驟與細節如圖 4所示。 
P-CSCF
(SUA)SUAUA1
AN2
UA1 Attached to AN2
1. Register
4. Register
3. Context trans
P-CSCF
(old)
AN1
R
e-R
E
G
IS
T
E
R
R
e-IN
V
IT
E
SUA's IMS home UA1's IMS home 
I-CSCF
(UA1)
S-CSCF
(UA1)
HSS
(UA1)
UA2's IMS home
I-CSCF
(UA2)
15. INVITE
UA2HSS(UA2)
P-CSCF
(UA2)
S-CSCF
(UA2)
2. Context req
AS
(UA1)
AS
(UA2)
18. Service Control
I-CSCF
(SUA)
S-CSCF
(SUA)
HSS
(SUA)
AS
(SUA)
5. Register 6. Cx-put
7. Cx-put Resp.
8. Register
9. Cx-put
10. Cx-put Resp.
11. 200 OK12. 200 OK
13. 200 OK
14. 200 OK
16. INVITE
17. INVITE
19. INVITE
21. INVITE
22. INVITE
23. 200 OK
24. 200 OK
25. 200 OK26. 200 OK
27. 200 OK
28. 200 OK
29. INVITE
30. 200 OK
20. Service Control
parallelization
31. Media stream re-established successfully
 
圖 4、The Message Flows of Node Handoff in the Tightly Coupled Architecture 
-6-
 Centralized Service Continuity based on Service Invocation 
為了與 3GPP 現有系統標準架構有一致性與相容性，另外提出一個 IMS 系統上集中
式(centralized)的換手重建機制，稱之為 Centralized Service Continuity (CSC)。CSC 運用 IMS
系統既有的架構與操作，把換手當作是 IMS 系統上的一項服務，藉由 iFC 的設定，以及
S‐CSCF監看 UE的重新註冊來判斷，進行標準的比對觸發服務程序(the process of service 
invocation)，而觸發的服務則是由 CSC application server (AS)來執行，CSC AS 將同時對通
話兩方送出重建邀請(re‐Invite)，以 3PCC 完成換手重建。另外為了加速換手時重新註冊
(IMS re‐registration)，結合  E‐IMS AKA的  one‐pass authentication 認證程序，設計出 CSC*。
為了 S‐CSCF 能適時地觸發 CSC AS提供的換手重建服務，每個 UE的 iFC 設定將包括兩種
情形，一種是在 UE在通話建立之初，S‐CSCF就要觸發 CSC AS，將 CSC AS加入繞送訊息
的路徑中，隨後 CSC AS便能監看雙方傳送的訊息而掌握通話狀態，並且儲存雙方連線的
SDP 相關資訊，為的是處理之後可能發生的換手，步驟參考圖 7(a)。另一種是當換手情
況發生，依 3GPP標準程序，UE會送出 SIP Register進行重新註冊，我們讓此 Register加
上重建連線的 SDP資訊，S‐CSCF 就會再次觸發 CSC  AS，CSC  AS 接著會依 Register 其中
SDP資訊更新之前建立連線儲存的 SDP，然後就以 3PCC完成換手重建，步驟參考圖 7(b)。 
IN
V
IT
E
200 O
K
 
(a)  
  
(b)  
圖 7、The Service Invocation in the CSC 
-8-
參考文獻 
[1] 3GPP, “IP Multimedia Subsystem (IMS); Stage 2,” TS23.228 v8.6.0, Sep. 2008. 
[2] J. Rosen, H. Schulzrinne, G. Camarillo, A. Johnston, J. Peterson, R. Sparks, M. Handley, 
and E. Schooler, “SIP: session initiation protocol,” IETF RFC 3261, June 2002. 
[3] C. M.  Huang,  C.  H.  Lee,  and  J.  R.  Zheng,  “A  novel  sip‐based  route  optimization  for 
network mobility,”  IEEE  Journal on  Selected Areas  in Communications,  vol. 24, no. 9, 
Sept. 2006, pp. 1682‐1691. 
[4] 3GPP,  “Feasibility  Study  on  3GPP  system  to  Wireless  Local  Area  Network  (WLAN) 
Interworking,” TR 22.934 v7.0.0, July 2007. 
[5] 3GPP,  “3GPP  System  to Wireless  Local  Area  Network  (WLAN)  Interworking;  System 
Description,” TS23.234 v7.7.0, June 2008. 
[6] Y.  Zhang  and  M.  Fujise,  “Security  management  in  the  next  generation  wireless 
networks,” International Journal of Network Security, vol. 3, no. 1, July 2006, pp. 1‐7. 
[7] T.  Renier,  K.  L.  Larsen,  G.  Castro  and  H.‐P.  Schwefel,  “Mid‐session macro‐mobility  in 
IMS‐based  networks,”  IEEE  Vehicular  Technology Magazine,  vol.  2, March  2007,  pp. 
20‐27. 
[8] Wei‐Kuo Chiang and Wen‐Yen Chang, “Network‐initiated simultaneous mobility in voice 
over  3GPP‐WLAN,”  to  appear  in  Wireless  Communications  and  Mobile  Computing 
(accepted on Oct. 18, 2009).   
[9] Wei‐Kuo  Chiang  and  Wen‐Yen  Chang  (2009),  “Mobile‐initiated  network‐executed 
SIP‐based  handover  in  IMS  over  heterogeneous  accesses,”  to  appear  in  International 
Journal of Communication Systems (accepted on Nov. 28, 2009). 
[10] V.  Devarapalli,  R.Wakikawa,  A.  Petrescu,  and  P.  Thubert,  “Network  mobility  basic 
support protocol,” IETF RFC 3963, Jan. 2005. 
[11] R.  Bhagavathula,  N.  Thanthry,  K.  Namuduri,  and  R.  Pendse,  “Issues  with  nested 
mobility,” in Proc. IEEE Veh. Technol. Conf., Oct. 2003, vol. 3, pp. 3009–2013. 
[12] H.  Cho,  T.  Kwon,  and  Y.  Choi,  “Route  optimization  using  tree  information  option  for 
nested mobile networks,” IEEE Journal on Selected Areas in Communications, vol. 24, no. 
9, Sept. 2006, pp. 1717‐1724. 
[13] M.  Calderon,  C.  J.  Bernardos,  M.  Bagnulo,  I.  Soto,  A.  de  la  Oliva,  “Design  and 
experimental  evaluation  of  a  route  optimization  solution  for  nemo,”  IEEE  Journal  on 
Selected Areas in Communications, vol. 24, no. 9, Sept. 2006, pp. 1702‐1716. 
[14] W.  K. Chiang, W.  Y. Chang  and  L.  Y.  Liu,  “Simultaneous  handover  support  for mobile 
networks on vehicles,” IEEE Wireless Communications and Networking Conference (IEEE 
WCNC 2008), Las Vegas, Nevada, USA, March 31‐ April 3, 2008, pp. 2771‐2776. 
[15] W. K. Chiang, A. N. Ren and Y. C. Chung, “Integerating SIP‐based Network Mobility into 
IP Multimedia  Subsystem,”  accepted  by  IEEE Wireless  Communication  and  Netowrk 
Conference (WCNC), 2009. 
[16] Wei‐Kuo  Chiang  and  Po‐Chiang  Kuo,  “Decentralized  secure  handover  in  IMS‐based 
networks,”  to  appear  in  International  Journal  of  Ad  Hoc  and  Ubiquitous  Computing 
(accepted on Dec. 20, 2010). 
-10-
Int. J. Ad Hoc and Ubiquitous Computing, Vol. 10, No. 3, 2012 137 
Copyright © 2012 Inderscience Enterprises Ltd.
Decentralised secure handover in IMS-based 
networks
Wei-Kuo Chiang* and Po-Chiang Kuo 
Department of Computer Science and Information Engineering, 
National Chung Cheng University, 
Chiayi 621, Taiwan 
Fax: +886 5 2720859 
E-mail: wkchiang@cs.ccu.edu.tw 
E-mail: kpc97m@cs.ccu.edu.tw 
*Corresponding author 
Abstract: This paper proposes a decentralised secure handover scheme for service continuity  
in IP Multimedia Subsystem (IMS)-based networks: Decentralised Service Continuity (DSC). 
The novelty of the DSC is that the Proxy Call and Session Control Function (P-CSCF) in IMS is 
enhanced as a distributed Application Server (AS) with third-party call control (3PCC) for 
handling the handover. Moreover, the DSC integrates a secure context transfer mechanism to the 
P-CSCF to get the context information of a newly attached User Equipment (UE) and guarantee 
the confidentiality and the integrity. The DSC could shorten the IMS transmission latency 
significantly and reduce UE power consumption, as compared with the standard IMS-based 
service continuity and the Mid-Session Macro-Mobility (MSM). 
Keywords: decentralised handover; secure context transfer; 3PCC; IMS. 
Reference to this paper should be made as follows: Chiang, W-K. and Kuo, P-C. (2012) 
‘Decentralised secure handover in IMS-based networks’, Int. J. Ad Hoc and Ubiquitous 
Computing, Vol. 10, No. 3, pp.137–148. 
Biographical notes: Wei-Kuo Chiang received his BS, MS and PhD in Computer Science  
and Information Engineering from National Chiao Tung University (NCTU), Taiwan,  
in 1989, 1991 and 1996, respectively. In February 2004, he joined the Department of Computer 
Science and Information Engineering, National Chung Cheng University, Chiayi, Taiwan, as an 
Assistant Professor. Before that, he was a section manager of the Internet Telecommunications 
Department at the Information and Communications Research Laboratories, Industrial 
Technology Research Institute (ICL/ITRI), Taiwan. He holds four patents with six pending.  
His recent research interests include SIP-based mobility management, service technologies in 
Next-Generation Networks (NGNs), mobile computing and wireless networks. 
Po-Chiang Kuo received his BS and MS in Computer Science and Information Engineering  
from National Chung Cheng University, Taiwan, in 2008 and 2010, respectively. He is currently 
working as a Smart Device Developer in CyberLink Corporation, Taipei, Taiwan. His research 
interests include mobility across heterogeneous networks, SIP-based network mobility, 3GPP IP 
Multimedia Subsystem (IMS) and applications developing on embedded operating system. 
1 Introduction 
The Next-Generation Network (NGN), a network that 
provides packet-based services and information, is gaining 
more significance in the all-IP world. To supply the 
telecommunication services and multimedia applications in 
the NGN, the Third Generation Partnership Project (3GPP) 
has defined the IMS (3GPP TS 23.228, 2009) to be 
responsible for the session signalling process. With the 
development of various wireless access technologies such as 
Universal Mobile Telecommunications System (UMTS), 
Code Division Multiple Access (CDMA2000), Wireless 
Local Area Network (WLAN), Long Term Evolution (LTE) 
and Worldwide Interoperability for Microwave Access 
(WiMAX), many issues such as networks interworking 
(Salkintzis et al., 2009; Psimogiannos et al., 2010) and 
mobility management (Ali et al., 2009) came into existence. 
From the aspect of interworking architecture, some related 
researches (Xu et al., 2007; Munasinghe and Jamalipour, 
2008; Durresi et al., 2010; Zhou et al., 2010) are to 
converge the heterogeneous wireless access networks  
because they can reduce the complexities of the design  
of the handover scheme. To achieve seamless handover in 
the heterogeneous access networks, IMS is brought up 
(Salkintzis et al., 2008; Bellavista et al., 2010; Chiang and 
Chang, 2010a, 2010b) to handle this mobility problem. 
Given the significance of these issues, the IMS-based 
service continuity for UEs has obviously become a major 
topic. 
Decentralised secure handover in IMS-based networks 139 
Figure 1 A simplified view of the IMS architecture (see online 
version for colours) 
The S-CSCF applies the filter criteria to determine whether 
to forward SIP requests to the AS for service invocation. 
The initial filter criteria (iFC) are stored in the HSS as part 
of the user profile and are downloaded to the 
S-CSCF upon user registration, or upon a terminating initial 
request for an unregistered user if unavailable. After 
downloading the user profile from the HSS, the S-CSCF 
assesses the filter criteria and invokes the appropriate 
application in the prescribed order for each subscriber call 
scenario (3GPP TS 23.218, 2008). 
2.2 Service Centralisation and Continuity 
Application Server (SCC AS) 
An SIP-based SCC AS is to provide the service continuity 
of multimedia sessions for the IMS-based service 
continuity. Its functions are defined by IMS Centralised 
Services (ICSs) (3GPP TS 23.292, 2009) and IMS Service 
Continuity (3GPP TS 23.237, 2009). The former has 
specified the architecture for delivery of consistent IMS 
services regardless of PS bearers or Circuit-Switch (CS) 
bearers, and the latter is proposed to interwork with ICS. 
The SCC AS acts as a B2BUA to reconnect an ongoing 
session for the two participant UEs, despite whether the two 
UEs are located in different access networks. 
Consider a handover scenario that uses the SCC AS to 
re-establish an ongoing session. There is already a session 
establishment between UE-1 and UE-2 where UE-1 will 
move to and attach to a new PS domain. According to the 
3GPP standard (3GPP TS 23.228, 2009), UE-1 will perform 
the processes of re-registration and session re-establishment 
sequentially. Figure 2 shows the message flows of the 
SCC handover scenario. The corresponding steps are 
illustrated here. 
Figure 2 The message flows of a handover scenario with the SCC (see online version for colours) 
Decentralised secure handover in IMS-based networks 141 
3.1 Secure context transfer 
When a handover occurs, the UE must perform the essential 
procedures to restore the same or corresponding state of  
the UE as that in the previous domain. To quickly 
reconstruct the necessary information between the UE  
and the access network, such as AAA, QoS and security 
association, an idea of the context transfer in IMS networks 
was proposed in Renier et al. (2007). The context transfer  
is to transfer the UEs context from the old P-CSCF  
(P-CSCFo) to the new one (P-CSCFn). The context may 
include registration state, call/session state and parameters 
for the security association between the UE and the  
P-CSCFo. With the context transfer mechanism, the security 
association between the UE and the P-CSCFo could  
be migrated to that between the UE and the P-CSCFn.
Hence, it needs fewer SIP messages for the re-registration 
and the session re-establishment when a handover  
occurs.
However, the context transfer mechanism mentioned 
earlier did not include the security issue while transferring 
the context from one place to another. In the modern IP 
network, varied and considerable attacks, like masquerading 
and Denial-Of-Service (DoS), often happen. To ensure a 
secure and efficient process of context transfer, we come up 
with a solution to provide the security of context transfer. 
Here, we design a reliable mechanism based on the 3GPP 
standard. Figure 4 shows the steps of the secure context 
transfer. The mechanism slightly modifies three entities 
in IMS: GGSN, UE and P-CSCF. Table 1 lists the  
notation of secret keys and parameters in the secure context 
transfer. 
Figure 4 The steps of the secure context transfer (see online 
version for colours) 
Table 1 Secret keys and parameters for secure context transfer 
(see online version for colours) 
Symbol Description 
SSK A shared secret key SSK between a GGSN and a 
neighbouring P-CSCF, a symmetric key generated 
by the GGSN or a public key managed by the  
P-CSCF
SQNg An individual counter SQN on a GGSN for each 
neighbouring P-CSCF, generated and managed by 
the GGSN 
SQNp The highest sequence number SQN the P-CSCF 
has received, managed by the P-CSCF 
RANDs A random number, generated by the GGSN, used 
for the GGSN/ P-CSCF to compute a Ks and a 
MAC/ XMAC 
AUTHs An authentication token, generated by the GGSN 
MAC A Message Authentication Code, computed by the 
GGSN using SQNg and RANDs as inputs to 
function f1 with SSK 
Ks A session key for temporary use between the  
UE and the P-CSCF, computed by the GGSN/ 
P-CSCF using RANDs as an input to function f2 
with SSK 
CTA The Context Transfer Authentications of a 
designated P-CSCF, generated by the GGSN 
CK A cipher key, generated by the HSS, kept in the 
UE and the P-CSCF, defined in 3GPP TS 33.203 
IK An integrity key, generated by the HSS, kept in 
the UE and the P-CSCF, defined in 3GPP TS 
33.203 
IMPI The IP Multimedia Private Identity (IMPI) of a 
UE in the UE’s IMS Subscriber Identity Module 
(ISIM) 
XMAC An expected Message Authentication Code, 
computed by the P-CSCF using SQNg and 
RANDs as inputs to function f1 with SSK 
When a UE moves to a new IP-CAN, the UE should execute 
the PDP context activation to gain its new IP address and 
the IP address/FQDN of the designated P-CSCFn (Salkintzis 
et al., 2009). The GGSN supplies the UE not just with the IP 
address/FQDN but also the CTAs of a designated P-CSCFn.
A moving UE will use CTA parameters to verify the newly 
attached P-CSCFn and assist the secure context transfer 
while a handover occurs. 
For a GGSN, we assume each of the neighbouring  
P-CSCFs shares a common secret key, denoted by SSK, 
with the GGSN. For each P-CSCF, the GGSN and the  
P-CSCF keep track of counters SQNg and SQNp,
respectively, to support CTA. The sequence number SQNg
is an individual counter SQN on the GGSN for each  
P-CSCF, and the sequence number SQNp on the P-CSCF 
denotes the highest sequence number the P-CSCF has 
received. 
Each CTA consists of a random number RANDs, an 
authentication token AUTHs and a session key Ks. How a  
Decentralised secure handover in IMS-based networks 143 
3.2 Security analysis 
The following offers security analysis of the proposed 
secure context transfer mechanism. The characteristics of 
security analysis to demonstrate the feasibility are shown 
here. 
Mutual authentication: The secure context transfer 
mechanism provides two mutual authentications. One is 
between a UE and the P-CSCFn, and the other is between 
the P-CSCFn and the P-CSCFo. The CTA from the GGSN, 
along with the cooperation of three entities: UE, P-CSCFn
and P-CSCFo, help achieve the authentications. The mutual 
authentication between the UE and the P-CSCFn is achieved 
by CTA because the UE should obtain the Ks from the CTA, 
and encrypts IMPI and the CK/IK with the Ks for 
authenticating the P-CSCFn. The P-CSCFn will derive the Ks
with the SSK and the RANDs, decrypt the encrypted context 
and then obtain the CK/IK for further communication.  
The mutual authentication between the P-CSCFn and the  
P-CSCFo can be achieved because the P-CSCFn should 
encrypt the necessary information in the CTReq with the 
CK/IK for the P-CSCFo to confirm the UE identity, and the 
P-CSCFo will encrypt the context information in the CTRes 
with the CK/IK for authenticating the P-CSCFn.
Replay attack: Replay attack is very common. The attacker 
might be a masquerading UE, P-CSCFn, or P-CSCFo. To 
prevent it, the SQN in the AUTHs of CTA has to be different 
for each P-CSCFn. With distinct SQN, the Ks and AUTHs
are generated based on random RANDs. Thus, CTAs will  
be different, and can only be used for one time in case of 
every handover occurrence. The SQNp and SQNg should be 
synchronous; otherwise, the RANDs and AUTHs might have 
already expired for the secure context transfer, which 
prevents the mechanism from replay attacks. In addition, the 
secret keys CK/IK will be renewed after a successful IMS 
registration (3GPP TS 23.228, 2009). 
Temporary cheat attack: For each of the three steps 
(Register, CTReq and CTRes) in the secure context transfer 
procedure, it is necessary to check whether the received 
messages are from a legal UE or P-CSCF. If any of the steps 
failed, the context transfer will break off immediately. It 
prevents the temporary cheat attacks because the attackers 
cannot fool the P-CSCFn and the P-CSCFo to complete a 
secure context transfer in the DSC. 
Key freshness: When a UE requests for a CTA, the GGSN 
will give the UE a new generated CTA based on the SQN 
for the newly attached P-CSCF of the UE and the RANDs,
where the SQN increases monotonically and the RANDs is a 
random number, i.e., the value of these parameters is 
different from that in the previous CTA. The changes of 
SQN and RANDs will cause the variations of AUTHs and Ks
even though the SSK between GGSN and the P-CSCF is 
unchanged. Hence, all these related parameters are  
renewed whenever a PDP context activation executes.  
Moreover, the CK/IK will change after a successful IMS 
registration. 
3.3 Parallelisation of re-registration and session  
re-establishment 
To achieve the DSC, the P-CSCF in IMS will be 
enhanced with the secure context transfer and 3PCC. 
The enhanced P-CSCF has to maintain the Session List to 
record the information of an ongoing session for the secure 
context transfer mechanism. The transferred context 
between the old and new P-CSCFs of a UE contains some 
registration information of the UE, such as registration state, 
session states, call states, Session List and parameters for 
the security association between the UE and the old  
P-CSCF. The enhanced P-CSCF can act as a B2BUA to 
play the role of a 3PCC controller to recover the ongoing 
session.
In general, the processes of registration and session  
re-establishment are carried out sequentially since a  
valid security association is a precondition for any 
communication session establishment (Camarillo et al., 
2002). However, in the DSC, the security association 
between the UE and the old P-CSCF could be migrated to 
that between the UE and the new P-CSCF. That the  
new P-CSCF re-establishes the ongoing session does not 
necessarily rely on the re-negotiation of security parameters 
between the UE and the new P-CSCF. Therefore, the 
enhanced P-CSCF could execute part of the registration and 
of the 3PCC in parallel. In other words, the DSC has the 
advantage of overlapping the registration process with the 
3PCC to reduce handover time as aforementioned. 
3.4 Handover algorithm on the P-CSCF 
In the DSC, the enhanced P-CSCF performs the secure 
context transfer of a UE in case of handover, continues  
the registration procedure on behalf of the UE and initiates  
a 3PCC for session re-establishment if the UE has an 
ongoing session. An algorithm for the DSC handover 
running on the P-CSCF is depicted in Figure 5. The left side 
of the figure depicts one procedure for handling the SIP 
REGISTER request, which is running on the new P-CSCF 
of a moving UE, whereas the right side depicts the other one 
for handling the context transfer request, which is running 
on the old P-CSCF of the UE. 
When a UE moves to a new PS domain, it will send an 
SIP REGISTER request to the S-CSCF via the newly 
attached P-CSCF to update its location in the HSS. The new 
P-CSCF determines to perform the context transfer or not 
by checking whether the SIP REGISTER contains a context 
transfer header and a new SDP. If the result is negative,  
it means the registration request is just an initial registration, 
so the new P-CSCF forwards the SIP REGISTER according 
to 3GPP 23.228. If the result is positive, the new P-CSCF 
will prepare the CTReq and send it to the old P-CSCF. 
Decentralised secure handover in IMS-based networks 145 
Steps 1–4: UE-1 moves to a new IP-CAN and connects to a 
new P-CSCF (P-CSCFn). UE-1 sends an SIP REGISTER 
request with its new SDP and the context transfer header. 
Upon receiving this REGISTER request, the P-CSCFn will 
perform the secure context transfer with the context transfer 
header to get the context information of UE-1 on the old  
P-CSCF (P-CSCFo). 
Steps 4–12: After receiving the context of the UE-1 
transferred from the P-CSCFo, the P-CSCFn will continue 
the unfinished steps for the UE-1 registration. 
Steps 13–27: At the same time, the P-CSCFn will execute 
the 3PCC to re-establish the ongoing session. That is, the 
unfinished steps for the registration and the 3PCC will be 
processed in parallel. The P-CSCFn will initiate two 
INVITEs: One is for UE-1 and the other is for UE-2.  
After both UE-1 and UE-2 answer their corresponding  
200 OK response for the INVITE requests, the session is  
re-established. 
The dotted lines in Figure 6 represent the overlap steps. 
For example, steps 13–24 can be concurrently executed with 
steps 4–12 and steps 25–27, so we only need to calculate the 
longer part for the total handoff latency. Thus, only the 
delay time of steps 13–24 needs to be calculated and that of 
steps 4–12 and 25–27 can be ignored since the former takes 
longer.
4 Performance analysis 
To evaluate the performance of the proposed scheme, we 
compare it with the 3GPP Standard Scheme (SCC) and the 
MSM scheme in terms of IMS transmission latency and 
performance metrics. The IMS transmission latency is 
defined as the sum of the transmission time of delivering 
SIP messages for handling the handover. Deployment 
considerations are also discussed as a suggestion for 
network operators. 
4.1 IMS transmission latency 
The IMS transmission latencies of the SCC, the MSM and 
the DSC will be compared based on the message flows  
of their handover scenarios in Figures 2, 3 and 6. The 
propagation delay between the UE and the P-CSCF is 
denoted by ,UE P CSCFT ⇔ −  and so on. Note that the dotted lines 
in these figures represent the overlap steps. It means that 
these steps can be executed with other steps in parallel, so 
we can ignore their delay time. 
According to Figure 2, the IMS transmission latency of 
a handover scenario with the SCC is 
SCC 1 1 1 1
1 1 1
1 1 1
1 _ 1 1 2
2 _ 2 2 2
2
5 4
4
4 4
4 3
6 3
3
UE P CSCF P CSCF I CSCF
P CSCF S CSCF I CSCF HSS
I CSCF S CSCF S CSCF HSS
S CSCF SCC AS S CSCF S CSCF
S CSCF SCC AS S CSCF P CSCF
P CSCF
T T T
T T
T T
T T
T T
T
− ⇔ − − − − ⇔ − −
− − ⇔ − − − − ⇔
− − ⇔ − − − − ⇔
− − ⇔ − − − ⇔ − −
− − ⇔ − − − ⇔ − −
− −
= +
+ +
+ +
+ +
+ +
+ 2 .UE⇔ −
According to Figure 3, the IMS transmission latency of a 
handover scenario with the MSM is 
MSM 1
1 1
1 1 1
1 1 2
2 2 2 2
5 2
2 3
2 2
2 3
3 3 .
n n o
n n
UE P CSCF P CSCF P CSCF
P CSCF I CSCF P CSCF S CSCF
I CSCF HSS I CSCF S CSCF
S CSCF HSS S CSCF S CSCF
S CSCF P CSCF P CSCF UE
T T T
T T
T T
T T
T T
− ⇔ − − ⇔ −
− ⇔ − − − ⇔ − −
− − ⇔ − − ⇔ − −
− − ⇔ − − ⇔ − −
− − ⇔ − − − − ⇔ −
= +
+ +
+ +
+ +
+ +
According to Figure 6, the IMS transmission latency of a 
handover scenario with the DSC is 
DSC 1
1 1 2
2 2 2 2
2
3(
).
n n o
n
UE P CSCF P CSCF P CSCF
P CSCF S CSCF S CSCF S CSCF
S CSCF P CSCF P CSCF UE
T T T
T T
T T
− ⇔ − − ⇔ −
− ⇔ − − − − ⇔ − −
− − ⇔ − − − − ⇔ −
= +
+ +
+ +
We suppose that the propagation delay between two  
nodes in the same network is α unit, and that between  
two nodes in distinct networks is β unit. The propagation 
delay across two networks takes more time than that  
in the same network. So, it is anticipated that α < β.
The percentage of roaming subscribers is ρ, and the 
percentage of UEs calling a corresponding UE in 
another distinct home network is δ. Thus, we can 
rewrite the above-mentioned equations to get: 
TSCC = 5α + 4((1 – ρ)α + ρ β)
                +  ((1 – ρ)α + ρ β) + 4α + 4α + 4α + 4α
                + 3((1 – δ)α + δ β) + 6α + 3((1 – ρ)α
              + ρ β) + 3α = 41α + (8ρ + 3δ)(β – α); 
TMSM = 5α + 2((1 – ρ)α + ρ β)
                 + 2((1 – ρ)α + ρ β) + 3((1 – ρ)α
                 + ρ β) + 2α +2α +2α + 3((1 – δ)α +δ β)
                 + 3((1 – ρ)α +ρ β)
                 + 3α = 27α + (10ρ + 3δ)(β – α);
TDSC = α + 2((1 – ρ)α + ρ β)
              + 3(((1 – ρ)α + ρ β) +((1 – δ)α + δ β)
              + ((1 – ρ)α + ρ β) + α) = 15α + (8ρ + 3δ)
                  (β – α).
Because of the lack of the actual deployment of the 
discussed architecture, it is delicate to predict the number  
of calls involving the components of this architecture. By 
applying the set of data (ρ = 20%, δ = 60%), which comes 
from the GSM world (Bessis, 2006), to the  
above-mentioned equations, we rewrite them to get: 
TSCC = 37.6α + 3.4β;
TMSM = 23.2α + 3.8β;
TDSC = 11.6α + 3.4β.
According to the above-mentioned equations, we compare 
the DSC with the SCC and the MSM, and the improvement 
ratios reach 
SCC DSC
SCC
26
37.6 3.4
T T
T
α
α β
−
=
+
Decentralised secure handover in IMS-based networks 147 
distribution. Owing to the decentralised property  
of the DSC, it would have less effect than a centralised 
entity in case of trouble occurrence. The DSC integrates 
a secure context transfer mechanism to the P-CSCF in the 
IMS to avoid the long delay of a handover owing to the  
two-pass authentication in the standard re-registration 
procedure. The secure context transfer mechanism 
guarantees the confidentiality and the integrity between the 
UE and the P-CSCF. 
The DSC could improve the efficiency of the standard 
IMS-based service continuity. From the mathematical 
analyses, the results show that the proposed scheme has not 
only shorter IMS transmission latency but also less power 
consumption for UEs, as compared with the SCC and the 
MSM. In addition, the DSC is without much modification 
on the existing IMS architecture so as to make deployment 
more practicable. 
The DSC is an application layer solution with  
flexibility for the IMS-based service continuity. For 
example, the GGSN has a similar role to the PDG in 3GPP-
WLAN, and the PDN gateway in 3GPP Evolved Packet 
Core (EPC) (3GPP TS 23.401, 2009). That is, the DSC may 
be easily adapted to the existing cellular networks (e.g., 
3GPP-WLAN) and future networks (e.g., WiMAX/EPC). 
Therefore, it may also be considered as an alternative 
solution of handover for NGN. In addition, it could be 
interworked with other layer solutions and support data 
transmission and real-time services over IP. Our future work 
is to investigate the feasibility of combining the DSC with 
lower layer solutions to design a cross-layer mobility 
management scheme. 
Acknowledgement 
This work was sponsored in part by National Science 
Council of Taiwan under grant NSC 99-2221-E-194-037-
MY2. 
References 
3GPP TS 23.218 (2008) IP Multimedia (IM) session handling;  
IM call model; Stage 2. v8.1.0. 
3GPP TS 23.228 (2009) IP multimedia subsystem (IMS); Stage 2. 
v9.0.0. 
3GPP TS 23.237 (2009) IP Multimedia Subsystem (IMS) Service 
Continuity; Stage 2. v10.0.0. 
3GPP TS 23.292 (2009) IP multimedia subsystem (IMS) 
centralized services; Stage 2. v9.4.0. 
3GPP TS 23.401 (2009) General Packet Radio Service (GPRS) 
enhancements for Evolved Universal Terrestrial Radio Access 
Network (E-UTRAN) access. v9.2.0. 
3GPP TS 33.102 (2009) 3G Security; Security architecture.  
v9.1.0. 
3GPP TS 33.203 (2009) 3G security; Access security for IP-based 
services. v9.3.0. 
Ali, I., Casati, A., Chowdhury, K., Nishida, K., Parsons, E., 
Schmid, S. and Vaidya, R. (2009) ‘Network-based mobility 
management in the evolved 3GPP core network’, IEEE 
Communications Magazine, Vol. 47, No. 2, pp.58–66. 
Bellavista, P., Corradi, A. and Foschini, L. (2010) ‘IMS-compliant 
management of vertical handoffs for mobile multimedia 
session continuity’, IEEE Communications Magazine,
Vol. 48, No. 4, pp.114–121. 
Bessis, T. (2006) ‘Improving performance and reliability of an 
IMS network by co-locating IMS servers’, Bell Labs 
Technical Journal, Vol. 10, No. 4, pp.167–178. 
Camarillo, G., Marshall, W. and Rosenberg, J. (Eds.) (2002) 
‘Integration of resource management and session initiation 
protocol (SIP)’, IETF Network Working Group, RFC 3312, 
October.
Chiang, W-K. and Chang, W-Y. (2010a) ‘Mobile-initiated 
network-executed SIP-based handover in IMS over 
heterogeneous accesses’, International Journal of 
Communication Systems, Vol. 23, Nos. 9–10, pp.1268–1288. 
Chiang, W-K. and Chang, W-Y. (2010b) ‘Network-initiated 
simultaneous mobility in voice over 3GPP-WLAN’, Wireless 
Communications and Mobile Computing, Vol. 11, No. 1, 
pp.53–66.
Durresi, A., Zhang, P., Durresi, M. and Barolli L. (2010) 
‘Architecture for mobile heterogeneous multi domain 
networks’, Mobile Information Systems, Vol. 6, No. 1, 
pp.49–63.
Dutta, A., Famolari, D., Das, S., Ohba, Y., Fajardo, V., Taniuchi, 
K., Lopez, R. and Schulzrinne, H. (2008) ‘Media-independent 
pre-authentication supporting secure inter-domain handover 
optimization’, IEEE Wireless Communications, Vol. 15, 
No. 2, pp.55–64. 
Huang, C-M. and Li, J-W. (2007) ‘Authentication mechanism over 
the integrated UMTS network and WLAN platform using the 
cross-layer bootstrap’, IET Communications, Vol. 1, No. 5, 
pp.866–874.
Karopoulos, G., Kambourakis, G. and Gritzalis, S. (2007) ‘Survey 
of secure handoff optimization schemes for multimedia 
services over all-IP wireless heterogeneous networks’, 
IEEE Communications Surveys & Tutorials, Vol. 9, No. 3, 
pp.18–28.
Kwon, T.T., Gerla, M. and Das, S. (2002) ‘Mobility management 
for VoIP service: mobile IP vs. SIP’, IEEE Wireless 
Communications, Vol. 9, No. 5, pp.66–75. 
Leggio, S., Manner, J. and Raatikainen, K. (2005) ‘Achieving 
seamless mobility in IP-based radio access networks’, IEEE 
Wireless Communications, Vol. 12, No. 1, pp.54–59. 
Munasinghe, K. and Jamalipour, A. (2008) ‘Interworking of 
WLAN-UMTS networks: an IMS-based platform for session 
mobility’, IEEE Communications Magazine, Vol. 46, No. 9, 
pp.184–191.
Ntantogian, C. and Xenakis, C. (2009) ‘One-pass EAP-AKA 
authentication in 3G-WLAN integrated networks’,  
Wireless Personal Communications, Vol. 48, No. 4,  
pp.569–584.
Politis, C., Chew, K.A., Akhtar, N., Georgiades, M., Tafazolli, R. 
and Dagiuklas, T. (2004) ‘Hybrid multilayer mobility 
management with AAA context transfer capabilities for all-IP 
networks’, IEEE Wireless Communications, Vol. 11, No. 4, 
pp.76–88.
Wireless Pers Commun
DOI 10.1007/s11277-012-0503-z
IMS-Based Centralized Service Continuity
Wei-Kuo Chiang · Po-Chiang Kuo
© Springer Science+Business Media, LLC. 2012
Abstract The IP Multimedia Subsystem (IMS) has been selected as a telecommunication
industrial standard for the signal processing in the heterogeneous access networks. It is also
brought up to handle the mobility management. However, the mobility of the user equipment
(UE) may disrupt or even intermittently disconnect an ongoing real-time session, which
heavily affects the satisfaction of the users. Therefore, how to reduce the service disruption
time gets more and more important. This paper first proposes a centralized service continuity
scheme, abbreviated as CSC, in IMS-based networks. The CSC treats handover as a service
in the IMS network. Its architecture and operation are based on service invocation. The ser-
vice continuity procedure is performed by an application server called CSC AS. The CSC
AS can carry out the third-party call control for fast session re-establishment by initiating
two INVITE requests concurrently. In addition, a variant of the CSC, denoted by CSC∗, is
derived by adopting the E-IMS AKA with one-pass authentication for achieving the accel-
eration of IMS registration during the handover. Analytical results show that both schemes
could shorten the handover latency significantly, as compared with the standard IMS-based
service continuity.
Keywords Service invocation · Third party call control · IP multimedia subsystem
1 Introduction
With the development of various wireless technologies such as Universal Mobile Telecommu-
nications System (UMTS), Code Division Multiple Access (CDMA2000), Wireless Local
Area Network (WLAN), LTE (Long Term Evolution) and Worldwide Interoperability for
W.-K. Chiang (B) · P.-C. Kuo
Department of Computer Science and Information Engineering, National Chung Cheng University,
Chiayi 621, Taiwan, ROC
e-mail: wkchiang@cs.ccu.edu.tw
P.-C. Kuo
e-mail: kpc97m@cs.ccu.edu.tw
123
IMS-Based Centralized Service Continuity
Table 1 Acronyms and terms
3PCC 3rd party call control
AKA Authentication and key agreement
AUTH Authentication token
AV Authentication Vector
B2BUA Back-to-back user agent
CK Cipher key
CSC AS Centralized service continuity application server
CSCF Call session control function
DP Digest password
HSS Home subscriber server
IK Integrity key
IMPI IP Multimedia Private Identity
IMS IP Multimedia Service
ITK IMS Temporary Key
RAND Random number
SCC AS Service Centralization and Continuity Application Server
SDP Session Description Protocol
SIP Session Initiation Protocol
UE User Equipment
XRES Expected response
2 Related Works
In this section, we will introduce the backgrounds of the IMS-based service continuity. We
will briefly describe the IMS architecture defined by 3GPP [3,14], then demonstrate the IMS
AKA procedure [15,18,19], and illustrate the message flows of the SCC handover [10,11].
2.1 The IMS Architecture
The IMS was first introduced in 3GPP release 5 as the core network for the 3G cellular
system [3]. The IMS specifies the functional entities, such as user equipment (UE), call and
session control function (CSCF), application server (AS), and home subscriber server (HSS).
The entities are essentially involved in processing signaling messages for session negotia-
tion, multimedia control, quality of service (QoS), mobility management, and authentication,
authorization and accounting (AAA) provision. A simplified architecture of an IMS network
for a UE handover scenario [20] is shown in Fig. 1.
The CSCF may take on the following roles as used in the IMS: proxy CSCF (P-CSCF),
interrogating CSCF (I-CSCF) and serving CSCF (S-CSCF). Each of them has different func-
tionalities. The P-CSCF, on the one hand, behaves like a proxy server and will forward
SIP messages to the home network, and like a user agent, on the other hand, in abnormal
conditions. The I-CSCF is responsible for SIP message forwarding, HSS interrogation and
S-CSCF selection. The S-CSCF performs registration and call setup services for the UE and
is responsible for service control and composition while the service logic is implemented
within ASes.
123
IMS-Based Centralized Service Continuity
UE-1 P-CSCF I-CSCF S-CSCF HSS
1. Register (IMPI)
2. Register (IMPI)
5. Register (IMPI)
8. 401 Unauthorized
(IMPI, RAND, AUTN, 
IK, CK)
9. 401 Unauthorized
(IMPI, RAND, AUTN, 
IK, CK)10. 401 Unauthorized(IMPI, RAND, AUTN)
11. Register
(IMPI, RES) 12. Register
(IMPI, RES)
15. Register
(IMPI, RES)
18. 200 OK
19. 200 OK
20. 200 OK
6. Cx-Put/Cx-Pull
AV-Req (IMPI)
7. Cx-Put/Cx-Pull Res
AV-Req-Resp
(IMPI, AVs)
Unprotected
Protected
3. Cx-Selection-Info
4. Cx-Selection-Info Res
13. Cx-Selection-Info
14. Cx-Selection-Info Res
16. Cx-Put/Cx-Pull
17. Cx-Put/Cx-Pull Res
Fig. 2 The message flows of a registration with the IMS AKA
which contains an ordered array of n AVs. Each vector includes a random number RAND, an
expected response XRES, a cipher key CK, an integrity key IK, and an authentication token
AUTH which are for authentication and key agreement between the UE and the S-CSCF.
After that, the S-CSCF will send an authentication challenge (401 Unauthorized) with the
parameters selected from an AV, including the RAND, the AUTH, the CK, and the IK towards
the UE. This 401 Unauthorized response will pass the P-CSCF. The CK and the IK will be
taken out of and kept by the P-CSCF, and the UE will receive a 401 Unauthorized response
only with the RAND and AUTH.
Step 11: After receiving the challenge response, the UE extracts the RAND and AUTH,
and runs AKA algorithms [18,22]. Then it will derive the authentication response RES, the
CK, and the IK. The RES will be carried in a new REGISTER request which is “protected”
between the UE and the P-CSCF. Note that the security association between the UE and the
P-CSCF had already been negotiated in the previous “unprotected” registration steps, and a
secure channel IPsec [23] has been established. The CK and the IK are to encrypt/decrypt the
IPsec packets. These protections can guarantee the origin authenticity, confidentiality, and
integrity.
Steps 12–20: The I-CSCF will determine the responsible S-CSCF for the UE, and then
forward the new REGISTER request to it. The S-CSCF retrieves the current XRES of the UE
and checks it with the RES which was carried to the S-CSCF. If the RES equals to the XRES,
it means the UE has been successfully authenticated and the IMPI has also been registered
to the HSS; that is, the registration-flag is set to “Registered”. The S-CSCF will send a 200
OK response to the I-CSCF after a successful authentication, and then the response will be
forwarded to the UE to complete the IMS AKA registration procedure.
2.3 The Message Flows of the SCC Handover
A SIP-based SCC AS is to provide the service continuity for the IMS-based multimedia ses-
sions. Its functions are defined by IMS Centralized Services (ICS) [10] which has specified
123
IMS-Based Centralized Service Continuity
Steps 1–20: UE-1 moves and attaches to a new PS domain, and then discovers the ad-
dress/FQDN of the new P-CSCF (P-CSCF-1) after the PDP context activation. To re-establish
the ongoing session between UE-1 and UE-2, UE-1 should perform the re-registration pro-
cedure through IMS AKA registration first [15]. The goal is to inform the HSS of the new
location of UE-1, and setup the security association between UE-1 and P-CSCF-1. These
steps are the same as those in Fig. 2.
Steps 21–22: During the registration process, S-CSCF-1 should perform a third-party
registration to SCC AS-1 for UE-1 based on the iFC in UE-1 user profile.
Steps 23–31: After registration, UE-1 sends a SIP INVITE request to the IMS for recon-
necting the previous ongoing session. When S-CSCF-1 receives the INVITE request, it will
forward the INVITE request to SCC AS-1 for triggering the service logic based on the iFC of
UE-1. Next, SCC AS-1 will anchor the call control leg between UE-1 and SCC AS-1 (access
leg), and send a modified re-INVITE request towards UE-2 to update the other call control
leg between SCC AS-1 and UE-2 (remote leg).
Steps 32–49: UE-2 replies the re-INVITE request with a 200 (OK) response, and SCC
AS-1 forwards this response to UE-1 to accomplish session reestablishment.
The dotted lines in Fig. 3 represent the overlap steps. For example, the delay time of steps
21–22 could be ignored since they do not delay the message flows following them. Also, the
ACK request and the 200 OK response initiated by SCC AS-1 can run in parallel so as to
shorten the handover delay. Consequently, overlapping the two flows, steps 38–43 and steps
44–49, can improve efficiency. Only will the delay time of steps 38–43 be calculated and that
of steps 44–49 can be ignored since the former takes longer.
3 Centralized Service Continuity
The CSC treats handover as a service in the IMS network. Its architecture and operation are
based on service invocation. The service continuity is performed by an application server
called CSC AS. The CSC AS can carry out the 3PCC for session re-establishment by ini-
tiating two INVITE requests concurrently. To achieve the acceleration of IMS registration
during the handover, the E-IMS AKA with one-pass authentication can be applied to the
CSC, referred to as CSC∗.
3.1 Functionalities of the CSC AS
To support the CSC functionalities, a CSC application server (CSC AS) must be implemented
and deployed. The CSC AS is a SIP AS. The initial registration of a UE in the CSC is a flow-
through from the IMS registration. It is implemented as a third-party registration involving
a SIP REGISTER from the S-CSCF of the UE to the CSC AS based on iFC.
Each time when the CSC AS receives an INVITE request from the S-CSCF, it will divide
the session into two-sided dialogs. It is rather useful for controlling calls and some procedures
of handover. Moreover, once receiving the response of the INVITE request with code 200
from the S-CSCF, the CSC AS will maintain the SDP associated with the two end users.
The CSC AS can act as a SIP user agent server, which means the CSC AS will receive
a SIP re-REGISTER request from the S-CSCF of the UE in handover. The re-REGISTER
request is composed of an SDP. This request represents the occurrence of UE handover and
triggers the CSC AS to perform a 3PCC for session re-establishment.
123
IMS-Based Centralized Service Continuity
CSC AS
S-CSCF
1. INVITE
IN
VI
TE
200 O
K
INVITE
200 OK 2. 200 OK
INVITE->CSC AS
Filter Criteria
3. Store the SDP for  
an ongoing session
HSS
0. Download iFC
during registration
(a)
CSC AS
S-CSCF
1. REGISTER with SDP
R
EG
IS
TE
R 4 .
 IN
VITEs
4. INVITE
4. INVITE
REGISTER->CSC AS
Filter Criteria
3. Compare new SDP
with old one, obtain 
up-to-date SDP
4. Send two INVITEs
to UEs (3PCC)
HSS
2. Location update 
(b)
Fig. 4 The service invocation in the CSC
Steps 1–20: These steps are the same as those in Fig. 2. Note that the REGISTER request
will carry the new SDP of UE-1.
Steps 21–22: While the registration steps take place, S-CSCF-1 selected for UE-1 will
perform a third-party registration to CSC AS-1 based on the iFC in UE-1 user profile. The
third-party REGISTER request will carry the new SDP of UE-1. With this information, CSC
AS-1 can compare the new SDP with the existing one associated with the ongoing session
in order to reach the preconditions of session establishment.
Steps 23–49: CSC AS-1 initiates two SIP INVITE requests concurrently: One is for UE-1
and the other is for UE-2. Both two end users will answer the INVITE request with a 200
(OK) response. In the end, the previous session is reconnected by the 3PCC procedure.
The dotted lines in Fig. 5 represent the overlap steps. For example, the delay time of steps
18–20 can be ignored since they do not delay the following message flows. Also, the two
123
IMS-Based Centralized Service Continuity
UE-1 P-CSCF I-CSCF S-CSCF HSS
1. Register
(IMPI, RANDu, DPu) 2. Register(IMPI, RANDu, DPu)
5. Register
(IMPI, RANDu, DPu)
12. 200 OK
(IMPI, DPs)
10. 200 OK
(IMPI, CKs, IKs, DPs)11. 200 OK
(IMPI, CKs, IKs, DPs)
6. Multimedia Auth Req
(IMPI, RANDu)
7. Multimedia Auth Ans
(CKh, IKh, User profile)Unprotected
Protected Compute ITKh
Verify digest-response
Compute DPs, CKs, IKs
Verify response-auth
Compute CKs, IKs
3. Cx-Query
4. Cx-Query Res
8. Server Assignment Req
9. Server Assignment Ans
Fig. 6 The message flows of a re-registration with the E-IMS AKA
3.4 Re-registration with the E-IMS AKA
To shorten the IMS registration process, the variant of the CSC, CSC∗, adopts the E-IMS
AKA. The E-IMS AKA was proposed in [17] as an improved secure IMS authentication
for UMTS. It can reduce the number of message round trips and guarantee the security
requirements between the UE and the IMS network. Figure 6 shows the message flows of a
re-registration with the E-IMS AKA.
The principal idea is as follows. First, an IMS UE derives a RANDu by using a sequence
number concatenated with a timestamp. At this time, the UE also use the RANDu to derive
the ITKu which consists of CKu and IKu. Next, a digest password DPu is computed by
a pseudo-random function with the RANDu and the ITKu. This DPu is treated as a ticket
or passport for challenging the server-side (the S-CSCF and the HSS). The pseudo-random
function is a cryptographic function of RFC 3310 [22]. After these preparations, the UE will
send a SIP REGISTER request with its IMPI, the RANDu and the DPu to the S-CSCF.
When receiving the SIP REGISTER request, the S-CSCF will check if the RANDu is
acceptable or not, and pass on the IMPI and the RANDu to the HSS. The HSS will use the
RANDu to derive CKh and IKh, and send them back to the S-CSCF with the UE user profile.
Because S-CSCF gets the ITKh based on CKh and IKh (from the HSS), it can derive a DPh
by the same pseudo-random function with the ITKh and the RANDu. The DPu and the DPh
should be matched if the UE is legal.
After the successful verification of the DPu, the S-CSCF will use RANDu + 1 to derive
ITKs which consists of CKs and IKs . Here CKs and IKs are for the IPsec tunnel between
the P-CSCF and the UE. Then a DPs is also generated by the pseudo-random function with
RANDu + 1 and ITKs as a challenge for the UE. A 200 OK response including the IMPI,
CKs , IKs and DPs will be sent to the UE. Note that the P-CSCF will still store CKs and IKs
and pass on the IMPI and the DPs to the UE.
123
IMS-Based Centralized Service Continuity
and performance metrics. Deployment considerations are also discussed as a suggestion for
network operators.
4.1 Message Propagation Delay
The comparative analysis is based on message propagation delay only in handover. The time
of message processing is ignored for brevity in our performance analysis due to the fact
that it is comparatively shorter than the propagation delay. We assume wireless transmission
latency is insignificant compared with wired propagation delays, considering relatively high
bandwidth in the wireless link [24].
The improvement ratios of the CSC and the CSC∗ as compared with the SCC, will be
evaluated based on the message flows of their handover scenarios in Figs. 3, 5, and 7. Note
that the dotted lines in these figures represent the overlap steps. It means that these steps can
be executed with other steps in parallel, so we can ignore their delay time.
The propagation delay between UE-1 and P-CSCF-1 is TUE−1⇔P−CSCF−1, the propa-
gation delay between P-CSCF-1 and I-CSCF-1 is TP−CSCF−1⇔I−CSCF−1, and so on. Step
numbers are marked between for a quicker understanding of the following equations.
According to steps 18–49 in Fig. 3, the session re-establishment delay with the SCC is
TSCC−SR = 2TUE−1⇔P−CSCF−1(20, 23) + TP−CSCF−1⇔I−CSCF−1(19)
+ TP−CSCF−1⇔S−CSCF−1(24) + TI−CSCF−1⇔S−CSCF−1(18)
+ 4TS−CSCF−1⇔SCC_AS−1(25, 26, 37, 38)
+ 3TS−CSCF−1⇔S−CSCF−2(27, 36, 39)
+ 6TS−CSCF−2⇔SCC_AS−2(28, 29, 34, 35, 40, 41)
+ 3TS−CSCF−2⇔P−CSCF−2(30, 33, 42)
+ 3TP−CSCF−2⇔UE−2(31, 32, 43).
According to steps 18–49 in Fig. 5, the session re-establishment delay with the CSC is
TCSC−SR = 5TS−CSCF−1⇔CSC_AS−1(21, 22, 23, 34, 35)
+ 3TS−CSCF−1⇔S−CSCF−2(24, 33, 36)
+ 6TS−CSCF−2⇔CSC_AS−2(25, 26, 31, 32, 37, 38)
+ 3TS−CSCF−2⇔P−CSCF−2(27, 30, 39) + 3TP−CSCF−2⇔UE−2(28, 29, 40).
According to steps 1–17 in Fig. 3, the re-registration delay with the SCC is
TSCC−Reg = 3TUE−1⇔P−CSCF−1(1, 10, 11) + 3TP−CSCF−1⇔I−CSCF−1(2, 9, 12)
+ 4TI−CSCF−1⇔HSS(3, 4, 13, 14) + 3TI−CSCF−1⇔S−CSCF−1(5, 8, 15)
+ 4TS−CSCF−1⇔HSS(6, 7, 16, 17).
According to steps 1–9 in Fig. 7, the re-registration delay with the CSC∗ is
TCSC∗−Reg = TUE−1⇔P−CSCF−1(1) + TP−CSCF−1⇔I−CSCF−1(2)
+ 2TI−CSCF−1⇔HSS(3, 4) + TI−CSCF−1⇔S−CSCF−1(5)
+ 4TS−CSCF−1⇔HSS(6 − 9).
According to Fig. 3, the total handover delay with the SCC is
TSCC = TSCC−Reg + TSCC−SR
123
IMS-Based Centralized Service Continuity
Fig. 8 Improvement ratios in the session re-establishment delay with the CSC
Fig. 9 Improvement ratios in the re-registration delay with the CSC∗
request appended with its new SDP to trigger the CSC AS, which would overlap the steps
for the response of the re-REGISTER request with the session re-establishment procedure
initiated by the CSC AS; whereas the UE in the SCC must wait for the completion of the
re-registration, and then sends a SIP re-INVITE request to the SCC AS for re-establishing the
ongoing session. Moreover, the two SIP INVITE requests initiated by the CSC AS can run in
parallel while only the response of the INVITE request and the ACK request initiated by the
SCC AS can run in parallel. Paralleling these overlap steps reduce the session re-establish-
ment latency. In addition, the CSC∗ achieves a significant improvement in the re-registration
delay because the SCC takes two registration round trips while the CSC∗ takes only one.
123
IMS-Based Centralized Service Continuity
SIP REGISTER request generated in case of handover; second, no change is required when
applying the CSC to the current IMS infrastructure; and third, the CSC handover service can
be easily deployed by setting the iFC for the UE.
The CSC∗ is derived from the CSC enhanced with the E-IMS AKA. Although some IMS
network entities, such as UE, S-CSCF and HSS, must be modified because of the E-IMS
AKA authentication in the CSC∗, as compare with the standard SCC, operators can easily
modify S-CSCF and HSS, and will not interrelate the other operator’s network. From the
aspect of UEs, the design can be easily fit in if the original sequence of re-registration and
session re-establishment steps is changed and the SIP re-REGISTER request is appended
with the new SDP of an UE in handover.
5 Conclusions
The CSC has been proposed for service continuity in the IMS-based NGN. It treats the hand-
over as a service in the IMS network. The CSC AS for the handover service can perform
the 3PCC by initiating two INVITE requests concurrently for fast session re-establishment.
Moreover, no change is required when applying the CSC to the current IMS infrastructure.
It only needs the UE to append an SDP to the SIP REGISTER request generated in case of
handover. The CSC∗, a variant of the CSC, adopts the E-IMS AKA with one-pass authentica-
tion for achieving the acceleration of IMS registration during the handover. The E-IMS AKA
can reduce the number of message round trips; thus, it could shorten the handover latency
significantly.
The CSC and the CSC∗ can improve the efficiency of the standard IMS-based service con-
tinuity because they have shorter message propagation delay of handover, as compared with
the SCC. In addition, there is without much modification on the existing IMS architecture so
deployment can be more practicable.
Moreover, both schemes could be adapted easily to the existing cellular networks and
future networks (e.g., WiMAX/EPC); therefore, they may also be considered as alternative
solutions of handover for NGN. Our future work is to investigate the feasibility of combin-
ing them with lower layer solutions in order to design a cross-layer mobility management
scheme.
Acknowledgments This work was sponsored in part by National Science Council of Taiwan under grant
NSC 99-2221-E-194-037-MY2. In addition, the authors would like to thank the anonymous reviewers for their
valuable comments and suggestions. Their efforts have significantly improved the quality of this paper.
References
1. Salkintzis, A., Hammer, M., Tanaka, I., & Wong, C. (2009). Voice call handover mechanisms in
next-generation 3GPP systems. IEEE Communications Magazine, 47(2), 46–56.
2. Ali, I., Casati, A., Chowdhury, K., Nishida, K., Parsons, E., Schmid, S., & Vaidya, R. (2009).
Network-based mobility management in the evolved 3GPP core network. IEEE Communications
Magazine, 47(2), 58–66.
3. Technical Specification Group Services and System Aspects. (2009). IP Multimedia Subsystem (IMS);
Stage 2. 3GPP TS 23.228.
4. Munasinghe, K., & Jamalipour, A. (2008). Interworking of WLAN-UMTS networks: An IMS-based
platform for session mobility. IEEE Communications Magazine, 46(9), 184–191.
123
IMS-Based Centralized Service Continuity
Po-Chiang Kuo received his B.S. and M.S. degrees in Computer
Science and Information Engineering from National Chung Cheng
University, Taiwan, ROC, in 2008 and 2010, respectively. He is cur-
rently working as a Smart Device Developer in CyberLink Corporation,
Taipei, Taiwan. His research interests include mobility across hetero-
geneous networks, SIP-based network mobility, 3GPP IP Multimedia
Subsystem (IMS), and applications developing on embedded operating
system.
123
 2
2) Networks Basic and Management 
    ‐ Network Systems and Devices  
    ‐ Wireless Networks, Ad‐Hoc and Sensor Networks    
    ‐ Network Modeling and Simulation  
    ‐ Network Management Techniques  
    ‐ Networks Security, Encryption and Cryptography  
 
3) Multimedia Application  
    ‐ Management and Diffusion of Multimedia Applications 
    ‐ Multimedia Data Base 
    ‐ Information Retrieval 
    ‐ Digital Rights Management 
 
4) Image, Video, Signal and Information Processing  
    ‐ Compression and Coding 
    ‐ Analysis and Processing 
    ‐ Computer Graphics 
    ‐ Data mining 
    ‐ Soft Computing 
    ‐ Web based applications 
 
 我們發表的論文主要是探討 1) Communication Basic and Infrastructure 的
network architecture 與 communication protocols。 
▬ 議程進行探討議題：議程安排主要分為下列議題，條列如下： 
 Wireless Networks 
 Image Processing 
 Web Applications 
 Software Engineering 
 Information Security 
 Systems and Architecture 
 Networking 
 Parallel and Distributed Computing 
 E- Technologies 
 Data Mining 
 Data Compression 
 Artificial Intelligence 
 
 4
五、攜回資料名稱及內容 
▬ 論文集光碟(名稱為 Proceedings of The Second International Conference on 
Digital Information and Communication Technology and its Applications 
(DICTAP 2012))：其中收錄了 98 篇論文。 
▬ 相關論文收錄在 IEEE Xplore 
 
六、其他 
▬ 無 
 
  
Abstract—With the media-independent pre-authentication 
(MPA), a mobile node (MN) performs the pre-authentication 
and pre-configuration to get the new care-of-address (nCoA) 
as the layer 3 handover before the layer 2 handover, in order 
to lessen handover delay. However, in reality, the MN may 
perform the layer 2 handover due to the link going down 
before completing the layer 3 handover. It will cause the 
packet loss if there are packets destined to the MN with the 
old care-of-address (oCoA). To avoid packet loss, the MPA 
can be enhanced with redirect tunneling (RT), denoted by 
MPA-RT. Before performing the link layer handover, the MN 
would request the old access router (oAR) to create a 
redirect tunnel with the new access router (nAR) after 
deleting the proactive handover tunnel (PHT) that was built 
between the MN and the nAR. Then the oAR will forward 
data packets to the nAR via the redirect tunnel. The nAR also 
starts to buffer those packets until the MN completes the link 
layer handover, and flushes the packets to the MN. In 
addition, we integrate the MPA-RT with media independent 
handover (MIH) and session initiation protocol (SIP) to 
provide a seamless handover for SIP applications. Simulation 
results shows that the cross-layer handover can significantly 
reduce the packet transmission delay and the temporary 
packet buffer size, as compared with current alternatives. 
 
Keywords-handover, pre-authentication, tunneling, cross-layer, 
SIP.  
I. INTRODUCTION 
n the next generation network (NGN), mobile devices or user 
equipments would roam seamlessly across wireless 
networks through different technologies such as IEEE 802.11 
(WLAN), IEEE 802.16 (WiMAX), CDMA, GSM, LTE, and so 
on. To provide the continuous service in mobile environment, 
the IETF Mobile Working group drew up a standard called 
Mobile IP (MIP) [1]. Several shortcomings in MIP have been 
discussed, such as handover delay and packet loss.  
There are numerous mobility-related papers for minimizing 
the handover latency. In [2], H. Fathi et al. provided an 
optimized mobility management solution to reduce handover 
delay and packet loss. K. El Malki [3] and R. Koodli [4] also 
discussed the mobility optimization mechanism for Mobile 
IPv4 and Mobile IPv6. The context transfer protocol (CTP) by 
J. Loughney et al. [5] allows user information to be transferred 
between access nodes to reduce the authentication and register 
delay. In addition, SIP [6] is used to assist the Mobile IPv6 
(MIPv6) protocol [7]. However, there is still a lot of space for 
improvements to minimize the handover latency [8]. 
In a mobile environment, handover means the process of an 
MN moving from the original access point to another while 
keeping an ongoing call or data session. It may cause signaling 
delay and packet loss due to the delay of layer 2 (link layer) and 
layer 3 (network layer) re-association. The authentication of 
layer 3 consumes most time in the handover. Recently, A. 
Dutta et al. proposed the media-independent pre-authentication 
(MPA) [9] to assist the MN to perform the layer 3 handover 
before the layer 2 handover in order to lessen handover delay. 
The performance improvement of MPA-based handover 
compared with MIPv6 can range from 85% to 99.65% [10]. It 
is easy to realize that MPA will play an important role in the 
NGN. However, in reality, the MN may not perform the MPA 
procedure in an ordinary way. That is, the MN may perform the 
layer 2 handover due to the link going down before completing 
the layer 3 handover. It will cause the packet loss if there are 
packets destined to the MN with oCoA. Worst of all, both of 
the sender and the receiver would have to query their 
corresponding home agents (HAs) for each other’s IP 
addresses due to the loss of binding update packets when 
dealing with simultaneous mobility [11]. It not only leads to the 
packet loss but also increases the handover delay. 
There are many papers addressing the packet loss problem 
over the past years. They can be roughly classified into two 
types of mechanism: buffering and tunneling. As an example of 
the buffering mechanism, a concept of dynamic buffering [12] 
was proposed to reduce the packet loss in MPA, denoted by 
MPA-DB. The MN would inform the oAR to buffer the 
packets destined to the MN (with oCoA) when the MN 
performs the layer 2 handover. Although MPA-DB can 
efficiently avoid the packet loss, the buffered packets at the 
oAR will be forwarded to the MN (with nCoA) through the 
nAR until the MN completes the layer 2 handover. The delay 
for forwarding the buffered packets in MPA-DB should be 
shortened.  
Fast handover in Fast Mobile IP (FMIP) [3] was proposed by 
IETF as an example of the tunneling mechanism. It builds the 
tunnel between the oAR and the nAR. During the handover, the 
packets destined to the MN (with oCoA) would be tunneled to 
and buffered at the nAR before the MN completes the layer 2 
Cross-Layer Handover for SIP Applications based on 
Media-Independent Pre-Authentication with Redirect Tunneling 
Wei-Kuo Chiang, Hung-Jiun Dai and Cheng Luo
Department of Computer Science & Information Engineering, National Chung Cheng University, 
Chiayi 621, Taiwan, R.O.C.  
wkchiang@cs.ccu.edu.tw, kevinb2204@gmail.com, tommyjeans42@hotmail.com 
I
978-1-4673-0734-5/12/$31.00 ©2012 IEEE                                                                                 348
  The MN would send a request to the oAR to create the RT 
tunnel before starting the layer 2 handover. The packets 
received by oAR are carried in an IP tunnel between the 
oAR and the nAR. These encapsulated packets will use the 
nAR address as the destination IP address. The architecture 
of MPA-RT is shown in Figure 2. 
 The MN would send a request to the CN to update the 
binding. Once receiving the request, the CN must reply a 
binding response to the MN. The MN will decide the 
completion of the binding update by checking if it has 
received the response packet from the CN. The MN would 
send the complete binding update (CBU) message to the 
oAR while receiving the response packet.  
 After the oAR receives the CBU message from the MN, it 
would check whether there are packets destined to the nAR 
in the buffer or not. If there still have packets in the buffer, it 
will continue to forward them to the nAR until the buffer is 
empty. Otherwise, the oAR will delete the RT tunnel.  
 
Figure 2. The MPA-RT architecture. 
B. Flow Chart of MPA-RT on MN 
At the beginning, the MN performs the pre-authentication 
and pre-configuration procedure due to the link going down 
(steps 1-3), as shown in Figure 3(a). After the three steps are 
completed, the PHT is established between the MN and the 
nAR. The MN sends the binding update to the CN over the 
PHT (step 4). Steps 1-4 is the basic procedure of MPA. The 
MN keeps detecting the link strength to decide when to 
perform the layer 2 handover (step 5). 
When the MN detects the link going down and have to hand 
over, the MN would delete the PHT tunnel between the nAR 
and the MN (step 6), and check if it has received the binding 
update response from the CN (step 7). If done, the MN 
performs the layer 2 handover (step 9), and terminates the 
following MPA-RT steps. Otherwise, the MN would notify the 
oAR to create a RT tunnel between the oAR and the nAR (steps 
8-9). 
After the MN completes the layer 2 handover, the MN would 
send flushing message to nAR (steps 1-2), as shown in Figure 
3(b). If the RT tunnel has been created, the MN would check if 
the response message has been received. After that, the MN 
will send the CBU packet to the oAR (steps 3-5). 
 
Start
Perform
Pre-
authentication
Perform
Pre-
configuration
Create PHT &
send session 
request to server 
Perform the
layer 2 
handover
Complete layer 2 
handover
Receive the 
response
Already create a  
RT tunnel
Send the CBU
to the oAR
End
Handling before executing the layer 2 handover 
Handling after completing the layer 2 handover 
Notify oAR to 
create RT tunnel
Send Delete 
PHT packet to 
the nAR 
Receive 
response
from the CN
Detect
link going 
down
Detect QoS going 
down
No
MPA
No
Yes
Yes
Send  flushing 
message to the 
nAR
Yes
No
Yes
No
 
Figure 3. Flow chart of MPA-RT on MN. 
C. Flow Chart of MPA-RT on AR 
As shown in Figure 4(a), the oAR not only forwards the 
received packets but also monitors the packets (steps 1-2). 
Once the oAR receives the Create RT tunnel message, it will 
create the RT tunnel with the nAR (steps 3-4). After creating 
the RT tunnel, the oAR would forward those packets destined 
to the oMN to the nAR until the tunnel is released (step 5) as 
well as monitor the CBU packet from the MN (step 6). Once 
the oAR receives the CBU, it will check the buffer for the 
nMN. The oAR will delete the RT tunnel while the buffer is 
empty. 
As shown in Figure 4(b), the nAR works as the same as that 
in the MPA. After performing the pre-configuration, the nAR 
creates a PHT tunnel (step 1) to encapsulate the packets 
destined to the nMN to the oMN (step 2). The nAR will receive 
the delete PHT message from MN when the MN starts the layer 
2 handover (steps 3-4). The nAR then buffers the packets 
destined to the nMN after deleting the PHT (step 5). When the 
MN completes the layer 2 handover, the nAR would flush the 
packets to the nMN (steps 6-7). 
 
978-1-4673-0734-5/12/$31.00 ©2012 IEEE                                                                                 350
 B. Packet Transmission Delay 
The packet transmission delay is the time for transmitting 
packets from the CN to the MN. As shown in Table 4, 
MPA-RT could perform better than MPA-DB. MPA-RT could 
reduce the packet transmission delay since these packets 
received at the oAR are forwarded to and buffered at the nAR 
before the layer 2 handover completes. The transmission delay 
between the nAR and the nMN is shorter than that between the 
oAR and the nMN. 
C. Buffer Size 
The required buffer sizes on the oAR and the nAR inFMIP, 
MPA-DB and MPA-RT are also evaluated, as shown in Table 5. 
The buffer size in FMIP is larger than others due to its longer 
layer 2 delay. In MPA-DB, the oAR would buffer packets 
destined to oMN during the layer 2 handover; therefore, the 
oAR needs a larger space to store the packets. By contrast, in 
MPA-RT, the packets are forwarded from the oAR to the nAR 
and buffered at the nAR during the handover.  
MN oAR CN 
MPA MIHF
IS
SIP RT User RT Handler
nAR
AA CA PHT Buffering
RT tunnel
Disconnect
Connect
2. Set threshold: thr1,thr2
1. Subscribe request
4. Get info request
5. Get info request
6. Get info response
7. Get info confirm
14. Signal strength<thr2
9. Pre-configuration
10. Pre-configuration[tunnel] management protocol to establish PHT
15. Delete PHT tunnel
19. The packets send before binding updae
20. Tunnel the packets with oCoA
24. Forward packet to MN (including SIP 200 OK)
26. CBU
13. BUP
18. Create RT tunnel
23. Notify nAR to forward buffered packets
25. BUA
21. SIP 200OK
12. SIP INVITE Ω transmission over PHT 
11. Notify get nCoA 
22. Send packets with  nCoA
3. Signal strength<thr1
8. Pre-authentication
17. Handover notify 16. Notify to buffer
MIH
MPA
MPA-RT
 
Figure 6. Message flows of SIP handover based on MPA-RT.
978-1-4673-0734-5/12/$31.00 ©2012 IEEE                                                                                 352
國科會補助計畫衍生研發成果推廣資料表
日期:2012/11/04
國科會補助計畫
計畫名稱: 網際網路協定多媒體子系統上網路移動技術之研究
計畫主持人: 江為國
計畫編號: 99-2221-E-194-037-MY2 學門領域: 計算機網路與網際網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
