1 
 
一、前言 
吾人已知應用完整通道資訊於現代無線通訊系統設計可將系統性能達到最
佳化狀態[1], [2], [3]。因此，針對傳送功率限制的情況下，應用通道資訊克服符
碼間干擾之預編碼器設計便吸引很多學者的研究。然而，無論是使用單輸入單輸
出或多輸入多輸出通訊系統，利用完整通道資訊之聯合傳收機設計研究大都是針
對系統使用足夠冗餘資料量(sufficient redundancy)，即在區塊傳輸間插入的冗餘
資料量是比通道階數要來的大許多。以線性接收機而言，斜投影架構(oblique 
projection framework)的提出使得吾人可使用最低冗餘資料量並在迫零等化機制
下設計達成系統位元錯誤率最小化之線性單基底預編碼器[4]。其相關設計方式
亦可應用於區塊內最小均方誤差等化機制及其它系統性能表現，如高斯相互資訊
量最大化問題[5], [6]。近年文獻研究成果顯示，利用非線性傳收機的架構，在限
定足夠冗餘資料量的情形下，其系統性能可透過最佳化設計提昇線性傳收機的極
限[7]-[9]。有鑑於此，本計畫乃探討應用已發展斜投影技術之相關線性傳收機研
究於開發新型式非線性接收機(特別著重區塊內決策回授等化機制)，並依提出之
新型式具區塊延遲偵測(block delay detection)接收機設計最佳線性預編碼器。 
 
二、研究目的及文獻探討 
綜觀預編碼器設計之相關研究文獻可知，對一使用有限大小(finite-size)之
區塊傳輸多輸入多輸出通訊系統在有限傳送功率限制下，迫零及最小均方誤差
等化條件之單區塊基底預編碼器及其對應之等化器已可獲得閉合解(closed-form)
表示式[10], [11]。特別值得一提的是，在迫零等化條件下，吾等提出之斜投影
架構可以設計出使用最低冗餘資料量並達到最低平均位元錯誤率之單區塊基底
預編碼器[4]-[6]。從文獻[4], [10]的證明可知，上述的設計結果會得到一個非對
角化之通道矩陣。倘若考慮線性傳送機與線性接收機使用迫零及最小均方誤差
等化機制，則傳收兩端高斯相互資訊量(Gaussian mutual information)最大化之預
編碼器設計將會得到一個對角化通道矩陣;而這一預編碼器設計正是形成一最佳
非托普立茲(non-Toeplitz)相關矩陣之頻譜朔型器[12]。從這些文獻結果顯示預編
碼器設計滿足最低平均位元錯誤率及最大高斯相互資訊量所得之通道矩陣，並
不一致而需權衡考量。另外，從文獻[7]-[9]中所得到結果說明，若利用非線性
傳收機架構，亦即當使用非線性預編碼器[7]或使用區塊內決策回授等化器[8]，
其聯合傳收機最佳化的設計是可以同時達成最低位元錯誤率與最大相互資訊
量。然而，我們注意到上述的非線性傳收機最佳化設計並未探討區塊間干擾存
在的環境而僅適用於區塊間干擾不存在(即多輸入多輸出通訊系統之區塊傳輸使
用足夠冗餘資料量)。並且，這些最佳化成果都是針對一個瞬時傳送區塊且伴隨
給定之區塊內符碼間干擾通道矩陣所做的設計，即探討針對無延遲之傳送區
塊。最近，從吾等研究結果顯示[5], [6]，一個線性傳收機系統之聯合最佳化設
計的位元錯誤率性能表現可以藉由設計針對某一特定延遲區塊而提昇。因此，
綜上討論，本計畫的研究動機乃考慮在具有區塊間干擾環境及有限傳送功率限
3 
 
夠冗餘資料量，式(1)之第二項則可被化簡消除。若能依上述設計，則 y(n)是可被
化簡後利用接收單個區塊處理即可回復 s(n)訊號[18]。 
 
Detector
)(ˆ ns )(~ ns
B
)(nQy
dW
d
CSI   ,TP
+
−
QPM ×
MM ×  
圖(二):  提出具區塊延遲偵測之新型式決策回授等化器。 
 
3.2 提出之新型式決策回授等化器 
圖(二)為本計畫提出之新型式決策回授等化器(DFE)架構，包含三個組成單
元:一個饋前(feedforward)矩陣 dW ，一個區塊內回授(feedback)等化矩陣 B，及一
個符碼檢測器。本計畫所提出之 DFE 與文獻[8]用於設計預編碼器不同。相較於
[8]中的等化器每次透過 MM × 饋前矩陣處理單區塊接收訊號 y(n)(如 3.1 節所
述，在假設足夠冗餘資料量之條件下)，本計畫之 DFE 則設計每次透過 QPM × 饋
前矩陣 dW 接收處理連續 Q 個區塊接收訊號，而 MM × 區塊內回授等化矩陣 B 與
檢測器則以單區塊為基準操作方式(類似於[8], [13]之操作方式)。因此，矩陣 B
內的元素則是饋前矩陣 dW 等化輸出區塊用來減去已完成檢測符碼的權重係數。
特別地，本計畫設計矩陣 B 為一個 MM × 嚴格下三角形矩陣，其內元素安排如
下式 
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
=
−−−− 0
00
000
0000
)2)(1(1)1(0)1(
2120
10
MMMM bbb
bb
b
L
OMM
MOO
L
L
B . 
利用上述所提出 DFE 內的組成單元，針對具有區塊延遲 d 之傳送區塊，即
)( dn−s ，本計劃將設計實現饋前矩陣 dW 以消除區塊間干擾效應並建立可結合單
區塊等化之區塊內決策回授等化器(B 與檢測器)的訊號模型，以實行區塊內符碼
間干擾等化機制。 
為便於說明，我們定義連續 Q 個接收區塊 y(n)為 =)(nQy vec([y(n－Q+1),…, 
y(n)])。同樣地， )(nQv 則定義為連續 Q 個雜訊區塊 v(n)。另外，我們定義在 )(nQy
中形成與式(1)之HE0及HE1相關之通道矩陣為H，並假設維度為 )( KQMQP +× 且
是一個全行秩(參數 K 的大小則取決冗餘資料量形式，參見[4], [5]之推導)。若 )(~ ns
表示所提出DFE之第n個檢測輸出符碼區塊，則將所提出DFE架構作用於 )(nQy
5 
 
因此我們可以利用式(5)做分區塊互斥偵測符碼。定義 )()(ˆ)( dnnnd −−= sse 為本計
畫提出 DFE 輸出與待偵測區塊 )( dn −s 之誤差。假設在此 DFE 內所偵測到之符碼
均正確無誤[8 與其內文獻普遍使用之假設](也就是說，當我們試圖在 10 −≤≤ ki
中偵測 kn)](ˆ[s 時， =in)](~[s idn )]([ −s 是假設成立的)。依照定義與運用式(4)， )(nde
可寫成 
)()()()( ndnn dMdd WvsBIFWUe += --- . 
接下來，我們將應用文獻[15]之位元錯誤率分析結果來求出最佳 d 值。再一次地
假設本計劃提出 DFE 過去所偵測之符碼均是正確無誤(此假設普遍使用於文獻
上，如上所述)，則對一個在高斯雜訊下之 N-ary 方正 QAM 星狀符碼而言(其中
位元轉換成符碼是使用 Gray 映射關係且在 dU 區塊內之等效符碼間干擾是高斯
分佈)，則第 i 個被檢測符碼 in)](~[s 之位元錯誤率可以非常近似地寫成[15] 
)/ (3 )/( βηerfc κβηerfcαP iiie +≈ , 
其中， NNα 2log/)11(2 −= ， 3/)1(2 −= Nβ 及 NNκ 2log/)21(2 −= 為一給定 N
之常數， ∫∞ −= ζπζ dxeerfc x2)2(:)( ，而 iη 表示檢測器輸入之第 i 個等化符碼 kn)](ˆ[s
的訊號與雜訊比(SNR)。於是，偵測區塊內符碼的平均位元錯誤率 aeP 可以表示成 
∑−
=
≈
1
0
1 M
i
ieae PM
P ∑∑ −
=
−
=
+=
1
0
1
0
)/ (3  )/(  
M
i
i
M
i
i βηerfcM
κβηerfc
M
α
.  (6) 
若 )(nde 之共變異矩陣定義為 )]()([ nnE Hddd eeRe = ，則我們可以得到滿足區塊內迫
零及最小均方誤差之共變異矩陣[16]，分別以 )ZF(deR 及 )MMSE(deR 表示之。依據文
獻[8], [10]的結果，對一個特定 d 值，我們可以類似地推導得到滿足區塊內迫零
及最小均方誤差等化機制之訊號雜訊比與 )ZF(deR 及 )MMSE(deR 之關係，即
iii dη ]/[1 )ZF()ZF( eR= 與 1]/[1 )MMSE()MMSE( −= iii dη eR ， 其 中 10 −≤≤ Mi 且
1][0 )MMSE( <≤ iideR 。以區塊內迫零等化條件為例，若將上述 )ZF(iη 代入式(6)，則我
們可觀察到當 iid ][ )ZF(eR 足夠小時(即等化後之符碼 SNR 落在中至高範圍)，則式(6)
中 aeP 為 iid ][ )ZF(eR 之凸面函式(convex function)。因此，若定義 )ZF(aeP 為區塊內迫零
等化條件之 aeP ，則 )ZF(aeP 受下限制於 
)ZF(LB_)ZF( aeae PP ≥ ))tr( (3 ))tr(( )ZF()ZF( dd β
Merfcκ
β
Merfcα
ee RR
+= . (7) 
式(7)之結果乃應用傑森不等式(Jensen＇s inequality)[17]，且等號成立於若且為若
)ZF(deR 之對角線元素均相等。同理，若考慮區塊內使用最小均方誤差等化機制，
7 
 
依據上面所建立的結果，一旦得到式(9)或式(10)的位元錯誤率最小化區塊延
遲，則相對應式(4)的饋前矩陣及式(5)的訊號模型均可依此 d 值建構完成。再者，
本計畫所提出之 DFE 在此最佳區塊延遲下之相對最佳 F, W 與 B 則可進一步推
導獲得[註 1]。另外，值得一提的是在區塊內使用最小均方誤差等化機制下，使
用本計劃所提出之新型式 DFE 設計傳收機時，式(10)之最佳區塊延遲不但能達成
系統最低平均位元錯誤率，亦同時能達成最大化高斯相互資訊量(Gaussian mutual 
information)[註 1]。 
本計畫為簡化系統擷取最佳區塊延遲偵測之複雜度，進一步分析上述式(9)
及式(10)之性能表現，結果說明如下。定義 MMnnEe dHddd )/tr()])/()([tr(:2 eRee == 表
示偵測器輸入之算術均方誤差，則分別用符號 2 )ZF_L(de 與 2 )MMSE_L(de 表示區塊內使
用迫零與最小均方誤差等化機制。假設對一個特定 d 值，傳輸功率 TP 足夠大到使
得式(10)中的 rd 滿足 Mrd = ，則[註 1] 
1
2
)ZF_L(
2
)MMSE_L( 1
1
−
⎟⎟⎠
⎞
⎜⎜⎝
⎛ +≤
d
d e
e .  (11) 
因此，根據式(11)的結果，若利用通道資訊計算獲得式(9)之 ZF min-BERd ，吾人可應用
本計劃提出之新型式 DFE 設計一個滿足區塊內使用最小均方誤差等化機制且在
ZF
min-BERd 下之傳收機滿足條件 
ZF
min-BER
2
)MMSE_L( dd
ed =
11
ZF
min-BER
2
)ZF_L( 1
−−
⎥⎥⎦
⎤
⎢⎢⎣
⎡
+⎟⎟⎠
⎞
⎜⎜⎝
⎛
=≤ dded . (12) 
由於 2 )MMSE_L(de 及 2 )ZF_L(de 均可被證明能利用相關傳收機設計方法來達成，因此若
在中至高訊號雜訊比情況使用 ZF min-BERd ，則應用式(12)與式(7)的結果可以保證得到
條件 )ZF((MMSE) aeae PP ≤ 。觀察式(9)與式(10)，當獲得通道資訊後，計算式(9)比式(10)
要簡單許多。因此，依據上述的討論結果與優點，吾人可設計一個次最佳
(sub-optimum)區塊內最小均方誤差等化機制之新型式 DFE－即選擇於 ZF min-BERd 下
而非 MMSEmin-BERd 下，設計滿足區塊內最小均方誤差等化機制之新型式 DFE。透過下節
之電腦模擬，我們可以呈現出所提出次最佳區塊內使用最小均方誤差等化機制之
新型式 DFE 的 BER 表現與最佳區塊內最小均方誤差等化機制之新型式 DFE 的
BER 表現在大多數訊號雜訊比下幾乎相同。 
 
四、結果與討論 
本節我們設計幾個電腦模擬以驗證本計劃提出新型式 DFE 所設計最佳化傳
收機之系統位元錯誤率性能表現。我們分別探討冗餘資料量為 TZ 與 CP 系統並
9 
 
區塊內使用最小均方誤差等化機制之新型式 DFE 的可行性。 
2 3 4 5 6 7 8 9 10 11
10
-5
10
-4
10
-3
10
-2
TZ systems
Eb/No(dB)
B
E
R
 
 
Proposed DFE-MMSE(Q=2)
Proposed DFE-MMSE(SP)(Q=2)
Proposed DFE-MMSE(ZF)(Q=2)
Proposed DFE-MMSE(Q=3)
Proposed DFE-MMSE(SP)(Q=3)
Proposed DFE-MMSE(ZF)(Q=3)
 
圖(四): 所提出之 DFE-MMSE 使用不同區塊延遲於 TZ 系統 
之 BER 性能表現。 
 
圖(五)及圖(六)則是我們另使用參數 8=M , 13=P 及 11=L 於 CP 系統以驗證
本計畫提出之設計。如圖(五)所顯示，分別在 2=Q 或 3=Q 情況下，本計劃所提
出之 DFE-MMSE 的 BER 性能仍是在所有 0/ NEb 的範圍內表現最佳。並且，無論
是 2=Q 或 3=Q ，當 0/ NEb 漸增加時，本計畫所提出之 DFE-ZF 的 BER 表現仍是
漸趨近於提出之 DFE-MMSE 的 BER 表現。根據圖(六)的結果，我們可以看出在
此模擬條件下，本計畫所提出之 DFE-MMSE 與 DFE-MMSE(ZF)兩者的 BER 性
能相同，而 DFE-MMSE(SP)之 BER 則不如其它兩者優異表現，特別是在低 0/ NEb
值。為了進一步深入觀察並驗證本計畫所提出之次最佳區塊內使用最小均方誤差
等化機制之新型 DFE 的適用性與強韌性，我們使用參數 14=M , 18=P 及 6=L 並
實現圖(六)內所有相關設計，如圖(七)所示。從圖(七)可看出，對於 2=Q 的情況
下，各個設計的 BER 性能表現優劣大致與圖(六)顯示相當。然而，對於 3=Q 的
情況下，所提出之 DFE-MMSE(ZF)之 BER 性能表現仍在所有 0/ NEb 的範圍內相
當接近於 DFE-MMSE 之 BER 性能表現；但是 DFE-MMSE(SP)之 BER 性能只能
在高 0/ NEb 的情形下表現與 DFE-MMSE 之 BER 性能一樣。這些結果，無異再一
次證實本計畫所提出次最佳區塊內使用最小均方誤差等化機制之新型式 DFE 的
可行性，也驗證 ZF min-BERd 與 MMSEmin-BERd 未必相同。 
本計畫的研究為運用通道資訊以設計最佳化聯合傳收機。我們利用近年的研
究成果應用斜投影架構技術[4]-[6]提出一具區塊延遲偵測之新型式決策回授等
化器，並利用其消除區塊間干擾的能力以設計達成最低平均位元錯誤率之最佳預
編碼器。在有限傳送功率的條件下，我們建立可達成區塊內迫零與最小均方誤差
11 
 
4 5 6 7 8 9 10 11 12
10
-6
10
-5
10
-4
10
-3
10
-2
CP systems
Eb/No(dB)
B
E
R
 
 
Proposed DFE-MMSE(Q=2)
Proposed DFE-MMSE(SP)(Q=2)
Proposed DFE-MMSE(ZF)(Q=2)
Proposed DFE-MMSE(Q=3)
Proposed DFE-MMSE(SP)(Q=3)
Proposed DFE-MMSE(ZF)(Q=3)
 
圖(七): 所提出之 DFE-MMSE 在參數(P, M, L) = (18, 14, 6)下 
使用不同區塊延遲於 CP 系統之 BER 性能表現。 
 
五、參考文獻 
[1] G. G. Raleigh and J. M. Cioffi, “Spatio-temporal coding for wireless 
communication,” IEEE Trans. Commun., vol. 46, pp. 357-366, Mar. 1998. 
[2] A. Goldsmith, S. Jafar, N. Jindal, and S. Vishwanath, “Capacity limits of MIMO 
channels,” IEEE J. Sel. Areas Commun., vol. 21, pp. 684-702, June 2003. 
[3] E. Telatar, “Capacity of multi-antenna Gaussian channels,” Eur. Trans. Telecomm. 
ETT, vol. 10, no. 6, pp. 585-596, Nov. 1998. 
[4] C. -H. Wu and S. J. Chern, “Minimum BER block-based precoder design for 
zero-forcing equalization: An oblique projection framework,” IEEE Trans. 
Signal Processing, vol. 55, no. 12, pp. 5630-5642, Dec. 2007. 
[5] C. -H. Wu, “The precoder design for intrablock MMSE equalization and block 
delay detection with a modified oblique projection framework,” IEICE Trans. 
Fundamentals, vol. E94-A, no. 2, pp.829-832, Feb. 2011. 
[6] C. -H. Wu, “Algorithm of determining BER-minimized block delay for joint 
linear transceiver design with CSI,” IEICE Trans. Fundamentals, vol. E95-A, no. 
3, pp.657-660, March 2012. 
[7] A. D’Amico, “Tomlinson-Harashima precoding in MIMO systems: a unified 
approach to transceiver optimization based on multiplicative schur-convexity,” 
IEEE Trans. Signal Processing, vol. 56, no. 8, pp. 3662-3677, Aug. 2008. 
[8] F. Xu, T. N. Davidson, J. –K. Zhang, and K. M. Wong, “Design of block 
transceivers with decision feedback detection,” IEEE Trans. Signal Processing, 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/12
國科會補助計畫
計畫名稱: 多輸入多輸出通訊系統結合一新型區塊內決策回授等化器之功率效益型預編
碼器設計
計畫主持人: 吳俊賢
計畫編號: 100-2221-E-468-015- 學門領域: 網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
