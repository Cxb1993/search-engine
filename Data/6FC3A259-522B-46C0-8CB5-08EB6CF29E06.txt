studied for the cost function used in matching 
pursuit. When the dictionary is composed of the Gabor 
functions, we propose a stochastic algorithm of 
optimization for finding the most matching 
components. Our experiment shows that the proposed 
stochastic algorithm can improve the convergence of 
matching pursuit in average. It is straightforward to 
apply the proposed algorithm to chirplet dictionary. 
英文關鍵詞： sparse signal representation, matching pursuit, 
stochastic optimization 
 
 2
 
一、前言 
 
傳統上，最為人所習知且常用的訊號分解方法是傅立葉轉換(Fourier transform)，傅立葉轉換
將訊號分解為弦波訊號的組合，這些弦波訊號具有不同的頻率，透過對於這些弦波訊號成份的分
析，可以對於訊號進行壓縮、分類、或是參數估計。但是傅立葉訊號分析法的缺點在於難以處
理頻率隨著時間而變化的訊號，對於持續時間很短的訊號，也就是接近於脈衝(impulsive signal)
的訊號，傅立葉方法也難以精確地對其進行分析。為了解決這些困難，近年來許多學者提出了
各種新的方法與理論，例如短時傅立葉分析(short-time Fourier analysis)、小波轉換(wavelet 
transform)、稀疏訊號表示法(sparse signal representation)等技術，用來分析特徵會隨著時間而
變化的訊號，不論是理論上的探討、軟體演算法的分析，或是實作上的設計考量，這些新方
法均有大量的研究成果。 
 
眾所皆知，任何訊號 y 皆可表示成某一空間描述矩陣(representation basis/dictionary 
matrix) D與一係數向量x的乘積，即 y = Dx，此係數向量x 為訊號 y在空間描述矩陣D中的
座標。而所謂的稀疏訊號是指對於某個選定的空間矩陣，其座標向量x 中的係數大部分均等
於零，或甚小於其他係數。換言之，此稀疏訊號可以用空間矩陣中極少數的分量所疊加
(superposition)而成。此時，係數向量x 則稱為訊號 y在空間描述矩陣A 上的稀疏表示(sparse 
representation) 。在某個描述矩陣D中具有稀疏特性的訊號，其表達式的資料可以經過壓縮
並完整還原，壓縮後的資料量可以遠遠低於傳統訊號處理採用 Nyquist’s rate 取樣的結果。
較為特殊的是，在稀疏訊號處理中使用的線性組合描述法並不一定為線性獨立系統(linear 
independent system)，換言之，空間描述矩陣不一定形成基底(basis)，因此，對於此空間矩陣，
同一個訊號可能有多個表達式(多個係數矩陣)。在稀疏訊號分析中，常把此描述矩陣D稱為
原子庫(dictionary)，其行向量稱為原子(atom)。  
 
 
二、研究目的 
 
由以上背景介紹可以得知，在原子庫中尋找最少量的原子以表示任一給定的訊號 y是稀
疏訊號分析中最基本且重要的工作之一。在實作上，最稀疏的表示法即在滿足 y = Dx 的條
件下，尋找x的 0L -norm 的最小值。傳統訊號處理技術中大多採用 2L -norm，和此不同之處
在於 0L -norm 強調了訊號 “稀疏程度” (sparsity)的重要性。稀疏訊號分解過程中應該尋找
0L -norm 的最小值，以取得最高的稀疏程度，這是理想情形，然而 0L -norm 的最佳化問題已
被證實為一個 NP-hard 的問題，在實作上顯得不切實際。已有學者證明，亦可透過 1L -norm
尋找訊號的稀疏表示式，因為 1L -norm 的最佳化問題可轉化為線性規劃的問題，因而大大的
降低了問題的複雜度，也提高了稀疏訊號處理的實用性。 
 
    Mallat 與 Zhang 提出了尋找近似最佳解的貪婪演算法(greedy algorithm)，稱為匹配逼近演
算法(matching pursuit)。匹配逼近演算法使用簡單的向量內積(inner product)，尋找原子庫中與
給定訊號內積較高的分量，將該分量的成分從訊號中扣除，重複此步驟直到訊號被完全分解或
者滿足某些終止條件為止，例如誤差低於某個給定或閥值，或是尋找到的原子數多於某個給定
的數目，均為典型的終止條件。匹配逼近演算法簡述如下： 
 
 4
佈於參數空間，P. Durka、D. Ircha 和 K.J. Blinowska 則提出了隨機原子庫的概念[4]，其參數
( , , )s u ω 是隨機分佈於某個範圍內，據此以解決某些訊號在作分解時所遇到的偏差(bias)問
題。Elad 和 Yavneh 提出了另一種隨機原子庫的概念[5]，在實作原始的匹配逼近演算法時，
每一步所找到的原子是和剩餘訊號有最大內積值的原子，這是決定性(deterministic)，而非隨
機的，Elad 和 Yavneh 的作法是隨機產生每一步所找到的原子，每個原子的出現機率則和其
用於合成訊號時所產生的誤差有關，Elad 和 Yavneh 證明了這樣的選法等效於選取具有最小
均方誤差(minimized mean squared error, MMSE)的解，對於去除訊號雜訊(denoising)相當有
效。 
 
以上提到在實作原始的匹配逼近演算法時，參數 ( , , )s u ω 通常都是採用均勻取樣以建立
原子庫，Mallat 和 Zhang 提到可以利用牛頓法以近一步逼近具有更大內積值的原子[1]，實
際上這是一個最佳化的問題，目標函數是訊剩餘號與原子訊號的內積，在實作上，匹配逼
近演算法所產生的最佳化的問題通常具有許多的區域最大/小值，因此如何有效地跳過這些
區域最小值而求得全域極值成為了一個值得研究的問題。Yi Sun et. al 介紹了一種隨機演算
法[6]，可用來求得區域最大/小值，在這個類似於最陡梯度法的演算法中，其梯度的調整是
用某個隨機變數的平均值決定，為了更細微地調整梯度步階值，Yi Sun et. al 也利用了自然
梯度(natural gradient)[7,8]，其梯度的方向總是指向變化最大的方向，在計算自然梯度時必須
估計該問題的 Fisher information，並計算此 Fisher 矩陣的反矩陣。 
 
 
四、研究方法 
 
 此研究中對於匹配逼近演算法進行探討與改進，以 Gabor 原子庫為例，給定輸入訊號
( )f t ，目標在於將 ( )f t 展開成以下的表示式 
 
1
0
( ) ( ) ( )
M
M
k k
k
f t a g t f tθ
−
=
= +∑  
 
其中 ( ), ( )kk ka f t g tθ= 是展開式中的係數， ( , , , )k k k k ks uθ ω φ= 為第 k 次疊代所選取的參數
值， ( )kf t 是剩餘函數，改進的匹配逼近演算法表示如下： 
 
 
輸入參數：原子庫{ ( )}
j
g tθ 、輸入訊號 ( )f t  
初始值：疊代次數 0k = 、初始剩餘訊號 0 ( ) ( )f t f t= 、初始表示集合 0S = ∅  
主迴圈：  
步驟一：對於所有的原子，計算目標函數值 ( ) ( ( ), ( ))
j
kc j F f t g tθ=  
步驟二：找出使目標函數值達到極值的原子
0
( ) ( )
j k
g t g tθ θ≡ ，計算其係數
( ), ( )
k
k
ka f t g tθ= ，將其加入表示集合 ( ){ }1 , ( )kk k kS S a g tθ−= ∪  
 6
2 2 2 2
2 2
( ) / ( ) /
3
2 ( ) /
2 ( )cos( ) ( )cos( )
( )cos( )( )
t u s t u s
t u s
F f t t e dt f t t e dt
s s
A f t t t u e dt
π π
π
ω ω
ω
∞ ∞
− − − −
−∞ −∞
∞
− −
−∞
⎡ ⎤∂ ∂⎡ ⎤= ×⎢ ⎥ ⎢ ⎥∂ ∂⎣ ⎦⎣ ⎦
= −
∫ ∫
∫
 
上式中 
2 2( ) /
3
4 ( )cos( ) t u sA f t t e dt
s
ππ ω
∞
− −
−∞
⎡ ⎤= ⎢ ⎥⎣ ⎦∫  
 
使目標函數達到最大值的 s 值，可以透過以下疊代而達成 
 
1
3
k k
ss s k Fs
+ ∂= + ∂  
 
上式中 k 為疊代次數， sk 為一常數，s 的起始值為前述之離散參數，中止條件為 1| |k ks s ε+ − ≤ ，
ε 為某個預先設定的閥值，實作時，中止條件可搭配疊代次數的限制，以停止發散的情形。
接下來，由以上推導可知 
 
2 22 ( ) /
3
2 2
( )cos( )( )
[ ( )cos( )( ) ]
t u sF A f t t t u e dt
s
As f T T T u
πω
ω
∞
− −
−∞
∂ = −∂
= −
∫
E
 
 
上式中E[X]的符號代表隨機變數 X 的期望值，T 是呈現高斯分佈的隨機變數，平均值為 u，標準
差為 / 2s π 。因此，可以用蒙地卡羅法估計上述期望值： 
 
2 2
1
1[ ( )cos( )( ) ] ( )cos( )( )
P
p p p
p
f T T T u f T T T u
P
ω ω
=
− ≈ −∑E  
 
 
五、結果與討論 
 
 我們先以兩個訊號測試以上改進的匹配逼近演算法，第一個訊號為 
 
2 2 2 2
1 1 2 2
1/4 1/ 4
( ) / ( ) /
1 1 2
1 2
2 2( ) 2 cos( ) 1 cos( )t u s t u sf t e t e t
s s
π πω ω− − − −= × + ×  
 
其中 1 1 18, 64, / 4s u ω π= = = , 2 2 22, 32, / 2s u ω π= = = , 0,1,...,127t = 。第二個訊號為 
 
2 2
sin(2.5 sin(0.008 )), 0,1,...74,
( )
sin(0.112( 75) ), 75,76,...127
t t t
f t
t t
π π =⎧= ⎨ − =⎩  
 
圖 1 和圖 2 是這兩個測試訊號的波形圖。我們以訊號 1( )f t 測試改進的匹配逼近演算法是否能正
 8
圖 8 是圖 7 的細部，由圖 7 與圖 8 可見，隨機最佳化平均而言對於目標函數 2F 也產生效果。 
 
 為了進一步探討隨機最佳化的行為，我們也測定了演算法的收斂情形，在我們的演算法實
作中，一旦收斂值與初始值的誤差大於初始 s 值的二分之一，則判定收斂失敗，否則為成功，
我們使用一測定量以分析收斂情形，稱為收斂比。收斂比的定義為執行最佳化過程中的收斂成
功次數與總執行次數的比值。當收斂比接近於 1.0 時，代表幾乎每一次執行隨機演算法都收
斂，而當收斂比很小時，代表隨機演算法的收斂結果錯誤，程式還是使用初始值進行後續
的計算。發生收斂比很小的情形大部分是因為演算法發散，因而達到疊代次數的限制而終
止，當收斂比很小或是很大時都代表隨機演算法可能使用了不良的初始條件，或是並未正確執
行蒙地卡羅法，表 3 是不同步階常數下的收斂比。由表 3 可知，當步階常數增加時，收斂比隨之
減少。雖然收斂比不能直接代表收斂效果，但是可以作為檢查各種設定的指標。由圖 5、6、7、
8 可以發現，當 0.5sk = 時，我們所提出的隨機最佳化演算法有最佳效果，此時執行演算法時約
有 80%的次數收斂。 
 
 
表 3. 不同步階常數下的收斂比 
步階常數 0.1sk =  0.2sk =  0.5sk =  1.0sk =  2.0sk =  
收斂比 0.9985 0.9370 0.7854 0.5166 0.3304 
 
 
 利用訊號 1( )f t 與 2( )f t 測試目標函數 1F 和 2F 的收斂情形時，都只呈現出這兩個特定函數
的分解結果，為了進一步確認目標函數 1F 和 2F 的收斂情形，我們使用了隨機訊號進行測試，
測試方式是產生 20 組長度為 128 的高斯白雜訊，其平均值為零，標準差為 1，然後分別用 1F
和 2F 進行分解，並計算其收斂曲線，圖 9 呈現出這些收斂曲線的平均值，由圖 9 可見，對
於隨機訊號，目標函數 2F 有較佳的收斂行為。 
 
 由本研究中可以發現，匹配逼近演算法的確能對於訊號進行有效的分解，在我們的測試
中發現，當目標函數為剩餘函數與原子函數之間差異的能量時，收斂情形較原始的內積值
作為目標函數更加快速，也更強健。我們也提出了一隨機最佳化的演算法以修正離散的 s
值，得到更匹配的原子，此演算法可以直接推廣，最佳化所有的離散參數，如何選取目標
函數 3F 則是值得討論的議題，我們在訂定目標函數時作了許多簡化，目的在於減少計算量，
並簡化推導與實作過程，不作這些簡化是否能得到進一步的最佳化也值得進一步討論。雖
然我們目前使用的是 Gabor 原子庫，但是可以直接推廣到 chirplet 原子庫。其餘的原子庫或
是混合的原子庫則須作進一步研究。 
 
 
 
 
 
 
 
 
 
 
 
 10
 
 
0 20 40 60 80 100 120 140
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
t  
圖 1. 測試訊號 1( )f t  
 
 
 
 
0 20 40 60 80 100 120 140
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
t  
圖 2. 測試訊號 2( )f t  
0 5 10 15 20 25 30 35 40 45 50
10
-35
10
-30
10
-25
10
-20
10
-15
10
-10
10
-5
10
0
k
en
er
gy
 o
f r
es
id
ue
 
圖3. 應用匹配逼近演算法於 1( )f t 時的收斂
情形，實線為 1F 的收斂曲線，虛線為 2F 的
收斂曲線 
0 5 10 15 20 25 30 35 40 45 50
10
-2
10
-1
10
0
k
en
er
gy
 o
f r
es
id
ue
 
圖 4. 應用匹配逼近演算法於 2( )f t 時的收
斂情形，實線為 1F 的收斂曲線，虛線為 2F 的
收斂曲線 
  
 
 
 
 12
 
 
0 5 10 15 20 25 30 35 40 45 50
10
-2
10
-1
10
0
k
en
er
gy
 o
f r
es
id
ue
 
 
圖 9. 應用匹配逼近演算法於隨機訊號時的平均收斂
情形，實線為 1F 的收斂曲線，虛線為 2F 的收斂曲線 
 
 
 2
地，更有著名的曼徹斯特大學，許多著名的學者出自曼大，例如 Paul Erdős 在曼大取
得博士學位，Ernest Rutherford 也曾任教於曼徹斯特大學。為了節省交通時間，筆者
搭乘的是由台灣直飛英國倫敦希斯洛機場的長榮班機，再由倫敦希斯洛機場轉機至
曼徹斯特。 
 
二、與會心得 
 
正如會議名稱所示，IST 發表的論文集中在各種成像系統(imaging system)的架
構、設計、量測方法、量測技巧與設備的軟硬體與演算法的最新發展，除了可見光
成像，像是 CCD、CMOS 等成像技術的研究之外，還有諸如太空遙測、醫藥、生物、
分子成像等領域的學者參加，電腦斷層(medical tomography)、腐蝕成像(corrosion 
imaging)等各種成像技術也是 IST 所關注的領域。今年的場次如下： 
 
Polarimetric Imaging and Remote Sensing 
Advances in Imaging 
Image Processing 
Electrical Capacitance Tomography  
Lung Cancer Detection and Discrimination Techniques 
Signal and Image Analysis 
Diagnostic Imaging Techniques 
Tomography for Industrial and Medical Applications 
Hyperspectral Imaging 
Remote Sensing 
Feature Extraction and Recognition 
Imaging Techniques 
Aerospace Imaging 
Ladars and Lidars 
Imaging Techniques and Devices 
Imaging Systems Design 
Linear and Non-linear Processing 
Object Detection and Recognition Techniques 
Microwave Imaging 
國科會補助計畫衍生研發成果推廣資料表
日期:2012/10/30
國科會補助計畫
計畫名稱: Grassmannian框的隨機搜尋演算法及其應用於訊號的稀疏時頻表示
計畫主持人: 王鵬華
計畫編號: 100-2221-E-305-009- 學門領域: 訊號處理
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
