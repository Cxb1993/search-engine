使用者。當某一使用者的傳輸通道狀況不佳時，排程機制可以選擇不傳輸資料給這個使用者，或是選
擇僅傳送足夠使用者播放的基礎層資料。如此可以避免傳送失敗所造成的頻寬浪費，以及後續重傳資
料所造成的延遲與網路資源浪費。假設排程機制可以選擇通訊品質相對比較優良的使用者來傳輸資料，
也能夠提升整體系統的頻寬有效利用比率，提高系統的吞吐量。 
LTE的網路支援『可適性調變與編碼技術』(Adaptive Modulation and Coding, AMC)。 AMC為次
世代網路相當迷人的一大特色。 eNode B 與用戶端設備可以依照不同的通道狀況來動態調整調變方
式與編碼方式，提升資料成功傳送的機率。此計畫目前也針對此部份進行深入的研究，並仰賴 AMC
來輔助我們所設計的排程演算法。針對通道品質回報的部份，我們將通道品質狀況回報給調變與編碼
機制的用意在於如下: 假設排程機制決定傳送資料給某些使用者，調變與編碼機制能夠依據每個使用
者的通道品質，來決定最佳的調變方式與編碼方式。假設使用者有較佳的通道品質，為提升傳輸速度，
我們可以採用較高之調變方式，例如使用 64QAM來最大化傳輸速度，另外，也可以採用較高之編碼
率 (coding rate)，例如 3/4的編碼率來提升每一封包所夾帶的有效資料量。 反之，當考量資料的有效
時間時，排程機制有時必須在通道品質不佳時進行資料傳送，以防止基礎層資訊失效。此時，我們必
須選擇較低階之調變技術以保護資料，並傳送較多的保護位元來提高資料修復的機率。 
 
ii. eNode B的負載狀況 
為使排程機制依照 eNodeB能力進行決策，機制本身必須對目前的負載情形有深入的瞭解。因此，
我們必須知道有 eNodeB中有多少進行中的連線，每個連線對頻寬的需求情況又是多少，才能決定每
一個時槽該安排多少之連線進行資料傳送，而每個連線又應該分得多少傳送資源。 在 LTE的網路中，
將網路傳送的資源依時間與頻率切割成許多資源區塊 (Resource Block, RB)。每一資源區塊在時間軸
代表 0.5ms (1 slot)， 在頻率軸則是由 12個子載波(subcarrier)， 每個子載波使用 15kHz的頻寬，共
180kHz 的頻寬。但實際傳輸時，LTE 的網路最小的排程單元是兩個資源區塊所組成的資源區塊組
(Resource-Block pair)。其代表 180kHz頻寬於 1ms的子時框 (1 subframe=2 slots=1ms) 內的傳輸機會。
此外，在 LTE 的規範中，允許排程機制分配不連續的資源區塊給使用者，意即分配給同一使用者複
數的資源區塊組時，每一個資源區塊組並不需要在時間或頻率軸上連續，排程機制可以選擇對使用者
最有利的資源區塊組給每一位使用者。因此，在我們所提出之 LTE 排程機制中，我們除了分配足量
的資源區塊組給使用者外，我們還會盡可能根據使用者對不同資源區塊的干擾與 fading情況，來分配
最適當的資源區塊組給使用者。 
iii. 傳遞延遲(propagation delay)與封包錯誤率 
由於用戶端是真正瞭解傳送結果的設備。使用者端必須週期回報其目前統計之平均封包錯誤率給
eNodeB，eNodeB才能得知在上次的排程決策後，每一使用者是否得到足夠的網路服務支援，做為下
次修正排程決策的依據。另外，eNodeB 也須透過追踪用戶端接收資料後所回傳的確認訊息
(acknowledgement)，來得知實際傳送的傳遞延遲。封包錯誤率與傳遞延遲直接反應出封包由 eNode B
發送至使用者端的最終服務品質結果。透過這兩項資訊可以評估確切的實體傳送速度。一來做為通道
不考慮快轉與倒退播放的情形下，視訊串流資料的剩餘有效時間 tr為: 
𝑡𝑟 = 𝑙𝑞𝜀         (2) 
其中 lq表示用戶端設備的暫存區中，還未被播放的基礎層數目。而 ε表示使用者應用程式每秒所須消
耗的影格數目。因此，此計畫所設計的排程演算法需要用戶端週期性回報其佇列長度狀況，讓 eNode 
B得以判斷哪些資料需要優先傳送，哪些資料還有等待的空間。 
 
我們利用上述各項變因，來動態調整 LTE eNode B中的排程機制以及調變與編碼機制，分配適當
的網路資源(時間與頻寬)給使用者，提升網路影像服務品質，也同時增加 LTE網路系統的整體效能。      
在 LTE的網路架構中，我們可以將排程機制分成時間領域的排程(Time Domain Scheduling)和頻
率領域的排程(Frequency Domain Scheduling)。一般的排程方式都先從 eNodeB的所有連線中，選擇此
回合排程所要排入的連線，在針對此次被選到的連線進行頻率的分配。此做法是先將連線本身進行時
間領域的排程，區分出每個連線應該在哪個回合的排程中被服務。再對每回合排程中的連線進行頻率
領域的排程。此做法主要是針對資料的時效性來做時間排程，再針對每條連線所屬之用戶端的狀態來
進行頻率排程。這樣的做法雖能顧及資料的時效性，但很多時候都會犧牲系統整體的效能。因為時效
性較短的資料並不見得能最大化系統的總傳輸速率。即時間領域排程所選出來的候選者，不見得是對
當時各頻段最有利的組合，候選者在頻率領域之排程僅能以相對於其他候選人有利的方式來決定頻率
使用權。有別於其他演算法，此計畫的排程演算法希望能在保障資料的時效性下，儘可能提升系統整
體的效能。因此我們先計算每條連線對每個資源區塊組的 SNR 值，用以評估某時間點時，每條連線
最適合的資源區塊組。於時間 t時，第 i條連線對第 j個資源區塊組的 SNR值 γi,j[t]: 
( )o
ji
ji NIk
tGP
t
+×
×
=
][
][ ,,γ     (3) 
其中 P為 eNode B之傳輸功率，Gi,j[t]表示連線 i在資源區塊組 j之增益，k表示總資源區塊組數目，
I表示 eNodeB之訊號干擾，No表示雜訊。假設訊燥比與傳輸成功率成正比，意即較高之訊燥比可以
支援較高之調變與編碼率，能有較高之傳輸速度。我們先找出時間 t時，能最大化每一資源區塊組吞
吐量 (throughput)，且尚未分配到資源區塊組的連線。假設連線 i 已經分配到足量的資源區塊組，則
我們令 ρi = 1，用以標示此連線已經無須再分配其他資源區塊組。因此，我們以(4)式來找出每一資源
區塊組所對應之連線，以最大化系統傳輸效能。 
𝑐𝑗 = 𝑥 ,  𝛾𝑥,𝑗[𝑡] = arg 𝑚𝑎 𝑥� 𝛾𝑥,𝑗[𝑡] |  𝜌𝑖 = 0�          (4) 
(4)式中之 cj代表最適合資源區塊組 j 的連線編號。從(4)式中，我們可以獲得每一資源區塊與其最適
合連線的對應關係。 
𝐶 = {𝑐1, 𝑐2 … 𝑐𝐻}        (5) 
假設 eNodeB中所有連線的資料均無逾時的疑慮，或是全部有逾時的疑慮的連線均包含在集合 C時，
我們可依照(5)式的結果進行傳送，可獲得最高之系統傳輸速率。但若是有任何即將逾時的資料，其
Nt
B
N
i
ij
j
∑
== 1     (8) 
其中Ｎ代表 eNode B目前之連線總數。而 eNode B之總傳輸速度Ｔa則為: 
∑ ∑∑
= = =
==
H
j
H
j
N
i
ijja tN
BT
1 1 1
1    (9) 
式中之Ｈ代表 eNode B中全部可以使用之資源區塊組數目。因此，一次排程中可以傳輸之資料總量 B
為: 
∑∑
= =
−
×=××=
H
j
N
i
ija tN
DwPTTDwPTtimeframeB
1 1
310
10
_     (10) 
 (10)中之 frame_time為 LTE網路定義之一個無線電訊框 (radio frame) 之時間長度，定義為 10毫
秒。而 DwPT則是在一個無線訊框內之 10個子訊框(subframe)中，下行資料所佔用之子訊框數目。 
 估計總傳輸速度之目的在於評估傳送即將逾時之進階層資訊是否會影響其他資料之傳送機會。其
評估方式如下 : 
假設目前於 eNode B之連線總數為 Nc，其中有 Nb條連線正在傳送基礎層資訊，有 Neo條連線正
在傳送進階層資訊，且其最前端之封包即將逾時，有 Ne條連線正在傳送進階層資訊，但目前沒有逾
時的疑慮，另外有 Nnr條連線正在傳送非即時性(non-real time)資料。假設目前每條連線皆有資料等待
傳送，db[i][x]表示第 i條傳送基礎層連線暫存器的第 x筆基礎層資訊，de[j][x]表示第 j條傳送進階層
且暫無逾時之連線暫存器的第 x筆進階層資訊，deo[k][x]表示第 k條傳送進階層且前端封包有逾時可
能之連線暫存器的第x筆進階層資訊，dnr[l][x]表示第 l條傳送非即時性資料連線暫存器的第x筆封包。
我們依照下面規則來決定是否傳送即將逾時的進階層資訊。 
首先，如下列公式(11)所示，假設 Bo為傳送基礎層連線中，即將逾時之總資料量。可用之總傳輸
資料量先減去即將逾時之基礎層資料量(其優先權最高)，剩餘之傳輸資料量若是大於即時性連線中目
前最前端之封包總合，代表傳送即將逾時之進階層不會造成下一次排程的負擔，即傳送所有即將逾時
之進階層資料。 
∑∑ ∑
== =
++>−
eb eo
N
j
e
N
i
N
k
eobo jdkdidBB
11 1
]1][[]1][[]1][[   (11) 
 假設下列公式(12)與(13)同時滿足，代表即使傳送這次即將逾時之進階層，在下一次排程仍有極
大的機率產生更多即將逾時之資料。式中之 y值表示目前網路資源僅能滿足至第 y條傳送進階層資訊
之連線。 
∑∑ ∑∑∑ ∑
+
== === =
++<−≤++
1
11 111 1
]1][[]1][[]1][[]1][[]1][[]1][[
y
j
e
N
i
N
k
eobo
y
j
e
N
i
N
k
eob jdkdidBBjdkdid
b eob eo
  (12) 
∑ ∑ ∑
+= = =
++<−
e b eoN
yj
N
i
N
k
eobeo kdidjdBB
1 1 1
]2][[]2][[]1][[   (13) 
 依照此計畫所設計之下行排程機制，我們同樣能將其精神應用於 LTE之上行排程機制中。礙於
篇 
幅，我們僅簡單描述如下: 對於 LTE環境而言，上行排程主要是由使用者設備 (UE) 提出需求，再由
eNode B依照目前上行資源的情況，決定分給每位使用者多少上行之資源區塊組。然而，由於在 LTE
的上行傳輸中，使用單載波之分頻多工( Single-Carrier FDMA, SC-FDMA)，在資源區塊組之分配上，
並不支援不連續之資源區塊組分配，因此在我們所規劃之 LTE上行排程機制中，將省略對每個資源
區塊組估計最大可傳送速度之動作。如此一來，將可以大大節省使用者設備之能源與運算資源消耗。 
 另外，考量視訊會議或其他多媒體之雙方會談應用，我們仍舊對使用者端所欲傳送之資料，保留
分層式編碼視訊串流的假設，意即使用者端所欲傳送之資料，一樣有即時性與非即時性之分，而對於
即時性資料傳輸，我們除了考慮原有之分層式編碼之基礎層與進階層關係，還會將 VOIP之情境納入
考量。VOIP之情境，有別於分層式編碼視訊串流，其串流內之封包大小為可預期，因此在排程中可
透過定期分配資源區塊組之方式來減少請求資源訊息所造成之額外資源花費 (overhead)。另外，我們
考慮將選擇調變與編碼方式的任務交由 eNode B來做，而不是由 UE來決定，原因在於 eNode B本身
持有由使用者傳送所發生之錯誤率與訊號強度等，可以更快獲得相關之參數。唯使用者必需在連線建
立之初就告知 eNode B，其所能支援之調變機制有哪些，eNode B會依照使用者所能支援的調變技術
中，選擇一個較為適當的，透過「上行排程應允」訊息 (Uplink Scheduling Grant) 來通知使用者。上
行排程之示意圖如圖二所示。 
 
 
圖二 LTE上行排程圖 
上行排程主要之步驟如下: 
步驟一: 
使用者必需要回報以下幾項資訊給 eNode B: 
i. 使用者之能源狀態 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/28
國科會補助計畫
計畫名稱: 子計畫一：次世代網路之跨層協調排程機制(I)
計畫主持人: 賴威光
計畫編號: 99-2221-E-110-065- 學門領域: 網路
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
