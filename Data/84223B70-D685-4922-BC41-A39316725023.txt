 2
original LDR photos to the HDR domain that 
can be treated as the real radiance in the 
scene, then we can use a simple thresholding 
method to detect the moving objects. For 
reducing the noise caused in previous step 
and filling out the small broken holes in the 
body of detected moving objects, we will use 
the morphology approach to refine the result 
of motion detection. Finally we are able to 
obtain a good HDR image by eliminating the 
moving objects at the HDR image 
composition stage. Two examples are given 
to demonstrate the robustness and 
effectiveness of the proposed method. 
 
Keywords: High dynamic range image, 
Moving objects detection, Thresholding, 
Morphology. 
 
二、研究動機與目的 
一般而言，而我們人眼可以感受的外
面景物的亮度變化非常大，通常可以超過
十萬倍，甚至由於我們人眼有所謂視覺適
應（adaptation）的能力，更能在數分鐘內
適應外界亮度的改變，而能感受分辨出更
大範圍的變化。但是當我們在對一個景拍
攝時，不管我們使用傳統底片式的相機或
直接使用數位相機來取像來得到一個二維
的亮度（brightness）矩陣時，很不幸的，
其並不能做為該景中亮度真正幅射
（radiance）的量測 [1, 2]。 
 
現實的情況是，在真實世界中的幅射
（radiance）與相片中的像素值存在著一個
非線性的對應關係，例如當幅射低於某個
臨界值時，在數位相片中即無法顯現其差
異，而只能皆以最暗―0 來表示之；同樣
地，當幅射強過某一臨界值時，數位相片
也只能以最亮―255 來紀錄該像素的強
度。由上面的說明，我們可以很明顯地看
出，拍攝所得之數位相片的動態範圍
（dynamic range）是相當小的。所謂“動
態範圍＂就是指一個景或影像中所能表現
出之最亮與最暗的對比值。 
我們以圖 1 來說明一般相片之動態範
圍不足的問題。圖 1(a)為我們眼睛所看到
的真實景物，注意，我們可以看到逆光的
樹葉部份，而且也可以清楚看到公園內樹
蔭下的車子細節；(b)為我們以一般數位相
機所拍得的相片，很明顯的，相片中有太
陽光的附近的樹葉幾為死白一片，而且樹
蔭下的許多汽車細節也因太暗而看不清
楚。這就是所謂“動態範圍＂不足所造
成。因此有學者[3, 4, 5]提出藉由結合多張
同景物但不同曝光時間的照片來產生所謂
的『高動態範圍（High Dynamic Range）影
像』，來解決一般數位相片動態範圍不足
的問題。 
 
 
      (a)               (b)   
圖 1 數位相片動態範圍不足的問題 (a)眼睛所
見之真實場景；(b)以數位相機所拍得的相片。 
 
然而在現實的情況中，我們想要拍攝
一張風景照的當時，但是不幸的是卻可能
常常有移動物體不經意的出現，例如因風
吹而擺動的樹葉，更甚是走動的人群等。
而如果我們拿這些照片去合成高動態範圍
影像，就會很難過地發現所合出來的結果
會有模糊不清的鬼影或移動物體之殘影存
在。圖 2 所示為以三張在滑雪場的不同曝
光時間影像去計算 HDR 影像的結果，可以
明顯發現，中間有三個破壞畫面的滑雪人
之殘影存在。因此本研究目的就是希望能
提出一個能在不同曝光時間拍攝之影像序
列中的有效移動物體偵測法，且其是全自
動的。進而使我們能在合成高動態範圍影
像的過程中將其消除，使所合成之高動態
範圍影像沒有移動物體的殘影，而完成一
 4
法觀察出來的小移動物體存在，例如樹叢
中因風吹而擺動的樹葉等。另一個嚴重問
題是使用者在標記移動物體的過程中，並
沒有辦法精確定位出移動物體的位置，而
這會導致在合成之高動態範圍影像在多餘
標記的區域會有雜點或色彩不連續的現象
發生。所以本研究的目的就是希望能提出
一個能在不同曝光時間拍攝的影像序列中
之自動移動物體偵測法，使我們能在合成
高動態範圍影像的過程中有效地將其消
除，使所合成之高動態範圍影像沒有移動
物體的殘影。 
 
傳統的移動物體偵測方法的原理是將
兩張影像做差值計算，當其彼此的像素值
差超過某一個範圍或臨界值時，便將該區
域判定為移動物體。但是很不幸的是，這
樣的方法在處理不同曝光時間拍攝的 LDR
影像序列時就不太有效了。由於影像是以
不同的曝光時間來拍攝，所以就算影像中
沒有任何移動物體，同一位置不同影像的
像素差還是會因為拍攝的曝光時間所造成
的亮度（illumination）差異太大超出門檻
值，而幾乎使整張影像都被視為移動物
體。圖 4 為將兩張不同曝光時間的 LDR 影
像直接相減，而將其差值影像中 R，G，B
像素值大於某一臨界值（threshold）的地方
以紅色標記，即判為移動物體的結果。我
們可以明顯的發現，被標記出來的部份幾
乎都是沒有在移動的場景部份。很顯然
的，這樣的方法肯定是不適合用在 HDR 影
像合成時用來偵測移動物體的。 
 
在本研究中，我們提出一個有效且強
建的移動物體偵測方法來解決此一問題。
首先我們先將原始的LDR影像利用相機響
應函數（camera response curve）轉換到
HDR 值域，也就是可以代表外界真實亮度
的量測值。接著我們將藉由一簡單的臨界
值法（thresholding）來完成移動物體的偵
測。由於偵測結果可能會有雜訊或在移動
物體內部會有小破洞的產生，我們將利用
型態學中的侵蝕（erosion）與膨脹（dilation）
來解決此問題。最後我們即可以在合成
HDR 影像的過程中，藉由忽略影像序列中
所偵測出被定義為移動物體的LDR影像之
像素，而使用其他不同曝光時間的影像來
計算產生 HDR 影像。最後所得的影像即為
一具有高動態範圍且沒有移動物體殘影的
完美影像。 
 
圖 4 兩張沒有移動物體之不同曝光時間 LDR
影像做移動物體偵測的結果。 
 
三、研究方法 
圖 5 所示為我們所提出之『自動偵測
並移除移動物體之高動態範圍影像系統』
之詳細流程圖，其細節部分我們接著一一
介紹之。 
 
首先我們先要求出該組不同曝光時間
的影像序列之相機響應函數（ camera 
response curve）。由於這時影像序列中可
能會有移動物體的存在，為了能有效降低
雜訊與移動物體的干擾，我們將採用前一
年度計畫所發展出之結合 K-means 與雙向
濾波器（Bilateral filter）的影像分割法，並
利用曝光時間較長的影像像素值必定大於
同一位置較短曝光時間影像像素值的法
則，來決定最佳的取樣點，而正確地計算
出非線性的相機響應函數。 
 
在移動物體偵測方面，我們提出先將
多張不同曝光時間的 LDR 影像，透過所計
算出之相機響應函數（camera response 
curve）轉成多張的 HDR 影像，接著再將
 6
 
圖 7 型態學之侵蝕與膨脹的結果。(a)初步偵
測的結果(b)經過兩次侵蝕運算(c)再經過兩次
膨脹運算。 
 
圖 8 為兩張不同曝光時間拍攝的 LDR
影像，很明顯地，我們發現右邊為以較長
曝光時間拍攝的影像，其藍色的天空部分
已經幾乎都是死白一片了，而在左邊較短
曝光時間的影像中，我們可以看到藍色的
天空部分。如果我們以傳統的移動物體偵
測法來計算的話，其會得到不正確的結
果。為了證明我們所提演算法的可行性，
我們將左邊較短曝光時間的影像上加上兩
隻大蝴蝶當成移動物體。圖 9 為我們以前
面所提之自動移動物體偵測法的處理結
果，我們發現所提演算法可以有效解決因
曝光時間不同所造成的亮度差異問題，而
正確偵測出移動物體的位置。 
 
   
圖 8 為兩張不同曝光時間拍攝的 LDR 影像，
其中左邊較短曝光時間的影像加上兩隻大蝴
蝶來模擬成移動物體。 
 
圖 9 以所提自動移動物體偵測法處理圖 8 測
試影像的結果。 
如果我們只有兩張輸入影像，則如同
前面所言，我們可以以所提方法來自動偵
測出影像中有移動物體的區域，但是我們
卻沒有辦法判斷出哪一張影像中被標記出
來的區域才是真正的移動物體。但是只要
我們有兩張以上的輸入影像，那這個問題
就可以解決了。我們用圖 10 來詳細說明
之。圖 10 所示為三張以不同曝光時間拍攝
的影像，其中有個紅色的正方形物體從左
邊移動到右邊。很明顯的，我們的目的就
是要判斷出來『影像 A 的方塊 1』、『影
像 B 的方塊 2』、『影像 C 的方塊 3』為
移動物體。先假設我們只有使用兩張影
像，分別是影像 A 與 B。由我們所提自動
移動物體偵測法可以將影像 A 中之移動物
體區域標記出來，即方塊 1 與方塊 2；而影
像 B 在影像 A 中之移動物體相對位置也會
被標記出來（方塊 1 與方塊 2），如此一來
我們就無法得知這兩張影像中到底哪一張
影像中被標記出來的區域才真正是移動物
體，而在其另一張影像中的相對區域應該
為背景物件。 
 
 
圖 10 三張有移動物體的影像。 
 
但是只要有超過兩張以上的影像，我
   
    (a)          (b)         (c)  
