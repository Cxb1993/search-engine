圖形辨識應用上，本實驗以女性乳房腫瘤辨識為例，實驗取樣以 160 位女性
乳房超音波影像為樣本，其中 91 位為良性腫瘤，由於原始影像大小不一，因此
影像經由重新取樣使其所有影像輪廓皆為 2048 個取樣點，亦即影像可分解至 11
階。由於腫瘤表面輪廓粗糙程度是腫瘤判定上之重要輔助特徵[4-5]，藉由不同
階次之能量分布可有效區分良性與惡性腫瘤差異，由圖一顯示其能量分布在六、
七階可觀察出彼此差異，其能量分布定義如下： 
∑
=
=
jN
n
jk ndE
0
2])[(                                         (1) 
其中 k為分解階次，N為取樣點， 是第 k階之取樣點， 是第 k階小
波轉換高頻係數。特徵擷取器之設計基本原理即基於能量函數的平方累加而得，
因此分析特徵擷取器所需位元長度(Word-Length)最佳化之架構與如何硬體實現
為本實驗目的。 
k
j /NN 2= jd
 
三、研究方法 
為尋找完美重建特性且適合即時處理之可攜式特徵擷取器，我們於九十二年
度計劃＂基於 SAA 演算法之非遞迴式離散周期性小波轉換的超大型積體電路架
構實現＂ (NSC-92-2213-E-327-002)中，發展出一新的平行管線運算理論架構；
稱為區段累加演算法(Segment Accumulation Algorithm ,SAA)。九十三年度計
劃＂以 FPGA 實現四種基本型式之 SAA-Based 超大型積體電路架構＂ 
(NSC-93-2213-E-327-005)，我們發現 TYPE I-1 的硬體實現效益最佳、最簡單控
制時脈、路徑最小、晶片面積亦最小、速度最快等優點。對於特徵擷取器之位元
長度最佳化分析，在 FPGA 的模擬過程實驗中實現第 6、7、8階分解時，所需的
路徑遠比預估的長甚多。主要原因係由遞迴式演算法所推導出的非遞迴濾波器係
數所需的位元長度甚長，再加上需要近千個暫態資料的累加，使得元件的佈局十
分困難。為克服此困難，將遞迴式與非遞迴式演算法中所需的位元長度做進一步
的分析並發現在第 6、7、8階時，轉換係數所需之平均位元將達 18 bits(不包
含 sign bit)。也就是原始訊號與經由濾波器係數的運算後所產生之轉換係數，
在取有限精度情況下，與真正轉換係數兩者之間存在著轉換係數之單階截尾誤差
(Truncation Error)，此單階截尾誤差隨著遞迴式 DPWT 執行多階之分解動作會
被累積而放大，使得失真情況惡化，最後導致於無法重建回原始訊號。因此對於
截尾誤差之處理得宜與否將嚴重影響重建後的訊號品質。為有效地解決此問題，
我們遂假設濾波器係數就其單階之分解與重建過程中，若要完美重建原始訊號，
其應依存著某些限制條件，若能滿足此限制條件，則意謂著原始訊號在此限制條
件下，經過離散周期性小波轉換與逆轉換後，即可完美重建回原始訊號。基於此
 2
若以 、 的 1-D NRDPWT 為例，濾波器係數長度由[6]可得知8=l 2=k
22)2( =FL 、 及 ，其濾波器係數的排列以堆疊方式排列，由於
)，因此濾波器係數長度不足部分以 0 填補如表一，其相對應之產生邏
輯電路圖描述於圖一所示，區段資料 是由參數資料 累加而得，為
了取得正確之區段資料 ，動態 SAA 模組每經過 p 個週期就將累加暫存
器 R1 的值傳遞到暫存器 R2，且觸發控制信號以清除暫存器 R1 的累加值。在計
算 的過程中，每 4 個時脈週期需要清除訊號以清除累加暫存器之
值，在這個例子中，利用零的位置(x,y)=(5,2)之值可作為清除之訊號。 
4=p 6=q
2(FLpq >
)()( thseg ki )(
)( ta kx
)()( thseg ki
)()( phseg ki +⋅
累加區段資料過程中，每一個區段資料 的產生彼此獨立，且經
過 p 個時脈後再與下一個區段值 相累加得到新的累加值 
。持續這個過程，直至累加暫存器 R3＇取得
之區段資料累加值即為第一筆非邊界資料小波轉換係數 ，之
後每經過 p 個時脈即可取得下一筆非邊界資料小波轉換係數 ，如此反覆過
程即可獲得所有非邊界資料之小波轉換係數。為正確取得區段資料累加值，因此
移位暫存器R3每N個時脈需將資料傳遞到移位暫存器R4以保存正確之累加區段
資料，由於邊界資料筆數從[6]可得知邊界資料 的筆數為 q-1 筆，由於轉換
係數是由中間值與邊界值相結合，因此中間值筆數與邊界資料筆數皆為 q-1 筆。
當原始訊號輸入完成後，移位暫存器 R4 已包含所有中間值，當資料傳遞完成後，
隨即清除暫存器 R3 與 R3＇之值，以獲得正確之累加值。因此下一筆原始訊號輸
入時，累加暫存器 R1 與 R3(R3＇)之值皆為零，而暫存器 R4 則儲存前一筆輸入
訊號之中間值，待相對應之邊界資料相加後依序輸出。 
)()( phseg ki +⋅
)2()( 1 phseg
k
i +⋅+
++⋅ )()( phseg ki )2()( 1 phseg ki +⋅+
++⋅ )()( phseg ki ++⋅+ )2()( 1 phseg ki ++⋅+ )3()( 2 phseg ki ++⋅+ )4()( 3 phseg ki ++⋅+ )5()( 4 phseg ki
)6()( 5 phseg
k
i +⋅+ ]0[jd
]1[jd
)(
 
k
nbd
由於邊界資料所對應之參考原始訊號是以原始訊號做周期性複製，因此在產
生第一筆小波轉換係數同時，可先將部分累加區段資料預先儲存，待原始訊號輸
入完成後與中間值相加依序輸出。 
所以邊界資料可表示如下： 
))1('())'('( 0
)(
1
2
0
)(
f
k
q
q
nqi
k
i tpnThsegpniThseg +−++∑ −+ −− −=    (5) 
 4
格路徑（Critical Path），而管線化是利用增加 Latency 來降低 Critical Path，
相當也增加了 Throughput。RROLT 則可有效抑制位元長度成長效應，不僅提升
硬體運算效能，也大幅降低硬體設計時所需位元長度，對於硬體電路面積更可大
幅縮小及消耗功率之降低。 
 
表一.濾波器係數排列方式 ( 8=l  and 2=k  ). 
 0=x  1=x  2=x  3=x  4=x  5=x  
3=y  )2(
3HFC  )2(7HFC  )2(11HFC  )2(15HFC  )2(19HFC  0 
2=y  )2(
2HFC  )2(6HFC  )2(10HFC  )2(14HFC  )2(18HFC  0 
1=y  )2(
1HFC  )2(5HFC  )2(9HFC  )2(13HFC  )2(17HFC  )2(21HFC  
0=y  )2(
0HFC  )2(4HFC  )2(8HFC  )2(12HFC  )2(16HFC  )2(20HFC  
 
40
60
80
100
120
140
1 2 3 4 5 6 7 8 9 10 11
Decomposition Stage (j)
M
ea
n 
V
al
ue
 o
f C
ha
nn
el
 E
ne
rg
y 
(
(in
 d
b)
malignant
benign
 
圖一. 良性、惡性腫瘤於各階次的能量分布 
 
)2(
0HFC
)2(
21HFC
)2(
18HFC
)2(
15HFC
)2(
 ,0 yC
)(tSJ
)2(
 ,1 yC
)2(
 ,2 yC
)2(
 ,3 yC
)2(
 ,4 yC
)2(
4HFC
)2(
1HFC
0)2(19HFC
)2(
8HFC
)2(
5HFC
)2(
2HFC 0
)2(
3HFC
)2(
12HFC
)2(
9HFC
)2(
6HFC
)2(
16HFC
)2(
13HFC
)2(
10HFC
)2(
7HFC
)()2(0 ta )(
)2(
1 ta )(
)2(
2 ta )(
)2(
3 ta )(
)2(
4 ta
: Multiplier : CSR Device
)2(
20HFC
)2(
17HFC
)2(
14HFC
)2(
11HFC
)()2(5 ta
)2(
 ,5 yC
R1 R1 R1 R1 R1
)2(
0hseg )2(1hseg
)2(
2hseg
)2(
4hseg
)2(
3hseg
)2(
5hseg
)4(  =periodSignalClear
: Adder
R5
]10[]0[ jj dd L
)2(
4bd
)2(
3bd
)2(
2bd
)2(
1bd
R : Register
R5R5R5R5
)2(
5bd
]15[]11[ jj dd L
R1
R3 R3 R3 R3 R3'R3 M
U
X
R2R2 R2 R2 R2 R2
)2(
1itd
)2(
2itd
)2(
3itd
)2(
4itd
)2(
5itd
R1
R3 )(  NperiodSignalClear =
R4R4R4R4R4 R6
圖二 1-D NRDPWT 特徵擷取器的硬體架構 
 6
