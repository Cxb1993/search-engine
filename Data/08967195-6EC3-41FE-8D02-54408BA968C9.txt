2以模擬出任何樂器的聲音及音效。然而儘
管如此，對於一般普遍社會大眾或是專業
的音樂愛好者，仍可輕易地分辨出合成音
樂與真實樂器產生之樂音，因為後者更接
近自然，也更符合人性。是以不論國內外，
仍有許多人士致力於樂器的自動演奏
[5-7]。
在過去，我們設計製作了以 PIC 單晶
片[8]為控制核心的自動吉他，後來又完成
一個進階的自動吉他演奏系統[9]，目的在
提高自動吉他的設計與應用層次，以增加
系統的實用及普遍性。有了這些實際的設
計經驗，我們更覺得在軟體方面的系統整
合，更顯重要。
在本計畫中，我們實現了一個實用的
自動吉他樂曲輸入系統，為了配合自動吉
他的硬體控制，我們自訂了一套樂曲控制
碼，作為樂曲檔案格式的基礎，取代了過
去單晶片系統中的二進位檔案格式。我們
也利用VB程式[10]設計了整合的GUI(圖形
使用介面)[11]。使用者可以直接輸入曲
目，先以軟體模擬音效的方式，測試樂曲
是否正確，在此我們結合 Midi 多通道的演
奏技術，提供數十種的樂器模擬音效。我
們也提供吉他演奏動畫模擬，以增加本系
統的教學功能。更進一步，我們提供了硬
體控制碼轉 MIDI 檔的功能，也設計了進階
的民謠與古典吉他六線譜圖形介面。至
此，一個實用的自動吉他樂曲輸入系統已
然呈現。
三、系統說明
本計畫在實現一個實用的自動吉他樂曲
輸入系統，圖 1 是自動吉他實體圖，已於
上一計畫完成，本計畫則偏重實用軟體介
面的整合實現。是以除了要擷取一般音樂
玩家所使用的音樂軟體，如 Guitar Pro、
Finale NotePad 等之優點外，還必須考慮
實際上如何驅動自動吉他實體之問題，以
下針對硬體控制碼樂曲格式、MIDI 音效模
擬吉他教學、硬體控制碼轉 MIDI 檔設計、
以及進階民謠與古典吉他六線譜圖形介面
等主題，分節說明如下。
3.1 硬體控制碼樂曲格式
在自動吉他硬體控制方面，我們是採
用電腦印表機埠外接 8255 卡[12]，控制外
部自動吉他的壓弦、撥弦、以及把位移動
等。如此 PC-Based 控制方式，使我們的軟
體設計層級，可以直接使用高階語言。基
於此，我們訂定了以下自動吉他硬體控制
碼。
自動吉他硬體控制碼：
INTRO: 起始碼，亦可輸入有關樂曲的文字介紹
（Introduction）
B****： 基本節拍時間= ****ms
P**： 移到第 ** 把位（左手）
T**：（右手）撥弦後延遲時間= ** 乘以 基本節
拍時間
S**： 休止時間= ** 乘以 基本節拍時間
Lab：（左手）壓第 b 把位(相對目前的把位)，第 a
條弦
lab： （左手）放開第 b 把位(相對目前的把位)，
第 a 條弦
Rab…：（右手撥）第 a 條弦，或同時撥第 a, b …
條弦
D： Debug 碼，此時可輸出一些訊息，供偵錯用
E: 結束碼
有了以上的硬體控制碼，我們就能很
方便的為每首吉他曲，寫出硬體控制碼樂
曲檔案。以一首初學者所常彈的「C 大調
小行板」[13,14]為例，以下為它的樂曲控
制碼部分摘錄。
INTRO B0170T01P01
L3251 R35R4R35R4 l3251R35R4R35R4
L3353R35R4R35R4 l3353L3251R35R4R35R4
………….（略）………….
T01 l63 L3251 R35R4R35R4 l3251R35R4R35R4
L3353R35R4R35R4 l3353L3251R35R4R35R4
l3251L23R26R4R26R4
l23L61R36R4R36R4 l61L13R15R4R15R4 T04
l13L233251R2345 l233251
E
有關以上樂曲控制碼，特別說明其中
「B0170」碼，意思指的是基本節拍時間定
為 170ms。我們可以藉由調整這個時間的
大、小，來決定演奏速度的慢、快，而達
到測試或學習的效果。此外，系統也提供
輸出控制文件檔的功能，以方便使用者除
錯，或驗證學習之用，以下為一控制文件
檔的部分內容。
自動吉他輸出控制文件檔：
注意：以下右手撥弦動作之間，若無時間間隔，表
示一起撥
移到第 1 把位
4 00：將 Delta Time 設為 0。
 FF 58 04：為 Meta Event (FF)型號，58 代表
拍子記號，接著 4 個 bytes 的資料。
 04 02：指每小節有四(04)拍，四分音符(22)
為一拍。
 18 08：1816=2410個 MIDI Clock 中有 8 個
32 分音符。
 00：將 Delta Time 設為 0。
 FF 51 03：為 Meta Event (FF)型號，51 代表
拍速，接著 3 個 bytes 的資料。
 09 27 C0：0927C0 轉為十進位為 600000，
由於單位採用微秒(10-6)，故得到一拍為 0.6
秒，故一分鐘有 100 拍。
 00：將 Delta Time 設為 0 。
 FF 2F 00：結束此軌。
 4D 54 72 6B：為識別位元。
 00 00 00 0D：為資料長度。
 00：將 Delta Time 設為 0 。
 90 3C 50：表示 Note ON 在 Channel 0，彈
奏中央 C (Do)，力道為 5016。
 81 40：為 Delta Time，時間為 192tick，實
際時間為 0.48 秒。
[192tick*(1beat/240tick)*(1min/100beats)*(6
0sec/1min)= 0.48]
 80 3C 40：Note Off 在中央 C。
 00：將 Delta Time 設為 0 。
 FF 2F 00：結束區塊。
此外，要發出合音（如 DO、Mi、Sol
三個音一齊發音）的話，只要在以上「90
3C 50」碼後加上為 0的 Delta Time 再
加上要發出的音即可，結束發音的方法
也是一樣的。
由於我們在上一節 MIDI 音效模擬
中，已經能夠取得所發的音（不論單音
或合音）的音階，以及發音的時間長
度，如此一來，再配合我們對 MIDI 檔
案的了解，即可順利完成硬體控制碼轉
MIDI 檔案的工作。
3.4 進階民謠與古典吉他六線譜圖形介面
前述自訂的自動吉他硬體控制碼，主
要在方便控制自動吉他硬體之用，事實
上，也可作為本系統的「中間檔案」。為
了完成一個實用的樂曲輸入系統，我們還
必須再提高樂曲輸入的層次，畢竟對於一
個普通的吉他玩家，要他輸入以上硬體控
制碼，是頗耗費時間的。
對於一般的吉他手而言，六線譜是大
家所熟悉的，無論是古典吉他，或是民謠
吉他，都可以用六線譜來表示。因此，我
們實現了一個進階民謠與古典吉他六線譜
圖形介面。這在使用者開啟新檔時，系統
就會請使用者選擇如圖 3 所示的民謠吉他
六線譜圖形介面，或是圖 4 的古典吉他六
線譜圖形介面。
這個部分的設計，考驗了我們 VB 程
式設計的功力，我們也都一一克服了其中
的關鍵技術，設計成果也達成了 Guitar Pro
等專業軟體的基本功能，讓使用者能輕鬆
方便的輸入樂曲。
特別是在民謠吉他圖形介面中，由於
民謠吉他使用到的和絃眾多，因此我們還
設計了一個如圖 5 所示的和弦編輯器，設
計者可以將自己所使用的和弦輸入到和弦
編輯器中，往後在六線譜編輯器上編輯
時，就可以選取自己要使用的和弦了。使
用者可以經由和弦編輯器做新增和移除的
動作，系統 chord.mic 這個檔案就是用來
儲存所有和弦內容的檔案。
此外，本系統上有許多智慧型設計，
例如有關音符的產生，本系統會依音符的
長度不同而去改變下一個音符的位子。因
此使用者可以依自己的需要，去設定音節
的長度。此系統的音符主要用全音符、二
分音符、四分音符、八分音符和十六分音
符五種，可以讓寫作者使用。在連音上，
此系統也會自動產生，不需使用者另行輸
入。
本系統在音節的產生方面，亦採取自
動產生的方式，使用者在寫作的時候就可
以不用在乎音節的問題。當產生新的音符
後，系統會將原有的總拍數加上新音符的
拍數，之後再將總拍數和輸入的音節拍數
做比較，如果總拍數等於音節拍數，那系
統就會自動產生新的音節。如總拍數小於
音節拍數，那麼系統就會將現在的音節往
後移，移到新產生的音符後。
四、參考文獻
[1] 奇 美 博 物 館 ， Web:
http://www.chimei.com.tw/museum/index.h
tml
[2] 張迪文，MIDI 狂想曲-電腦音樂輕鬆上錄，松
崗，民國八十八年。
[3] 高盟欣，樂譜編輯與電腦音樂的應用，淡江大
學資訊工程所碩士論文，民國八十七年。
6圖 3. 民謠吉他六線譜圖形介面
圖 4. 古典吉他六線譜圖形介面
圖 5. 民謠吉他和絃編輯器
