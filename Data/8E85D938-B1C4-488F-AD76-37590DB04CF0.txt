2B: 使用型態學式影像處理（Morphological
Image Processing）為基礎的人臉偵測系統
使用型態學式影像處理為基礎的人臉
偵 測 系 統 （ Morphological Image
Processing），其想法是如下，一個黑色的
長條形區塊是一個人類眼睛的侯選者，我
們使用型態學式影像處理方法 closing、
chipped、different 等運算，來找出影像中的
黑色的長條形區塊，在找出了黑色的長條
形區塊之後，每一對的黑色的長條形區塊
萃取出對應的方形區域作為人臉侯選人，
最後再一一驗證每個方形區域是否萃取出
真正的人臉。其流程如下圖所示：
圖 二 、 使 用 型 態 學 式 影 像 處 理
（Morphological Image Processing）為基礎
的人臉偵測系統[Han et al., 2000]
使用型態學式影像處理為基礎的人臉
偵測系統其缺點在於，在一個複雜背景的
影像中，使用型態學式影像處理找出的黑
色的長條形區塊，其數量可以是非常大
的，如此將大量增加系統的計算量。
C: 使用類神經網路的人臉偵測系統
(Neural Network based Face Detection)
使用類神經網路的人臉偵測系統
(Neural Network based Face Detection System)
的想法是，訓練一個類神經網路來分類一
個 20 X 20 的影像中是否含有一個人臉，
一但類神經網路訓練好之後，我們使用一
個影像區塊(window)掃描要偵測的影像，
這個影像區塊可以是不同的尺寸，在影像
中不同的位址，最後這個影像區塊重定大
小成一個 20 X 20 的影像，餵入我們之前
訓練好的類神經網路之中，使用類神經網
路的人臉偵測系統的流程圖如下[Rowley,
1998]：
  
圖三、使用類神經網路的人臉偵測系統
 使用類神經網路的人臉偵測系統在實
驗中可以得到很好的結果, 但是它需要的
計算時間卻是非常大的, 那是因為他要對
整張影像中所有可能的子影像做分類（掃
描整張影像中不同尺寸且重疊的影像區
塊）。而且他只能偵測出與影像垂直的人
臉，要延伸到可以偵測不同角度的人臉，
會大大增加他的搜尋空間，也增加了他的
計算時間。同時訓練資料的選取對於訓練
一個類神經網路有很大的影響，在使用類
神經網路的人臉偵測系統中，採集負訓練
樣本（不含人臉影像的訓練樣本）是一件
很困難的事情，因為不包含人臉的樣本集
合是一個十分大的集合，這使得我們很難
能採集到『充分』與具有『代表性』的負
樣本訓練集合。
三、混和型人臉偵測系統
在愛滋病的治療方法中，最有名的就
是華裔科學家所提出的雞尾酒治療法，雞
尾酒治療法的內涵在於：有時候一種藥物
4由一個非線性映射映射到一個高維度
的特徵空間，而支撐向量定義出一個特徵
空間中的球來圍住所有的樣本點。而且一
個高維度的球在原來空間中可以是任意的
形狀。單類別支撐向量機方法的概念圖可
用圖四表示。
圖四表示將所有的樣本點經由一非線
性轉換映射到高維度特徵空間，並找出
一個有最小半徑的球來包含特徵空間中所
有的樣本點，一但特徵空間中的球被找出
來後，我們就可以計算出所有點在特徵空
間中到球心的距離，而畫出上面的高度
圖，距球心距離越遠則顏色越深，而由高
度為球半徑的橫切線定義出一條邊界曲線
來包含所有的樣本點。
其實單類別支撐向量機與類神經網路
在這裡所做的工作是一樣的，都是分割是
人臉與不是人臉的二個類別，但是二者最
大的不同在於所需要的訓練樣本不同，類
神經網路需要二類訓練樣本—正樣本(包
含人臉)與負樣本(不包含人臉)，而單類別
支撐向量機則是只需要正樣本即可，眾所
皆知的，在類神經網路人臉偵測系統中採
集負訓練樣本是一件很困難的事情，不包
含人臉的樣本集合是一個十分大的集合，
採集到『充分』與具有『代表性』的負樣
本訓練集合是非常困難的，而使用單類別
支撐向量機，我們可以很巧妙的避開採集
負訓練樣本的困難。另外，由於我們只使
用正樣本來找出支撐向量，所以找出的支
撐向量數目也會比傳統二類別支撐向量機
來的少，如此，也可大幅縮短人臉偵測的
時間。整個系統流程圖如圖五所示
四、訓練樣本的收集
在本計畫中，我們收集了本校教職員
工的人臉影像作為訓練樣本，同時我們也
從網路中收集不同的人臉影像作為訓練用
途。所收集到的人臉影像數量如下表所示。
表一、收集到的人臉資料
男 女
老年 118 197
青年 399 418
小孩 36 20
總共包含了 1,188 張人臉影像。另外，
我們也從網路上下載了在人臉偵測研究中
常用的人臉資料，例如 MIT CBCL 人臉資
料庫(http://www.ai.mit.edu/projects/cbcl/)。
其中包含了 2,429 張人臉影像。在產生人
臉訓練資料時，我們將每一個人臉影像經
過鏡射、左右翻轉，以及輕微地平移(shift)
與旋轉(rotate)，來產生 15 張不同的人臉影
像，並且使用 light correcting 與 histogram
equalization 去除光線對分類的影響[H.A.
圖五、混和式人臉偵測系統流程圖
6當新近樣本 c 所對應的係數 c改變時，我
們可得到 ig 的改變如下
}{
,222
cDi
BKKg cic
Sj
jiji

 


與
 


Sj
jcg 
其中














 



ccc
Dj
cjjc
Dj
cjjc
Djk
kjjk
Djk
kjjkJ
KKK
KKR
B
2
,,
2
)(
2)(
2
1


所以，在“平衡狀態(equilibrium)”時
 





Djcjj
c
,

,
其中
 





























cs
cs
s
s
ss
K
K
P


11
1



,
而且 1QP ，而 Q 為 symmetric but not
positive-definite Jacobian :
  















sss
s
ssss
ssss
KK
KK
Q






1
111
1
1
110
,
簡而言之，在每一次 incremented step，我
們計算






Si
Sici
i 0

與





Si
cREir
g cii 0
}{2 
 
c
Dj
cjj
SjDk
kjjk
ccc
Sj
cjj
Sjk
kjjkJ
KK
KKKR
























2)(2
)(
,
2
,
2
最後，我們將增加式單類別 SVM 學習演
算法摘列在表二中。
六、計畫成果
在本計畫執行期間中，我們開發了一套
混和式人臉偵測系統，自動由大量影像資
料中萃取人臉的部分。基於我們所提出的
混和式方法與增加式單類別支撐向量機分
類學習方法，此系統可以由『粗糙』到『細
1. Initialize c to zero;
2. If 0cg , terminate (c is not a border or outside vector)
3. If 0cg , apply the largest possible increment c so that (the first) one of
the following conditions occurs:
(a) 0cg : Add c to border set S, update P accordingly, and terminate;
(b) Cc  : Add c to outside set E, and terminate;
(c) Elements of D migrate across S, E, and R (“bookkeeping”):
update membership of elements and, if S changes, update P accordingly.
And repeat step 3 as necessary.
表二、 Incremental Learning Algorithm,
