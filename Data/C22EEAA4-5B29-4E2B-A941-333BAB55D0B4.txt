 1 
中文摘要：  
在過去技術文獻上，一般設計的壓電致動微奈米定位平台，大都僅止於定位上的應用。
因應各種加工時的狀況，對於工件幾何形狀的精確掌控，本計畫將發展一種具輪廓追蹤控制
之三軸長行程微奈米定位平台。本計畫的主要工作將分年敘述如下： 
第一年的主要工作內容，將以伺服馬達致動系統驅動 XYθ平台達到粗定的目標，並選用
壓電材料與 Scott-Russell(SR)結構放大為基礎，作動 XYθ細定位平台, 利用 Ansys電腦軟體模
擬平台機構的位移量，及田口方法對此細定位平台作最佳化設計。最後將粗細平台整合成為
一微奈米定位平台。 
    第二年的主要工作內容，是對第一年所整合完成之三軸長行程微奈米定位平台進行系統
鑑別，分別是以動態信號分析儀及基因演算法來對本計畫之系統進行鑑別，進而建立本計畫
系統之數學模型。在系統控制方面，本計畫之奈米定位平台，是由三支壓電陶瓷，同時致動
三軸互為 120 度的 SR 放大機構，使奈米定位平台產生位移，因此三軸間的運動會互有干涉
耦合現像，為解決此一耦合問題，本計畫將提出一控制手法，設計出一解耦合控制器，使三
軸間之干涉耦合現像可以達到零干涉的控制目標。工件之幾何形狀大都由斜線、轉角與圓弧
這三種基本軌跡所組成的二維軌跡，因此本計畫將分別研究輪廓追蹤下各別輪廓之響應，再
設計輪廓追蹤控制器，針對輪廓誤差及輪廓精度來做補償控制。 
關鍵詞：微奈米定位平台、田口方法、系統鑑別、解耦合控制器、輪廓追蹤 
 
 
 
 
 
 
 
 3 
Keyword: Micro/Nano-meter positioning stage, Taguchi method, System Identification, decoupled 
controlle contouring tracking  
        
 5 
第一章 前言 
本計畫主要針對三軸長行程微奈米定位系統作整合與研究，以伺服馬達為 XYθZ 粗定位
平台，並選用壓電材料與微結構放大器作為基礎，利用田口方法對 XYθZ 細定位平台做最佳
化設計。藉由系統參數鑑別技術與控制器的設計，完成具奈米級定位精度的三軸長行程微/奈
米定位平台的開發與研製，使微奈米定位平台能達到更高效率及更高精確度的定位技術。 
 
1.1計畫背景及目的 
隨著生物科技、半導體製程、光電技術、通訊科技等研發領域逐漸地將產品微小化，精
密加工微小化的技術發展，相對性的，成了未來整個工業科技發展的重要趨勢。現今熱門的
資訊及通訊相關產品，如小型照相機、光學式掃描機、攝影機，光碟機等，不僅其外觀體積
達到小型化，其內部更是隱藏著許多高精密的小零件。這些精密細微的零件在組裝作業時，
必須先將零件先鎖緊至半固定狀態，以便調整其輸出信號至最佳值後，再以螺絲強力鎖固或
以 UV硬化法固定之。但是零件在半固定狀態時，有如下問題點： 
(1) 零件小，不易作業。 
(2) 零組件在半固定狀態時，很難再微動。 
(3) 零組件調整到在精確位置後，以強力固定時，位置又易跑掉。 
(4) 若利用傳統伺服機構定位，因鎖固的滑動面上存在著極大的摩擦力，難以克服“黏著
－滑動(Stick-Slip)”的問題。 
而設計組裝零件之機台，一般均會運用伺服馬達及滾珠螺桿所構成的移動檯，但隨著產
品的微小化趨勢，所要求的定位精度越來越接近傳統定位機構之解析度的上限，且因伺服馬
達及滾珠螺桿所構成的定位機構，欲達到如此高的精密定位精度，需克服螺桿所造成的間隙
與摩擦等傳統控制難題。因此，目前此類組裝作業大多仰賴熟練技術士，拿著小榔頭邊敲零
組件，邊預測新位置，最後再加以鎖固，以致生產效率低落。故欲提升生產效率，現場急需
此類組裝作業的自動化。但基於上列所述困難，此項精密組裝作業，很難利用傳統伺服機構
 7 
1.2構想的創新性與對產業界的重要性 
          本計畫主要之創新性是設計出一解耦合且具備輪廓追蹤控制的三軸長行程微奈米
定位平台，其主要內容將分述如下： 
1.2.1 第一年『三軸長行程微/奈米定位平台之最佳化設計與製作』之創新性與重要性 
本計劃之三軸長行程微/奈米級定位平台，最大的特色為利用 Scott-Russell(SR)放大
特性，運用在精密微定位平台中，其中 SR 放大機構為位移線性放大，採用具彈性之撓
性鉸鏈(flexible hinge)來連接機構連桿，設計出 SR機構之精密定位平台；本設計之微精
密定位平台設計為對稱性，可減低因溫度變化導致的干涉情形，且輸入端以三個壓電陶
瓷致動器作動，精密微定位平台可得到三自由度的定位，是本精密微定位平台之重要特
色。其本子計劃將精密微定位平台運用在掃描探針顯微鏡中，可補償定位平台快速且精
確之定位，其精密度可到達 1~10 nm之位移調整，在掃描探針顯微鏡量測範圍內，即可
得到更精確之量測值；精密微定位平台是一具有高可靠性、可高速動作之超精密微定位
系統，除了應用在半導體製外，可運用在各式系統中，如工具機、精密加工機、光纖與
波導器自動對準系統、三次元量測儀、掃瞄式穿隧電流顯微儀、掃瞄式探針顯微儀、原
子力顯微儀等，所以精密微定位平台之設計制造，是一個不可忽視的科技技術，科技的
發達進步與精密微定位平台的製作是相輔相成的。  
1.2.2 第二年『三軸長行程微/奈米定位平台之鑑別與控制』之創新性與重要性 
基因演算法之系統鑑別，基因演算的概念自 1960 年代起即有許多學者參於研究，
剛開始時是將其應用於模擬生物遺傳來解決最佳化的問題。基因演算法的最大優點是當
它在尋求問題之最佳化解的過程中，可以避免陷入局部最佳點，因此能找到全域最佳點
的機會較大，而且已被廣泛應用於各類實際的工程最佳化問題，例如自動控制、機器學
習、函數最佳化等。本計畫除了用基因演算法來鑑別出系統參數，建立系統模型外，另
外再加上使用動態信號分析儀，針對每軸向鑑別出各軸向之系統轉移矩陣，再一次的去
驗證系統之數學模型。 
 9 
計並製造二自由度(X-Y 軸)之摩擦驅動平台，其最大之位移行程為 20 mm，位移解析度為 7.5 
nm。 
在尺蠖蟲式的定位平台方面，1985 年 Mamin 等[7]屬於壓電致動尺蠖蟲式平台方面，利
用 bimorph壓電陶瓷的變形，配合具有靜電吸引力的腳座，設計出單步位移 25至 400 nm之
二軸長行程微定位機構。1999年 Katholieke University[8]研發一尺蠖蟲式的奈米級定位平台，
其最大行程 10 cm，解析度小於 10 nm。2000年大葉大學洪振義教授[9]設計一單自由度進給
裝置與三自由度微動裝置，利用雙裝置整合方式來達成精密微動定位的目標，單自由度進給
裝置主要是採用驅動位移量較大的壓電材料尺蠖蟲式（Inchworm）驅動設計，其運動行程可
達 68.9 mm，解析度為小於 40 nm；而微動裝置是利用管狀的壓電材料作為驅動源，運動行程
16.57 μm，解析度為 1 nm。 
另外依據材料彈性變形原理設計的定位平台，1998 年 Chang 與 Du[10]提出一利用二組
Scott-Russell機構放大位移的微定位平台，有 100 um行程及 40 nm解析度。1999年 Chang等
[11，12]針對平台設計與製作進行研究，建立模型、進行分析、找出最佳尺寸，研製出一三自
由度微定位平台，其中 X軸及 Y軸為同一層，有 18 um位移量、lO nm位移解析度;θz軸為
另一層，架設於 XY軸之上，有 0.6 m rad旋轉量、0.2 mrad旋轉解析度。2001年羅士哲等[13]
利用致動器的微量位移及材料彈性變形的原理，配合具有放大位移效果的線性放大機構，達
到高精密線性定位的平台。2002 年 Mizumoto[14]等人以傳動軸改用高解析度之壓電致動器
(PZT)進行驅動，位移解析度更進而達到 50 pm。2002年張所鋐等[15]選擇合適的六自由度並
聯式機構，採用撓性鉸鍊後利用積層式壓電致動器驅動。最大位移 8 μm與 8 nm解析度，最
大旋轉行程 200 μrad，各軸間干涉量小於 5 %。1999年張所鋐教授[16]再提出以一單自由度微
動平台，組裝於一長距離致動機構，形成一粗與細整合之平台。其中單自由度微動平台，具
有 2 nm 的位移解析度；而奈米級長距離致動機構為一具有 10 mm 最大位移量、10 nm位移
解析度。1999年清華大學倪維斗教授[17]參考 Stewart Platform的六腳移動架設計概念，使用
PZT作為致動器，設計一組以撓性結構為接點的六腳微動平台。其中 X軸的最大位移為 2.15 
μm，Y軸的最大位移為 2.86 μm，Z軸的最大位移為 2.92 μm，θX最大變化量為 26.86 μrad，θY
 11 
Decoupled MIMO 自調式適應控制理論在多軸液壓驅動系統的適用性，並研究結構耦合強度
受控制器的影響。成功的以 Coupled MIMO 自調式適應控制為基準，實驗分析出 Decoupled 
MIMO 自調式適應控制器的控制適用範圍。2001 年陳成振、陳世樂[29]，主要是利用交叉耦
合控制手法，將一非線線的雙軸平台進行橢圓及直線輪廓控制，並利用一分析出 ISMC 法則
能取非線性系統，最好的追蹤輪廓的性能。2003 年蕭文裕、傅群超[30]，研究交叉耦合控制
器於雙軸伺服機構之應用，並且以 DSP-Based來實現交叉耦合理論。其主要是利用回饋控制、
前饋控制、交叉耦合控制加以組合後，對追蹤誤差及輪廓誤差的影響。成功的利用實驗直線
路徑、菱形路徑及圓形路徑等三種不同的參考路徑，設計出可控制輪廓之控制器。 
 
 13
度最細的中點算起傾斜角為 θ，則鉸鏈橫截面上的寬度為[31]： 
 
cos sin ( / )2D t 2R 2R t 4R 2q q= + - × = + ×  (2.1) 
 
鉸鏈橫截面上的彎曲應力 σ及剪應力 τ為： 
 
2)(
)sin(6
Db
RLP
Z
M q
s
-
==  (2.2) 
 
bD
P
2
3
=t  (2.3) 
若連桿的長度 L 愈長，鉸鏈受力後愈容易變形，所產生的位移也較明顯；若鉸鏈寬度 t
及鉸鏈半徑 R愈大，則鉸鏈愈不容易變形，對連桿施力也需加大，如此，撓性鉸鏈就會失去
原本設計的用意了。 
一般典型的撓性鉸鏈如圖 2.1 所示，撓性鉸鏈的運動向量可分為 X、Y、Z、θx、θy、θz
共六個自由度，t表鉸鏈的寬度，R表鉸鏈半徑，b表鉸鏈長度，L即是連結鉸鏈的連桿長度;
對於一般微動定位平台的運動趨勢是平面的，僅需要以 XY平面位移運動的 X、Y、θz三自由
度即可，為了使其他 Z、θx、θy 三個自由度能不產生位移的運動，探究對撓性鉸鏈運動自由
度有較大影響的因子，只有鉸鏈的長度 b。若將鉸鏈長度 b 加長，鉸鏈斷面的截面係數必成
b2倍值加大，對 Z、θx、θy三向量的彎曲應力 σ及剪應力 τ必會減小，產生彈性變形也相對減
小，甚至微乎其微。 
 
 15
( )bf
EbR22
3
=
 (2.6) 
     
其中 )(bf 為: 
 
( ) ( )( )
( )
( ) ïþ
ï
ý
ü
ïî
ï
í
ì
÷÷
ø
ö
çç
è
æ +
×
ú
ú
û
ù
ê
ê
ë
é
+
+
+ú
û
ù
ê
ë
é
++
++
÷÷
ø
ö
çç
è
æ
+
= -
b
b
bb
b
bbb
bb
bb
b
2tan
2
16
21
243
2
1 1
2/322
2
2f
 
( )( )
( )
( ) ÷
÷
ø
ö
çç
è
æ +
ú
ú
û
ù
ê
ê
ë
é
+
+
÷÷
ø
ö
çç
è
æ
+
+
ú
ú
û
ù
ê
ê
ë
é
++
++
÷÷
ø
ö
çç
è
æ
+
= -
b
b
bb
b
bbbbb
bb
bb
2tan
2
16
2
1
21
243
2
1 1
2/3222/32
2
2
 
        ( )( )
( )
( ) ÷
÷
ø
ö
çç
è
æ +
ú
ú
û
ù
ê
ê
ë
é
+
+
+
++
++
= -
b
b
bb
b
bbb
bb 2tan
2
16
21
243 1
2/5222
2
 
        
( )
( ) ÷
÷
ø
ö
çç
è
æ
+
ú
ú
û
ù
ê
ê
ë
é
+
+
+
++++
++
= - 12tan
2
16
484
243 1
2/522345
2
bbb
b
bbbbb
bb
 (2.7) 
 
將 β= t / 2R代入方程式(2.7)式得: 
 
÷
ø
ö
ç
è
æ+÷
ø
ö
ç
è
æ+÷
ø
ö
ç
è
æ+÷
ø
ö
ç
è
æ+÷
ø
ö
ç
è
æ
÷
ø
ö
ç
è
æ+÷
ø
ö
ç
è
æ+
=
R
t
R
t
R
t
R
t
R
t
R
t
R
t
f
2
4
2
8
2
4
22
2
2
2
43
)( 2345
2
b
 
            
÷÷
ø
ö
çç
è
æ
+
ú
ú
ú
ú
ú
ú
û
ù
ê
ê
ê
ê
ê
ê
ë
é
÷
÷
ø
ö
ç
ç
è
æ
÷
ø
ö
ç
è
æ+
÷
ø
ö
ç
è
æ +
+ - 12tan
22
2
2
16
1
2/52 b
R
t
R
t
R
t
 (2.8) 
 
假設 t是很小值，則: 
 
 17
            
( )
2
6tan6
2/5
1
2/5 p
÷
ø
ö
ç
è
æ=¥÷
ø
ö
ç
è
æ= -
t
R
t
R
 (2.12) 
 
故方程式(2.6)式可簡化成: 
 
( ) 2/1
2/52/522
9
22
6
1
3
21
3
2
R
Ebt
R
tEbR
f
EbRK
zzM ppbq
=÷
ø
ö
ç
è
æ»=
 (2.13) 
 
其中，E為楊氏係數，R為撓性鉸鏈的半徑，t為撓性鉸鏈的厚度，b為撓性鉸鏈的寬度，θmax
為撓性鉸鏈的旋轉角度，D = t + 2R。 
 
2.1.2 SR放大機構位移理論 
圖 2.2為 SR機構的示意圖，其中 C為一固定點，A點為一撓性鉸鏈連結 AC和 BD，且 B
點沿著 Y軸移動，假設 LADACAB === ， q=ÐABC ，D點的座標位置為: 
 
0=DY  (2.14) 
   
22)2( BD YLX -=  (2.15) 
 
其中，XD和 YD分別為 D點的 X和 Y座標的位置，YB是 B點的 Y座標位置。在 SR機構中，
當 B點沿著 Y軸方向移動時，D點會沿著 X軸方向作直線位移，所以 B點的 Y座標位置與
D點的 X座標位置關係可表示為: 
 
2222 )()( BBDDBD YYXXYX D++D+=+  (2.16) 
 19
2.1.3 SR放大機構運動方程式推導[34] 
SR位移放大機構如下圖2.3所示，採用一體成型的方式製成，其中位移放大的方式為趨
近線性放大，將壓電陶瓷致動器置於SR的輸入端，當壓電陶瓷致動器產生位移變形時，SR
放大機構將會隨壓電陶瓷致動器變形位移而產生位移線性放大。 
 
圖2.3 SR機構Solid Works圖 
 
動態方程式的建立是基於以下的假設：SR機構受推力下，機構剛體不變形，只有撓性鉸
鏈產生彎曲變形。 
先由圖2.4的SR機構模型圖，列出動能T及位能V，再以Lagrange公式推導出動態方程式。
首先，X及Y方向的虛位移可表示為: 
 
î
í
ì
+=
+-=
Þ
î
í
ì
+=
+=
dqqqd
dqqqd
qq
qq
)cos(2
)sin(2
)sin(2
)cos(2
0
0
0
0
lx
ly
lx
ly
  (2.19) 
 
對時間微分，可得速度為： 
 
)sin(2 0 qqq +-= && ly   (2.20) 
                     
其中， 0q 為初始角度，θ為微量變化角度，x為D點對C點距離，y為B點對C點距離。 
令 1T 、 2T 及 pT 分別代表 AC連桿質量、 BD連桿質量(m = m2 + m3，即 AB質量m2加 AD質
 21
 
式中kθ及kp分別為撓性鉸鏈的旋轉彈性系數及壓電致動器的彈性系數，而kθ可表示為： 
 
)1(1
)2(
231)2(
12
2
2
2
2
2
gb
bbg
bb
g
b
bbJ -+-ú
û
ù
+
++
+
î
í
ì
ê
ë
é +
+=
Ebrk
 
                        
ïþ
ï
ý
ü
÷
÷
ø
ö
ç
ç
è
æ
-+-
-+
ú
ú
û
ù
ê
ê
ë
é
+
+
+ -
)1(1
2tan
)2(
)1(6
2
1
2
32 gb
bg
b
b
bb
b  (2.28) 
 
其中，r為撓性鉸鏈圓孔半徑，t為撓性鉸鏈最窄處的寬度，b為撓性鉸鏈厚度(即機構厚度)，h 
= t + b， r
t
2=b ， rh 2/=g  和E為彈性係數。 
所以，總位能為： 
PVVV += q                                (2.29) 
總虛功和為反作用力 cF、壓電致動器作用力P及撓性鉸鏈阻尼力；分別對 xd 、 yd 及dq 所
做的虛功為： 
 
[ ]dqqqqqqqqqd q )(sin43)cos(2)sin(2 02200 +--+-+= && pc clclFPlW           (2.30) 
 
將以上結果代入 Lagrange方程式，可得到運動方程式： 
 
 23
2.2 SR放大機構的最佳化設計 
田口方法（Taguchi method），是一種用來改善品質的工程方法，產品設計的重心在於產
品概念的選擇和參數的最佳化，這可藉由降低重要的品質特性之變異，田口設計可降低變異
或使系統對變異不敏感，這樣做可降低成本提高品質，而不需要以高成本的方法來控制品質，
其最終目的是節省更多的成本。田口方法是一個很有效的分析技術，SR放大機構參數設計步
驟是期望找出控制因子之最佳水準尺寸的方法，應用田口方法的特點，建立 SR 放大機構參
數設計流程圖，如圖 2.5 所示。在定立目標函數後，利用數個重要控制因子及水準數，即可
設計得最佳化尺寸。使用田口方法的優點是經由直角表和變異數分析，可有效的減少實驗的
次數，設計的過程中，先定義其控制因子和各控制因子的水準數，再將所決定的控制因子與
水準，配合直角表做實驗模擬，其以 ANSYS 電腦軟體模擬的方式，將所模擬出的結果求得
S/N比及計算分析其變異數[35]。 
 
1.定義目標函數
2.選擇回應圖
3.確認控制因子
及水準數
5.ANSYS模擬
與數據收集
4.選擇直角表
計算S/N比
完成回應表
及回應圖
預估最佳水準
組合下的S/N比
6.數據分析
7.確認實驗
確認
8.最佳化水準組合
Yes
No
 
圖 2.5 田口方法設計流程圖 
2.2.1 定義目標函數 
雖然 SR機構是一個線性位移機構，但由於 SR機構在機械製造上會產生誤差，且在機構
上固定點 C 並非是完美的設計，因此 SR 機構的輸出端點會發生微量的縱向偏移，故利用田
口方法作 SR機構輸出端點最佳化的直線度比設計，其直線度比定義為 SR機構輸出端點的縱
 25
列表如表 2.1。因為設定四個三水準的因子，共需要八個自由度，因此可選用 L9的直角表。
其中撓性鉸鏈偏移量的定義，以圖 2.7為說明圖，輸入端點施一力且垂直於水平 X軸向，當
撓性鉸鏈 C點與輸入端點 B點及施力方向在同一直線上，則撓性鉸鏈的偏移量值為零，反之，
撓性鉸鏈 C點與輸入端 B點及施力方向不在同一直線上，其之間的偏差值即為撓性鉸鏈偏移
量之值。 
 
           
(a) 0度       (b) 45度       (c) 90度 
圖 2.6 撓性鉸鏈位置之三種角度 
 
 
 
 
 
表 2.1 SR機構的參數和水準配置表 
控制因子 SR機構參數 水準 1 水準 2 水準 3 
A 撓性鉸鏈的位置 0° 45° 90° 
B 撓性鉸鏈的半徑 2.4 2.5 2.6 
C 撓性鉸鏈的寬度 8 9 10 
D 撓性鉸鏈的偏移量 0 0.5 1 
                                                       單位: mm 
 
 27
表 2.2 使用 L9 直角表模擬設計與 S/N比 
控制因子 
模擬組別 
A B C D 
△XD/△YD MSD S/N比 
1 1 1 1 1 29.4 1.61E-3 29.3697 
2 1 2 2 2 25.9 1.50E-3 28.2498 
3 1 3 3 3 43.6 5.26E-3 32.7912 
4 2 1 2 3 129 6.01E-5 42.2124 
5 2 2 3 1 37.1 7.25E-4 31.3987 
6 2 3 1 2 94.2 1.13E-4 39.4843 
7 3 1 3 2 71.2 1.98E-4 37.0438 
8 3 2 1 3 385 6.76E-6 51.7009 
9 3 3 2 1 52.0 3.69E-4 34.3242 
 
 
 
 
 
表 2.3  SR放大機構的 S/N回應表 
 
Mean S/N ratio (dB) 
控制因子 
Level 1 Level 2 Level 3 Max-min 
A 30.1369 37.6985 41.0230 10.8861 
B 36.2087 37.1165 35.5333 1.5832 
C 40.1850 34.9288 33.7446 6.4404 
D 31.6975 34.9260 42.2349 10.5374 
 
 
 29
 
(2) 主效果的平方和 
對於一因子 A，具有 p水準，且每一水準有 m個觀測值，那麼此因子的平方和為: 
 
CF
m
AAA
SS pA -
+++
=
22
2
2
1 )(...)()(
 (2.40) 
 
其中 Ai為因子 A 在水準 i 之觀測值總和。如果每一水準的觀測值數目不同，設為 mi，
i=1,2,…,p,那麼 
 
CF
m
A
m
A
m
ASS
p
p
A -+++=
2
2
2
2
1
2
1 )(...)()(
 (2.41) 
 
對於一具 p水準的因子之自由度為 p-1。 
 
(3) 誤差平方和(SSE) 
SSE為總平方和減去主效果平方和及所有交互作用效果平方和。 
(4) 誤差變異數(error variance) eV  
誤差變異數=誤差平方和/誤差自由度 
 
(5) 貢獻度 
定義貢獻度 ρ為淨平方和佔總平方和的百分比。 
 
%100´
¢
=
TSS
SS A
Ar  (2.42) 
 31
D 174.8775 2 87.4387 171.0906 46.1794 39.2490 
誤差 3.7869 2 1.8935 15.1477 - 3.479 
總計 435.9102 8 - - - 100 
 
2.2.4 確認實驗 
為了避免高估最佳條件的 S/N比，我們僅用影響效果較強的因子來估算，因為因子 B的
平方和很小，所以合併當作誤差，而不把它的改善效果包括在內;至於選取具顯著性的因子，
則利用因子效果圖作主觀判斷，或以各因子的貢獻度百分比來進行評選。在決定了最適當條
件及其對應的預測值後，須在最當適參數設定下進行驗證，然後把模擬得到的 S/N比與所預
測的做一比較，這個預測最佳化 S/N比的值，可經由下式取得(忽略 B和 C兩個控制因子): 
 
dBTDTATf   9717.46)3()3( =-+--=h        (2.44) 
 
其中， å
=
=
n
i
in
T
1
1
h  
這個 fh 的 S/N比最佳化組 8h (51.7009)的模擬值還小，因此選擇 8h 的 S/N比模擬值為尺寸
最佳化的組合。 
 
2.3 ANSYS有限元素分析 
有限元素法是一個數值的程序，可以用來求解像是包含應力分析、振動分析等廣泛的工
程問題，有很多實際的工程問題我們無法獲得精確解，這種難以獲得解答可歸因於複雜的統
御微分方程式或是難以處理的邊界和初始條件，要處理這類的問題，只能訴諸於數值的近似
值。與解析解做對比，解析解顯示系統內任一點精確的行為，它可應用到各種的工程問題上
以獲得解答，穩態、暫態、線性或非線性問題的應力分析等問題，都可以用有限元素法來分
 33
 
 
表 2.5 SR放大機構鉸鏈徧移之直線度比 
鉸鏈徧移量 模擬直線度比 
0 mm 40.5 
1 mm 98.3 
 
2.4實驗分析 
為了驗證田口方法所設計之最佳化 SR放大機構，利用實驗量測 SR放大機構的特性，如
圖 2.10所示為 SR放大機構的實驗流程圖，實驗流程中先從電腦送出訊號，透過數位/類比訊
號轉換器(D/A converter)傳送訊號，訊號經由電壓放大器將電壓放大，再傳送給壓電陶瓷致動
器，由壓電陶瓷致動器驅動 SR機構的輸入端來改變 SR機構的輸出位移，並利用電容式位移
感測器量測 SR 機構的輸出位移量，電容式位移感測器量測到位移時，將訊號轉換成電壓訊
號，並經由類比/數位訊號轉換器(A/D converter)傳回給電腦，電腦再將訊號給記錄下來。實
驗驅動之電腦軟體以 LabVIEW程式撰寫，驅動方式則以壓電陶瓷致動器每秒 15 V增加到 150 
V 作為輸入的訊號，利用電容式位移感測器量測 SR 機構的輸出端點位移量，所以我們即可
得到輸入電壓與 SR機構輸出端點位移量的關係，SR機構位移量測實體圖如圖 2.11所示。 
 
 35
 
(a) 撓性鉸鏈偏移量為 0 mm。 
 
 
(b) 撓性鉸鏈偏移量為 1 mm。 
圖 2.12 SR放大機構實驗量測的輸入電壓與位移的關係圖 
 
圖 2.13所示為 SR機構的撓性鉸鏈偏移量為 0 mm 和 1 mm，當輸入電壓從 0 V增加到
150 V時，SR 機構所測量到輸出端點 X方向與 Y方向的位移直線度比，當輸入電壓為 150 V
時，SR機構的撓性鉸鏈偏移量為 0 mm時，輸出端點的直線度比為 22.77;當輸入電壓為 150 V
時，SR 機構的撓性鉸鏈偏移量為 1 mm時，輸出端點的直線度比為 28.72，故撓性鉸鏈有偏
移量的直線度比沒有偏移量的直線度比大。其表 2.6為將 SR放大機構的理論值與模擬及實驗
值整合之比較表，由表中之數據可明顯看出 SR 放大機構有鉸鏈徧移的位移量與直線度比，
比鉸鏈沒有徧移量效果來得好，其中 SR放大機構鉸鏈徧移 1 mm之直線度比實驗，鉸鏈有徧
移的直線度比相較於鉸鏈沒有徧移的高，但與理論及模擬之值比較，相差相當大，主要原因
 37
定位平台的外形如圖 2.14所示，由於工作平台在整體機構的中心，為了確保工作平台的平行
度，我們利用導引彈簧的回彈特性，將工作平台與基座連結，並利用 ANSYS 電腦模擬分析
不同形狀之導引彈簧的特性，如圖 2.15所示;模擬過程中先設定以單一壓電致動器驅動，如圖
2.14中之壓電致動器對 A點施 1 μm的位移量時，並量測 O點延著 Y軸向的位移量做比較，
經由 ANSYS 電腦模擬分析後可得，當工作平台沒有導引彈簧與基座連結時，如圖 2.15(a)所
示，O點延著 Y軸的移動位移量為 1.373 μm，若以半圓形的導引彈簧作為工作平台與基座連
結時，如圖 2.15(b)所示，其 O點延著 Y軸的移動位移量為 1.087 μm，最後用半橢圓形導引彈
簧作為工作平台與基連結時，如圖 2.15(c)所示，其 O點延著 Y軸的移動位移量為 1.245 μm，
將此比較彙整如表 2.7，由此得知，為了增加工作平台的平行度，利用半橢圓形導引彈簧連結
工作平台與基座，可得到與沒有導引彈簧較相近的驅動範圍，故我們設計半橢圓形導引彈簧
來加強工作平台的平行度。 
 
 
圖 2.14 平面式三自由度奈米定位平台模型圖 
 
          
 39
固定基座
活動槽
容置槽
工作平台
固定孔
半橢圓形
導引彈簧
壓電致動器
SR放大機構
定位孔
 
圖 2.16 平面式三自由度微奈米定位平台 
     
2.6性能實驗分析 
圖 2.17顯示所建構之三軸長行程微奈米定位平台，其主要是由粗定位用之伺服馬達與細
定位之壓電致動的平面式三自由度微奈米定位平台所組成，在伺服馬達的選用方面，本計畫
選用日本 MITSUBISHI–J2-SUPER 三菱汎用 AC 伺服馬達，而壓電致動器則是使用 NEC 
TOKIN 公司生產積層式壓電致動器(multiplayer piezoelectric actuator)，伺服馬達的總行程為
100毫米，壓電致動器可產生 17 μm的位移量，為了整個控制系統的穩定、堅固性和更高的
共振的頻率，使用特殊了防震機制為實驗硬體架構的基座。在實驗過程中的硬體設備，我們
有一台 Celeron 2.0個人電腦(PC)、NI所產的 PCI-7344運動控制卡、伺服馬達、伺服馬達驅
動器、光學尺編碼器、停止開關、NEC TOKIN 公司生產積層式壓電致動器、PCI-6054 與
PCI-6703資料擷取卡、電容式位移感測器及自製平面式微奈米定位平台等，如圖 2.18所示。
在軟體的使用方面，我們主要將使用對應支援於 PCI-7344運動控制卡 LabVIEW的應用程式。 
 41
2.6.1 粗定位平台性能測試 
本節將針對伺服馬達驅動平台的 X、Y及 θZ三軸實驗分別探討，伺服馬達驅動平台 X軸
與 Y軸是以電流控制伺服馬達，並且以光學尺作為位置訊號的回授，在給定平台的目標位置
後，利用控制器使滑動台達到誤差範圍在 1 μm以內的位置，θZ軸是以電流控制伺服馬達，且
以編碼器作為位置訊號的回授，在給定平台的目標位置後，利用控制器使平台達到誤差範圍
在 100 μrad以內的位置，在初期之平台性能測試，本計畫將使用 PID控制器作為基礎性能測
試之控制器，其 PI控制器的值設定為 P=7，I=0.3;圖 2.19所示為 X軸向經由 PI控制器，對 1 
cm的定位追蹤實驗結果，圖 2.19(a)所示為伺服馬達驅動 X軸向 1 cm，其大約在 0.7 秒即可
達到穩定，且 Y軸向的干涉是小於 mm以下之尺度，圖 2.19(b) 所示為伺服馬達驅動 X軸向
1 cm時，θZ軸向的干涉也是小於 0.01 rad以下之尺度。圖 2.20所示為 Y軸向經由 PI控制器，
對 1 cm的定位追蹤實驗結果，圖 2.20(a)所示為伺服馬達驅動 Y軸向 1 cm，其大約在 0.7 秒
即可達到穩定，且 X 軸向的干涉是小於 mm 以下之尺度，圖 2.20(b)所示為伺服馬達驅動 Y
軸向 1 cm時，θZ軸向的干涉也是小於 0.01 rad以下之尺度。圖 2.21所示為 θZ軸向經由 PI控
制器，對 1 rad的定位追蹤實驗結果，圖 2.21(a)所示為伺服馬達驅動 θZ軸向 1 rad時，X軸向
與 Y軸向的干涉都小於 mm以下之尺度，圖 2.21(b)所示為伺服馬達驅動 θZ軸向 1 rad時，其
大約在 0.5 秒即可達到穩定。 
 
   
(a) X軸與 Y軸位移值。            (b) θZ軸位移值。  
圖 2.19 伺服馬達平台驅動 X軸向 1 cm的定位追蹤結果 
 
 43
某一特定位置(X，Y，θZ)，3支壓電陶瓷致動器需要輸入一組對應的電壓組，將兩邊同乘
[ ] [ ][ ]( ) 1-TT OOO ，可得出[T]、[I]及[O]的關係如下式: 
 
[ ] [ ][ ] [ ][ ]( ) 1-= TT OOOIT  (2.46) 
 
經由實驗結果可找出轉換矩陣[T]如下: 
 
[ ]
ú
ú
ú
û
ù
ê
ê
ê
ë
é
-
-
--
=
359009.0800760.8366205.5
308964.0674224.002229.8
250111.0428814.7318878.5
T  (2.47) 
 
求出轉移矩陣後，即可指定單一軸向或是多軸向所對應之三個壓電致動器之輸入電壓關
係，壓電致動平台之三個壓電致動器輸入定為(V1，V2，V3 )，輸出三個軸向位移為(X，Y，θZ)，
其輸入電壓值與輸出位移值之關係為: 
 
[ ]
ú
ú
ú
û
ù
ê
ê
ê
ë
é
×=
ú
ú
ú
û
ù
ê
ê
ê
ë
é
z
Y
X
T
V
V
V
qD
D
D
3
2
1
 (2.48) 
壓電致動平台之輸入電壓值與輸出位移值的轉換矩陣如(2.48)式，我們將利用此轉換矩
陣，配合前饋 PID控制器來做壓電致動平台的精密定位，實驗方式是 X軸與 Y軸由初始狀態
先移動到-1 μm後，再每隔兩秒增加 1 μm的位移量到 2 μm，θZ軸向則以每兩秒增加 50 μrad
到 370 μrad的旋轉量，之後立即再以每兩秒降低 50 μrad旋轉量到達初始狀態，我們將 PID
控制器的參數設定為 P = 20，I = 0.008，D = 0.006進行實驗量測。 
 
(Ⅰ) 壓電致動平台最大位移量 
圖 2.22 所示為壓電致動平台經由前饋 PID 控制器之 X 軸向的控制位移圖，圖 2.22(a)所
示為 X軸向可移動範圍的位置圖與 Y軸向的位置干涉圖，圖 2.22(b) 所示為 X軸向在移動位
置時，θZ軸向的位置干涉圖，由兩圖可看出當 X 軸向在做負向位置移動轉向正向位移時，Y
軸與 θZ軸的干涉會較大(即在第四秒時)，且在做位置移動時，移動的瞬間會有掁盪，但階可
 45
的位置干涉圖，由兩圖可看出當 θZ軸向在正向旋轉 370 μrad降低到 300 μrad時，X軸向與 Y
軸向的干涉會較大，且在旋轉值改變的瞬間會有掁盪，但階可在極短的時間內達到穩定，故
θZ軸向最大旋轉範圍為 370 μrad。 
 
            
(a) θZ軸旋轉值                         (b) X軸與 Y軸位移值 
圖 2.24壓電致動平台驅動 θZ軸向之三軸向位移比較圖 
 
(Ⅱ) 壓電致動平台最小解析度 
壓電致動平台除了最大位移量的量測外，最重要的是精密平台的解析度，解析度的量測
方式是命令位置以步階的形式輸入，經由前饋 PID控制器控制送出訊號，再由電容式位移感
測器接收訊號，如圖圖 2.25所示為 X軸向的解析度量測結果，圖 2.25(a) 所示為 X軸向每秒
增加 40 nm到 400 nm後，再以每秒減 40 nm至原點的步階位移訊號，圖 2.25(b) 所示為 X軸
向每秒增加 30 nm到 300 nm後，再以每秒減 30 nm至原點的步階位移訊號，圖 2.25(c) 所示
為 X軸向每秒增加 20 nm到 200 nm後，再以每秒減 20 nm至原點的步階位移訊號，圖 2.25(d) 
所示為 X軸向每秒增加 10 nm到 100 nm後，再以每秒減 10 nm至原點的步階位移訊號，由
圖 2.25所示可知壓電致動平台 X軸向的定位解析度是 40 nm。 
 
 47
        
(a) 每步階為 40 nm                  (b) 每步階為 30 nm 
         
(c) 每步階為 20 nm                  (d) 每步階為 10 nm 
圖 2.26 Y軸向的解析度量測結果 
 
圖 2.27 所示為 θZ軸向的解析度量測結果，圖 2.27(a) 所示為 θZ軸向每秒增加 2 μrad到
20 μrad後，再以每秒減 2 μrad至原點的步階位移訊號，圖 2.27(b) 所示為 θZ軸向每秒增加 1 
μrad到 10 μrad後，再以每秒減 1 μrad至原點的步階位移訊號，由圖 2.27所示可知壓電致動
平台 θZ軸向的定位解析度是 2 μrad。 
 
        
(a) 每步階為 2 μrad                 (b) 每步階為 1 μrad 
圖 2.27 θZ軸向的解析度量測結果 
 49
第三章 多軸長行程微/奈米級定位平台之系統鑑別與控制(第二年) 
本章節主要是使用基因演算法則來進行系統鑑別，基因演算的概念自1960 年代起即有許
多學者參於研究，剛開始時是將其應用於模擬生物遺傳來解決最佳化的問題。基因演算法的
最大優點是當它在尋求問題之最佳化解的過程中，可以避免陷入局部最佳點，因此能找到全
域最佳點的機會較大，而且已被廣泛應用於各類實際的工程最佳化問題，例如自動控制、機
器學習、函數最佳化等[36, 37]。在進行完成系統鑑別之後，我們將使用適應性法則對系統進
行控制器之設計，此控制器之功能除了能達到使定位平台可以達到長行程之功能外，還能夠
針對軸與軸之間的干涉而達到消除耦合之功能，亦即解耦合之功能，進而達到解耦合控制器
及輪郭追蹤控制之設計功能。 
3.1 簡介 
壓電致動器的定位控制和遲滯補償的建模技術，在過去的一些文獻中已初步的探討 
[38-40](43-45)，其中的機構系統建模方式，一般皆是使用MCK系統配合微分方程式之建立，
即可完整的建構出機構系統之動態方程式，並且可以描述出系統之非線性狀態。 
3自由度(X、Y、θz)精密定位平台之控制，在過去的文獻中，Chang等 [41, 42]提出極端
精密的XYθz壓電致動定位平台，其中之設計主要是利用XY方向裝置壓電致動器，透過撓性
鉸鏈(flexura)進行θz的旋轉。王和張 [8](48)提出發表一篇具耦合分析及最佳化設計的3自由度
微奈米定位平台。在這個組合式的機構中，是由複雜的撓性鉸鏈結構及三個PZT致動器所構
成的。由這一篇的探討中，我們發現其機構亦有很大的耦合現象。因在為了解決這個耦合現
象，在[41-42]的這些文章中，將提出設計可以避免耦合之機構，而在[41-43] .的這些文獻中更
出如何進行相關之系統鑑別及輪廓追蹤的方法。 
有這個計畫的第一個焦點即是如何鑑別三自由度(X, Y, θz)定位平台，及使用壓電致動器
所產生之非線性行為。對於遲滯現象的描述可以使用Bouc-Wen微分方程式來進行描述[44]。
在遲滯模型之參數鑑別，我們可以使用實數型基因演算法(real-coded genetic algorithm, RGA)
的方法，來鑑別出最佳之參數值[45, 46]。RGA這是搜索近最佳解決的法則，已經被證明在這
 51
,q s q q s dv R i pl w l= + +     (3.1a) 
,d s d d s qv R i pl w l= + -  (3.1b) 
 其中 
,qqq iL=l     (3.2a) 
.fdmdddd ILiL +=l  (3.2b) 
上式方程式中， dv 和 qv 分別為 d軸與 q軸之定子電壓， di 和 qi 分別為 d軸與 q軸之定
子電流， dL 和 qL 分別為 d軸與 q軸之定子電感， dl 和 ql 分別為 d軸與 q軸之定子
磁通鏈， sR 和 sw 分別為定子電阻與換流器切換頻率。而且在方程式 (3.2b)式中 fdI
為等效 d軸磁化電流， mdL 為 d軸互感。  
電磁轉矩 (electric torque)可表示為  
*
e t qk it =   (3.3) 
其中 *qi  是控制電流命令，而 tk  是馬達扭力常數。通常 PMSM 是使用命令電壓
*
qv .做為控
制命令之輸出。但從以下我們將轉換成為真正控制 PMSM 之真正訊號，也就是控制 PMSM
轉子之電流信號，其式子表示如下： 
 
*
* q s d
q
s q
v
i
R L s
w l-
=
+
                                                              (3.4) 
其中 s  是 Laplace轉換。而應用扭力可以獲得如下式： 
e m m r m rB Jt t w w= + + &  (3.5) 
其中 mt  是負載扭矩，去做用在馬達轉子上 rw，而其變數之定義分別 rw  是馬達轉子角度，
 53
*
z z zM θ C θ K θ3 3 3 t3 q3 3K i D+ + = +&& &                                                 (3.9c) 
其中 
1 2 3M M M
2
d
m
l m J
2p
æ ö= = = +ç ÷
è ø
,  1 2 3C C C mB= = = ,  1 2K K ( )
2dl K
2p
= = , t1 t 2 t
ldK K k
2p
= =  
及下標 1，2和 3 分別是表示 X–, Y–和 zθ –之軸向。而其中的M 是質量，C 是阻尼係數, K
是剛性係數，而 D  則是描述來自外部的干擾及其它軸向來的交叉耦合能量，最後我們可以
將粗定位平台由 PMSM驅動之控制方塊圖表示成如圖 3.1所示。其中輸入的位置命令，透過
控制器之轉換可轉成電壓命令，由(3.4)式可知，最後送到馬達進行控制的則是電流命令。 
*
qv
Position 
controller
1 1 1M C K
2
1
s s+ +
dl
2p
X
tK
*
qi
+
-
1D
+
+
dl
+
-
e
s q
1
R L s+
d
2
l
p sr
w X&psw
*X
 
圖 3.1  X– 軸向 PMSM位置控制方塊圖 
3.2.2 適應性控制器設計 
為了簡化對於適應性之控制器設計，我們將只針對(3.9a)式，即X– 軸進行設計，而PMSM
之動態方程式可寫成下式： 
*( C K )
M t1 q1 1 1 11
1X K i D X X= + - -&& &                                              (3.10) 
狀態變數可以定義成如下式： 
1X X= , 2X X= &   (3.11) 
其中 1X 和 2X  是分別表示X–方向的位移和速度，將該數學模型進行一次微分可得下式： 
 55
( ) ( )* 2 21 2 21 1 2 1 1 2 1 1 2 2 2 1 2 2
2 2 1 1
( ) ( )
( )q d dt
M e ei e X X D C X K X e e x e e e
e e k M
ì üé ù- ± Dï ï= - + - - - ± D - - ± Dí ýê ú± D ï ïë ûî þ
& &                                      
(3.18a) 
2 2
1
1
e eD
M
h
± D
=&                                                            (3.18b) 
                                                                 
由(3.16)-(3.18)式, Lyapunov 穩定法則可以滿足的得到如下： 
2 2
1 2 0L e e= - - £&  (3.19) 
最後的結果，由於使用控制律(3.15)式和適應律(3.16)式，對於 X– 軸向之控制器設計，
Lyapunov穩定法則是令人滿意的。此外，漸近穩定法則被證明在系統的穩定追蹤和外部干優
消除，有顯著的效果。此控制器在 X– 軸向所產生之結果，對於 Y– 和 zθ – 軸向也會有同樣
的結果。 
3.3三軸壓電平台系統 
3.3.1 壓電平台數學模型 
關於平面式三自度精密定平台之數學建模方面，我們還是使用二階之微分方程式來進行
描述，為了處理真實系統中之交叉耦合現象，我們將在剛度矩陣裡考慮交叉耦合影響，其表
示式如下： 
1 1 2
2 1 2
1 2
0 0 0 0 ( )
0 0 0 0 ( )
0 0 0 0 ( )
z z z z z z z z
x x x x x ex x x
y y y y y ey y y
e
m x b x k k k x k d V h
m y b y k k k y k d V h
I b k k k dk d V hq q q q q q q qq q q
é ù é ù é ùD D -é ù é ù é ù é ù
ê ú ê ú ê úê ú ê ú ê ú ê ú+ + D D = -ê ú ê ú ê úê ú ê ú ê ú ê ú
ê ú ê ú ê úê ú ê ú ê ú ê úD D -ë û ë û ë û ë ûë û ë û ë û
&& &
&& &
&& &
    (3.20) 
其中 x, y 和 θ分別用來描述三個軸向之物理量， 1m  和 2m  是等效的其量， I  是轉動貫量， 
,x yb b  和 zbq 是黏滯係數， xk  yk  和 zkq  是等效的彈係數，而 xkD , ykD 和 zkqD 則是用來描述
交叉耦合的剛性係數，它們分別是由 x-, y- and θz-三軸的撓性鉸鏈所產生之拓樸虛擬誤差。而 
d 則是由 θz-旋轉量所產生之拓樸虛擬誤差。 x  和 y  是輸出位移， zq  是輸出旋轉角度, xh , 
 57
解之條件來設計適應函數(fitness function)，而適應函數值較高的物種將被挑選至交配池中，
這樣的步驟就是複製過程，接著再依交配及突變過程的運算，便完成一代的基因遺傳演算法
則，如此反覆的下去以產生適應性最強的物種[45-46]。在以後的章節裡關於系統參數的鑑定，
我們將針對適應函數的設計然後利用 RGA方法，去進行系統的鑑別。 
3.4.2適應函數 
適應函數 (fitness function)在基因演算法中，代表著一項很重要的性能   指標
(performanceindex)。對於求一極小值的目標函數(objective function)問題，可以利用一極大值
減去目標函數而求得適應函數。因此 PMSM之馬達模型在(3.9)式被描述著，我們將利用 RGA
法則去加以鑑別出最佳之參數值，如何去鑑別出最佳之參數值，主要之關鍵是在適應函數之
的定義，以下我們將定義一適應函數去鑑別 PMSM參數值： 
( )
2
1
DM,C,K, t n
i
i
F K
E
=
=
å
  (3.23) 
( ) ( )ii
iE X X
*= -  (3.24) 
其中 M , C , K , 和 tK 是要鑑別之參數，而D是一個正數，n是所有樣本數，而 iE 則是計
算各世代之誤差值， i則是世代數 , ( )iX  是實驗得到之位移值。然後利用 MATLAB 中之 
fourth-order Runge-Kutta 法則去解(3.9)式，我們可以去得到最佳解
( i )
X * ，一樣的其它兩軸向
可以用此法得到最佳解，而找出最佳之參數值。 
    在平面式三自由度之壓電致動精密平台方面，跟據(3.20)式我們可以發現需要鑑別的參數
有 27個 1m , 2m , I , xb , yb , zbq , xk , 1xkD , 2xkD , yk , 1ykD , 2ykD , zkq , 1zkqD , 2zkqD  of Eq. 
(1) and xa , xb , xg , ya , yb , yg , zqa , zqb , zqg , exd , eyd , zed q ，因此我們可以將適應函數定
義如下： 
 59
數， , ,
z zx x y yV u V u V uq q=  =  =
& & & 則是輸入控制電壓的改變率。透過(3.20)和(3.21)式之關係，我們
可以推導出下式之關係： 
1 2
1 2
2 1 2 3 4 1 1
1 1 1 1 1 1 1
3
4 3 3 4 3 4
x x x ex x x x x
z
x
x ex x x
x x
k b k d k k k dx x x x x y
m m m m m m m
x u
x d x x x x x
q
a b g
=
D D
= - - + - - - -
=
= - -
&
&
&
& & & &
                    (3.22) 
1 2
1 2
2 1 2 3 4 1 1
2 2 2 2 2 2 2
3
4 3 3 4 3 4
y y y ey y y y y
z
y
y ey y y
y y
k b k d k k k d
y y y y y x
m m m m m m m
y u
y d y y y y y
q
a b g
=
D D
= - - + - - - -
=
= - -
&
&
&
& & & &
                      (3.23)  
1 2
1 2
2 1 2 3 4 1 1
3
4 3 3 4 3 4
z z z z z z z z
z
z z z z
z z
e
z z z z z
z
z e z z z z z
k b k d k k k d
x y
I I I I I I I
u
d
q q q q q q q q
q
q q q q
q q
q q q q q
q
q a q b q q g q q
=
D D
= - - + - - - -
=
= - -
&
&
&
& & & &
                  (3.24)  
    由上述，我們得到很常令人遺憾的結果，即是在(3.21)式中的遲帶變數 4x , 4y  and 4zq 在
描述在系繰動態中，但由於(3.22-3.24)中的非線性的絕對函數是不可得的。因此 4x , 4y  and 
4zq 是不可知道的物理量。為了節省文章之長度，我們將只秀出 4x 進行推導，使得 4x 變數可
以精確的產生高性能控制效果。因此我們將在狀態空間下，使用 Taylor級數展開去漸近 4x 變
數，由於絕對值有正負號之分，因此我們將有以下四個考慮[49]： 
Condition 1: 3 0x <&  and 4 0x < , 4 3 3 4( )x ex x xx d x x xa b g= + +& & &                       (3.25a)  
Condition 2: 3 0x >&  and 4 0x > , 4 3 3 4( )x ex x xx d x x xa b g= - +& & &                       (3.25b) 
Condition 3: 3 0x <&  and 4 0x > , 4 3 3 4( )x ex x xx d x x xa b g= + -& & &                       (3.25c) 
Condition 4: 3 0x >&  and 4 0x < , 4 3 3 4( )x ex x xx d x x xa b g= - -& & &                       (3.25d)  
   我們可以去簡化(3.25a)式和(3.25d)式，然後去解出 4 ( )x t ，我們將(3.25a)兩邊同時進行積
 61
1 1
1 x ex
x x x x
dd k d
m q
a
f
é ùæ ö
= - +ê úç ÷
è øë û
. 在 y- 和 θ-軸向方面，我們也將使用的方法進行處理，可獲得
下式： 
1 2
2 1 1 2 2 3 3 1 1 2 1
3
y y y y y z y
y
y y
y a y a y a y a x a d
y u
q
=
= - - + - D - D -
=
&
&
&
                                  (3.32) 
1 2
2 1 1 2 2 3 3 1 1 2 1
3
z z z z z z
z
z z
z z z z
z
a a a a x a y d
u
q q q q q q
q
q q
q q q q
q
=
= - - + - D - D -
=
&
&
&
                              (3.33) 
其 中  1 2/y ya k m= , 2 2/y ya b m= , 3 2/y y eya k d m= , 1 1 2/y ya k mD = D , 2 2 2/y ya k mD = D , 
2 1
1 y ey
y y y y
d
d k d
m q
a
f
é ùæ ö
= - +ê úç ÷
ê úè øë û
, 1 /z za k Iq q= , 2 /z za b Iq q= , 3 /z z zea k d Iq q q= , 1 1 /z za k Iq qD = D , 
2 2 /z za k Iq qD = D  and 
1
1 z z
z z z z
edd k d
I q
q q
q q q q
a
f
é ùæ ö
= - +ê úç ÷
ê úè øë û
. 最後我們可以推導得到，平面式三自由
度之壓電致動平台，其動態方程式之表示如(3.31-3.33)所示。 
 
3.5.2 ABC控制器設計 
根據(3.31)式，將去使用 ABC 控制器，去設計軌跡追蹤控制器，證明的部份我們將只秀
出 x-軸的推導過程。這個追蹤誤差可以定義成如下： 
1 1 de x x= - ,                                                                (3.34a) 
2 2 1ae x x= - ,                                                               (3.34b) 
3 3 2ae x x= - ,                                                               (3.34c) 
其中 dx  主要是描述設計位移，而 1ax  和 2ax 主要是分別 2x  對 3x 進行在設計穩定控制用
之增益值。因此我們可以分別從(3.34b)和(3.34c)式獲得 2 2 1ax e x= +  和 3 3 2ax e x= +  ，然後我
們將(3.34a-c)進行一次微分，我們可以得到下式：  
 63
( )1 2 1 1 2 3 3 3 2 2 1 1 1 2 2 1 1
3
2 1 1 1 1 2 2 1 1 2 1 1 3 3 3 2
2 2 1 1 2 2
1 2 3
1 ˆ[ (
ˆˆ ] [(
1 1 1ˆ ˆ) ]
d d x x x x x
x
x z x a x x x x z x a
a a x x x x x
L e e c e x x e a e a c e e a x a x a y
a
a d x a x a x a y a d x e c e e
x x a a a a d
q q
b b b
é ù= + - + - + + ´ - - + + + Dë û
     + D + + ) - - - D - D - - + - -
     + - + D D + D D +
& & &
& &
%& && & % % ˆ .xd
&
      (3.40) 
由(3.40)我們可以重新整理出微分一次的 Lyapunov 函數如下： 
2 2 2
1 1 2 2 3 3 2 1 1 2 2 1 2 1 1 2 2 1 2 2
1 1 2 2
1 2 3
ˆˆ ˆ
1 1 1 ˆˆ ˆ 0.
x x z x x z x x
x x x x x x
L c e c e c e e a y e a e a y e a e d e d
a a a a d d
q q
b b b
= - - - + D + D - D - D + -
       + D D + D D + £
&
&%& &% %
        (3.41) 
為了使滿足 Lyapunov穩定性定理，我們可以設計出適應律如下︰ 
1 1 2ˆx 1a e ybD = -& ,                                                             (3.42) 
2 2 2ˆx z1a eb qD = -& ,                                                            (3.43)  
3 2
ˆ
xd eb= -
&
.                                                                (3.44) 
將(3.42)-(3.44)代入(3.41)我們可以獲得下式之最後結果： 
2 2 2
1 1 2 2 3 3 0L c e c e c e= - - - £&                                                    (3.45) 
本計畫所設計 ABC控制器，其控制律(3.39a-c)式和適應律(3.42)-(3.44)式，最後可以滿足
Lyapunov 的穩定法則，由(3.45)式可知。而且，如果 x-, y- and θz- 軸的控制參數是大略被設
計的， 其三自由度平台的穩定的漸近軌道控制和改善壓電致動器所產生的遲滯行為，也是可
以達到的。 
3.6二階段式控制法則 
在這個章節中我們將使用二階段式的控制器來對 XY zq 進行精密定位控制。這個二階段式
的控制策略，秀在圖 3.2中，在圖中說明了當 PMSM定位進入了 1  μm£ 之定位精度後，控制
系統會將控制力切換至壓電致動器，即 ABC控制器，讓後讓誤差可以在奈米的尺度，因此二
階段之定義，即是第一階段定位平台的驅動是使用 PMSM，而第二階段定位平台的驅動是使
 65
+
-
dX
*
q1i
p1V%
X
xe
Adaptive
 controller The PMSM 
The ABC
controller1μm£  
1 μm>
The PA
Table
 
(b) 
Fig. 3.2  二階段控制系統  (a)控制策略(b) X–軸向的控制方塊圖 
 
3.7 數值模擬與實驗結果 
   本計畫在第二年的系統鑑別及系統解耦合控制的實驗設備購置與配置，正與第一年相
同，因此其相關之實驗建購請參照2.6節。 
3.7.1系統鑑別 
在這個實驗過程，我們將去比較我們給數值模擬和實驗同樣的電壓，去比較其輸出值，
亦即輸出之位移量。在實驗過程中，主要我們將要給的電壓，由電腦送出，經過D/A送過
PMSM，透過所設計欲送出之動態電壓訊號，我們可以量到同產生之動態位移訊號，透過這
樣的輸入與輸出的關係，我們利用RGA之法則去鑑別出系統之相關參數。 
( ) ( ) ( )( )
( ) ( )0 1 0 1
V t A+ Bsin t mod t ,T ,
tt mod ,
T
w
w w w w
=
æ ö= + - ç ÷
è ø
                                               (3.47) 
其中 A 和 B 分別是輸入電壓V的準位和放大增益值。而 T 是時間週期，而 w0 和w1 則是
最小和最大之頻率。在PMSM系統鑑別時，我們將設定 A=B=48, w0=1, w1=100, T=10。 
此時比較分析實驗與數值模擬鑑別出來的響應位移，如圖3.4所示是PMSM系統之響應，
而圖3.4(d-f)則是秀出PMSM系統之響應位移誤差量，其中我們可以發現在位移量之誤差是在
0 2. mm± 以下，而旋轉角之誤差則是在 10 radm± 以下。接下來我們對壓電平台進行分析實驗
 67
表3.1 PMSM鑑別之系統參數 
Parameters Feasible domains Identified values 
1 3M , M , M   (kg)2   0 ~10 2.890,  3.030,  3.424 
1 2 3C   (Ns/m), C   (Ns/m), C   (Ns/m)  40 ~1 10  ´  
3 3
3
2.005 10 , 2.033 10
       2.081 10
´ ´
´
 
1 2 3K , K , K  (N/m)  
70 ~1 10  ´  
63.199 10´ , 63.201 10´ , 
63.119 10´  
1 2 3,  ,   (Nm/A)t t tK K K  0 ~ 1 0.561, 0.563, 0.351 
 69
(
)
D
is
pl
ac
em
en
t x
 μ
m
(
)
D
is
pl
ac
em
en
t y
 μ
m
(
)
z
R
ot
at
io
n 
μr
ad
q
( )Time s
( )Time s
( )Time s
(
)
Er
ro
r 
μm
(
)
Er
ro
r 
μm
(
)
Er
ro
r 
μr
ad
( )Time s
( )Time s
( )Time s
(a)
(b) 
(c) 
(d) 
(e) 
(f) 
0.0 0.2 0.4 0.6 0.8 1.0
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
 
 
 
 Simulations
 Experiments
0.0 0.2 0.4 0.6 0.8 1.0
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
4.0
 
 
 
 
 Simulations
 Experiments
0.0 0.2 0.4 0.6 0.8 1.0
0
20
40
60
80
100
120
 
 
 
 Simulations
 Experiments
0.0 0.2 0.4 0.6 0.8 1.0
-0.3
-0.2
-0.1
0.0
0.1
0.2
0.3
 
 
 
0.0 0.2 0.4 0.6 0.8 1.0
-0.4
-0.3
-0.2
-0.1
0.0
0.1
0.2
0.3
0.4
 
 
 
0.0 0.2 0.4 0.6 0.8 1.0
-4
-2
0
2
4
6
8
10
12
 
 
 
 
圖 3.4 對 PMSM 系統進行實驗值與模擬值之比較。(a-c)分別是 x -、 y -和 zq -三軸向之位
移響應。(d-f)則是位移響應誤差。  
 
 71
現象，經過這個圖形之比較分析，我們可以清礎的得到當沒有進行控制器時，系統會因為輸
入之電壓大小，正比與產生的耦合現象大小，但是當我們利用控制器進行控制時，我們會明
顯的發現在各軸向間之干涉明顯的得到改善。 
(
)
D
is
pl
ac
em
en
t y
 μ
m
(
)
D
is
pl
ac
em
en
t x
 μ
m
(
)
D
is
pl
ac
em
en
t x
 μ
m
( )Time s
( )Time s
( )Time s
(
)
z
R
ot
at
io
n 
 μ
ra
d
q
(
)
z
R
ot
at
io
n 
 μ
ra
d
q
(
)
D
is
pl
ac
em
en
t 
 μ
m
y
( )Time s
( )Time s
( )Time s
( )d ( )e
( )f ( )g
( )h ( )i
with controller
without controller
without controller
with controller
with controller
without controller
without controller
with controller
with controller
without controller
without controller
with controller
0 1 2 3 4 5
-0.03
-0.02
-0.01
0.00
0.01
0.02
0.03
0.04
0.05
0.06
 
 
 
0 1 2 3 4 5
-1.0
-0.8
-0.6
-0.4
-0.2
0.0
0.2
0.4
0.6
0.8
1.0
 
 
 
0 1 2 3 4 5
-0.06
-0.04
-0.02
0.00
0.02
0.04
 
 
 
0 1 2 3 4 5
-1.0
-0.5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
 
 
 
 
0 1 2 3 4 5
-0.12
-0.10
-0.08
-0.06
-0.04
-0.02
0.00
0.02
0.04
0.06
 
 
 
0 1 2 3 4 5
-0.06
-0.03
0.00
0.03
0.06
0.09
0.12
 
 
 
(
)
D
is
pl
ac
em
en
t y
 μ
m
(
)
D
is
pl
ac
em
en
t x
 μ
m
( )Time s
( )Time s
( )Time s
(
)
z
R
ot
at
io
n 
 μ
ra
d
q
( )a
( )b
( )c
0 1 2 3 4 5
-0.5
0.0
0.5
1.0
1.5
2.0
 
 
 
0 1 2 3 4 5
-0.5
0.0
0.5
1.0
1.5
2.0
 
 
 
0 1 2 3 4 5
-5
0
5
10
15
20
25
 
 
 
 
圖 3.6 對於平面式三自由度之平台，我們給連續步階命令，然後去比較有無控制器之輸出反
應。(a-c)是分別給 x - , y -  和 zq -的連續步階命令。 (d-i) 是去比較各軸向有無控制器所產
生之位移或旋轉之響應。 
 73
3.7.3 sin波和輪廓追蹤控制 
在這個單元中，我們將去對三軸長行程定位平台進行控制性能之測試。我們規劃的實驗
有 sin 波的軌跡追蹤，還有星形之輪廓軌跡追蹤。在 sin 波的軌跡追蹤方面，我們將給
1 1 sin 2  x y t mp m= = +  的命令訊號，其執行時間是 0-5 秒，其最後之實驗結果秀在圖 3.8。在
圖 3.8(a-c)中所示的是各軸給定 sin波之軌跡追蹤結果，而圖 3.8(d-f)則分別是秀出數值模擬與
實驗之位移誤差量，其中在 x-軸的誤差量為 0 03. mm± ，在 y-軸的誤差量為 0 04. mm± 和 在 θz-
的誤差量為 0 7. mm± 。 
0 1 2 3 4 5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
 
 
 
 Commands 
 Simulations
 Experiments
0 1 2 3 4 5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
 
 
 
 
 Commands 
 Simulations
 Experiments
(
)
D
is
pl
ac
em
en
t x
 μ
m
(
)
D
is
pl
ac
em
en
t y
 μ
m
( )Time s
( )Time s
(
)
Er
ro
r 
μm
(
)
Er
ro
r 
μm
( )Time s
( )Time s
(a) ( )d  
(b) ( )e
0 1 2 3 4 5
-0.06
-0.04
-0.02
0.00
0.02
0.04
0.06
 
 
 
 Simulation errors
 Experiment errors
0 1 2 3 4 5
-0.08
-0.06
-0.04
-0.02
0.00
0.02
0.04
0.06
0.08
0.10
 
 
 
 Simulation errors
 Experiment errors
 
 
 75
(
)
D
is
pl
ac
em
en
t x
 μ
m
(
)
D
is
pl
ac
em
en
t y
 μ
m
(
)
z
R
ot
at
io
n 
μr
ad
q
( )Time s
( )Time s
( )Time s
(
)
Er
ro
r 
μm
(
)
Er
ro
r 
μm
(
)
Er
ro
r 
μr
ad
( )Time s
( )Time s
( )Time s
(a) ( )d
(b) 
(c)
( )e
( )f  
0.0 0.5 1.0 1.5 2.0 2.5 3.0
0.0
0.5
1.0
1.5
2.0
2.5
3.0
 
 
 
 Commands 
 Simulations
 Experiments
0.0 0.5 1.0 1.5 2.0 2.5 3.0
0.0
0.5
1.0
1.5
2.0
2.5
3.0
 
 
 
 Commands 
 Simulations
 Experiments
0.0 0.5 1.0 1.5 2.0 2.5 3.0
0
5
10
15
20
25
30
 
 
 Commands 
 Simulations
 Experiments
0.0 0.5 1.0 1.5 2.0 2.5 3.0
-0.20
-0.15
-0.10
-0.05
0.00
0.05
0.10
0.15
0.20
 
 
 
 Simulation errors
 Experiment errors
0.0 0.5 1.0 1.5 2.0 2.5 3.0
-0.25
-0.20
-0.15
-0.10
-0.05
0.00
0.05
0.10
0.15
0.20
0.25
 
 
 
 Simulation errors
 Experiment errors
0.0 0.5 1.0 1.5 2.0 2.5 3.0
-2.0
-1.5
-1.0
-0.5
0.0
0.5
1.0
1.5
2.0
 
 
 
 Simulation errors
 Experiment errors
圖 3.9使用二階段控制器對掃頻式弦波進行軌跡追蹤。(a-c)分別是在 x-, y- 和 θz-軸上給的掃
頻 sin波命令位移。(d-f)分別是各軸之追跡誤差量。 
 
 77
(
)
D
is
pl
ac
em
en
t y
 μ
m
( )Displacement x μm
(c) 
0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3
0.5
0.6
0.7
0.8
0.9
1.0
1.1
1.2
1.3
 
 
 
 Commands
 Simulations
 Experiments
 
圖 3.10 使用二階段控制器對星形做輪廓追蹤。(a-b)分別是 x- 和 y-軸向之位移。(c)則是輪廓
追蹤圖形。(d-e)是分別是 x- 和 y-軸向之位移誤差。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 79
外層的壓電致動器所承受的負載大。若以組裝的方式設計多自由度定位平台，間隙
的誤差是目前加工無法克服的缺點，相較於一體成型的加工方式，組裝式的定位平
台之結構可分開加工，加工的方式簡單，精度可達到所需之要求，大幅降低製造成
本，但機構的零組件越多，累積的間隙誤就越大，所以在作機構設計的思考方面，
應依定位平台不同的需求考量而設計。 
(4). 壓電致動器在負電壓時的特性: 壓電致動器在給予負電壓時，壓電致動器會產生位
移縮收的現象，若持續給予負電壓時，壓電致動器的縮收位移會產生一個轉折點，
即壓電致動器的位移變化會改為伸長，以本文所使用的積層型壓電致動器，電壓在
低於-45伏特時，壓電致動器開始由位移縮收改變為位移伸長，所以選擇壓電致動器
作為驅動器時，必須了解壓電致動器的使用限制是要的。 
(5). 避免壓電致動器之間的相互干涉: 定位平台的主要驅動源是壓電致動器，在定位平
台放置壓電致動器的位置，必須考慮每個壓電致動的位移範圍是否有相互的干涉，
若有干涉的情況，定位平台的功效將大幅的降低甚至為零。 
(6). 壓電致動器的預壓力: 壓電致動器的預壓力將是決定定位平台品質好壞的主要關
鍵，定位平台在加工時，並無法控制到每一個尺寸的精度都相同，且壓電致動器本
身因製作的誤差也無法保証每一個尺寸階一致，所以設計一個可以適當的調整預壓
力的功能是必要的。 
   在第二部份系統與鑑別方面，本計畫使用 RGA進行系統之鑑別，其優點除了是可以找到
全域的最佳解，而且一次可以進行 30個以內的參數鑑別，可以說在系統鑑別的方法中，是一
個最佳的選擇。而在控制部份，本計畫提出之二階段控制法則，除了結果適應性控制器和遞
迴式適應性控制器，分別去對 PMSM及 PA進行控制，其產生的結果，可以達解耦合之效果，
在輪廓的追蹤上，更可以得到很好的追蹤效果，完全達到本計畫之預期效果，可以提供學業
界在三長軸行程之微奈米定位上一個很好的解決方法。。 
 
 81
[11] S. H. Chang, C. K. Tseng, and H. C. Chien, “An Ultra-precision XYθz Piezo-micropositioner 
Part I: Design and Analysis,’’ IEEE Trans. Ultrasonics, Ferroelectrics, and Frequency Control, 
Vol. 46, No. 4, pp. 897-905, July, 1999. 
[12] S. H. Chang, C. K. Tseng, and H. C. Chien, "An Ultra-precision XYθz Piezo-Micropositioner 
Part II: Experiment and Performance," IEEE Trans. Ultrasonics, Ferroelectrics, and Frequency 
Control, Vol. 46, No. 4, pp. 906-912, July, 1999. 
[13] 羅士哲，朱怡銘，林熙翔，王鴻年，張所鋐，”三自由度高精密線性定位平台”智慧財產
局，2001. 
[14] H. Mizumoto, M. Shioe, S. Arii, M. Yabuya “Picometer Positioning using Twist-roller  
Friction Drive Mechanism,” proc. of the 3rd euspen International Conference, Eindhoven, The 
Netherlands, May 26th -30th, 2002. 
[15] 吳冬立，“並聯式六自由度奈米級微定位平台研製” 國立臺灣大學機械工程學研究所碩士
論文，2002。 
[16] 李振邦，「奈米級長距離致動機構暨三自由度微定位平台之研製」，國立臺灣大學機械工
程學研究所碩士論文，1999。 
[17] 白尉芬，「次奈米級三維六次元雷射測長與即時控制系統研究之初步成果」，國立清華大
學物理學系碩士論文，1999。 
[18] 林冠禎，「順滑模態控制器於高精度定位控制之應用」，國立成功大學航空太空工程學系
碩博士論文, 2002. 
[19] C. W. Lee, and S. W. Kim, “An ultraprecision stage for alignment of wafer in advanced 
microlithography,” Elsevier Science Inc., Precision Engineering, Vol.21, No.2/3, pp.113-122, 
1997. 
[20] W. J. Kim, “Six-axis nano-positioning with planar magnetic levitation,” Elsevier Science Inc., 
IEEE NANO, Nano-Manipulations, pp.174-179, 2001. 
[21] 江瑞利、吳上立，以真實碼基因演算法為基礎之 AVR 系統最佳 PID 控制器的研製，高
 83
[34] 李振榮，鄭金火，馮榮豐，Scott-Russell 切削刀具機構之最佳化設計及分析，第二十屆
機械工程研討會，pp.597~604，12月，2003。 
[35] W.H. Yang, Y.S. Tarng, “Design optimization of cutting parameters for turning operations 
based on the Taguchi method”, Journal of Materials Processing Technology, pp.122-129, 
1998. 
[36] J. H. Holland, “Adaption in Natural and Artificial System,” Ann Arbor, MI: The University of 
Michigan Press, 1975. 
[37] P. J. Fleming and C. M. Fonseca, “GeneticAlgorithms in Control Systems Engineering: A Brief 
Introduction,” Genetic Algorithms for Control Systems Engineering, IEE Colloquium on, 
pp.1-5, May 1993. 
[38] P. Ge and M. Jouaneh, “Tracking control of a piezoceramic actuator”, IEEE Trans. Control 
Syst. Technol., Vol. 4, No. 3, (1996) 209–216. 
[39] H. J. M. Adriaens, W. L. de Koning and R. Banning, “Modeling piezoelectric actuators”,  
IEEE/ASME Trans. Mechatronics, Vol. 5, No. 4, (2000) 331–341. 
[40] T. S. Low and W. Guo, “Modeling of a three-layer piezoelectric bimorph beam with  
hysteresis”, IEEE J. Microelectromech. Syst., Vol. 4, No. 4, (1995) 230–237. 
[41] S. H. Chang, C. K. Tseng and H. C. Chien, “An ultra-precision XY_θz piezo-micropositioner 
part I: design and analysis”, IEEE Transactions on Ultrasonics, Ferroelectrics, and Frequency 
Control, Vol. 46, No. 4, (1999) 897-905. 
[42] S. H. Chang, C. K. Tseng and H. C. Chien, “An ultra-precision XY_θz piezo-micropositioner 
part II: experiment and performance”, IEEE Transactions on Ultrasonics, Ferroelectrics, and 
Frequency Control, Vol. 46, No. 4, (1999) 906-912. 
[43] H. Wang and X. Zhang, “Input coupling analysis and optimal design of a 3-DOF compliant 
micro-positioning stage”, Mechanism and Machine Theory, Vol. 43, (2008) 400-410. 
[44] F. Ikhouane, V. Manosa and J. Rodellar, “Dynamic properties of the hysteretic  
