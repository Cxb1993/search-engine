11.緒 論
1.1 研究動機
近年來由於無人飛行載具技術的快速發展，提供較佳的負載特性及資訊傳輸能力，機
載影像系統因為探測範圍廣、資訊獲得量大，已成為所有無人載具系統的必備選項，廣泛
運用於空域影像監測用途[1,2]、路徑導航「3」、降落導引「4」、國土安全[5-7 ]等。
然而現有主要機載影像系統仍不能滿足許多應用場合的需求，主要因為目前系統操作上仍
以人工為主，人工操作具有嚴重延遲現象，尤其當飛控操作人員透過機載攝影機小視角相
對座標觀察目標物，很容易因為載具瞬時運動而追失目標。另外由於外界擾動（側風干擾
等）所帶來的飛機機身瞬時運動，也會發生周期性的搖晃，使視軸模糊，甚至使目標脫索，
造成攝影機瞄準線相對被測目標的偏移，特別當飛機運動姿態較大時；如躲避威脅時，仍
需先藉由操作人員先一步提供修正指令，以維持攝影機原偵測方向。
由於攝影機所獲得的的影像是二維及平面，因此要想用來做目標定位，必須從中獲得
三維、立體的視覺資訊。這些從三維空間點到攝影機成像平面之間映射關係參數的確定，
是由攝影機成像建立的幾何模型所決定，這些參數必須由實驗及計算獲得稱之為攝影機標
定，為重建三維幾何座標之關鍵[8]。目前主要有(1)傳統標定法:運用一已知高精度的空
間標定參考物作為校正、(2)自標定法:運用圖像對應點的資訊直接透過影像來完成標定，
但在圖像有噪音狀況則不穩定，(3)主動視覺標定法等方法：是指有已知攝影機的運動訊
息，包含攝影機在平台座標系朝某一方向平移的已知量，或者攝影機平移或旋轉運動，此
種狀況與無人載具運動及本研究中目標物標定的方式相當接近。
1.2 主動視覺系統[10,11]
現就主動視覺系統做進一步的說明，主動視覺系統有三項功能:
(1) 透過主動控制攝影機參數(位置、方位、焦距、光圈等)的機制來控制攝影機
的運動，如目標物的主動追蹤。
(2) 透過改變攝影機參數或圖形處理控制選取關鍵目標物。
(3) 根據攝影機與目標關係分為:
i. 攝影機與目標靜止
ii. 攝影機靜止目標運動之監控應用
iii. 攝影機運動而目標靜止之導引辨識應用
iv. 攝影機與目標均相對運動
Ghoust 及 Vincze 則對(iii)種導引應用有清楚的說明[12]，藉由各關定位點提供定位
參考的資訊，如圖 2所示。Ghoust 及 Vincze 則對(iii)種導引應用有清楚的說明[13]，藉
由各關定位點提供定位參考的資訊，如圖 1所示，攝影機藉由基座上的慣性量測單元了解
目前位置，並藉由立體視覺擷取特徵參考點的位置，並藉以修正實際定位資訊。
3除載具航向及姿態變化的影響[14-17]。早期為使用機械式陀螺儀穩定平台，但由於結構
複雜、造價昂貴且精度容易飄移，目前已較少見，而由於近年來微機電技術的突飛猛進，
使得捷聯式(strap down)慣性量測元件獲得容易，不僅性能優越、體積縮小且價格相較以
往大幅降低[18]。常見的做法為將速率陀螺儀作為感測元件安裝於攝影機的座標軸，進行
姿態角的補償[19]。就目前市面上主要的系統包括；Cloud cap 公司、L3、MicroPilot 公
司所開發之影像系統，如圖 4所示，均具備慣性穩定功能。
Capcloud L3 MicroPilot
圖 4.現有商用穩定平台廠家
目前有關追蹤平台的穩定，一般有兩種方法，第一種為四軸穩法，主要概念為將攝影
機安裝再一個穩定平台的內框架中透過自身伺服系統使內框架始終保持水平位置，但此方
法因結構複雜，目前已少用。第二種為三軸穩定法，主要概念是將載具相對地面絕對座標
的方位角、俯仰角、滾轉角等尤拉角，結合載具慣性輸出的航向角和姿態訊息進行座標變
換，得到攝影機相對在載具座標系中的方位、俯仰、滾轉角的變化量。由於攝影機座固定
於載具，因此將兩個角速率陀螺儀安裝於攝影機基座，量測其迴旋及俯仰角速度，並由此
帶入攝影機平台姿態回復控制。
1.3 研究步驟
由於本研究著重於平台穩定性統動態分析及控制，因此在分析上有兩大主要項目：
第一項目為建立整體軟體模擬分析，首先建立載具目標跟蹤數學模式，藉由攝影機針
孔模型連結目標物在影像成像面座標、攝影機焦距及攝影平台與飛機姿態角的相對關係，
其次建立飛機載具受外力(風力及大氣紊流)擾動之數學模型，此處將以本實驗室目前已開
發完成之小型動力無人飛行載具模型為研究標的物。另外以拉格朗日(Lagrange)方程式建
立攝影機雙軸穩定平台動態方程式，其次建立機體座標系、地面方位 NED 座標系、GPS 座
標以及俯仰、滾轉等尤拉角、平台座標系之轉換關係，其中 NED 座標部份為整合卡曼濾波
器及融合 GPS 及慣性量測單元資訊，主要提供攝影機平台座標系與地面絕對參考點之相對
座標值。最後集合各個子模組建立完整綜合模擬系統；研究飛機載具擾動對平台的影響，
並驗證平台控制之成效，提高轉台之控制精度。
第二項目則在建立穩定平台硬品迴路模擬硬體架構，此處將飛機載具模型建立於
SBRIO 系統以模擬載具受外力影響實際運動狀態，並藉由 FPGA 與飛控電腦溝通執行飛控導
航指令。同時建立雙軸陀螺影像穩定平台，並採用嵌入式系統晶片作為陀螺儀回饋訊號接
收及平台穩定控制器之用，並執行控制指令以驗證其姿態是否正確及其強健性。
5圖 6. 載具與攝影機相對關係座標轉換
現假設平台之俯仰角為 g，迴旋角 f，則當平台無轉動時兩座標系重合，當平台轉動
時，其座標轉換關係如下式
sin 0 cos
cos cos sin sin cos
cos sin cos sin sin
f fa b
a f g g f g b
a bf g g f g
x x
y y
z z
 
    
    
                      
(5)
而由拉角轉動速度與體軸之轉動速率轉換關係如下
1 sin 0
0 cos cos sin
0 sin cos cos
b
b
b
x
y
z
  
    
   
               



(6)
由以上兩式可推導當載具改變運動速率時，對平台影響如下：
sin 0 cos
cos cos sin sin cos
cos sin cos sin sin
a b
a b
a b
x xf f
y f g g f g y
f g g f gz z
  
      
     
    
    
     
            
(7)
=
sin 0 cos 1 sin 0
cos cos sin sin cos 0 cos cos sin
0 sin cos coscos sin cos sin sin
f f
f g g f g
f g g f g
   
        
       
                



(8)
由此可獲得平台感知到載具相對運動影響如下
( sin ) cos sin ( cos cos sin )cos
( cos cos sin ) cos ( sin cos cos )sin sin
f az f g g
g f g
            
            
     
  
  
  
(9)
( sin )sin ( sin cos cos )cos
g ax f f                  (10)
,
g f   為載具角運動對轉台的影響，作為轉台受到的外界干擾影響只平台系統中。
另一方面在前式 2可將形式作一變換如下
1 1
c w
c w
c w
x x
y y
z z
   
               
   
T
R T
o 1
,
c c w
c c w
c c w
x x x
y y y
z z z
      
                          
T R (11)
xb
yb
zb
ya
za
xa
θg
θf
72.3.1 卡曼濾波器狀態及測量方程式[22-25]
對於描述一離散系統的狀態變數 kRx ，離散時間過程可以用差分方程來描述：
111   kkkn wBuAxx (17)
從量測變數
mRz ，其量測方程為
kkk vHxz  (18)
其中 A為狀態矩陣表示狀態 x 前一時刻與目前時刻間之關係，B為輸入矩陣表示狀態
x 與輸入間之關係，u 代表系統之輸入，H 為測量矩陣表示狀態 x 與測量值 z間之關係。
隨機信號 nw 和 nv 分別表示系統過程的激勵雜訊及量測雜訊。兩種雜訊這裡假設為相
互獨立、常態分佈的白雜訊（White noise）。
),0()(
),0()(
RNvp
QNwp


(19)
Q 稱為程序雜訊協方差矩陣，R稱為測量雜訊協方差矩陣，兩者皆為正定矩陣。
2.4.2 卡曼濾波器估測及運算過程
定義 kxˆ 為已知在第 k 時間之前狀態的先驗估計資料。（代表先驗，^ 代表估計）定
義 kxˆ 為已知量測變數 kz 在第 k 時間的後驗狀態估計。可定義先驗估計誤差和後驗估計誤差
kkk
kkk
xxe
xxe
ˆ
ˆ

 
則先驗估計誤差協方差及後驗估計誤差協方差為
][
][
T
kkk
T
kkk
eeEP
eeEP

 
(20)
後驗估計變數 kxˆ 計算為先驗估計變數 kxˆ 和量測變數 kz 與預測 kxHˆ之差值的線性組
合。
)ˆ(ˆˆ   kkkk xHzKxx (24)
其中 )ˆ(  kk xHz 稱為量測殘餘，其表現出預測值與量測值的差異，若為零表示量測與
預測之值完全吻合。K 為殘餘增益因子（Gain factor），其目的是使後驗估計誤差協方
差最小。其K 表示為
 1



 RHHPHP
RHHP
HP
K Tk
T
kT
k
T
k
k (21)
卡曼濾波器透過迴授控制的方式估計過程（Process）的狀態，濾波器估計過程在一
時間點的狀態，然後透過包含雜訊的量測訊號當作迴授。所以卡曼濾波器基本上分成兩大
部分：時間更新（Time Update）方程及量測更新（Measurement Update）方程。時間更
新方程負責推算下一個時間的狀態及協方差估計值當作下次量測更新的先驗（Priori）資
料。量測更新則負責將先驗資料與新的量測資料結合成為後驗（Posteriori）估計。所以
時間更新可以看做一種預測（Predictor）的程序，量測更新可以看做一種校正（Corrector）
的程序。所以卡曼濾波器可以是為一種數值預測及校正的演算法，如圖 8。
9圖 9. 平台穩定控制迴路
2.6 GPS 定位座標轉換[26]
在一般的導航座標中多使用 NED 座標作為組合導航及地圖導航座標點依據，因此在本
節中將先介紹如何由衛星定位之 WGS-84 座標系轉換至 NED 座標。其次由於在為飛行器動
態模擬環境中所在已為 NED 座標，因此為能於人機介面顯示 GPS 座標資訊，以增加其擬真
度，在第二小段將說明如何將 NED 座標轉回 WGS-84 座標。
2.6.1 WGS-84 轉換至 NED 座標系
地心固定座標系統是以地心為原點，地心指向北極方向為 Z軸，地心到赤道面與初子
午面交會點之方向為 X軸，依據右手定則訂出 Y軸。由於 GPS 使用的是以橢圓球體描述的
WGS-84 座標系統，轉換至以球體描述 ECEF 座標需進行轉換。
圖 10 ECEF 座標與 WGS-84 座標關係
飛控電腦
Xplane
模型
運動姿態座標
平台轉換矩陣
外在干擾
平台方位
控制模型
θC
平台伏仰
控制模型
θa0
Θf0
1/S
1/S
Θf
Θa
2a
2f
1a
1f卡曼
濾波器
-
-
-
11

 32
32
L cos
sin
arctan
aep
beZ rn

 (30)
22 yxp  ,
pb
Zntanarc (31)
3. 硬品迴路實驗架構
3.1 結合 DSP 及 FPGA 之通用型硬品迴路系統
在本研究中，著眼於結合 DSP 及 FPGA 技術於無人載具雲台控制模組開發，本研究
係以設計通用型控制模組硬品迴路測試平台為目標，在設計上預期整套系統除因結合 DSP
及 FPGA 技術，並具備整合測試 INS 及 GPS 功能；並可透過 PWM 介面進行影像雲台控
制。依據設計想定，可以建立系統的初步功能需求如下：
(1) 結合 DSP 及 FPGA 技術，客製化所需功能。
(2) 可進行硬品迴路模擬驗證，縮短開發時間。
(3) 融合 INS 及 GPS 進行雲台控制。
3.1 硬品迴路模擬定義
HIL 模擬器，主要是模擬系統在接近實際狀況中所產生之輸出、輸入訊號。特別可用
於模擬系統在關鍵或是較危險之操作狀態時所實際產生之反應。在 UAV 自動控制器發展
的過程中，HIL 模擬器可以被發展用來模擬相關的飛行數據。如控制感測器輸入之信號或
模擬輸出信號，因此可將 UAV 的自動控制系統安裝在 HIL 的環境中，用來驗證全系統在
一個閉迴路中的運作情形。我們可以很安全的調整相關的系統參數，再觀察其對系統的影
響，用以調校全系統。
在本研究中，在開發 HIL 模擬器的部份，為了加速模擬器的開發期程及可靠性，因
此使用商用的模擬軟體。利用這種模式發展優點為，只需要加入感測器量測及伺服器動作
之模擬的相關功能，即可建立 HIL 模擬器。
3.2 以 X-Plane 9 為基的 HIL 模擬器平台
HIL 模擬器主要包含有感測器、訊號處理、致動器等三部分。其中感測器的部份是
模擬了飛機在飛行時的感測器輸出。而控制器讀取了感測器輸出的數據後，透過控制器的
導航程式，進行訊號處理、應用。最後將系統產生控制命令，轉換成控制雲台的控制命令。
在訊號處理的部份，吾人便可使用實際的 UAV 控制器進行處理，由此來得知載具在
真實情況下會有的反應。在本研究中為透過乙太網路使 X-Plane 9 與 UAV 控制器做連
結。模擬架構如圖 11.所示。
13
NI Multisim
NI Ultiboard
CompactRIO Module Development Kit 1.5
加速規介面
陀螺儀介面
GPS 接收器介面
無線傳輸模組介面
模擬軟體 搭配硬體
X-Plane 9 PC
3.5 實際架構
最終產品架構如圖 13 所示，左側為模擬之飛控介面接收系統，中間為美商國家儀器
之整合 DSP 及 FPGA 之 sbRIO 系統，最右側為 X-Plane 之模擬軟體，依照測試流程、步驟
及規範發展測試介面。為能清楚顯示現有載具姿態並應用於後續載 具導航方法理論的設
計及驗證，可於遠端 HOST 電腦使用 X-plane 3D 飛行動態模擬軟體，將載具姿態透過 UDP
網路回傳顯示，並透過 FPGA 硬體模組輸出相關訊號至嵌入式系統特定介面，了解現有之
測試狀態
圖 13.系統架構圖
圖 14.系統實體模擬圖
15
圖 16. 初步整合後的圖形介面
4.2 追瞄效能分析
為了驗證本研究所雲台系統控制效能，以下分別就俯仰機構、迴旋機構進行個別測
試，最後並進行整合測試，以確認實驗雲台的控制能力。針對各分項實驗進行說明如下：
(1) 俯仰機構追瞄效能分析：
而為了讓量測所得到的資料更具代表性及準確度，本研究利用 LabView Share
Variable 植入雲台的 Real-Time 運算單元中，來擷取目標追蹤之即時資訊，如圖
17。同時以相同條件重複實驗 30 次的數據，取得平均追瞄時間為 3.6 秒。
圖 17 俯仰機構即時追瞄響應圖(白線：目標值、紅線：即時位置)
(2) 迴旋機構追瞄效能分析：
為了分析迴旋軸對於目標的追瞄能力，實驗以 LabView Share Variable 擷取目標追
蹤之即時資訊，如圖 18。以相同條件重複實驗 30 次的數據，取得迴旋機構平均
追瞄時間為 3.8 秒。
17
圖 21 目標縱軸速度(紅線：目標縱向速度、白線：零速度)
(6) 由圖 22 及 23 可知，以目標速度預估結合卡曼濾波可有效的對目標的位置進行估
測，誤差均在 0.1 pixel 內，而圖前方區塊的誤差極大區域導因於手動追瞄切換自
動追瞄時資料的誤差。
圖 22 水平軸卡曼濾波位置與實際目標位置圖
(紅線：估計位置、白線：實際位置)
圖23 俯仰軸卡曼濾波位置與實際目標位置圖
(紅線：估計位置、白線：實際位置)
19
[17]王振收、徐非駿，“機載 SAR 穩定平台座標變換及其軟件實現”，雷達與對抗，第 2 期，
2005。
[18]方成一、王振旺，“艦載雷達天線電子穩定方程的推導方法”， 雷達與對抗，第 2 期，
1999。
[19]C. J. Kepmpf, “Disturbance observer and feedforward design for a high speed direct drive
positoning table,”IEEE Transactions on Control Systems Technology, Vol. 7, No. 5, 1999.
[20] 同 8.
[21] Jang, J., Tomlin,”Autopilot Design for the Standford DragonFly UAV:Validattion through
Hardware-in-the Loop Simulation,”AIAA GNC Conference, Montreal,Canda, Aug, 2001.
[21] Greg, W., Bishop, G., An Introduction to the Kalman Filter, SIGGRAPH, 2001.,
Http://info.acm.org/pubs/toc/CRnotice.html.
[22] Levy, L. J., “The Kalman Filter：Navigation’s Integration Workhorse,” The Johns Hopkins 
University, pp. 1-10, 1997.
[23] Shaikh, K. N., Sharif, A. R. B. M., Jamaluddin, H., Mansoor, S., “GPS-Aided-INS for
Mobile Mapping in Precision Agriculture,” Map Asia Conference, Malaysia, pp. 1-2, 2003.
[24] MAYBEAK, P. S., Stochastic models, estimation, and control, ACADEMIC PRESS, U.S.A,
pp. 1-7, 1979.
[25] Welch, G., Bishop, G., An Introduction to Kalman Filter, ACM, U.S.A, pp. 20-21, 2001.
[26] 張毅、羅元等，移動機器人技術及其應用，電子工業出版社，大陸，2008。
[27] Hanselman, H., “Hardware-in-the- Loop Simulation for Development and Test of
Electronic Control Units”Proceedings of the Real-Time System’93 Conference, January
13-15, 1993, Paris, France.
[28] Http:/www.ni.com/Using High-Level Protrotyping Hardware and Software in Machine
Control Applications.
5圖一、DCC 研討會會場 圖二、研討會會場
二、 過程
2009 IEEE 國際機器人計算智能及自動化研討會是一個寶貴且難得的經驗，它所包含的學術研究
多達40多項專業領域。因此非常感謝國科會支持出國參加這個國際機器人研討會。會議中，接觸了各
國專業頂尖研究人員，讓自己對於對問題的思考能更上層樓。會議之中，我見到了許許多多對於科學
熱衷的人士齊聚一堂，藉由參與研討會的發表與討論，讓自己了解目前自己的研究領域及著重方向，
是否有足夠的研究價值，而藉由問題的提問也了解大家對於該類問題的看法。
本人與原計畫研究助理張合中於本研討會所發表的題目為:「FPGA為基礎小型無人飛機飛控模擬硬
品迴路之研究」，如圖三所示。 相關題目在本此研討會發表較少，因此也得到會場研究人員熱烈的討
論與迴響。除了參加本報告外，其他時間也積極參加大會專題演講及各Session的議程，以了解他國學
者在相同領域的研究成果與自我研究領域的新啟發。本次除參加研討會外，也應主辦單位的邀請主持
一個場次的研討，該場次主題為感測器資料融合，共有六篇論文發表，本人也就主持討論與各國發表
人交換研究新的，同時增加國際相關學者對本校的了解。
圖三、現場發表論文
7機電教學套件
圖四、教育機器人產覽產品
三、 與會心得
此次參加2009 IEEE 國際機器人計算智能及自動化研討會獲益良多。會中除於會中發表自己的
論文外，並聆聽與自己相關領域的論文發表，了解各國學者的研究趨勢與軟硬體之運用，同時對下一
階段的主題進行思考與激盪，因此除了獲得相當多的相關資訊外，對於自己研究上的瓶頸與問題也有
新的想法與思維，讓我們與來自世界各國的學者相互切磋與討論，且認識許多來自世界各國相同領域
的學者，以國際語言相互切磋彼此在學術上的經驗與心得，這種感覺在國內研討會是難以體驗到的，
更加覺得知識與學問是永遠學習不完，要走向國際拓展視野。
四、 建議事項
本次會議認識許多來自世界各國的機器人領域研究人員，了解許多國家相當鼓勵大家參與國際活
動，也了解世界各國在機器人技術所投入的資源，在未來機器人技術技將於我們各個生活的層面有相
當的影響，因此更因及早投入相關研究。
五、 攜回資料名稱及內容
研討會論文光碟
98 年度專題研究計畫研究成果彙整表 
計畫主持人：石大明 計畫編號：98-2221-E-606-008- 
計畫名稱：無人飛行載具影像穩定慣性平台動態分析及控制 
成果項目 
量化 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
國內 
論文著作 
期刊論文 0 0 100% 
篇 
 
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100%  
專書 0 0 100%   
專利 申請中件數 0 0 100% 件  已獲得件數 0 0 100%  
技術移轉 
件數 0 0 100% 件  
權利金 0 0 100% 千元  
參與計畫人力 
（本國籍） 
碩士生 0 0 100% 
人次 
 
博士生 1 1 20% 協助實驗及研究結果數據整理 
博士後研究員 0 0 100%  
專任助理 0 0 100%  
國外 
論文著作 
期刊論文 0 0 100% 
篇 
 
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
2009 IEEE 國際機
器人計算智能及
自動化研討會 
The 8th IEEE 
International 
Symposium on 
Computational 
Intelligence in 
Robotics and 
Automation 
(CIRA2009) 
專書 0 0 100% 章/本  
專利 申請中件數 0 0 100% 件  已獲得件數 0 0 100%  
技術移轉 
件數 0 0 100% 件  
權利金 0 0 100% 千元  
參與計畫人力 
（外國籍） 
碩士生 0 0 100% 
人次 
 
博士生 0 0 100%  
博士後研究員 0 0 100%  
