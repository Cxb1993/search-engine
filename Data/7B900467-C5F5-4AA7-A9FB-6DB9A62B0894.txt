一、中英文摘要 
 
本年度計畫結合離散小波轉換、三角形區塊比對於動態影像壓縮技術、及算術編碼
來消除或縮減在磁振造影影像中，任一或多種的重複性，以得到資料壓縮的效果，而達
到符合網路化的需求，以期對影像的傳輸與儲存有更大助益。在研究中以數位化的左心
室磁振動態影像資訊和腦部功能性磁振動態影像資訊作為壓縮的實例，並以高峰訊號雜
訊比（peak signal-to-noise ratio, PSNR）值和壓縮比率（compression ratio, CR）來作績效
的評估，實驗結果發現透過此研究架構來對醫學動態影像壓縮，可得到一極佳之 PSNR 
值和 CR 值。 
關鍵詞：動態影像壓縮、磁振造影影像、高峰訊號雜訊比、壓縮比率 
 
Abstract 
In this project, a novel hybrid coders is developed for dynamic medical image 
compression. The kernel techniques include discrete wavelet transformation (DWT), 
triangle-block matching algorithm, and arithmetical coding to reduce the temporal 
redundancy and to achieve a good lossless compression rate. There are two data sets in the 
experimental design, one is the dynamic magnetic resonance image (MRI) for human left 
ventricle. The other is the functional magnetic resonance image (fMRI) for human brain. The 
peak signal-to-noise ratio (PSNR) and compression ratio (CR) are used to evaluate the 
performance of this approach. Experimental results show that the PSNRs and CR for both 
cases are prime by applying the proposed method.  
Keywords: Dynamic medical image compression, Magnetic resonance image, Peak 
signal-to-noise ratio, Compression ratio 
 
二、緣由與目的 
 
影像壓縮的原理是要去除影像中多餘的部份來減少資料容量，因此一種壓縮方式的
優劣與被壓縮資料本身的特性相當有關係，需要根據待壓縮資料的特性結構選擇合宜的
方式才可以有效壓縮資料。所以隨著醫學影像的種類不同，造影方式的改變，直接或間
接都會改變影像儲存與傳輸系統中壓縮方式的改變，故必須由影學影像的特性和壓縮的
本質探討，來滿足不同影像的需求，找尋一個合適壓縮方式的策略。而磁振造影影像
（magnetic resonance image, MRI）在醫學上常用來顯示出腦部的結構、新陳代謝、內部
組織及器官的功能，是一種非侵入性相當安全觀察身體組織的方法，其取得技術已被廣
泛的應用在大腦皮質、心臟、及功能性磁振造影影像（functional magnetic resonance image, 
fMRI）上。但由於所取得之影像通常紀錄有在空間上及時間上大量的資訊，因此形成
所謂動態的影像或視訊影像，所以其壓縮方式較其他的醫學影像形式複雜。然而在臨床
上已被廣泛地使用，所以磁振造影影像的壓縮方式，已成為今日醫療影像數位化中，不
容忽視的問題。 
在傳統的視訊動態壓縮技術中，如 H.263、MPEG-4 等[1, 15]，常藉由固定區塊比
對（block-based matching algorithms），應用位移評估與位移補償來減少動態影像中各方
相間的多餘性，但利用傳統的區塊位移補償技術於磁振造影影像並不恰當的。因動態的
磁振造影影像間存在著大量的變動像素，所以若要以傳統的區塊比對方式套用於磁振造
影影像的壓縮上是不適當的。本研究結合三角形區塊演算法、重要係數鏈結分析、及算
而我們不能防止較長編碼字的發生，因為它們出現較小的機率將對最佳化的編碼有所幫
助。 
Jeong 和 Jo [9] 提出一個接近合適的二維離散餘弦轉換係數的霍夫曼碼係數來對
影像作壓縮處理，這個方法是利用自我調整多重的霍夫曼編碼簿來對量化轉移編碼的係
數。它整合了利用區塊的類型，量化步驟的大小，和 zig-zag 掃描方式來作為編碼簿的
選擇決策。對於稀有的編碼符號，作者使用可變長度的編碼方式；Jeon et al. [10] 根據
區域符號統計發展出三種霍夫曼編碼方式，來作為對有效被運用之前所定義的編碼簿。
第一種方法是動態修改符號-編碼字的關聯，它不須重建本身的霍夫曼樹。第二種方法
是從產生最小位元數的集合中選擇合適的編碼簿；而上述兩種方法的綜合則為第三種方
法。Hu 和 Chang [8] 提出一個新的無失真影像壓縮方法，它包含了兩階段架構。第一
階段是線性的預測器，它被使用於未經處理影像資料的非相關性。第二階段是發展一個
有效的計畫，這個計畫是使用霍夫曼編碼方式針對殘餘的影像編碼來進行處理。 
  
(二) 以小波轉換為基礎的壓縮相關研究 
Calderbank et al. [5] 提出一個建立整數的反小波轉換，這些反向的整數到整數的小
波轉換是有助於無失真的影像壓縮編碼。這個方法的主要慨念是基於分解小波轉換因子
至提昇的階層，因此允許整數小波轉換的建構，這個建構是個可行性的技術常被應用於
建構小波,透過反覆的更新程序來建構子頻帶；Munteanu et al. [12] 使用四元樹編碼方式
來發展一個以小波為基礎的壓縮技術，這個方法有效的利用內部頻帶區域資訊。這個演
算法產生一個無失真壓縮後的資料流，維持其品質層級，且容許對感興趣的區塊（region 
of interest, ROI）作編碼；Bilgin et al. [4] 提出一個由反整數小波轉換和位元水平層級編
碼器所組成的整個層級影像編碼器。位元水平層級編碼器是由作者所發展出來的，它適
用於 JPEG-2000（joint photographic experts group）確認模式。這個編碼器能將不同的特
徵透過二進位元的資料流作傳輸，且達到預期能容納的資料流量。 
Yoo 和 Jeong [18] 發展出一個為線性-階段雙矩形小波轉換作統一整合的架構，這
個架購包含四個階段：切割、預測、更新和正規化。使用兩個參數，訊號相依方法統一
整合成眾所周知的整數到整數的轉換；Shapiro [14] 發展出一種對離散小波轉換後係數
編碼的方法，名為 EZW（embedded zerotree wavelet），其主要目的是為了對影像做有效
的壓縮。此法利用門檻值來對離散小波轉換後係數做判斷，並對判斷為重要係數做編碼
處理；Said 和 Pearlman [13] 提出一種名為SPIHT的（set partitioning in hierarchical trees）
壓縮方式，此種壓縮方式是 EZW 的改良版，所以 SPIHT 的許多觀念是沿襲 EZW 而
來。且 SPIHT 無論在壓縮效果與壓縮碼所佔的空間都比 EZW 來的好；重要係數鏈結
分析（significance-linked connected component analysis, SLCCA）是由 Chai et al. [6] 提
出一套影像壓縮方式，與 EZW 及 SPIHT 相同，都有用到離散小波轉換的技術來將數
位影像由空間域轉換成頻率域，主要是以量化、建構重要係數及重要係數區鏈結的三種
技術來對重要係數做壓縮編碼。 
 
(三) 動態影像壓縮的相關研究 
ITU-T [1] 的動態影像壓縮方式，名為 H.263，它是透過傳統的區塊比對方式，求
得位移評估、位移補償，然後運用離散餘弦轉換（discrete cosine transformation, DCT）
變换和“Z”字形掃描流程編碼，得到輸出碼流。且 H.263 已得到國際公認標準；MPEG-1
（motion picture experts group）[2] 於 1990年被發展出，它是以位移評估、位移補償技
術來對影像進行編碼，並以輕鬆簡易及資料量少的方式，能提供 352 * 240解析度，為
我們可對 LL部分再做一階離散小波轉換動作，以完成第二階的離散小波轉換，以此類
推，即可依需求取得 n階的離散小波轉換結果。 
 
 
圖 3. 垂直分割示意圖 
 
2. 重要係數鏈結分析編碼 
重要係數鏈結分析（SLCCA）引用的技術主要的有三種，分別為『量化』、『建構
重要係數之連續要素』、『重要係數區之鏈結』。首先 SLCCA 要對離散小波轉換後的係
數進行量化動作，此動作的主要目的是將原來資料的取樣值變小，以便讓日後做壓縮動
作時能有好的編碼效果，除此之外，利用建構重要係數與重要係數區鏈結來對量化後的
係數做進一步壓縮處理。以下將詳細介紹 SLCCA 之編碼方式： 
（1）SLCCA 的量化 
在做量化動作之前，需設定一個量化值 Q，對於 Q 值的選擇是由影像壓縮比率來
決定的，Q 值越大，則量化後的重要係數越少，故影像壓縮比例越高，影像壓縮後所
佔儲存空間就越小；Q 值越小，則量化後的重要係數越多，影像壓縮比例越低而影像
壓縮後所佔儲存空間就越多。如何找到一個適當的 Q 值，這須由使用者去衡量。若應
用在醫學影像上，影像訊號品質的好與壞，主觀上皆應由專科醫師鑑定，因為每筆訊號
皆隱藏著病理，影響勝鉅，非一般人所能判讀。當設定好 Q 值，將離散小波轉換後的
係數依序取出除以 Q 值，若有餘數則無條件捨去；然後 SLCCA 將所得到的數值放回
離散小波轉換結果中原本的位址上。SLCCA 將量化後的係數分為等於 0、大於 0、小於
0三類；對於 SLCCA 而言，大於 0及小於 0的量化後係數都是重要係數；反之，等於
0 的量化後係數則為不重要係數。在未來壓縮時，SLCCA 將努力保護重要係數的存在
及完整性，至於不重要的係數，SLCCA 則會盡量避免儲存它們，以節省儲存的空間及
傳送的時間。 
（2）建構重要係數之連續要素 
SLCCA 觀察發現，經量化後的重要係數值往往會有叢聚（clustering）的現象。也
就是說，重要係數的上下左右通常都也都是重要係數；而且這種現象在同一頻帶中最常
見；如果我們能有效的利用這種叢聚的現象，針對一個叢聚的重要係數們，僅紀錄少部
分的資料，避免一個個係數的儲存，如此必可大量減少影像壓縮後的資料量。這就是 
SLCCA 建構連續要素的基本目的與觀念。建構連續要素的詳細步驟如下： 
針對某一個頻帶，首先從此頻帶上找一個重要係數(非 0的值)為基礎點當作一個鍵
值（seed），以此鍵值為中心點，依照『上右下左』的順序先掃描一次周圍的係數，同
時紀錄是否為重要係數。SLCCA 規定，當遇到重要係數時以符號 S 紀錄之，遇到非
重要係數時以符號 I 紀錄之；例如假設某個鍵值的右側係數也是重要係數，但其它上
 圖6. 重要係數區鏈結之範例圖 
 
基本上重要係數區鏈結與建構連續要素設計的目的相同，都是為了減少量化後係數
的儲存資料量，只不過建構連續要素是針對同一頻帶內的重要係數做壓縮，重要係數區
鏈結是針對不同頻帶間的重要係數做壓縮。以圖 6為例，如果我們能利用係數 5來找到
重要係數 2與 3的話，那我們就可以不用紀錄叢聚一與叢聚二的鍵值了，儲存的資料量
自然就減少了。 
 
3. SLCCA 之壓縮編碼演算法 
在說明 SLCCA 編碼演算法前，須先定義一些 SLCCA之 規定：在 SLCCA 中，
POS 代表係數值大於 0的重要係數，NEG 代表係數值小於 0的重要係數，而 LINK 代
表重要係數區鏈結的產生。SLCCA 還有其他的規定，例如 SLCCA 掃描頻帶的順序是
以 N 字形來做掃描，同一頻帶內的掃描順序則是以 Z 字型來作掃描的順序。 
除了上述規定，SLCCA 的演算法中有用到三個串列（list），其定義如下； 
（1）LSO（list of scan order）： 
此串列是 SLCCA 存放待檢視係數的位置，一開始會將離散小波轉換後的係數作
量化的處理，所得到量化後的係數依順序取出，並放至於此串列中。 
（2）LCC（list of child clusters）： 
此串列是 SLCCA存放重要係數之子孫位置，重要係數區鏈結的動作即是利用此串
列來完成的； LCC串列中有係數的話，那麼 SLCCA 會先處理 LCC 中的係數。 
（3）LSC（list of significant coefficient）： 
此串列是 SLCCA 存放鍵值的地方。將所有搜尋到的鍵值依搜尋順序存放，經過
重要係數區鏈結技術，鍵值數量是最精簡，最後要傳送到解壓縮端的資料，LSC 串
列中的資料是主要的一部分。 
根據以上的規定與串列的定義，針對靜態影像壓縮，SLCCA 演算法描述如下： 
 
【SLCCA 編碼主程式】 
步驟 1：針對輸入的數位影像，SLCCA 首先利用離散小波轉換的技術將其轉換成頻率
域的資訊。 
步驟 2：量化，根據所設定的量化值 Q，將離散小波轉換後所得到的係數值依序取出來
除以 Q，然後放回。 
步驟 3：利用 SLCCA 規定的掃描順序掃描所有量化後的係數，並將掃描到的係數位
量化技術
輸入小波係數
將量化後係數位置
存入LSO
針對群聚進行編碼
將所有重要係數座
標紀錄於LSC
SLCCA副程式:
編碼重要係數
判斷係數值，輸出
是POS或NEG
結束SLCCA程式
結束SLCCA副程式
判斷子孫係數值。
做重要係數區鏈結
LINK、LCC
同一頻帶，做係數
所屬群聚中所有重
要係數編碼
 
圖 7. SLCCA 之流程圖 
 
4. SLCCA 之解壓縮程序 
步驟 1：取得輸入字串、重要係數值的資訊。 
步驟 2：將圖框內所有的起始係數設為零。 
步驟 3：按所得輸入字串順序依序將資訊取出，並判斷取出的資訊；若取出的資訊為座
標則將此座標紀錄在 LSC 字串；若取出的資訊為 LINK 則將位於 LSC 字串
內最後面的座標內係數乘以 2，並紀錄於 LCC 字串內；若取出的資訊為 POS 
則表示此資訊座標內的重要係數為正；若取出的資訊為 NEG 則表示此資訊座
標內的重要係數為負。 
步驟 4：以 LCC 字串內有係數先做處理的原則，重複步驟 3。 
步驟 5：直接將取得的重要係數值一一對應到 LSC 串列。 
 
 (二) 三角形區塊演算法 
1. 三角形區塊演算法之壓縮程序 
三角形區塊演算法首先將相鄰兩圖框分割成三角形區域（分別以 frame(t-1) 及 
frame(t) 代表前後兩張圖框），且各個三角形區域相等，如圖 8所示。 
 
 
 
 
 
 
)1,,(),','(~ −= knmSknmS rrrr                    （2） 
其中 、  分別為 r 點位移後之座標，k、k-1 分別為第 k 及 k-1 張影像圖框。若 
、 不為整數，則 r´ 灰階強度為 
rm′ rn′
rm′ rn′
])1()[1(])1([ BADcr SuuSvSuuSvS −+−+−+=′                 ） 
圖10為位移點灰階強度示意圖，其中 SA、SB、SC 和 SD 分別為 r´ 周圍四個點的灰
階值，u 為 r´ 垂直線至 SD 之距離，v 為 r´ 至 SASB 線之垂直距離。第五步則須設定
容許誤差值 e，若 r´ 灰階強度值與原圖此點灰階強度值之差值大於 e，則不將圖框
（k-1）中 r 點強度移至圖框（k）中 r ´點，並將這些位置座標紀錄之。最後則作位移
補償，也就是將重建圖框中未填滿之像素點以原圖之像素點補滿，並依序紀錄這些座標
之灰階強度值。重複上述動作，即為整個的三角形區塊演算法。 
 
 
圖 10. 位移點灰階強度示意圖 
 
2.三角形區塊演算法之解壓縮程序 
步驟1：透過所取得的資訊（即為位移後之頂點座標），求出各頂點位移向量。 
步驟2：利用各頂點位移向量計算出位移後三角形內之各個點的位移向量，並利用此位
移向量取得各個點在位移後之座標。 
步驟3：運算各 r ´點的灰階強度。  
步驟4：利用取得的大於設定誤差值之座標，將這些座標內之灰階強度值移除 
步驟5：依序將位移補償值填補於灰階強度空白之座標。 
 
五、實驗設計與結果分析 
在本研究中，我們以左心室 MRI 及 fMRI 作為測試影像資料，其第一張影像資
料如圖11所示。壓縮程序為將第一張影像以 SLCCA 技術作壓縮，再以此圖框作為基
礎，依序對第二張影像至最後一張影像分別以三角形區塊比對方式作紀錄，並將以8*8
（pixel）的等三角形區塊作比對，再分別將 SLCCA 壓縮資訊與各個區塊比對之資訊
以算數編碼方式作壓縮。在此，我們以 PSNR（peak signal-to-noise ratio）作為影像品質
之績效評估準則，其計算方式如下： 
RMSE
PSNR 255log20 10=  (4) 
 
  
2 三角形區塊比對演算法及傳統的正方形區塊比對演算法 
在此實驗設計中，以連續的左心室磁振動態影像作為實驗資料。在三角形區塊比對
方面，首先，以SLCCA 技術解壓縮後之圖框作為重建基礎圖框，依序對圖框1~16分別
以8*8（pixel）的等三角形區塊作比對，以找出位移頂點座標並紀錄之。接著再利用位
移頂點的資訊將圖框作重建，並將大於誤差值 e 之座標灰階強度值移去，所得一重建
的圖框影像如圖13（b），在此實驗中，誤差值 e 設定為25，由實驗所得。最後進行位
移補償，即可得一完整圖框影像如圖13（c）。如此反覆運作，所得一連串解壓縮圖框。
在正方形區塊比對方面，在壓縮過程中，我們以8*8（pixel）的正方形區塊作比對，來
求得區塊位移向量及位移補償值。影像在透過正方形區塊比對方式後，以位移向量所重
建之圖框影像如圖14（b）所示，在做完位移補償後所得解壓縮之圖框影像如圖14（c）
所示。如此反覆運作，即可得一連串解壓縮圖框。 
在圖框影像失真率的績效評估方面，實驗測試結果，三角形區塊比對方式所得之平
均  PSNR 值為 30.2117±0.1147；方形區塊比對方式所得之平均  PSNR 值為
14.3821±1.1153。由此可知，透過三角區塊比對方式所得之 PSNR 值遠超過傳統方形區
塊比對方式所得之 PSNR 值。換句話說，三角區塊比對方式有著較佳之成效。 
 
（a）原始圖框 （b）位移頂點所重建之圖框 （c）補償後所得之圖框 
圖13. 三角形位移頂點重建及補償後之影像 
     
  
（a）原始圖框 （b）位移頂點所重建之圖框 （c）補償後所得之圖框 
圖14. 方形區塊位移頂點重建及補償後之影像 
 （1）frame1壓縮前 （2）frame1解壓縮後 （3）frame2壓縮前 （4）frame2解壓縮後
 
（5）frame3壓縮前 （6）frame3解壓縮後 （7）frame4壓縮前 （8）frame4解壓縮後
 
（9）frame5壓縮前 （10）frame5解壓縮後 （11）frame6壓縮前 （12）frame6解壓縮後
 
（13）frame7壓縮前 （14）frame7解壓縮後 （15）frame8壓縮前 （16）frame8解壓縮後
圖15. fMRI 壓縮前後部份之圖框 
 
七、計畫成果自評 
 
由本計畫三年來所發展出之期刊論文有如參考文獻[19-23]、研討會論文有如參考文
獻[24-29]、碩士論文有如參考文獻[30-33] 。 
 
八、參考文獻 
1. (1995) Video coding for low citrate communications, ITU-T Draft Record H.263. 
2. (1993) Coding of moving pictures and associated audio for digital storage media up to about 
1.5 Mbit/s, Technique Report, ISO/IEC IS 11172 (MPEG- 1). 
3. (1994) Generic coding of moving pictures and associated audio, Technique Report, ISO/IEC 
DIS 13818 (MPEG-2). 
