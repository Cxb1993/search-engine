二、報告內容 
2-1 前言 
絕大多數之系統均為廣義能量系
統，若無其他外在因素干擾，應該會符
合指數規律，而可以利用 GM(1,1)模型
作準確之預測，也因此可以證明只有一
次累加生成序列作為各種灰色預測模型
建模之中間信息是正確的。然而，實際
的系統均或多或少會受到其他因素之影
響，不再完全符合指數規律，而必須引
進相關序列作為協調序列，以便補充信
息，以提高預測或間接量測之準確度，
而應以具有協調序列之預測模型如例如
GM(1,n)、GMC(1,n)等來分析。 
信息不完全為灰色系統之主要特徵，
必須補充信息而使關係由灰變白。但是灰
色系統之傳統模型 GM(1,n)之解法並不正
確。 
本計畫就灰色預測模型 GM(1,n)作研
究 與 改 良 成 為 灰 色 動 態 捲 積 模 型
DGDMC(1,n)，對於模型參數作適當之調
整 ， 其 系 統 參 數 係 以 絕 對 收 斂 法
(deterministic convergence scheme)求得，
並以捲積(Convolution Integral)算法求出
多序列灰微分方程式之正確解，以便能確
保因為引進協調序列及其一階導函數而
提高傳統灰色預測模型之預測準確度。使
在經濟預測、工程數值之間接量測等方面
十分準確而能廣泛地被應用。 
 
2-2 研究目的 
由於傳統之GM(1,n)模型之解法並不
正確，往後研究者卻多沿用，使預測準確
度不如預期，而對灰色系統可利用引進協
調序列來補充信息，進而提高預測準確度
之基本原理產生懷疑，傅立的書更直截了
當的指出「在GM(N,H)模型中，當 2≥H
時，所建模型不能作預測用，只能用於分
析因子之間之相互關係。」[1]，殊不知鄧
聚龍教授所提出傳統GM(1,n)模型之解法
存在有極大之錯誤。 
信息不完全是灰色系統之主要特
徵，必須補充信息，使系統之關係由灰變
白。灰色預測模型之補充信息方式以引進
相關序列作為協調序列最為有效，因為引
進較多之協調序列，便含有大量預測原點
鄰近之元素，那是特別重要之信息，比增
加單一序列元素數量之方式更能充分、有
效地補充信息，協調序列之一次累加生成
序列之一階導函數對信息之補充也具有
相當大的重要性，將一併作為系統之輸入
函數，以便大幅提高模型預測之準確度。 
GDMC(1,n)模型[2]之系統參數係以
最小平方法求得，雖然最小平方法非常簡
單，但是最小平方法是漸近有偏誤的
(asymptotically biased)。特別是當預測序
列存在有預測原點附近之反曲點時，
GDMC(1,n)模型便不再能準確預測或間接
量測；本研究所提出之絕對灰色動態捲積
模型 DGDMC(1,n)之系統參數則係以絕對
收斂法求得無偏估計(unbiased estimate)。
使在經濟預測、工程數值之間接量測等方
面十分準確而能廣泛地被應用。 
 
2-3 文獻探討 
灰色理論是1982年由大陸學者鄧聚
龍教授所提出，是一種新理論，適用於預
測、決策、與控制等之分析，特別適用於
預測之分析[3,4]。 
由於鄧聚龍教授所提出之灰色理論在預
測與決策模型上存在一些疑問與錯誤，尤
其是預測模型並沒有提出嚴格之數學分
析[3,5]；本人則因發表論文與在研究所授
課之需，已進一步證明例如灰微分方程式
只有一階(GM(1,1)、GM(1,1)、與其延伸模
型 GDM(1,1,1)、DGDM(1,1,1)、GMC(1,n)
等等)是正確的[6]、累加生成運算只有一
次(1-AGO)是正確的[6]等。離散序列數據
之累加生成運算相當於連續函數之積
分；離散序列數據之累減生成運算則相當
於連續函數之微分[6]，對於廣義能量系統
之分析，其系統行為特徵值序列之一次累
加生成後之新序列可用以建立一階灰微
分方程式以進行預測分析，能充分運用有
限之數據信息預測未來的數值，應用範圍
廣泛，諸如國民生產毛額、財稅、物價、
交通運輸、教育文化、農林漁牧、工程數
 2
),()...,,,( 10 gEgggEE m ==           (8) =+++ )()( )1(1
)1(
1 tnpX
dt
tnpdYα  達到極小，其中gi為待定模型參數。由(8)
式所定義之誤差函數可視為一個超曲面
(hypersurface)，並定義為 rttXdt
tdXn
j
jj
j
j ,...,2,1],)(
)(
[
2
)1(
2
)1(
1 =+∑
=
ββ  
,)( 0EgE =                      (9)                              (16) 
其中 E0 為該誤差函數的極小值，故吾人
必須求得為 
及某個模型可由(4)式表示。方程式(4)
與 (16) 式 可 分 別 用 顯 函 數 表 示 為
與 。若沒有
受到干擾，則在最佳狀態的鄰近，誤差
是 微 小
的。若e(t)充分的小，則 約等
於 
...)()1(1 =+ tnpX ...)()1(1 =+ tnpY
)()()( )1(1
)1(
1 tnpXtnpYte +−+=
)()1(1 tnpX +
.)(0 dggEE =⏐=                     (10) 
又該誤差函數可在最小值處以泰勒級數
(Taylor series)展開為 
)()()(  0 dgg
gEEgE dg −⏐+≅ =∂
∂  
)()()(
2
1
 
2
 ' dg
gg
gEdg dg −⏐−+ =∂∂
∂       (11) )()(ˆ )1(1)1(1 tnpRDYtnpX +−=+  
,)()(
2
)1(
21∑
=
++
n
j
jjj tXSDS         (17) 因 為 E 在 g=d 處 有 極 小 值 ， 故
0)(  =⏐ =dgg
gE
∂
∂ 且 dggg
gE
=⏐ 
2 )(
∂∂
∂ 為 正 定
(positive definite)。因此 
其中 dtdD /= ，因此 
)(ˆ)()( )1(1
)1(
1 tnpXtnpYte +−+≅      (18) 
或 
).()()(
2
1)(  '
2
 '
0 dg
gg
gEdgEgE dg −⏐−+≅ =∂∂
∂  )()()( )1(1 tnpDYRte +−≅ α  
∑
=
−+−−
n
j
jjjjj tXSDS
2
)1(
2211 )()]()[( ββ  (19) (12) 
由(12)式可得 若定義 
1γα =−R , 
)()()(  '
2
 '
dg
gg
gE
g
gE
dg −⏐≅ =∂∂
∂
∂
∂          (13) 
22121 γβ =−S , 
,33232 γβ =−S  或 
…, 
⎥⎦
⎤⎢⎣
⎡ ⏐
⎥⎥⎦
⎤
⎢⎢⎣
⎡ ⏐=− =
−
= )(
1
 '
2 )()(
iggdg g
gE
gg
gEdg ∂
∂
∂∂
∂ , (14) ,2211 −=− nnnS γβ  
1222 −=− nnnS γβ  
及 因此 
),()( 1
)1(
1 tvtnpDY =+  
⎥⎦
⎤⎢⎣
⎡ ⏐
⎥⎥⎦
⎤
⎢⎢⎣
⎡ ⏐−=+ =
−
= )(
1
 '
2 )()()()1( iggdg g
gE
gg
gEigig ∂
∂
∂∂
∂
                                (15) 
)()( 2
)1(
2 tvtDX =− , 
)()( 3
)1(
2 tvtX =− , 
…, 為 最 陡 下 降 算 法 (steepest-descent 
algorithm)。 )()( 22
)1( tvtDX nn −=− , 
),()( 12
)1( tvtX nn −=−   其 中 與 係 先 將
與 作三次
樣條函數[8]擬合後再求得。然後，可得 
)(1 tv nitv i ...,,3,2),(22 =−
)()1(1 tnpY + nitX i ...,,3,2,)()1( =2-4-3 系統參數 R, Sj1, j = 2, 3, …, n 及 
Sj2, j = 2, 3, …, n 之求法 
    假設某過程可以微分方程描述為 
 4
+×+−+− )((
2
1[1
2
1 )5.05.0(1
2
2 τω λτ fe
R
t
R  
))]},1()((
2
1))1( 2 −−+− ττλτ fff  
,...,,3,2 rfrt +=               (32) 
其 中 0.121 ==ωω 、 1λ 與 2λ 分別等於
3/1− 與 3/1 、u(t-2)為單位步階函數
(unit step function) 。 對 (32) 式 中 之
作一次累減生成運算，可得
白化值 
)(ˆ )1(1 trpX +
)1()1()1(ˆ )0(1
)1(
1
)0(
1 +=+=+ rpXrpXrpX  
(33) 
及 
),1(ˆ)(ˆ)(ˆ )1(1
)1(
1
)0(
1 −+−+=+ trpXtrpXtrpX
....,,3,2 rfrt +=                 (34) 
    關於預測準確度之檢測，吾人可應
用均方百分比誤差RMSPE(root mean 
square percentage error)分別檢測預測序
列在預原點之前與之後的預測成效
RMSPEPR與RMSPEPO，RMSPEPR與
RMSPEPO分別定義為 
=RMSPEPR     
(%) 100)](/[)]()(ˆ[
n
1 2)0(2)0()0(
1
×−∑
=
tXtXtX
n
t
                             (35) 
及 
=RMSPEPO
(%) 100)](/[)]()(ˆ[
nf
1 2)0(2)0()0(
1
×−∑+
+=
tXtXtX
nfn
nt
                             (36) 
    至於 DGDMC(1,n)預測模型要如何
應用在材料機械性質之間接量測，茲以某
材料之勃氏硬度為協調序列作該材料在
較高溫度下之抗拉強度之間接量測為例
說明如下： 
材料之機械性質，尤其是抗拉強度常
常是機械設計選擇適當材料之重要依
據，材料之硬度與抗拉強度均會隨著溫度
之升高而降低，但尚無法表示兩者確切之
函數關係。測試材料之勃氏硬度一次大約
需要 10 秒鐘，測試抗拉強度則大約需要 2
分鐘，因此，在高溫下(例如 800oF 以上)
測試抗拉強度時，試片(test piece)必須保
溫，測試設備比較昂貴，否則將會高估試
驗結果(冷卻到較低溫度時，材料之流動性
降低，硬度與強度均會提高)。 
假設某材料在800oF以下之勃氏硬度
與抗拉強度均已被測得，而在800oF以上則
僅測試勃氏硬度，如此便可以勃氏硬度為
協調序列，抗拉強度為預測序列進行800oF
以上抗拉強度之間接量測。 
 
2-5 結果與討論 
本研究以一個實際的例子之分析來
說明 DGDMC(1,n)模型應用，並說明
DGDMC(1,n)模型採用絕對收斂法求解
系統參數對預測或間接量測之準確度具
有決定性之影響。 
    本實例以某材料之勃氏硬度為先
行指標間接量測對應於較高溫度之抗拉
強度來說明DGDMC(1,n)模型確實具有
很高的間接量測或預測之準確度。考慮
Samuel (1952)[10]書上之表159中之觀
察值(observations)，包括溫度由4000F至
13000F之熱處理鋼9255(fine grained)之
勃氏硬度及抗拉強度之實際量測值，該
材料在15500F之溫度退火、16500F之溫
度正常化、及16250F之溫度在油中淬
火。共有10組實際量測數據，列於表1。
其中前5組用於建模，第6至10個抗拉強
度數據則留待與間接量測值比較之用。 
    以勃氏硬度 (記為 )為先行指
標、抗拉強度(記為 )為預測序列，
由預測原點(forecast origin，r=5)前共五
組數據可建立DGDMC(1,2)模型，則由
(15)至(34)式可求得(4)式中之系統參數
R, S21, 及S22之絕對收斂估計，列於表
2；(4)式中之參數n, r, rp、(34)式中之rf
等亦列於表2；作間接量測分析係假設(4)
式中之系統參數R, S21, 及S22維持不變，
在結合先行指標在預測原點前、後之數
據，則(4)式等號右邊各項加總之數值，
即(24)中之f(t)可求得，並列表3；再由(30)
至 (34)式求得抗拉強度之間接量測值
，列於表4，並圖示於
圖1。預測準確度之檢測(35)與(36)式中
)0(
2X
)0(
1X
10...,,7,6),(ˆ )0(1 =iiX
 6
  
表2 關於Samuel (1952)書上溫度由4000F
至13000F之熱處理鋼9255之抗拉強度
間接量測，(4)式中之參數n, r, rp、(34)
式中之rf、(4)式中之系統參數R, S21, 及
S22之絕對收斂估計、分別在(35)與(36)
式中之RMSPEPR與RMSPEPO 
表4 Samuel (1952)書上之熱處理鋼9255
在溫度由9000F至13000F以勃氏硬度
為先行指標之抗拉強度之DGDMC 
(1,2)間接量測值及實際量測值 
參數 數值 
n 2 
r 5  
rp 0 
rf 5 
R - 6.31875×108 
S21 - 2.11576×109  
S22 - 7.01858×106  
RMSPEPR (%) 0.82  
RMSPEPO (%) 1.85  
 
表3 (24)式中之函數f(t)之數值 
t f(t) 
1 - 1.28396×1012 
2 - 1.26368×1012 
3 - 1.19524×1012 
4 - 1.08821×1012 
5 - 9.66073×1011 
6 - 8.26375×1011 
7 - 7.31362×1011 
8 - 6.69514×1011 
9 - 6.00134×1011 
10 - 5.77104×1011 
i(溫度
0F) 
間接量
測 
值
)(ˆ )0(1 iX
(MPa) 
實際量
測值
 )()0(1 iX
(MPa) 
間接量
測之百
分誤差
6(900) 1418.36 1414 0.31 % 
7(1000) 1232.63 1242 - 0.75 %
8(1100) 1108.51 1104 0.41 % 
9(1200) 1004.67 993 1.18 % 
10(1300) 931.54 897 3.85 % 
 
表5 Samuel (1952)書上之熱處理鋼9255
在溫度由9000F至13000F以勃氏硬度
為 先 行 指 標 之 抗 拉 強 度 之
GDMC(1,2)[2]間接量測值及實際量測
值 
i(溫度
0F) 
間接量
測 
值
)(ˆ )0(1 iX
(MPa) 
實際量
測值
 )()0(1 iX
(MPa) 
間接量測
之百分誤
差 
6(900) 1322.99 1414 - 6.44 % 
7(1000) 1083.89 1242 - 12.73 %
8(1100) 869.16 1104 - 21.27 %
9(1200) 651.58 993 - 34.38 %
10(1300) 390.17 897 - 56.50 %
 
 
 
 
 
 
 8
