normalization of PGC demodulation system using laser 
modulation to generate carrier signal.（2）
Intelligent noise reduction technique of FOIS system.
（3） Digital signal processing of PGC demodulation 
using FPGA.  
Two applications of FOIS mentioned here: （1） Debris 
flows monitoring system of FOIS.（2）High sensitive 
security detecting system of FOIS using PGC 
demodulation. The research and fabricate of the two 
FOIS systems combine the past and future techniques 
to attain the field application. 
 
英文關鍵詞：  
 
  
一、中文摘要 
干涉式光纖感應器具有許多優點例如靈敏度高、動態範圍大、線性度佳、具安全本
質、不受電磁干擾及極佳的多工功能。此外干涉儀的感應光纖可以偵測由聲音及壓力等
物理場引起的相位訊號，因此應用極為廣泛。但在實際應用上，干涉式光纖感應器必須
具有高功能感應器的基本要求，例如低雜訊，高靈敏度及高精確度。深入研究干涉式光
纖感應器的結構本質及訊號解調技術，仍有一些潛在問題限制干涉式光纖感應器的實用
性，經過廣泛總結，本計畫提出三項新技術研發：（1）使用雷射調變產生載波訊號之
PGC 解調系統的靈敏度歸一化技術。（2）干涉式光纖感測系統的智慧型雜訊消除技術。
（3）使用 FPGA 作 PGC 解調的全數位化訊號處理。 
在應用方面本計畫提出二項：（1）使用干涉式光纖感應器的土石流監測系統。（2）
使用 PGC 解調的高靈敏度安全偵測系統。這二項光纖感測系統的研製，結合了過去及
未來二年所規劃的技術研發之應用，使得干涉式光纖感測系統更具有實用性。 
 
 
二、英文摘要 
Fiber optic interferometric sensors（FOIS）have many advantages such as extremely high 
sensitivity, wide dynamic range, electrically passive, immunity to electromagnetic 
interference and multiplexing. Additionally, the sensing fiber of the interferometer is capable 
of detecting the phase signal induced by physical fields such as acoustics and pressure. 
Therefore, the applications of FOIS are wide. However, in the practical applications of FOIS, 
they must possess the basic requirements of high performance sensors, such as low noise, 
high sensitivity and high accuracy. When we study in depth the natural structure and signal 
demodulation techniques of FOIS, there are some latent problems limiting the field 
applications of FOIS. Some factors can influence the signal-to-noise ratio and sensitivity of 
FOIS obviously. After extensive summary, there are three new techniques of FOIS for field 
applications, such as：（1）Sensitivity normalization of PGC demodulation system using laser 
modulation to generate carrier signal.（2）Intelligent noise reduction technique of FOIS system.
（3） Digital signal processing of PGC demodulation using FPGA.  
Two applications of FOIS mentioned here: （1） Debris flows monitoring system of FOIS.
（2）High sensitive security detecting system of FOIS using PGC demodulation. The research 
and fabricate of the two FOIS systems combine the past and future techniques to attain the 
field application. 
  4 
 
（二）研究目的 
光纖感應器具有靈敏度高、動態範圍大、不受電磁干擾、適合多工及長程傳輸 (光
纖傳輸損耗小且分光容易)等優點，本計畫將利用干涉式光纖感應器對聲壓感應極為靈
敏的特性，研究光纖感應器在聲音及壓力相關偵測系統上的應用。隨著社會發展的多元
化以及治安事件難以斷絕，在一些住宅社區及重要廠區等，設置可靠的全天候室外安全
偵測系統將日益重要。另外因地球軟氣候暖化，在台灣暴雨一再創新紀錄造成嚴重土石
流，研發功能佳成本低的土石流監測系統便相對重要。因此，在「干涉式光纖感測系
統的靈敏度歸一化與數位訊號處理」之研究計畫中，將深入探討干涉式光纖感應器一些
仍亟待研發的新技術，以及幾個重要之應用。 
 
 
（三）文獻探討 
雙臂式單模態光纖干涉儀是極為靈敏的感應器，其兩個光纖臂分別作為參考臂及感
應臂，或者都作為感應臂亦可，感應光纖臂可以感應各種物理場訊號(1)。使用適當的訊
號解調線路，可線性解調感應的相位訊號(2), (10) ~(13)。另外也有論文提出最常用的 PGC
解調之改善方法(14)。但一般雙臂式光纖干涉儀有偏振訊號褪變問題(15)，使用以法拉第旋
轉鏡 (Faraday rotator mirror，簡寫為 FRM) 取代邁克遜干涉儀兩光纖臂端點的反射鏡，
使用一般光纖便可製成無偏振感受性光纖干涉儀(16)，完全解決了偏振引起的訊號褪變問
題。在 PGC 解調電路的功能改善方面，從 95 年度的研發所獲得的成果，證明必須使用
引線光纖延遲相位補償技術(7)，才能使 PGC 解調輸出維持在最佳靈敏度。但為了使引線
光纖延遲相位補償能自動化，同時又能以較 FPGA 的硬體及軟體來達到預期功能，必須
使用數位相乘取代傳統類比相乘及能精密調整延遲相位的同步電路。使用 PGC 解調作
為高靈敏度安全偵測系統及土石流監測系統等的基礎，因傳統 PGC 解調使用類比電路
製作有電路老化、準位飄移等現象，易引起 PGC 解調失真等問題，也無法作準確及完
整的靈敏度歸一化控制，因此尚需研發完整的靈敏度歸一化技術與智慧型數位化訊號處
理，使其具有高偵測率及低誤報率的偵測功能。之前 PGC 解調系統的 PGC 解調歸一化
技術，是在光纖干涉儀的干涉臂上，使用 PZT 相位調制器產生載波相位訊號（9）（17）（18），
但在許多應用上實用的光纖感應器必須為全光纖結構，因此光纖感應器不能使用 PZT
相位調制器，PGC 載波相位訊號及模擬感應相位訊號都必須使用雷射電流調變，配合干
涉儀的不等長路徑以產生相位訊號，這也是新研發的靈敏度歸一化技術所必須考慮的問
題。 
 
 
（四）研究方法 
本年度在干涉式光纖感測系統的靈敏度歸一化與數位訊號處理方面的研究，主要
分成以下兩個項目： 
（1）使用雷射調變產生載波訊號之PGC解調系統的靈敏度歸一化技術。 
（2）使用 FPGA 作 PGC 解調的全數位化訊號處理及其在土石流監測系統及高靈敏度   
安全偵測系統的應用。 
（3）干涉式光纖感測系統的智慧型雜訊消除技術。 
 
詳細的研究內容，分述如下： 
 
  6 
 
 
圖一、 使用雷射電流調變產生載波相位訊號的 PIFOMIS 系統。 
 
在 PGC 解調系統中，引線或感測光纖的損耗，及雷射老化都會引起光強度衰減(屬
於 DC 或極低頻的變化)，這也是引起 PGC 解調輸出靈敏度改變最基本且最重要的因素，
必須做適當的靈敏度補償。但如前所述，在做靈敏度補償時須同時考慮因雷射調變引起
的載波光強度調變問題。公式(9)中第一項為正常 PGC 解調輸出，正比於 22kb ，因此當
干涉訊號的干涉項振幅bk 改變時，需做靈敏度之補償。由於 PGC 解調的高頻載波相位
訊號最佳振幅為 rad37.2 （＜ rad ），因此不能作為正確獲得干涉項振幅之依據。可模
擬一個在 PGC 解調輸出頻寬外的低頻（例如 10Hz）相位訊號，此低頻訊號和載波相位
訊號相加後，需在其周期（0.1sec）內確保能產生干涉訊號之極大和極小值（亦即最大
相位減去最小相位須大於 rad2 ），以正確計算干涉訊號振幅及作為補償之依據。假設
加入的低頻相位訊號為 tLL  sin ，其頻率為 10Hz（則載波訊號 100kHz為 10Hz的 10000
倍），則在 tLL  sin 的最大值附近時（例如 tLsin 在 0.999→1→0.999 內 tL 範圍為
5.12°，有 142個 100kHz訊號之周期存在），總相位為載波相位訊號 tc sin0 加上 L 。
同樣的在 tLL  sin 的最小值附近時（例如在-0.999→-1→-0.999內 tL 範圍為 5.12°，
有 142 個 100kHz 訊號之周期），總相位為載波相位訊號 tc sin0 減去 L 。假設
radL 405.2 （對應 0)405.2(0 J ，按後面 phase scrambler 理論推導，此時解調輸出訊
號失真最小），則在 10Hz 的相位最大值附近時，對應的最大相位訊號為
 radbb   775.4405.237.2 ，在相位最小值附近時，對應的最小相位訊號為
 radbb   775.4405.237.2 。因此無論 b 為任何值，最大和最小相位訊號差恆
為 radrad 255.9  ，因此在 0.1秒內最大和最小相位訊號差大於 rad2 都能成立，確保
干涉訊號有極大極小值出現，能獲得正確的干涉訊號振幅。加入 tLL  sin 後 PIFOMI
的輸出干涉訊號  tI 修正如下式：
 
 
 
       
      tttVtV
ttttktdtabtI
cT
sscLLbLc


sincos
sinsinsincos1sinsin1
010
0


  
(3) 
 
上 式 中    tdtabtV Lc  s i ns i n10  ，    tdtabktV Lc  sinsin11  及
    tttt ssLLbT  sinsin  。其中 ta csin 及 td Lsin 為雷射光的強度調變。要
獲得正確的干涉項振幅(即(3)式中的bk 之乘積)，會受到此兩光強度調變的影響，亦即每
  8 
 
圖二、 EP1550 雷射配合 ΔL = 9cm 干涉儀，以雷射電流調變複合產生 100kHz 相位訊號
rad37.2 及 10Hz 相位訊號 rad405.2 ，由光接收器輸出的干涉訊號波形。 
 
      
圖三、DFB 雷射配合 ΔL= 9cm 干涉儀，以雷射電流調變複合產生 100kHz 相位訊號
rad37.2 及 10Hz 相位訊號 rad405.2 ，由光接收器輸出的干涉訊號波形。 
 
表一為使用光衰減器調整在不同衰減倍率後作靈敏度歸一化補償的相對誤差百分比
值（以光接收器將干涉訊號放大 10 倍後峰對峰值為 5V 的情況作參考基準）。EP1550 雷
射及 DFB 雷射分別配合 ΔL 等於 9cm 及 24cm 之干涉儀，使用光衰減器調整在不同衰
減倍率後作靈敏度歸一化補償，PGC 解調輸出的 2kHz（ rad1 ）模擬感應相位訊號振幅
變化的誤差百分比值。實驗結果顯示 EP1550 雷射及 DFB 雷射配合 ΔL = 9cm 之干涉
儀，在光接收器將干涉訊號振幅放大 300 倍以內時（和參考基準相比，光強度大約衰減
到 30 倍左右），解調輸出的 2kHz 訊號振幅變化誤差都在 0.6%以內。 
 
 
 
表一、 使用光衰減器調整在不同衰減倍率後作靈敏度歸一化補償的相對誤差百分比
值（以光接收器將干涉訊號放大 10 倍後峰對峰值為 5V 的情況作參考基準） 
  2 
    使用 Simulink 作為平台，模擬所需要的訊號，並以數位離散 PGC 解調系統
取代類比 PGC 系統。 模擬原本的載波與感測訊號作用在光纖干涉儀，產生干涉
後，如光接收器的類比訊號輸出，光干涉訊號如下式所示：  
]sin)(cos[ 0 ttBAI c                     （1）     
並且產生類比 PGC 解調所使用與解調載波相同頻率的訊號，模擬出 PGC
解調程序需要的一倍頻，使用一倍頻產生二倍頻，如使用 tcs in 進行倍頻
後為
2
2cos1 tc ，進行濾波後可得二倍頻率。 
    模擬修正型的 PGC 解調程序進行解調(如圖一修正型的 PGC 解調器之相
位解調處理技術方塊圖(7)。干涉訊號進入平行架構的兩個乘法器同時與一倍
頻與二倍頻相乘後，進入兩個相同的低通濾波器。進行微分後，兩兩與另
一平行尚未微分訊號作乘法，後進入減法器後積分即可得到所加入的感應
訊號。當然其中的濾波器，需要兩個完全相同的，微分器需要確保訊號在
高頻時不會飽和，以及積分器在低頻時不會飽和。 
 
圖一 修正型的 PGC 解調器之相位解調處理技術方塊圖。  
    使用簡化的相位載波調變，同樣進行PGC解調程序，不同的是根據修正型
的PGC解調器之相位解調處理技術(7)，利用等效的乘法器進行模擬，原本需要每
一個取樣點作實質乘法以等效的方波作取代，達到更簡便的方式進行解調。 
使用Xilinx®  support DSP元件架構在 Simulink平台上，利用ML506-FPGA 所
支援的 DSP 去建構數位系統。 其訊號的模擬也與上一節相同 (當然進行實際上
的數位系統進行實測時，訊號源會經由干涉儀輸出，經過類比數位轉換器進入數
位系統)，干涉訊號載波為 97.656 kHz，以及解調感應訊號 10 kHz 與 10 Hz 擾頻
訊號(scrambler signal)。數位取樣頻率為 3.125 MHz，PGC 解調所需要的基頻與
二倍頻，所用 12.5MHz，對於基頻為 128 點/T， 二倍頻利用延遲(Delay)以及互
斥或閘(xor-gate)產生 64 點/T，輸入系統。 
 根據類比數位轉換器 16-bit-ADC7625 最大取樣率為 6 MHz ，該取樣範圍為
-4.096 ~ +4.096 ，利用 FPGA 所產生 200 MHz 系統頻率進行 2 的次方降頻時，
可以降至 3.125MH 可以達到數位轉換器取樣頻率的使用範圍內。所以對於光纖
干涉儀干涉訊號輸入取樣率為 3.125 MHz，基頻頻輸入端為了調整引線光纖 PGC
解調的相位延遲補償，用基頻產生二倍頻，所產生的相位差以及引線光纖所造成
  4 
期有 16 點。接著 PGC 的後續處理電路（包括微分器、乘法器、減法器及積分器）
的時脈還要再除以 4，大約 390.625 kHz 左右（第四個時脈），相當於把低通濾波
輸出的數位訊號再除 4（亦即對應一個載波訊號周期有 16 點中每 4 點取 1 點）。
由於在 PGC 中低通濾波輸出後的最高頻率約為 45 kHz（低通濾波器的 3dB 頻寬
為 45 kHz  stopband 頻寬為 90 kHz，60 dB/octave），因此 45 kHz 訊號一個周期
平均約有 8.68 點（時脈 390.625 kHz），因此在 FPGA 電路處理上應不會有任何
問題。PGC 解調輸出（即積分器輸出）的最高訊號頻率為 10 kHz，相當於 10 kHz
訊號一個平均周期約有 39.06 點，數位中，應非常足夠可以恢復該感應訊號。 
    因此如果微分器、乘法器、減法器及積分器所佔用的處理時間若太大，可以
將前述 PGC 的後續處理電路（包括微分器、乘法器、減法器及積分器）的時脈
還可再除以 8，為 195.3125 kHz 來執行。         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
（3）數位元件設計原理以及調整 
 (a)   等效乘法器 
利用與基頻相同的方波，去選擇干涉訊號當下訊號的反相與否，可達到原本等效
於基頻與 2 倍頻與干涉訊號相乘分別得到：(7) 
)(sin)(
4
)( 11 ttF
B
tS 


                      （2）  
)(cos)(
4
)( 22 ttF
B
tS 


                        
 
(3) 
其中 
14
0
2212
0
11
12
)1(
)0()(),37.2(
12
1
)0()( 










 n
n
n
n
n
J
n
FtFJ
n
FtF
          (4)
 
當載波相位 2.37rad 時可以得到最大值解調訊號。 
 
(b)   微分器設計原理 
微分器容許最高頻率的最大振幅值在 PGC 解調系統，可以推導出由類比
微分器 Z 轉換後，所得到的數位微分器其轉移函數如下：
 
T
TnxnTx
t
tx ))1(()()( 



                                   (5) 
)(
)(11
]
))1(()(
[)(
1
zX
zY
Tz
z
T
z
T
TnxnTx
ZzH 







            (6)
 
   所以代表輸入訊號進行一個離散數據的延遲後，與原訊號相減後，即代表進
行微分的動作。 
  假設載波頻率 (carrier frequency) 97.656 kHz，低通濾波器 (low pass filter 
  6 
)()( ntuAenth pnT
                                (13)
 
對上次進行 z 轉換可得數位濾波器的轉移函數： 
                   
 
1
0 1
)()]([)(


 
 
ze
A
ntuAenthZzH
pT
n
pnT
               (14) 
其中高頻截止頻率為 
                        
p
FH
2
1

                                 (15)
 
    使用 6 kHz 振幅 1 rad 的感應訊號其輸出值電壓振幅為 0.5 volt（此設定值相
當於振幅 10 rad 的感應訊號輸出值電壓振幅為 5 volt），以此作為半積分器調整的
根據。半積分器（在類比電路是以回饋電阻和回饋電容作並聯來達到半積分器功
能，可避免 DC 訊號積分飽和，FPGA 中半積分器應依此等效電路來設計。）具
有低通濾波功能，其高頻截止頻率設定為 20 Hz 。 
  (d)   低通濾波器設計 
因 PGC 解調是根據 Bessel，需要考慮使用頻帶內訊號在 Bessel 函數分量，
所以濾波器設計的頻帶上，要符合設計訊號的最大相位，解調不失真，即為濾波
器通帶外的倍頻不超過 60 dB 的分量，即可忽略，不會造成解調的失真。 
    製作濾波器有許多模式，根據不同的需要考慮不同使用模式，對於 Bessel
函數其分量，在使用頻帶內需要等增益倍率，解調輸出後才不會造成訊號失真，
在相位延遲部分，對於各個頻率分量也需要線性相位延遲或者為常數。 
    本文使用的低通濾波器頻帶範圍為增益降低 3 dB 時頻率 45 kHz， 超過 45 
kHz 到 90 kHz 之響應曲線下降率至少達到 60 dB/octave，意即假設使用頻率為
6 kHz 操作在最大相位振幅時， 其干涉儀輸出的干涉訊號八倍頻分量
8J 其最大
值需要低於 60 dB 才可以忽略。 
 
（4） 數位元件 
   使用數位系統須要有一個可以作為系統核心的平台，場效可程式邏輯閘陣列
（FPGA，Field Programmable Gate Array）可以提供我們所需的訊號處理以及系
統所需要的時脈，當然接收干涉儀訊號進入數位系統需要類比數位轉換器。以及
使用雷射調變 PGC 解調所需要的相位載波與感測訊號，利用微控制器(MCU) 
ADuc841 來進行 AD9834 的類比訊號產生以及 AD575 的 DC-gain 的調整，數位
系統要換成類比系統，使用於 FPGA PGC 解調號訊號轉換 DAC，便於觀察當下
  8 
（6）數位系統時脈及取樣頻率 
    本實驗在數位 PGC 解調過程中，使用 Xilinx FPGA ML506 200MHz 工作頻
率為主要時脈，再經由訊號處理方式產生其他系統所需的工作時脈，如表一。 
    而在數位 PGC 解調系統中，可以區分兩個部分共四個取樣頻率。第一個部
分為邁克遜干涉儀系統的類比輸入訊號。此部分為 ADuC841 產生訊號，包含進
入雷射控制器的基頻載波訊號及補償觸發訊號。第二個部分為 FPGA Xilinx 
ML506 系統接收訊號。此部分為 AD7625 數位取樣干涉訊號及數位 PGC 解調過
程訊號。首先是干涉訊號的取樣頻率，以及相位補償降頻後的基頻訊號。經過等
效乘法器後再降兩倍取樣頻率，輸入低通濾波器。濾波器輸出後訊號可再降四倍
變成 390.625KHz，如表二。 
表一  使用 Xilinx FPGA ML506 systems 所產生的頻率 
使用時脈(MHz) 200 100 100 
產生時脈(MHz) 100 12.5 3.125 
備註 ADC 工作頻率 MCU 工作頻率 ADC 取樣頻率 
 
表二  FPGA 內 PGC 解調時脈 
使 用 時 脈
(MHz) 
12.5 3.125 1.5625 0.390625 
 基頻 輸入取樣訊號 訊號降頻 濾波後降頻 
 
備註 
ADuC841 
microprocessor 
systems 
Xilinx ML 506 
systems 
Xilinx ML506 
systems 
Xilinx 
ML506 
systems 
 
（7）  低通濾波器及帶通濾波器設計 
為了完成相位補償功能，需要由雷射調變模擬一個高於 PGC 解調最大頻率
不易受環境雜訊影響的感應相位訊號，如 10 KHz。如果 PGC 解調頻寬較小及載
波頻率較低，例如只有 30 KHz。因此 10 KHz 的兩倍頻必須降低到小於 PGC 解
調的低通濾波器頻帶的 3dB 頻寬之內，作為調整基頻與二倍頻載波相位的依據。 
但受限於 PGC 解調低通濾波器的頻帶，高頻訊號振幅必須小於 rad36.0 使高頻
感應相位訊號能線性解調。依據第一類的 Bessel 函數值在 rad36.0 以內時，高頻
訊號在干涉訊號中其 3 倍頻（正比於  3J ）及更高頻率分量都以可以忽略，因
此 PGC 解調的低通濾波器頻寬只要超過 2 倍諧頻分量便可對此高頻感應相位訊
號作線性解調。而為了分離感應訊號與 10 KHz 補償訊號，在 PGC 解調輸出再設
計 3dB 為 7K 的低通濾波器，如圖三，以及一個通帶為 9K 到 11K 的帶通濾波器，
如圖四。而 PGC 解調後端低通濾波器及帶通濾波器設計架構，如圖五。 
  10 
處理數位訊號方面的優點，可以使用延遲(Delay)塊即可進行位移訊號達成補償掃
描方式，相位補償流程圖如圖六所示。補償方式進行數位設計，可分為三個部分
說明如下： 
第一個部分是訊號延遲位移。利用計數器(Counter)輸出 0 到 31 共 32 個數值，加
上選擇器(Mux)的配合，來完成控制訊號位移。當計數值為 0 時表示補償零度，
計數器計數值往上增加掃描角度，而計數值為 15 時表示補償 90 度。計數器計數
到 31 時表示全部掃描完 180 度，如圖七。 
    第二個部分是振幅存取及大小比較。當新的訊號延遲位移前，需將舊的位移
振幅值儲存在暫存器。當新訊號位移後累加 32 次的振幅值，將此值平均後與舊
的振幅值比較。新振幅值大於舊振幅值時，將新振幅值存入暫存器內，並且用另
一暫存器儲存相對位移值。 
    第三部分為控制一、二倍頻調整。在調整二倍頻時一倍頻延遲需要固定，當
調整一倍頻時二倍頻要固定，因此使用選擇器及計數器來選擇調整順序。一開始
計數器輸出為 0，一倍頻選擇器選擇為 0 輸出一倍頻零度補償訊號。當二倍頻 32
次位移完成後觸發計數器輸出為 1，選擇器選擇為 1 輸出一倍頻 90 度補償訊號。 
比較二倍頻兩組振幅值後固定二倍頻最大延遲次數，計數器輸出為 2 而選擇器選
擇為 2 並開始一倍頻 32 次的位移。當一倍頻位移完成後，計數器輸出為 3 時固
定一倍頻最大延遲次數。而當計數器輸出為 0 與 1 時，二倍頻選擇器輸出 32 次
位移，計數器輸出為 2 與 3 時，選擇器輸出二倍頻最大延遲次數。 
   經過此三個步驟後完成一二倍頻相位調整，使解調訊號有最大解調振幅。 
 
  
圖六數位相位延遲補償流程圖 
  12 
 
圖八 數位解調靈敏度歸一化流程圖 
 
圖九 10Hz週期內訊號最大、最小值 
 
 (三) 實驗測試與實驗結果 
    本實驗結果會分別對三個部分做驗證，第一個部分為訊號在 Simulink 平台
元件驗證；第二個部分為 Xilinx 平台元件驗證，使用類比弦波訊號源測試每個元
件的功能性；第三個為實際干涉訊號輸入系統解調輸出模擬感應訊號。數位解調
系統使用 Simulink 以及 Xilinx 平台元件，共可分為四個部分，第一部分為訊號
源模擬，用來模擬輸入感應弦波訊號及載波訊號；第二部分等效乘法選擇器，用
於選擇輸入正負的干涉訊號，利用此處理方式可加速訊號的處理；第三部分低通
濾波器，用於濾除高頻訊號保留低頻訊號。第四部分微分、積分器，確保訊號積
  14 
（b）低通與帶通濾波器 
    PGC 解調架構中，低通濾波器具有非常重要的功能，用於濾掉基頻與二倍
頻訊號、與干涉訊號作用後的高頻載波 。濾波器設計另一個重點是濾波器的增
益部分，因為從 PGC 解調的最前端開始，使用 Bessel 函數展開後進行訊號處理。
所以當頻帶內增益不相等時，會造成訊號變大或變小造成重大失真。因此在設計
低通濾波器上要注意低頻增益部分要相等。在帶通濾波器部分用於分開解調感應
訊號與 10KHz 的補償觸發訊號，而頻帶內增益一樣要相等。 
 
（c）積分器 
    一般積分器在短時間內積分後，因為低頻訊號或者積分累加了訊號與前級所
產生的 offset，所以當系統經過一段時間後會造成積分器飽和。使用半積分器可
以等效於一個反相放大器與一個米勒積分器，對低頻訊號來說相當於是一個放大
器，因此不會因訊號 offset 後造成訊號飽和。當系統開始執行後，積分器經過一
段時間後會造成系統飽和而無法偵測訊號，所以可以使用一控制訊號對積分器進
行重置，或者使用半積分器取代可以確保系統不會飽和，如圖十二。 
         
(a)                                 （b） 
圖十二 (a) 使用半積分器 PGC 解調訊號 (b) 使用全積分器 PGC 解調訊號 
（2）  Xilinx®  support DSP 元件驗證 
    承接模擬測試部分，使用實際外部訊號進行測試。如同模擬測試一樣，系統
可分為三大部分 ADC、System clock synchronization、及 PGC 解調，如圖十三。 
第一個部分為 ADC 部分為類比數位轉換，經過數位化的訊號後傳輸到 FPGA 進
行數位化處理；第二個部分為 System clock synchronization ，作為連接不同的系
統，如微處理器使用。本實驗系統中的同步時脈統一由 FPGA 控制，同時此部分
也負責 ADC 與 DAC 的同步輸出控制。第三個部分為 FPGA-PGC 系統，共分為
五個部分。 
  16 
 
圖十五 低通濾波器頻率響應曲線。 
 
(c) 微分器 
    根據微分特性將訊號微分後，輸出訊號與輸入訊號有 90 度的相位差，因此
以外部訊號弦波做測試，確認輸出訊號是否符合此特性。高頻訊號也需要觀察其
微分後輸出訊號是否飽和。在設計數位系統時，設定 6KHz 1rad 模擬訊號峰對峰
值為 0.5V，限制訊號使其不飽和。 
  
(d) 實質乘法器 
    高頻訊號經過實質實乘法器相乘後，需要確定相乘後訊號不飽和圖十六。因
此使用固定弦波訊號當做測試源，經過 chipscope 觀察輸入及輸出訊號。 
 
圖十六 實質乘法器。Sine signal 為模擬訊號， Real-Multiplier output signal 為實
質乘法器輸出訊號。 
 
(e) 積分器 
    根據積分特性，低頻訊號積分後會使積分器飽和，造成訊號無法解調，因此
在 FPGA 系統中使用半積分器，來確保系統不受低頻訊號與 DC 的影響。 
 
（3）干涉訊號解調 
    驗證完 Xilinx®  support DSP 元件後，使用雷射配合 ΔL 干涉儀，以雷射電流
調變複合產生 2.37 rad 97.65625 KHz 載波相位訊號。由光接收器輸出的干涉訊
號。將干涉訊號輸入 FPGA 系統進行 PGC 解調，將干涉儀感應訊號解調輸出。 
  18 
訊號，解調訊號及再經過低通濾波器及帶通濾波器，如圖十九。低通濾波器輸出
的為 2KHz 訊號 
 
圖十九 Xilinx®  support DSP 模擬解調訊號 
 
（4）  數位解調自動補償技術 
    
(a) 數位相位延遲補償技術 
    根據一、二倍頻的數位調整流程設計，模擬每 31 次位移後累積一次，補償
調整完後計數器總共會有四個輸出累積數字，分別為數字 0、1、2 以及數字 3。
數字 0 為二倍頻第一次調整；數字 1 為二倍頻第二次調整，調整完後並固定二倍
頻最大位移次數；數字 2 為一倍頻調整；數字 3 為固定一倍頻最大位移次數。 
    載波訊號在系統光纖中傳輸，因為在特定長度下會使解調訊號變得極小，因
此需要進行相位補償。假設在調整一倍頻補償過程中，固定的二倍頻訊號剛好極
小，相同會造成解調訊號極小。因此在進行二倍頻調整時需要進行兩次的補償，
藉由兩次的調整找到最大相位，以確保二倍頻的相位最大。在進行模擬時第一次
調整的最大解調振幅值為 0.16，第二次調整的最大解調振幅值為 0.041，因此選
擇第一次調整的最大相位位移值，如圖二十。 
    固定二倍頻訊號相位後，進行一倍頻的相位調整。相同的經過 31 次位移的
調整，找到解調訊號最大解調振幅。在模擬一倍頻調整時，最大解調振幅值為
0.192，如圖二十一。一倍頻以及二倍頻載波相位調整時，每次位移調整的過程
中解調振幅值不斷在變化，因此藉由調整一、二倍頻最大相位來取得 PGC 解調
訊號最大解調訊號。 
 
  20 
 
圖二十二 光訊號未受損耗的干涉訊號波形。 
 
圖二十三 光訊號受到損耗及歸一化的干涉訊號波形。 
 
（四）全數位化訊號處理在感測系統上的應用及結論 
     本研究以場效可程式邏輯閘陣列（FPGA， Field Programmable Gate Array）
作為干涉式感測器數位化 PGC 解調的平台，藉由數位化的過程使訊號解調達到
更能快速效果。在實驗過程中以類比 PGC 解調程序做為標準參考模型，使用
Matlab Simulink 及 Xilinx®  support DSP 完成模擬以及取代類比元件，建立數位
化 PGC 解調系統。在 PGC 解調過程中需要高頻載波訊號，此部分使用 ADuC841
微控制器經撰寫 Keil C 程式語言來控制類比訊號 IC。透過 AD7625 類比數位轉
換器將干涉訊號轉換成數位訊號經輸出/輸入介面進入 FPGA 數位解調系統。 
    設計過程中將實值乘法器以等效乘法器的方式取代，使訊號在系統中更能快
速運算。在系統中設計三個不同的濾波器，低通濾波器負責濾除高頻載波以及將
解調訊號(2KHz 及 10KHz)過濾出 2KHz 訊號，而帶通濾波器則使 10KHz 通過。
其中濾波器的增益在通帶內需相同，因此解調訊號才不會造成嚴重失真變形。在
積分器上則應避免訊號飽和的情況發生。 
  22 
 傳統上消除雜訊會先定出平均時間（例如 3.2 秒，每 100ms 得到一個感應
訊號值，共有 32 個訊號值），採取漸進漸出方式作平均，並在平均時間內，合
理保留有可能是闖入者之相對較大之感應訊號值不列入平均，目的為有效的扣除
雜訊形成的波包外型，但由闖入者引起的感應訊號值不會被扣除，因而提高訊號
雜訊比。但傳統的感應雜訊平均時間若取 3.2 秒，對於大風等瞬間引起的大的環
境雜訊，基本上會留下剛開始連續 3.2 秒不能有效消除的雜訊，容易引起誤報。
新型的數位訊號處理系統，具有連續儲存多筆感應訊號值之功能，因此可發展智
慧型雜訊消除技術，運用儲存之前及之後的感應訊號值來做最適當的雜訊扣除。
此技術會造成一些訊號處理延遲（但必須在評估後為可接受的範圍之內），因此
稱其為延遲平衡雜訊消除技術，但可預期對於大風等瞬間引起的大的環境雜訊，
能有效的消除雜訊，進而提高訊號雜訊比降低誤報率。 
背景感應雜訊平均時間若取 3.2 秒，實際扣除的為其之前 1.6 秒和之後 1.6 秒
間共 3.2 秒的平均雜訊。延遲平衡雜訊消除技術在平均時間內合理保留有可能是
闖入者之相對較大之訊號不列入平均，如前所述，假設闖入者引起的感應訊號平
均持續時間為 1.7 秒，則可選取大小排在第 18、19 及 20 大的感應訊號值平均後
做為瞬間的雜訊扣除值。此背景雜訊之扣除邏輯選擇在「闖入者可能引起的感應
訊號比例」外較高計數值，目的為有效的扣除雜訊形成的波包外型，但闖入者引
起的感應訊號計數值不會被拿來做平均雜訊扣除。 
雜訊扣除的目的在於有效增加訊號雜訊比（S/N），其基本原理為訊號和雜
訊在前面所述的雜訊扣除邏輯中有不同的特性存在。由大風大雨所引起的感應雜
訊，從常識上直覺判斷為一連串連續分佈的訊號，因此有明顯的雜訊波包，使用
延遲平衡雜訊消除技術可有效降低 N 值。由闖入者引起的感應訊號，偏向於有
明顯間斷分佈的訊號型態，因此無明顯的雜訊波包，便可避免扣除闖入者引起的
感應訊號，而保留住較大的 S。因此基本的處理原則是以 S 為主，由 S 決定擬保
留之大訊號比例值為平均時間內最大之幾%，經過雜訊扣除後新的 S/N 比，即是
合理的 S/N 比值。 
  
（三）實驗與結果 
 本實驗使用計數式訊號處理技術作訊號處理，背景感應雜訊平均時間都取
3.2 秒，同時分別以傳統的雜訊消除技術及延遲平衡雜訊消除技術作訊號處理，
也都選取大小排在第 18、19及20大的感應訊號值平均後做為瞬間的雜訊扣除值。 
 
（1）實驗一 
第一個實驗是將感應光纖佈放在一個廠區的圍籬上，使用計數式訊號處
理系統每 100ms 得到一個感應訊號計數值。圖一為有強風吹過時的原始感應訊
號，圖二為強風吹過時的感應訊號使用傳統雜訊消除技術處理後的結果，圖三為
強風吹過時的感應訊號使用延遲平衡雜訊消除技術處理後的結果。比較圖二和圖
三的結果可看出使用延遲平衡雜訊消除技術處理後，由強風引起的殘留雜訊波包
  24 
 
 
 
圖四為有闖入者時的原始感應訊號。 
 
 
圖五為有闖入者時的感應訊號使用傳統雜訊消除技術處理後的結果。 
 
 
圖六有闖入者時的感應訊號使用延遲平衡雜訊消除技術處理後的結果。 
 
 
（2）實驗二 
  26 
 
圖九為有火車經過時的感應訊號使用延遲平衡雜訊消除技術處理後的結果。 
 
（四）結論 
根據訊號處理理論及實驗結果，可歸納出有關延遲平衡雜訊消除技術和傳
統雜訊消除技術比較如下： 
（1） 對於闖入者引起的訊號及緩慢環境變化引起的雜訊，在同樣設定下延遲平
衡雜訊消除技術可獲得較佳的處理結果，但差異較不明顯。 
（2）對於急速環境變化引起的雜訊，在同樣設定下使用延遲平衡雜訊消除技術
可獲得極佳的處理結果，使用傳統雜訊消除技術殘留雜訊波包將極為明
顯，兩種雜訊消除技術差異極為明顯。 
 
 
 
四、參考文獻 
[1] A. D. Kersey, “Recent progress in interferometric fiber sensor technology,” Fiber 
Optic and Laser Sensors VIII, Ramon P. Depaula, Eric Udd, Editors, Proc. SPIE 
1367, pp. 2-12, 1990. 
[2] A. Dandridge, A. B. Tveten, and T. G. Giallorenzi, “Homodyne demodulation 
scheme for fiber optic sensors using phase generated carrier,” IEEE J. Quantum 
Electron., Vol. QE-18, pp. 1647-1653,1982. 
[3] Shih-Chu Huang and Hermann Lin, “The counting signal processing and counting 
level normalization techniques of polarization insensitive fiber optic Michelson 
interferometric sensors,” Applied Optics, Vol. 45, Issue 35, pp. 8832-8838, 2006.
（國科會計畫研發成果，計畫編號 NSC 93-2215-E-017 -002 -） 
[4] 黃世巨、林鴻銘、蔡伶郁、張毓筠、黃裕峰, “測量雙臂式光纖干涉儀的干涉
臂長度差的理論及技術,” 2006 台灣光電科技研討會暨國科會光電學門成果發
  28 
[16] A. D. Kersey, M. J. Marrone, and M. A. Davis,“Polarisation insensitive fibre 
optic Michelson interferometer,”Electron. Lett., Vol. 27, pp. 518-520, 1991. 
[17] Shih-Chu Huang, Wuu-Wen Lin, and Mao-Hsiung Chen, “Phase sensitivity 
normalization in time-division multiplexing of polarization-insensitive 
interferometric sensors using phase-generated carrier demodulation,” Optical 
Engineering, Vol. 35, pp.2634-2640, 1996. 
[18] Jun He, Lin Wang, Fang Li and Yuliang Liu, “An ameliorated phase generated 
carrier demodulation algorithm with low harmonic distortion and high stability,” J. 
Lightwave Technol. Vol. 28, No. 22, pp. 3258-3265, 2010. 
[19] Shih-Chu Huang, Yuh-Fung Huang,  Fuh-Hsin Hwang, 
Guan-Wen  Huang,  Shi-Ming  Zhou, “Sensitivity normalization of pgc 
demodulation using laser modulation to generate carrier signal,” International 
Photonics Conference 2011 (IPC2011) , 8-10 December 2011 at National Cheng 
Kung University, Tainan, Taiwan. （國科會計畫研發成果，計畫編號 NSC 
99-2221-E-017 -014 -） 
[20] Shih-Chu Huang, Yuh-Fung Huang, and Zhen-Zhang Wu, “Sensitivity 
normalization technique of PGC demodulation with low harmonic distortion and 
high stability using laser modulation to generate carrier signal,” Sensors and 
Actuators A 174, pp. 198– 206, 2012. （註：SCI,國科會計畫編號 NSC 
100-2221-E-017 -008 -） 
 
 
 
 
 
 
 
 
 
 
 
  30 
3.  請依學術成就、技術創新、社會影響等方面，評估研究
成果之學術或應用價值（簡要敘述成果所代表之意義、
價值、影響或進一步發展之可能性） 
 
一、學術成就 
    PGC 解調需先產生高頻載波相位訊號，在許多應用上必須使用半導體雷射電
流調變來產生，但對雷射作電流調變將會同時產生光強度調變。光強度調變對 PGC
解調會引起非線性解調項，造成 PGC 解調輸出的不穩定及失真。本研究首先提出
相位擾頻器理論，能有效改善 PGC 解調輸出不穩定及失真。另外在實際環境中使
用的光纖感測系統，有許多因素會使干涉訊號振幅變小，因此須做靈敏度補償，
本文提出使用雷射調變產生低頻相位訊號，確保在低頻訊號週期內能產生干涉訊
號之極大和極小值，以正確計算干涉訊號振幅及作為補償之依據。此外更進一步
推導低頻相位訊號具有 rad405.2 之振幅時（符合 0)405.2(0 J 之條件），可產生最
佳的相位擾頻器功能，同時也能符合 PGC 解調輸出靈敏度歸一化之要求。靈敏度
歸一化的實驗結果顯示加 10Hz 振幅為 rad405.2 的低頻相位訊號，對光強度衰減
範圍在 30 倍以內時，解調輸出的模擬感應相位訊號振幅變化誤差都在 0.6%以內，
顯示本文所提出的靈敏度歸一化技術，效果十分良好。本研究所提出的靈敏度歸
一化技術，對於一些長距離或許多室外的偵測應用上，光纖感應器必須為全光纖
結構的感測系統，極具有實用價值。本研究成果已發表在 Sensors and Actuators A
（A 174, pp. 198– 206, 2012.），也已提出「使用雷射調變產生載波訊號之 PGC 解調
系統的靈敏度歸一化方法」中華民國專利申請。 
   
二、技術創新 
    本研究使用 FPGA 作 PGC 解調的全數位化訊號處理，以 Simulink 及 Xilinx®  
DSP 完成模擬及取代類比元件，建立數位化 PGC 解調系統。提出將實值乘法器以
等效乘法器方式取代的數位化 PGC 解調新技術，具有精簡、快速及準確的優點。
同時利用數位訊號處理做光纖延遲及靈敏度歸一化補償，全部整合在數位系統中。
最具發展潛力的是 FPGA 結合微處理器，可直接作感測系統所需的訊號處理，使
感測系統大為簡化及具有實用性。因此作 PGC 解調的全數位化訊號處理後，藉由
後續數位訊號處理，可完成不同功能的干涉式光纖感測系統。另外本研究也提出智
慧型消除雜訊的新技術，對於急速環境變化引起的雜訊，可獲得極佳的處理結果，
使用在安全偵測系統上，可明顯提升偵測率及降低誤報率。 
 
三、社會影響 
隨著社會發展及治安事件難以斷絕，在住宅社區及重要廠區等，設置可靠的
全天候室外安全偵測系統將日益重要。另外因地球氣候暖化，暴雨一再創新紀錄
造成嚴重土石流，研發功能佳成本低的土石流監測系統便相對重要。本研究所
提出的全光纖結構PGC解調感測系統、全數位化訊號處理及智慧型消除雜訊技
術，應用於上述各感測系統將可明顯改善其功能，使其更具實用性。  
國科會補助計畫衍生研發成果推廣資料表
日期:2012/09/19
國科會補助計畫
計畫名稱: 干涉式光纖感應器新技術的研發及應用(II)
計畫主持人: 黃世巨
計畫編號: 100-2221-E-017-008- 學門領域: 光纖通訊與波導光學
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
