印刷電路板(PCB)生產規劃決策支援系統之開發-子計畫一： 
印刷電路板生產需求預測系統開發 
計畫編號：NSC94-2213-E-155-003-1 
執行期限：94 年 8月 1 日至 95 年 7 月 31 日 
主持人：張百棧  元智大學工業工程與管理學系（所） 
計畫參與人員：劉鎮豪、陳世興、樊晉源、宋安勝  元智大學工業工
程與管理學系（所） 
摘要 
 
印刷電路板產業為我國每年帶來可觀的經濟貢獻，業者不斷的擴充產能，卻
比不上需求的快速變化，造成供給與需求失衡，普遍存在庫存堆積與待料問題。
本三年期計畫即希望透過一系列生產預測模型之預測，提供未來需求趨勢，進而
使後續物料準備與生產排程工作順利銜接；減少庫存成本與停工的損失。本研究
計畫將預測模式依照發展順序，分為三大類型介紹如下，首先第一年運用 GANN
發展預測模式，期望運用類神經網路及基因演算法之整合，對整個印刷電路板生
產作一完善之預測，第二年則是加入 Fuzzy Rule Base 的觀念，期望藉由模糊規則
及倒傳遞類神經網路的幫助，找出較為關鍵的重要指標，提升 GANN 的預測效果。
第三年則是在前兩年架構基礎之下，建構一加權式模糊演化網路，將原本之倒傳
遞模糊模式進行適當之改善，運用權重的觀念改善其效果。透過此一系列預測模
式之發展與運作，將可以有效提升預測模式之效能，其誤差將可控制在 1%之內。 
 
1.  計畫動機與目的 
印刷電路板(Printed Circuit Board；PCB)是電子產業的重要零組件，肩負著連
結各種電子零件的任務，故常受到電子產業景氣循環而隨之變動。在 1990 年代末
期由於資料處理與無線通信的加速成長，使得網路設備與行動電話的需求產生驚
人的變化。在此同時個人電腦的需求仍然持續強勁，而伺服器、工作站以及資料
儲存設備的需求也一樣明顯，正是印刷電路板產業風光時期。 
然而，整體電子產業在 2001 年至 2002 年間的萎縮，用於資料處理與通信需
求的印刷電路板應用快速而大量的消失，更進一步的減低了印刷電路板在其他領
域的消耗量，導致了全球印刷電路板的供需嚴重失衡。台灣是全球重要且龐大的
印刷電路板生產地區之一，當然不能倖免於這次的衰退影響。 
電子產業的成長與印刷電路板產業具有連動性，因此電子產業可以帶動印刷
電路板產業的擴張。但因為成本的壓力、生產地的遷移與生產技術的變動趨緩，
使得印刷電路板在產品中的價值比率逐漸壓縮，因此對於印刷電路板產業的獲利
產生負面的影響。審視過去的印刷電路板產值與生產面積的訊息，可以明確的看
出從 2000 年 2003 年間印刷電路板的市場產值滑落了 18.6%，但是生產面積卻成長
了 14.4%，因此，國內相關業者因利潤降低而面臨到決擇的命運，許多較小型的印
刷電路板廠商紛紛的前進大陸或歇業，較大型的業者也在面臨著挑戰。 
面對著市場的爭奪戰，業者必須仰賴著可靠訊息以提供決策時的依據，其中
「需求預測」是業界視為一個關鍵的訊息指標。合理可靠的預測可以提前知道訂
單需求數量、提早準備物料需求與進行產能規畫、縮短流程時間與滿足交期，這
2.1 預測方法之演進 
依照洪國智[48] 分析，傳統預測方法主要分為定性分析(Qualitative)和定量分
析(Quantitative)兩種方法，定性分析法運用較為主觀的因子，如專家的經驗、判斷
和意見。此類預測方法較著名的有德爾菲法(Delphi Technique)、主管意見法(Jury of 
Executive Opinion)、歷史類推法(Historical Analogy)等。而定量分析的預測方法主
要是以統計與迴歸分析為基礎進行衍生的。一般傳統分析方法雖然有其一定的準
確度，但是面對突發事件，亦或是探討變數間交互關係時，甚至是變數較多的複
雜性問題時，其預測效果就較差，[23]，Luxhøj[28]在其着作中，都對此一方面頗
有著墨，那如何改善傳統預測方法不足之處?劉瑞鑫[59]認為新興的人工智慧模型
由於具有較大的彈性、可估計非線性關係，不若傳統的時間序列模型有較多的假
設與限制。因此許多的學者開始傾向發展人工智慧型的預測方法來解決這些問
題。這一方面的方法包括類神經網路、基因演算法、模糊理論、案例式推理等一
系列的軟性計算法則，近代多位學者相信，藉由這一系列新式方法之幫助，將可
大幅降低求解時間，並可以增進傳統預測方法缺乏之能力。本節將再下列小節中，
針對類神經網路、基因演算法、模糊理論作一簡單支敘述。 
2.2類神經網路 
類神經網路(Artificial Neural Network)為一種計算系統，是指模仿生物神
經網路的資訊處理系統，而其精確的定義為：「類神經網路是一種計算系統，包括
軟體與硬體，它使用大量簡單的相連人工神經元來模仿生物神經網路的能力。」
[56] 
類神經網路依其演算法可分為三大類[56]： 
1、監督式學習網路(Supervised Learning Network) 
從問題中取得訓練範例(有輸入變數值，也有輸出變數值)，從中學習輸入變
數與輸出變數的內在對應規則，以應用於新的範例(只要有輸入變數值，需推論輸
出變數值的應用)。例如：倒傳遞類神經網路(BPN)。 
2、非監式學習網路(Unsupervised Learning Network) 
從問題領域中取得訓練範例(只有輸入值)，並從中學習範例內在集群規則，
以應用於新的範例(有輸入變數值，需推論它與那些訓練範例屬於同一隻群的應
用)。例如：自我組織映射網路(SOM)。 
3、混合式學習網路(Hybird Learning Network) 
基本上，此模式是結合監督式與非監督式學習網路。網路中的輸入層與隱藏層
間使用非監督式學習，網路中的隱藏層與輸出層間則使用監督式學習。監督式學
習網路的應用是現今類神經網路中最重要，也是目前最成功的應用，約佔 95%以
上，且已應用在許多企業中，包括汽車引擎診斷、製程控制(Process Control)、
礦床探測訊號分析、股價預測等。在監督式學習網路中，又以倒傳遞網路的應用
最多，Shan M.S.[34]、Luxhoj etc.,[28] Quah and Srinivasan[32] 等學者，將 BPN 運
用於包含電力預測、股價趨勢、消費趨勢等不同狀況，均達到不錯之預測效果。 
 
 
 
  
圖 2-1、模糊類神經網路架構圖[20] 
模糊理論結合類神經網路的軟性計算(Soft Computing)演算法目前應用在許
多不同的領域中，如：工業環境的控制系統、加工參數最佳化、半導體機器產能
預測；而商業環境的預測、財政分析、股價指數漲跌預測、消費性貸款、銀行授
信決策及醫療疾病診斷、電力需求預測…等。模糊類神經網路運用於預測方面相
關文獻眾多，Dash 等[10]將此一方法應用於電量的預測上。Chen[9]將模糊倒傳遞
網路應用於晶圓產出時間的預測問題。Kuo [23]發展一模糊演算法為基礎之模糊類
神經網路預測模式用於當企業有突發的促銷狀況時之預測工作。實證結果顯示，
經過模糊化之類神經網路之預測結果均較其他比較績效指標效果優異。結合了類
神經模糊的預測系統可說是本研究計畫第二年預測系統之重心。 
2.6 案例式推理 
案例式推理(Case-Based Reasoning)的發展起源於 1982 年 Roger Schank[33]
提出的動態記憶(Dynamic Memory)，利用記憶資料庫(Memory-based)的方法推理。
如同人類處理事情的經驗，經由記憶、認知、經驗與學習，累積過去的經驗知識，
當遇到問題時可以從過去的經驗知識中擷取相似的案例來解決現在所發生的問
題，而其它學者對案例式推導的解釋如下表所示： 
表 2-2、學者對案例式推理之解釋 
學 者 案例式推理的解釋 
Aamodt&Plaza[1] 藉由回憶先前相似的情境，以可利用的資訊和知識來解決新問題。 
Leake[24] 案例式推理的發展動機主要為模擬人類學習推理的邏輯方式，以及提昇人工智慧系統運作的效率。 
Smyth[35] 案例式推理能利用過去相似問題個案累積的經驗中推導出相關知識，以重複應用於新問題上。 
及工業生產構面，而關於各變數間所包含之詳細項參考圖3-1，本研究整理如下： 
  
圖 3-1 印刷電路板需求預測因子四大構面 
 
3.1.1 時間序列構面： 
時間序列因子主要考量金像電子於 1999 年 1 月到 2003 年 12 月間每月實際銷
售資料，印刷電路板產業不同於一般製造業，主要以月銷售金額與總生產面積來
衡量需求狀況，銷售金額的多寡容易受波動，故本研究只針對每月之總生產面積
數量進行需求預測。 
3.1.2 總體經濟構面： 
在總體經濟指標中，包含了國民生產毛額、景氣對策信號、消費者物價指數、
躉售物價指數、工業生產變數、外銷訂單、失業率、進出口貿易值…等，但考量
到與 PCB 需求的相關性，本研究只考量五項因子，分別為國民生產毛額、失業率、
消費者物價指數、進口和出口貿易值。 
3.1.3 下游產品需求構面： 
印刷電路板常用於電子零件裝載的機板，舉凡一般消費性電子產品，資訊、
通訊、醫療，甚至航太科技產品都需要使用印刷電路板作為安裝與互連時的主要
支撐，是所有電子產品不可或缺的主要基礎零件。在本研究計畫中，考量 IEK 之
「台灣資訊硬體產業十大主流產品排名：1996-2004」報告，選取其中最為重要的
五項產品，作為其預測需求構面分別為監視器(Monitor)、筆記型電腦(Notebook 
PC，NB)、桌上型電腦(Desktop PC，DT)、主機板(Motherboard，MB)、及液晶顯
示器(LCD Monitor)，並以這四類產品的銷售情況做為代表項目。 
1、平均絕對百分比誤差(Mean Absolute Percentage Error ：MAPE) 
t
tt
n
t A
AF
n
MAPE
||1
1
−= ∑
=
                          (3-1) 
其中，Ft：第 t 期的預測值、At：第 t 期的實際值、n：期數。當 MAPE 值愈小時，
表示預測能力愈佳。 
2、平均絕對偏差(Mean Absolute Deviation：MAD) 
||1
1
tt
n
t
AF
n
MAD −= ∑
=
                         (3-2) 
其中，Ft：第 t 期的預測值、At：第 t 期的實際值、n：期數。 
3、誤差均方根差(Squared Root of Mean Squared Error：RMSE) 
n
AF
RMSE
tt
n
t
2
1
)( −∑
= =                         (3-3) 
其中，Ft：第 t 期的預測值、At：第 t 期的實際值、n：期數。 
4、總成本差(Total Cost Deviation：TCD) 
)*|(|1
1 t
t
tt
n
t A
S
AF
n
TCD −= ∑
=
                    (3-4) 
其中，Ft：第 t 期的預測值、At：第 t 期的實際值、n：期數、 tS ：第 t 期印刷電路
板之實際銷售金額 、
t
t
A
S ：第 t 期印刷電路板之單位成本。 
在本研究中，將上述的四項預測衡量指標來評斷本研究所提出的預測模式與
其他方法之比較，一般而言，使用 MAD 或 RMSE 是目前比較常用的預測方法的
衡量，MAD 與 RMSE 較小，代表預測方法精確性較高，反之則精確性較差。倘若
MAD 與 RMSE 所呈現的結果不同時，可優先考量 RMSE 較小的預測方法較佳。
本研究將會於第五章運用衡量指標將前三年之研究計畫進行比較。 
 
 
 
圖 4-1 研究流程圖 
表 4-2、灰關聯分析篩選因子後之資料整理 
資料筆數 1 2 3 … P 
構面一 D1*1 D1*2 D1*3 … D1*P 
構面二 D2*1 D2*2 D2*3 … D2*P 
#  #  #  #   #  
構面 M DM*1 DM*2 DM*3 … DM*P 
實際值 1A  2A  3A  … PA  
步驟三、加入時間序列因子 
在時間序列因子中，本研究將用溫氏指數平滑法對於下一期需求量進行初步
的預測，並將此預測值做為一項網路輸入因子。 
溫氏指數平滑法的做法如同 4.2 節方法所示，先利用試誤法來設定 α、β、γ 等
穩定平滑參數、季節平滑參數與趨勢平滑參數設定的較佳組合，再將此組合代入
公式中，而季節因子長度 L 則設定為每次季節循環的長度，本研究的季節因子長
度設為 12 個月。因此，經過時間序列因子的輸入後，表 4-2 可轉為表 4-3，如下表
所示 
表 4-3、加入時間序列因子的資料整理 
資料筆數 1 2 3 … P 
構面一 D1*1 D1*2 D1*3 … D1*P 
構面二 D2*1 D2*2 D2*3 … D2*P 
#  #  #  #   #  
構面 M DM*1 DM*2 DM*3 … DM*P 
時間序列 F1 F2 F3 … FP 
實際值 1A  2A  3A  … PA  
步驟四、資料數值正規化 
經過上述資料整理後，即可代入神經網路計算，但本研究採用加權演化式模
糊神經網路，在進行模糊化前須先經過正規化，以避免連續變數因值域範圍過大，
而影響到加權演化式模糊神經網路的計算，正規化的方法如公式所示。 
minmax
min
, XX
XX
normali
iX −
−=  (4-1)
4.2、神經網路訓練階段 
在神經網路訓練階段中，將採用加權演化式模糊神經網路(WEFuNN)進行訓
練，透過加權方法能更清礎粹取輸入因子不同的差異程度，經訓練完後會產生模
糊規則庫與連接權重值，以提供回想階段使用。加權演化式模糊類神經網路的架
構圖如圖 4-2 所示。 
xµ~
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
≥
<≤−
−
<≤−
−
<
=
cx
cxb
bc
xc
bxa
ab
ax
ax
,0
,
,
,0
 (4-2)
其中， xµ~ 代表 x 之隸屬函數 。 
本研究之各構面輸入因子會依其因子特性來決定自我式調整模糊區間，其詳
細資料如表 4-4 所示，以「時間序列構面」的隸屬函數為例，其模糊隸屬函數如圖
4-4 所示，其他構面之圖形亦與此相似。 
 
圖 4-4、自我式調整模糊區間隸屬函數圖 
表 4-4、加權演化式模糊類神經網路模型變數表 
變數名稱 變數型態 術語名稱與區間個數 
時間序列構面 輸入變數 自我式調整模糊區間 
工業生產構面 輸入變數 自我式調整模糊區間 
下游產品需求構面 輸入變數 自我式調整模糊區間 
總體經濟構面 輸入變數 自我式調整模糊區間 
生產數量 輸出變數 自我式調整模糊區間 
 
EXi,,j,k = inputkji ,,
~µ    for  k = 1,2,3,…,m (4-3) 
kTE ,1  = 
output
ki,
~µ    for  k=1,2,3,...,m (4-4) 
 
步驟二、初始參數設定 
1、初始假設：系統裡一開始沒有模糊規則，是由第 1 筆資料所產生。 
2、建立第一條模糊規則： 
W1(1) = EX1,j,k (4-5)
第四層：模糊輸出層 
5、計算輸出轉換函數 
假如 piA ,1 > S ，則模糊輸出值的計算公式如(4-10)所示 
)12(2 ,, pipi AWSatlinA ×=   (4-10)
 
圖 4-6、線性轉換函數 
6、計算誤差值 
|2| , inii yAErr −=  (4-11)
假如 Erri < Ethr ，則計算明確輸出值； 
否則 創造一個新的模糊規則，並計算該模糊規則的連接權重值，公式為(4-7)、
(4-8)。 
第五層、實際值輸出層： 
Oi = W3 × piA ,2    (4-12)
步驟三、權重更新： 
1、每一筆資料經過步驟二的計算後，需更新連接權重值 W1 與 W2，其公式如下： 
dist=[ kjiEX ,, -W1(p)] (4-13)
distpWpW oldnew ×+= 1)(1)(1 α  (4-14)
)1()()(2)(2 ,2 pioldnew AErrpWpW ××+= α  (4-15)
將相似的模糊規則進行合併，並進行合併後的權重更新，當模糊規則一直在
演化時，其權重就會隨著新合併的模糊規則而進行權重更新，圖 4-7 為 4 筆資料在
透過演化過程而進行權重的更新。 
表 4-5、加權演化式模糊類神經網路模型之符號定義 
符號 符號定義 
input
kji ,,
~µ  ：為第 i 筆資料第 j 個輸入因子第 k 個區間之模糊隸屬函數。 
output
ki,
~µ  ：為第 i 筆資料第 k 個區間之輸出值模糊隸屬函數。 
kjEX ,,1  ：為第 1 筆資料第 j 個輸入因子第 k 個區間的模糊隸屬函數。 
kTE ,1  ：為第 1 筆資料第 k 個區間之輸出值模糊隸屬函數。 
W1(1) ：第 1 條模糊規則之第二層與第三層的連接權重值。 
W2(1) ：第 1 條模糊規則之第三層與第四層的連接權重值。 
piD ,  ：第 i 輸入資料與第 n 條模糊規則之距離。 
jw  ：第 j 個輸入因子之權重。 
W1(p) ：現有第 p 條模糊規則之第二層與第三層的連接權重值。 
piA ,  ：第 i 筆資料與第 p 條模糊規則之相似值。 
piA ,1  ：第 i 筆資料與第 p 個模糊規則之第三層的作用函數。 
S ：相似度門檻值。 
Satlin ：為類神經網路輸出層的線性轉換函數。 
yi ：第 i 筆資料之模糊化實際需求數量。 
niA ,2  ：第 i 筆資料對應到第 p 條模糊規則之模糊輸出值。 
Erri ：為第 i 筆資料預測結果與實際需求數量之誤差值。 
Ethr ：為誤差容許門檻值。 
Oi ：第 i 筆資料之解模糊化的明確預測需求數量。 
W3 ：第 i 筆資料之第四層連接第五層的連接權重值。 
dist ：第 i 筆資料之距離。 
1α  ：W1 權重的學習率。 
2α  ：W2 權重的學習率。 
5. 實驗結果與分析 
在本章中，將利用第四章中所提出之加權演化式模糊類神經網路模型
(WEFuNN)來建構印刷電路板需求預測，並探討此模型最適參數的設計。此外，亦
將此模型與第二年計畫發展之演化式模糊類神經網路(EFuNN)、第一年計畫發展
之基因神經網路模型[54]進行各種預測結果之績效衡量，期望找出各種模型間的
優缺點。透過不同模型間的相互比較與實證分析，提出最適合印刷電路板產業之
生產預測模型，而這也是本研究計畫所欲達到之目標。 
在實驗過程中，各模式之建立均用 Borland C++ Builder 5.0 程式語言所撰
寫，倒傳遞網路將則利用 Neural Work Professional Ⅱ Plus 建構，所有實驗
環境將在 Pentium Ⅳ 2.4G，256RAM 之環境中進行實驗。 
接下來將就上一章節詳述的研究流程分成以下小節來加以描述實驗結果，分
別為灰關聯分析、溫氏指數平滑法、加權演化式模糊類神經網路學習與參數設
計，並與其它預測模型之效果評比，另外，由於各方法之求解時間甚短，故不列
述。 
5.1 灰關聯分析 
本研究計畫收集與印刷電路板需求預測相關指標共三大構面 15 項因子，為
減少因子數目以增進加權演化式模糊類神經網路之學習效率，本研究利用灰關聯
分析計算每種構面中每一因子對於每月印刷電路板生產數量的關聯度，並選取出
各構面中關聯度最高之因子做為加權演化式模糊類神經網路的輸入因子。各構面
的各項因子與該因子之灰關聯度列述如表 5-1 所示。 
在計算每個因子的灰關聯度時，「失業率」的正規化採用望小法，此外的因
子之正規化方式皆採用望大法；而每個因子的灰關聯度分辨係數ζ皆設為 0.5。 
 
 
 
 
 
 
 
 
 
 
 
 
表 5-2、溫氏指數平滑法預測值與實際值之比較 
 
其中， iF 代表第 i月份的預測值； iA 代表第 i月份的實際值； iM ape 代表第
i月份之預測值與實際值之誤差百分比。溫氏指數平滑法最大的特色在於當資料
具有季節性因子與趨勢性因子存在時，預測上會有不錯的準確度。由表 5-2 顯
示，溫氏指數平滑法的測試樣本 MPAE 為 9.17%，標準差為 11.42%，當 MAPE 小於
10%時，代表該方法已具有準確預測能力，因此，本研究將溫氏指數平滑法求得
之預測值代入加權演化式模糊類神經網路中，可以充份的將季節性因子與趨勢性
因子做為網路學習的指標，使網路學習之考量範圍更加完備。 
 訓練樣本 測試樣本 
月 1999 2000 2001 2002 2003 
i iF  iA  iMape  iF  iA iMape iF iA iMape iF iA iMape  iF  iA
iMape
 
1 543675 553678 1.81% 859530 937904 8.36% 590234 420119 40.49% 626008 601675 4.04% 649700 649066 0.10%
2 491465 515985 4.75% 405435 437582 7.35% 549685 558776 1.63% 516689 494645 4.46% 465219 466750 0.33%
3 714565 748610 4.55% 589368 620259 4.98% 688075 687149 0.13% 682209 666988 2.28% 623542 633615 1.59%
4 642222 678307 5.32% 665465 709506 6.21% 444248 422863 5.06% 723786 720610 0.44% 681530 693946 1.79%
5 638685 678763 5.90% 795875 842393 5.52% 498017 492605 1.10% 798539 772659 3.35% 783733 785838 0.27%
6 741159 793636 6.61% 891553 926282 3.75% 594095 613800 3.21% 711118 654890 8.59% 693935 679312 2.15%
7 779432 834252 6.57% 1003783 1029183 2.47% 480354 519449 7.53% 799637 740697 7.96% 753675 723914 4.11%
8 738308 793293 6.93% 996677 1005137 0.84% 697069 779520 10.58% 837546 759466 10.28% 800210 757490 5.64%
9 549289 613227 10.43% 884111 874773 1.07% 500890 595869 15.94% 372758 298746 24.77% 949143 836846 13.42%
10 723844 797339 9.22% 1089077 1057271 3.01% 601759 711963 15.48% 651528 612528 6.37% 1019900 833012 22.44%
11 1059280 1134829 6.66% 1194111 1144526 4.33% 613572 744712 17.61% 529568 512144 3.40% 1100546 860892 27.84%
12 1010351 1061306 4.80% 939783 899864 4.44% 441666 598816 26.24% 725386 736557 1.52% 1189945 912182 30.45%
Avg   6.13%   4.36%   12.08%   6.45%   9.17%
Std   2.23%   2.32%   12.02%   6.49%   11.42%
表 5-3、加權演化式模糊類神經網路因子代號與水準設定 
 
本實驗所選用直交表為 )3(27 13L ，依照表所排出之組合進行實驗，因每個
組合之加權演化式模糊類神經網路的結果都相同，故實驗只進行一次，並逐一進
行測試並記錄其結果，其結果如表 5-4 所示。 
 
表 5-4、參數組合之實驗結果 
代號 因   子 水準 1 水準 2 水準 3 
A X1 模糊區間數量 8 9 10 
B X2 模糊區間數量 3 4 5 
C X3 模糊區間數量 3 4 5 
D X4 模糊區間數量 8 9 10 
E Y1 模糊區間數量 3 4 5 
F X1 之權重值 0.25 0.275 0.3 
G X2 之權重值 0.20 0.25 0.3 
H X3 之權重值 0.15 0.20 0.25 
J X4 之權重值 0.25 0.3 0.35 
L 誤差門檻值 0.1 0.2 0.3 
K 相似度門檻值 0.7 0.8 0.9 
M W1 學習率 0.1 0.5 0.9 
N W2 學習率 0.1 0.5 0.9 
 A B C D E F G H J K L M N 實驗 1 S/N 比 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.0847 21.44233
2 1 1 1 1 2 2 2 2 2 2 2 2 2 0.0988 20.10486
3 1 1 1 1 3 3 3 3 3 3 3 3 3 0.0919 20.73369
4 1 2 2 2 1 1 1 2 2 2 3 3 3 0.0878 21.13011
5 1 2 2 2 2 2 2 3 3 3 1 1 1 0.0876 21.14992
6 1 2 2 2 3 3 3 1 1 1 2 2 2 0.1629 15.76158
7 1 3 3 3 1 1 1 3 3 3 2 2 2 0.0581 24.71648
8 1 3 3 3 2 2 2 1 1 1 3 3 3 0.1411 17.00946
9 1 3 3 3 3 3 3 2 2 2 1 1 1 0.1134 18.90774
10 2 1 2 3 1 2 3 1 2 3 1 2 3 0.0682 23.32431
11 2 1 2 3 2 3 1 2 3 1 2 3 1 0.0313 30.08911
12 2 1 2 3 3 1 2 3 1 2 3 1 2 0.0846 21.45259
13 2 2 3 1 1 2 3 2 3 1 3 1 2 0.1077 19.35569
14 2 2 3 1 2 3 1 3 1 2 1 2 3 0.1029 19.75169
15 2 2 3 1 3 1 2 1 2 3 2 3 1 0.0786 22.09155
Main Effects Plot for S/N Ratios 
 
圖5-2、各因子S/N比回應圖 
 
在S/N比圖比較的基準乃愈大為愈佳，因此由回應圖及回應表中選取每個因
子水準中值最大者分別為A2-B3-C1-D3-E2-F1-G1-H1-J3-K3-L1-M3-N2，最佳參數
組合如表5-6所示。 
表5-6、最適參數之組合 
 
而為求此模型更精確之最佳參數組合，本研究更進一步的針對13項因子
Delta統計量排序(如表5-5所示)，以半數法則來選取影響性最高的前幾項參數，
進行全因子實驗設計。 
在第二階段中，將第一階段田口參數設計之Delta值由大至小排列，並計算
累積百分比(如圖5-3所示)，由於採用半數法則，而50%的Delta累積百分比共有
四項因子，所以選擇此四個因子進行全因子實驗設計，而前四個最具影響性因子
分別為X4之權重值、X1模糊區間數量、X1之權重值及X2之權重值，各因子水準設
計主要採用第一階段之最佳水準為基礎，縮小各因子水準之間距，其各因子之代
號與水準如表5-7所示。 
代
碼 因子 
數
量 
代
碼 因子 權重
代
碼 因子 
參
數
A X1 模糊區間數量 9 F X1 之權重值 0.25 K 誤差門檻值 0.3
B X2 模糊區間數量 5 G X2 之權重值 0.20 L 相似度門檻值 0.7
C X3 模糊區間數量 3 H X3 之權重值 0.15 M W1 學習率 0.9
D X4 模糊區間數量 9 J X4 之權重值 0.35 N W2 學習率 0.5
E Y1 模糊區間數量 4       
M
ea
n 
of
 y
321
0.06
0.05
0.04
0.03
0.02
321
321
0.06
0.05
0.04
0.03
0.02
321
A B
C D
 
圖 5-4、各因子之主效應圖 
 
表 5-8、加權演化式模糊類神經網路最適參數組合 
 
 
 
 
 
 
根據上述之參數設計所得到之最適參數組合，代入本研究所建立之加權演化
式模糊類神經網路模型，在訓練階段時共演化出 46 條模糊規則，演化過程如圖
5-5 所示，在測試階段所得到之預測結果如圖 5-6 所示。 
 
因子 最適之參數 
X1 模糊區間數量 9 
X1 之權重值 0.25 
X2 之權重值 0.20 
X4 之權重值 0.36 
差作為衡量模型間優劣之標準。 
5.4.1 演化式模糊類神經網路模型 
演化式模糊類神經網路(EFuNN)所使用之田口參數設計方式與 5.3 小節之方
式類似，但本小節的重點在於探討與演化式模糊神經網路之績效比較之部份，因
此演化式模糊神經網路之最佳參數設計，在此不多贅言。最適參數整理如下表
5-9 所示： 
表 5-9、演化式模糊類神經網路之最適參數設計 
 
 
 
 
 
 
 
 
 
 
圖 5-7、EFuNN 模糊規則演化過程 
 
根據上述之參數設計所得到之最適參數組合，代入演化式模糊類神經網路模
型，在訓練階段時共演化出 38 條模糊規則，演化過程如圖 5-7 所示，在測試階
段所得到之預測結果如下圖 5-8 所示。 
 
 
 
 
參數 最適之設定 
輸入因子模糊區間個數 2 
輸出因子模糊區間個數 2 
相似度門檻值 0.9 
誤差門檻值 0.1 
W1 學習率 0.5 
W2 學習率 0.5 
學習次數  1 
在圖 5-8 中可看出 EFuNN 模型預測的能力，從整體預測效果來看，EFuNN 之
平均誤差百分比低於 10%，屬於預測能力極佳之模型。而加權演化式模糊神經網
路之平均誤差百分比為 2.11%，較 EFuNN 的平均誤差百分比 6.44%為低，可見得
加權演化式模糊神經網路能有較準確的預測能力。另外，加權演化式模糊神經網
路之標準差為 2.11%，比 EFuNN 之 4.31%低，顯示加權演化式模糊神經網路亦有
較高之預測穩定度。 
另外，從 MAD 方面來看，加權演化式模糊神經網路的 MAD 值為 16445 平方英
呎, 低於 EFuNN 的 47072 平方英呎，顯示加權演化式模糊神經網路的預測較接近
實際生產需求。以 RMSE 方面來看，加權演化式模糊神經網路的 RMSE 值為 23849
平方英呎，低於 EFuNN 的 56566 平均英呎，顯示加權演化式模糊神經網路在預測
精確定上較 EFuNN 佳。 
5.4.2 倒傳遞網路模型 
類神經網路是現今最普遍應用於各領域，如百貨公司銷售預測、銀行個人信
用評等、製程參數控制之預測等，其都具有預測效率佳的效果。此小節將利用
Neural Network Professional Ⅱ Plus 軟體進行類神經網路之實驗，倒傳遞網
路在修正權重的部份將採用「最陡降坡法」，為傳統倒傳遞網路最常使用的修正
方式。. 
表 5-11、倒傳遞網路模型說明表 
 
倒傳遞網路所使用之田口參數設計方式與 5.3 小節之方式類似，但本小節的
重點在於探討與倒傳遞網路之績效比較之部份，因此倒傳遞網路之最佳參數設
計，在此不多贅言。最適參數整理如下表 5-12 所示： 
 
表 5-12、倒傳遞網路之最適參數設計 
 
 
 
 
 
 
 
其預測之結果如下圖 5-9 所示： 
使用工具 Neural Network Professional Ⅱ Plus 
輸入層 出口貿易值、液晶顯視元件、印刷電路板銷售產值、溫氏指數平滑法
輸出層 預測值 學習法則 Delta-Rule 轉換函數 Sigmoid 
參數 最適之設定 
隱藏層層數 1 層 
隱藏層神經元個數 2 個 
學習速率 0.4 
慣性動量 0.5 
學習次數 100000 次 
值明顯與實際值產生偏差，但從整體預測效果來看，倒傳遞網路之平均誤差百分
比低於 10%，屬於預測能力極佳之模型。而加權演化式模糊類神經網路之平均誤
差百分比為 2.11%，較倒傳遞網路的平均誤差百分比 8.76%為低，可見得加權演
化式模糊類神經網路能有較準確之預測能力。另外，加權演化式模糊類神經網路
之標準差為 2.11%，比倒傳遞網路之 9.63%低，顯示加權演化式模糊神經網路亦
有較高之預測穩定度。 
另外，從 MAD 方面來看，加權演化式模糊神經網路的 MAD 值為 16445 平方英
呎, 低於倒傳遞網路的 72494 平方英呎，顯示加權演化式模糊神經網路的預測較
接近實際生產需求。以 RMSE 方面來看，加權演化式模糊神經網路的 RMSE 值為
23849 平方英呎，低於倒傳遞網路的 109899 平均英呎，顯示加權演化式模糊神
經網路在預測精確度上較倒傳遞網路佳。 
5.4.3、多元迴歸分析預測模型 
多元迴歸分析為統計學中的一種常用方法，原理是將一個或多個自變數來對
應一個因變數，而產生一個線性方程式，當自數數與因變數具有線性相關時，容
易很快的建立出模型，但遇到非線性的問題時，則很難建立準確的模型。 
多元迴歸分析模型中的輸出值(Y)即為印刷電路板之預測銷售量，而四項輸
入項分別為出口貿易值( 1X )、液晶顯視元件( 2X )、印刷電路板銷售產值( 3X )、
溫氏指數平滑法( 4X )。其關係式如下所示： 
1 1 2 2 3 3 4 4Y a X a X a X a X b= + + + +  
其中， 1a 、 2a 、 3a 、 4a 及 b經由 Excel 內建之資料分析函式庫計算後，其
多元迴歸分析方程式如下所示： 
1 2 3 40.01141 0.244169 5.91762 0.969816 13140.4Y X X X X= × + × − × + × −  
將測試樣本代入多元迴歸分析方程式計算後，其預測結果如圖 5-10 所示： 
多元迴歸分析預測結果與實際值之比較
0
200000
400000
600000
800000
1000000
1200000
1400000
1 2 3 4 5 6 7 8 9 10 11 12 月份
生
產
數
量
0.00%
5.00%
10.00%
15.00%
20.00%
25.00%
30.00%
35.00%
百
分
比
誤差百分比
實際值
迴歸分析預測
值
平均誤差百分
比
圖 5-10、多元迴歸分析預測結果與實際值之比較 
5.4.4 基因神經網路模型 
傳統的倒傳遞網路對於權重的修正往往侷限在「最陡坡降法」的搜尋空間而
無法跳脫，容易造成收斂的效果不佳或是提早收斂等狀況。因此，基因神經網路
可藉由基因演算法具有強大的空間搜尋能力來取代「最陡坡降法」的缺點。本模
式即為本研究計畫第一年所建立之基因神經網路模型，經由田口參數設計後，其
最適之設定如下表 3-15 所示。 
 
表 3-15、基因神經網路最適參數組合 
 
 
 
 
 
 
 
 
 
其預測之結果如下圖 5-11 所示： 
GANN模型預測結果與實際值之比較
0
100000
200000
300000
400000
500000
600000
700000
800000
900000
1000000
1 2 3 4 5 6 7 8 9 10 11 12 月份
生
產
數
量
0.00%
1.00%
2.00%
3.00%
4.00%
5.00%
6.00%
7.00%
8.00%
9.00%
百
分
比
誤差百分比
實際值
GANN預測值
平均誤差百分
比
圖 5-11、基因神經網路預測結果與實際值之比較 
 
 
 
 
 
 
 
參數 最適之設定 
交配方式 兩點交配 
突變方式 單點突變 
取代方式 菁英政策 
交配率 0.8 
突變率 0.3 
隱藏層數 2 
世代數 300 
5.5 綜合比較分析 
上一小節中，本研究所提出加權演化式模糊類神經網路之預測模型，在各種
績效衡量方面都優於其它的預測模型，另從圖 5-12 中可看出，在所有預測方法
的模型中，以本研究所提出之預測模型的預測結果與實際生產數量最為接近，預
測能力最為佳。另外，衡量預測方法除了準確度與精確度之外，本研究還考量到
預測的總成本差(TCD)，從總成本差可看出因預測偏差所產生的額外成本。 
各種預測模型之比較
400000
500000
600000
700000
800000
900000
1000000
1100000
1200000
1 2 3 4 5 6 7 8 9 10 11 12 月份
生
產
數
量
實際值
加權演化式模糊
類神經網路
基因神經網路
EFuNN
倒傳遞網路
多元迴歸分析
 
圖 5-12、各種預測模型之比較 
 
表 5-17、各種預測模型 TCD 之比較 
月 份 WEFuNN EFuNN 倒傳遞網路 多元迴歸分析 
基因神經網
路 
1 3,072,155  14,446,998 19,429,540 4,198,962  23,732,623 
2 4,395,091  47,498,947 8,409,801 3,253,195  4,329,205 
3 4,990,992  25,783,043 13,743,489 599,994  18,025,165 
4 18,154,441  26,758,317 21,357,616 27,921,429  84,058 
5 2,464,846  48,657,033 7,737,847 19,523,469  6,164,192 
6 2,578,727  12,156,644 2,462,335 14,354,790  1,102,563 
7 14,420,239  18,169,830 13,506,341 26,472,926  7,139,677 
8 13,328,602  73,260,100 23,437,140 33,714,439  10,752,945 
9 51,065,745  66,828,004 83,198,517 90,926,161  53,738,680 
10 5,688,405  4,330,497 136,961,995 146,070,856  25,463,975 
11 10,491,155  27,987,263 176,532,242 196,539,696  44,716,133 
12 24,742,581  77,341,858 189,723,506 229,006,210  31,619,847 
總合 *155,392,978  443,218,533 696,500,370 792,582,129  226,869,062 
測試誤差 *12,949,415  36,934,878 58,041,697 66,048,511  18,905,755 
確實可以有效減少誤差與標準差，增加模型之準確性與穩定性。 
2、考量各輸入因子給予不同權重值的預測模型，能顯示出各因子的重要程度之
代表性，較其它輸入因子權重相等之預測模型來的準確。 
3、當考量預測模型之準確度與精確度時，加權演化式模糊類神經網路模型優於
其它預測模型之表現，有最小的 MAPE 與 RMSE，顯示本研究之預測模型同時具有
高準確度與精確度。 
4、考量整體預測誤差所造成的成本差異時，加權演化式模糊類神經網路模型較
其它預測模型具有最小之誤差成本。 
5、加權演化式模糊類神經網路在訓練過程中，只需一個世代即可完成，較其它
結合倒傳遞網路的預測模型之訓練過程快許多。 
6、多元迴歸分析模型乃五個預測模型中預測能力最差的，因該模型只適於線性
問題，對於非線性之問題的預測能力較為貧弱。 
7、各種預測模型在第九個月的預測誤差都明顯偏大，乃因金像電子曾於 2002
年 9 月發生火災，9 月份的需求亦受到火災的影響而降低，此乃預測上的不可抗
拒因素所造成預測的不準確性。 
5.6 研究討論 
根據上一小節實證結果，本研究所提出之研究方法皆優於其它預測模型，本
研究探討可能原因如下所示： 
1、加權演化式模糊類神經網路採用(WEFuNN)加權的方式進行相似度之計算，可
依各輸入因子所代表的重要性而給予相對之權重，較演化式模糊類神經網路
(EFuNN)採用相同權重計算相似度的方法更能萃取資料中的知識。 
2、演化式模糊類神經網路模型在計算相似度時，採用模糊距離函數(Fuzzy 
Distance Function)，計算作用函數公式為(1-D)，而本研究方法計算相似度
時，採用歐基理德的最短距離計算公式，計算作用函數為(exp(-D))，其最大
之差異在於模糊距離函數乃屬於線性型態，而歐基理德乃屬於指數型態，因
此，歐基理德距離公式能明確的計算出相似度的差異程度。 
3、本研究在回想過程階段中，結合 k鄰近法擷取模糊規則的方法，較演化式模
糊類神經網路回想過程階段只找最相似之模糊規則較為準確，乃 k鄰近法能
修正預測結果之準確性，較能適應複雜的環境變化。 
4、經實證結果發現，加權演化式模糊類神經網路、演化式模糊類神經網路與基
因神經網路之預測效果皆優於傳統倒傳遞網路，乃傳統倒傳遞網路調整權重時採
用「最陡坡降法」，較其它結合倒傳遞網路模型之預測效果差，而最陡坡降法在
進行連結權重調整時，容易產生局部解、處理單元飽和、出現減緩和跳出現象與
執行時間過長等問題。 
 
相似度計算的方法，可依問題的特性來採用何種相似度演算法，以提升預測
能力。 
參考文獻 
[1]. Aamodt, A. and E. Plaza, “Case-Based Reasoning: Foundational Issue 
Methodological Variations and System,” Artificial Intelligence Communications, 
Vol. 7:1, pp.39-59, 1994. 
[2]. Abdel-Aal, R.E. Z. Al-Garni, “Forecasting monthly electric energy consumption 
in eastern Saudi Arabia using univariate time series analysis”, Energy, Vol.22,pp. 
1059-1069 , 1997. 
[3]. Abraham, A. and N. Baikunth, “A neuro-fuzzy approach for modeling electricity 
demand in Victoria”, Applied Soft Computing , pp. 127-138. ,2001. 
[4]. Abraham, A., N. Baikunth, and P.K. Mahanti, “Hybrid Intelligent Systems for 
Stock Market Analysis”, Lecture Notes in Computer Science, 
vol.2074,p.p.337-345,2001. 
[5]. Abraham, A., D. Steinberg, and N.S. Philip, “Rainfall Forecasting Using Soft 
Computing Models and Multivariate Adaptive Regression Splines” IEEE SMC 
Transactions: Special Issue on Fusion of Soft Computing and Hard Computing in 
Industrial Applications, February , 2001. 
[6]. Box, G.P., G.M. Jenkins, “Time Series Analysis: Forecasting and Control,” 
Holden-day Inc. , 1976. 
[7]. Brown, R.G. “Smoothing, Forecasting and Prediction of Discrete Time Series”, 
Englewood Cliffs, NJ: Prentice Hall, 1962. 
[8]. Chan, C.K., B.G. Kingsman, H. Wong, “Value of Combining Forecasts in 
Inventory Management-A Case Study in Banking’’ European Journal of 
Operational Research,117(2), pp.199-210, 1999. 
[9]. Chen, T. “A Fuzzy Back Propagation Network for Output Time Prediction in a 
Wafer Fab,” Applied Soft Computing 2/3F, pp.211-222, 2003 
[10]. Dash, P. K., A. C. Liew, and S. Rahman, “Peak load forecasting using a fuzzy 
neural network,” Electric Power Systems Research 32, pp.19-23, 1995. 
[11]. Azoff, E.M “Neural Network Time Series Forecasting of Financial Markets”, 
John Wiley & Sons, 1994. 
[12]. Gardner, E.S. & D.G.. Dannenbring, “Forecasting with Exponential 
Smoothing:Some Guidelines for Model Selection.” Decision Sciences, Vol. 11, 
No.2,  pp. 370~383, 1980. 
[13]. Herbig, P., J. Milewicz, and J.E. Golden, “Forecasting: Who, What, When, and 
How”, Journal of Business Forecasting, Vol.12, No.2, Summer 1993. 
[29]. Michael D.G. and S.A. Moore, “Depicting the use and purpose of documents to 
improve information retrieval,” http://www.umich. edu/~samoore/resear. index. 
1997.  
[30]. Michael, J. A., and B.S. Gordon, “Data Mining Techniques: for marketing,” sales, 
and customer support, ” John Wiley & Sons, 1997. 
[31]. Munoz, A.H., J.A. Hendler, and D.W. Aha, “Conversational Case-Based 
Planning” Review of Applied Expert System ,5, pp.163-174, 1999. 
[32]. Quah, T.S. and B. Srinivasan, “Improving returns on stock investment through 
neural network selection”, Expert Systems with Application, Vol. 17, pp295-301, 
1999. 
[33]. Schank, R.C. “Dynamic Memory: Theory of Reminding and Learning in 
Computers and People”, Cambridge University Press, 1982. 
[34]. Shan, M.S., D.X. Li, and L. Bao, “Improving the accuracy of onolinear 
combined forecasting using neural networks” Expert System with Application,16, 
pp.49-54,1999. 
[35]. Smyth, B., “Constructing Competent Case Based Reasoners: Theories, Tools and 
Techniques,” Proceedings of the Workshop on Automating the Construction of 
Case Based Reasoners, Stockhol, Sweden, 1999. 
[36]. Srinivasan, Dipti, “Evolving artificial neural networks for short term load 
forecasting,” Neural computing, Vol.23, pp.265-276, 1998. 
[37]. Al-Saba, T., I. El-Amin, “Artificial neural networks as applied to long-term 
demand forecasting”., Artificial Intelligence in Engineering 13 pp.189-197,1999. 
[38]. Tong-Seng, Q. and B. Srinivasan, “Improving returns on stock investment 
through neural network selection”., Expert System with Applications 17 
pp.295-301,1999. 
[39]. Trigg, D.W. and D.H. Leach, “Exponential Smoothing with an Adaptive 
Response Rate,” Operational research Quarterly, 18,pp.53-59,1976. 
[40]. 于宗先，經濟預測，中央研究院經濟研究所，1972。 
[41]. 台灣電路板協會，全球電路板供需分析與台灣未來機會，2004。 
[42]. 行政院主計處統計局，中華民國統計月報，1999-2003。 
[43]. 行政院主計處統計局，台灣地區物價指數統計月報，1999-2003。 
[44]. 吳宗正，「人工神經網路與統計方法應用於台灣上市電子類股價指數預測與
分類之研究」，國立成功大學，碩士論文， 2004。 
[45]. 李允中、王小璠、蘇木春，模糊理論及其應用，全華科技圖書股份有限公司，
台北，2003。 
[46]. 李順成，農業政策及經濟研究，農委會科技計畫期末摘要報告 2000。 
[47]. 周湘蘭，類神經網路在多重產品需求預測上之應用，元智大學工業工程管理
研究所，碩士論文，2001。 
