 2
 
超視覺能力之探索與建構 
Investigation and Construction of Super-Vision Capability  
黃榮興 葉勝凱 高鳳呈 周俊逸 
逢甲大學自動控制工程研究所 
Thong-Shing Hwang, Sheng-Kai Yeh, Fong-Cheng Gao, Jyun-Yi Chou 
Automatic Control Engineering, Feng Chia University 
 
摘要 
   本研究之目的是在於製作一套具有對焦技術之機器視覺自動量測系統，應用 CCD 動態影
像處理技術以即時量測平台之三個姿態角度。利用平台上特徵點的影像將其影像座標透過平面
投影轉換法，求得在任意姿態時該特徵點的世界座標位置，且配合轉動矩陣計算出平台姿態，
將姿態值回授給平台，以便將來完成追蹤控制之目的。 
 
 關鍵字：影像處理，自動對焦，姿態量測，動感模擬 
 
Abstract 
The purpose of this research is to design an auto-focusing technique of the vision machine and 
apply the dynamic image processing technique to measure the attitude of platform in real-time. In 
this research, we transform the images of feature points on the upper platform into the world 
coordinate system by using image coordinate transformation with plane projection transfer method, 
and then calculate the corresponding platform attitude. Close loop feedback control will be realized 
by sending the attitude of platform back to the computer in the future. 
 
Keywords：Image Processing, Auto-Focusing, Attitude Measurement, Motion-Cueing Simulation 
             一、前言 
攝影機校正技術是電腦視覺應用中最基
礎與實際的一個課題，攝影機經校正後始能得
知影像平面座標與空間座標的相對關係。有別
於以往在姿態之即時量測上，大部分都是用平
台既有的順向運動方程(Forward Kinematics)
來 推 導 估 測 或 是 利 用 微 機 電 系 統
(Micro-Electro Mechanical System MEMS)所製
造之慣性導航感測器－陀螺儀方式，本研究使
用一種非接觸式 CCD 影像處理技術於動感平
台姿態量測，重點放在製作一套具有對焦、變
焦之機器視覺自動量測系統，取代人工調整，
以節省人工調整的時間與體力，提高準確度與
達成自動化，且利用焦距之自動調整以捕捉清
晰之物體及姿態變化，更加賦予視覺系統多樣
化的能力。 
 
二、系統簡介與理論說明 
    動感平台部分，動感模擬最主要目的，不
外是將現實狀況之動態感覺完完全全模擬出
來，如何在受限空間內，將動感現象表現得有
如深在其中的現實狀況感覺，是現今籌建高階
 4
為有一方向無明顯變化而產生很大的誤差。 
( ) ( )1 1 , , 1M Ny
x y
S M D I x y I x y
− −
= − +∑ ∑  (2)                                                
( ) ( )1 1 , 1,M Nx
x y
SMD I x y I x y
− −
= − +∑∑          (3) 
    目標函數則是計算 SMDx 與 SMDy 的總
和，並選擇出現最大值時的對焦位置為最佳對
焦位置： 
SMD(i)=SMDx+SMDy           (4) 
最佳對焦位置 = i  , ( )MAX SMD i⎡ ⎤⎣ ⎦  
    M、N：圖檔大小 
    i：鏡片位置 
(3)影像拉普拉斯能量(Energy of Laplacian of 
the Image) 
影像拉普拉斯是以影像強度函數的二次
微分當作高通濾波器，利用於邊界搜尋的拉普
拉斯運算子做二次微分： 
2 2
2
2 2 2 2
I II
x y
∂ ∂∇ = +∂ ∂             (5) 
以近似的離散化拉普拉斯運算核作為高
通濾波器： 
1 4 1
1 4 20 4
6
1 4 1
L
⎡ ⎤⎢ ⎥= −⎢ ⎥⎢ ⎥⎣ ⎦
            (6)運
用對焦品質評估的目標函數則定義為： 
( ) ( ),M N i
x y
LE i L I x y= ∗∑∑                (7) 
最佳對焦位置 = i  , MAX[LE( i )] 
      M、N：圖檔大小 
      i：鏡片位置 
      ∗：迴旋積分(Convolution Integral) 
前面的說明可知焦距模糊之影像其像素
灰階值可用來作為自動對焦的評斷工具，而焦
距量測即是求取在不同焦距的影像之高頻能
量，自動對焦最主要的工作就是先進行焦距量
測，以便求得該張影像高頻能量。圖 2 所示為
透鏡位置與焦距量測之間的關係，由圖中可以
看出來在最佳透鏡位置時其焦距量測所得的
高頻能量為最大。因此若能找出高頻能量最高
的點即為最佳透鏡位置。但並非一次就能找到
最佳對焦的位置，需反覆幾次才能完成自動對
焦的工作。 
 
圖 2 透鏡與焦距量測關係之高斯函數示意圖 
 
2.2.2  CCD 影像姿態量測之探討 
由於計算平台姿態角之前，我們必須先知
道特徵點所在的座標位置，因此訂定 CCD 座
標與上下平台之間的座標為我們首要的工
作，其姿態量測座標系統示意圖如圖 3 所示： 
  
圖 3 姿態量測系統座標示意圖 
其中世界座標亦同為下平台座標，CCD 之
Z 軸方向為攝影方向，三座標之 Z 軸與上下平
台中心點為共線。 
(1)  CCD 攝影機模型 
攝影機模型是將景物的影像轉成圖面的
過程，以物理的描述表示出來；而攝影機及人
眼的透視投影方式，可以視作一個針孔模型
（pinhole model）如圖 4 示： 
 6
以同樣的方式，將(17) (19)代入到(20)亦可
得： 
( )
( )
6 6
6 6
6 6
cos sin sin sin cos
cos cos sin sin sin
cos sin
B P
B P
B P
x y
y y
z y
ψ θ φ ψ φ
ψ φ ψ θ φ
θ φ
⎡ ⎤ ⎡ ⎤⋅ ⋅ − ⋅ ⋅⎢ ⎥ ⎢ ⎥= ⋅ + ⋅ ⋅ ⋅⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⋅ ⋅⎣ ⎦ ⎣ ⎦
  (22)                                       
→ψ = arcsin (Bz6 / Py6 ‧cosθ) 
透過上述求解方式，平台姿態角 ψ、θ、
Ψ即可順利求出。 
 
2.3 平台 CCD 影像姿態量測之設計 
（一）平面投影轉換法 
在世界座標軸中選取 0WZ = 的平面作投
影轉換，利用3 4× 的投影矩陣 K 簡化成 的平
面投影矩陣。 
1 11 12 13 14 11 12 13
2 21 22 23 24 21 22 23
3 31 32 33 34 31 32 33
0
1
1
w
w
w
w
x
x k k k k k k k x
y
x k k k k k k k y
x k k k k k k k
⎡ ⎤⎡ ⎤ ⎡ ⎤ ⎡ ⎤ ⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥∝ =⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥ ⎢ ⎥ ⎢ ⎥⎢ ⎥⎣ ⎦ ⎣ ⎦ ⎣ ⎦ ⎣ ⎦⎣ ⎦
       (23) 
利用一個 的矩陣可以完成一般的平面投
影座標轉換，又稱為平面投影轉換矩陣以 M 表
示。 
11 12 13
21 22 23
31 32 331 1
w
w
x m m m u
y m m m v
m m m
⎡ ⎤⎡ ⎤ ⎡ ⎤⎢ ⎥⎢ ⎥ ⎢ ⎥∝ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎢ ⎥⎣ ⎦ ⎣ ⎦⎣ ⎦
           (24) 
所以可以推導成下式 
11 12 13
31 32 331
wx m u m v mX
m u m v m
+ += = + + 、 
21 22 23
31 32 331
wy m u m v mY
m u m v m
+ += = + +         (25) 
可將以上兩式展開成 
31 32 33 11 12 13( )X m u m v m m u m v m+ + = + +  
31 32 33 21 22 23( )Y m u m v m m u m v m+ + = + +   
                                     (26)                       
上式中有 9 個未知數，由於在齊次座標轉
換是比例上相等，所以可以假設其中一個未知
數是固定，例如 33 1m = ，所以實際要求的對應
的關係量只剩 8 個數值。由於一個對應點可以
產生 2 組線性獨立方程式，在實驗中可從圖
3.66 校正塊抓取 N 個對應點以產生 2N 個方程
式，所以要求解 8 個未知數至少需要 4 個非共
線(non-collinear)的對應點以提供 8個線性獨立
方程式，利用以下方式求解： 
假設固定 33 1m = ，利用 4 組對應點可得 
111 1 1 1 1 1
121 1 1 1 1 1
132 2 2 2 2 2
212 2 2 2 2 2
223 3 3 3 3 3
233 3 3 3 3 3
314 4 4 4 4 4
324 4 4 4 4 4
1 0 0 0
0 0 0 1
1 0 0 0
0 0 0 1
1 0 0 0
0 0 0 1
1 0 0 0
0 0 0 1
mu v X u X v
mu v Y u Y v
mu v X u X v
mu v Y u Y v
mu v X u X v
mu v Y u Y v
mu v X u X v
mu v Y u Y v
− − ⎡⎡ ⎤ ⎢⎢ ⎥− − ⎢⎢ ⎥ ⎢⎢ ⎥− − ⎢⎢ ⎥− −⎢ ⎥⎢ ⎥− −⎢ ⎥− −⎢ ⎥⎢ ⎥− −⎢ ⎥− −⎢ ⎥⎣ ⎦ ⎣
1
1
2
2
3
3
4
4
X
Y
X
Y
X
Y
X
Y
⎤ ⎡ ⎤⎥ ⎢ ⎥⎥ ⎢ ⎥⎥ ⎢ ⎥⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥=⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥⎢ ⎥⎢ ⎥ ⎣ ⎦⎦
    
                                     (27)           
之後可以利用線性代數的最小平方誤差
求投影解： 
AX = b 
X = (ATA)-1 ATb                   (28) 
    解出所有的 m 值，之後便可利用平面投影
轉換矩陣將影像座標轉成真實世界座標。 
 
圖 7 校正塊實照圖 
上圖 7 每一格正方形大小為 1cm x 1cm 的
校正方塊圖，方塊中的直線並不包含在 1cm 的
範圍內。 
（二）平台姿態角之量測 
在使用 CCD 抓取平台影像之前，為了正
確找出上平台 4P 、 5P 、 6P 點的擺放位置，我們
須事先確定平台轉動軸之方位，其實體架設為
圖 8。 
 
圖 8 CCD 量測實體架構圖 
第一步：將特徵點擺放至上平台。 
第二步：調整 CCD 攝影位置，讓三特徵
 8
 
圖 12 目標函數變化程度 
 
3.1 姿態量測之結果 
由於姿態量測訂定特徵點所在的平面為
平台萬向接頭所在的平面，實際上放置特徵點
的位置與萬向接頭之平面有一垂直的高度
差，因此在計算所有特徵點偏移量時，需考慮
到原點特徵點的偏移情形。實驗選定量測動感
平台執行 Yaw Sin 15 度，再利用 CCD 自動對
焦監控系統來量測三個特徵點的座標值，圖中
橫座標取樣時間為 0.1sec，縱座標為中心點座
標的像素值(Pixel)。 
 
圖 13 轉 Yaw-sin 之 Pitch 姿態 
    
圖 14 轉 Yaw-sin 之 Yaw 姿態 
    
圖 15 轉 Yaw-sin 之 Roll 姿態 
圖 13 到圖 15 為平台單軸驅動 Yaw Sin 
Wave，圖中包含由 CCD 影像處理計算出的平
台姿態角(紅色曲線)、理想輸入的姿態角(綠色
曲線)與順想量測之姿態角(黑色曲線)三條曲
線。由圖形顯示我們可以發現驅動平台單軸，
其他兩軸能存在著些許角度的偏差，這與實際
輸入姿態值差異很大，實際輸入轉動Yaw 15 度
但實際上除了有 Yaw 的轉動還伴隨著另外兩
個Pitch 與Roll 角度的變化。 
    實際上平台尺寸設計上與驅動滾珠導螺
桿會有些微的誤差，另外在 CCD 電腦端也已
對影像清晰度執行過最佳焦距的校正，與平台
本身中心點之特徵點的偏移進行校正，但是由
於周圍光源、CCD 和影像擷取卡的光學影響以
及外界雜訊等，會影響影像處理計算姿態時產
生的誤差；最後就是平台量測的演算法則，只
適用於某種特定的實驗平台設置上，與假設在
某些情況理想狀況下，對於其他設置的量測平
台會存在一定的量測誤差。 
由以上這些誤差分析，似乎看起來順向的
結果是最接近符合實際輸入，順向的量測都是
由內部程式運算出的結果，也不確定它就是真
實量測到的結果，而 CCD 雖有誤差但卻是由
外接實際量測值，或許實際平台的動作就有如
CCD 量測一般，並非理想上動作分明無誤差。
因此未來若有相關於這方面的後續研究，可以
試著再將慣性導航感測器－陀螺儀量測方式
加入一同比較分析，如此一來更可以提高量測
的準確度，才能降低動感平台的誤差，使其平
台位移和轉動之準確性增加。 
 
四、結論與未來展望 
本研究為國科會計畫「超視覺能力之探索
與建構」第一期之研究，目的在於建構一仿生
機器人超視覺系統以探索與建構仿生機器人
超視覺能力，同時在動感平台上將此超視覺能
力整合測試與模擬驗証。在傳統上，都是由人
工調整焦距(變焦鏡頭)以便讓影像達到清晰，
有鑑於此，本研究引入自動對焦技術，透過評
