 II 
可供推廣之研發成果資料表 
■ 可申請專利  □ 可技術移轉                                      日期：96年 8月 1日 
國科會補助計畫 
計畫名稱：非線性 FDI濾波器設計與其在接收機自主完整性監控之
應用：使用微分幾何法 
計畫主持人：王和盛      
計畫編號：NSC 95-2221-E-019-097學門領域：航太 
技術/創作名稱 
一種具有強健性的全球導航衛星系統接收機自主
完整性監控的方法 
 
發明人/創作人 王和盛 
技術說明 
中文： 
本發明以線性矩陣不等式為工具，針對接收機自主完整性監控問題
設計出適用的 H∞濾波器。基於所提及的方法，GPS動態定位與自
主完整性監控問題均可以轉化成標準的 H∞控制架構，並且可設計
出一 H∞濾波器同時進行 GPS 動態定位以及錯誤偵測與排除。接收
機自主完整性監控的目的在於偵測無法容許的定位誤差，並且進一
步的排除誤差來源。因此；導航的功能才能繼續運作，這樣的概念
與 FDI問題有著相同的精神。近年來 H∞最佳化理論應用於 FDI備
受重視，尤其在於抗擾動(disturbance rejection)與系統的強健性
(robustness)方面。我們的目標在於以線性矩陣不等式的方法來設計
應用於解決自主完整性監控問題的 H∞濾波器。所提及的方法不僅
能偵測位置誤差也能偵測速度或加速度誤差。 
英文：In the present invention, a LMI-based H∞ filter design for the 
GPS positioning and receiver autonomous inequality monitoring 
(RAIM) problems are examined. Based on the proposed method, 
dynamic GPS positioning and fault detection and isolation (FDI) 
problem can be solved simultaneously based on a standard H∞ control 
setting. The purpose of RAIM is to detect the presence of unacceptably 
large position error and, further, to exclude the error source. Thus, the 
GPS navigation is allowed to continue. This kind of concept is similar 
to the general idea of Fault Detection & Isolation problem. Lately, H∞ 
optimization methods for FDI have received increased attention for 
providing disturbance rejection and robustness properties. Our 
objective is to design an LMI-based H∞ filter for the problem of 
receiver autonomous integrity monitoring. The proposed method can 
detect not only the position error but also the velocity error (or even 
acceleration error). 
 IV 
 
參考文獻 
 
1. H. S. Wang and T. T. Chien, “A Unified LMI Approach to GPS Positioning and Integrity 
Monitoring,” IEEE Conference on Systems, Man and Cybernetics, Taipei, Taiwan, October, 
2006. 
2. H. S. Wang and P. C. Hsiao, “Receiver Autonomous Integrity Monitoring via an H∞ 
Optimization Approach,” Proceedings of ION GNSS 2006. 
3. H. S. Wang and P. C. Hsiao, “GNSS Availability Analysis in Taiwan – a Markov Model 
Approach,” ION National Technical Meeting 2006. 
 VI 
4.1 GPS定位方程式之狀態空間模型 29 
4.2 強健控制理論簡介 31 
4.2.1 強健控制系統模型及結構 32 
4.2.2 H∞控制器設計-使用線性矩陣不等式 34 
第五章 GPS自主完整性監控系統套裝軟體設計、模擬、分析 39 
5.1 GPS自主完整性監控系統介紹 39 
5.2 快照式 GPS自主完整性監控系統設計、模擬、分析 41 
5.2.1 模擬結果與分析 43 
5.3 GPS自主完整性監控系統之 H∞濾波器設計、模擬、分析 50 
5.3.1 模擬結果與分析 53 
第六章 結論與展望 60 
參考文獻  62 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 VIII 
圖 5.15 H∞濾波器之 GPS自主完整性監控系統主監測畫面    52 
圖 5.16偏移誤差測試訊號            56 
圖 5.17隨機擾動測試訊號            56 
圖 5.18 H∞濾波器偵測結果            57 
圖 5.19估測誤差              57 
圖 5.20 x(t)-狀態軌跡             58 
圖 5.21 y(t)-狀態軌跡             58 
圖 5.22 z(t)-狀態軌跡             59 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 1 
                                          
               第一章 
                                          
 緒論 
1.1 研究動機與目的 
由於飛航安全具有絕對的優先次序，因此 GPS接收機如果要作為
主要的空用導航系統必需滿足可用性、精確性、連續性的要求，還須
具備完整性的功能。所謂的完整性，意指當 GPS衛星系統發生故障 
的時候，接收機能偵測出來並且適時發出警告。接收機自主完整性監
控器(Receiver Autonomous Integrity Monitoring ; RAIM)即是利用贅餘
衛星的資訊，依據統計學中的假設檢定，從檢查衛星的虛擬距離中，
判斷衛星組合的失常與否。 
 
近幾年來，為了達成自主完整性監控的功能，數種針對自主完整
性監控問題的演算法被具體呈現。Parkinson and Axelrad [1]提出了最
小平方剩餘法(Least-Square Residuals Method)作為偵測衛星失常的依
據。Sturza [2]提出了同位空間演算法(Parity space algorithm)，同位空
間演算法不但能將故障或失常的衛星給予偵測(Detection)，還建立了
一個幾何概念對於故障或失常的衛星能具體排除(Exclusion)。傳統文
獻中提及的演算法大多是靜態(Static)性的且僅與當前的量測量有關。 
 3 
監控系統套裝軟體，並設計出兼具有親和力的圖形使用者介面
(Graphical User Interface)，以便整合於軟體接收機和使用者的操作，
以提昇導航系統在完整性上的性能需求。 
 
1.2 論文架構 
本論文共分為六章。第一章介紹研究動機與論文之內容架構。 
第二章中，概述全球定位系統簡介與 GPS 單機定位原理。而第三章
則是對快照式 GPS 自主完整性監控器設計，介紹設計所需的理論與
演算法。第四章則是介紹 GPS自主完整性監控之 H∞濾波器設計。第
五章中，呈現了 GPS 自主完整性監控系統套裝軟體設計、模擬、分
析。第六章為本論文的結論和未來展望。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 5 
面平均分配四顆衛星，軌道面傾斜角(inclination)為 55 度，軌道高度
約 20200公里，週期為 11小時 58分(參考圖 2.1之 GPS衛星分佈示
意圖 )。這樣的設計可使地球上任何時間、任何地點，在仰角
(elevation)15度以上的天空均可“看到”4至 8顆GPS衛星，一般的GPS
接收機只需獲得四顆良好的衛星訊號，使用者即可達到三度空間的定
位與導航。 
 
圖 2.1 GPS 衛星分佈示意圖 
 
2. 地面追蹤站控制部分(Control Segment)： 
GPS的地面控制部份包含 2個主控制站，6個追蹤站與 4個地面
控制站(其分佈如圖 2.2所示)等三部份，其內容說明如下： 
 
(1) 主控制站(Master Control Station)： 
 7 
印度洋的 Diego Garcia 以及北太平洋的 Kwajalein。地面控制站主要
配備有地面天線，能由主控制站來遙控地面控制站的動作，其主要的
功能是把主控制站所計算出的修正參數傳送至 GPS衛星。 
 
圖 2.2 GPS系統地面控制站分佈圖 
 
3. 使用者部分(User Segment)： 
使用者部份指的是一般使用者的 GPS 接收機，由於 GPS 訊號是
單方向傳送的(由 GPS衛星傳至使用者)，所以使用者的數目並沒有限
制。GPS 接收機可以將 GPS 衛星的訊號轉換為位置、速度以及時間
的估測量。如前所述，接收機只需四顆衛星即可進行定位、導航的解
算。目前 GPS 接收機主要應用於導航、定位、時間傳遞及相關學術
研究之用。 
 
 9 
010101
111
11
10
02020322
223 20
0
000
1
1
1
RRR
RR
RR
RRR
nn
nRR
nnn
nnn
RRR
XXYYZZ
eXXP
XXYYZZ
eYYP
ZZ
eCdtP
XXYYZZ
ρρρ
ρ
ρ ρρρ
ρ
ρρρ
−−−

 − 
−−−  − =++   −
 
   −−−




  (2.2) 
 
其中 222010101()()()
i
R XXYYZZρ =−+−+− ； 1,2,in   
將(2.2)式重新整理後，可得線性方程式 
YHXe=+             (2.3) 
其中 
11
22
11
RR
RR
nn
RR nn
P
P
Y
P
ρ
ρ
ρ
××


=−




，
1
2
1n n
e
e
e
e
×


=




 為 1n× 向量 
 
010101
111
020202
222
000
4
1
1
1
RRR
RRR
nnn
nnn
RRR n
XXYYZZ
XXYYZZ
H
XXYYZZ
ρρρ
ρρρ
ρρρ
×
−−−


−−−
= 

 −−−


為 4n× 向量 
 
0
0
0
41
XX
YY
X
ZZ
Cdt ×
−
 −=
 −


為41× 向量 
 11 
                                                                  
                                   第三章 
                                            
快照式 GPS自主完整性監控器設計 
  
隨著科技的進步，飛機的速度越來越快 ; 如果導航系統提供了錯
誤的訊息，就可能誤導飛機瞬間偏離航道，造成危險的局面。因此， 
導航系統的完整性(Integrity)成為一個重要的問題。完整性意指當系統 
不適合用來幫助導航時，系統能提供適時的警告給使用者。 
 
在沒有其它擴增系統輔助的情況下，接收機自主完整性監控器 
(Receiver Autonomous Integrity Monitoring ; RAIM);是最常見的一種
提供完整性資訊的方法。當 GPS 作為輔助(Supplemental)導航系統
時，需要至少五顆衛星的資訊，從觀察虛擬距離(Pseudoranges)的過
程中檢查衛星工作狀況。當系統偵測到有衛星失常時，飛行員可以將
導航系統由GPS切換為其他次要導航系統。當GPS作為主要(Primary)
導航系統時，系統應有自動將失常衛星排除的能力，以維持 GPS 導
航系統正常工作。僅能偵測衛星失常的 RAIM顯然是無法提供足夠的
完整性資訊，因此必須配合 FDE(Fault Detection & Exclusion)演算法
使用六顆以上的衛星資訊，以達成完整性要求。 
 13 
    稱為一個失敗(Failure)存在。 
 
 最大容許警報率(Maximum Allowable Alarm Rate)意指當 GPS 
   在正常操作且無衛星失常的情況下，總共的警報率。由於大 
部份的完整性警報是基於傳送誤差和接收機雜訊所造成，可
預期真正因衛星失常所引發的警報是很少的。 
 警報時間(Time to Alarm)是指當失敗發生後，一直到發出完 
整性警報所需的最大允許時間間隔。 
 偵測或然率(Detection Probability)=1-漏偵測或然率(Miss 
Detection Probability)。失誤或然率是指當事實上失敗存在
時，偵測演算法卻不能推算出失敗發生的機率。 
 當 SA效應存在時，表 3.1所列規格仍應滿足。 
3.2 偵測衛星失常與失常衛星排除演算法 
如前所述，一個完備的導航系統除提供空中導航服務的功能外，
當系統無法提供足夠的正確訊息時，系統本身必須能提供可即時發出
告警的能力，這就是所謂系統的完整性。我們將 RAIM的演算法安裝
在接收機之內，以達到「自主」監控的效能。RAIM使用上我們假設
最多只有一顆衛星發生故障，亦即不考慮衛星在同一時問發生兩顆以
上故障的情形。在這樣的假設條件下，以下將介紹兩種快照式 RAIM
的演算法作為偵測衛星故障的依據，「快照式」(Snapshot)方法的特
 15 
3. 若e 的元素皆為互相獨立，平均值為零且具有相同變異量的高斯 
隨機變數，則 SSE將會是擁有 n-4 個自由度的未正規化之凱方分  
佈(Chi-Square Distribution)的隨機變數。 
 
為了要分析為何 SSE為 n-4個自由度的未正規化之凱方分佈的隨 
機變數，首先介紹凱方分佈的定義及相關理論: 
 
定義 3.1 凱方分佈的定義[7] 
若隨機變數 X為具有 n個自由度的凱方分佈，則其機率密度函數
(Probability Density Function)為以下的形式: 
/2
(/2)1/22   if      0 
() (/2)
             0                  if     0     
n
nxxex
fx n
x
−
−− ≥= Γ
 ≥
 
其中 
1
0
() xtxtedt
∞ −−Γ= ∫  
定理 3.1[7] 
若 12,, nXXX  是獨立的高斯分佈隨機變數，每個隨機變數都有相
同的平均µ 和標準差σ ，令 
 
2
1
n
K
K
XY µ
σ=
−= 
∑  
則Y 是一個具有 n個自由度的凱方分佈之隨機變數。 
 17 
所以存在一nn× 正交矩陣(Orthogonal Matrix) K，可將IQ− 對角化為
一nn× 矩陣，其對角線上之元素有 n-4個為 1，其餘四個為 0。亦即 
    (1,1,0,0,0,0)TIQKdiagK−=        (3.8) 
令 12(,,)
T
nuuuuKe==  ，由(3.3)和(3.4) 兩式可得 
    TSSEww=  
     ()()TTeIQIQe=−−  
()TTTeIQQQQe=−−+  
     ()TeIQe=−  
     (1,1,0,0,0,0)TTeKdiagKe=   
     (1,1,0,0,0,0)Tudiagu=   
2222
1254 nnuuuu −−=+++          (3.9) 
若e 的元素皆為互相獨立，平均值為零且具有相同變異量 2σ 的高斯隨
機變數，則 
111211
212222
12
n
n
nnnnn
KKKe
KKKe
uKe
KKKe


=







 
   
11112211
21122222
1122
nn
nn
nnnnnn
KeKeKeu
KeKeKeu
KeKeKeu
++
 ++==

 ++




 
由於K 為一正交矩陣，所以對於 1,2,,in=   
 19 
3.2.2 同位法(Parity Method)[2] 
(2.3)式中，最小平方法的解為 1() TTLSXHHHY
∧
−= ，對於矩陣
4nH × ， ()4rankH = ，經由 Gram-schmidt正交化過程可得矩陣 (4)nnP −× ， 
使得 0PH = ，且 4
T
nPPI −= 。故可以得到一nn× 矩陣 
1() TTHHH
U
P
−
=−−−−−−−

        (3.11) 
其中， ()rankUn = 。線性轉換U 將n 維的量測空間Y 分離成 4維的狀
態空間(State Space)和 n-4維的同位空間(Parity Space)，如下: 
1() TT LSHHHX
UYY
Pp
∧
−  =−−−−−−=−−   
       (3.12) 
方程式下半部為一(4)1n×× 向量p ，p 稱為同位向量(Parity Vector)。
而P 的每列互相正交，長度為 1，與H 的每一行互相正交。由上式得 
 
()pPYPHXePHXPePe==+=+=   (3.13) 
由於 ()rankUn = ，且 
()
||
TT
TT
HHH
UHPHP
P

=−−−−−− 

 
11()()TTTTT
T
HHHHHHHP
PHPP
−−= 

 
4
4
0
0 nn
I
I
I −
==

 
 
 21 
44nnnnHQR×××=  
然後，矩陣P 就等於矩陣 TQ 最底下 n-4列。 
3.2.3 FDE(Fault Detection & Exclusion)演算法[2] 
FDE 演算法利用贅餘衛星資訊，經由觀察虛擬距離，對 GPS 導
航系統提供完整性監控(Integrity Monitoring)的能力。FDE演算法是由
偵測(Detection)衛星失常與排除(Exclusion)失常衛星兩部份所組成；
偵測衛星失常的方法即為上述之最小平方剩餘法 (Least Square 
Residual Method)與同位法(Parity Method)。其中，同位法在判斷與排 
除失常衛星方面提供一個有用的幾何概念。因此，本節延續同位法討 
論排除失常衛星的方法。 
 
由第三章介紹的同位法中，可以歸納出下列幾個重要結果: 
(1)由 TTppwwSSE (參閱(3.16)式)，可以得到同位向量p 與誤差平 
   方和(Sum of Squared Errors ; SSE)之關係。 
(2)若要求(3.11)式中的轉換矩陣P ，可以對矩陣H 做正規化 QR分解 
  (Normalized QR Decomposition)[32]，使HQR ，其中 TQQI  ，R  
  為上梯形矩陣。因此 TTQHQQRR ，而矩陣R 的底下 n-4 列均
為 0。矩陣P 就等於矩陣 TQ 最底下 n-4列，可使 0PH  。 
(3)當衛星發生故障時，同位向量可以表示為 ()pPYPHXBe==++  
  上式中，Y 為測量值，P 為轉換矩陣。當P 將Y 映射至p 時，只 
 23 
向量之行向量，此行向量對應的衛星即為發生失常的衛星，因此進而 
排除發生故障的衛星。圖 3.2為模擬位於松山機場(北緯 25度 04分 
17秒，東經 121度 32分 36秒)位置下可收到 6顆衛星，且編號 3號 
的衛星發生故障並考慮所有的誤差项。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 3.2 同位向量表示圖(松山機場) 
 
 
 
 
 
 
 
 
 
 
 
 25 
YHXB=+    (0,0, ,0) TiBb=       (3.17) 
經由最小平方法求解可得其解的誤差為 
  1() TTLSxeXXHHHYX
∧
−=−=−  
  1()()TTHHHHXBX−=+−  
  11()()TTTTXHHHBXHHHB−−=+−=  
令 1() TTAHHH −= ，可得 
1112111
2122222
3132333
4143444
0
0
nii
nii
x i
nii
nii
AAAAbe
AAAAbe
eAB b
AAAAbe
AAAAbe

 
 
 ====
 
   






 
由上式可得 
水平誤差 22222222121212 iiiiiiieeAbAbbAA=+=+=+    (3.18) 
由(3.18)式可以得知水平誤差和偏移誤差呈線性關係。 
另外，由(3.2)，(3.5)和(3.17)式可得 
[ ]
[ ]
1
1
11
1
()
  ()
  ()()
  ()
  
TT
TT
TTTT
TT
wYYIHHHHY
IHHHHHXB
HXHHHHHXIHHHHB
IHHHHB
IQB
∧
−
−
−−
−
=−=− 
=−+
=−+− 
=−
=−

 (3.19) 
再由(3.3)和(3.19)兩式可得 
 27 
    
圖 3.3水平誤差與 /(4)SSEn −     圖 3.4水平誤差與 /(4)SSEn −  
(保護半徑<警報極限)             (保護半徑>警報極限) 
 
現在考慮見六顆衛星，如圖 3.5所示。假設斜率最大的衛星發生
失常，則相對應的軌跡線必須在臨界點之下，才能符合性能規格。 
 
 
 
 
 
 
 
 
 
圖 3.5 水平誤差與 /(4)SSEn − (所有可見衛星) 
 
斜率最大軌跡線的保護半徑稱為近似保護半徑誤差(Approximate 
Radial-error Protected ; ARP)。因此，如果一衛星幾何的 ARP大於警 
報極限，就可能發生水平誤差超過警報極限，而警報訊號卻未能在警 
報時間內發出的情況，這個無法容許的衛星幾何必須刪除。由圖 3.4 
及(3.22)式，可以得到(3.23)式，以求取近似保護半徑誤差(ARP)之值。 
 29 
                          
                 第四章 
                                            
GPS自主完整性監控之 H∞ 濾波器設計 
 
GPS自主完整性監控之 H∞ 濾波器設計將在本章中說明，包含定
位方程式之狀態空間模型、強健控制系統模型與結構、以及使用線性
矩陣不等式進行 H∞ 控制器設計。 
 
4.1 GPS定位方程式之狀態空間模型 
設計 H∞ 濾波器應用於 GPS自主完整性監控，首先要務是建立適
當的 GPS定位方程式之狀態空間模型，也就是 GPS定位之狀態方程
式與量測方程式。 
 
 GPS定位之狀態方程式 
要進行定位作業前，都需先將待測目標的動態，用一個適當的狀
態方程式或模型加以描述，以做為待測目標之動態程序。當我們對物
體作靜態定位時，僅須考慮物體的相對位置及時間關係即可，通常是
以位置模型（Position Model；P Model）來表示。若對行進間的待測
物體作動態定位，則需要再加入物體的運動速度作為參數，而行進間
物體的系統描述，一般是以位置-速度模型（Position-Velocity Model；
 31 
(1)()()()PPPPPxkAxkBdkFfk+=++     (4.3) 
(1)()()()PPPPPykCxkDdkHfk+=++     (4.4) 
同樣的， Px 是狀態變數向量， Py 是量測輸出向量， PA 、 PB 、 PC 、 PD 、
PF 與 PH 是相對應的實係數矩陣，d 是雜訊或擾動向量，f代表造成衛
星失常的誤差向量(Fault Vector) 或偏移誤差(Bias Error)，通常為步級
(Step Function)或斜坡函數(Ramp Function)。 
4.2 強健控制理論簡介 
在實際問題當中，我們遇到的系統都是如圖 4.1所示的類型。不
論雜訊、擾動、不確定性、誤差，都是無時無刻存在的。因此，要想
得到系統和外界干擾的精確數學模型是不太可能的。而控制系統在擾
動下保持自身穩定性的能力，就被稱為控制系統的強健性。 
 
 
 
圖 4.1一般系統連接圖 
 
Disturbance 
Other Controlled Signals  
Uncertainty Uncertainty 
Noise 
Controller Reference Signals  
System Interconnection 
Tracking Errors 
 33 
描述： 
12
11112
22122
(1)()()()
:()()()()
()()()()
xkAxkBwkBuk
GzkCxkDwkDuk
ykCxkDwkDuk
 +=++
 =++
 =++
     (4.5) 
其中： nxR∈ 是狀態向量， muR∈ 是控制輸入信號， pyR∈ 是量測出
輸出， rzR∈ 是包含被控信號和追蹤誤差的輸出信號向量， qwR∈ 是
包含所有雜訊擾動的輸入信號向量，這裡考慮的外部擾動是不確定
的，但具有限能量，即
2wL∈ 。A 、 1B 、 2B 、 1C 、 2C 、 11D 、 12D 、 21D 、
與 22D 是相對應的實係數矩陣，K(z)是控制器的轉移函數，由以下狀
態空間描述： 
(1)()() CCkAkBykξξ +=+         (4.6) 
()()() CCukCkDykξ=+          (4.7) 
其中： CnRξ ∈ 是控制器的狀態， CA 、 CB 、 CC 和 CD 是待確定控制器的
參數矩陣。 
 
 在強健控制系統理論中，系統模型經常表示如下: 
()
AB
Gz CD

= 

          (4.8) 
因為是雙埠系統模型（Two-Input；Two-Output Model），所以可以將
(4.5)式改寫成 
 35 
  
[ ]
2221221
221
112212111221
       
   
CCC
clcl
CCC
clCCclC
ABDCBCBBDD
AB
BCABD
CCDDCDCDDDDD
++==

=+=+
    (4.11) 
 
將控制器中待定的參數矩陣集中在一起，也就是 H∞控制問題中最終
要確定的矩陣。 
: CC
CC
AB
CD
Θ= 

      (4.12) 
為了簡化表示方式，引入一些矩陣如下: 
[ ]
[ ]
1
0001
2
1212
2
21
21
0
          0
000
00
   0
00
0
AB
ABCC
IB
D
CI
D
===
===  
= 

BCD
D
    (4.13) 
這些矩陣可由系統模型(4.5)中的係數矩陣得知，閉迴路系統各個係數
矩陣可以表示成： 
Acl = A0 + BΘC    Bcl = B0 + BΘD21 
Ccl = C0 + D12ΘC  Dcl = D11 + D12ΘD21        (4.14) 
顯然，這些閉迴路系統的係數矩陣都表示成了控制器 K中參數矩陣
的仿射(Affinely)函數，接下來介紹兩個重要的引理。 
 
引理 4.1 
 37 
路系統 γ<∞wzT 的充份必要條件為存在一對稱且正定矩陣 clX ，使得 
1 0
0
0
0
0
clclcl
TT
clclcl
T
clcl
clcl
XAB
AXC
BID
CDI
γ
γ
−−
 − < −
 −
   (4.18) 
利用先前提及的簡化符號(4.12)、(4.13)與(4.14)，矩陣不等式(4.17)
可以進一步表示成 
0
cl
TTT
X QQΨ+Θ+Θ< PP       (4.19) 
其中 
1
00
00
011
011
0
0
0
0
cl
cl
TT
cl
X TT
XAB
AXC
BID
CDI
γ
γ
−−
 −Ψ=  −
 −
      (4.20) 
12
212
00000
00
0000
TT
TT
I
BD
==  
PBD    (4.21) 
[ ]21
221
00000
00
0000
I
Q
CD
== 

CD    (4.22) 
因此，H∞控制器存在問題轉化成了一個等價的純代數問題。根據引
理 4.1這樣的矩陣不等式是可行的(Feasible)若且為若 
0;
cl
T
XWWΨ<PP  0cl
T
XWWΨ<QQ      (4.23) 
其中：WP 和WQ 分別是由核空間 ker(P)和 ker(Q)的任意一組基底作為
行向量構成的矩陣。這樣，具有兩個矩陣變數 clX 和Θ 的矩陣不等式
(4.19)的可行性問題轉化成了等價的兩個只含有一個矩陣變數 clX 不
 39 
                                                                   
                                   第五章 
                                            
GPS自主完整性監控系統套裝軟體設計、模擬、分析 
 
在本章中，我們將利用三、四章所介紹的理論，整合設計出一套
自主完整性監控系統，提供靜態、動態的自主完整性監控的功能，並
考量友善、方便操作、美觀的人機介面加以整合。詳細的設計、模擬
與分析結果將在本章中說明。 
 
5.1 GPS自主完整性監控系統介紹 
本監控軟體是在Matlab的環境下所發展設計的，Matlab是由美國
Mathworks 公司於 1984 年所推出的一套軟體，可相容於微軟視窗系
統與其他電腦系統，對於數值分析、矩陣運算、繪圖模擬皆有十分傑
出的表現。本監控軟體主要功能為 GPS 自主完整性監控，對於靜態
與動態定位下，當有衛星發生故障的情況發生時，能針對故障的衛星
進行偵測與排除，提供所監測時空點的衛星資訊並記錄所發生的事件
歷程與時間。在系統介面的設計上我們使用 Matlab 的圖形使用者介
面(Graphical User Interface；GUI)觀念撰寫，並考量使用者操作上的
需求與便利，進行相關系統介面之開發設計。 
 41 
5.2 快照式 GPS自主完整性監控系統設計、模擬、分析 
快照式 GPS自主完整性監控系統的設計是以同位法為基礎，整合 
FDE 演算法與近似保護半徑誤差法構成了 GPS 系統中接收機自主完
整性的功能，圖 5.2為快照式 GPS自主完整性監控系統主監測畫面。 
 
圖 5.2快照式 GPS自主完整性監控系統主監測畫面 
進入快照式 GPS自主完整性監控系統主監控畫面後，系統會自動
監測所儲存的衛星訊息，並將監測的資訊動態顯示於畫面的顯示區，
也就是主監測畫面的下方白色的區域，衛星分佈狀態圖與同位向量圖
則會以動態的方式顯示於主監測畫面的上方，而畫面的右手邊則為介
面的操作區，能獨立顯示與紀錄衛星故障的事件歷程與時間紀錄。 
 
快照式 GPS自主完整性監控系統顯示區，顯示了各種不同監控相
 43 
5.2.1 模擬結果與分析 
模擬過程中所使用的模擬訊號是在隨意假設的衛星之模擬虛擬
距離上加入一個偏移誤差(Bias Error)，用來模擬衛星發生故障。虛擬
距離的偏移誤差會造成水平誤差，也會反映到用來判定衛星是否失常
的決定值( /(4)SSEn − )上，在接下來的模擬分析中，我們模擬了一些
不同的狀況並測試快照式 GPS自主完整性監控系統是否能正常的偵
測、排除故障衛星、顯示與記錄事件。 
 
我們設定了兩種不同的事件來對快照式 GPS自主完整性監控系
統進行模擬測試，模擬 Case 1主要是測試系統對於故障衛星的偵測、
排除與事件記錄，模擬 Case 2則加入無法容許(Inadmissible)的衛星幾
何的時空點，對系統進行測試。 
 
 模擬 Case 1 
在 Case 1模擬情境上我們模擬衛星編號 3號的衛星發生故障，將
所對應的虛擬距離加入一個 500公尺的偏移誤差，作為虛擬距離的模
擬訊號，整個模擬時間為 0到 7200秒(GPS time of week in seconds)，
監控時間的間隔為 600秒並於 3600秒後加入偏移誤差，而模擬訊號
中衛星的數量皆大於 6顆衛星以便進行故障衛星的偵測與排除，衛星
數量大約是在 8-9顆之間變動，模擬的時空點也不會有無法容許的衛
 45 
 
 
 
 
 
 
 
 
 
 
 
圖 5.5 監測結果顯示畫面 
從監測畫面與時間資訊、監測結果顯示畫面中可得知編號 3號的
衛星在 3600秒(GPS time of week in seconds)以後發生了故障，監測畫
面於衛星分佈圖中，系統會用鮮綠色的星號標示出故障的衛星，而時
間資訊也記錄了發生的時空點，當時並無衛星顆數不足與無法容許的
衛星幾何發生，監測結果顯示畫面也記錄了編號 3號的衛星發生故
障，由監測系統所記錄與顯示的資訊都和模擬假設的情況一致，表示
監測結果能如預期偵測出衛星的異常狀態。 
 模擬 Case 2 
在模擬Case 2的模擬情境上我們同樣是模擬衛星編號 3號的衛星
發生故障，我們將對應的虛擬距離同樣加入 500公尺的偏移誤差作為
模擬訊號，模擬時間同樣為 0到 7200秒(GPS time of week)，間隔為
600秒並於 3600秒後加入偏移誤差，而模擬訊號中衛星的數量在 1200
秒時衛星數量為 3顆，其餘時空點皆為 6顆以上，並在時間點為 1800
 47 
 
 
 
 
 
 
 
 
 
 
 
圖 5.8監測結果顯示畫面 
 
由於我們事先假設在 1200秒與 1800秒時有衛星數目不足與無法
容許的衛星幾何的時空點發生，在時間資訊與監測結果顯示畫面中發
現確實能將這兩個事件資訊記錄下來，而在 3600 秒後，3 號衛星故
障的資訊也能正確的記錄與顯示，可驗證監測系統所記錄與顯示的資
訊皆和所模擬假設的情況一致。 
 
此外、此監控程式還提供了獨立的衛星運動軌跡的動態顯示視
窗，可顯示所有動態衛星的衛星編號以方便使用者監看衛星運動的軌
跡與狀態，如下圖 5.9所示。 
 
 
 
 
 
 
 49 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 5.10排除故障衛星之前 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 5.11排除故障衛星之後 
 51 
K 
G 
w 
u 
z 
y 
           
圖 5.13 轉化後濾波器結構圖 
經由轉換後，目標是希望最小化最壞(worst case design)的估測誤差 e
在有限能量(bounded energy)的外部輸入信號 w下，也就是  
2
2
20
minsup L
wL
Lw
e
w∈
≠
 [ ]Twdf=  
在工程上應用時，我們希望估測誤差 e小到某一個可以接受的範
圍，這等同於次佳的 H∞ 控制問題(Suboptimal H∞ Control Problem)，
目的是設計一個濾波器uKy= ，使得整個閉回路系統滿足下列性質，
如圖 5.14所示: 
 
 
 
 
 
圖 5.14 H∞ 控制器設計問題  
 整個閉迴路系統是內部穩定(internally stable)的。 
f 
d P 
K 
r 
y 
+ 
- 
e 
 53 
5.3.1 模擬結果與分析 
離散化後的 GPS自主完整性監控問題以狀態空間模型描述，可表
示如下 
(1)()()()PPPPPxkAxkBdkFfk+=++       (5.1) 
(1)()()()PPPPPykCxkDdkHfk+=++       (5.2) 
狀態變數向量 Px 包含了 x軸方向、y軸方向、z軸方向的位置、速度、
加速度和時鐘偏移等共十個狀態變數， Py 是量測輸出向量，d 是雜訊
或擾動，f代表造成衛星失常的誤差(Fault Vector)或偏移誤差(Bias 
Error)。 
其中 
-5
-5
-5
0.990.015100000000
00.990.010000000
000.990000000
0000.990.015100000
00000.990.010000
000000.990000
0000000.990.015100
00000000.990.010
000000000.990
0000000000.99
PA
×



 ×

= 

 ×




 
 
555
555
0.897710.00455672.3244101.74640.00886444 .5217100.429760.00218141.1127102.0101
1.73090.00878584.4817100.969870.0049232. 5112100.321820.00163358.3325102.0101
0.812280.004123
PC
−−−
−−−
−−×−×−×
−−×−−×−−×
−
=
555
555
5
2.1032101.34560.00682993.4839101.25330.0 0636163.2451102.0101
0.79580.00403942.0605100.970480.0049262. 5128101.57030.00797064.0658102.0101
1.33670.0067853.461100.389560.0
−−−
−−−
−
−×−−×−−×
−−×−−×−×
−−×− 55
555
56
0197731.0086101.44990.00735953.7541102.0 101
1.13370.00575452.9354100.601420.00305271 .5572101.5470.00785234.0054102.0101
1.86360.009459524.8252100.25930.00131626 .7139100.7
−−
−−−
−−
×−×
−−×−×−−×
−−×−−×− 5
555
07560.00359151.832102.0101
0.448650.00227731.1617101.01690.00516172 .633101.67480.00850124.3365102.0101
−
−−−









 −×
−−×−×−−×
 
 55 
5
5
6
6
6
6
6
6
5
5
2.616910
3.110410
5.23310
7.476610
1.569710
7.468210
1.166910
6.022710
1.666310
1.49710
T
KC
−
−
−
−
−
−
−
−
−
−
−×
 ×
−×
−×
−×
= 
−×
−×
−×
 ×
−×
 
1
0.22534
0.47852
0.12627
0.68316
0.32912
0.025466
0.53985
T
KD




−= −
−
−

−
 
 
造成衛星失常的偏移誤差(Bias Error)我們以步級函數(Step func-
tion)作為模擬與測試的標準，如圖 5.15 所示。另外，隨機擾動訊號
(Disturbance)的期望值為 0(Zero Mean)且變異量為 1(Unitary 
Variance)，如圖 5.16所示。 
以收到 8颗衛星為前提，將量測輸出投入到所設計的 H∞濾波器，
H∞濾波器偵測結果與估測誤差如圖 5.17、5.18 所示。我們希望所設
計的 H∞濾波器能正確的將造成衛星失常或錯誤的偏移誤差偵測出
來，以便對於造成衛星失常的誤差給予排除或孤立，由模擬結果中發
現我們所設計的 H∞濾波器能符合性能要求，順利的偵測出造成衛星
失常的誤差信號。此外；系統的最佳 H∞性能指標值標是
52.203610optγ −=× ，也能符合需求。 
 57 
 
圖 5.18 H∞濾波器偵測結果 
 
 
圖 5.19估測誤差 
 59 
 
圖 5.22 z(t)-狀態軌跡 
 
 模擬結果中，也呈現 x(t)，y(t)、z(t)等狀態變數隨時間變化的軌
跡，如圖 5.19、5.20、5.21，如同預期；因為是加速度為一定值，所
以狀態變數的軌跡呈現如二次曲線一般。 
 
 
 
 
 
 
 61 
方法不僅能偵測出位置誤差，對於速度或加速度誤差皆可以正確的偵
測。 
 
RAIM或 FDE建基於統計之檢測原理，每一筆數據都獨立處理。
濾波器式的資料處理，不僅考慮了此刻的數據，過去的數據也以適當 
的權數發會影響力，可以得到較周全的判斷。此外；這樣的方法對於
位置變化或速度變化較大的高動態狀況，應可以應用於提高定位精
度，對於衛星導航系統等相關應用，具有改善傳統接收機受到高動態
狀況影響的缺點，期盼我們這段時間的研究成果，能對今後的完整性
問題能有所貢獻。 
 
 
 
 
 
 
 
 
