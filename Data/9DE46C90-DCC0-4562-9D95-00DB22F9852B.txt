 Abstract 
The development of Swallow small UAV system includes three major phases. The first phase 
focuses on the design and stability analysis of the aircraft. The second phase focuses on the 
compact avionics system development and integration. And the third phase focuses on formation 
flight capability development. This report will fully cover the overall development process of 
Swallow UAV system. The work of the first phase includes the air vehicle design, low Reynolds 
numbers wind tunnel test, flights stability analysis and flight test of Swallow UAV. The air 
vehicle is designed based on historical data and experimental equations. Wind tunnel and flight 
tests have been conducted to refine the design results. Two different configurations, including the 
flying wing and conventional configurations are considered. The configuration finally decided 
upon was a pusher-type electric motor driven aircraft with a 1.4 meter wing span. The work of 
the second phase includes the development of the avionics system and the hardware-in-the-loop 
simulation environment (HILSE), inner loop attitude controller development/verification and 
flight test to verify these designs. The avionics system, combines onboard computer (OBC) with 
global positioning system (GPS), attitude heading reference system (AHRS), and pressure 
altitude/airspeed sensor, is developed to provide position, velocity, and attitude data, and 
transmits data to ground control station (GCS) or other UAV via wireless modem. The HILSE is 
a modified avionics system for simulation purpose. The OBC is the same, but sensor data are 
distributed from X-Plane flight simulator. The attitude controller, combining GPS velocity based 
pseudo attitude (PA) and fuzzy logic controller (FLC) is developed. The work of the third phase 
includes the development of trajectory tracking capability of the leader aircraft and formation 
flight capability of the wingman aircraft, and the corresponding flight test verification. FLC based 
navigation system is also developed. An experiment procedure is designed to make sure the 
aircraft will not collide with each other during flight test. The flight tests have assured that the 
current version of Swallow UAV has good flight stability with a sufficiently light weight and 
reliable avionics system, and the attitude controller with navigation system has sufficient 
performance for formation flight demonstration. In 2011/6/30, the two UAVs autonomous 
formation flight demonstration took place in the open ground near Si-Gang Bridge and the results 
showed that the Swallow UAV system is capable of performing formation flight mission.  
Problems of the current system are discussed and the possible solution, the vision based 3-D 
positioning method, is described. 
 
Keywords: Small UAV, Avionics Design, Hardware-In-the-Loop simulation, Pseudo Attitude, 
Fuzzy Logic Control, Formation Flight, Image Processing, Image Positioning 
 
中文摘要 
飛燕(Swallow)小型無人飛行載具系統的開發主要可分為三階段，第一階段著重於載具
的設計與分析，第二階段為微型化航電的開發與整合，第三階段為自主導航與編隊飛行控
制律的開發。本報告將涵蓋飛燕(Swallow)小型無人飛行載具系統之開發全部過程。第一階
段之工作包含飛燕(Swallow)小型無人飛行載具系統的載具設計，低雷諾數風洞實驗驗證，
以及試飛。第二階段之工作包含微型化航電以及硬體迴路模擬系統開發，姿態穩定控制器
開發與驗證，以及試飛驗證。航電設計部份結合機載電腦與 GPS、姿態航向參考系統、高
度計與空速計，提供姿態、位置與控制量等等資訊，並利用無線資料傳輸模組將資訊傳遞
至地面站或其他無人飛機。硬體迴路模擬系統修改原來的微型化航電，作為模擬之用。其
利用 X-Plane 飛行模擬軟體提供感測器資訊給機載電腦，控制於其中的飛機。姿態穩定控
制器結合虛擬姿態以及模糊控制，維持飛機於指定姿態飛行。第三階段之工作包含長機之
飛行路徑追蹤與僚機之編隊飛行功能開發，並經由一系列實驗確保兩架無人飛機之編隊飛
行實驗當中不會發生空中碰撞。經由試飛結果，Swallow 無人飛機系統具有良好的飛行穩
定性，可靠且輕量的航電系統，其姿態穩定控制器與導航系統之性能足以進行編隊飛行。
編隊飛行之功能展示於 2011/6/30 完成，實驗結果顯示 Swallow 無人飛機系統可以進行編隊
飛行之任務。然而實驗結果也顯示一些目前系統不足之處，針對這些不足之處，我們進行
影像定位技術之研究，已有初步成果。 
 
 acquire the position information of the leader aircraft. The image positioning algorithm is tested 
on HILSE. The simulation results show the algorithm is capable of estimate the position of the 
leader aircraft. 
 
2. Air Vehicle Design 
In order to support multiple aircraft flight test, every single aircraft should be simple and 
reliable enough, so the maintenance and repair requirement can be minimized. 
Internal-combustion engine needs breaking-in and lots of maintenance to achieve high reliability, 
therefore not a suitable choice. The electric motor, on the contrary, is almost plug-and-play 
without the breaking-in process, so it is selected as the propulsion system. 
Flying wing configuration prototype was first designed and flight tested (SW-X1, Fig. 1 (A)), 
SW-X2, Fig. 1 (B)). This design only has a main wing and a fuselage, and therefore it is light 
weight and simple for assembly. However, the stability is a big problem. The flying wing aircraft 
is highly sensitive to the location of the center of gravity (C.G.). But as specifications shows in 
Table 1, the length of 1% mean aerodynamic cord (MAC) is 3 millimeters. That means several 
millimeters change of the C.G. location will change the handling quality significantly. It leads to 
poor lateral stability under crosswind and landing and high crash rate. 
Conventional configuration, on the other hand, is much less sensitive to the C.G. location. A 
prototype (SW-X3, Figure 1(C)) was made to confirm the handling quality and payload capacity 
of the second design. The final decision is a twin boom aircraft with a 1.4 meter wingspan. The 
mold fabricated version of the prototype (SW-3A1~4) is shown in Figure 1(D). The parameters of 
them are listed in Table 1. The detailed design procedure is described in following sections. 
 
Figure 1. Flying wing (A, B) and twin boom (B, C) configuration of Swallow UAV 
 
Table 1.  Parameters of Swallow UAV 
Aircraft SW-X1 SW-X2 SW-X3 SW-3A1~4 
Configuration Flying Wing Flying Wing Twin Boom Twin Boom 
Maximum Takeoff Weight (kg) 1.0 2.0 2.9 2.8 
Main Wing Airfoil MH-60 MH-60 SD-7032 SD-7032 
Main Wing Reference Area, refS  
( 2m ) 
0.255 0.39 0.39 0.35 
Main Wing AR 2.8 3.7 5 5.6 
Main Wing Span (m) 0.84 1.2 1.4 1.4 
Propulsion 200W Motor 350W Motor 350W Motor 350W Motor 
 
2.1 Design of Swallow-SW-X1 
The design of Swallow UAV includes conceptual design, preliminary design, wind tunnel test, 
prototype flight test, and design modification and test. Conceptual design determines the main 
configuration of the aircraft. Preliminary design determines the parameters of the main parts of 
the aircraft. Prototype flight tests and wind tunnel tests are made to verify the results evaluated 
from preliminary design which may have large error because of low Reynolds number effect. The 
modifications are made by wind tunnel tests and flight tests. If the tested prototype meets the 
requirement, production will be made for 4 aircraft. Here we take the design procedure of SW-X1 
as example. The design procedure of SW-X2~3 are similar but focus on solving the existed 
problem. 
(C) (B) (D) (A) 
 Part Part Weight (g) 
11.1V battery (avionics) 154 
11.1V battery (power) 154 
Brushless ESC (18A) 30 
Motor and Propeller 60 
Receiver (PCM 6Chennel) 20 
Servo (GWS NARO) 20 
Camera +Transmitter  50 
WM (AC4790) 44 
ARM OBC 110 
GPS 130 
Other Sensors (estimated) 300 
Structure 350 
Total 1422 
 
2.3.2 Wing Loading and Power Loading 
From series of SUAV developed by Aero Vironment including Pointer, Dragon Eye, and Raven, 
the wing loading falls in the range of 60~ 80 Newton per square meter , and the power loading 
falls in the range of 7 ~ 12 Watt per Newton. The wing loading value 60 Newton per square meter 
is chosen since Swallow is lighter and will be smaller than above aircrafts. The motor is 
determined as a 200 Watt brushless motor since the power loading reaches 14 Watt per Newton 
and it is easy to purchase. 
 
2.3.3 Airfoil Determination and Wing Geometry 
The preliminary data is simulated by CFD software “Profili” in Figure 5. Three airfoils are 
chosen with “MH-60, E182, and Zagi-10” by the flying type of airfoils because of highly lift to 
drag ratio (L/D) and small value of moment coefficient (CM) which is suitable for flying aircraft 
design. The airfoil is selected as MH-60 because of the easier fabrication of the airfoil section in 
the consideration of preliminary design, however, the finally selection of the airfoil will be 
decided by the results of wing tunnel tests. The parameters of the main wing is determined by 
wing loading and makes the dimensions of tip chord, wing span, and the chord jointed with 
fuselage as integer centimeter for easy fabrication. The swept angle is determined as 15° to have 
reasonable vertical stabilizer mount. Static margin is set to 6%, which is 1.86 centimeter before 
aerodynamic center. 
  Capacity of Battery  Nominal Voltage 2 3600 11.1 79920batteryE A s V J       (4) 
batteryE  is the total energy of the battery. For a certain velocity, cruiseV , as an example, 17 meter 
per second, the drag, cruiseD , power requirement, cruiseP , and endurance, cruiset , are as following: 
1.525 17 43.20.6 0.6
cruise
cruise cruise
DP V W      (5) 
1850 30minbatterycruise
cruise
Et sP    (6) 
This result, however, is too optimistic compare to real case. The endurance will be determined 
by flight test. 
 
2.4 Wind Tunnel Test 
2.4.1 Experimental Facilities 
A low-speed open-type wind tunnel shown in Figure 6 is used for conducting the aerodynamic 
experiments in the present study. The wind tunnel has a test section of 0.914 × 1.20 m2 in cross 
section with the operating stable speed ranges between 5.0 and 30.0 m/s in the test section, where 
the maximum turbulence level of the free stream is less than 1.5%. 
 
Figure 6. Low Speed Open Type Wind Tunnel 
 
A six-component force balance of strain-gage type was adopted to measure the aerodynamic 
lift, drag and side force and pitch, roll and yaw moments which the full scale is respectively 5.0 
kg, 3.0kg and 3.0kg in lift, drag, side force and 0.3 kg-m, 0.3 kg-m and 0.2 kg-m in pitch, roll and 
yaw moments in measurements. The output electronic signals were fed to a personal computer 
(PC) via a 12-bit Analog/Digital (A/D) converter. All experimental data were stored and analyzed 
in the PC too. 
 
2.4.2 Experiment 
The wind tunnel tests are conducted to verify and modify the aerodynamics characteristics of 
flight performances of vehicles designs, especially to consider the length scales and flight speeds 
of Swallow UAV, the small UAV commonly encounter a combined aerodynamic issues: low 
aspect ratios airplane flies at low Reynolds numbers. Since experimental and numerical 
aerodynamic data is still insufficient for the design, more detailed investigations regarding the 
application of small UAV scaled wing aerodynamics are necessary for understanding [15][16][17]. 
The procedures of wind tunnel tests are separated by two parts of works. One is the three airfoil 
aerodynamic performances modify tests and the other one is the fully scale Swallow UAV model 
test with static six degree of freedom. 
The three airfoil aerodynamic performances modify tests put three wing models, “Zagi-10, 
MH-60 and E-182”, into experiment for basic aerodynamic force and moment measurements. In 
order to catch the points of Swallow UAV wing design, all wing geometries are the same: The 
  
Figure 8. Fully Scale Swallow-UAV Model 
 
Figure 9. Lift and Drag Coefficients of Fully Scale Swallow UAV Model 
CM vs. AOA
-1.6
-1.4
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
-15 -10 -5 0 5 10 15 20 25
AOA
CM
CM at 30.75cm
CM at 22.75cm
CM at 23.75cm
 
Figure 10 Pitch Moment at Different C.G. Location of Swallow UAV 
 
2.5 Prototype Flight Test and Design Modification 
SW-X1 is made to prove the preliminary design. It is fabricated by Styrofoam and balsa wood, 
and hardened by ABS board and carbon fiber sticks. From flight test results, the longitudinal 
stability is sufficient but lateral stability is suffered from vertical stabilizer structure problem. The 
MTOW reaches 1.1kg only, which is much lower than requirement. The modified aircraft, 
SW-X2 is made by balsa wood and composite material for better strength. The wing is enlarged, 
and MTOW grows to 2kg. The aircraft can carry all the required component of the onboard 
avionics system described in later chapter, but the lateral stability is not sufficient at low speed 
when landing. SW-X3 is redesigned as conventional configuration. The MTOW increased 
gradually to 2.9kg because the horizontal and vertical stabilizer, but the stability is good and the 
landing is smooth. This configuration is finally mold fabricated as SW-3A1~4, and the three-view 
of it is shown in Figure 11. 
CL vs. AOA
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
1.2
-10 -5 0 5 10 15 20 25
AOA
CL Re=150000
Re=100000
CD VS. AOA
0
0.1
0.2
0.3
0.4
0.5
0.6
-10 -5 0 5 10 15 20 25
AOA
CD Re=150000Re=100000
  
Figure 12. Onboard Avionics System and Ground Control Station Architecture of Swallow 
UAS 
 
3.2.1 Onboard Computer 
Due to the limited size and payload capacity of the Swallow UAV, the onboard avionics system 
has to be light weight and small size. A commercial ARM9 evaluation board is chosen as OBC 
(Figure 13). This board has integrated all the necessary I/O with small size, and the low power 
requirement dramatically reduces the weight of the onboard avionics system because the size and 
weight of the power supply and battery are reduced. The total weight of the integrated avionics is 
about 600g with battery. The operation system of ARM OBC is Embedded Linux. The coding is 
based on Crossbow MNAV 1.5 [8] but modified to multi RS-232 port operation. 
Table3. Specifications of OBC 
Microprocessor Samsung® S3C2440A 
ROM 2MB NOR Flash, 256MB NAND Flash 
RAM 64MB SDRAM 
I/O 
100Mbps Ethernet interface X1, USB HOST X1, USB DEVICE X1, Audio In X1, Audio Out 
X1, SD Card X1, UART X2, LCD Port X1, 44 Pin GPIO X1, JTAG X1 
Power 5V 
 
 
Figure 13. ARM OBC 
 
3.2.2 Sensor System 
The sensor system is composed of different sensors and a servo and sensor I/O board (SIOB) to 
integrate the data of them into RS-232 protocol. 
The sensors include GPS, IMU, air data sensor, and motor monitoring unit (MMU). The 
u-blox® LEA-5H GPS smart antenna (Figure 14) provide 4Hz geodetic position, velocity and 
 Figure 14. GPS Smart Antenna with Power Level Convert Board (From Left to Right) 
 
Table5. Specifications of Xsens® MTi 
Rate of Turn Dimensions 3 axes 
Rate of Turn Full Scale +/- 300deg/s 
Rate of Turn Linearity 0.1% of Full Scale 
Rate of Turn Bias Stability 1deg/s  1  
Rate of Turn Noise Density 0.05 deg/s/ Hz  
Rate of Turn Alignment Error 0.1deg 
Rate of Turn Bandwidth 40Hz 
Acceleration Dimensions 3 axes 
Acceleration Full Scale +/- 50 2/m s  
Acceleration Linearity 0.2% of Full Scale 
Acceleration Bias Stability 0.02 2/m s  1  
Acceleration Scale Factor Stability 0.03%  1  
Acceleration Noise Density 0.002 deg/s/ Hz  
Acceleration Alignment Error 0.1deg 
Acceleration Bandwidth 30Hz 
Magnetic Field Dimensions 3 axes 
Magnetic Field Full Scale +/- 750mGauss 
Magnetic Field Linearity 0.2% of Full Scale 
Magnetic Field Bias Stability 0.1mGauss 
Magnetic Field Scale Factor Stability 0.5%  1  
Magnetic Field Noise Density 0.5 deg/s/ Hz  
Magnetic Field Alignment Error 0.1deg 
Magnetic Field Bandwidth 10Hz 
Digital Interface RS-232, USB 
Power 4.5V-30V 
Outline Dimensions 58x58x22mm(W x L x H) 
Weight 50g 
 
 
 
Figure 15. Xsens® MTi 
 
Table6. Specifications of MicroStrain® 3DM-GX3™-25 OEM 
  
 
Figure 17. Air Data Sensor 
 
Table8. Specifications of MMU 
RPM Sensor Hyperion® HP-EM2-TACHBL 
RPM Sensor Signal Type 3.3V PWM 
Current Sensor Atto Pilot® DC Voltage and Current Sense PCB 
Current Sensor Full Scale 89.4A 
Current Sensor Maximum Input Power 51.8V 
A/D Converter Maxim® MAX11606 
A/D Converter Power 4.5V to 5.5V 
A/D Converter Resolution 10Bits 
A/D Converter Relative Accuracy ±1LSB 
A/D Converter Nonlinearity ±1LSB 
A/D Converter Offset Error ±1LSB 
A/D Converter Gain Error ±1LSB 
A/D Converter Full-Power Bandwidth 3MHz 
A/D Converter Full-Linear Bandwidth 5MHz 
Microcontroller Microchip® PIC18F2580 
 
 
Figure 18. RPM Sensor and Current Sensor, A/D Converter, and Microcontroller of MMU 
(From Left to Right) 
 
SIOB (Figure 19) is designed with three major functions. The first is acquiring the information 
of air data sensor and the MMU from Inter-Integrated Circuit ( 2I C ) ports, and decoding the pilot 
Pulse-Width Modulation (PWM) command signal from RC receiver (PWM Decoder), and send 
them out via one RS-232 port. The second is Serial Servo Controller (SSC) controlling RC servos 
by the commands from OBC via RS232 port. The third is switching modes between manual 
control and autonomous flight by hardware relay switches. Four control channels (aileron, 
elevator, throttle, and rudder) can be selected independently to be controlled by OBC or pilot. 
Table9. Specifications of SIOB 
 the transmitted power is set to 200mW. The onboard antenna is 2dB flat antenna taped on the 
fuselage. The antenna of GCS is 3dB omni-directional antenna with the transmitted power of 1W.  
Table11. Specifications of WM 
Wireless Modem Aerocomm® AC-4790 
Maximum Output Power 1W 
Data Rate 76800bps 
Power 3.3V to 5.5V 
 
 
Figure 21. WM 
 
The range of this setup can be estimated by applying two-ray model [21] for the case that the 
loitering leader transmits data to the wingman just taking off: 
     10 10 10dBm= dBm+10log +20log -40logr t l t rP P G hh d  (7) 
rP  is the receiver sensitivity. It is -70dBm from the manual of the AC4790. tP  is the 
transmitted power. In our case, 23.01dBmtP  . lG  is the product of transmitter and receiver 
antenna. Here we set 4lG  . th  and rh  are the height of the transmitter and receiver, 
respectively. For this case, 100th m  and 1.5rh m . d  is the horizontal distance between the 
two antennas, and the result is about 3.6 km. It is sufficient during in-visual-range operation of 
Swallow UAS. A data transmission sequence is designed to minimize the latency and dropout 
problems of wireless communication. This sequence is shown in Figure 22. The “Group1” is the 
position, velocity, time, and attitude data of the aircraft. The “Group2” is the airspeed, pressure 
altitude, and other onboard health information of the aircraft. With this data sequence, the 
package size will be smaller compare to sending all data together, therefore reduce the bit error 
rate of this wireless network, and the required navigation information of the leader aircraft will 
transmit to the wingman in top priority. 
 
Group1  Group2 Group1 Group2 
 
Figure 22. Data Transmission Sequences 
 
3.2.4 Onboard Image System 
Onboard image system includes a CCD camera and an image transmitter (Figure 23). The 
camera is mounted on the nose of the fuselage with a fixed -15° look down view. The 1.2 GHz 
image transmitter is used due to the less pass loss compare to 2.4GHz system and prevent 
interference with RC receiver. 
Table12. Specifications of Onboard Image System 
Camera CCD Sensor 1/3” Panasonic CCD 
Camera Power 12V DC 
Camera Lens Type Fixed 
0.2 sec 0.4 sec 0.1 sec 0.3 sec 0 sec 
 Image Station Image Grabber Card I/O 
Video In: AV, S-Video 
Digital Out: USB 
 
 
Figure 24. The Data Station (A), The Image Station (B), and The GCS Software Display (C) 
 
4. Leader Fuzzy Navigation and Control System 
The system architecture of the L – FNCS is shown in Figure 25 with inner-outer loop controller 
architecture. The inner-loop includes the attitude estimator and the attitude controller to stabilizes 
the roll and pitch angle. The outer-loop is the waypoint navigator to guide the aircraft toward the 
desired waypoints and the circle trajectory tracker to make the aircraft tracking the desired circle. 
 
Figure 25. Architecture of L – FNCS 
 
4.1 Attitude Estimation  
For a strap-down attitude heading reference system (AHRS) fixed in the aircraft, the y-axis 
acceleration will be distorted by the bank-to-turn motion and the roll angle result will be wrong 
[22]. An attitude estimation method using GPS velocity data produced pseudo-attitude and 
integrated with gyroscopes is developed for Swallow UAS. 
 
4.1.1 Pseudo-Attitude 
The pseudo-attitude is first introduced by R. P. Kornfeld et al. as backup attitude data source 
for general aviation aircraft [23]. It uses the accelerations provided by GPS velocity change to 
estimate attitude instead of the accelerometers. These accelerations can be estimated by Kalman 
filter. The detailed formulations please refer to [10]. By these accelerations, the pseudo-attitude is 
determined as follwing: 
2
t  a va = v
v
  (8) 
n ta = a a   (9) 
2
t  g vg v
v
  (10) 
(C)
(A) 
Laptop 
WM 
(B) 
Image Receiver 
Laptop 
  
Figure 27. Complementary Filter for Attitude Estimation 
 
CF  and CF  denotes the complementary flitted roll and pitch angle, respectively. IMU  and 
IMU  are the roll and pitch angular rate measured by gyroscopes, respectively.   is the damping 
ratio. 0  is the natural frequency.   and 0  are determined by flight data post process that 
0  is tuned to recover the dynamic response of the resulted roll angle and remove the 
pseudo-attitude time lag.   is tuned to match the magnitude of the resulted roll angle to the 
pseudo-roll.    0 , 0.17,0.54    for the Swallow UAV. 
 
4.2 Fuzzy Logic Control 
Fuzzy logic control (FLC) [9, 25] is applied to attitude controller and waypoint navigator for 
fast implementation. The detailed dynamic modeling is not required. Otherwise, the controller is 
designed by operational experience and expert knowledge. The architecture of fuzzy logic control 
is shown in Figure 28. 
 
Figure 28. Architecture of Fuzzy Logic Controller 
 
The data base is membership functions for the transformation between crisp data and fuzzy sets. 
Triangular membership function is applied to reduce computational cost.  
The rule base contains rule table, which is a list of IF-THEN rules as following: 
,1 1 ,2 2: if    and  ,  then   
j j j j j
input input outputR x A x A y B    (19) 
jR is the j th rule, 1, 2, , 49j   , ,1 ,2,input inputx x  are the input data, joutputy  is the output data, 
and 1 2, ,
j j jA A B are the fuzzy sets. That means the 2-input-1-output fuzzy system with 49 rules is 
applied. The fuzzy sets defined as following: 
   , , , , , , , , Negative Big,
Negative Medium, Negative Small, Zero,
Positive Small, Positive Medium, Positive Big.
j j
iA B NB NM NS ZO PS PM PB NB
NM NS ZO
PS PM PB
 
  
  
 (20) 
The input data, *inputx , is transformed into fuzzy sets by the fuzzifier with membership 
  
Figure 30. Membership Functions of Attitude Controller 
 
4.4 Waypoint Navigator 
The waypoint navigator includes the waypoint pass determination algorithm, the altitude 
controller, and the line trajectory tracker, as shown in Figure 31. The waypoint pass 
determination algorithm decides whether the desired waypoint (WP) is passed or not. It is 
determined by the following two decision strategies. One is called the waypoint radius method. If 
the aircraft is in a certain range, the waypoint radius, of the desired waypoint, then the algorithm 
will determine that the aircraft passes through the desired waypoint (Figure 32(A)). The waypoint 
radius in our case is 50 meters. The other is called the vector product method. If the vectors in 
Figure 32(B) satisfy Eq. 23, then the algorithm will determine that the aircraft passes through the 
desired waypoint. 
02 12 0wp wp    (23) 
 
Figure31. Waypoint Navigator 
 
 r ry x   (28) 
y r circlee y r   (29) 
 
Figure 34. Local Navigation Coordinate 
 
The inputs are the y-axis position error ye  ,1inputx  and ry  ,2inputx , and the output is the 
desired roll angle.   is filtered by a 5 Hz low pass filter to reject the measurement noise from 
IMU. The membership functions are shown in Figure 35. The rule table is the lateral rule table. A 
roll compensator is added to make the aircraft fly along the circle smoothly. By the aircraft 
kinematics, the compensated roll angle is calculated as follows: 
21tanc
circle
v
gr        (30) 
With this roll compensator, if ye  and ry  are zero, then the desired roll is c , and the aircraft 
will fly along the circle. An upper limit of 120° and a lower limit of 30° is set to r , as shown in 
Figure 34, to avoid the aircraft turns to the undesired direction. When 120r   , the desired roll 
will set to 2upper c  . When 30r   , the desired roll will set to 0lower   . 
 
Figure 35. Membership Functions of Circle Trajectory Tracker 
 
  
,2rx , ,2ry , and ,2rz  are the relative x, y, and z position along the wingman navigation 
coordinate, and ,2rx , ,2ry , and ,2rz  are the relative x, y, and z velocity, respectively. 1x , 1y , 
and 1z  are the leader east, north, and up position in the ENU coordinate frame, where 2x , 2y , 
and 2z  are the wingman east, north, and up position similarly. ,2,r desiredx , ,2,r desiredy , and 
,2,r desiredz  are the desired relative position and xe , ye , and ze  are the relative position error 
along the wingman navigation coordinate. 2  is the heading angular rate of the wingman 
aircraft. 1v  and 2v  are the leader and the wingman horizontal velocity in the E-N plane, ,1Uv  
and ,2Uv  are the leader and the wingman velocity in the up axis, and 1  and 2  are the leader 
and the wingman heading angle from GPS measurement, respectively.  
 The fuzzy formation controllers, including the longitudinal, lateral, and vertical formation 
controller, guide the aircraft to maintain the desired formation by the resulted relative navigation 
information. The longitudinal formation controller controls the aircraft to the desired relative x 
position. The inputs are xe   ,1inputx  and ,2rx   ,2inputx , and the output is the throttle control 
PWM signal. The rule table is the longitudinal rule table. The lateral controller controls the 
aircraft to the desired relative y position, the inputs are ye   ,1inputx  and ,2ry   ,2inputx , and the 
output is added with the roll angle of the leader aircraft as the desired roll angle. The vertical 
controller controls the aircraft to the desired relative z position. The inputs are the ze   ,1inputx  
and ,2rz   ,2inputx , and the output is added with the pitch angle of the leader aircraft as the 
desired pitch angle. The rule table is the longitudinal rule table. The membership functions of all 
the three formation controllers are shown in Figure 38. The overall architecture of the relative 
navigator is shown in Figure 39. Please note that the desired roll and pitch angle are added with 
the leader roll and pitch angle, respectively, so that the relative navigator is able to deal with the 
case that the leader aircraft is turning [4], and 2  is obtained from the IMU and is low pass 
filtered in 5Hz to reject the measurement noise. 
 
Figure 38. Membership Functions of Relative Navigator 
 
  The W-FNCS test procedure (Figure 41(B)) is designed to avoid mid-air collision and 
improve safety during the two UAVs autonomous formation flight demonstration. The first step 
of this procedure is the HIL simulation as well. As Figure 40 shows, two HILSE can be linked via 
Local Area Network (LAN) and WM to perform multi-UAV HIL simulation. The coding problem 
can be fixed and the parameters of the relative navigator can be initially determined in this step. 
The second step is the Virtual Leader (VL) flight test [4]. The GCS broadcast the pre-recorded 
leader position, velocity, and attitude data by a virtual leader station (Figure 42(A)) with the same 
data sequence as described in section 3.2.4. In the VL flight test, the W-FNCS can be tested by a 
near-real environment, controlling a real wingman aircraft tracing a virtual leader aircraft. If the 
performance of the W-FNCS is feasible, then we will go to the final step.  
The final step is the two UAVs autonomous formation flight demonstration. The mission 
profile is shown in Figure 43. The leader aircraft will take off first, and climb to the desired 
altitude by manual control of the ground pilot (Figure 43, (1)). Then the leader aircraft will switch 
to the autonomous navigation mode (Figure 43, (2)) to track a pre-set circular trajectory (Figure 
43, (3)). Then the wingman aircraft will take off and climb to the desired altitude by manual 
control, too (Figure 43, (4)). The wingman aircraft will fly to stand-by course manually (Figure 
43, (5)) to wait the leader aircraft pass through it. When the heading of the two aircraft are 
approximately the same and the relative position is in the condition that the leader aircraft is 
ahead of the wingman aircraft, the wingman aircraft will switch to autonomous formation flight 
mode (Figure 43, (6)) to follow the leader aircraft (Figure 43, (7)). When the mission is 
completed, the wingman aircraft will switch to manual control and land first (Figure 43, (8)), than 
the leader aircraft (Figure 43, (9)). 
 
Figure 41. Test Procedure of L-FNCS (A) and W-FNCS (B) 
 
 
(B) (A) 
  
(A) (B)
(C) (D)
 RGB
0
RGB
RGB
0 , if C 0
G B , if M R
C
H 60 B R 2 , if M G
C
R G 4 , if M B
C
                      
  (40) 
0 , if C 0
S C , otherwise
1 2L 1
        
 (41) 
 RGB RGB1L M m2   (42) 
Where RGBM
 
is the maximum value of red, green, and blue values of the RGB model, RGBm  
is the minimum value of the RGB model, and C is  RGB RGBM m . 
 
8.1.2 Thresholding 
When the images are transferred into the HSL color model, the color tracking method can be 
applied to determine the target from the original images. This method cost much less 
computational power than other methods, and, with the HSL color model, the brightness of the 
color is separated and will not affect the result. The thresholding technique is applied to separate 
the back-ground and fore-ground to accelerate the image processing algorithm for real-time 
operation. It is formulated as following: 
min image max
image
1 , T (i, j) T
(i, j)
0 , otherwise
       
f
g   (43) 
Where  image i, jf  is the H and L value of the input image at position (i, j). Tmin is the 
minimum value of H and L of the target. Tmax is the maximum value of H and L of the target.  image i, jg is the intensity value of the output image at position (i, j). The result is shown in Figure 
45. 
 
Figure 45. The Image Before (A) and After (B) Thresholding 
 
8.1.3 Morphology Filter 
After thresholding, the image is binarized as Figure 45 (B), but has noise. The morphology 
filter is applied to filter out noise and keep the features of the target. Here, we utilize the 
morphology filter called opening algorithm. The input image is eroded then dilated by the 
structured element.  
The erosion is formulated as following [30]: 
     image image imagei, j i, j i, j k g e  (44) 
imagee  is the structured element as Figure 46 (A), and imagek  is the binary output image as 
Figure 46 (C). The image imageg  as Figure 46 (B) is scanned by imagee  from the top left pixel to 
(A) (B) 
 considered. It also helps to improve the leader aircraft positioning algorithm, which will be 
discussed later. It is illustrated in Figure 49. 
 
Figure 49. The Image Before Filtering (A), iamgev
  Axis Image Projection (B), iamgeu  Axis 
Image Projection (C), and the Image After Filtering (D) 
 
Then the image center of gravity of the target can be determined as following: 
,
,
1
0
, 1
0
x image
i i
x image
i
n
image image
i
x image n
image
i
m u
G
m







(46) 
,
,
1
0
, 1
0
y image
j j
y image
j
n
image image
j
y image n
image
j
m v
G
m







(47) 
Where ,x imageG  and ,y imageG  are the location of the target center of gravity in the image coordinate 
system. ,x imagen  and ,y imagen  are the total pixel numbers in iamgeu
  and iamgev  axis of the image 
coordinate system, respectively. 
iimage
m  and 
jimage
m  are the mass of the target, which are 
assigned as 1. 
iimage
u  denotes the position of the ith pixel in iamgeu
  axis, and 
jimage
v  denotes the 
position of the jth pixel in iamgev
  axis of the image coordinate system, respectively. 
 
8.2 Camera Parameters 
CCD camera model includes the intrinsic parameters and the extrinsic parameters. Intrinsic 
parameters are the camera parameters will differ from one camera to another. Extrinsic 
parameters are used in the transformation between different coordinate systems. The intrinsic 
parameters play an important role in camera positioning system because the image distortion is 
 ,p camerau  165.50365 
,p camerav  116.10717 
camera  0 
 
The extrinsic parameters are used for the coordinate transformation from the camera coordinate 
system to the wingman navigation coordinate. It can be represented as following: 
,2 11, 12, 13,
,2 21, 22, 23,
,2 31, 32, 33,
r cwn cwn cwn camera
r cwn cwn cwn camera
r cwn cwn cwn camera
x r r r X
y r r r Y
z r r r Z
                        
 (49) 
11,cwnr , 12,cwnr , ..., 33,cwnr  are the extrinsic parameters. 
 
8.3 Distance Estimation 
As refer to [33, 34] with the triangular geometry relation between the real aircraft and the 
onboard image of the camera coordinate system (Figure 51), the distance from 0,cameraC  to the 
target, cameraZ , can be determined as following: 
image camera
ac camera
b f
b Z
  (50) 
 
Where imageb  is the main wing span obtained by the onboard image in pixel, and acb  is the 
main wing span of the aircraft. 
 
Figure 51. Geometry Relation between Real Aircraft and Onboard Image 
 
8.4 Distortion Calibration 
The acquired images from the CCD camera have distortions mainly caused by the lance. The 
wide Field Of View (FOV) lance is used to cover wide airspace and lower the risk of lost target 
for the camera fixed on the fuselage, but, as Figure 52 (A) shows, it cause a lot of distortion. It 
will make large error for the image positioning system. As referred to [35], the image distortion 
  
Figure 53. The Flow Chart of 3-D Image Positioning System 
 
8.6 HIL Simulation 
8.6.1 Simulation Setup 
The 3-D image positioning system is HIL simulated on the HILSE. The leader is set to 
maintain a desired roll angle of -15° and desired pitch angle of 0°. The wingman is flied manually. 
The leader and wingman HILSE are linked by LAN so that the two aircraft can fly and display in 
the same environment. The hardware architecture of the 3-D image positioning system is shown 
in Figure 54. The GPS and AHRS information from the wingman HILSE is fed into the image 
processing OBC (Figure 55) with 1.2Ghz processor and Microsoft® Windows XP operation 
system, and the image from the CCD camera as well. The algorithm is operated on the OBC in 
the update rate of 10Hz. An Xsens® MTi (Figure 15) is attached on the CCD camera for the 
calibration between the screen of HILSE and the CCD camera. It applies the same CCD camera 
as the onboard one of the Swallow UAV (Figure 23) and the same image grabber card (Figure 56) 
as the GCS to make the simulation as real as possible. 
 
Figure 54. Hardware Architecture of 3-D Image Positioning System 
 
Table17. Specifications of Image Processing OBC 
OBC VIA Pico-ITX P820 
Processor 1.2GHz VIA NanoTM E 
    
data
0.5N
2
1
data
Leader Estimated by Camera Leader GPS
RMS Error m =
N
      

 (56) 
Figure 57 (A) shows the flight trajectory of the two aircraft and the leader position estimated 
by the 3-D positioning system. The blue line is the wingman GPS position, the red line is the 
estimated leader position, and the green line is the leader GPS position. Figure 57 (B) illustrates 
the error percentage of the leader position estimation. Figure 57 (C) and (D) represent the north 
and east position results, respectively. The blue line is the wingman GPS position, the red line is 
the estimated leader position, and the green line is the leader GPS position. The RMS errors of 
the positioning system in the east and north direction are about 20cm. 
 
Figure 57. Flight path (A), Error in North and East Direction (B), Position in East Direction 
(C), and Position in North Direction (D) of the HIL Simulation 
Table 19.  HIL Simulation Errors 
 Error Mean (%) RMS Error (m)
North 3.1623 % 0.2057m 
East 3.1654% 0.2034m 
 
9. Conclusions and Future Work 
In this project, the Swallow UAS with integrated hardware, including the air vehicle and 
avionics system, and software, including the Leader Fuzzy Navigation and Control System 
(L-FNCS) and Wingman Navigation and Control System (W-FNCS), is developed. The L-FNCS 
is designed with the Guidance, Navigation, and Control (GNC) function of attitude estimation 
and control, waypoint navigation, and circle trajectory tracking. The W-FNCS is designed with 
the GNC function of attitude estimation and control, and relative navigation. The Swallow UAS 
is flight tested to prove that the aircraft have the capability of formation flight autonomously. The 
performance, however, still have room for improvement. 
The communication and wind disturbance have major impact of formation flight performance. 
For the communication problem, the 3-D image positioning system is developed and HIL 
simulated with HILSE. It can operate in real-time with update rate of 10Hz with high accuracy in 
the range of 20cm. The navigation filter which can integrate the leader data from the wireless 
network between UAVs and the 3-D image positioning system, and predict the leader position, is 
worth to investigate. It can provide robust leader position, velocity, and attitude estimation [31] to 
(A) 
20 40 60 80 100 120 140 160
-20
-10
0
10
20
er
ro
r-N
or
th
 (%
)
time (s/4)
20 40 60 80 100 120 140 160
-20
-10
0
10
20
er
ro
r-E
as
t (
%
)
time (s/4)
(B) 
0 20 40 60 80 100 120 140 160 180
2.904
2.9045
2.905
2.9055
2.906
2.9065
2.907
x 105
E
as
t (
m
)
tims (s/4)
(C) 
0 20 40 60 80 100 120 140 160 180
2.4491
2.4491
2.4491
2.4492
2.4493
2.4493
2.4493
x 106
N
or
th
 (m
)
tims (s/4)
(D) 
 2005. 
22. Y. R. Ding, Y. C. Lai, C. H. Lin, Y. Teng, Y. H. Huang, S. W. Chen, and F. B. Hsiao, “The 
Application of GPS Velocity Based Pseudo Attitude on Attitude Control of The Small UAV 
System,” 7th Aeronautics and Astronautics Symposium across Taiwan Strait, Taipei, Taiwan 
R.O.C., 16-17 November 2010. 
23. R. P. Kornfeld, R. J. Hansman, and J. J. Deyst, “Single-Antenna GPS-Based Aircraft Attitude 
Determination,” Navigation, vol. 45, no. 1, pp. 51-60, 1998. 
24. H. K. Tenn, S. S. Jan, F. B. Hsiao, “Pitch and roll attitude estimation of a small-scaled 
helicopter using single antenna GPS with gyroscopes”, GPS Solutions, Vol. 13, No. 3, pp. 
209-220, Jul 2009. 
25. Y. H. Cheng, "Vision-based Track Following for UAV", Master Thesis, Institute of 
Aeronautics and Astronautics, National Cheng-Kung University, Taiwan, June 2008. 
26. M. Pachter, J. J. D’Azzo, and A. W. Proud, “Tight Formation Flight Control,” Journal of 
Guidance, Control, and Dynamics, Vol. 24, No. 2, pp. 246-254, 2001. 
27. C. C. Chuang, “Study on CCD Camera Vision-Based 3-D Positioning for Small Fixed-wing 
Unmanned Aerial Vehicle, Master Thesis, Institute of Aeronautics and Astronautics, National 
Cheng-Kung University, Taiwan, June 2011. 
28. M. L. Comer and E. J. Delp, “Morphological operations for colour image processing,” 
Journal of Electronic Imaging, Vol. 8, No.3, pp. 279-289, 1999. 
29. M. K. Agoston, “Computer graphics and geometric modeling: implementation and 
algorithms,” Springer-Verlag London Limited, London, U. K., 2004. 
30. R. M. Haralick, X. Zhuang, C. Lin, and J. S. J. Lee, “The Digital Morphological Sampling 
Theorem,” IEEE Transactions on Acoustics, Speech, and Signal Processing, Vol. 37, No. 12, 
December 1989. 
31. Y. Watanabe, E. N. Johnson, and A. J. Calise, “Optimal 3-D Guidance from a 2-D Vision 
Sensor,” AIAA Guidance, Navigation, and Control Conference and Exhibit, Providence, 
Rhode Island, U.S.A., 16-19 August 2004. 
32. Matlab camera calibration toolbox -http://www.vision.caltech.edu/bouguetj/calib_doc/. 
33. M. C. Lu, W. Y. Wang, and C. Y. Chu, “Image-Based Distance and Area Measuring Systems”, 
IEEE Sensors Journal, Vol. 6, No. 2, April 2006. 
34. S. M. Oh, E. N. Johnson, “Relative Motion Estimation for Vision-based Formation Flight 
using Unscented Kalman Filter,” AIAA Guidance, Navigation and Control Conference and 
Exhibit, Hilton Head, South Carolina, USA, August 20-23, 2007. 
35. 鍾國亮, ”影像處理與電腦視覺導論,” 台灣東華出版, 台北市, 中華民國九十七年. 
36. C. H. Hu, “Ortho-imaging of Aerial Video and Application on Navigation for Unmanned 
Aerial Vehicle”, Master Thesis, Institute of Aeronautics and Astronautics, National Cheng 
Kung University, Taiwan, June 2010. 
 
 
 
 
 
 
 
 
 
 
 
 
  
國科會補助計畫衍生研發成果推廣資料表 
日期：100 年 9 月 20 日 
國科會補助計畫 
計畫名稱：具氣動穩定、自主導航、與編隊飛行能力的飛燕
(Swallow)小型無人飛行載具系統研究與開發(3/3) 
計畫主持人：蕭飛賓         
計畫編號：NSC97-2221-E-006-235-MY3  領域：航太工程 
（中文）具氣動穩定、自主導航、與編隊飛行能力的飛燕(Swallow)
小型無人飛行載具系統研究與開發 
研發成果名稱 （英文）The Development of a Small Unmanned Aircraft System - 
Swallow UAVs with Aerodynamic Stability, Autonomous Navigation, 
and Flying Formation Capability 
成果歸屬機構 國立成功大學 發明人 (創作人) 
蕭飛賓 
（中文）建立低速載具風洞實驗驗證平台及機體設計及低雷諾數
數值模擬之經驗方針。可應用於小型無人飛機之微型化航電。小
型無人飛機硬體迴路模擬系統。結合虛擬姿態與模糊控制之姿態
穩定控制器。應用於航點導航與航線追蹤之模糊控制器。應用於
編隊飛行之模糊控制器。三維影像定位系統。 
技術說明 
（英文）To establish the experimental methods of low speed wing 
tunnel tests and to provide the experiential directions of small UAV 
design and low Reynolds numbers CFD simulation. Avionics system 
applied to Small UAV. Hardware-in-the-loop simulation environment 
(HILSE) for Small UAV. Attitude controller combining pseudo 
attitude and fuzzy controller. Fuzzy logic based waypoint 
navigation/line trajectory tracking/circle trajectory tracking controller. 
Fuzzy logic based formation flight controller. Vision-based 3-D 
positioning system. 
產業別 
可穩定飛行並作為自主及編隊飛行開發平台之小型無人飛行載
具。 
低速風洞實驗驗證平台。 
微型化航電系統。 
硬體迴路模擬系統。 
可自主飛行及編隊飛行之小型無人飛機系統。 
技術/產品應用範圍 
低雷諾數氣動力特性驗證與分析。 
小型無人飛行載具複合材料快速加工製程。 
低速載具設計風洞實驗驗證平台。 
基於 Embedded Linux 之航電系統。 
結合 GPS 之姿態估測系統。 
智慧型模糊控制器。 
影像定位。 
附件三 
國立成功大學 
出國報告書 
 
 
 
 
 
 
 
 
 
報告名稱：成功大學航太所-流力及空氣動力學實驗室參加
日本第五屆 ISEM 國際研討會 
出國期間：99/11/3~99/11/8 
經費來源：行政院國家科學委員會 
單位：航空太空工程學系 
職稱：教授 
姓名：蕭飛賓 
聯絡電話：06-2757575 轉 63667 
 
 
 
 
 
 
 
 
中華民國 100 年 1 月  24 日 
 2
目錄 
一、目的.....................................................................................................3 
二、過程.....................................................................................................4 
三、心得.....................................................................................................8 
四、建議事項.............................................................................................8 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 4
二、過程 
第五屆日本 ISEM 國際研討會於 11 月 4 日至 7日，在日本龍古大學的大宮校
區舉辦，主辦單位發佈給參加者的行程如下: 
 
 Abstract submission: May 10, 2010 ==> May 24, 2010 
 Notification of abstract acceptance: May 20, 2010 (received by May 10) 
May 25, 2010 (received after May 10) 
 Full-length manuscript submission: August 1, 2010 (not extended)  
 Notification of full-length manuscript acceptance: August 31, 2010(not 
extended)  
 Final manuscript due: September 20, 2010(not extended) 
 
本參訪團隊之行程表如下所示:  
 
月 日 國家 地點 內容 
11 3 台灣 台灣→日本 交通 
11 4 日本 京都 前往龍古大學報到並參與歡迎晚會  
11 5 日本 京都 會議 
11 6 日本 京都 會議、出遊與晚宴 
11 7 日本 京都 會議與閉幕儀式 
11 8 日本 日本→台灣 交通 
 
參訪團隊的每日行程如下: 
11/3－ 
前往日本: 
由桃園國際機場搭機前往日本關西機場，再轉乘客運到京都的京都第二鐵塔
酒店。當天先確認京都的公車路線圖、從旅館到會議場地的路線。 
 
11/4－ 
前往龍谷大學: 
當天根據網路蒐集與主辦單位提供的交通資訊，搭乘公車前往會議場地。 
 
報到及參加歡迎晚會: 
 6
 
圖三、劉益仲發表論文 
 
圖四、參訪團隊於龍谷大學內合影 
 
晚宴 
  於 Rihga Royal Hotel Kyoto 舉行。 
 8
三、心得 
  在本次研討會中，可以看出各國大學在實驗力學的研究，確實是累積了多年
的實力而造就的成果。藉由互相交流，截長補短，互通有無，可以促進彼此的成
長。參與這次研討會確實得到不少研究上的啟發與靈感，獲益良多。 
 期望日後不論是我們自己辦的研討會，還是有機會去參加其他國際性的研討
會，我們都能有機會獲得最佳的學習經驗。 
 
四、建議事項 
 透過本次參加日本 ISEM 國際研討會，獲得相當多的寶貴經驗與心得，在此
提出幾點建議如下: 
 
1. 持續支持國內實驗力學研討會的舉辦，以提供各研究團隊一個不錯的發展舞
台。 
2. 透過國際研討會的舉辦或參加，建立一個實驗力學的交流平台。 
97 年度專題研究計畫研究成果彙整表 
計畫主持人：蕭飛賓 計畫編號：97-2221-E-006-235-MY3 
計畫名稱：具氣動穩定、自主導航、與編隊飛行能力的飛燕(Swallow)小型無人飛行載具系統研究與開
發 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 2 2 100%  
研究報告/技術報告 0 0 100%  
研討會論文 6 6 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 7 7 100%  
博士生 5 5 100%  
博士後研究員 2 2 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 2 2 100%  
研究報告/技術報告 0 0 100%  
研討會論文 4 4 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
