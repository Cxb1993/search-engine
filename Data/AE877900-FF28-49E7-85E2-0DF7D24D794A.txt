 2 
一、 前言 
隨著 EPON 網路的普及，利用 EPON 網路進行多媒體資訊的傳輸更加方便[1, 
2]。但從法律面來探討，這樣的傳輸行為卻產生出許多法律上的議題，如侵犯智
財權、非法複製及詐欺等。但目前仍極為欠缺相關的證據蒐集與機制[3]，因此要
如何有效追蹤、記錄、分析多媒體檔案的非法侵害行為，進而遏止該行為成為一
個重要的議題。本計畫中利用在 JPEG 這種網路上最為常見的圖片格式為例，利
用 JPEG 格式的特性，而在傳輸流量尚未還原成應用層檔案時，於網路層中進行
數位標籤的偵測，以加快追踨、記錄的效能。主要特色為偵測是否含有特定的數
位標籤不需要先將封包重組成檔案即可進行檢測，以找出傳輸具有特定數位標籤
的 JPEG 流量之可疑犯罪證據的優點。如此不但可以為司法審判提供所需要重要
證據外，同時亦可達到事前嚇阻的效果。 
二、 研究目的 
本計畫主要目的為開發一套運用在 EPON 網路環境中的多媒體特徵嵌入及
偵測的數位鑑識系統 (Multimedia Signature embedding and detecting Digital 
Forensic System，MSFS)，該系統主要分為數位標籤嵌入模組(Signature Tag 
Embedded Module，STEM)及網路層數位標籤偵測搜證模組 (Network Layer 
Signature Tag Detection & Collection Module, NSDM)。數位標籤嵌入模組負責將
數位標籤嵌入至影像中，可利用此數位標籤來辨別擁有者。主要需考量該嵌入作
業對該媒體品質影響及該數位標籤是否容易受到破壞等問。而網路層數位標籤偵
測搜證模組則分為兩大部分，Master 負責搜集及管理所要監視特定數位標籤清
單的工作；而 Agent 具位於 EPON 網路的終端設備，利用監聽的方式，於 EPON
的網路層進行封包中含有數位標籤流量的偵測。主要需考量 EPON 網路環境的高
速特性，這部分必需要考慮時間複雜度的問題。本研究有別於傳統的數位鑑識機
制，大幅減低數位鑑識的蒐證資料量，而可以達到相同的效果，且可以更快速有
效的達成目標，以提供在 EPON 環境中一套可行且有效的數位鑑識安全機制，
並進一步改善 EPON 的安全問題。本研究亦於 OSSF 自由軟體鑄造場中提供多媒
體特徵嵌入及偵測的數位鑑識系統函式庫(MSFS Lib)及數位標籤嵌入模組
(STEM)及數位標籤讀取模組(STRM)兩項運用該函式庫開始的自由軟體元件及
原始碼。 
三、 文獻探討 
本計畫將就多媒體檔案數位鑑識相關技術、資料隱藏及本計畫所選定的
JPEG 圖片格式進行相關的文獻探討，以做為本計畫系統設計的基礎。 
 4 
3.3 JPEG 圖形檔案 
本計畫基於 JPEG 圖片格式在網路上運用極為廣泛，故選擇採用此格式作為
研究對象。JPEG 是一種靜態影像壓縮標準，是由 ISO 及 ITU 所制定的。JPEG
壓縮的過程大致上分為 1.JPEG 檔頭資訊、2.色彩空間轉換與取樣、3.離散餘弦
轉換(DCT)、4.量化、5.熵編碼、6.輸出 bitstream 及 7.存入事先寫好的檔頭資訊
檔案中等步驟。而 JPEG 壓縮模式方面主要分為基本壓縮模式(baseline)、漸近式
壓縮模式(progressive)、無損編碼模式(lossless)及階層模式(hierarchical)等四種[9]。
在考量網路運用的普及度後及本計畫承襲第一年的成果等因素，故仍以基本壓縮
模式為主要對象。 
而 JPEG 影像檔其檔頭資訊中記載了所有 JPEG 所需的量化表、Huffman 編
碼表以及影像大小資訊。JPEG 檔案是採用 2 個位元組來表示，當檔案讀取到第
一個位元組為 0x FF 時，即代表為檔頭格式，之後再判斷第二個位元組的內容來
確認檔頭的類型[8]。由於 JPEG 檔所輸出的是位元串流(bitstream)的形式，故當若
位元串流填滿 16bit 為 0x FF 時，其後 2 個 byte 就得輸出 0x 00 來表示其為位元
串流，而非是檔頭資訊。每一檔頭後面所接的參數皆使用 00 來加以區隔，常見
的檔頭資訊如下表 1 所示：  
表1 JPEG 檔頭資訊 
檔頭 代表意義 
0x FFD8 影像貣始端 
0xFF E0 應用資料標記 
0x FF DB 定義量化表格 
0x FF C0 DCT 貣始框架 baseline 
0x FF C4 定義 Huffman 表格 
0x FF DA 資料貣始 
0x FF D9 影像結束 
資料來源: 本計畫整理 
JPEG 會成為網路上最常用的影像格式主要受益於超高的壓縮比率，進而擁
有極小的檔案大小，以利於早期網路速率不高時可以便利的傳輸影像。而其高壓
縮比率主要是利用人類視覺上的特性來進行破壞性的壓縮處理，由於人類對於低
頻的訊號較敏感，而高頻的訊號則較難以分別，故在 JPEG 壓縮過程中，針對高
頻與低頻的訊號採取不同的量化係數來處理。JPEG 壓縮主要是以人類的肉眼敏
感度作考量。故高頻部份量化的數值比較大，即壓縮比例較高。因此大多可用資
訊都記錄在低頻部份。因此量化表的矩陣係數將會決定 JPEG 影像品質的好壞。
JPEG 中的量化表，基本上分別是亮度(luminance)及彩度(chrominance)兩個量化
表所組成。 
 6 
以下分別針對多媒體特徵嵌入及偵測的數位鑑識系統中的這兩大模組進行
說明： 
一、數位標籤嵌入模組(STEM) 
該模組主要功能在於負責將擁有者期望要進行版權保護的媒體檔案中
嵌入指定的數位標籤，數位標籤是一種以字串為基礎的特徵值，可以利
用此數位標籤辨視出檔案的擁有者是誰。此外此一嵌入數位標籤的動作
中，尚需考量對該媒體檔案品質的影響及該嵌入的數位標籤是否容易受
到破壞等問題。 
二、網路層數位標籤偵測搜證模組(NSDM) 
當要被保護的多媒體檔案中嵌入數位標籤的特徵值後，我們利用這種建
立於 OLT 上的偵測機制，於連續封包流量中偵測是否有受保護的多媒
體檔案(即嵌數位標籤的檔案)在進行傳輸，如果有比對到可疑的封包內
容，立即進行啟動相關的證據收集機制。該模組分為 Master 與 Agent
兩大部分，分述如下： 
i. 控管元件(Master) 
負責搜集及管理所要監視特定數位標籤清單的工作。當偵測到網
路有可疑的封包檔案後，立即啟動 OLT 中的證據收集機制，在
這個機制中主要負責將收集到重要資訊，如：來源 IP、目的 IP、
來源埠、目的埠、傳送時間等相關證據傳送並儲存到 Master 的
資料庫中，以提供未來司法審判的重要證據，以提供數位鑑識
(Forensics)之所需。 
ii. 監視元件(Agent) 
具位於 EPON 網路的終端設備，即 OLT 上，利用監聽的方式，
於 EPON 的網路層進行封包中含有數位標籤流量的偵測，以加
快追踨、記錄的效能。因考量 EPON 網路環境的高速特性，這
部分必需要考慮時間複雜度的問題。 
 
本研究有別於傳統的數位鑑識機制，大幅減低數位鑑識的蒐證資料量，而可
以達到相同的效果，且可以更快速有效的達成目標，以提供在 EPON 環境中一
套可行且有效的數位鑑識安全機制，並進一步改善 EPON 的安全問題。本系統
主要作業環境如下圖所示： 
 8 
本系統亦進行相關的接受測試程序，主要共有 5 項，分別列示如下： 
ATC-001. 使用者嵌入特定數位標籤至 JPEG 檔案中 
ATC-002. 使用者讀取嵌入至 JPEG 檔案中的特定數位標籤 
ATC-003. 使用者指定監控 JPEG 流量的特定數位標籤與取得結果 
ATC-004. 系統以側錄方式監視 OLT 上具特定數位標籤的封包 
ATC-005. 網路層數位標籤偵測搜證模組模組訊息溝通 
 
本研究於 OSSF 自由軟體鑄造場中提供的多媒體特徵嵌入及偵測的數位鑑
識系統(MSFS)的雛型系統即運用上述接受準則及測試程序加以驗證。同時本系
統各元件亦皆有安排對應的測試程序，確保系統的品質。各元件與測試程序追朔
表如下所示： 
表3 子系統 vs. 測試案例追朔表 
系統元件 
 
接受測試程序 
數位標籤嵌入模組
(STEM) 
網路層數位標籤偵測搜證模組
(NSDM) 
控管元件(Master) 監視元件(Agent) 
ATC-001 V   
ATC-002 V   
ATC-003  V  
ATC-004   V 
ATC-005  V V 
資料來源: 本計畫整理 
本系統計畫數位標籤嵌入模組(STEM)亦於經由 ATC-001 與 ATC-002 兩項接
受測試程序，利用 lena.jpg、相片及影像處理軟體製作的 JPEG 圖片測試後，證
明本計畫所開發的系統可以正確的嵌入數位標籤至 JPEG 圖形檔案中，且對人類
的視覺上來說沒有顯著的差異，符合 STR-001 與 STR-002 兩項測試需求，相關
測試結果如下： 
 
圖3 嵌入數位標籤前後的 JPEG 檔案 
資料來源: 本計畫整理 
 10 
經過上述研究結果及相關驗證，證明本計畫所開發的多媒體特徵嵌入及偵測
的數位鑑識系統(MSFS)雛型系統確時達成本計畫目的，並且適用於 EPON網路環
境的高速特性。本研究有別於傳統的數位鑑識機制，可在相同的效果下大幅減低
數位鑑識的蒐證資料量。本研究亦依承諾於 OSSF 自由軟體鑄造場中提供多媒體
特徵嵌入及偵測的數位鑑識系統函式庫(MSFS Lib)及數位標籤嵌入模組(STEM)
及數位標籤讀取模組(STRM)兩項運用該函式庫開始的自由軟體元件及原始碼。 
六、 參考文獻 
[1] FIND, 2009, “光纖、DSL 與 Cable 之混合方式成為業者鋪設網路服務之首選”, 
Retrieved 2010/07/15 from 
http://www.find.org.tw/find/home.aspx?page=news&id=5576. 
[2] FTTH Council, 2009, “Global Fiber to the Home Expansion Defies the Economic 
Downturn”, Retrieved 2010/07/15 from 
http://www.ftthcouncil.org/en/newsroom/2009/09/30/global-fiber-to-the-home-exp
ansion-defies-the-economic-downturn. 
[3] Yuanchen, 2010, “網路犯罪”, Retrieved 2010/07/20 from 
http://content.edu.tw/wiki/index.php?title=%E7%B6%B2%E8%B7%AF%E7%8A
%AF%E7%BD%AA&oldid=6497. 
[4] Venkatachalam V., Cazzanti L., Dhillon N. & Wells M., 2004, “Automatic 
Identification of Sound Recordings”, IEEE Signal Processing Magazine, Vol. 21, 
No. 2, pp.92-99. 
[5] Lukas J, Fridrich J& Goljan M., 2006, “Digital camera identification from sensor 
pattern noise.” IEEE Trans. Information Forensic and Security, Vol. 1, No. 2, 
pp.205–214. 
[6] Luo W. , Qu Z. , Pan F. & Huang J., 2007, “A survey of passive technology for 
digital image forensic”, Frontiers of Computer Science in China, Vol. 1, 
pp.166-179. 
[7] Vlajic N. & Card C., 2001, “Vector quantization of images using modified adaptive 
resonance algorithm for hierarchical clustering”, IEEE Transactions on Neural 
Networks, Vol.12, No. 5, pp.1147-1162. 
[8] Rao K.R. & Yip P., 1990, Discrete Cosine Transform: Algorithms, Advantages, 
Applications, Academic Press Inc., Boston, USA. 
[9] JPEG Committee, 2007, “JPEG Homepage”, Retrieved 2010/07/1 from 
http://www.jpeg.org/jpeg/index.html. 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：李忠憲 計畫編號：99-2221-E-006-248- 
計畫名稱：在乙太被動光纖網路進行多媒體特徵嵌入及偵測之數位鑑識方法(資訊安全技術) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 1 1 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 1 1 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
