二、計畫緣由與目的
在網路的世界裡，檔案傳輸協定[7](File Transfer Protocol, FTP)是僅次於
HTTP 與 E-Mail 外，一項很重要且常用的技術，FTP 為 OSI 七層中應用層的協
定，可以指令操作方式來達到與遠端伺服器進行檔案的傳輸，也可進行伺服器中
檔案的刪除、變更名稱與目錄的新增\移除。唯 HTTP 與 E-Mail 也能作簡易的檔
案傳輸，且不需要輸入繁瑣的 FTP 指令即可完成，為什麼 FTP 還是能在檔案傳
輸環境中佔有一席之地？主要原因在於若檔案太大或太多時，利用 HTTP 的超連
結功能下載或是 E-Mail 夾帶檔案寄送的方式都不方便，此外在利用 FTP 進行傳
輸，在效率與可靠性遠勝於 HTTP 與 E-Mail。因此，FTP 在未來並不會被淘汰，
反而會因越來越多的檔案共享需要而受到重視。
但目前的 FTP 只注重傳輸檔案的便利性，並沒有考慮到傳輸時的安全性，
也就是說當使用者與伺服器在傳輸檔案時，是以可辨識的明文進行溝通，如碰到
攻擊者進行竊聽的動作，所有使用者與伺服器之間傳輸的資訊皆會被得知，攻擊
者甚至可以偽冒使用者進行登入動作。故我們在去年的計畫中，實作出可抵抗密
碼驗證檔失竊之檔案傳輸系統。可抵抗密碼驗證檔失竊之檔案傳輸系統除了可對
使用者與伺服器之間的傳輸作加密外，對於密碼檔可能遭竊的問題，我們使用密
碼驗證檔 (Verifier)[1][5][6]機制來解決此問題。所謂的密碼驗證檔，意即將原本
的密碼檔經過一個單向函數的運算變成密碼驗證檔。當使用者登入時，檔案伺服
器可利用其所儲存的密碼驗證檔來確認使用者是否知道真正的密碼。且就算取得
密碼驗證檔也無法推導求得密碼檔，也就是說，就算攻擊者偷取到帳號與密碼驗
證檔，也無法偽冒合法使用者進行登入的動作。
所以在去年的計畫中，我們已成功保護檔案在網路上傳輸時的安全性，並且
防止檔案伺服器被駭客入侵後，攻擊者可以偽冒合法用者登入伺服器。在本年度
的計畫中，我們更進一步的去考慮木馬程式對檔案傳輸系統所造成的危害。
近年來，出現了許多以記錄使用者帳號與密碼為目的的駭客程式。其方法是將該
木馬植入使用者的電腦內，當該木馬程式啟動時，將會記錄使用者以鍵盤輸入的
字串資料，並將該資料傳給駭客本身或是寄至駭客已經預設好的信箱。雖然許多
系統在輸入密碼時，是以星號(*)表示，但仍然無法抵抗鍵盤紀錄器之木馬攻擊。
由於目前絕大多數的主從式的網路系統均以帳號與密碼來驗證使用者的身份，
(包含我們在前二年所開發的檔案傳輸系統)，這種木馬程式(鍵盤記錄器)會嚴重
影響系統的安全性。因為當攻擊者利用鍵盤紀錄器取得使用者的帳號與密碼後，
便可以偽冒合法的使用者去存取伺服器中的資料。以下的圖 1 即為此種攻擊方式
的示意圖。
為了抵擋此種木馬程式的攻擊，在今年的計畫中，我們提出了智慧型可變密
碼之檔案傳輸系統，其關鍵技術便是使用一次性密碼(One Time Password, OTP)
[2][3][4][8][9][10][11][12]，來達到每次登入皆使用不同的密碼，進而混淆攻擊者
使用鍵盤記錄器所竊取到資訊。而所謂的 OTP，便是改變每次輸入的密碼。在
使用者輸入密碼時，使用者根據系統的要求輸入一次通行碼 (One Time Password
體來連結我們所設計之伺服器來測試相容性），等整個系統穩定無誤後，最後
將我們所改良出的安全通訊協定整合至原先的 FTP 系統中，並將另外設計的
OTP 子系統加至 Client 子系統中，最後進行源碼的模組化與精簡，以使得我
們所完成之安全檔案傳輸系統能達到盡善盡美。
四、結果與討論
基於以上種種理由，我們針對了鍵盤記錄器的攻擊方式，實做了智慧型可變
密碼之檔案傳輸系統(Intelligent Variable Password File Transfer System,
IVPFTS)，除了增加 OTP 的功能之外，其智慧型可變密碼子系統的運作並不會影
響檔案傳輸系統的運作，故可整合去年的可抵抗密碼驗證檔失竊之檔案傳輸系統
至今年的新系統中。以下便是對 IVPFTS 的介紹。
1、系統介紹
智慧型可變密碼之安全檔案傳輸系統主要是讓在公司外面的主管或員工，使
用客戶端應用程式再透過網際網路至公司內部的伺服器來下載或上傳機密的資
料，在這個駭客眾多且商業競爭的狀況下，資料的保密性也變的相對的重要，故
本系統提供了加密功能與可抵抗密碼驗證檔失竊的攻擊。且在今年加入智慧型可
變密碼子系統，降低了使用者在輸入密碼時被木馬程式側錄或偷窺等風險，使攻
擊者就算得到該次登入的密碼，也無法偽冒使用者登入。本系統共分為『伺服器
端子系統(FTSS)』、『使用者端子系統(FTSC)』與『智慧型可變密碼子系統
(IVPS)』，分別為公司內部伺服器以及在外員工所使用，如圖 2 所示。
圖 2 IVPFTS 架構圖
2、伺服器端子系統(FTSS)
示。
圖 4 FTSC 架構圖
4、智慧型可變密碼子系統(IVPS)
使用者啟用該功能後，IVPS 將會從系統本身現有的問題亂數選取一題，並
亂數產生問題所需的變數，經由 FTSC 的介面顯示出來，而當使用者計算出 OTP
後，也是經由 FTSC 的介面輸入，再傳至 IVPS 進行反轉的動作，進而取得使用
者真正的密碼，最後 IVPS 將真正的密碼傳至 FTSC 進行登入 FTSS 的動作，如
圖 5 所示。
