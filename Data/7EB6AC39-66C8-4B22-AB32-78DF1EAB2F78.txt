摘    要 
 
在本計畫中，我們將致力於三維 FIR錐形數位濾波器設計之研究。該類濾
波器廣泛應用於地質學、地震學、聲納及雷達工程等之研究。我們所採用的
方法為 McClellan轉換法，該法之主要優點為：首先設計一精確度較高之一
維濾波器及一簡單之多維轉換子濾波器(transformation subfilter)，然後
將上述之一維濾波器轉換為多維濾波器即可。在步驟上，設計之方法分為兩
大類，一為間接法，另一為直接設計法。前者首先設計一種二維扇形轉換子
濾波器，然後將其中之餘弦函數之一以具圓形轉換子濾波器取代，即可得一
三維錐形濾波器。後者則與一般二維濾波器之設計類似，將相關之限制條件
代入，先設計三維之轉換子濾波器，再以 McClellan轉換法將一維濾波器轉
換為三維錐形濾波器。上述兩種方法各具優缺點，前者之優點為具一有效之
結構體；後者之優點為方法簡單直接，但上述之限制條件將因錐形濾波器之
傾斜度不同而改變。 
 
本計畫另一目標為擴展上述方法至可調角度之三維 FIR錐形濾波器之設
計。此類濾波器之優點為透過改變一可調之參數即可調整錐形濾波器之角
度，毋須重新設計一個新的系統。 
 
另外，在本計畫進行的過程中，我們亦將相關方法成功設計多維濾波器
組，相關內容亦將列入本報告中。 
Abstract 
In this project, the design of 3-DFIR cone-shaped filters will be investigated, 
which are widely applied in areas such as processing of geological and 
seismological data, sonar and radar engineering, etc. In this project, the technique 
of McClellan transformation is adopted wherein a higher-order 1-D prototype 
linear-phase filter and a low-order multi-dimensional transformation subfilter are 
designed, then the 1-D prototype filter is mapped into a multi-dimensional filter 
by a change of variables. For the design of 3-D FIR cone-shaped filters, two 
designed methods are applied: indirect method and direct method. In the indirect 
method, first, a transformation subfilter for fan-type mapping is found, then the 
cosine term of a frequency variable of the above transformation subfilter is 
replaced by an embedded transformation subfilter which possesses circular 
contours. In the direct method, a 3-D transformation subfilter is designed first by 
incorporating some specified constraints, and then the designed 3-D cone-shaped 
filter can be achieved by the technique of McClellan transformation. Both the 
methods stated above are significant with their respective features. For the indirect 
method, an efficient structure will be proposed, while the design is simple and the 
performance is better for the direct method. Also, a disadvantage of the direct 
method is that the specified constraints stated above depend on the inclination 
degree of the 3-D cone-shaped filter. 
 
Moreover, both the methods stated above will be extended to the design of 
variable 3-D cone-shaped filters which are applied applications where the 
inclination degree of the cone-shaped filters can be adjusted online without 
redesigning a new system.  
 
By the way, the developed method also applied to the design of 
multi-dimensional FIR filter banks, and the report also included here. 
 
Therefore, this report contains: 
A. Design of general 3-D FIR cone-shaped filters by the indirect method. 
(embedded McClellan transformation) 
 I 
 
Contents 
 
Chapter 1. 3-D FIR Cone-Shaped Filter Design by a Nest of McClellan 
Transformations and Its Variable design………..……….…1 
 
Chapter 2. Design of 3-D FIR Cone-Shaped Filters by McClellan 
Transformation and Least-Squares Contour Mapping .…..27 
 
Chapter 3. An Iterative Approach for Minimax Design of 
Multidimensional Quadrature Mirror Filters……………...39 
 
出國參加學術會議報告…………….……………………………….62 
 2 
  In the design of 2-D FIR digital filters, McClellan transfor- mation plays a dominant role [16]–[30]. Applying 
the technique, a high-order 1-D prototype filter and a low-order 2-D transformation subfilter are designed, 
respectively, then the 1-D prototype filter is mapped into a 2-D filter by a change of variables. 
  In this paper, the design of 3-D FIR cone-shaped filters is investigated by a nest of McClellan transformations. 
First, a 2-D FIR fan-type filter with inclination θ  is designed by McClellan transformation and the following 
substitution is used: 
          00 10 01 3 11 312 12cos cos cos cos cost t t t        (2) 
The design specification is illustrated in Fig. 2(a). Then, the term  12cos   in (2) is replaced by 
          00 10 01 1112 1 2 1 2cos cos cos cos cosr r r r          (3) 
and the circular cutoff contour shown in Fig. 2(b) is required to meet an ideal one as much as possible. To find 
the coefficients in (2) and (3), some constraints are incorporated in this paper such that scaling problem can be 
avoided. Although higher order transformation subfilters in (2) and (3) can be used for accuracy, the 
complexity of the designed system will increase drastically. So, only first-order transformation subfilters are 
adopted in this paper. 
  Also, there is another trend of filter design concerning the design of variable filters which are applied 
applications where the frequency characteristics need to be adjustable [31]–[42]. Among the existing works, 
especially, the technique of McClellan transformation is applied in [40]–[42] to the design of 2-D FIR variable 
filters. In this paper, it will be dealt with for the design of 3-D FIR variable cone-shaped filters by a nest of 
variable McClellan transformations. 
  This paper is organized as follows. In Section Ⅱ, the technique of a nest of McClellan transformations is 
applied to the design of 3-D FIR cone-shaped filters, which will be extended to the design of 3-D FIR variable 
cone-shaped filters in Section Ⅲ. Several examples will be presented to demonstrate the effectiveness of the 
proposed method. Finally, the conclusions will be given in Section Ⅳ. 
 
II. DESIGN OF 3-D FIR CONE-SHAPED FILTERS BY A NEST OF MCCLELLAN TRANSFORMATIONS 
For a zero-phase FIR digital filter, its frequency response can be represented by  
                                                                                                                                                                                                                  
 
 4 
 
             
             
00 10 00 10 10 1 10 01 2 01 11 00 3 10 11 1 2
11 10 1 3 11 01 2 3 11 11 1 2 3
cos cos cos cos cos cos
cos cos cos cos cos cos cos .
t t r t r t r t t r t r
t r t r t r
            
         
  (10) 
Comparing (6) and (10), the relationships shown below can be obtained: 
 
000 00 10 00
100 10 10
010 10 01
001 01 11 00
110 10 11
101 11 10
011 11 01
111 11 11 .
t t t r
t t r
t t r
t t t r
t t r
t t r
t t r
t t r
 


 

  


 

 

 
  (11) 
A. Determination of the Transformation Coefficients in (2)  
To find the transformation coefficients in (2), it is desirable to incorporate the following constraints such that 
scaling problem can be avoided: (1) The 1-D frequency origin, 0 , is mapped into the    12 3, 0,   point 
of the 2-D frequency plane, and (2) the point    is mapped into    12 3, ,0   , which leads to   
 00 11t t   (12a) 
 10 011 .t t    (12b) 
Moreover,  3 12 tan θ   along the cutoff contour shown in Fig. 2(a), so the objective error function can be 
represented by 
 
 
          
    
     
12 11 12 3
0
2
01 12 3 12
2
12 12 12
0
cos cos 1 cos cos
cos cos
cos cos
up
up
c
T
c
T T
f f f
e t
t d
d
s


       
    
        
  


t
t c
t r t Q t
 (13) 
 6 
B. Design of 1-D Prototype Filters 
In this section, the 1-D prototype low-pass FIR filter is designed by the Remez exchange algorithm [43]. For 
example, when 20N  , passband  0, 0.24776c  , stopband  0.1 ,c   , the magnitude response is shown 
in Fig. 4(c). 
C. Determination of the Transformation Coefficients in (3) 
For deriving the coefficients in (3), three constraints are considered: (1) 12 0   is mapped into 
   1 2, 0,0   , (2) 12   is mapped into    1 2, ,    , and (3) 01 10r r  due to symmetry, which leads to  
 00 11r r   (16a) 
 
1
.01 10 2
r r    (16b) 
Hence the corresponding objective error function can be represented by 
 
           
21 1
11 12 1 2 11 11 1 22 2
2
11 11
cos cos cos cos cosc
c
c c c
e r r r dl
s r r r q
           
  

  (17) 
where 
c
dl  denotes a line integral along the circular cutoff contour shown in Fig. 2(b), 
      
2
1 1
12 1 22 2
cos cos cos ,c c
c
s dl          (18a) 
          1 112 1 2 1 22 22 cos cos cos cos cos 1 ,c c
c
r dl                 (18b) 
    
2
1 2cos cos 1 .c
c
q dl        (18c) 
Obviously, for a given 12c , the minimum of (17) is obtained for  11 2c cr r q . Also the proper frequency 
point 12c , which is mapped into the circular cutoff contour shown in Fig. 2(b), must be determined by 
choosing the frequency 12c  where  11e r  is minimum. For example, when θ 65 and 
510  , 
 tan 65up  , the error curve  11e r  for 120 c    is shown in Fig. 4(d), the desired 12c  is 0.40197 , 
11 0.27917598r  , and the isopotential contours are illustrated in Fig. 4(e) where the values inside the figure 
represent the frequencies 12  of the fan-type filter designed in Section Ⅱ.A. 
 8 
For comparing with the works in [12] and [15], the root-mean-squared deviation error of the cutoff isopotential 
is defined by 
 
 
  
   
     
3 12
3 12
1 2
2
1 2 3
0 0
3 3 12 123 3
3 1 2
12 12
3 3
1
1 1
3 12
2 2
cos , , ,
, for 45 ,
cos , sin ,
tan θ tan θtan θ , for 45 ,
N N
rms c
n nN N
n n
N N
F
n N
n N
 
    
   
  
 
  
 
 
    
  
     
      
    
 
 (23) 
and the results are also list in Table Ⅰ when 12 3 90N N  . To peer the detail, the root-mean-squared deviation 
errors of the cutoff isopotentials, rms , for the proposed method and the methods in [12] and [15] are illustrated 
in Fig. 6. It can be observed from Table Ⅰ and Fig. 6 that the proposed method and the methods in [12] and [15] 
own their respective feature: the overall performance of the proposed method is better while the others give 
uniform and closed-form solutions. It is noted that the performance of [12] is particularly better when 
47 θ 53  . 
  As to the computation time, Matlab simulations show that each design took about 35.12 seconds in average on 
a notebook PC with Intel Core Duo CPU T8300. But if the step size   for finding the error curves in Figs. 4 (a) 
and (d) is increased to 310 , the design only took 0.358 seconds of CPU time. 
For the scaling problem of transformation function (10), exhaustive experiments show that the values of (10) 
for  ,i    , 1,2,3i  always lie inside  1, 1  when the constraints in (12) and (16) are considered in the 
design procedure. 
 10 
 
   
   
   
11
0
01
0
11
0
1,1,
0,1,
1,1, ,
M
m
m
M
m
m
M
m
m
t p t m p
t p t m p
r p r m p










 




  (30) 
and the coefficient generators for both the prototype 1-D filter and the transformation subfilter are shown in Fig. 
7(c). It is noted that the coefficient generators are implemented such that the coefficients are changed only on 
the demand of variation. 
A. Design of the Fan-Type Variable Transformation Subfilter and the 1-D Prototype Variable Filter 
By (2) and (12), the substitution for the fan-type contour mapping can be represented by  
                  11 12 3 01 12 3 12cos 1 cos cos cos cos cos ,t p t p             (31) 
and the technique in [42] can be applied for the design of the fan-type variable transformation subfilter and the 
1-D prototype variable filter, where a cutoff-frequency orbit function shown below must be determined: 
   20 1 2 .
M
c Mp b b p b p b p        (32) 
  For example, it is desirable that θ  is adjustable over 
1 2θ 55 ,θ 75    , so the variable range for parameter p  
is    1 21 2tan , tanθ θp p    . When 5M   is used, Fig. 8(a) shows the cutoff-frequency orbit accompanying 
the individual design with integer inclination angles in the range of 55 θ 75   marked by “ ”, and the 
isopotential cutoff edge contours for different integer inclination degrees are shown in Fig. 8(b). The related 
coefficients are tabulated in Table Ⅱ. For the design of 1-D prototype variable low-pass filter, the magnitude 
response is shown in Fig. 8(c) when 20N   and the width of transition band 0.15T  . 
B. Design of the Circular-Type Variable Transformation Subfilter 
By (3) and (16), the transformation for the circular-type contour mapping is  
             12 11 1 2 1 2
1 1
cos cos cos 1 cos cos .
2 2
r p           (33) 
To find the corresponding cutoff-frequency orbit function as below 
 12 
 
        
 
3 12
3 12
3 12
1 2
21
1 2 31 1 1
0 0 0
2 1 12 123 3 3 3
1 3 1 2
3 3 12 122 2
cos , , , ,
θ θ , for 1,
θtan , cos , sin ,
, for 1,
p
p
p
N N N
rms cN N N
n n n
p
p
n n
N N
F pp
n n N p
p
n p N pN p p
 
    
  
  

  
  


    

      
                
  
 (38) 
which is equal to 0.04302546  when 1θ 55 , 2θ 75 , 60pN   and 3 12 90N N  . In (38),  1 2 3, , ,F p    
denotes the frequency response of variable transformation subfilter for a specified p . The design took 9.218 
seconds of CPU time when 310  is used to find the values marked by “ ” in Figs. 8(a) and (d). Also the 
scaling problem can be avoided by incorporating the constraints of (12) and (16) in the design procedures. 
Although, the theoretical proof cannot be given to show this fact, but exhaustive simulations show that the 
frequency responses of (27) for  ,i    , 1,2,3i  always locate inside  1, 1 . 
 
IV. CONCLUSIONS  
In this paper, a new method has been successfully proposed for the design of 3-D FIR cone-shaped filters. 
Following the design of a transformation subfilter with fan-type contours, an embedded transformation 
subfilter is designed to replace one cosine term of the original transformation subfilter. In this paper, the 
proposed method has also been extended to the design of variable cone-shaped filters, which fully demonstrates 
the effectiveness and flexibility of the proposed method. 
REFERENCES 
[1] L. T. Bruton and N. R. Bartley, “The design of highly selective adaptive three-dimensional recursive cone 
filters,” IEEE Trans. Circuits Syst., vol. 34, no. 7, pp. 775–781, Jul. 1987. 
[2] M. E. Zervakis and A. N. Venetsanopoulos, “Design of three-dimensional digital filters using 
two-dimensional rotated filters,” IEEE Trans. Circuits Syst., vol. 34, no. 12, pp. 1452–1469, Dec. 1987. 
[3] A. C. Tan and H. Sun, “Structurally passive synthesis of three- dimensional recursive cone filters,” in Proc. 
32nd IEEE Midwest Symp. Circuits Syst., Aug. 14–16, 1989, vol. 2, pp. 1119–1122. 
[4] M. Bolle, “A closed form design method for recursive 3-d cone filters,” in Proc. IEEE Int. Conf. Acoustics, 
Speech, Signal Process., Apr. 19–22, 1994, vol. 6, pp. 141–144. 
[5] G. Runze and P. Steffen, “A contribution to the design of digital three- dimensional FIR and IIR cone 
filters,” in Proc. 3-D Image Analysis Synthesis, Nov. 1996, pp. 179–182. 
 14 
[20] D. T. Nguyen and M. N. S. Swamy, “Approximation design of 2-D digital filters with elliptical 
magnitude response of arbitrary orientation,” IEEE Trans. Circuits Syst., vol. CAS–33, no. 6, pp.597–603, 
Jun. 1986. 
[21] M. S. Reddy and S. N. Hazra, “Design of elliptically symmetric 2-D FIR filters with arbitrary 
orientation,” Electronics Lett., vol. 23, no. 18, pp. 964–966, Aug. 1987. 
[22] E. Z. Psarakis, V. G. Mertzios, and G. P. Alexiou, “Design of two dimensional zero phase FIR fan filters 
via the McClellan transform,” IEEE Trans. Circuits Syst., vol. 37, no. 1, pp. 10–16, Jan. 1990. 
[23] S.-C. Pei and J.-J. Shyu, “Design of 2-D FIR digital filters by McClellan transformation and least squares 
eigencontour mapping,” IEEE Trans. Circuits Syst. Ⅱ, Analog Digit. Signal Process., vol. 40, no. 9, pp. 
546–555, Sep.1993. 
[24] C. K. Chen and J. H. Lee, “McClellan transform based design techniques for two-dimensional linear 
phase filters,” IEEE Trans. Circuits Syst. Ⅰ, Fundam. Theory Appl., vol. 41, no. 8, pp. 505–517, Aug. 
1994. 
[25] G. V. Moustakides and E. Z. Psarakis, “Design of N-dimensional hyperquadrantally symmetric FIR 
filters using the McClellan transform,” IEEE Trans. Circuits Syst. II, Analog Digit. Signal Process., vol. 42, 
no. 8, pp. 547–550, Aug. 1995. 
[26] Y. -S. Song and Y. H. Lee, “Formulas for McClellan transform parameters in designing 2-D zero-phase 
FIR fan filters,” IEEE Signal Process. Lett., vol. 3, no. 11, pp. 291–293, Nov. 1996. 
[27] S.-C. Pei and J.-J. Shyu, “Design of 2-D FIR digital filters by McClellan transformation and 
least-squares contour mapping,” Signal Process., vol. 44, no. 1, pp. 19–26, Jun. 1995. 
[28] H. C. Lu and K .H. Yeh, “Optimal design of 2-D FIR digital filters by scaling-free McClellan 
transformation using least-squares estimation, ” Signal Process., vol. 58, no. 3, pp. 303–308, May 1997. 
[29] H. C. Lu and K. H. Yeh, “2-D FIR filters design using least squares error with scaling-free McClellan 
transformation,” IEEE Trans. Circuits Syst. Ⅱ, Analog Digit. Signal Process., vol. 47, no. 10, pp. 
1104–1107, Oct. 2000. 
[30] C.-C. Tseng, “Design of 2-D FIR digital filters by McClellan transform and quadratic programming,” 
Proc. Inst. Elect. Eng. Vis. Image Signal Process., vol. 148, no. 5, pp. 325–331, Oct. 2001. 
[31] C. W. Farrow, “A continuously variable digital delay element,” in Proc. ISCAS, 1988, pp. 2641–2645 
[32] T.-B. Deng, “Design of linear phase variable 2-D digital filters using real- complex decomposition,” 
IEEE Trans. Circuits Syst. II, Analog Digit. Signal Process., vol. 45, no. 3, pp. 330–339, Mar. 1998. 
 16 
 
 
 
 
 
TABLE Ⅰ  
THE RELATED RESULTS FOR THE DESIGN OF 3-D FIR CONE-SHAPED FILTERS WITH 20N   AND 35 θ 85  , 
AND COMPARISONS BETWEEN THE PROPOSED METHOD AND THE METHODS IN [12] AND [15]. 
 θ  
Proposed method 
Method in 
[12] 
Method in 
[15] 
c
   
12c
   
11
t  
01
t  
11
r  rms  rms  rms  
35  0.63976 0.85269 
-0.1634835
9 
-0.5549171 0.44297755 0.04235498 0.11642287 0.07393103 
40  0.57545 0.85269 
-0.0963088
6 
-0.5257499
6 
0.44297755 0.04618366 0.11146387 0.06861684 
45  0.5 0.85269 0 -0.5 0.44297755 0.04471952 0.09439354 0.09243811 
50  0.42455 0.71586 0.09630886 
-0.4742500
4 
0.36680456 0.06662341 0.03950643 0.0989269 
55  0.36024 0.59994 0.16348359 -0.4450829 0.32372541 0.06460113 0.07504389 0.10154284 
60  0.30212 0.49641 0.21333164 -0.4167224 0.29687193 0.05369084 0.08328548 0.09286125 
65  0.24776 0.40197 0.25145973 
-0.3911334
5 
0.27917598 0.04014389 0.07245512 0.07556123 
70  0.19585 0.31433 0.28066806 
-0.3693765
1 
0.26718397 0.0269322 0.05332988 0.05418291 
75  0.14561 0.2317 0.30240491 -0.3520417 0.25907298 0.01562093 0.0328281 0.03300801 
80  0.0965 0.15261 0.31746243 
-0.3394503
2 
0.25392453 0.00707627 0.01544117 0.01546517 
85  0.04808 0.07576 0.32636838 -0.3318541 0.25103676 0.00178751 0.00398336 0.00398445 
 
TABLE Ⅱ 
THE RELATED COEFFICIENTS FOR THE DESIGN OF A 3-D FIR VARIABLE CONE-SHAPED FILTER WITH 55 θ 75  . 
Coefficients 0m  1m  2m  3m  4m  5m  
mb  3.54131718 -3.26143631 1.62146579 -0.44891413 0.06503912 -0.00383783 
 1,1,t m  -0.75211807 1.37154715 -0.77082135 0.2254595 -0.03335305 0.00196532 
 0,1,t m  -0.89145068 0.65088893 -0.36544717 0.11473637 -0.01926224 0.00134384 
ˆ
mb  6.99863194 -7.5101446 4.24623083 -1.32737863 0.21700282 -0.01447988 
 1,1,r m  1.17578052 -1.49610493 1.02796881 -0.3600674 0.06305512 -0.00436979 
 
 18 
 
 
 
 
 
 
 
 
 
     
θ
ω3
ω12
π
π
-π
-π ωup
 
(a) 
 
     
ω2
ω1
π
π
-π
-π ωup
 
(b) 
 
Fig. 2 (a) Specification for the design of a fan-type filter. (b) Circular cutoff contour for the embedded 
transformation of the proposed method. (Shadowy regions: passbands) 
 
 20 
 
 
(a) 
 
 
(b) 
 
 
(c) 
 
Fig. 4 Design of a 3-D FIR cone-shaped filter with θ 65  and 20N  . (a) Error curve for fan-type contour 
fitting. (b) Isopotential contours for fan-type contour fitting. (c) Magnitude response of 1-D FIR prototype 
filter. (d) Error curve for circular contour fitting. (e) Isopotential contours for circular contour fitting. (f) 
Magnitude responses of the designed cone-shaped filter for 
3
  , 0.75 , 0.5  and 0.25 . 
 
 22 
 
 
 
 
                       
 
 
                       
 
 
                       
 
Fig. 5 Isopotential surfaces of 3-D FIR cone-shaped filters at magnitude 0.98  when θ 35 , 45 , 55 , 65 , 
75  and 85 . 
 
 24 
 
 
 
 
 
F(z1, z2 , z3 , p) 2F(z1, z2 , z3 , p) 2F(z1, z2 , z3 , p) 2F(z1, z2 , z3 , p) 2F(z1, z2 , z3 , p)
a0(p) a1(p) a2(p) a3(p) a4(p) a5(p)
-1
-1 -1
-1
 
 
(a) 
 
R(z1, z2 , p) T1(z3 , p)
T2(z3 , p)
 
 
(b) 
 
a(n,5) a(n,4) a(n,3) a(n,2) a(n,1) a(n,0)
an(p)     0 ≤ n ≤ N 
t(1,1,5) t(1,1,4) t(1,1,3) t(1,1,2) t(1,1,1) t(1,1,0)
t(0,1,5) t(0,1,4) t(0,1,3) t(0,1,2) t(0,1,1) t(0,1,0)
r(1,1,5) r(1,1,4) r(1,1,3) r(1,1,2) r(1,1,1) r(1,1,0)
p
t11(p)
t01(p)
r11(p)
 
 
(c) 
Fig. 7 (a) Structure of a 3-D FIR variable filter designed by variable McClellan transformation ( 5N  ). (b) 
Block diagram of the variable transformation subfilter designed by the proposed method. (c) Coefficient 
generators for the 1-D prototype filter and the transformation subfilter ( 5M  ). 
 26 
 
 
 
 
                       
 
                       
 
                        
(g) 
Fig. 8 (Continued) 
 
 28 
demonstrate the good performance of the proposed method. 
 
II. Problem formulation and design examples 
For designing a 3-D cone-shaped filter, Fig. 1 presents the ideal cone shape which 
is described by  
 
 
2
2 2 3
1 2 2
C:
tan θ

                                               (1) 
where θ  denotes the angle between the cone-surface and the  1 2,  -plane. When 
the technique of McClellan transformation is applied, the zero-phase response of the 
1-D prototype filter can be represented by 
   
0
cos .
N
n
n
H a n

                                           (2) 
Replacing  cos n  in (2) by the th - ordern Chebyshev polynomial, (2) becomes 
     
0
cos .
N
n n
n
H a T

                                           (3) 
For designing 3-D FIR filters by McClellan transformation, the substitution 
   
     
       
         
1 2 3
000 100 1 010 2 001 3
110 1 2 101 1 3
011 2 3 111 1 2 3
cos , ,
cos cos cos
cos cos cos cos
cos cos cos cos cos (4)
F
t t t t
t t
t t
    
      
     
      
 
is adopted, and the frequency response of the designed 3-D FIR filter is  
    1 2 3 1 2 3
0
, , , , .
N
n n
n
H a T F

                                        (5) 
 
A. Approach I 
To find the transformation coefficients in (4), it is desirable to incorporate the 
following constraints such that scaling problem can be avoided as much as possible: 
(1) The 1-D frequency origin, 0 , is mapped into the    1 2 3, , 0,0,     point of 
the 3-D frequency space, (2) the point    is mapped into    1 2 3, , ,0,0    , 
 0, ,0 and  , ,0  , and (3) 100 010t t  and 101 011t t  due to symmetry,  which leads to  
 
000 110 011
100 010 110 011 111
001 110 011 111
101 011
2
2 2 1
t t t
t t t t t
t t t t
t t
  

   

   
 
                                          (6) 
 30 
 -1
1
.
2
 t Q r                                                    (12) 
To determine the cutoff frequency c  of 1-D prototype filter, it is desirable to obtain 
the error curve  e t  for 0 c    and the corresponding c  with minimum error is 
the desired one.  
 
Example 1: In this example, a 3-D cone-shaped filter with inclination θ 65  is 
designed. Fig. 2(a) presents the error curve  e t  for 0 c   , and the minimum 
occurs when 0.24758c    which is the desired cutoff frequency of 1-D prototype 
low-pass filter. If the technique of Remez exchange algorithm [24] is applied, the 
magnitude response of 1-D prototype low-pass filter with 20N  ,  passband 
 0,0.24758  and stopband  0.34758 ,   is shown in Fig. 2(b), and Fig. 2(c) presents 
the magnitude responses of the designed 3-D cone-shaped filter for 3   , 0.75 , 
0.5  and 0.25  while its isopotential surface at magnitude 0.98  is shown in Fig. 3. 
Example 2: To illustrate the effectiveness of the proposed method, more 3-D 
cone-shaped filters are designed, and Fig. 3 presents the isopotential surfaces at 
magnitude 0.98  for θ 35 , 45 , 55 , 65  and 75  while the numerical results are 
listed in  Table I. For comparing with the existing methods [9], [12] and [13], the 
root-mean-squared deviation error of the cutoff isopotential is defined by 
  
   
 
   
3 12
3 12
3 12
1
2
21
1 2 31 1
0 0
3 3
3
3 3
12 123 3
1 2
12 122 2
cos , , ,
, for 45 ,
tan θ , for 45 ,
cos , sin , (13)
tan θ tan θ
N N
rms cN N
n n
n n
N N
F
n N
n N
 
    
 

 
 
 
 
 
  
    
  
 
 
 
   
    
   
 
 
and the comparison with 12 3 90N N  is illustrated in Fig. 4 from which it can be 
observed that the performance of the proposed method in this subsection is better than 
the existing method for θ 79 . But the disadvantage of the method in this subsection 
is that scaling problem will occur when θ 79 , i.e.  1 2 3, ,F     will be larger than 
1 for certain region, so another approach will be proposed in next subsection to 
overcome it. 
 
B. Approach II 
 
To overcome the possible scaling problem in Section II-A, one more constraint is 
 32 
In this chapter, two approaches have been proposed for the design of 3-D FIR 
cone-shaped filters, and it is found that Approach I presented in Subsection II-A is 
desirable to be used when the inclination degree θ  of the designed cone-shaped filter 
is smaller than 79 , otherwise, Approach II stated in Subsection II-B is preferable. As 
to the design of 3-D cone-shaped filters with variable inclination as in [13] by the 
analogous methods in this chapter, it seems to be a challenge when the variable range 
is around θ 79 , which will make a research topic in the future. 
 
References: 
[1] L. T. Bruton and N. R. Bartley, “The design of highly selective adaptive 
three-dimensional recursive cone filters,” IEEE Trans. Circuits Syst., vol. 34, no. 7, 
pp. 775–781, Jul. 1987. 
[2] A. C. Tan and H. Sun, “Structurally passive synthesis of three- dimensional 
recursive cone filters,” in Proc. 32nd IEEE Midwest Symp. Circuits Syst., Aug. 
14–16, 1989, vol. 2, pp. 1119–1122. 
[3] M. Bolle, “A closed form design method for recursive 3-d cone filters,” in Proc. 
IEEE Int. Conf. Acoustics, Speech, Signal Process., Apr. 19–22, 1994, vol. 6, pp. 
141–144. 
[4] G. Runze, “Efficient design of digital 3-D cone-shaped FIR fan filters using 
transformations,” in Proc. 10th IEEE Workshop Image Multidi- mensional Signal 
Process., Jul. 1998, pp. 263–266. 
[5] L. T. Bruton, “Selective filtering of spatio-temporal plane waves using 3-D cone 
filter banks,” in Proc. 2001 IEEE Pacific Rim Conf. Commun. Signal Process. 
(PACRIM), Aug. 26–28, 2001, pp. 67–70. 
[6] L. T. Bruton, “Three-dimensional cone filter banks,” IEEE Trans. Circuits Syst. I, 
Fundam. Theory Appl., vol. 50, no. 2, pp. 208–216, Feb. 2003. 
[7] B. Kuenzle and L. T. Bruton, “A novel  low-complexity spatio-temporal ultra 
wide-angle polyphase cone filter bank applied to sub-pixel motion 
discrimination,” in Proc. ISCAS, 2005,  pp. Ⅲ/2397–Ⅲ/2400. 
[8] S. Singh and D. A. L. Piriyakumar, “Non-uniform bandwidth 3D cone filter 
bank,” in Proc. 50th Midwest Symp. Circuits Syst., Aug. 5–8, 2007, pp. 586–589. 
[9] G. Mollova and W. F. G. Mecklenbräuker, “McClellan based design approach for 
3-D digital filters with minimization of the integral squared error,” International 
Journal of Mathematics and Computers in Simulation, vol. 1, no. 1, pp.18-25, 
2007. 
[10] G. Mollova and W. F. G. Mecklenbräuker, “Three-dimensional cone FIR filters 
design using the McClellan transform,” in Proc. 41st Asilomar Conf. Signals, Syst., 
Comput., Pacific Grove, CA, Nov. 4–7, 2007, pp. 1116–1120. 
 34 
[23] C.-C. Tseng, “Design of 2-D FIR digital filters by McClellan transform and 
quadratic programming,” Proc. Inst. Elect. Eng.1/2˝Vis. Image Signal Process., 
vol. 148, no. 5, pp. 325–331, Oct. 2001. 
[24] J. H. McClellan, T. W. Parks and L. R. Rabiner, “A computer program for 
designing optimum FIR linear phase digital filters,” IEEE Trans. Audio 
Electroacoust., vol. AU–21, no. 6, pp. 506–526, Dec. 1973. 
 
 
 36 
 
 
 
 
      (a)                          (b) 
 
 
 
 
 
 
 (c) 
 
Fig. 2 Design of a 3-D FIR cone-shaped filter with θ 65  by the method in 
Subsection II-A. (a) Error curve  te . (b) Magnitude response of 1-D FIR 
prototype filter. (c) Magnitude responses of the designed cone-shaped filter for 
3  , 0.75 , 0.5  and 0.25 . 
 
 38 
 
 
 
 
 
 
 
Fig. 4. The root-mean-squared deviation errors of the cutoff isopotentials. 
(Circle line: proposed Approach I, cross line: proposed Approach II, solid 
line: method of [9], dash-dot line: method of [12], dash line: method of 
[13].) 
  
 
40 
1. Introduction 
 
   For the past decade, the design of quadrature mirror filter (QMF) banks has received considerable attention 
due to their wide applications in one-dimensional (1-D) and multidimensional signal processing [1]–[47]. 
Among various QMF banks, the two-channel system is the most widely used and constitutes the basic element 
of a multirate system. 
   In this chapter, the design of two-channel multidimensional QMF banks is investigated. A typical QMF bank 
is shown in Fig. 1(a) where the input signal is split into subbands by the analysis filter pair     
0 1
,z zH H  
and then the subband components are added to form the reconstructed signal in the receiver throughout the 
synthesis filter pair     
0 1
,z zF F . Generally, most of the existing works concern the perfect-reconstruction 
system by designing a pair of filters to accommodate the perfect-reconstructed conditions. However, to reduce 
the implementation complexity, only one of the filters mentioned above is needed to be designed under the 
cost of magnitude distortion. Furthermore, although several works have been proposed for minimax design of 
1-D QMF banks, but the multidimensional case isn’t discussed yet. So, an iterative technique will be 
developed in this chapter to design multidimensional QMF banks in minimax sense. 
    In this chapter, the objective error function consists of two parts. One is the mean-squared error of overall 
magnitude response, and the other is the stopband energy of the analysis lowpass filter which is incorporated 
such that the magnitude response of the analysis lowpass filter will not deviate from the desired one too much. 
But the problem to minimize the objective error function is highly nonlinear, so an iterative method is 
proposed in this chapter to overcome it. Furthermore, to reduce the peak error of overall magnitude response, 
an iterative weighting-updated technique modified from [48]-[50] is proposed too, which constitutes the outer 
iterative loop while the iteration mentioned above makes up the inner loop. The method is generalized in this 
chapter, and examples such as design of 2-D and 3-D QMF banks will be presented.  
   This chapter is organized as follows. The problem formulation for the design of a 2-D QMF bank is 
presented in Section 2. First, the original objective error function is derived, for which the minimization is a 
highly nonlinear optimization. So an iterative quadratic method is proposed to replace it in Section 2-B. Then 
the weighting-updated technique is proposed in Section 2-C to reduce the peak error of overall magnitude 
response obtained in Section 2-B. To initialize the overall procedures, the initial system is designed in Section 
  
 
42 
       1 2
1 2
1 1
0 0 0 1 21 2 1 2
0 0
, ,
N N
n n
n n
H H h z zz z n n
 
 
 
 z  (6) 
where N  is an odd integer and the filter coefficients  0 1 2,h n n  are octagonal symmetric, i.e.  
       1 1 1 1 1 1 1 10 0 0 01 2 1 2 1 2 2 12 2 2 2 2 2 2 2 ,, , , ,N N N N N N N Nh h h hn n n n n n n n                  
  11 2 20 , .
Nn n    (7) 
Hence the frequency response of (6) can be represented by  
      
1 1
1 22 2
0 0 01 2
ˆ,
N Nj j
H H e e H
 
 
  
 ω ω  (8) 
where  1 2, ω  and  
 
           
     
         
1
2
1
2
1
2 1
1 2
1 1 1 1
0 0 0 01 2 1 22 2 2 2
1
1 1
0 1 22 2
1
1
1 1
0 1 2 1 1 2 2 2 1 1 22 2
2 1
ˆ ˆ 2, cos cos, ,
4 cos cos,
4 .cos cos cos cos,
N
N
N
N N N N
n
N N
n
n
N N
n n
H H h h n n n
h n nn n
h n n n n n n
   
 
   



   

 


 
 
     
  
     



=ω
 (9) 
By defining 
        1 11 1 1 1 00 0 02 22 2 2 2, , , ,2,, 1, 1, 2
T
N NN N N N hh h h N N        h  (10a) 
and 
 
           
            
1 2 1 2
1 2 1 2
1, 2 , 2 , ,cos cos cos cos2 2
4 ,cos cos cos cos1 2 2 1
T
N N N N
   
   
  

    
c ω
 (10b) 
(9) can be represented by 
    0
ˆ TH h cω ω  (11) 
where the superscript T  denotes the transpose operator. Following (8) and (11), the Fourier transform 
representation of (5) is given by 
  
 
44 
A. Design of the initial analysis lowpass filter 
To process the iterative quadratic programming, an initial analysis lowpass filter must be designed first. By 
the specifications shown in Fig. 2, the corresponding error function is given by  
 
       
     
2 2
0 0
2 2
ˆ ˆ1
1
p s
p s
i
R R
T T
R R
T T
i i i
e d dH H
d d
s
 
 
  
 
 
ω ωh ω ω
ω ωh c h cω ω
h p h Q h
 (18) 
where pR  denotes the passband region   1 2 ,,pR     1 2 1 20 , and p         , 
 ,
p
i
R
s d  ω   (19a) 
  2 ,
p
i
R
d p c ωω  (19b) 
         .
p s
T T
i
R R
d d  Q c c ω c c ωω ω ω ω  (19c) 
The initial coefficient vector h , denoted by 0h , can be obtained by differentiating (18) with respect to h  and 
setting the result to zero, which yields 
 10
1
2
.
i i
h Q p   (20) 
B.  Least-squares design of 2-D QMF banks 
For a given weighting function  W ω , the minimization of (17) is progressively achieved by an iterative 
method. In the k-th iteration, the objective error function is defined by  
 
     
         
     
, ,
2
0, 1 0, 1
ˆ ˆ1
             
s
k k kk m k s k
T T
k k k k
R
T T
k k
R
e e e
W dH H
W d

 

 
 
 
 
    

h h h
ωh c h cω ω ω ω ω
h c c h ωω ω ω
 (21) 
where the coefficient vector denoted by the subscript k  is the desired solution in the k-th iteration, and the 
function denoted by the subscript 1k  is computed by  
  
 
46 
 
1-
.
k k
h
k


h h
h
  (27) 
When h  is small enough, for example h inn   where inn  is a very small positive number, the iterative 
process can be stopped. In this chapter, 0.001inn   is used. 
 
Example 1: This example deals with the least-squares design (   1W ω ) of an 25N  2-D QMF bank, and it 
is desirable that the analysis lowpass filter is designed with 0.1p     and 0.1s    . For the choice of 
 , Fig.3(a) presents the curves for the error functions  me h  and  se h  when 0.5  . Obviously, there 
exists a trade-off relationship between  me h  and  se h , and it can be observed that  me h  increases faster 
when 0.05 , so 0.05  is used in this example. As to the choice of  , Fig.3(b) shows the needed 
iteration number for different values of   when 0.05 . From Fig.3(b), it can be found that the iteration 
number is lesser when   is around about 0.5 and the phenomenon also occurs in Section 3, hence 0.5   is 
chosen in this chapter. When 0.05 , 0.5  , the LS design took four iterations and the absolute error of 
overall magnitude response, defined by 
     , ,1E RT  ωω ω  (28) 
is presented in Fig.5(c) where the peak error is 0.01961411. Moreover, to illustrate the convergence of the 
iterative method in this example, the trace of relative norm h  is shown in Fig.5(d). 
C.  Minimax design of 2-D QMF banks 
To further reduce the peak error in Section 2-B, an iterative weighting-updated technique is proposed in this 
section, which constitutes the outer loop of the overall process while the iteration in Section 2-B makes up the 
inner loop. The overall iterative process is illustrated in Fig.4 and described in detail as below: 
 Step 1:  Given N , p , s ,   and  , set   1W ω and find the initial coefficient vector 0h  by (20). 
 Step 2: Set the inner iterative counter 0k . 
  
 
48 
two, two, one, one, , one, respectively, and that would mean thirty-four inner iterations are needed. Fig.5(a) 
and (b) present the magnitude responses of analysis lowpass filter and overall system, respectively, and the 
final absolute error  E ω  is shown in Fig.5(c) where the peak error is 0.01117092. To illustrate the 
convergence of outer iterative process, the trace of relative peak error ratio   is given in Fig.5(e). To peer 
the equiripple characteristics, Fig.5(f) depicts the side views of  E ω  along 1-  and 2-axes. For illustrating 
the convergence of the proposed method, more experiments are processed and the results are tabulated in 
Table 1. Although we cannot give the proof, the results are satfactory. 
 
3. Design of three-dimensional quadrature mirror filters 
In this section, the notation equivalences shown below are employed: 
  1 2 3, ,n n nn ,    1 2 31 1, 1, 1N n N n N n N        n  
  1 2 3, ,z z zz ,  1 2 3, ,z z z    z  
 
1 1 0
1 1 1
0 0 1
 
   
  
M  
  1 2 3, ,  ω ,  1 2 3, ,          ω  
   1 2 3 1 2 3, , , 0 , ,R           
   1 2 3 1 2 3 1 2 3, , , 0 , , andp pR                   
   1 2 3 1 2 3 1 2 3, , , 0 , , ands sR                  
 d ω  denotes a 3-D integral 
For designing a two-channel 3-D QMF bank, the analysis lowpass filter whose passband cutoff contour is 
illustrated in Fig.6 is adopted, and the transfer function is characterized by  
       31 2
1 2 3
1 1 1
0 0 1 2 3 0 1 2 3 1 2 3
0 0 0
, , , ,
N N N
nn n
n n n
H H z z z h n n n z z z
  
 
  
 z  (34) 
where 
  
 
50 
would means totally twenty-one inner iterations are required. The magnitude responses of analysis lowpass 
filter and overall system are presented in Fig.7(a) and (b), respectively, for 3 0  , 3 , 2 3  and  . The 
overlapped magnitude response error along 1-axis  over 2 30 ,     is shown in Fig.7(c) accompanying 
those along 
2
   and 
3
axes  . The peak magnitude error is 0.00665803 in minimax design. Also, more 
experiments are given to illustrate the effectiveness of the proposed method and the results are tabulated in 
Table 2. 
 
4. Conclusion 
In this chapter, a nonlinear optimization for the design of QMF banks has been replaced successfully by the 
proposed iterative method. Both the optimizations for LS sense and minimax sense can be achieved by a nest 
of iterative techniques where the objective error function is minimized for a given weighting function in inner 
loops while the weighting-updated technique is applied to reduce the peak error of overall magnitude response 
in outer loops. Several examples, including design of 2-D and 3-D QMF banks, have been presented to 
demonstrate the effectiveness of the proposed method. 
 
References 
[1] K. Swaminathan, P.P. Vaidyanathan, Theory and design of uniform DFT, parallel, quadrature mirror 
filter banks, IEEE Trans. Circuits Systems 33(12)(1986) 1170–1191. 
[2] P.P. Vaidyanathan, Quadrature mirror filter banks, M-band extensions and perfect-reconstruction 
techniques, IEEE ASSP Magazine 4(3)(1987) 4–20. 
[3] D.B.H. Tay, Design of filter banks/wavelets using TROV: a survey, Digital Signal Processing 7(1997) 
229–238. 
[4] V.K. Jain, R.E. Crochiere, Quadrature mirror filter design in the time domain, IEEE Trans. Acoust. 
Speech, Signal Processing 32(2)(1984) 353–361. 
[5] F. Grenez, Chebyshev design of filters for subband coders, IEEE Trans. Acoust. Speech, Signal 
Processing 36(2)(1988) 182–185. 
  
 
52 
[19] J. Huang, G. Gu, A direct approach to the design of QMF banks via frequency domain optimization, IEEE 
Trans. Signal Processing 46(8)(1998) 2131–2138. 
[20] W.-P. Zhu, M.O. Ahmad, M.N.S. Swamy, An efficient approach for the design of nearly 
perfect-reconstruction QMF banks, IEEE Trans. Circuits Syst. II, Analog, Digit. Signal Processing 
45(8)(1998) 1161–1165.  
[21] C.-K. Goh, Y.C. Lim, C.S. Ng, Improved weighted least-squares algorithm for the design of quadrature 
mirror filters, IEEE Trans. Signal Processing 47(7)(1999) 1866–1877.  
[22] H.-C. Chao, Two-channel filter banks satisfying low-delay and perfect-reconstruction design, Signal 
Processing 80(3)(2000) 465-479. 
[23] F. Al-Namiy, M.J. Nigam, On the design of 2-band FIR QMF filter banks using WLS technique, in Proc. 
4
th
 International Conference/ Exhibition on High Performance Computing in the Asia-Pacific Region, 
May 2000, pp. 772–776. 
[24] A.P, Vinod, A.B. Premkumar, L.C. Tong, A novel approach to the design of weighted minimax 
quadrature mirror filters, International Symposium on Signal Processing and Its Applications, Aug. 2001, 
pp. 33–35. 
[25] J. Kliewer, E. Brka, Near-perfect-reconstruction low-complexity two-band IIR/FIR QMF banks with FIR 
phase-compensation filters, Signal Processing 86(1)(2006) 171-181. 
[26] Y.-D. Jou, Design of two-channel linear-phase quadrature mirror filter banks based on neural networks, 
Signal Processing 87(5)(2007) 1031-1044. 
[27] C.-W. Kok, W.-C. S, Y.-M. Law, Peak constrained least-squares QMF banks, Signal Processing 
88(1)(2008) 2363-2371. 
[28] M. Vetterli, Multi-dimensional sub-band coding: some theory and algorithms, Signal Processing 
6(2)(1984) 97-112. 
[29] S.-C. Pei, S.-B. Jaw, Design of 2-D quadrature mirror FIR filters for image subband coding, IEEE Trans 
Circuits Systems 34(4)(1987) 438–441. 
[30] E.P. Simoncelli, E. H. Adelson, Non-separable extensions of quadrature mirror filters to multiple 
dimensions, Proceeding IEEE 78(4)(1990) 652–664. 
  
 
54 
[42] K.S.C. Pun, T.Q. Nguyen, A novel and efficient design of multidimensional PR two-channel filter banks 
with Hourglass-shaped passband support, IEEE Signal Process. Letter 11(3)(2004) 345–348. 
[43] B.D. Patil, P.G. Patwardhan, V.M. Gadre, Eigenfilter approach to the design of one-dimensional and 
multidimensional two-channel linear-phase FIR perfect reconstruction filter banks, IEEE Trans. Circuits 
Syst. І, Reg. Papers 55(11)(2008) 3542–3551. 
[44] M.D. Adams, D. Xu, Optimal design of high-performance separable wavelet filter banks for image 
coding, Signal Processing 90(1)(2010) 180-196. 
[45] D.B.H. Tay, N.G. Kingsbury, Design of nonseparable 3-D filter banks/wavelet bases using 
transformations of variables, IEE Proc.-Vis. Image Signal Processing 143 (1)(1996) 51–61. 
[46] H. Benoit-Cattin, A. Baskurt, F. Turjman, R. Prost, 3D medical image coding using separable 3D wavelet 
decomposition and lattice vector quantization, Signal Processing 59(2)(1997) 139-153. 
[47] D.B.H. Tay, Analytical design of 3-D wavelet filter banks using the multivariate Bernstein polynomial, 
IEE Proc.-Vis. Image Signal Processing 147(2)(2000) 122–130. 
[48] C.-Y. Chi, Y.-T. Kou, A new self-initiated optimum WLS approximation method for the design of 
linear-phase FIR digital filters, in Proc. 1991 IEEE  ISCAS, June 1991, pp. 168–171. 
[49] C.-Y. Chi, S.-L. Chiou, A new self-initiated WLS approximation method for the design of 
two-dimensional equiripple FIR digital filters, in Proc. 1992 IEEE ISCAS, May 1992, pp. 1436–1439. 
[50] C.-Y. Chi, S.-L. Chiou, A new iterative WLS Chebyshev approximation method for the design of 
two-dimensional FIR digital filters, in Proc. 1993 IEEE ISCAS, May 1993, pp. 898–901. 
  
 
56 
 
 
 
H0(z) ↓M F0(z)↑M
H1(z) ↓M F1(z)↑M
 xˆ n x n
 
(a) 
 
 
 
 
H0(z) ↓M 2H0(z)↑M
2H0(-z) ↓M H0(-z)↑M z1z1
-1
 xˆ n x n
 
(b) 
 
 
Fig. 1. (a) A general two-channel QMF bank. (b) Aliasing-free QMF bank used in this paper. 
stopband
passband
0 1
0
0.5
0.5
1
Normalized frequency 1/ π
N
o
rm
al
iz
ed
 f
re
q
u
en
cy
  
 
2
/π
1 2 p
   
1 2 s
   
N
o
rm
al
iz
ed
 f
re
q
u
en
cy
  
 
2
/π
 
 
 
Fig. 2. Specifications of analysis lowpass filter in the first quadrant for the 2-D QMF bank. 
  
 
58 
Initiation
 0
, , , , ,
, 1
p sN ω ω α β
W h ω
k=0
k       k+1
Calculate
 0 -1 0
00 0
ˆ , , ,
, , ,
,kH 
 
p pω
Q Q Q Q
Find by (25)kh
Update by (26)kh
h inn 
Find , ,ir δ ρ
out 
Stop
Yes
Yes
No
Update
by (31)~(33)
 W ω
0h kh
No
 
 
 
 
Fig. 4.  Flowchart of the overall iterative process for minimax design of QMF banks. 
  
 
60 
 
 
Fig. 6. Passband cutoff contour of the analysis lowpass filter for a 3-D QMF bank. 
 
 
 
 
 
 
(a) 
 
 
Fig.7 Minimax design of a 3-D QMF bank. (a) Magnitude response of analysis lowpass filter at 3 0  , 3 , 2 3  and  . (b) 
Magnitude response of overall system at 3 0  , 3 , 2 3  and  . (c) Side views of magnitude response error along 1- , 2 - , 
and 3-axes.  
 
 62 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                                99 年 10 月 25 日 
報告人姓名  
徐忠枝 
 
服務機構 
及職稱 
 國立高雄大學 
 電機工程學系 
 教授 
     時間 
會議 
     地點 
 2010年 10月 15~17日 
 
 德國 Darmstadt 
本會核定 
補助文號 
 
 NSC 99-2221-E-390-005 
會議 
名稱 
 (中文) 第六屆智慧型資訊隱藏及多媒體訊號處理國際研討會 
 (英文) The Sixth International Conference on Intelligent Information Hiding 
and Multimedia Signal Processing 
發表 
論文 
題目 
 (中文) 以巢狀馬克龍轉換法設計三維 FIR錐形濾波器 
 (英文) Design of 3-D FIR Cone-Shaped Filters by a Nest of McClellan 
Transformations 
 64 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
 
   
 
   
 
Fig.  Isopotential surfaces of 3-D FIR cone-shaped filters at 
magnitude 0.98  when θ 35 , 45 , 55 , 65 , 75  and 85 . 
 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                                99 年 10 月 25 日 
報告人姓名  
徐忠枝 
 
服務機構
及職稱 
 國立高雄大學 
 電機工程學系 
 教授 
     時間 
會議 
     地點 
 2010 年 10 月 15~17 日 
 
 德國 Darmstadt 
本會核定
補助文號
 
 NSC 99-2221-E-390-005 
會議 
名稱 
 (中文) 第六屆智慧型資訊隱藏及多媒體訊號處理國際研討會 
 (英文) The Sixth International Conference on Intelligent Information Hiding 
and Multimedia Signal Processing 
發表 
論文 
題目 
 (中文) 以巢狀馬克龍轉換法設計三維 FIR 錐形濾波器 
 (英文) Design of 3-D FIR Cone-Shaped Filters by a Nest of McClellan 
Transformations 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
 
   
 
   
 
Fig.  Isopotential surfaces of 3-D FIR cone-shaped filters at 
magnitude 0.98  when θ 35= o , 45o , 55o , 65o , 75o  and 85o . 
 
  
Abstract—In this paper, the technique of a nest of McClellan 
transformations is proposed for the design of 3-D FIR cone- 
shaped filters. First, a transformation subfilter for fan-type 
mapping is found. Then the cosine term of a frequency variable of 
the above transformation subfilter is replaced by an embedded 
transformation subfilter which possesses circular contours. 
Several examples will be presented to demonstrate the 
effectiveness of the proposed method. 
 
Index Terms—Cone-shaped filter, finite-impulse-response 
(FIR) filter, three-dimensional (3-D) filter, McClellan 
transformation, least-squares method. 
 
I. INTRODUCTION 
OR designing a 3-D cone-shaped filter, the ideal cone shape, 
which is illustrated in Fig. 1, can be described by 
 ( )
2
2 2 3
1 2 2tan θ
ω
ω ω+ =  (1) 
where θ  denotes the angle between the cone-surface and the 
( )1 2,ω ω -plane. Recently, the design of 3-D cone-shaped filters 
has received considerable attention due to their wide 
applications in areas such as processing of geological and 
seismological data, sonar and radar engineering, and motion 
discrimination [1]–[8]. Among the existing literature, it is 
impressive for [7] and [8] in which the technique of McClellan 
transformation is applied to the design of 3-D FIR cone-shaped 
filters. 
  In the design of 2-D FIR digital filters, McClellan transfor- 
mation plays a dominant role [9]–[14]. Applying the technique, 
a high-order 1-D prototype filter and a low-order 2-D 
transformation subfilter are designed, respectively, then the 
1-D prototype filter is mapped into a 2-D filter by a change of 
variables. 
  In this paper, the design of 3-D FIR cone-shaped filters is 
investigated by a nest of McClellan transformations. First, a 
2-D FIR fan-type filter with inclination θ  is designed by 
McClellan transformation and the following substitution is 
used: 
( ) ( ) ( ) ( ) ( )00 10 01 3 11 312 12cos cos cos cos cost t t tω ωω ωω = + + +  (2) 
 
 
 
The design specification is illustrated in Fig. 2(a). Then, the 
tern ( )12cos ω  in (2) is replaced by 
( ) ( ) ( ) ( ) ( )00 10 01 1112 1 2 1 2cos cos cos cos cosr r r rω ω ω ω ω= + + +   (3) 
and the circular cutoff contour shown in Fig. 2(b) is required to 
meet an ideal one as much as possible. To find the coefficients 
in (2) and (3), some constraints are incorporated in this paper 
such that scaling problem can be avoided.  
 
II. DESIGN OF 3-D FIR CONE-SHAPED FILTERS BY A NEST OF 
MCCLELLAN TRANSFORMATIONS 
For a zero-phase FIR digital filter, its frequency response can 
be represented by  
( ) ( )
0
cos .
N
n
n
H a n
=
ω = ω∑                         (4) 
Replacing ( )cos nω  in (4) by the th - ordern Chebyshev 
polynomial, (4) becomes 
 ( ) ( )[ ]
0
cos .
N
n n
n
H a T
=
ω = ω∑   (5) 
Generally, for designing a 3-D FIR digital filter by McClellan 
transformation the substitution shown below is used 
( ) ( )
( ) ( ) ( )
( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( )
1 2 3
000 100 1 010 2 001 3
110 1 2 101 1 3
011 2 3 111 1 2 3
cos , ,
cos cos cos
cos cos cos cos
cos cos cos cos cos
F
t t t t
t t
t t
ω = ω ω ω
= + ω + ω + ω
+ ω ω + ω ω
+ ω ω + ω ω ω
 (6) 
and  the frequency response of the designed 3-D FIR filter is  
 ( ) ( )1 2 3 1 2 3
0
, , , , .
N
n n
n
H a T F
=
⎡ ⎤ω ω ω = ω ω ω⎣ ⎦∑   (7) 
  To determine the transformation coefficients in (6), the 
technique of a nest of McClellan transformations is applied. 
First, a 2-D transformation subfilter for designing a 2-D 
fan-type filter with inclination θ  is achieved by the 
substitution (2) and it is desirable that the cutoff contour shown 
in Fig. 2(a) can be met as much as possible. In Fig. 2(a), 
 ( )
, if 45 ,
tan , if 45 .up
⎧ π θ ≤
ω = ⎨π θ θ >⎩
D
D   (8) 
Design of 3-D FIR Cone-Shaped Filters by a Nest of 
McClellan Transformations 
F
 
Jong-Jy Shyu*, Soo-Chang Pei** and Yun-Da Huang** 
*Department of Electrical Engineering, National University of  Kaohsiung, Taiwan 
**Graduate Institute of Communication Engineering, National Taiwan University, Taiwan 
 
2010 Sixth International Conference on Intelligent Information Hiding and Multimedia Signal Processing
978-0-7695-4222-5/10 $26.00 © 2010 IEEE
DOI 10.1109/IIHMSP.2010.44
147
 00 11r r= −   (14a) 
 1 .01 10 2r r= =   (14b) 
Hence the corresponding objective error function can be 
represented by 
 
( ) ( ) ( ) ( )
( ) ( )
1 1
11 12 1 22 2
2
11 11 1 2
2
11 11
cos cos cos
cos cos
c
c
c c c
e r
r r dl
s r r r q
⎡= ω − ω − ω⎣
⎤+ − ω ω ⎦
= + +
∫
  (15) 
where 
c
dl⋅∫  denotes a line integral along the circular cutoff 
contour shown in Fig. 2(b), 
 ( ) ( ) ( ) 21 112 1 22 2cos cos cos ,c c
c
s dl⎡ ⎤= ω − ω − ω⎣ ⎦∫   (16a) 
 
( ) ( ) ( )
( ) ( )
1 1
12 1 22 2
1 2
2 cos cos cos
cos cos 1 ,
c c
c
r
dl
⎡ ⎤= − ω − ω − ω⎣ ⎦
⎡ ⎤ω ω −⎣ ⎦
∫   (16b) 
 ( ) ( ) 21 2cos cos 1 .c
c
q dl⎡ ⎤= ω ω −⎣ ⎦∫   (16c) 
Obviously, for a given 12cω , ( )11 2c cr r q= − . Also the proper 
frequency point 12cω , which is mapped into the circular cutoff 
contour shown in Fig. 2(b), must be determined by choosing the 
frequency 12ω  where ( )11e r  is minimum.   
 D. Derivation of the Filter Coefficients for the 3-D 
Cone-Shaped Filter 
Substituting (10) and (14) into (9), it results in  
 
( )
( )
000 11 01 11 11
1
100 010 012
001 01 11 11
110 01 11
1
101 011 112
111 11 11
1
1
,
t t t r r
t t t
t t t r
t t r
t t t
t t r
= − −⎧⎪⎪ = = +⎪⎪ = −⎪⎨
= +⎪⎪
= =⎪⎪⎪ =⎩
  (17) 
and the filter coefficients of a 3-D FIR cone-shaped filter can be 
obtained by decomposing the recurrence relations in (7).  
E. Examples and Comparison 
To demonstrate the effectiveness of the proposed method, 
the results for 35 θ 85≤ ≤D D  are tabulated in Table Ⅰ, and the 
isopotential surfaces at magnitude 0.98  for θ 35= D , 45D , 55D , 
65D , 75D  and 85D  are presented in Fig. 3 where the 1-D 
prototype filter is designed with 20N = , passband [ ]0, cω , and 
stopband [ ]0.1 ,cω π π+ . For comparing with the work in [8], 
the  
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 3 Isopotential surfaces of 3-D FIR cone-shaped filters at magnitude 
0.98  when θ 35= D , 45D , 55D , 65D , 75D  and 85D . 
 
149
國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/04
國科會補助計畫
計畫名稱: 三維FIR錐形數位濾波器及其可調式之設計
計畫主持人: 徐忠枝
計畫編號: 99-2221-E-390-005- 學門領域: 訊號處理
無研發成果推廣資料
Processing, 
vol.91, no.4, 
pp.1730-1740, 
April 2011. 
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
1.Jong-Jy Shyu, 
Soo-Chang Pei and 
Yud-Da 
Huang, ’Design of 
3-D FIR cone-shaped 
filters by a nest of 
McClellan 
transformations,’ 
Proceeding of The 
Sixth 
International 
Conference on 
Intelligent 
Information Hiding 
and Multimedia 
Signal Processing, 
Darmstadt, 
Germany, October 
15~17, 2010. 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
其他成果 
(無法以量化表達之
成果如辦理學術活
動、獲得獎項、重要
國際合作、研究成果
國際影響力及其他協
助產業技術發展之具
體效益事項等，請以
文字敘述填列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
科 測驗工具(含質性與量性) 0  
