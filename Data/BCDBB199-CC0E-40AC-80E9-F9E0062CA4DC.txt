 1
  
Abstract—In this paper, the design of wideband fractional 
delay FIR filter is investigated. First, the recovery method of 
simultaneous sampling of a signal and its derivative is reviewed 
briefly. Then, the reconstruction formula of derivative sampling is 
applied to design fractional delay FIR filter by using index 
substitution and window method. The filter coefficients are easily 
computed because closed-form design is obtained. Finally, design 
examples are demonstrated to show the proposed method has 
smaller design error than the conventional fractional delay FIR 
filters without sampling the derivative of signal. 
 
Index Terms—Fractional delay filter, derivative sampling, FIR 
filter, window method 
 
I. INTRODUCTION 
N many signal processing applications, there is a need for a 
delay that is a fractional of the sampling period. These 
applications include beam steering of antenna array, time 
adjustment in digital receivers, modeling of music instruments, 
speech coding and synthesis, comb filter design and analog 
digital conversion, etc. [1]-[7]. An excellent survey of the 
fractional delay filter design is presented in tutorial paper [1]. 
The ideal frequency response of fractional delay filter is given 
by 
                          
Dj
d eH
ωω −=)(                          (1) 
where D  is a positive real number in the desired range. Taking 
the inverse discrete-time Fourier transform, the ideal impulse 
response is  
      
)(
)(
2
1)(
Dnsinc
deHnh njdid
−=
= ∫− − ωωπ
π
π
ω
          (2) 
where )/()sin()( tttsinc ππ= . So far, the fractional delay 
filters are all designed under the Shannon sampling scheme, as 
shown in Fig.1(a). In this case, the frequency response of the 
FIR filter used to approximate this specification is given by 
                         ∑
=
−=
N
n
njj enheH
0
)()( ωω                  (3)  
Thus, the traditional design problem is how to determine the 
filter )( zH  such that the actual frequency response )( ωjeH  
fits the ideal response )(ωdH  as well as possible. So far, 
several methods have been proposed to solve this design 
problem such as window method, Lagrange interpolation 
 
 
method and Fourier transform interpolation method etc. 
   On the other hand, there exist various sampling methods in 
the literature except the Shannon sampling scheme. Some 
typical ones are band-pass sampling, interlaced sampling, 
derivative sampling and generalized sampling etc [8]-[10]. 
Thus, it is interesting to design fractional delay filter based on 
other sampling schemes. In this paper, we will use the 
derivative sampling method to design fractional delay filter 
which is composed of two filters )(1 zH  and )(2 zH , as 
depicted in Fig.1(b). Because )(' nx  is the first-order 
derivative of )(nx , it is easy to show that the 
frequency-domain relation between input and output in Fig.1(b) 
is given by 
        )()(
)(
)(
21
ωω
ω
ω
ω jjj
j
eHjeH
eX
eY +=        (4)  
where )( ωjeX  and )( ωjeY  are the Fourier transforms of 
)(nx  and )(ny . Thus, the design problem is how to 
determine the filters )(1 zH  and )(2 zH  such that the actual 
frequency response )()( 21
ωω ω jj eHjeH +  
approximates the ideal response )(ωdH  as well as possible. 
In next sections, the details for this design will be described.  
II. DESIGN BASED ON SHANNON SAMPLING SCHEME 
In this section, the design of fractional delay filter based on 
Shannon sampling scheme is described briefly because the 
proposed method is an extension of this method. The 
well-known Shannon sampling theorem is first described 
below: Let )(nx  be the uniform samples of the band-limited 
signal )(tx  with frequencies no higher than maxf , then the 
)(tx  can be reconstructed by using the formula:  
                    ∑∞
−∞=
−=
m
mtsincmxtx )()()(              (5)  
if the sampling rate is greater than max2 f . In the following, the 
index substitution will be used to obtain filter coefficients 
)(nh  in Eq.(3). Using the index substitution knm −= , 
Eq.(5) can be rewritten as  
              ∑∞
−∞=
+−−=
k
kntsincknxtx )()()(            (6)  
Let Dnt −= , then Eq.(6) can be expressed as 
           
)()(
)()()(
nxnh
DksincknxDnx
id
k
∗=
−−=− ∑∞
−∞=        (7)  
Design of Wideband Fractional Delay FIR Filter 
Based on Derivative Sampling Scheme 
I 
 3
where )()()( 21
ωωω ω jjj eHjeHeH +=  for the 
proposed design. Obviously, the smaller NRMS error E  has, 
the better performance the design method has.  
Example 1: In this example, we compare the proposed method 
with conventional Shannon sampling method in section II. The 
filter order is chosen as 60=N  and window )(nw  is 
rectangular widow below:  
                       
⎩⎨
⎧ ≤≤=
otherwises
Nn
nw
0
01
)(                  (21)  
Fig.2 shows the NRMS error curve E  (solid line) of the 
proposed method for various delay D . The dashed line is the 
result of conventional Shannon sampling method. It is clear that 
the error of proposed method is smaller than the conventional 
method. Fig.3(a)(b) show the magnitude response and group 
delay of fractional delay filter designed by proposed method for 
60=N  and 5.30=D . Fig.3(c)(d) show the magnitude 
response and group delay of fractional delay filter designed by 
conventional method for 60=N  and 5.30=D . Obviously, 
the proposed method has smaller design error in the high 
frequency range than Shannon sampling method.  
Example 2: In this example, we will compare the proposed 
method with conventional Lagrange method whose filter 
coefficients are given by  
                             ∏
≠= −
−=
N
nkk kn
kDnh
,0
)(                    (22)  
When the filter order is chosen as 60=N  and )(nw  is 
rectangular widow, Fig.4 shows the NRMS error curves E  of 
the proposed method and Lagrange method for various delay 
D . Obviously, the error of proposed method is smaller than 
the Lagrange method. Fig.5(a)(b) show the magnitude response 
and group delay of fractional delay filter designed by Lagrange 
method for 60=N  and 5.30=D . Compared Fig.5 with 
Fig.3(a)(b), it is clear that the proposed method has smaller 
design error in the high frequency range than conventional 
Lagrange method.  
Finally, it worth mentioning that if derivative signal )(' nx  
is not given by sampling )(' tx , it can be obtained easily by 
passing )(nx  through a digital differentiator )( zG  which 
has been well studied in the literature [11]. In this case, the 
frequency response of filter )()()()( 21 zHzGzHzH +=  
will approximate ideal response )(ωdH  in Eq.(1) well. Thus, 
the proposed design method is still valid even though the 
derivative signal )(' nx  is absent and only )(nx  is given.  
V. CONCLUSION 
In this paper, the fractional delay FIR filter has been designed 
by using derivative sampling scheme. The experimental results 
show that the proposed design method has smaller design errors 
than the conventional methods with the help of extra derivative 
samples. However, only the case of first-order derivative is 
considered here. Thus, it is interesting to design fractional 
delay FIR filter by using high-order derivative sampling 
scheme in the future. 
REFERENCES 
[1] T. I. Laakso, V. Valimaki, M. Karjalainen and U.K. Laine, 
"Splitting the unit delay: tool for fractional delay filter design," 
IEEE Signal Processing Magazine, pp.30-60, Jan. 1996. 
[2] S.C. Pei, P.H. Wang and H.S. Lin, “Closed-form design of 
maximally flat FIR fractional delay filter,” IEEE Signal 
Processing Letters, vol.13, pp.405-408, July 2006. 
[3] T.B. Deng, "Coefficient-symmetries for implementing 
arbitrary-order Lagrange-type variable fractional-delay digital 
filters," IEEE Trans. on Signal Processing, vol.55, pp.4078-4090, 
Aug. 2007. 
[4] T.B. Deng, "Symmetric structures for odd-order maximally flat 
and weighted-least-squares variable fractional-delay filters," 
IEEE Trans. on Circuits and Systems-I: Regular Papers, vol.54, 
pp.2718-2732, Dec. 2007. 
[5] C.C. Tseng and S.L. Lee, "Design of fractional delay FIR filter 
using discrete Fourier transform interpolation method," Proc. 
2008 IEEE Int. Symp. Circuits Syst., pp.1156-1159, May 2008. 
[6] J.J. Shyu and S.C. Pei, "A generalized approach to the design of 
variable fractional-delay FIR digital filters," Signal Processing, 
vol.88, pp.1428-1435, June 2008. 
[7] J.J Shyu, S.C. Pei, C.H. Chan and Y.D. Huang, “Minimax design 
of variable fractional-delay FIR digital filters by iterative 
weighted least-squares approach,” IEEE Signal Processing 
Letters, vol.15, pp.693-696, 2008. 
[8] A. Papoulis, Signal Analysis, McGraw-Hill, 1977. 
[9] R.N. Bracewell, The Fourier Transform and Its Applications, 
Third Edition, McGraw-Hill, 2000. 
[10] D.A. Linden, "A discussion of sampling theorem," Proc. of The 
IRE, pp.1219-1226, July 1959. 
[11] C.C. Tseng, “Stable IIR digital differentiator design using 
iterative quadratic programming approach,” Signal Processing, 
vol.80, pp.857-866, 2000. 
 
 
 
Fig.1 Design of fractional delay filter based on two different 
sampling schemes. (a) Conventional Shannon sampling scheme. 
(b) Derivative sampling scheme. The x’(n) is the derivative of 
x(n). 
 
x(t)
sampling 
x(n) H(z) 
y(n) 
≈ x(n-D) 
(a) sampling 
(b) 
x’(t) 
x(t) x(n) H1(z) 
sampling 
x’(n) H2(z) 
y(n) 
≈ x(n-D)
WIDEBAND FRACTIONAL DELAY FILTER DESIGN BASED ON INTERLACED 
SAMPLING METHOD 
Chien-Cheng Tseng1 and Su-Ling Lee2 
      1Depart. of Computer and Communication Engineering               2Depart. of Computer Sci. and Information Engi. 
National Kaohsiung First University of Sci. and Tech.                               Chung-Jung Christian University 
Kaohsiung, Taiwan                                                                              Tainan, Taiwan 
tcc@ccms.nkfust.edu.tw                                                                  lilee@mail.cjcu.edu.tw
ABSTRACT 
In this paper, the design of wideband fractional delay filter 
is investigated. First, the reconstruction formula of inter-
laced sampling method is applied to design wideband frac-
tional delay filter by using index substitution and window 
method. The filter coefficients are easily computed because 
closed-form design is obtained. Then, the weighted least 
squares method is used to design wideband fractional delay 
filters. Finally, numerical examples are demonstrated to 
show that the proposed method has smaller design error 
than the conventional fractional delay filter without using 
the interlaced sampling scheme. 
1. INTRODUCTION 
   In many signal processing applications, there is a need for a 
delay that is a fraction of the sampling period. These applica-
tions include beam steering of antenna array, time adjustment 
in digital receivers, modeling of music instruments, speech 
coding and synthesis, image interpolation and comb filter 
design etc [1]-[8]. An excellent survey of the fractional delay 
filter design is presented in tutorial paper [1]. The ideal fre-
quency response of fractional delay filter is given by 
                           Djd eH
ωω −=)(                            (1) 
where D  is a positive real number in the desired range. So 
far, the fractional delay filters are all designed under the 
Shannon sampling scheme, as shown in Fig.1. Usually, the 
Shannon sampling scheme is implemented by using one ana-
log-to-digital (ADC) converter. In this case, the frequency 
response of the FIR filter used to approximate this specifica-
tion is given by 
                        ∑
=
−=
N
k
kjj ekheH
0
)()( ωω                  (2)  
Thus, the traditional design problem is how to determine the 
filter )(zH  such that the actual frequency response 
)( ωjeH  fits the ideal response )(ωdH  as well as possible. 
Until now, several methods have been proposed to solve this 
design problem such as window method, Lagrange interpola-
tion method, maximally flat method, weighted least squares 
method and discrete Fourier transform method etc. In these 
designs, the frequency response error is defined by 
           )()()(1 ωω ω dj HeHE −=             (3) 
If the filter coefficients )(kh  in Eq.(2) are real-valued, the 
frequency response error at πω =  is given by 
  
)sin()]cos()1([
)1(
)()()(1
DjDH
eH
HeHE
Dj
d
j
ππ
ππ
π
π
+−−=
−−=
−=
−  (4) 
Thus, the absolute value of error )(1 πE  can be written as 
  
|)sin(|
)][sin()]cos()1([|)(| 221
D
DDHE
π
πππ
≥
+−−=   (5) 
So, there is an irreducible error at πω =  for conventional 
designs [2]. This means that the wideband fractional delay 
filter design can not be achieved by using Shannon sampling 
scheme in Fig.1. Therefore, it is interesting to use other sam-
pling methods to design wideband fractional delay filter. 
   In the literature, there exist various sampling methods ex-
cept the Shannon sampling scheme. Some typical ones are 
band-pass sampling, interlaced sampling, derivative sam-
pling and generalized sampling etc [9][10]. Thus, it is inter-
esting to design wideband fractional delay filter based on 
these sampling schemes. In this paper, we will use the inter-
laced sampling method to design fractional delay filter which 
is composed of two filters )(1 zG  and )(2 zG , as depicted 
in Fig.2. Usually, the interlaced sampling scheme is imple-
mented by using two parallel analog-to-digital converters 
with different control clocks. Because )( τ−nx  is the de-
layed version of )(nx , it is easy to show that the frequency-
domain relation between input and output in Fig.2 is given 
by 
     )()(
)(
)(
21
ωωτω
ω
ω
jjj
j
j
eGeeG
eX
eY −+=     (6) 
where )( ωjeX  and )( ωjeY  are the Fourier transforms of 
)(nx  and )(ny . Thus, the design problem is how to de-
termine the filters )(1 zG  and )(2 zG  such that the actual 
frequency response )()( 21
ωωτω jjj eGeeG −+  approxi-
mates the ideal response )(ωdH  as well as possible. In this 
case, the frequency response error is defined by  
   )()()()( 212 ωω ωωτω djjj HeGeeGE −+= −   (7) 
18th European Signal Processing Conference (EUSIPCO-2010) Aalborg, Denmark, August 23-27, 2010© EURASIP, 2010   ISSN 2076-1465 55
proposed filters )(1 zG , )(2 zG  and conventional filter 
)(zH  can be evaluated by using Eq.(2) and Eq.(20). If the 
direct-form realization is used, the number of adders and 
multipliers to implement filter )(zH  in Fig.1 are N  and 
1+N , while the number of adders and multipliers to imple-
ment FIR filters )(1 zG  and )(2 zG  in Fig.2 are 
)(
2
1
∑
=
−
i
ibiu NN  and )1(
2
1
∑
=
+−
i
ibiu NN . In the ADC part, it 
can be observed that the interlaced sampling method needs 
one more ADC than the Shannon sampling method. In the 
next subsection, one numerical example will be studied. 
2.2 Design Example and Comparison 
In the following, one numerical example performed with 
MATLAB language in an IBM PC compatible computer is 
used to demonstrate the effectiveness of the proposed win-
dow method. To evaluate the performance, the normalized 
root mean squares (NRMS) error is defined by 
          %100
)(
)()(
2
1
2
0
2
0 ×
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜
⎝
⎛ −=
∫
∫
ωω
ωω
π
π ω
dH
dHeG
E
d
d
j
   (23) 
where )()()( 21
ωωτωω jjjj eGeeGeG −+=  in 
the proposed design approach. Obviously, the smaller NRMS 
error E  is, the better performance the design method is. If 
)( ωjeG  in Eq.(23) is changed to )( ωjeH , E  is the 
NRMS error of conventional design. In this paper, the E  is 
computed by using numerical rectangular integration method 
with step size 1000
π . Now, let us study an example below: 
Example 1: In this example, we will compare the proposed 
method with conventional window method based on Shan-
non sampling scheme. To achieve this purpose, the conven-
tional window method is briefly described below: Taking the 
inverse discrete-time Fourier transform of ideal frequency 
response )(ωdH , the ideal impulse response is given by 
          
)(
)(
2
1)(
Dksinc
deHkh kjdid
−=
= ∫− ωωπ
π
π
ω
     (24) 
In the conventional window method, the filter coefficients 
)(kh  in Eq.(2) are given by 
                      )()()( khkwkh id=                        (25) 
where )(kw  is a prescribed window function of length 
1+N . A numerical example is now studied. The parame-
ters are chosen as 4121 == bb NN , 6021 == uu NN , 
5.0=τ  and 100=N . Fig.3 shows the NRMS error 
curve E  (solid line) of the proposed method for various 
delay D  with step size 40
1 . The dashed line is the result of 
conventional rectangular window method based on Shannon 
sampling scheme with 1)( =kw  for Nk ≤≤0 . It is 
clear that the error of proposed method is smaller than the 
conventional method. Fig.4(a)(b) show the magnitude re-
sponse and group delay of fractional delay filter designed by 
proposed method for 5.0=τ , 4121 == bb NN , 
6021 == uu NN  and 4.50=D . Fig.4(c)(d) show the 
magnitude response and group delay of fractional delay filter 
designed by conventional rectangular window method for 
100=N  and 4.50=D . Obviously, the proposed method 
has smaller design error in the high frequency range than 
Shannon sampling method. That is, the wideband design can 
be accomplished by the proposed method based on interlaced 
sampling scheme. Now, the complexity issue is addressed. 
Because 4121 == bb NN , 6021 == uu NN  and 
100=N  are chosen, the number of adders and multipliers 
to implement two filters )(1 zG  and )(2 zG  are 38 and 40, 
while the number of adders and multipliers to implement 
filter )(zH  are 100 and 101. Obviously, the implementation 
complexity of )(1 zG  and )(2 zG  is smaller than that of 
)(zH . Although the filter-part accuracy and complexity of 
proposed method is better than conventional method, the 
proposed method needs one more ADC than the conventional 
method, as shown in Fig.1 and Fig.2. Thus, the improvement 
in filter part is at the cost of the increase of complexity in the 
ADC part. 
3. WEIGHTED LEAST SQUARES METHOD 
In this section, the weighted least squares (WLS) method 
is first used to design fractional delay filter whose coeffi-
cients can be obtained by solving matrix inversion. Then, 
numerical comparison with conventional WLS design is 
made. 
3.1 Design method 
    Taking ωjez = , the frequency response of filters )(1 zG  
and )(2 zG  in Eq.(20) can be written as 
       2,1)()( == ∑
=
− iekgeG
iu
ib
N
Nk
kj
i
j
i
ωω          (26) 
Thus, the frequency response )()( 21
ωωτω jjj eGeeG −+  
is gotten as 
  
)(
21
21
)()(
)()(
)(
2
2
1
1
τωω
ωωτω
ω
+−
=
−
=
−
∑∑ +=
+=
kj
N
Nk
kj
N
Nk
jjj
j
ekgekg
eGeeG
eG
u
b
u
b
 (27) 
Defining the following four vectors 
 Tubb NgNgNg ])()1()([ 1111111 L+=g   (28a) 
 Tubb NgNgNg ])()1()([ 2222222 L+=g  (28b) 
 TNjNjNj ubb eee ][)( 111 )1(1
ωωωω −+−−= Le        (28c) 
 TNjNjNj ubb eee ][)( )()1()(2 222
τωτωτωω +−++−+−= Le  (28d) 
then the frequency response in Eq.(27) can be rewritten as 57
[4] T.B. Deng, "Coefficient-symmetries for implementing 
arbitrary-order Lagrange-type variable fractional-delay 
digital filters," IEEE Trans. on Signal Processing, vol.55, 
pp.4078-4090, Aug. 2007. 
[5] T.B. Deng, "Symmetric structures for odd-order maxi-
mally flat and weighted-least-squares variable fractional-
delay filters," IEEE Trans. on Circuits and Systems-I: 
Regular Papers, vol.54, pp.2718-2732, Dec. 2007. 
[6] C.C. Tseng and S.L. Lee, "Design of fractional delay 
FIR filter using discrete Fourier transform interpolation 
method," Proc. 2008 IEEE Int. Symp. Circuits Syst., 
pp.1156-1159, May 2008. 
[7] J.J Shyu, S.C. Pei, C.H. Chan and Y.D. Huang, “Mini-
max design of variable fractional-delay FIR digital fil-
ters by iterative weighted least-squares approach,” IEEE 
Signal Processing Letters, vol.15, pp.693-696, 2008. 
[8] Y.D. Huang, S.C. Pei and J.J. Shyu, “WLS design of 
variable fractional-delay FIR filters using coefficient re-
lationship,” IEEE Trans. on Circuits and Systems-II: Ex-
press Briefs, vol.56, pp.220-224, Mar. 2009. 
[9] R.N. Bracewell, The Fourier Transform and Its Applica-
tions, Third Edition, McGraw-Hill, 2000. 
[10] F. Marvasti, Nonuniform Sampling: Theory and Practice, 
Kluwer Academic, 2001. 
[11] P.S.R. Diniz, E.A.B. da Silva and S.L. Netto, Digital 
Signal Processing: System Analysis and Design, Cam-
bridge University Press, 2002. 
 
 
 
 
 
 
 
 
 
Fig.1 The design of fractional delay filter based on Shannon 
sampling scheme implemented by one analog-to-digital con-
verter (ADC). 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig.2 The design of fractional delay filter based on interlaced 
sampling scheme implemented by two parallel analog-to-
digital converters with different control clocks. 
45 46 47 48 49 50 51 52 53 54 55
0
2
4
6
8
10
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
 
Fig.3 The NRMS error curve E  (solid line) of the proposed 
window method for various delay D . The dashed line is the 
result of conventional Shannon sampling window method. 
0 0.5 1
0
0.5
1
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se
(c)
0 0.5 1
49
50
51
52
normalized frequency
gr
ou
p 
de
la
y
(d)
0 0.5 1
0
0.5
1
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se
(a)
0 0.5 1
49
50
51
52
normalized frequency
gr
ou
p 
de
la
y
(b)
 
Fig.4 The magnitude response and group delay of the de-
signed fractional delay filters. (a)(b) Proposed interlaced 
sampling window method. (c)(d) Conventional Shannon 
sampling window method. 
13 13.5 14 14.5 15 15.5 16 16.5 17
0
5
10
15
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
(b)
13 13.5 14 14.5 15 15.5 16 16.5 17
0
0.5
1
1.5
x 10-3
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
(a)
 
Fig.5 (a) The NRMS error E  of the proposed WLS method 
for various delay D . (b) The NRMS error E  of the conven-
tional WLS method for various delay D  
0 0.5 1
0
0.5
1
1.5
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se (c)
0 0.5 1
14
15
16
normalized frequency
gr
ou
p 
de
la
y
(d)
0 0.5 1
0
0.5
1
1.5
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se (a)
0 0.5 1
14
15
16
normalized frequency
gr
ou
p 
de
la
y
(b)
 
Fig.6 The magnitude response and group delay of the de-
signed fractional delay filters. (a)(b) Proposed WLS method. 
(c)(d) Conventional WLS method. 
x(n) H(z) 
y(n) 
≈ x(n-D) x(t) ADC 
clock 
clock 
x(t) 
x(n) G1(z) 
x(n-τ) G2(z) 
y(n) 
≈ x(n-D) 
ADC 
ADC 
clock 1 
clock 2 
clock 1 
clock 2 59
   In the literature, there exist various sampling methods except 
the Shannon sampling scheme. Some typical ones are 
band-pass sampling, interlaced sampling, derivative sampling, 
Hilbert transform sampling and generalized sampling etc 
[13]-[18]. Thus, it is interesting to design wideband digital 
integrator based on these sampling schemes. In this paper, we 
will use the interlaced sampling method to design digital 
integrator which is composed of two real-coefficient filters 
)(1 zG  and )(2 zG , as depicted in Fig.2(b). Because 
)( τ−nx  is the interlaced signal of )(nx , it is easy to show 
that the frequency-domain relation between )(nx  and )(ny  
in Fig.2(b) is given by 
   )()(
)(
)(
21
ωωτω
ω
ω
jjj
j
j
eGeeG
eX
eY −+=   (10) 
where )( ωjeX  and )( ωjeY  are the Fourier transforms of 
)(nx  and )(ny . Thus, the design problem is how to 
determine the filters )(1 zG  and )(2 zG  such that the actual 
frequency response )()( 21
ωωτω jjj eGeeG −+  
approximates the ideal response )(ωD  in Eq.(1) as well as 
possible. In this case, the frequency response error is defined by  
 )()()()( 21 ωω ωωτω DeGeeGE jjj −+= −  (11) 
So, the error at πω =  for real valued filters )(1 zG  and 
)(2 zG  is given by 
  
[ ]
[ ][ ]
[ ]⎪⎪⎩
⎪⎪⎨
⎧
+−−
−+−
−−−
−+−
=
−−+−=
−+=
−−
−
oddI
Gj
GG
evenI
Gj
GG
e
j
GeG
DeGeeGE
Ijj
jjj
:
)1()sin(
)1()cos()1(
:
)1()sin(
)1()cos()1(
1)1()1(
)()()()(
1
2
21
1
2
21
21
21
π
π
ππτ
ππτπ
τπ
τπ
τπ
τπ
π
ππ
  (12) 
Thus, the absolute value of the error )(πE  can be written as 
      21
2
2
21
])1()[sin(
)]1()cos()1([
|)(|
πτπ
τππ ±−+
−+−=
G
GG
E    (13) 
If the filters )(1 zG  and )(2 zG  are designed to satisfy the 
following two equalities: 
                     )1()cos()1( 21 −−=− GG τπ              (14a) 
                     πτπ 12 )1()sin( ±=−G                    (14b) 
then the error )(πE  will reduce to zero. This means that the 
wideband digital integrator design can be achieved by using 
interlaced sampling scheme. The design details will be studied 
in next sections. 
 This paper is organized as follows. In section II, the 
reconstruction formula of interlaced sampling method is 
applied to design wideband digital integrator by using index 
substitution and numerical integration rules. The filter 
coefficients are easily computed because closed-form design is 
obtained. In section III, the weighted least squares (WLS) 
method is used to design wideband digital integrator. The 
solution is easily obtained by solving the matrix inversion. The 
numerical examples are also demonstrated to show that the 
proposed method has smaller design error than the 
conventional digital integrator that does not use the auxiliary of 
interlaced sampling signal. Finally, a conclusion is made. 
II. NUMERICAL INTEGRATION METHOD 
In this section, the interlaced sampling theorem is first 
reviewed. Then, we apply this theorem to design digital 
integrator by using index substitution method and numerical 
integration rules. Finally, numerical examples are used to 
compare the proposed approach with conventional digital 
integrators based on Shannon sampling scheme. 
A. Design Method 
Let )(nx  and )( τ−nx  be the uniform samples of the 
band-limited signal )(tx  and its delayed signal )( τ−tx , 
then the )(tx  can be reconstructed by using the formula: 
∑∑ ∞
−∞=
∞
−∞=
+−−+−=
mm
mtbmxmtamxtx )()()()()( ττ  (15) 
where 
     )()cot()2()( 2 tsincttsincta ⋅⋅+= τππ        (16) 
     )()cot()2()( 2 tsincttsinctb ⋅⋅−= τππ        (17) 
with tttsinc ππ /)sin()( = . The proof of this fact can be 
found in [13][14]. In the following, the index substitution and 
numerical integration rules will be used to obtain two filters 
)(1 zG  and )(2 zG  in Fig.2(b). Using the index substitution 
knm −= , Eq.(15) can be rewritten as  
             
∑
∑
∞
−∞=
∞
−∞=
++−−+
+−−=
k
k
kntbknx
kntaknxtx
)()(ˆ
)()()(
τ
           (18) 
where )()(ˆ τ−= nxnx . Taking pnt −= , then Eq.(18) 
can be expressed as 
               
∑
∑
∞
−∞=
∞
−∞=
−+−+
−−=−
k
k
pkbknx
pkaknxpnx
)()(ˆ
)()()(
τ
             (19) 
Defining ),(1 pkg  and ),(2 pkg  as 
                    )(),(1 pkapkg −=                         (20a) 
                    )(),(2 pkbpkg −+= τ                   (20b) 
then Eq.(19) can be rewritten as  
                  
∑
∑
∞
−∞=
∞
−∞=
−+
−=−
k
k
knxpkg
knxpkgpnx
)(ˆ),(
)(),()(
2
1
       (21) 
The sample )( 31−− Inx  and )( 32−− Inx  can be 
estimated from Eq.(22) by choosing 3
1+= Ip  and 
3
2+= Ip : 
         
∑
∑
=
=
−++
−+≈−−
N
k
N
k
knxIkg
knxIkgInx
0
3
1
2
0
3
1
13
1
)(ˆ),(
)(),()(
    (35a) 
      
∑
∑
=
=
−++
−+≈−−
N
k
N
k
knxIkg
knxIkgInx
0
3
2
2
0
3
2
13
2
)(ˆ),(
)(),()(
    (35b) 
Substituting Eq.(35) into Eq.(34), we have 
⎟⎟
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜⎜
⎜
⎝
⎛
−−+−+
−+−
≈
∑
∑
∫
=
=−
−−
)1()(ˆ)(3
)()(3)(
8
1)(
0
2
0
1
1
Inxknxkg
knxkgInx
dx
N
k
s
N
k
s
In
In
λλ  (36) 
where  
         ),(),()( 3213111 +++= IkgIkgkg s            (37a) 
        ),(),()( 3223122 +++= IkgIkgkg s         (37b) 
Substituting Eq.(36) into Eq.(26), we have 
 
∑∑
==
−+−+
−−+−+−=
N
k
s
N
k
s knxkgknxkg
InxInxnyny
0
2
0
1 )(ˆ)(8
3)()(
8
3
)1(
8
1)(
8
1)1()(
 (38) 
Because )()(ˆ τ−= nxnx , taking the discrete-time Fourier 
transform at both sides of Eq.(38), we obtain 
      
ω
ω
ωτ
ω
ωωω
ω
ω
j
N
k
jk
s
j
j
N
k
jk
s
IjIj
j
j
e
ekg
e
e
ekgee
eX
eY
−
=
−
−
−
=
−+−−
−+
−
++
=
∑
∑
1
)(
8
3
1
)(3
8
1
)(
)(
0
2
0
1
)1(
     (39) 
Compared Eq.(10) with Eq.(39) and letting ωjez = , the 
designed filters )(1 zG  and )(2 zG  are given below: 
    
1
)1(
0
1
1 1
)(3
8
1)( −
+−
=
−−
−
++
=
∑
z
zzkgz
zG
I
N
k
k
s
I
   (40a) 
                    
1
0
2
2 1
)(
8
3)( −
=
−
−=
∑
z
zkg
zG
N
k
k
s
                   (40b) 
So far, the interlaced sampling method has been presented to 
design digital integrators. In the following, numerical examples 
will be used to compare these designs with conventional 
Shannon sampling designs. 
B. Design Example and Comparison 
    Now, two numerical examples performed with MATLAB 
language in an IBM PC compatible computer are used to 
demonstrate the effectiveness of the proposed design method. 
To evaluate the performance, the integral squares error is 
defined by 
                  ωωπ ω dDeGE j 2
01
)()(∫ −=                  (41) 
where  
       )()()( 21
ωωτωω jjjj eGeeGeG −+=     (42) 
for the proposed design approach. The above error is computed 
by using numerical rectangular integration method with step 
size 100
π . Obviously, the smaller error 1E  has, the better 
performance the design method has. Now let us study two 
examples below: 
Example 1: In this example, the performance of digital 
integrator in Eq.(32) will be studied. When the parameters are 
chosen as 10=N  and 5=I , Fig.3(a) shows the error curve 
1E  of the integrator )(
ωjeG  for various offset τ  in the range 
]7.0,2.0[ . Clearly, the error has minimum value at offset 
5.0=τ . Thus, it is suggested to choose 5.0=τ  for the 
digital integrator in Eq.(32). Moreover, when the parameters 
are chosen as 10=N  and 2.0=τ , Fig.3(b) shows the error 
curve 1E  of the integrator )(
ωjeG  for various offsets I . 
Obviously, the error has minimum value near 5=I , so it is 
suggested to choose I  as an integer nearest 2N  for the digital 
integrator in Eq.(32). Next, let us study the frequency response 
of integrator in Eq.(32). If the parameters are chosen as 1=N , 
0=I , and 5.0=τ , then the transfer functions in Eq.(32) 
become 
                         1
1
1 1
1
6
1)( −
−
−
+=
z
zzG                         (43a) 
                           12 1
1
6
4)( −−= zzG                          (43b) 
Fig.4 shows the frequency response error |)()(| ωω DeG j − , 
magnitude response |)(| ωjeG  and normalized phase 
response πωω /]))(([ IeGangle j + . Because the frequency 
response error at πω =  is only 0.015, the proposed method 
has small design error in the high frequency range. This means 
that the wideband design can be accomplished by the proposed 
method based on interlaced sampling scheme. The error 1E  in 
this design is 51005.9 −× . If )( ωjeG  in Eq.(41) is changed 
  Now, a numerical example is used to study the performance of 
the proposed weighted least squares design method. 
Example 3: When the parameters are chosen as 4=N , 
2=I  and 1)( =ωW , Fig.7(a) shows the error curve 1E  of 
the integrator )( ωjeG  for various offset τ  in the range 
]7.0,2.0[ . Clearly, the error has minimum value at offset 
5.0=τ . Therefore, it is suggested to choose 5.0=τ  for 
WLS method. Moreover, when the parameters are chosen as 
6=N , 2.0=τ  and 1)( =ωW , Fig.7(b) shows the error 
curve 1E  of the integrator )(
ωjeG  for various offsets I . 
Obviously, the error has minimum value near 2
NI ≈ . 
Moreover, if the parameters of WLS design are chosen as 
4=N , 2=I , 1)( =ωW  and 5.0=τ , then Fig.8 shows 
the frequency response error |)()(| ωω DeG j − , magnitude 
response |)(| ωjeG  and normalized phase response 
πωω /]))(([ IeGangle j + . Because the frequency response 
error at πω =  is only 61024.7 −× , the proposed method has 
small design error in the high frequency range. This means that 
the wideband design can be accomplished by the proposed 
WLS method. The error 1E  in this design is 
111020.1 −×  
which is smaller than the errors of integrators )( zFk  
(k=1,2,..,5).  
  Finally, one discussion is made below: On the above designs, 
the offset τ  is assumed that no error occurs. However, due to 
fabrication imperfection of two analog -to-digital converters in 
Fig.2(b), the offset between two ADC's may exist an error δ . 
Thus, the true offset value becomes δτ +  rather than τ . In 
this case, the frequency response of the designed digital 
integrator is given by 
     )()()( 2
)(
1
ωδτωωω jjjj eGeeGeG +−+=   (53) 
Thus, it is interesting to study how the error δ  influences the 
frequency response error 1E . Now, let us use an example to 
illustrate this effect. If the WLS method with parameters 
4=N , 2=I , 1)( =ωW  and 5.0=τ  is used to design 
digital integrator, Fig.9(a) shows the error curve 1E  versus δ . 
Clearly, the larger offset error δ  is, the larger frequency 
response error 1E  is. To reduce the effect of offset error, a 
modified WLS method is presented below. If the offset error 
δ  locates at the interval ],[ ub δδ , the cost function in Eq.(50) 
is modified the following form:  
    ∫ ∫− − −−=
π
π
δ
δ ω ωδω
ωωu
b
ddD
e
WE j
T
s
2
)(
1
)()()( egg    (54) 
The )(2 ωe  in Eq.(46d) for the above vector )(ωe  needs to 
be changed to 
TNjjj eee ][)( )()1()(2
δτωδτωδτωω ++−++−+−= Le  (55) 
This modification implies that the filter coefficients g  are 
determined by considering both frequency response error and 
offset error. After some manipulation, Eq.(54) can be rewritten 
as 
   
ss
T
s
T
jT
j
s
c
ddDe
e
W
E
u
b
+−=
−−−= ∫ ∫− −−
qggQg
eg
g
2
)()1()(
|1|
)(
)(
2
2
π
π
δ
δ
ω
ω ωδωωω   (56) 
where matrix sQ , vector sq , and scalar sc  are given by 
∫ ∫ −−=
π δ
δ ω ωδωω
ω
0 2
])()(Re[
|1|
)(2 u
b
dd
e
W H
js eeQ  (57a) 
∫ ∫ −− −−=
π δ
δ
ω
ω ωδωωω0 *2 )]()1()(Re[|1|
)(2 u
b
ddDe
e
W j
js eq  (57b) 
     ωωωδδ π dDWc bus 20 |)(|)()(2 ∫−=        (57c) 
Because )( gsE  is a quadratic function of g , its optimal 
solution is given by ss qQg
-1
opt = . Now, let us use one 
design example to evaluate the performance. If the modified 
WLS method with parameters 4=N , 2=I , 1)( =ωW , 
1.0−=bδ , 1.0=uδ  and 5.0=τ  is used to design digital 
integrator, Fig.9(b) shows the error curve 1E  versus δ . 
Obviously, the larger offset error δ  is, the larger frequency 
response error 1E  is. However, compared Fig.9(a) with 
Fig.9(b), it is clear that the design error 1E  has been reduced 
greatly near 1.0±=δ . Moreover, Fig.10 shows the frequency 
response error |)()(| ωω DeG j − , magnitude response 
|)(| ωjeG  and normalized phase response 
πωω /]))(([ IeGangle j +  for this modified WLS method 
with offset error 05.0=δ . Because the frequency response 
error at πω =  is only 056.0 , the wideband design can be 
accomplished by the modified WLS method even though the 
offset error occurs. 
IV. CONCLUSIONS 
In this paper, the design of wideband digital integrator has 
been presented. First, the reconstruction formula of interlaced 
sampling method is used to design wideband digital integrator 
by index substitution and numerical integration rules. Because 
the closed-form design is obtained, the filter coefficients are 
easily computed. Then, the weighted least squares method is 
applied to design digital integrator which is optimal in least 
squares sense. Finally, numerical examples are demonstrated to 
show that the proposed method has smaller design error than 
the conventional digital integrator. However, only 
one-dimensional digital integrator is studied in this paper. Thus, 
it is interesting to extend the proposed method to design 
two-dimensional digital integrators in the future. 
REFERENCES 
[1] M. A. Al-Alaoui, "Novel digital integrator and differentiator," Electronics 
Letters, vol.29, pp.376-378, Feb. 1993. 
[2] J. Le Bihan, "Novel class of digital integrators and differentiators," 
Electronics Letters, vol.29, pp.971-973, May 1993. 
[3] N. Papamarkos and C. Chamzas, "A new approach for the design of digital 
integrators," IEEE Trans. on Circuits and Systems-I, vol.43, pp.785-791, 
Sep. 1996. 
0 0.2 0.4 0.6 0.8 1
0
0.005
0.01
0.015
0.02
normalized frequency ω/π
er
ro
r
(a)
0 0.2 0.4 0.6 0.8 1
0
5
10
normalized frequency ω/π
m
ag
ni
tu
de
(b)
0 0.2 0.4 0.6 0.8 1
-1
-0.5
0
normalized frequency ω/π
ph
as
e
(c)
 
Fig.4 Designed results of digital integrator in Eq.(32). (a) 
Frequency response error |)()(| ωω DeG j − . (b) Magnitude 
response |)(| ωjeG . (c) Normalized phase response 
πωω /]))(([ IeGangle j + . 
 
0.2 0.3 0.4 0.5 0.6 0.7
0
0.02
0.04
0.06
0.08
0.1
offset τ
er
ro
r E
1
(a)
0 2 4 6 8 10
0
0.05
0.1
0.15
0.2
parameter I
er
ro
r E
1
(b)
 
Fig.5 Designed results of digital integrator in Eq.(40). (a) The 
error curve 1E  versus offset τ  for 10=N  and 5=I . (b) 
The error curve 1E  versus delay I  for 10=N  and 
2.0=τ . 
 
0 0.2 0.4 0.6 0.8 1
0
0.005
0.01
0.015
0.02
normalized frequency ω/π
er
ro
r
(a)
0 0.2 0.4 0.6 0.8 1
0
5
10
normalized frequency ω/π
m
ag
ni
tu
de
(b)
0 0.2 0.4 0.6 0.8 1
-1
-0.5
0
normalized frequency ω/π
ph
as
e
(c)
 
Fig.6 Designed results of digital integrator in Eq.(40). (a) 
Frequency response error |)()(| ωω DeG j − . (b) Magnitude 
response |)(| ωjeG . (c) Normalized phase response 
πωω /]))(([ IeGangle j + . 
 
0.2 0.3 0.4 0.5 0.6 0.7
0
1
2
3
4
x 10-9
offset τ
er
ro
r E
1
(a)
0 1 2 3 4 5 6
0
2
4
6
8
x 10-8
parameter I
er
ro
r E
1
(b)
 
Fig.7 Designed results of WLS method. (a) The error curve 1E  
versus offset τ  for 4=N  and 2=I . (b) The error curve 
1E  versus delay I  for 6=N  and 2.0=τ . 
 
 
出席國際學術會議心得報告 
                                                             
計畫編號 NSC 99-2221-E-327 -001- 
計畫名稱 基於進階取樣技術的數位濾波器設計 
出國人員姓名 
服務機關及職稱 
曾建誠 
國立高雄第一科技大學電腦與通訊工程系教授 
會議時間地點 99 年 8 月 23 日至 8 月 27 日, 丹麥奧爾堡 
會議名稱 
(中文) 第 18 屆歐洲信號處理會議 
(英文) 18th European Signal Processing Conference (EUSIPCO 2010) 
發表論文題目 
(中文) 使用交錯取樣技術設計寬頻分數延遲濾波器 
(英文) Wideband fractional delay filter design based on interlaced sampling method 
(中文) 使用離散哈特萊轉換設計分數階微分器 
(英文) Design of fractional order differentiator using discrete Hartley transform 
(中文) 使用 B-spline 和高斯-雷建德積分法則設計數位 IIR 積分器 
(英文) Design of digital IIR integrator using B-spline interpolation and Gauss 
Legendre integration rule 
(中文) 使用根映射法設計穩定二維凹谷濾波器 
(英文) Design of stable two-dimensional IIR notch filter using root map 
 
一、參加會議經過 
8 月 22 日至奧爾堡會議與文化中心(Aalborg Congress and Culture Center)了解整個 EUSIPCO-2010
會場的佈置，8 月 23 日早上參加由香港科技大學教授 Daniel P. Palomar 演講 Convex Optimization, 
Game Theory, and Variational Inequality Theory in Multiuser Communication Systems 的教學課程，
了解凸集合最佳化和對局理論在通訊信號處理的發展趨勢，下午參加由教授 Gonzalo R. Arce 演
講的 Compressive Sensing and Its Applications in Imaging 的 Tutorial 課程，由於此題目是信號處理
近年來最熱門的研究題目之一，故整個會埸發問非常踴躍，讓我體會到與會者追求新知的態度，
從此課程中我已學會 Compressive Sensing 的各種回復(Recovery)技術，正積極思考如何用在稀疏
(sparse)濾波器設計應用中。8 月 24 日早上則發表自己的三篇 digital filter design 的論文，和與會
者熱烈討論，受益良多。8 月 24 日下午則參加 Compressed Sensing 的 session，與大家一起討論
如何利用壓縮性感測理論來發展各種信號處理演算法，其實 Compressed Sensing 便是利用信號稀
疏性的一種取樣新技術。8 月 25 日早上則參加 Image Enhancement 的 session，了解影像增強處理
的新技術及應用。8 月 25 日下午則參加 Image and Video Watermarking 的 session，進一步了解影
像及視訊浮水印技術的發展。8 月 26 日早上則參加 Image and Video Processing 的 session，了解
影像及視訊處理技術的發展趨勢。8 月 26 日下午則參加 Sampling and Sparse Processing 的
session，進一步了解取樣定理及稀疏表示的新方法。8 月 27 日早上則發表自己的另一篇 digital 
filter design 的論文，和與會者熱烈討論，受益良多。8 月 27 日下午則參加 Image and Video 
Encryption 的 session，進一步了解影像及視訊加解密技術的新方法。 
WIDEBAND FRACTIONAL DELAY FILTER DESIGN BASED ON INTERLACED 
SAMPLING METHOD 
Chien-Cheng Tseng1 and Su-Ling Lee2 
      1Depart. of Computer and Communication Engineering               2Depart. of Computer Sci. and Information Engi. 
National Kaohsiung First University of Sci. and Tech.                               Chung-Jung Christian University 
Kaohsiung, Taiwan                                                                              Tainan, Taiwan 
tcc@ccms.nkfust.edu.tw                                                                  lilee@mail.cjcu.edu.tw
ABSTRACT 
In this paper, the design of wideband fractional delay filter 
is investigated. First, the reconstruction formula of inter-
laced sampling method is applied to design wideband frac-
tional delay filter by using index substitution and window 
method. The filter coefficients are easily computed because 
closed-form design is obtained. Then, the weighted least 
squares method is used to design wideband fractional delay 
filters. Finally, numerical examples are demonstrated to 
show that the proposed method has smaller design error 
than the conventional fractional delay filter without using 
the interlaced sampling scheme. 
1. INTRODUCTION 
   In many signal processing applications, there is a need for a 
delay that is a fraction of the sampling period. These applica-
tions include beam steering of antenna array, time adjustment 
in digital receivers, modeling of music instruments, speech 
coding and synthesis, image interpolation and comb filter 
design etc [1]-[8]. An excellent survey of the fractional delay 
filter design is presented in tutorial paper [1]. The ideal fre-
quency response of fractional delay filter is given by 
                           Djd eH
ωω −=)(                            (1) 
where D  is a positive real number in the desired range. So 
far, the fractional delay filters are all designed under the 
Shannon sampling scheme, as shown in Fig.1. Usually, the 
Shannon sampling scheme is implemented by using one ana-
log-to-digital (ADC) converter. In this case, the frequency 
response of the FIR filter used to approximate this specifica-
tion is given by 
                        ∑
=
−=
N
k
kjj ekheH
0
)()( ωω                  (2)  
Thus, the traditional design problem is how to determine the 
filter )(zH  such that the actual frequency response 
)( ωjeH  fits the ideal response )(ωdH  as well as possible. 
Until now, several methods have been proposed to solve this 
design problem such as window method, Lagrange interpola-
tion method, maximally flat method, weighted least squares 
method and discrete Fourier transform method etc. In these 
designs, the frequency response error is defined by 
           )()()(1 ωω ω dj HeHE −=             (3) 
If the filter coefficients )(kh  in Eq.(2) are real-valued, the 
frequency response error at πω =  is given by 
  
)sin()]cos()1([
)1(
)()()(1
DjDH
eH
HeHE
Dj
d
j
ππ
ππ
π
π
+−−=
−−=
−=
−  (4) 
Thus, the absolute value of error )(1 πE  can be written as 
  
|)sin(|
)][sin()]cos()1([|)(| 221
D
DDHE
π
πππ
≥
+−−=   (5) 
So, there is an irreducible error at πω =  for conventional 
designs [2]. This means that the wideband fractional delay 
filter design can not be achieved by using Shannon sampling 
scheme in Fig.1. Therefore, it is interesting to use other sam-
pling methods to design wideband fractional delay filter. 
   In the literature, there exist various sampling methods ex-
cept the Shannon sampling scheme. Some typical ones are 
band-pass sampling, interlaced sampling, derivative sam-
pling and generalized sampling etc [9][10]. Thus, it is inter-
esting to design wideband fractional delay filter based on 
these sampling schemes. In this paper, we will use the inter-
laced sampling method to design fractional delay filter which 
is composed of two filters )(1 zG  and )(2 zG , as depicted 
in Fig.2. Usually, the interlaced sampling scheme is imple-
mented by using two parallel analog-to-digital converters 
with different control clocks. Because )( τ−nx  is the de-
layed version of )(nx , it is easy to show that the frequency-
domain relation between input and output in Fig.2 is given 
by 
     )()(
)(
)(
21
ωωτω
ω
ω
jjj
j
j
eGeeG
eX
eY −+=     (6) 
where )( ωjeX  and )( ωjeY  are the Fourier transforms of 
)(nx  and )(ny . Thus, the design problem is how to de-
termine the filters )(1 zG  and )(2 zG  such that the actual 
frequency response )()( 21
ωωτω jjj eGeeG −+  approxi-
mates the ideal response )(ωdH  as well as possible. In this 
case, the frequency response error is defined by  
   )()()()( 212 ωω ωωτω djjj HeGeeGE −+= −   (7) 
18th European Signal Processing Conference (EUSIPCO-2010) Aalborg, Denmark, August 23-27, 2010© EURASIP, 2010   ISSN 2076-1465 55
proposed filters )(1 zG , )(2 zG  and conventional filter 
)(zH  can be evaluated by using Eq.(2) and Eq.(20). If the 
direct-form realization is used, the number of adders and 
multipliers to implement filter )(zH  in Fig.1 are N  and 
1+N , while the number of adders and multipliers to imple-
ment FIR filters )(1 zG  and )(2 zG  in Fig.2 are 
)(
2
1
∑
=
−
i
ibiu NN  and )1(
2
1
∑
=
+−
i
ibiu NN . In the ADC part, it 
can be observed that the interlaced sampling method needs 
one more ADC than the Shannon sampling method. In the 
next subsection, one numerical example will be studied. 
2.2 Design Example and Comparison 
In the following, one numerical example performed with 
MATLAB language in an IBM PC compatible computer is 
used to demonstrate the effectiveness of the proposed win-
dow method. To evaluate the performance, the normalized 
root mean squares (NRMS) error is defined by 
          %100
)(
)()(
2
1
2
0
2
0 ×
⎟⎟
⎟
⎠
⎞
⎜⎜
⎜
⎝
⎛ −=
∫
∫
ωω
ωω
π
π ω
dH
dHeG
E
d
d
j
   (23) 
where )()()( 21
ωωτωω jjjj eGeeGeG −+=  in 
the proposed design approach. Obviously, the smaller NRMS 
error E  is, the better performance the design method is. If 
)( ωjeG  in Eq.(23) is changed to )( ωjeH , E  is the 
NRMS error of conventional design. In this paper, the E  is 
computed by using numerical rectangular integration method 
with step size 1000
π . Now, let us study an example below: 
Example 1: In this example, we will compare the proposed 
method with conventional window method based on Shan-
non sampling scheme. To achieve this purpose, the conven-
tional window method is briefly described below: Taking the 
inverse discrete-time Fourier transform of ideal frequency 
response )(ωdH , the ideal impulse response is given by 
          
)(
)(
2
1)(
Dksinc
deHkh kjdid
−=
= ∫− ωωπ
π
π
ω
     (24) 
In the conventional window method, the filter coefficients 
)(kh  in Eq.(2) are given by 
                      )()()( khkwkh id=                        (25) 
where )(kw  is a prescribed window function of length 
1+N . A numerical example is now studied. The parame-
ters are chosen as 4121 == bb NN , 6021 == uu NN , 
5.0=τ  and 100=N . Fig.3 shows the NRMS error 
curve E  (solid line) of the proposed method for various 
delay D  with step size 40
1 . The dashed line is the result of 
conventional rectangular window method based on Shannon 
sampling scheme with 1)( =kw  for Nk ≤≤0 . It is 
clear that the error of proposed method is smaller than the 
conventional method. Fig.4(a)(b) show the magnitude re-
sponse and group delay of fractional delay filter designed by 
proposed method for 5.0=τ , 4121 == bb NN , 
6021 == uu NN  and 4.50=D . Fig.4(c)(d) show the 
magnitude response and group delay of fractional delay filter 
designed by conventional rectangular window method for 
100=N  and 4.50=D . Obviously, the proposed method 
has smaller design error in the high frequency range than 
Shannon sampling method. That is, the wideband design can 
be accomplished by the proposed method based on interlaced 
sampling scheme. Now, the complexity issue is addressed. 
Because 4121 == bb NN , 6021 == uu NN  and 
100=N  are chosen, the number of adders and multipliers 
to implement two filters )(1 zG  and )(2 zG  are 38 and 40, 
while the number of adders and multipliers to implement 
filter )(zH  are 100 and 101. Obviously, the implementation 
complexity of )(1 zG  and )(2 zG  is smaller than that of 
)(zH . Although the filter-part accuracy and complexity of 
proposed method is better than conventional method, the 
proposed method needs one more ADC than the conventional 
method, as shown in Fig.1 and Fig.2. Thus, the improvement 
in filter part is at the cost of the increase of complexity in the 
ADC part. 
3. WEIGHTED LEAST SQUARES METHOD 
In this section, the weighted least squares (WLS) method 
is first used to design fractional delay filter whose coeffi-
cients can be obtained by solving matrix inversion. Then, 
numerical comparison with conventional WLS design is 
made. 
3.1 Design method 
    Taking ωjez = , the frequency response of filters )(1 zG  
and )(2 zG  in Eq.(20) can be written as 
       2,1)()( == ∑
=
− iekgeG
iu
ib
N
Nk
kj
i
j
i
ωω          (26) 
Thus, the frequency response )()( 21
ωωτω jjj eGeeG −+  
is gotten as 
  
)(
21
21
)()(
)()(
)(
2
2
1
1
τωω
ωωτω
ω
+−
=
−
=
−
∑∑ +=
+=
kj
N
Nk
kj
N
Nk
jjj
j
ekgekg
eGeeG
eG
u
b
u
b
 (27) 
Defining the following four vectors 
 Tubb NgNgNg ])()1()([ 1111111 L+=g   (28a) 
 Tubb NgNgNg ])()1()([ 2222222 L+=g  (28b) 
 TNjNjNj ubb eee ][)( 111 )1(1
ωωωω −+−−= Le        (28c) 
 TNjNjNj ubb eee ][)( )()1()(2 222
τωτωτωω +−++−+−= Le  (28d) 
then the frequency response in Eq.(27) can be rewritten as 57
[4] T.B. Deng, "Coefficient-symmetries for implementing 
arbitrary-order Lagrange-type variable fractional-delay 
digital filters," IEEE Trans. on Signal Processing, vol.55, 
pp.4078-4090, Aug. 2007. 
[5] T.B. Deng, "Symmetric structures for odd-order maxi-
mally flat and weighted-least-squares variable fractional-
delay filters," IEEE Trans. on Circuits and Systems-I: 
Regular Papers, vol.54, pp.2718-2732, Dec. 2007. 
[6] C.C. Tseng and S.L. Lee, "Design of fractional delay 
FIR filter using discrete Fourier transform interpolation 
method," Proc. 2008 IEEE Int. Symp. Circuits Syst., 
pp.1156-1159, May 2008. 
[7] J.J Shyu, S.C. Pei, C.H. Chan and Y.D. Huang, “Mini-
max design of variable fractional-delay FIR digital fil-
ters by iterative weighted least-squares approach,” IEEE 
Signal Processing Letters, vol.15, pp.693-696, 2008. 
[8] Y.D. Huang, S.C. Pei and J.J. Shyu, “WLS design of 
variable fractional-delay FIR filters using coefficient re-
lationship,” IEEE Trans. on Circuits and Systems-II: Ex-
press Briefs, vol.56, pp.220-224, Mar. 2009. 
[9] R.N. Bracewell, The Fourier Transform and Its Applica-
tions, Third Edition, McGraw-Hill, 2000. 
[10] F. Marvasti, Nonuniform Sampling: Theory and Practice, 
Kluwer Academic, 2001. 
[11] P.S.R. Diniz, E.A.B. da Silva and S.L. Netto, Digital 
Signal Processing: System Analysis and Design, Cam-
bridge University Press, 2002. 
 
 
 
 
 
 
 
 
 
Fig.1 The design of fractional delay filter based on Shannon 
sampling scheme implemented by one analog-to-digital con-
verter (ADC). 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig.2 The design of fractional delay filter based on interlaced 
sampling scheme implemented by two parallel analog-to-
digital converters with different control clocks. 
45 46 47 48 49 50 51 52 53 54 55
0
2
4
6
8
10
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
 
Fig.3 The NRMS error curve E  (solid line) of the proposed 
window method for various delay D . The dashed line is the 
result of conventional Shannon sampling window method. 
0 0.5 1
0
0.5
1
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se
(c)
0 0.5 1
49
50
51
52
normalized frequency
gr
ou
p 
de
la
y
(d)
0 0.5 1
0
0.5
1
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se
(a)
0 0.5 1
49
50
51
52
normalized frequency
gr
ou
p 
de
la
y
(b)
 
Fig.4 The magnitude response and group delay of the de-
signed fractional delay filters. (a)(b) Proposed interlaced 
sampling window method. (c)(d) Conventional Shannon 
sampling window method. 
13 13.5 14 14.5 15 15.5 16 16.5 17
0
5
10
15
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
(b)
13 13.5 14 14.5 15 15.5 16 16.5 17
0
0.5
1
1.5
x 10-3
fractional delay D
N
R
M
S
 e
rro
r E
 (%
)
(a)
 
Fig.5 (a) The NRMS error E  of the proposed WLS method 
for various delay D . (b) The NRMS error E  of the conven-
tional WLS method for various delay D  
0 0.5 1
0
0.5
1
1.5
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se (c)
0 0.5 1
14
15
16
normalized frequency
gr
ou
p 
de
la
y
(d)
0 0.5 1
0
0.5
1
1.5
normalized frequency
m
ag
ni
tu
de
 re
sp
on
se (a)
0 0.5 1
14
15
16
normalized frequency
gr
ou
p 
de
la
y
(b)
 
Fig.6 The magnitude response and group delay of the de-
signed fractional delay filters. (a)(b) Proposed WLS method. 
(c)(d) Conventional WLS method. 
x(n) H(z) 
y(n) 
≈ x(n-D) x(t) ADC 
clock 
clock 
x(t) 
x(n) G1(z) 
x(n-τ) G2(z) 
y(n) 
≈ x(n-D) 
ADC 
ADC 
clock 1 
clock 2 
clock 1 
clock 2 59
                  )()(1)( 2
1
0
M
kn
M
k
dd caskXM
nx π∑−
=
=                  (3) 
Substituting Eq.(2) into Eq.(3), we get 
∑
∑
−
=
−
−
=
−+
+⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧ +=
1
1
2
2
1
1
2
2
2
)()(1
)cos()(1)()()0(1)(
N
N
k
M
kn
L
nN
k
M
kn
d
caskNX
N
X
N
caskXX
N
nx
π
ππ
 (4)  
Using Eq.(1) and the following equality 
             
)cos(2
)()()()(
21
2121
θθ
θθθθ
−=
−−+ cascascascas         (5) 
then Eq.(4) can be rewritten as 
     ∑ ∑
−
=
−
=
− ⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
⎟⎠
⎞⎜⎝
⎛+
−+
=
1
0
1
1
)(22 cos2
)cos()1(1
)(1)(
N
m
k
N
mk
L
nm
d
N
L
nmx
N
nx π
π
   (6) 
Obviously, the interpolated value of )(nxd  is just the 
weighted average of the data x(m) (m=0,1,...,N-1). Moreover, 
this interpolator will satisfy the following property:  
                                )()( ixiLx d =                                 (7) 
that is, the interpolation becomes an identity at the time 
points of the original length-N signal. Because )(nxd  is the 
interpolated sequence of x(n) with factor L, we have the fol-
lowing relation:  
                         )()( L
p
d ixpiLx +≈+                          (8)  
for 10 −≤≤ Lp  and 10 −≤≤ Ni . When p=0, Eq.(8) 
reduces to Eq.(7). Combining Eq.(6) and Eq.(8), we have 
                     ),()()(
1
0
∑−
=
+≈+
N
m
L
p
L
p imbmxix                  (9) 
where interpolation basis is given by 
 
( )
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
⎟⎠
⎞⎜⎝
⎛+
+−+
=+ ∑−
=
−−
1
1
)(22 cos2
)(cos)1(1
1),( N
L
p
k
N
imk
L
pm
L
p
i
N
imb π
π
  (10) 
Using the identities )sin()sin()cos()cos()cos( 212121 θθθθθθ +=− , 
mm )1()cos( −=π  and 0)sin( =πm , we have 
                      
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −+=
+=
+−
N
mi
im
i
N
L
p
L
p
L
pm
2)(2cos
))(cos()cos(
))(cos()1(
π
ππ
π
                   (11) 
Substituting Eq.(11) into Eq.(10), the basis is rewritten as 
        ∑
= ⎟⎟⎠
⎞
⎜⎜⎝
⎛ −+=+ 2
0
)(2cos1),(
N
k
L
p
kL
p
N
kmi
N
imb πβ      (12) 
where 
                       
⎩⎨
⎧
−=
==
1,,2,12
,01
2
2
N
N
k k
k
Lβ                   (13) 
Let L
pit += , then the value of t can be any real number in 
[0,N) if factor L approaches infinity. Substituting L
pit +=  
into Eq.(9), we get 
                         ),()()(
1
0
tmbmxtx
N
m
∑−
=
≈                     (14) 
This means that the continuous-time signal )(tx  can be 
approximately reconstructed from its samples x(0), x(1), ..., 
x(N-1) in the range [0,N) by using continuous-time interpo-
lation basis ),( tmb . 
3. NON-INTEGER DELAY SAMPLE 
ESTIMATION 
    In this section, we will use DHT interpolation method to 
solve non-integer delay sample estimation problem because 
the proposed fractional order differentiator design method is 
based on this estimation method. The problem to be studied 
is how to estimate non-integer delay sample )( dIns −−  
from the given integer delay samples )(ns , )1( −ns , 
)2( −ns ,..., )1( +− Nns , where I  and N  are integers 
and d  is a real number in the interval ]1,0[ . And, I  is 
usually chosen in the range ]1,0[ −N . In this paper, we 
use the weighted average approach to achieve the purpose, 
that is, non-integer delay sample is estimated by 
      )(),()(
1
0
rnsdIrwdIns
N
r
−+=−− ∑−
=
     (15) 
Now, the remaining problem is how to use the DHT interpo-
lation method in the preceding section to determine the 
weights ),( dIrw + . To solve this problem, we choose 
))1(()( tNnstx +−−=                      (16) 
Substituting Eq.(16) into Eq.(14), we get 
),())1(())1((
1
0
tmbmNnstNns
N
m
∑−
=
+−−≈+−−   (17) 
Let rNm −−= 1 , this expression becomes 
 ),1()())1((
1
0
trNbrnstNns
N
r
−−−≈+−− ∑−
=
   (18) 
Replacing t  by dIN −−− 1 , the above equation can be 
rewritten as 
  ∑−
=
−−−−−−≈−−
1
0
)()1,1()(
N
r
rnsdINrNbdIns    (19) 
Comparing Eq.(15) with Eq.(19), we get 
          ∑
=
⎟⎠
⎞⎜⎝
⎛ −−=
−−−−−=+
2
0
)(2cos1
)1,1(),(
N
k
k N
kdIr
N
dINrNbdIrw
πβ
            (20) 
Finally, given integer N , and delay dI + , the procedure 
to estimate non-integer delay sample )( dIns −−  from the 
given integer delay samples )(ns , )1( −ns , )2( −ns ,..., 
)1( +− Nns  is summarized below:  
Step 1: Use Eq.(20) to compute the weights ),( dIrw + . 51
then )(zG  is the transfer function of the designed frac-
tional order differentiator which will approximate ideal fre-
quency response Ijej ωυω −)(  well. Now, given integer N , 
fractional order υ , delay I , integer K  and small positive 
number h , the procedure to design fractional order differ-
entiator )( zG  is summarized below:  
Step 1: Use Eq.(20) to compute the weights ),( khIrw + . 
Step 2: Compute coefficients )(ka  by using Eq.(27). 
Step 3: Use Eq.(34) to calculate coefficients )(rg . 
Step 4: The transfer function of the designed fractional order 
differentiator is given by ∑−
=
−=
1
0
)()(
N
r
rzrgzG . 
Finally, some remarks are made as follows: First, a large 
integer K  needs to be chosen for reducing truncation error 
which occurs in Eq.(29). Second, a smaller positive number 
h  needs to be chosen for reducing the approximation error 
which occurs in Eq.(30). Third, if N  is large, the designed 
fractional order differentiator is a long-length FIR filter. To 
reduce implementation complexity, the Prony method in [16] 
can be used to approximate long-length FIR filter )( zG  by 
an IIR filter below: 
                 
∑
∑
=
−
=
−
+
=
1
1
1
2
0
1
)(1
)(
)( N
n
n
N
n
n
zng
zng
zG               (38) 
5. DESIGN EXAMPLES AND COMPARISONS 
In this section, we will study the design error of the pro-
posed DHT-based fractional order differentiator and compare 
it with conventional methods. To evaluate the performance, 
the integral squares error of frequency response is defined by 
                 ωωλπ ω dHeGE dj
2
0
)()(∫ −=         (39)  
Obviously, the smaller the error E  is, the better performance 
of design method has.  
Example 1: In this example, the design parameters of the 
proposed method are chosen as 100=N , 40=I , 
5.0=υ , 1000=K  and 02.0=h . Fig.2(a) depicts the 
magnitude responses (solid line) of the )(zG . The dashed 
line is the ideal magnitude response υω . So, the specifica-
tion is fitted well except the region near πω = . Fig.2(b) 
shows the phase response πωω 5.0/]))(([*90 IeGangle j +  
in degree. The dashed line is the ideal response υ90 . It can 
be observed that the specification is approximated well. Now, 
let us compare the proposed method with the conventional 
fractional delay method in [9]. When the design parameters 
are chosen as 100=N , 40=I  and 5.0=υ , the con-
ventional fractional order differentiator is designed by the 
Lagrange fractional delay method used in Fig.4 of [9]. 
Fig.2(c)(d) show the designed results (solid line) of this 
method. The dashed line is ideal response. It can be seen that 
the actual response does not fit the ideal response well in 
high frequency region. If 9.0=λ  is chosen, the error E  of 
conventional fractional delay method in [9] is 0.1255, and the 
error E  of proposed DHT method is 0.0287. Thus, the pro-
posed method has smaller design error than the conventional 
method in [9]. 
Example 2: In this example, let us compare the proposed 
method with the conventional time domain least-squares 
method in [10] whose design procedure is described below: 
Step 1: Expand the fractional order Tustin differentiator 
υ)]([ zU  as the following power series form: 
       
⎟⎠
⎞⎜⎝
⎛ +=
⎥⎦
⎤⎢⎣
⎡⎥⎦
⎤⎢⎣
⎡ −=
⎟⎟⎠
⎞
⎜⎜⎝
⎛
+
−=
∑
∑∑
∞
=
−
∞
=
−−∞
=
−
−
−
1
00
1
1
1
)(12
)(2
1
12)]([
k
k
k
k
k
k
k
k
zku
zCzC
z
zzU
υ
υυυ
υ
υ
    (40) 
where filter coefficient )(ku  is the convolution sum of 
υ
k
k C)1(−  and υ−kC . After truncating the high-order terms, 
υ)]([ zU  can be approximated by FIR filter 
                  ⎟⎟⎠
⎞
⎜⎜⎝
⎛ += −
−
=
∑ kN
k
zkuzU
c 1
1
)(12)( υ                (41) 
where cN  is the truncation length. 
Step 2: Using the Prony method, the long-length FIR filter 
)( zU  can be approximated by the IIR filter below: 
                     
∑
∑
=
−
=
−
+
=
2
2
1
2
0
1
)(1
)(
)(ˆ N
n
n
N
n
n
znu
znu
zU
                 (42) 
Then, the frequency response of filter )(ˆ zUz I−  will ap-
proximate the ideal response  Ijd ejH
ωυωω −= )()(  well. 
Now, one example is used to compare this conventional de-
sign with the proposed design in Eq.(38). The parameters in 
conventional design are chosen as 60=cN , 102 =N  
and 5.0=υ . Fig.3(a)(b) show the magnitude and phase re-
sponses (solid line) of the designed differentiator )(ˆ zU . The 
dashed line is ideal response. The maximum pole radius is 
0.9941, so IIR filter )(ˆ zU  is stable. From this result, it is 
clear that the error of phase is very small, but the magnitude 
error at high frequency band is very large. After )( ωjeG  in 
Eq.(39) is changed to )(ˆ ωω jIj eUe− , the error E  with 
9.0=λ  is 13.4803 for this traditional design. For compari-
son, the designed results of proposed DHT method are re-
ported below. The design parameters are chosen as 60=N , 
9=I , 1000=K , 02.0=h , 101 =N , and 5.0=υ . 
Fig.3(c)(d) show the magnitude and phase responses (solid 
line) of the designed IIR differentiator )(zG  in Eq.(38). The 
dashed line is ideal response. The maximum pole radius is 
0.8169, so IIR filter )(zG  is stable. Compared Fig.3(a)(b) 
with Fig.3(c)(d), it can be observed that the proposed DHT 53
DESIGN OF DIGITAL IIR INTEGRATOR USING B-SPLINE INTERPOLATION AND 
GAUSS-LEGENDRE INTEGRATION RULE 
Chien-Cheng Tseng1 and Su-Ling Lee2 
      1Depart. of Computer and Communication Engineering               2Depart. of Computer Sci. and Information Engi. 
National Kaohsiung First University of Sci. and Tech.                               Chung-Jung Christian University 
Kaohsiung, Taiwan                                                                              Tainan, Taiwan 
tcc@ccms.nkfust.edu.tw                                                                  lilee@mail.cjcu.edu.tw
ABSTRACT 
In this paper, the design of digital IIR integrator is investi-
gated. First, the B-spline interpolation method is described. 
Then, non-integer delay sample estimation of discrete-time 
sequence is derived by using B-spline interpolation ap-
proach. Next, the Gauss-Legendre integration rule and non-
integer delay sample estimation are applied to obtain the 
transfer function of digital integrator. Finally, some numeri-
cal comparisons with conventional digital integrators are 
made to demonstrate the effectiveness of this new design 
approach. 
1. INTRODUCTION 
Digital integrators are useful devices in the application areas 
of control, radar and biomedical engineering [1]-[4]. The 
ideal frequency response of digital integrator is given by 
                               Ije
j
D ωωω
−= 1)(                              (1) 
where I  is a prescribed integer delay. The problem is how 
to design a digital filter such that its frequency response fits 
)(ωD  as well as possible. So far, the methods of digital 
integrator design can generally be classified into two catego-
ries. One is the linear phase FIR filter approach in which the 
filter coefficients are obtained by using maximal flatness 
constraints [1][2], the other is the IIR filter method in which 
the filter coefficients are determined directly from well-
known numerical integration rule [3][4]. In [3], Ngo pre-
sented a third-order digital integrator whose transfer func-
tion is given by 
            
1
321
1 1
5199
24
)( −
−−−−
−
+−+=
z
zzzzzF
I
       (2) 
In [4], Tseng and Lee have used Richardson extrapolation 
and polyphase decomposition to design digital integrators. 
From Eq.(62) in [4], the transfer function of a typical forth-
order integrator is given by 
    
1
43
21
1
2
1
213914388
88650672603693
139968
)(
−
−−
−−
+−
−
⎟⎟⎠
⎞
⎜⎜⎝
⎛
+−
++−
=
z
zz
zz
z
zF
I
    (3) 
From Eq.(1), it is clear that the gain of integrator at zero 
frequency 0=ω  is infinity, so the above transfer functions 
have one pole at 1=z . On the other hand, B-spline inter-
polation has been successfully used in numerical interpola-
tion, image processing, digital filter design, digital filter 
bank, computer graphics, and analog-to-digital conversion 
[5]-[7]. The early work on the B-spline theory and imple-
mentation is surveyed in the tutorial paper [8]. Thus, it is an 
interesting topic that uses B-spline interpolation method to 
design digital IIR integrators. The purpose of this paper is to 
study this topic. As a result, the design error can be reduced 
by suitably choosing the degree of B-spline function. The 
numerical comparisons with conventional digital integrators 
also show the effectiveness of this new approach. 
2. B-SPLINE INTERPOLATION 
In this section, B-spline function is first reviewed briefly. 
Then, the B-spline interpolation method is described. 
Splines are piecewise polynomials with pieces which are 
connected smoothly. The jointing points of the polynomials 
are called knots. The normalized symmetrical, bell-shaped  
B-spline functions of degree p  with 2+p  equally spaced 
knots are defined by 
            4444 34444 21 L
timesp
p tttt
)1(
000 )(**)(*)()(
+
= ββββ             (4) 
where rectangular pulse 
                             
⎪⎩
⎪⎨
⎧
>
=
<
=
2
1
2
1
2
1
2
1
0
||0
||1
)(
t
t
t
tβ                         (5) 
and * denotes the convolution operator. After some manipu-
lation, the function )(tpβ  can be written as 
)()(
1
)1(
!
1)( 2
1
2
1
1
0
ituit
i
p
p
t ppp
p
i
ip −+−+⎟⎟⎠
⎞
⎜⎜⎝
⎛ +−= ++
+
=
∑β   (6) 
where )(tu  is the unit step function given by 
                                
⎩⎨
⎧
<
≥=
00
01
)(
t
t
tu                            (7) 
The result in Eq.(6) clearly shows that )(tpβ  is a piecewise 
polynomial of degree p . For example, when 3=p , the 
closed-form representation of the cubic B-spline is given by 
18th European Signal Processing Conference (EUSIPCO-2010) Aalborg, Denmark, August 23-27, 2010© EURASIP, 2010   ISSN 2076-1465 60
  
( )
( )
( ) )()(
)()(
)()(
0 0
0 0
0
mnsknt
kntmns
kntwts
N
m
N
k
p
km
p
N
k
N
m
km
p
N
k
k
−⎟⎠
⎞⎜⎝
⎛ −−=
−−⎟⎠
⎞⎜⎝
⎛ −=
−−=
∑ ∑
∑ ∑
∑
= =
= =
=
βα
βα
β
  (22) 
Taking dInt −−= , the above equation reduces to 
 )()()(
0 0
mnsdIkdIns
N
m
N
k
p
km −⎟⎠
⎞⎜⎝
⎛ −−=−− ∑ ∑
= =
βα   (23) 
Compared Eq.(23) with Eq.(15), the weights ),( dmh  are 
given by 
                 ∑
=
−−=
N
k
p
km dIkdmh
0
)(),( βα          (24) 
Now, let us summarized the estimation procedure below: 
Given the B-spline function )(tpβ  with degree p , integer 
N , and delay dI + , the procedure to estimate non-integer 
delay sample )( dIns −−  from the given integer delay 
samples )(ns , )1( −ns , )2( −ns ,..., )( Nns −  is sum-
marized below:  
Step 1: Compute the matrix Φ  whose elements are given 
by )( mkpmk −= βφ . 
Step2: Calculate the inverse matrix 1−Φ  with element kmα . 
Step 3: Use Eq.(24) to compute the weights ),( dmh . 
Step 4: The non-integer delay sample is estimated by 
)(),()(
0
mnsdmhdIns
N
m
−=−− ∑
=
. 
4. DESIGN OF DIGITAL INTEGRATOR USING 
GAUSS-LEGENDRE INTEGRATION RULE 
In this section, the Gauss-Legendre integration rule and B-
spline-based non-integer delay estimation method are used 
to design digital IIR integrator. First, the Gauss-Legendre 
integration rule is described briefly. Then, this rule is applied 
to design digital integrator. The Gauss-Legendre rule is used 
to estimate the following definite integral numerically: 
                                  ∫−= 11 )( dttsQ                                 (25) 
The M-point Gauss-Legendre approximation formula for this 
definite integral is given by 
                            ∑
=
=
M
k
kMkMM tsuQ
1
,, )(                      (26) 
where the abscissas kMt ,  and weights kMu ,  must satisfy the 
following constraints 
12,,2,1,0)(
1
,,
1
1
−== ∑∫
=−
Mmtudtt
M
k
m
kMkM
m L  (27) 
By solving the above nonlinear equations, the abscissas kMt ,  
and weights kMu ,  can be easily obtained [9]. Now, two typi-
cal cases are listed below. For two-point Gauss-Legendre rule, 
i.e., M=2, the abscissas kMt ,  and weights kMu ,  are 
                                 12,21,2 == uu                                (28a) 
                                
3
1
2,21,2 ==− tt                            (28b) 
For three-point Gauss-Legendre rule, i.e., M=3, the abscissas 
kMt ,  and weights kMu ,  are 
                      9
5
3,31,3 == uu     982,3 =u                      (29a) 
                     5
3
3,31,3 ==− tt     02,3 =t                  (29b) 
So far, the Gauss-Legendre rule has been reviewed briefly. 
Now, let us use this rule to design digital integrator. When a 
signal )(ts  passes through the ideal integrator with integer 
delay I , its output )(ty  is given by 
                          ∫ −∞−= It dsty ττ )()(                          (30) 
Setting 1−= nt  and nt = , we have 
                      ∫ −−∞−=− 1 )()1( In dsny ττ                   (31a) 
                         ∫ −∞−= In dsny ττ )()(                         (31b) 
Using the following equality:  
∫ ∫ ∫−∞− −−∞− − −−+=In In In In dsdsds 1 1 )()()( ττττττ   (32) 
we get 
              ∫ − −−+−= In In dsnyny 1 )()1()( ττ            (33) 
Thus, the design problem reduces to how to evaluate the 
definite integral of the second term in Eq.(33). This problem 
can be solved by using various numerical integration rules in 
textbook [9]. Because the Gauss-Legendre integration rule is 
a more accurate method, we use it to design digital integra-
tor in this paper. The integral interval in Eq.(25) is [-1,1] 
which is not consistent with the integral interval 
],1[ InIn −−−  in the second term of Eq.(33). So, the 
following variable substitution is used to make translation: 
                  
2
)122( −−+= Inxτ                      (34) 
After using this substitution, the second term in Eq.(33) is 
given by 
                  ( )∫
∫
−
−−+
−
−−
= 1
1 2
)122(
2
1
1
)(
dxs
ds
Inx
In
In
ττ
              (35) 
If two-point Gauss-Legendre rule is used, Eq.(35) can be 
approximated by 
  
( ) ( )[ ]7887.02113.0
2
1
2
)122(
2
)122(
2
1
)(
3
1
3
1
1
−−+−−≈
⎥⎥⎦
⎤
⎢⎢⎣
⎡
⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−++⎟⎟⎠
⎞
⎜⎜⎝
⎛ −−+≈
−
−
−−∫
InsIns
In
s
In
s
ds
In
In
ττ
 (36) 62
REFERENCES 
[1] B. Kumar, D. Roy Choudhury and A. Kumar, "On the design of 
linear phase FIR integrators for midband frequencies," IEEE Trans. 
on Signal Processing, vol.44, pp.345-353, Oct. 1996. 
[2] B. Kumar and A. Kumar, "FIR linear-phase approximations of 
frequency response 1/(jω) for maximal flatness at an arbitrary fre-
quency )0(, 00 πωω << ," IEEE Trans. on Signal Processing, 
vol.47, pp.1772-1775, June 1999. 
[3] N.Q. Ngo, "A new approach for the design of wideband digital 
integrator and differentiator," IEEE Trans. on Circuits and Sys-
tems-II, vol.53, pp.936-940, Sept. 2006. 
[4] C.C. Tseng and S.L. Lee, "Digital IIR integrator design using 
Richardson extrapolation and fractional delay," IEEE Trans. on 
Circuits and Systems-I, vol.55, pp.2300-2309, Sept. 2008. 
[5] T.M. Lehmann, C. Gonner and K. Spitzer, "Survey: Interpola-
tion methods in medical image processing," IEEE Trans. on Medi-
cal Imaging, vol.18, pp.1049-1075, Nov. 1999. 
[6] S. Samadi, M.O. Ahmad and M.N.S. Swamy, "Characterization 
of B-spline digital filters," IEEE Trans. on Circuits and Systems-I, 
vol.51, pp.808-816, Apr. 2004. 
[7] D. Petrinovic, "Causal cubic splines: formulations, interpolation 
properties and implementations," IEEE Trans. on Signal Process-
ing, vol.56, pp.5442-5453, Nov. 2008. 
[8] M. Unser, "Splines: A perfect fit for signal and image process-
ing," IEEE Signal Processing Magazine, pp.22-38, Nov. 1999. 
[9] J.H. Mathews and K.D. Fink, Numerical Methods Using 
MATLAB, Third Edition, Prentice-Hall, 1999. 
-2 0 2
-0.5
0
0.5
1
1.5
t
β0 (
t)
p=0
-2 0 2
-0.5
0
0.5
1
1.5
t
β1 (
t)
p=1
-2 0 2
-0.5
0
0.5
1
1.5
t
β2 (
t)
p=2
-2 0 2
-0.5
0
0.5
1
1.5
t
β3 (
t)
p=3
 
Fig.1 The normalized B-splines )(tpβ  for p=0,1,2,3. 
0 20 40 60 80 100
-1
0
1
t
s(
t)
(a)
0 20 40 60 80 100
-1
0
1
t
co
s(
0.
04
 π t
) (b)
0 20 40 60 80 100
0
0.05
0.1
t
er
ro
r
(c)
 
Fig.2 The B-spline interpolation. (a) The interpolated func-
tion )( ts . (b) Sinusoidal function )04.0cos( tπ . (c) The 
absolute errors )04.0cos()( tts π− . 
5 10 15 20
0
0.2
0.4
degree p
E
rro
r E
1
(a)
5 10 15 20
0
0.2
0.4
degree p
E
rro
r E
2
(b)
 
Fig.3 The error curve of proposed B-spline design method 
for degree ]20,1[∈p . (a) 1E  of integrator )(1 zH . (b) 
2E  of integrator )(2 zH . 
 
0 0.2 0.4 0.6 0.8 1
0
2
4
6
8
10
normalized frequency (ω/π)
m
ag
ni
tu
de
 re
sp
on
se
 
Fig.4 The magnitude response of integrator )(1 zH  designed 
by B-spline interpolation method with p=18. The dashed line 
is the ideal magnitude response. 
                      (a)                                                   (b) 
10 20 30 40
0
0.2
0.4
0.6
0.8
1
degree p
E
rro
r E
1
 
0 0.2 0.4 0.6 0.8 1
-200
-150
-100
-50
0
normalized frequency (ω/π)
fre
qu
en
cy
 re
sp
on
se
 e
rro
r (
dB
)
 
                                             
Fig.5 (a) Error curve 1E . (b) Error |))()((|log20 110 ωω jeFD − . 
The dashed line is the error |))()((|log20 110
ωω jeHD − . 
                       (a)                                                   (b) 
10 20 30 40
0
0.2
0.4
0.6
0.8
1
degree p
E
rro
r E
1
 
0 0.2 0.4 0.6 0.8 1
-200
-150
-100
-50
0
normalized frequency (ω/π)
fre
qu
en
cy
 re
sp
on
se
 e
rro
r (
dB
)
 
Fig.6 (a) Error curve 1E . (b) Error |))()((|log20 210 ωω jeFD − . 
The dashed line is the error |))()((|log20 110
ωω jeHD − . 
 64
polynomial ),( 21 zzP  can be rearranged as the following 
form: 
        
)]([
),(),(
21
2
0 0
12121
2
2
2
1
1
1
zzP
zzkkpzzP k
N
k
N
k
k
=
⎟⎟⎠
⎞
⎜⎜⎝
⎛= −
= =
−∑ ∑          (4) 
where the expression )]([ 21 zzP  can be interpreted as 1-D 
polynomial in variable 2z  whose coefficients are polynomial 
in variable 1z . When 1z  is fixed, the )]([ 21 zzP  can be 
factored to yield 2N  roots. Thus, the second root map 2Γ  is 
defined as the loci of 2N  roots of )]([ 21 zzP  when pa-
rameter 1z  traverses the unit circle 11
ωjez = .  
2.2 Stability and Root Map 
For the 2-D first quadrant IIR filter with order 
),,,( 2121 NNMM , its transfer function is given by 
        
),(
),(
),(
),(
),(
21
21
2
0 0
121
2
0 0
121
21
2
1
1
2
2
1
2
1
1
2
2
1
zzP
zzQ
zzkkp
zzkkq
zzH
k
N
k
N
k
k
k
M
k
M
k
k
=
=
−
= =
−
−
= =
−
∑ ∑
∑ ∑
      (5) 
In [12], Shanks has shown that ),( 21 zzH  is stable if and 
only if the following conditions are true: 
          1||,1||0),( 2121 =≥≠ zzifzzP       (6a) 
          1||,1||0),( 2121 ≥=≠ zzifzzP       (6b) 
It is obvious that the condition in Eq.(6a) implies that the root 
map 1Γ  of the unit circle of variable  2z  lies inside the unit 
circle in the 1z  plane. And, the condition in Eq.(6b) means 
that the root map 2Γ  of the unit circle of 1z  lies within the 
unit circle in the 2z  plane. Thus, stability condition of 
Shank's theorem will be satisfied if two root maps lie within 
unit circle. So, we can control the stability of 2-D IIR filter 
by controlling two root maps to lie inside the unit circle. 
2.3 Linear Fractional Transform 
In [15], the linear fractional transformation (LFT) from com-
plex variable 1z  to 2z  is defined by 
                            
413
211
2 czc
czcz +
+=                                   (7) 
where 1c , 2c , 3c  and 4c  are constants. It can be shown that 
the LFT transforms circles and lines into circles and lines. 
Moreover, the Eq.(7) can be rewritten in the form 
              012
1
12
1
21
1
143 =−−+ −−−− zzczczcc                (8) 
This expression is the same as 0),( 21 =zzP  with order 
)1,1(  if we choose 3)0,0( cp = , 4)0,1( cp = , 
1)1,0( cp −= , and 2)1,1( cp −= . Thus, we can use the 
properties of LFT in complex analysis to construct the de-
sired root maps of  0),( 21 =zzP  with order )1,1( . In next 
section, the details that design 2-D IIR notch filter using root 
map and LFT will be described. 
3. DESIGN OF 2-D IIR NOTCH FILTER 
     In this section, we will summarize some important root 
maps. Then, these root maps are used to design 2-D IIR 
notch filter. The first important root map is described by the 
following fact: 
Fact 1: Choosing parameters  
                        
1
22
+
−−=
r
rra ρ ,     
1+
−=
r
b ρ              (9)                      
and let 2-D polynomial with order )1,1(  be 
          1),( 12
1
1
1
2
1
121 +++= −−−− bzbzzazzzB        (10) 
then we have the results: 
(1) The two root maps 1Γ  and 2Γ  are the same. 
(2) The two root maps are both circles with center at ρ  and 
radius r . 
(3) The equalities 0),1( =+ rB ρ  and 0)1,( =+ rB ρ  hold. 
Proof: Because 0),( 21 =zzB  is a special LFT in complex 
variable textbook in [15], this fact can be proved by using 
techniques in [15]. The details are described below. Since the 
symmetry property ),(),( 1221 zzBzzB =  is valid, two root 
maps are the same. So, we only need to find the root map 2Γ  
because 1Γ  is the same as 2Γ . To find 2Γ , let complex vari-
ables  1z  and 2z  be represented by 
                                     jyxz +=1                                        
                                     jvuz +=2                                (11) 
Substituting Eq.(11) into 0),( 21 =zzB , it yields 
                              abuvyxub −−=−+ )(                
                              bvyubvx −=++ )(                       (12) 
Since 1z  is on the unit circle, we have the constraint 
122 =+ yx . Based on this constraint and Eq.(12), we get 
         
2
2
2
2
2
2 11
)1(
⎟⎟⎠
⎞
⎜⎜⎝
⎛
−
−=+⎟⎠
⎞⎜⎝
⎛
−
−−
b
bav
b
abu         (13) 
Substituting Eq.(9) into Eq.(13), we have 
                           ( ) 222 rvu =+− ρ                            (14) 
This means that the root map 2Γ  is a circle with center at ρ  
and radius r . Finally, it is easy to show that the equalities 
0),1( =+ rB ρ  and 0)1,( =+ rB ρ  hold by using direct 
substitution. 
     Based on the results in Fact 1, we have the further results 
of root map below: 
Fact 2: Let 2-D polynomial with order )2,2(  be 
   
⎥⎥
⎥
⎦
⎤
⎢⎢
⎢
⎣
⎡
Φ=
−
−−−
2
2
1
2
2
1
1
12121
1
],,1[),,,,,(
z
zzzrzzF θθρ  (15) 
where matrix Φ  is 1686
design parameters are not changed. From this result, it is 
clear that error ripple near notch frequency has been reduced. 
Moreover, it is interesting to study the shape of 3-dB contour 
of notch in which the magnitude |),(| 21 ωω jj eeH  is equal to 
2
1 . Fig.3 shows the 3-dB contours of the designed 2-D IIR 
notch filters ),( 21 zzH  for various parameters α  and ε  
when notch frequency is chosen as )5.0,5.0(),( 21 ππωω =NN . 
It is clear that the 3-dB contour is symmetric about the notch 
frequency )5.0,5.0( ππ . And, the size of 3-dB contour is re-
duced if parameters α  and ε  are reduced. Thus, we can use 
parameters  α  and ε  to control the shape of 3-dB contour 
of notch. 
Example 2: Comparison with Conventional 2-D IIR Notch 
Filter Design 
In this example, we will compare the proposed design 
method with conventional outer product expansion method in 
[9]. Given the notch frequency ),( 21 NN ωω  and parameter 
BW , the transfer function of conventional 2-D IIR notch 
filter in [9] is given by 
( ))()(1)()(
2
11),( 2211221121 zHzHzHzHzzH aabb −−=  (23) 
where filters 
     ⎟⎟⎠
⎞
⎜⎜⎝
⎛
+−
+−−= −−
−−
2
2
1
1
21
12
1
1
2
1)(
iiii
iiii
ibi zaza
zzaazH    i=1,2     (24) 
     
1
1
1
)( −
−
+
+=
ii
ii
iai zb
zbzH      i=1,2                                      (25) 
with the coefficients 
      ( )21 tan1
)cos(2
BW
iN
ia +=
ω ,   ( )( )2
2
2 tan1
tan1
BW
BW
ia +
−=    i=1,2      (26) 
      ( )( )42 42sin
sin
πω
πω
+
−=
iN
iN
ib       i=1,2                                         (27) 
Fig.4 shows the magnitude response |),(| 21 ωω jj eeH   and the 
loss |),(|1 21 ωω jj eeH− of this conventional IIR notch filter for 
)5.0,5.0(),( 21 ππωω =NN  and π005.0=BW . Comparing 
Fig.2 with Fig.4, it can be seen that the performance of the 
proposed design method is similar to one of the conventional 
method in [9]. However, the order of the proposed filter 
),( 21 zzH  in Eq.(22) is )2,2,2,2(  and the order of con-
ventional filter ),( 21 zzH  in Eq.(23) is )3,3,3,3( . So, 
the implementation complexity of proposed filter will be less 
than the complexity of conventional filter if the direct-form 
realization is chosen. 
Example 3: Sinusoidal Interference Removal on Image 
In this example, we will use the proposed IIR notch filter to 
remove the sinusoidal interference superimposed on an im-
age with size 512512 × . The image shown in Fig.5(a) is 
the Lake image corrupted by a sinusoidal interference below: 
                       )2.01.0sin(50 nm ππ +                        (28) 
Now, let us design a 2-D IIR notch filter with notch fre-
quency )2.0,1.0(),( 21 ππωω =NN , 1.0=α  and 
01.0=ε  to remove this sinusoidal interference in spatial 
domain. The filtered image is shown in Fig.5(b). It is clear 
that the interference has been removed by the proposed 2-D 
IIR notch filter. In the above, only the case of single sinusoid 
is studied. For the case of multiple sinusoidal interferences, 
the cascade notch filter can be used to remove the multiple 
interferences if the notch frequencies are chosen as the fre-
quencies of sinusoids. 
5. CONCLUSIONS 
    In this paper, the root map has been presented to design a 
stable 2-D IIR notch filter. First, the linear fractional trans-
formation (LFT) in complex analysis is used to construct the 
desired root map of 2-D polynomial. Then, the numerator 
and denominator of transfer function of 2-D IIR notch filter 
can be obtained from the LFT used in the construction of 
root map. Finally, design example and image application are 
demonstrated to show the effectiveness of the proposed ap-
proach. However, only IIR notch filter design is considered 
here. Thus, it is interesting to design other 2-D IIR filters by 
using root map in the future. 
REFERENCES 
[1] S.C. Pei and C.C. Tseng, "Elimination of AC interference in 
electrocardiogram using IIR notch filter with transient suppres-
sion" IEEE Trans. on Biomedical Engineering, pp.1128-1132, 
Nov. 1995. 
[2] R.C. Gonzalez and R.E. woods, Digital Image Processing, 2nd 
Edition, Prentice-Hall, 2002. 
[3] V.K. Srivastava and G.C. Ray, "Design of 2D-multiple notch 
filter and its application in reducing blocking artifact from 
DCT coded image," Proc. of the 22nd Annual EMBS Interna-
tional Conference, pp.2829-2833, July 2000.  
[4] S.C. Pei and C.C. Tseng, "Two-dimensional IIR and FIR digi-
tal notch filter design" Proc. of the ISCAS 1993, pp.890-893, 
May 1993. 
[5] V.L. Narayana Murthy and A. Makur, "Design of some 2-D 
filter through the transformation technique," IEE Proc. Vision, 
Image and Signal Processing, vol.143, pp.184-190, June 1996. 
[6] S.C. Pei, W.S. Lu and C.C. Tseng, "Two-dimensional FIR 
notch filter design using singular value decomposition," IEEE 
Trans. on Circuits and Systems-I, pp.290-294, Mar. 1998. 
[7] F. Wysocka-Schillak, "Design of equiripple 2-D linear-phase 
FIR notch filters," EUROCON 2007 The International Confer-
ence on "Computer as a Tool", pp.112-115, Sept. 2007. 
[8] S.C. Pei and C.C. Tseng, "Two dimensional IIR digital notch 
filter design," IEEE Trans. on Circuits and Systems-II, pp.227-
231, Mar. 1994. 
[9] S.C. Pei, W.S. Lu and C.C. Tseng, "Analytical two-
dimensional IIR notch filter design using outer product expan-
sion," IEEE Trans. on Circuits and Systems-II, pp.765-768, 
Sept. 1997. 
[10] T. Hinamoto, N. Ikeda, S. Nishimura and A. Doi, "Design of 
two-dimensional adaptive notch filters," Proc. of 5th Interna-
tional Conference on Signal Processing, pp.538-542, Aug. 
2000. 
[11] S.C. Pei, C.L. Wu and J.J. Ding, "Simplified structures for two-
dimensional adaptive notch filters" Proc. of the ISCAS 2003, 
pp.IV-416-IV-419, May 2003. 
[12] J. L. Shanks, S. Treitel and J.H. Justice, "Stability and synthe-
sis of two-dimensional recursive filters," IEEE Trans. on Audio 
Electroacoust., pp.115-128, June 1972. 1688

國科會補助計畫衍生研發成果推廣資料表
日期:2011/09/15
國科會補助計畫
計畫名稱: 基於進階取樣技術的數位濾波器設計
計畫主持人: 曾建誠
計畫編號: 99-2221-E-327-001- 學門領域: 訊號處理
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
