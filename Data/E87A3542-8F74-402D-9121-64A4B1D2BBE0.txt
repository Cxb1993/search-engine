§Ë!Z5ùŸ(43−„£àœ„«n
Keywords: Hysteresis, Cyclic plasticity, Linear quadratic optimal control, Frictional os-
cillator
The main purposes of this project are to study the dynamic behavior of engineering
structures under earthquakes and the mechanisms of several isolation and damping de-
vices under cyclic loading, and to develop a new optimal control law. Understanding the
phenomena of multiaxial hysteresis is essential for the design and analysis of earthquake
resistant structures. For this we shall explore the modeling of the hysteresis phenomena,
analyze the nonlinear structural behavior, and develop high precision numerical schemes
which preserve the internal symmetry of the hysteretic behavior. For the passive control,
we shall analyze the fundamental mechanism of friction damping system, and give the
systems a unified treatment under the generic name of frictional oscillators by combin-
ing the knowledge of friction, hysteresis, and cyclic plasticity. For the active control of
earthquake-excited structures, we shall examine the difficulties encountered by the linear
quadratic optimal control algorithm and try to take into consideration the accumulating
effect of seismic disturbances.
Under this project one paper was published:
Chein-Shan Liu, 2006, Reid’s passive and semi-active hysteretic oscillators with friction
force dependence on displacement, Int. J. Non-Linear Mechanics, vol.41, pp.775-786.
One paper is submitted for possible publication:
Chein-Shan Liu, Der-Yuan Liou, 2006, Linear quadratic controllers for buildings against
earthquakes.
776 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
u(t)
k
m p(t)
|fd| = k0 |u|
k
m p(t)
Actuator
Sensor
u(t)
Damper Plate
(a)
(b)
Fig. 1. Schematic plots of (a) passive and (b) semi-active Reid oscillators.
of friction force and spring force is a restoring force. In terms
of r, Eq. (1) changes to
mu¨(t) + r(t) = p(t). (4)
For the Reid damping devise, we may use
r = (1 + )ku if uu˙> 0, (5)
r = (1 − )ku if uu˙< 0, (6)
or
r = [1 +  sgn(uu˙)]ku (7)
to represent the relation of restoring force and displacement as
shown in Fig. 2, in which
 := k0
k
> 0 (8)
denotes the hysteretic-damping coefﬁcient, a ratio of damping
force to elastic force. The major problem of the above formula-
tion is that the criterion of uu˙> 0 or uu˙< 0 does not uniquely
determine the (u, r) point, which may locate at one of two
restoring force–displacement branches as shown in Fig. 2.
Fig. 2. Relation of restoring force and displacement.
In order to overcome these difﬁculties, we consider another
view of the model by a linearly elastic–isotropic hardening
model borrowed from plasticity theory in the next section.
For a damping purpose which supplies a contact friction
mechanism on the oscillator to suppress its vibration, we are
naturally led to consider a modiﬁed friction device, of which
the damper plate is placed in contact with the mass slider
when its displacement has a tendency to increase, i.e., uu˙> 0,
whereas when the displacement of the oscillator already has
a tendency to decrease, i.e., uu˙< 0, we remove the damper
plate. Therefore, corresponding to the passive Reid oscillator
as shown in Fig. 1(a), we call the oscillator with following
modiﬁed friction device:
r = (1 + )ku if uu˙> 0, (9)
r = ku if uu˙< 0, (10)
a semi-active Reid oscillator as shown in Fig. 1(b).
A semi-active implementation of the Reid oscillator was pro-
posed by Caughey [9], and was further analyzed by Zhang and
Iwan [6]. In this paper, the steady-state behaviors of passive and
semi-active Reid oscillators under harmonic loadings are inves-
tigated by a phase plane method as developed by Liu [10,11],
Hong and Liu [12] and Liu and Huang [13]. This method is
rather better in the estimation of steady-state responses. Eq. (4)
together with Eqs. (5) and (6) or Eqs. (9) and (10) constitute a
piecewise linear dynamical system, which is rather easy to solve
exactly to obtain its motion; however, it is untrue in the steady-
state motion, because our aim is to derive formulae that can es-
timate the maximum responses of the piecewise linear system,
a non-linear problem, and judge what values of the parameters
that cause the system sticking or non-sticking in its steady state.
2. A new formulation and responses under harmonic
loadings
2.1. Isotropic linear hardening element
The frame (x, f ) as shown in Fig. 3(a) is obtained from
the frame (u, r) by a suitable rotation through an angle ,
778 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
-300
0
300
u
-300
0
300
-0.7
0.0
0.7
f
-0.7
0.0
0.7
-350 0 350
u
-350 0 350
u
-350 0 350
x
-350 0 350
x
-350 0 350
u
-350 0 350
u
-4
0
4
r
-4
0
4
.
(a)
(b)
(c)
(d)
(e)
(f)
Fig. 4. Typical responses of passive (left) and semi-active (right) Reid oscillators: (a) and (d) the hysteretic loops in the plane of (u, r), (b) and (e) the
hysteretic loops in the plane of (x, f ), (c) and (f) the limit cycles in the plane of (u, u˙).
under large force, the mass slider may jump from one sliding
phase to another sliding phase, and cannot always stay in a
sticking phase.
2.4. Harmonic loadings and responses
In this section, the driving force is taken to be harmonic:
p(t) = p0 sind t , (29)
with amplitude p0 and driving angular frequency d . For input
(29), the responses of the oscillator are derived by integrating
Eqs. (24) and (25) during sliding phase and by using Eq. (27)
during sticking phase (see Appendix A).
With the solutions given in Appendix A, one can easily obtain
the displacement u and restoring force r of the oscillator via
Eq. (16).
The above results are derived for the passive Reid oscillator;
however, they are also applied to the semi-active Reid oscillator
780 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
A2
[
sind t2 sind t1 cos
y − 
2
+ 2 cosd t1 sin
y − 
2
]
− V
2
sin
y − 
2
= , (41)
where
y := d(t2 − t1), 0 <y. (42)
In principle, we can combine Eqs. (38)–(41) together by utiliz-
ing a numerical method to determine the four unknowns of t1,
t2, V and . However, it gives us no proper information about
t1, t2,  and V and the inﬂuence factors. We below put these
equations into a more concise form, such that in terms of the
identiﬁed parameters, the closed-form representations of  and
V are available.
3.2. Equation required for steady-state estimation
In Appendix B, we derive the following equation:
F(rw, , y) :=
∣∣∣∣∣
a11 aˆ12 aˆ13
a21 aˆ22 aˆ23
a31 aˆ32 aˆ33
∣∣∣∣∣= 0. (43)
In addition to a11, a21 and a31, which are deﬁned respectively in
Eqs. (B.2), (B.5) and (B.8), the other aˆij are deﬁned as follows:
aˆ12 := B
(
cos y − cos y
1
)
, (44)
aˆ13 := B
(
1
1
sin
y
1
− sin y
)
, (45)
aˆ22 := C
(
cos y + cos y − 
2
)
, (46)
aˆ23 := −C
(
sin y + 1
2
sin
y − 
2
)
, (47)
aˆ32 := (C − B) sin y + 1B sin
y
1
+ 2C sin
y − 
2
, (48)
aˆ33 := (C − B) cos y + B cos y
1
+ C cos y − 
2
, (49)
where
B := 1
(1 + )(1 − 21)
, (50)
C := 1
(1 − )(1 − 22)
. (51)
Eq. (43) gives us a relation between rw and y for each . It can
be utilized to determine the function relation of rw = ˆ(y, ) or
y = yˆ(rw, ) numerically.
We note that
F(rw, , 0):=
∣∣∣∣∣∣∣∣∣∣∣
1 0 0
− cos 
2
C
(
1 + cos 
2
)
C
2
sin

2
2 sin

2
−2C sin

2
C
(
1 + cos 
2
)
∣∣∣∣∣∣∣∣∣∣∣
= 2C2
(
1 + cos 
2
)
> 0, (52)
F(rw, , ):=
∣∣∣∣∣∣∣∣∣∣
cos

1
−B
(
1 + cos 
1
)
B
1
sin

1
−1 0 0
−1 sin

1
1B sin

1
B
(
1 + cos 
1
)
∣∣∣∣∣∣∣∣∣∣
= − 2B2
(
1 + cos 
1
)
< 0. (53)
Thus, for each rw and , the equation F(rw, , y)=0 must exist
at least one solution of y in the range of (0, ]. Numerically,
there are two approaches to solve F(rw, , y)=0. The ﬁrst one
is that for each y, we use the Newton–Ralphson method to ﬁnd
rw from F(rw, , y)= 0. The other one is that for each rw, we
use the Newton–Ralphson method to solve y from F(rw, , y)=
0. It is more convenient to use the latter approach to ﬁnd the
frequency response curves as shown below.
3.3. Closed-form solutions of steady-state maximum responses
From Eq. (B.1), we can obtain two linearly independent equa-
tions for cosd t1 and sind t1, and solve them to obtain
cosd t1 = a31a23 − a21a33
a22a33 − a32a23
V
d
, (54)
sind t1 = a32a21 − a22a31
a22a33 − a32a23
V
d
. (55)
Substituting the above two equations into the identity
cos2d t1+sin2d t1=1, we obtain a single equation as follows:
V
d
=
√
(a22a33 − a32a23)2
(a31a23 − a21a33)2 + (a32a21 − a22a31)2
. (56)
Furthermore, from Eq. (40), it follows that


= 1V
d
sin
y
1
+ A1

{(
sin y − 1 sin
y
1
)
cosd t1
+
(
cos y − cos y
1
)
sind t1
}
. (57)
Substituting Eq. (56) for V/(d), Eq. (54) for cosd t1 and
Eq. (55) for sind t1 into the above equation, we obtain the
closed-form formula for /.
782 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
0.0 0.4 0.8 1.2 1.6 2.0
0.0 0.4 0.8 1.2 1.6 2.0
rw
rw
0.0
0.5
1.0
1.5
2.0
2.5
∆/
u 0
η=0.8
=0.6
=0.4
=0.2
0
2
4
6
8
10
V/
u 0
w
d
(a)
(b)
Fig. 6. Comparing the steady-state responses of passive Reid oscillator under
different  for (a) maximum displacement and (b) maximum velocity.
Substituting Eq. (60) for /(u0), we obtain
∣∣∣∣
{
sin y − B
(
sin y − 1 sin
y
1
)}
cosd t1
+
{
cos y −B
(
cos y − cos y
1
)}
sind t1− 1V
u0d
sin
y
1
∣∣∣∣
= 1V
u0d
sin
y
1
+ B
{(
sin y − 1 sin
y
1
)
cosd t1
+
(
cos y − cos y
1
)
sind t1
}
. (66)
Substituting Eq. (61) for cosd t1 and Eq. (62) for sind t1
into Eq. (66) and cancelling out V/(u0d), we can obtain a
border line equation. We observe that the border line formula
is independent of u0, which gives a closed-form formula in the
plane (rw, ) upon substituting y = yˆ(rw, ).
It provides us the maximum hysteretic-damping coefﬁcient 
required to prevent sticking for different frequency ratios. When
 is smaller than that, it will make the passive Reid oscillator
to be zero stop per cycle in the steady state, so that the criterion
0.0 0.2 0.4 0.6 0.8 1.0
rw
0.0
0.2
0.4
0.6
0.8
1.0
Sticking Region
η
Fig. 7. Non-sticking region of passive Reid oscillator as marked by black
solid points is plotted in the plane of (rw, ).
for zero stop per cycle is∣∣∣∣
{
sin y − B
(
sin y − 1 sin
y
1
)}
a31aˆ23 − a21aˆ33
aˆ22aˆ33 − aˆ32aˆ23
+
{
cos y − B
(
cos y − cos y
1
)}
× aˆ32a21 − aˆ22a31
aˆ22aˆ33 − aˆ32aˆ23 − 1 sin
y
1
∣∣∣∣
1 sin
y
1
+ B
(
sin y − 1 sin
y
1
)
a31aˆ23 − a21aˆ33
aˆ22aˆ33 − aˆ32aˆ23
+ B
(
cos y − cos y
1
)
aˆ32a21 − aˆ22a31
aˆ22aˆ33 − aˆ32aˆ23 . (67)
Under the above criterion, we plot the parameters (rw, ) in
Fig. 7, of which the region ﬁlled with black points denotes
the non-sticking region, while the remaining blank part is the
sticking region.
4. Comparing semi-active and passive Reid oscillators
The estimation of the long-term behavior of semi-active Reid
oscillator can be carried out by a similar procedure as that for
the passive Reid oscillator in Section 3. The formulae appeared
there can be applied with merely changing the following pa-
rameters:
2 = 0 =
√
k
m
, 2 := rw =
d
0
, A2 := p0
k(1 − r2w)
,
(68)
and the quantities that are related with the above three param-
eters are also changed simultaneously.
784 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
0
2
4
6
8
10
∆/
u 0
0.0 0.4 0.8 1.2 1.6 2.0
rw
0.0 0.4 0.8 1.2 1.6 2.0
rw
0
1
2
3
4
V/
 u
0w
d
(a)
(b)
Fig. 10. Comparing the steady-state responses of passive and semi-active
Reid oscillators under different  for (a) maximum displacement and (b)
maximum velocity.
5. Concluding remarks
We have shown that the hysteretic damping with dry fric-
tion dependent on the amplitude of displacement is described
completely by a linear elastic–isotropic hardening model. Pre-
cise criteria for sliding and sticking were then derived. The
estimations of maximum responses of passive and semi-active
Reid oscillators are accurate and effective. The maximum dis-
placement and maximum velocity are linearly dependent on the
friction static displacement u0, but the two phase lags are in-
dependent of u0. The border line of sticking and non-sticking
motions is independent of u0. In the range of rw < 1, the max-
imum displacement and velocity of semi-active Reid oscillator
are smaller than that of the passive Reid oscillator. When rw=1
or rw in the range of 1.6 <rw2, the differences of maximum
0.0 0.2 0.4 0.6 0.8 1.0
0.0
0.5
1.0
1.5
2.0
2.5
∆/
u 0
0.0
1.0
2.0
3.0
4.0
5.0
V/
 u
0w
d
η
0.0 0.2 0.4 0.6 0.8 1.0
η
(a)
(b)
Fig. 11. Comparing the steady-state responses of passive and semi-active
Reid oscillators under different rw for (a) maximum displacement and (b)
maximum velocity.
displacement and velocity of passive and semi-active Reid os-
cillators are small. In the range of 1 <rw1.6, the maximum
displacement and velocity of semi-active Reid oscillator are
larger than that of the passive Reid oscillator. The non-sticking
region of semi-active Reid oscillator is smaller than that of the
passive Reid oscillator. These two oscillators both start to ap-
pear as the sticking motion when rw < 1/3, and in this range
our estimations fail.
Acknowledgement
The ﬁnancial support provided by the National Science
Council of Taiwan under the Grant NSC 94-2211-E-019-005
is gratefully acknowledged.
786 C.-S. Liu / International Journal of Non-Linear Mechanics 41 (2006) 775–786
2 = 1
√
1 + 
1 −  =
rw√
1 −  , (B.15)
where
0 :=
√
k
m
, rw := d
0
. (B.16)
In order to have a non-trivial solution for V/(d), cosd t1
and sind t1, we must let the determinant of the coefﬁcient
matrix in Eq. (B.1) be zero:∣∣∣∣∣
a11 a12 a13
a21 a22 a23
a31 a32 a33
∣∣∣∣∣= 0,
which, in view of Eqs. (B.3), (B.4), (B.6), (B.7), (B.9), (B.10),
(B.12) and (B.13) by cancelling out the factor of u0 due to
u0 > 0, leads to Eq. (43).
References
[1] T.K. Caughey, A. Vijayaraghavan, Free and forced oscillations of a
dynamic system with “linear damping” (nonlinear theory), Int. J. Non-
Linear Mech. 5 (1970) 533–555.
[2] K.K. Beucke, J.M. Kelly, Equivalent linearization for practical hysteretic
systems, Int. J. Non-Linear Mech. 32 (1985) 211–238.
[3] N. Makris, M.C. Constantinou, Analysis of motion resisted by friction.
I. Constant Coulomb and linear/Coulomb friction, Mech. Struct. Mach.
19 (1991) 477–500.
[4] R.W. Clough, J. Penzien, Dynamics of Structures, McGraw-Hill, New
York, 1975.
[5] S.R. Kuo, J.T. Chen, Forced vibration of a sdof system with a new
hysteretic damping subjected to harmonic loading, Int. J. Appl. Math. 1
(1999) 411–438.
[6] Y. Zhang, W.D. Iwan, Some observations on two piecewise-linear
dynamic systems with induced hysteretic damping, Int. J. Non-Linear
Mech. 38 (2003) 753–765.
[7] G.B. Muravskii, On frequency independent damping, J. Sound Vib. 274
(2004) 653–668.
[8] T.J. Reid, Free vibration and hysteretic damping, J. R. Aeronaut. Soc.
60 (1956) 738.
[9] T.K. Caughey, Musings on structural control, in: Proceedings of the
International Workshop on Structural Control, vol. 65, 1993.
[10] C.-S. Liu, The steady loops of sdof perfectly elastoplastic structures
under sinusoidal loadings, J. Mar. Sci. Technol. 8 (2000) 50–60.
[11] C.-S. Liu, The steady-state responses of a bilinear elastoplastic oscillator
under sinusoidal loading, J. Chin. Inst. Eng. 25 (2002) 199–210.
[12] H.-K. Hong, C.-S. Liu, Non-sticking oscillation formulae for Coulomb
friction under harmonic loading, J. Sound Vib. 244 (2001) 883–898.
[13] C.-S. Liu, Z.-M. Huang, The steady state responses of sdof viscous
elasto-plastic oscillator under sinusoidal loadings, J. Sound Vib. 273
(2004) 149–173.
[14] H.-K. Hong, C.-S. Liu, Coulomb friction oscillator: modelling and
responses to harmonic loads and base excitations, J. Sound Vib. 229
(2000) 1171–1192.
of a closed-loop control and an open-loop control [5-7] and was sometimes called the feedback-
feedforward (FF) control [8,9]. However, the FF control has to assume Gaussian processes
and to presume a model of earthquake excitations, for example the model of Kanai-Tajimi
[10-12], which obviously do not amount to an actual earthquake excitation. Indeed, the FF
control is optimal only if all the processes involved are Gaussian and is efficient only if the
modeled excitation is similar to the actual excitation [7]; on the other hand, the SF control
is optimal only if the external excitation is entirely absent.
In a previous paper [4] we have already tackled this problem by faithfully considering the
effect of external disturbance on the control law of the controlled structure. In this paper
we intend to assess quantitatively the performance of the complete state (CS) controller by
developing a stabilized numerical algorithm and comparing the results to the other LQ con-
trollers by means of some examples. The arrangement of this paper is as follows. In Section
2 we reformulate the LQ optimal control as an initial value problem (IVP). In Section 3
we discuss the solution of IVP in terms of integrals. In Section 4 a stabilized formulation
is derived. In Section 5 a control algorithm based on complete state control is proposed.
In Section 6 we use numerical simulations to study the performance of the CS control algo-
rithm and the relative merits of the CS, SF and FF algorithms for active control of structures
against earthquakes.
2. AN IVP FORMULATION FOR LQ OPTIMAL CONTROL
Consider a linear engineering structure with ns degrees of freedom subjected to the excitation
w(t) due to earthquake and to the control force u(t). The equation of motion of the structure
may be written as
Mx¨s(t) + Cx˙s(t) + Kxs(t) = Bsu(t) + Esw(t), (1)
in all its lifetime [tb, td] ⊂ R, with prescribed initial conditions xs(t0) and x˙s(t0). Here t is
current time and t0 ∈ [tb, td) is an initial time. See Figure 1. The column matrix xs is the
relative displacement. A superposed dot indicates a time differentiation. The symmetric
matrices M, C, K are, respectively, the mass, damping, and stiffness of the structure. To
be a structure M and K are positive definite and C is positive semidefinite. This structural
dynamical problem of ns equations of motion together with the initial conditions on ns
displacements and ns velocities can be transformed to the state space description as follows:
x˙(t) = Ax(t) + Bu(t) + Ew(t), x(t0) = x0 (2)
in all its lifetime [tb, td] ⊂ R, where
x(t) =

 xs(t)
x˙s(t)

 , x0 =

 xs(t0)
x˙s(t0)

 (3)
and
A =

 0 I
−M−1K −M−1C

 , B =

 0
M−1Bs

 , E =

 0
M−1Es

 . (4)
2
It is easy to check that N is symmetric and negative semidefinite and H is a Hamiltonian
matrix, which is, by definition, a square matrix satisfying
(JH)T = JH, J :=

 0 I
−I 0

 , J−1 = JT = −J, J2 = −I. (11)
3. SOLUTION
To solve the optimal control problem, we seek in this section a change of variables, more
precisely, a change of bases and coordinates in the sympletic space of the complete states.
It is preferable not only theoretically but also computationally for a change of variables to
preserve the Hamiltonian structure. To have such a structure-preserving transformation (in
fact a symplectic basis change), let us define the internal costate [4]:
zx(t) := λ(t)−Rxx(t), (12)
where the Riccati matrix Rx can be calculated directly from
Rx := ΨλxΨ
−1
xx (13)
with Ψ determined by solving the H eigenproblem:
HΨ = ΨΩ, (14)
where
Ψ =

 Ψxx Ψxλ
Ψλx Ψλλ

 , Ω =

 Ω1 0
0 −ΩT1

 . (15)
Consequently, the state-costate IVP (9) is transformed, upon employing the algebraic Riccati
equation
Q + RxA + A
TRx + RxNRx = 0, (16)
to the state-internal costate IVP:
d
dt

 x(t)
zx(t)

 =

 Ax N
0 −ATx



 x(t)
zx(t)

 +

 Ew(t)
−RxEw(t)

 , (17)

 x(t0)
zx(t0)

 =

 x0
−Rxx0

 , (18)
where
Ax := A + NRx. (19)
Integrating Equation (17) from a time tk to the current time t, leads to
x(t) = e(t−tk)Axx(tk) +
∫ t
tk
e(t−τ)AxNzx(τ)dτ +
∫ t
tk
e(t−τ)AxEw(τ)dτ, (20)
zx(t) = e
−(t−tk)A
T
x zx(tk)−
∫ t
tk
e−(t−ξ)A
T
x RxEw(ξ)dξ. (21)
4
in the new Equation (27), and finally equate the resulting equation to Equation (20) with
tk replaced by tk−`, obtaining
zx(t) = [e
(t−tk−`)AxLxe
(t−tk−`)A
T
x − Lx]
−1
{
−
∫ t
tk−`
e(t−τ)AxNzx(τ)dτ
+
∫ t
tk−`
[
e(t−τ)AxLx − e
(t−tk−`)AxLxe
(τ−tk−`)A
T
x
]
RxEw(τ)dτ
}
. (28)
Since all the eigenvalues of Ax have negative real parts, all the exponential functions in
Equations (27) and (28) are decaying if t0 ≤ tk−` < tk < t, ensuring the asymptotical
stability in the time-stepping algorithm of the internal costate zx and the internal state yx.
The price we paid is that we need to calculate the inverse [e(t−tk−`)AxLxe
(t−tk−`)A
T
x − Lx]
−1
at each time step.
What is the meaning of Equation (28)? To answer it, we first recognize that Equation
(21) is stable numerically if the time direction is reversed backward; therefore, we may
calculate the values zx(τ) for all τ ∈ [tk−`, t) from an unknown current value zx(t), compare
these newly calculated values with the already known values zx(τ) and require the error
(τ, zx(t)) := e
(t−τ)ATx zx(t) +
∫ t
τ
e(ξ−τ)A
T
x RxEw(ξ)dξ − zx(τ) (29)
to be as small as possible. Accordingly, we minimize the squared L2-error weighted by a
positive definite matrix −N > 0:
−1
2
∫ t
tk−`
[(τ, zx(t))]
TN(τ, zx(t))dτ (30)
so as to determine zx(t). The result is
zx(t) = −
{∫ t
tk−`
e(t−τ)AxNe(t−τ)A
T
x dτ
}
−1
∫ t
tk−`
e(t−τ)AxN
[∫ t
τ
e(ξ−τ)A
T
x RxEw(ξ)dξ − zx(τ)
]
dτ. (31)
Then, we derive the following formula:∫ t
ξ
e(t−τ)AxNe(t−τ)A
T
x dτ = Lx − e
(t−ξ)AxLxe
(t−ξ)ATx . (32)
Let us substitute N in (23) into the left-hand side of (32) to obtain∫ t
ξ
e(t−τ)AxNe(t−τ)A
T
x dτ = −
∫ t
ξ
e(t−τ)Ax [AxLx + LxA
T
x ]e
(t−τ)ATx dτ.
The right-hand side can be written as
−
∫ t
ξ
e(t−τ)Ax [AxLx + LxA
T
x ]e
(t−τ)ATx dτ =
∫ t
ξ
d
dτ
[
e(t−τ)AxLxe
(t−τ)ATx
]
dτ.
6
Step 5: use Equation (35) with k = 0 to calculate x(t1);
Step 6: use Equation (36) with k = 0 to calculate u(t1);
Step 7: repeat steps 4-6 but with k = 1, 2, . . . to calculate zx(tk+1), x(tk+1) and u(tk+1).
It is important to note that the most calculations can be carried out off-line in advance,
including all the coefficients in the linear algebraic Equations (34)-(36), so that only a few
simple on-line calculations are needed in the real-time control practice. Hence, the above
proposed algorithm in the stage of real-time operation is simple and stable.
6. NUMERICAL SIMULATIONS AND COMPARISONS
To demonstrate the capability of the new control law three examples are numerically simu-
lated by comparing with the conventional state feedback (SF) control law and the so-called
feedback-feedforward (FF) control law, the brief sketches of which are given right below.
6.1. State feedback (SF) control
It is known that in the conventional state feedback control theory the Riccati differential
equation
Λ˙1(t) + Λ1(t)A + A
TΛ1(t) + Λ1(t)NΛ1(t) + Q = 0, Λ1(tf ) = 0 (37)
is solved numerically backwards in time. Fortunately, with usual values of weighting matrices
and structure properties, the Riccati matrix Λ1(t) remains constant almost over the entire
duration [t0, tf ] except for very near the terminal time tf . Hence we may set Λ1 = Rx to
simplify the calculation, where Rx is given in Equation (13).
In the conventional control theory the internal costate zx(t) is neglected. For this reason,
the conventional SF controller is regulated by the response state vector alone and disregards
zx(t) by letting zx(t) = 0; consequently, Equations (12) and (33) change, respectively, to
λ(t) = Rxx(t), (38)
u(t) = −R−1BTRxx(t). (39)
It is obvious that the control due to Equation (39) does not meet the optimality condition
if the external excitation does not vanish. Although this methodology prevails in the optimal
control literature and is known as a linear quadratic regulator (LQR), it is not the optimal
one when the structure is subjected to external excitations.
6.2. Feedback-feedforward (FF) control
The formulation [5,6,8,9] of the FF control is briefly sketched. In this control theory, the
external excitation is taken as the output of a linear filter driven by a Gaussian white noise
process wd(t). Figure 2 shows the arrangement of the FF control. Thus,
w(t) = Dd(t)zd(t), z˙d(t) = Adzd(t) + Cdwd(t), (40)
where zd is a p-dimensional state vector of the seismic excitation model; wd(t) is a stationary
Gaussian vector white noise process; and Dd(t) is a function of time allowing nonstationary
8
where m is the mass of the floor, c is the damping coefficient, and k is the structure stiffness.
At here m = 2.92 kN s2/m, k = 1389.76 kN/m, and c = 1.58 kN s/m were used. A control
force
u(t) = −4kcT (t) cos α (47)
was applied to the floor through a pair of tendons connected to an actuator placed at the
base with a tendon stiffness kc = 372.05 kN/m and a tendon angle α = 36
◦, T (t) being the
displacement of tendon. By using the CS control law (33), Equation (46) becomes
mx¨s(t) +
[
c +
Rx22
mR
]
x˙s(t) +
[
k +
Rx12
mR
]
xs(t) = w(t)−
zx2(t)
mR
. (48)
This equation is very inspiring in that the effect of the control force u(t) regulated by the
CS controller is essentially to increase the damping coefficient and the stiffness capacity of
the dynamical system by the amounts of Rx22/(mR) and Rx12/(mR), respectively, and at
the same time to change the disturbance shape by the amount of zx2/(mR). Equation (48)
may be recast to
x¨s(t) + 4piζmfmx˙s(t) + 4pi
2f 2mxs(t) = Wm(t), (49)
where the modified (undamped) natural frequency fm, the modified damping ratio ζm, and
the modified disturbance are, respectively,
fm :=
1
2pi
√
k
m
+
Rx12
m2R
, ζm :=
c + Rx22/(mR)
2
√
mk + Rx12/R
, Wm(t) :=
w(t)
m
−
z2(t)
m2R
. (50)
We consider two cases. Both have the same Q given by Q11 = 1389.76 m
−2, Q12 =
Q21 = 0 m
−2 s−1, Q22 = 0 m
−2s−2, but with different R and therefore the different Riccati
matrix as follows: case (1) R = 0.00257 (kN)−2, Rx11 = 126.39, Rx12 = Rx21 = 1.3699,
Rx22 = 0.2333; case (2) R = 0.0257 (kN)
−2, Rx11 = 332.3, Rx12 = Rx21 = 1.45, Rx22 = 0.687.
In the sense of Equation (49), the characteristic parameters were improved substantially
by the CS controller, for case (1) the natural frequency jumping up from f = 3.47 Hz to
fm = 3.69 Hz, the damping ratio increasing from ζ = 1.24% to as high as ζm = 24.14%, and
the forcing amplitude changing from |w|rms = 0.4357 and |w|∞ = 3.4155 to |Wm|rms = 0.4002
and |Wm|∞ = 3.5715; for case (2) the natural frequency jumping up from f = 3.47 Hz to
fm = 3.496 Hz, the damping ratio increasing from ζ = 1.24% to ζm = 8.376%, and the
forcing amplitude changing from |w|rms = 0.4357 and |w|∞ = 3.4155 to |Wm|rms = 0.4283
and |Wm|∞ = 3.1243. Table II(a) compares the results of case (1). The CS algorithm
not only suppressed 27.0% (l2-norm) or 24.4% (l∞-norm) more displacement than the SF
algorithm but also saved 10.7% (l2-norm) or 26.1% (l∞-norm) of the control force; the
performance index of the CS controller was far less than that of the SF controller with value
36.3%. Table II(b) compares the results of case (2). The CS algorithm not only suppressed
27.7% (l2-norm) or 23.0% (l∞-norm) more displacement than the SF algorithm but also
saved 32.5% (l2-norm) or 38.4% (l∞-norm) of the control force; the performance index of the
CS controller was far less than that of the SF controller with value 50.2%.
Although the SF algorithm has the effects of strengthening and increasing damping, it
is not smart enough to know how to change the shape of external excitations. In Figure 4
the maximum relative displacements and maximum control forces of the two controllers SF
and CS are compared for different ratios of Q11/R. Before the ratio Q11/R = 3.5× 10
6, the
10
have higher participation factors, as may be seen in Figures 5-7, which reveal clearly that the
responses of the two controlled cases are full of components of higher frequencies (Figures
5-7(b) and (c)) compared with the uncontrolled case (Figures 5-7(a)).
The maximum values in Table VII and Figures 8-9 show that the CS controller demands
the actuator capacity of the active tendon controllers to increase 3.1% to 30.9% at the first
five stories, but those at the last three stories to decrease slightly in the range 0.15% to 3.0%.
Also, the root-mean-square values presented in Table VII can be used to calculate the root-
sum-square control force for the whole structure, yielding 405.4 kN for the SF controller and
405.3 kN for the CS controller. This indicates the same power consumption to be required
for the above two controllers.
In summary, a cross-examination of Tables III-VII on the general performances of the
SF and CS controllers indicates that the CS controller performs better than the SF one in
terms of relative displacement, story acceleration and story shear force on every floor and
story, and also in control forces at upper stories. Indeed, it has been proved that judged
from the performance index set up in Equation (5) the CS controller always performs better
than the SF controller.
6.6. Example 3
For the purpose of comparing the three controls, except for the control algorithms, all pa-
rameters and functions that including the earthquake imposing on the base should be taken
as the same. Recalling that the FF control needs to assume a Gaussian process and to pre-
sume a model of earthquake excitations. The external excitations were therefore modeled
by passing a Gaussian white noise process through a second order filter of Kanai [10] and
Tajimi [11], for which the spectral density function was given by [12]
Φ(ω) =
1 + 4ζ2g (ω/ωg)
2
[1− (ω/ωg)2]2 + 4ζ2g (ω/ωg)
2
S (51)
with ωg = pi Hz, ζg = 0.3 and S = 4.5× 10
−4 m−2/s3. Dd(t) in Equation (40) was calculated
by [6]
Dd(t) = a(t)
[
−ω2g − 2ζgωg
]
(52)
with the envelope function being
a(t) =


0, t < 0,
( t
t1
)2, 0 ≤ t < t1,
1, t1 ≤ t < t2,
exp[−γ(t− t2)], t ≥ t2,
(53)
in which t1 = 3 s, t2 = 13 s, tf = 30 s, and γ = 0.26 s
−1. The external excitation w(t)
was then calculated via Equation (40). The time history of w(t) so calculated are shown in
Figure 10(a). The shear building structure described in Example 2 is employed here again
to compare the performances of SF, FF and CS controllers, where the related structure
parameters remain unchanged.
12
Gaussian and is to a substantial extent dependent upon the presumed earthquake model,
both the SF and CS controls are LQ algorithms and are suitable to both the deterministic
and stochastic descriptions of earthquake excitations. The CS control takes full advantage
of the information of the actual earthquake but does not need to know the earthquake in
advance, and is easily implemented in real-time and on-line.
The SF controller disregards the internal costate zx which account for the accumulated
effect of the external excitations w on the structure and therefore performs less satisfactorily
than the CS controller. The internal costate zx in the CS controller should not be mixed up
with the zd in the FF controller since they are based upon very different underlying ideas.
The numerical results shown in the tables and figures have confirmed that the response val-
ues by using the CS controller were encouragingly smaller than the values by using the SF
and FF controllers.
REFERENCES
1. Kurata N, Kobori T, Takahashi M, Niwa N, Midorikawa H. Actual seismic response
controlled building with semi-active damper system. Earthquake Engineering and
Structural Dynamics 1999; 28:1427-1447.
2. Chase JG, Barroso LR, Hunt S. Quadratic jerk regularization and the seismic control
of civil structures. Earthquake Engineering and Structural Dynamics 2003; 32:2047-
2062.
3. Iemura H., Pradono MH. Simple algorithm for semi-active seismic response control
of cable-stayed bridges. Earthquake Engineering and Structural Dynamics 2005; in
press.
4. Hong HK, Liu CS, Liou DY. Complete state LQ optimal control of earthquake-
excited structures. Proceedings of the National Science Council ROC(A) 1994;
18:386-399.
5. Xu YL, Zhang WS. Closed-form solution for seismic response of adjacent buildings
with linear quadratic Gaussian controllers. Earthquake Engineering and Structural
Dynamics 2002; 31:235-259.
6. Abdel-Rohman M, Quintana VH, Leipholz HH. Optimal control of civil engineering
structures. Journal of Engineering Mechanics (ASCE) 1980; 106:57-73.
7. Abdel-Rohman M, Leipholz HH. Stochastic control of structures. Journal of Engi-
neering Mechanics (ASCE) 1981; 107:1313-1325.
8. Suhardjo J, Spencer BF, Sain MK. Feedback-feedforward control of structures under
seismic excitation. Structural safety 1990; 8:69-89.
9. Suhardjo J, Kareem, A. Feedback-feedforward control of offshore platforms under
random waves. Earthquake Engineering and Structural Dynamics 2001; 30:213-235.
10.Kanai K. Seismic-empirical formula for the seismic characteristics of the ground.
Bulletin of the Earthquake Research Institute Tokyo University 1957; 35:309-325.
11.Tajimi H. A statistical method of determining the maximum response of a building
during an earthquake. Proceedings of the 2nd World Conference on Earthquake
Engineering, Tokyo-Kyoto, Japan, 781-798, 1960.
12. Lin YK, Cai GQ. Probabilistic Structural Dynamics Advanced Theory and Applica-
tions, McGraw-Hill, New York, 1995.
13. Meyer KR, Hall GR. Introduction to Hamiltonian Dynamical Systems and the N-
body Problem, Springer-Verlag, New York, 1992.
14
the IVP (A4) and (A5) is transformed to
d
dt

 yλ(t)
zλ(t)

 =

 ATλ 0
0 −Aλ



 yλ(t)
zλ(t)

 +

 Ew(t)
−LλEw(t)

 , (A11)

 yλ(t0)
zλ(t0)

 =

 x0
−Lλx0

 . (A12)
Again like H, the system matrix of Equation (A11) is also a constant coefficient linear
Hamiltonian matrix, as is easily verified.
Integration of Equation (A11) from time tk to time t leads to
zλ(t) = e
−(t−tk)Aλzλ(tk)−
∫ t
tk
e−(t−ξ)AλLλEw(ξ)dξ (A13)
and Equation (A7) as well.
From Equation (A10) it follows that
L−1λ QL
−1
λ + L
−1
λ Aλ + A
T
λL
−1
λ = 0. (A14)
Using the above equation we have∫ t
ξ
e(t−τ)A
T
λ L−1λ QL
−1
λ e
(t−τ)Aλdτ = −
∫ t
ξ
e(t−τ)A
T
λ [ATλL
−1
λ + L
−1
λ Aλ]e
(t−τ)Aλdτ
=
∫ t
ξ
d
dτ
[
e(t−τ)A
T
λ L−1λ e
(t−τ)Aλ
]
dτ = L−1λ − e
(t−ξ)AT
λ L−1λ e
(t−ξ)Aλ . (A15)
Substituting Equation (A7) for yλ(ξ) into Equation (A8) and using the following formula
1
−
∫ t
ξ
e−(t−τ)AλQe−(t−τ)A
T
λ dτ = Lλ − e
−(t−ξ)AλLλe
−(t−ξ)AT
λ , (A16)
we obtain
λ(t) = e−(t−tk)Aλλ(tk) + [Lλe
(t−tk)A
T
λ − e−(t−tk)AλLλ]yλ(tk)
+
∫ t
tk
[Lλe
(t−ξ)AT
λ − e−(t−ξ)AλLλ]Ew(ξ)dξ. (A17)
Using Equation (A9) it can be written as
λ(t) = Lλe
(t−tk)A
T
λ L−1λ λ(tk) + [e
−(t−tk)Aλ − Lλe
(t−tk)A
T
λ L−1λ ]zλ(tk)
−
∫ t
tk
[e−(t−ξ)AλLλ − Lλe
(t−ξ)AT
λ ]Ew(ξ)dξ. (A18)
On the other hand substituting Equation (A13) for zλ(τ) into the following integral and
using formula (A15) we obtain∫ t
tk
e(t−τ)A
T
λ L−1λ QL
−1
λ zλ(τ)dτ = [L
−1
λ e
−(t−tk)Aλ − e(t−tk)A
T
λ L−1λ ]zλ(tk)
−
∫ t
tk
[L−1λ e
−(t−ξ)Aλ − e(t−ξ)A
T
λ L−1λ ]LλEw(ξ)dξ. (A19)
16
In view of Equation (A15) the above equation turns out to be
zλ(t) = [e
(t−tk−`)A
T
λ L−1λ e
(t−tk−`)Aλ − L−1λ ]
−1∫ t
tk−`
e(t−τ)A
T
λ L−1λ QL
−1
λ
[∫ t
τ
e(ξ−τ)AλLλEw(ξ)dξ − zλ(τ)
]
dτ. (A27)
Therefore, the meaning of Equation (A23) is to determine such zλ(t) as to minimize the
L2-error of the backward calculations of zλ(τ) ∀τ ∈ [tk−`, t) from the zλ(t).
With yλ(t) from Equation (A7) and zλ(t) from Equation (A27) the optimal control is
determined by
u(t) = −R−1BT[Lλyλ(t) + zλ(t)], (A28)
which is obtained by substituting the definition (A9) into equation (8). Altogether, the above
three Equations (A13), (A27) and (A28) constitute a stabilized optimal control algorithm.
18
Table I. Comparisons of CS, SF and FF controls.
CS control SF control FF control
Excitation no constraint no constraint constrained by (40)
Optimality LQ via (5) failed to meet (5) LQG via (42)
Control law (33) (39) (43)
Rx (13) (13) (13)
Λ2 no need no need (44)
Internal (co)state zx via (24)2 zx = 0 zd via (40)2
Input in internal (co)state equation w no constraint no wd Gaussian white noise
Symplectic form yes yes no
Table II(b). The results of example 1 for case (2) with NC, CS control and SF control.
NC CS (a) SF (b) (a-b)/b
relative displacement
cm cm % cm % %
max 1.7486 0.942 -46.1 1.224 -30.0 -23.0
rms 0.37 0.13 -64.9 0.180 -51.4 -27.7
control force
kN kN %
max 1.648 2.677 -38.4
rms 0.224 0.332 -32.5
performance
JCS JSF %
×10−1 1.092 2.195 -50.2
Table VI. Maximum response of story shear force of example 2.
Story No. NC (a) SF (b) CS (c) (c− b)/b
kN kN % kN % %
Story 1 11096 1908 -82.8 232 -97.9 -87.8
Story 2 11043 1126 -89.8 638 -94.2 -43.3
Story 3 10651 685 -93.6 554 -94.8 -19.1
Story 4 9976 484 -95.1 435 -95.6 -10.1
Story 5 8909 388 -95.6 364 -95.9 -6.2
Story 6 7314 323 -95.6 271 -96.3 -16.1
Story 7 5243 268 -94.9 221 -95.8 -17.5
Story 8 2739 183 -93.3 143 -94.8 -21.9
Table VII. Demand of control force of example 2.
Floor No. Maximun Root mean square
SF (b) CS (c) (c-b)/b SF (b) CS (c) (c-b)/b
kN kN % kN kN %
Floor 1 408 534 30.9 57 66 15.8
Floor 2 751 923 22.9 103 114 10.7
Floor 3 1006 1154 14.7 135 142 5.2
Floor 4 1176 1269 7.9 154 155 0.65
Floor 5 1275 1315 3.1 162 160 -1.2
Floor 6 1326 1324 -0.15 165 161 -2.4
Floor 7 1347 1319 -2.1 166 160 -3.6
Floor 8 1353 1313 -3.0 166 160 -3.6
Table IX. Root-mean-square response of relative displacement of example 3.
Floor No. NC (a) SF (b) FF (c) CS (d) (d− b)/b (d− c)/c
cm cm % cm % cm % % %
Floor 1 0.252 0.0282 - 88.8 0.0161 -93.6 0.0117 -95.4 -58.5 - 27.3
Floor 2 0.488 0.0444 - 90.9 0.0228 -95.3 0.0144 -97.0 -67.6 - 36.8
Floor 3 0.702 0.0530 - 92.5 0.0251 -96.4 0.0135 -98.1 -74.5 - 46.2
Floor 4 0.889 0.0567 - 93.6 0.0259 -97.1 0.0117 -98.7 -79.4 - 54.8
Floor 5 1.045 0.0579 - 94.5 0.0267 -97.4 0.0101 -99.0 -82.6 - 62.2
Floor 6 1.166 0.0578 - 95.0 0.0274 -97.7 0.0092 -99.2 -84.1 - 66.4
Floor 7 1.248 0.0573 - 95.4 0.0281 -97.7 0.0087 -99.3 -84.8 - 69.0
Floor 8 1.290 0.0570 - 95.6 0.0284 -97.8 0.0085 -99.3 -85.1 - 70.0
Table XII. Demand of maximum control force of example 3.
Floor No. Maximun
SF (b) FF (c) CS (d) (d-b)/b (d-c)/c
kN kN kN % %
Floor 1 81 92 118 45.7 28.3
Floor 2 150 166 202 34.7 21.7
Floor 3 201 218 248 23.4 13.8
Floor 4 236 249 268 13.6 7.6
Floor 5 257 265 277 7.8 4.5
Floor 6 270 272 279 3.3 2.6
Floor 7 276 274 279 1.1 1.8
Floor 8 279 274 279 0.0 1.8
Table XIII. Demand of RMS control force of example 3.
Floor No. Root mean square
SF (b) FF (c) CS (d) (d-b)/b (d-c)/c
kN kN kN % %
Floor 1 17 21 26 52.9 23.8
Floor 2 31 38 44 41.9 15.8
Floor 3 42 49 53 26.2 8.2
Floor 4 49 55 57 16.3 3.6
Floor 5 54 58 58 7.4 0
Floor 6 56 60 59 5.4 -1.7
Floor 7 58 60 59 1.7 -1.7
Floor 8 59 60 59 0.0 -1.7
R−1BTΛ1
structure
R−1BTΛ2 Dd(t)
z˙d(t) = Adzd(t) + Cdwd(t)
∑
?
ﬀﬀ Λ2
Ad
?
?
?
?
?
-
6
ﬀ
-
white noise wd(t)
zd(t)
w(t)
u(t) x(t)−
−
Figure 2. The flow diagram of the feedback-feedforward (FF) control.
            
            
            
            
            
           
-1E+6 0E+0 1E+6 2E+6 3E+6 4E+6 5E+6 6E+6
0.0
0.5
1.0
1.5
2.0
0
2
4
6
8
10
 Q11 /R
M
ax
im
u
m
 r
el
at
iv
e 
d
is
p
la
ce
m
en
t 
(c
m
)
M
ax
im
u
m
 c
on
tr
ol
 f
or
ce
 (
k
N
)
relative displacement
control force
CS
SF
Figure 4. The maximum relative displacements and maximum control forces
of the two controllers SF and CS are compared for different ratios of  Q11 /R.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
               
              
-1000
-500
0
500
1000
-250
0
250
500
0 20 40 60
-500
-250
0
250
500
R
oo
f 
ac
ce
le
ra
ti
on
 x
s8
 (
cm
/s
ec
2  
)
(a)
(b)
(c)
Time (sec)
Figure 6. The roof accelerations of example 2 for (a) NC, (b) SF, and (c) CS.
 
 
 
 
 
 
 
 
 
 
 
                  
 
                 
-500
-250
0
250
500
0 20 40 60
-500
-250
0
250
500
F
ir
st
 f
lo
or
 c
on
tr
ol
 f
or
ce
 u
1  
(k
N
)
(a)
(b)
Time (sec)
Figure 8. The first floor control forces of example 2 for (a) SF, and (b) CS.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                   
-6
-3
0
3
6
-0.3
-0.2
-0.1
0.0
0.1
0.2
0.3
-0.3
-0.2
-0.1
0.0
0.1
0.2
0.3
R
oo
f 
re
la
ti
v
e 
d
is
p
la
ce
m
en
t 
x
s8
 (
cm
)
0 20 40 60
-0.3
-0.2
-0.1
0.0
0.1
0.2
0.3
Time (sec)
(a)
(b)
(c)
(d)
Figure 10. The roof relative displacements of example 3 for (a) NC, (b) SF, (c) FF, and (d) CS.
 
 
 
 
 
 
 
 
 
 
 
                 
-5000
-2500
0
2500
5000
-500
-250
0
250
500
B
as
e 
sh
ea
r 
fo
rc
e 
V
1  
 (
k
N
)
0 20 40 60
-500
-250
0
250
500
-500
-250
0
250
500
Time (sec)
(a)
(b)
(c)
(d)
Figure 12. The base shear forces of example 3 for (a) NC, (b) SF, (c) FF, and (d) CS.
 
 
 
 
 
 
 
 
