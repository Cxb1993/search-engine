with the unconnected n-1 ports terminated with the 
virtual auxiliary terminations whose characteristics 
are acquired through indirect measurements. The S-
matrices of a Mini-Circuits&reg； D17I 17 dB 
directional coupler, a DiTom&reg； three-port 
circulator D3C2040 and a Narda&reg； four-port 
circulator COF-2040 are then acquired accordingly 
from measurements using a two-port vector network 
analyzer and virtual auxiliary terminations. 
In Chapter 3, the design of an 8-port 4 x 4 Butler 
matrix is described. With the aid of the HFSS&reg； 
of Ansoft Corporation to visualize the field 
distributions, theory of the short-slot coupler is 
reviewed in the beginning. Explicit design formulas 
of 3 dB and 0 dB short-slot couplers are arranged to 
estimate the structure dimensions for the HFSS&reg； 
simulations to begin with. According to the 
simulation results, SIW short-slot couplers of 0 dB 
and 3 dB and a 30 GHz 4 x 4 SIW Butler matrix are 
designed on Rogers RO4003&reg； substrate with 8 mil 
thickness. 
For the measurement of short-slot couplers, the 
measurement of fully symmetric four-port network 
using two-port vector network analyzer is discussed 
in Chapter 4 to reconstruct the four-port S-matrices 
of the 3 dB and 0 dB SIW short-slot couplers. 
Finally, a measurement procedure is developed in 
Chapter 5 to acquire the eight-port S-matrix of a 4 x 
4 SIW Butler matrix by exploiting the concept of 
virtual auxiliary termination. 
英文關鍵詞： n-port microwave network, S-matrix, Butler matrix, 
substrate integrated waveguide 
 
  
 
ii 
 
 
和 0 dB SIW 短槽耦合器以及四乘四 SIW 巴特勒矩陣。 
為了量測短槽耦合器，於第四章討論使用雙埠向量網路分析儀量測完全對
稱的四埠元件，並據此重建 3 dB 和 0 dB SIW 短槽耦合器之四埠散射矩陣。 
最後，於第五章配合虛擬輔助負載，發展出一套量測方法，重建四乘四
SIW 巴特勒矩陣之散射矩陣。本論文使用 Rogers RO4003®  8 mil 厚板材製作 3 
dB 和 0 dB 短槽耦合器以及四乘四巴特勒矩陣，電路結構均採用基板合成波導
（SIW）。雖然它們是多埠元件，其多埠散射矩陣則係利用雙埠向量網路分析
儀量測及 TRL（thru-reflect-line）校準，並經適當計算予以重建。對每一待測
物而言，重建之散射矩陣一方面可驗證其效能；另一方面則可提供其設計參
數，方便設計其後續應用。 
 
 
 
 
 
 
 
 
 
  
 
iv 
 
 
For the measurement of short-slot couplers, the measurement of fully 
symmetric four-port network using two-port vector network analyzer is discussed in 
Chapter 4 to reconstruct the four-port S-matrices of the 3 dB and 0 dB SIW 
short-slot couplers. 
Finally, a measurement procedure is developed in Chapter 5 to acquire the 
eight-port S-matrix of a 4 x 4 SIW Butler matrix by exploiting the concept of 
virtual auxiliary termination. 
 
 
 
 
 
 
 
 
 
 
 
 
  
 
vi 
 
 
2.3 Accuracy Analysis ．．．．．．．．．．．．．．．．．．． 21 
2.4 Remedy for Numerical Difficulty ．．．．．．．．．．．．． 26 
2.5 Experiment ．．．．．．．．．．．．．．．．．．．．．． 29 
2.6 Results ．．．．．．．．．．．．．．．．．．．．．．． 31 
2.7 Summary ．．．．．．．．．．．．．．．．．．．．．． 32 
CHAPTER 3  DESIGN OF SIW BUTLER MATRIX ．．．．．．． 56 
3.1 Introduction ．．．．．．．．．．．．．．．．．．．．． 56 
3.2 Basic Components ．．．．．．．．．．．．．．．．．．． 57 
3.2.1 3 dB Short-slot Coupler ．．．．．．．．．．． 61 
3.2.2 0 dB Short-slot Coupler and Phase Shifters ．．．． 63 
3.3 4 x 4 Butler Matrix ．．．．．．．．．．．．．．．．．．． 66 
3.4 Summary ．．．．．．．．．．．．．．．．．．．．．． 67 
CHAPTER 4  MEASUREMENT OF FULLY SYMMETRIC 
FOUR-PORT NETWORK．．．．．．．． ．．．．． 80 
4.1 Introduction ．．．．．．．．．．．．．．．．．．．．． 80 
4.2 Formulation ．．．．．．．．．．．．．．．．．．．．． 81 
4.3 Experiment and Results ．．．．．．．．．．．．．．．．． 84 
4.4 Summary  ．．．．．．．．．．．．．．．．．．．．．．． 84 
CHAPTER 5  MEASUREMENT OF SIW BUTLER MATRIX ．．． 89 
5.1 Introduction ．．．．．．．．．．．．．．．．．．．．． 89 
5.2 Measurement ．．．．．．．．．．．．．．．．．．．．． 90 
1 
 
A straightforward way to characterize a multiport network is to use a 
multiport vector network analyzer (VNA) without delving into the underlying 
operating principle [1], [2]. In light of all the multiport VNAs that appear on the 
market [3], one usually can simplify multiport measurement nowadays. However, 
the use of a two-port VNA is still necessary for a multiport device with number of 
ports or the operating frequency beyond the specifications of commercial 
multiport VNAs. In addition, since the two-port thru-reflect-line (TRL) 
calibration is simple and well developed [4] compared to the multiport one [5], 
the use of a two-port VNA accompanied with the two-port TRL is favorable for 
the shift of the reference plane of a multiport measurement [6]. 
1 
Chapter 
INTRODUCTION 
  
3 
 
 
1
2
3
2
0 0 0
0 0 0
0 0 0
0
0 0 0
n
n
k
k
KK
k
k


 
 
 
  
 
 
  
. (1.5) 
The diagonal elements in (1.5) are the reflection coefficients of the auxiliary 
terminations, which are connected in sequence to the terminated ports. JJS , JKS , 
KJS  and KKS  are partitioned matrices of the true n-port S-matrix and are defined 
as 
 
1 1 1 2 1 1 1 2 1 2
2 1 2 2 2 1 2 2 2 2
1 1 1 2 1 1 1 2 1 2
2 1 2 2 2 1 2 2 2 2
2 1 2 2 2 1 2 2
|
|
|
|
| |
|
|
n
n
n
n
n n n n n
j j j j j k j k j k
j j j j j k j k j k
JJ JK
k j k j k k k k k k
KJ KK k j k j k k k k k k
k j k j k k k k k
S S S S S
S S S S S
S S
S S S S S
S S S S S S S
S S S S S




    
              
 
      
 
 
2 2nk 
 
 
 
 
 
 
 
 
 
 
 
. (1.6) 
Taking a three-port network with  1,3J   as measured ports and the 
other port  2K   terminated in 2  as an example, one can write the measured 
two-port S-matrix according to (1.4)-(1.6) as 
 
13 13
11 1213
13 13
21 22
m m
m
m m
S S
S
S S
 
 
 
 
    
11 13 12 1
1
22 21 232
31 33 32
S S S
S S S
S S S

         
   
. (1.7) 
It is observable that four elements of the true three-port S-matrix can be obtained 
as the first matrix on the right side of (1.7) if 2 0  . Otherwise, the imperfectly 
matched load 2  causes mismatch-induced errors and makes the measured 
  
5 
 
As illustrated in Fig. 1.2, the SIW [22], also known as laminated 
waveguide [23] and post-wall waveguide [24], emulates a rectangular waveguide 
by replacing the two metallic sidewalls with two rows of via-holes. It can 
therefore be fabricated on the printed circuit board (PCB) or the low-temperature 
co-fired ceramic (LTCC) for low-cost, mass-producible and highly integrated 
microwave and mm-wave systems.  
Being an artificial periodic waveguide, its radiation loss of TEn0 is studied 
to be negligible by following the design rule related to the via diameter D and 
pitch b [25] 
 5
2
g
D
b D



 
, (1.2) 
where g  is the guided wavelength. On the contrary, the TEnm and TM are not 
the guided modes of the SIW. This important feature can be explained by the 
well-established design principle of waveguide slot antenna [26]. A slotted 
waveguide radiates if its surface current is interrupted by a slot vertical to a 
current line [27]. As can be seen in Fig. 1.3, the TE10 surface currents in the 
sidewalls of a rectangular waveguide flow vertically. Therefore, the leaks of the 
SIW cause only a minor perturbation in the current distribution of TE10 and 
negligible radiation. Due to the similarity of surface currents on the sidewalls, all 
TEn0 are actually the guided modes of the SIW. However, the nonzero transverse 
magnetic filed of the TEnm and TM produce longitudinal currents on the sidewalls 
which are completely interrupted by the leaks of the SIW. Accordingly, the TEnm 
and TM radiate rather than propagate along the SIW. 
  
7 
 
VNA [31]-[33]. 
It then covers a complete design flow and the measurement procedures for 
a mm-wave 4 x 4 SIW Butler matrix. In particular, the measurement procedures 
can characterize multiport devices up to their intrinsic ports, and therefore help 
one design high performance mm-wave modules by following a bottom-up 
approach. In the bottom-up approach, the basic components of the system are 
designed, verified by measurements and then improved accordingly. 
First of all, theory of the short-slot coupler is reviewed with the aid of the 
HFSS
®
. Explicit design formulas for 0 dB and 3 dB short-slot couplers are 
arranged to estimate the structure dimensions for the HFSS
®
 simulation to begin 
with. According to the simulation results, 30 GHz SIW 0 dB and 3 dB short-slot 
couplers are fabricated on Rogers RO4003
®
 substrate with 8 mil thickness and 
verified using two ground-signal-ground (GSG) probes and a two-port VNA [34], 
[35].  
A mm-wave 4 x 4 SIW Butler matrix is then designed and measured 
accordingly [36]. The reconstructed S-matrix not only verifies the characteristics 
directly, but also facilitates efficient system design flow by simulations with the 
  
9 
 
In Chapter 5, a measurement procedure is developed to acquire the 
eight-port S-matrix of the 4 x 4 SIW Butler matrix by exploiting the concept of 
virtual auxiliary termination. The eight-port S-matrix of the Butler matrix not 
only verifies its characteristics directly, but also is advantageous for the designs 
of its follow-on applications. 
Chapter 6 concludes this report with summaries and remarks on future 
work. 
  
11 
 
 
 
 
 
 
Fig. 1.2 Topology of a substrate integrated waveguide. 
 
  
13 
 
 
 
Microstrip
Waveguide
0 0.2 0.4 0.6 0.8 1 1.2 1.4
0
50
100
150
0
200
400
h - (mm)
Q
  
w
av
eg
u
id
e
Q
  
m
ic
ro
st
ri
p
 
 
Fig. 1.4 Quality factors of microstrip line and SIW for different dielectric 
thickness. 
 
  
15 
 
 
 
 
 
 
 
Fig. 1.6 Transition from the SIW to CPW. 
  
17 
 
coefficients is in common. In addition, we observe that most of the methods prefer 
auxiliary terminations with small or moderate reflection coefficients. It is believed 
that they can alleviate possible numerical difficulties by those auxiliary 
terminations. Thus, there are two issues worth our attention. Firstly, depending on 
the types of the ports of DUT, measuring the reflection coefficient of auxiliary 
termination may be easy or tedious. For instance, it could be beneficial for not 
directly probing auxiliary terminations like surface mount devices. Secondly, to be 
described in Section 3.4, in contrast to the processes of soldering surface mount 
resistors for PCB and fabricating poly resistors for MMIC which suffer from large 
variation, the process of implementing strongly reflecting termination like a 
short-circuited or an open-circuited transmission line is repeatable and reliable for 
both applications. The applicability of existing methods is then limited as they do 
not function normally with the use of auxiliary terminations having large reflection 
coefficients. Only recently have these two issues been tackled in [16]. It proposes a 
method to acquire the S-matrix of a multistage line coupler using two-port VNA 
and short-circuited reflective terminations with 0.6 0.8   , in which all but one 
are unknown. 
Inspired by an attempt to deal with the first issue mentioned above, we 
propose an indirect measurement technique to circumvent those direct 
measurements of auxiliary terminations. It is learned later that the synergy of this 
technique and the method in [7] allows one to dispense with the use of auxiliary 
terminations. In other words, the DUT can have its unused ports left unconnected 
even though it may give large reflection coefficients. Since the unused ports have 
  
19 
 
12mS . One then terminates the second port in 2  and measures port 1 to get the 
one-port S-parameter 1mS . By performing signal flow graph analysis, 2  can be 
calculated from the elements of 12mS  and 1mS  as 
 
12 12
12 112 21
2 22 1 12
11
( )
m m
m
m m
S S
S
S S
  

. (2.1) 
Therefore, through proper permutations, all i  can be acquired without directly 
measuring them. 
2.2.2 Virtual Auxiliary Termination 
According to [7], the S-matrix of an n-port network can be reconstructed 
using 2
nC combinations of two-port measurements with the other n-2 unused ports 
terminated in fully characterized auxiliary terminations. It is given by 
 1 1recS     . (2.2) 
In (2.2), 
 
1
2
1
0 0 0
0 0 0
0 0 0
0
0 0 0
n
n

 
 
 
  
 
 
  
 (2.3) 
is an nxn diagonal matrix, whose diagonal elements are the reflection coefficients 
of the auxiliary terminations in which ports are invariably terminated while not 
being connected to VNA. The elements of   to be expressed in Section 2.3 are 
related to the reflection coefficients of the auxiliary terminations and the measured 
  
21 
 
coefficient of the virtual auxiliary terminations is acquired by connecting one port 
to VNA while leaving the other two ports unconnected.  (2.1) and (2.2) are then 
carried out to reconstruct the three-port S-matrix of the DUT. 
Figs. 2.2 and 2.3 show the experiment results. For verifying the results, a 
benchmark is obtained by following the mathematical definition of S-parameter [6] 
and performing three sets of two-port measurements with the other unused port 
terminated in the load of calibration kits. Since the DUT is a reciprocal network, 
only the elements on or above the diagonal are depicted. The experiment results 
show the agreement with those of benchmark. 
2.3  Accuracy Analysis 
Since both calculations of   and (2.2) involve matrix inversion, it could 
be numerically difficult under certain circumstances [8], [9], [37]-[39]. Judging by 
[39], one can tell the accuracy of the method in [7] from the 2-norm condition 
number of  . A matrix with a large condition number is known as ill-conditioned, 
one whose solution to inverse matrix is overly sensitive to perturbations in its 
elements. In our case, numerical perturbations mostly originate from the 
measurement errors and the finite precision of computer. 
Before the discussion of the condition number of  , the calculation of   
itself is given in the following. For a two-port measurement with the measured 
ports  1 2,J j j  and the terminated ports  1 2 2, , , nK k k k  , the   in (2.3) 
  
23 
 
As 1 , 2  and 3  are of no significance for the following discussion, their 
explicit expressions are not shown. By making a comparison between (2.6) and 
(2.8), the identity between JJ  and JJ  concludes that JJ  is a partitioned 
matrix of  . Consequently, one can piece together   from 2
nC  combinations of 
JJ , which can be evaluated from the measured two-port S-matrices and the 
reflection coefficients of auxiliary terminations by using (2.5). 
Through trying to expand (2.6), one finds that the elements of   are 
nonlinear complex functions of S-parameters of the n-port network and reflection 
coefficients of the auxiliary terminations. It is difficult, if not impossible, to figure 
out what   tends to make   ill-conditioned by interpreting and deciphering the 
equations. By contrast, it is practicable to perform quantitative analyses by 
conducting computer simulation of measurement. 
Designating a Narda
®
 COF-2040 four-port circulator which operates 
between 2 GHz and 4 GHz as the experimental sample, we illustrate its port 
enumeration in Fig. 2.4 and prepare its S-matrices at different frequencies for the 
ensuing simulations by following the mathematical definition of S-parameter [6] 
and performing six combinations of two-port measurements with unused ports 
terminated in the loads of an Agilent
®
 85052D calibration kit. 
The first computer simulation is to study how different reflection 
coefficients of auxiliary terminations affect the condition numbers of  . Although 
auxiliary terminations are permitted to be all identical, partially distinct or all 
distinct, the case of being all identical is of interest and is simulated. Defining the 
  
25 
 
 3
0.23 84 0.56 121 0.31 30 0.65 167
0.85 20 0.23 105 0.16 102 0.34 34
0.35 30 0.66 143 0.22 118 0.54 123
0.15 77 0.30 35 0.87 24 0.22 83
o o o o
o o o o
o o o o
o o o o
S
  
 
 
  
 
 
. (2.12) 
The two-port measurements are then simulated by partitioning the sampled 
S-matrices properly and substituting these partitioned matrices and the specified 
reflection coefficients of auxiliary terminations into (1.4). After six combinations of 
JJ  are evaluated from (2.5),   is acquired and its 2-norm condition numbers for 
various reflection coefficients of auxiliary terminations over the Smith chart are 
depicted for the sampled S-matrices in Figs. 2.6, 2.7 and 2.8. 
The condition number distribution pattern of the type one sample shows 
only one peak, whereas those of type two and type three have four relatively higher 
peaks. After running more simulations at other frequencies for each type of 
S-matrix, we observe that the resulting patterns are similar to those given in Figs. 
2.6, 2.7 and 2.8. Moreover, even though peaks of the patterns change positions for 
different cases, they never move inward on the Smith chart. 
Three implications can then be drawn from the results of the first 
experimental simulation. Firstly, the method in [7] prefers auxiliary terminations 
with small reflection coefficients. Secondly, when auxiliary terminations with large 
reflection coefficients are taken, it may encounter numerical difficulty whose 
destructiveness depends inversely on the power dissipation of the DUT. Thirdly, 
since the reflection coefficient of virtual auxiliary termination is close to that of an 
open circuit, which is at the furthest right point in the Smith chart in Fig. 2.7(b), the 
  
27 
 
port is measured n-1 times with different ports terminated in auxiliary terminations. 
For example, 1211
mS , 1311
mS  and 1411
mS  are the three reflection terms measured from 
the first port of a four-port DUT. The repetitions of reflection terms sum up to 
2
24
nC n  redundant equations in (2.13). By keeping only one of the reflection 
terms of each port and dropping the others, the number of equations is then 
identical to that of the unknowns which herein are the elements of S . 
The reduced version of (2.13) is arranged as 
 
 
 
 2
12
1 11 12 1 2 11
12
2 11 12 1 2 12
( 1)
11 12 1 2 22
, , , , , , , , 0
, , , , , , , , 0
                            
, , , , , , , , 0
m
nn n
m
nn n
m n n
nn nn
g S S S S
g S S S S
g S S S S 
   
   
   
. (2.14) 
These equations are rational functions concerning each element of the true S-matrix, 
therefore they are analytic over the complex plane except for those points making 
the denominator equal to zero [41]. The existence of the partial derivatives hints 
that Newton’s method is a candidate for solving (2.14). By using the vector notation 
and defining 
 11 12[ ]tnnX S S S , (2.15) 
 21 2[ ]tnG g g g  (2.16) 
and 
 
2 2 2
1 1 1
11 12
2 2 2
11 12
11 12
nn
nn
n n n
nn
g g g
S S S
g g g
J S S S
g g g
S S S
   
   
 
   
    
 
 
   
 
   
, (2.17) 
  
29 
 
where v and w are the indexes, and u is an odd number. In analogy to the design of 
a low pass filter, u is chosen to be reasonably large to make the curve of 
S-parameter smooth and not to distort those segments occupying the valleys of 
condition numbers in Fig. 2.9, which are reliably reconstructed using (2.2). 
2.5  Experiment 
The following experiment is conducted to demonstrate the applicability of 
virtual auxiliary termination. The DUT is a Narda
®
 COF-2040 four-port circulator 
which is the experimental sample in Section 2.3. It has four SMA female 
connectors. In the experiment, its four-port S-matrix is going to be reconstructed 
from measuring two-port S-matrices while leaving the other two ports unconnected 
as the virtual auxiliary terminations. The reason for using a four-port circulator in 
this experiment is that it is a nonreciprocal device with S-parameters having a large 
dynamic range to verify the applicability of our approach. 
One needs to measure six combinations of two-port S-matrices, namely 
12mS , 13mS , 14mS , 23mS , 24mS  and 34mS , to get  . Additionally, the one-port 
S-parameters for characterizing the unknown reflection coefficients of virtual 
auxiliary terminations are acquired by connecting one port to VNA while leaving 
the other three ports unconnected. The unknown reflection coefficients of the 
virtual auxiliary terminations at the other three ports are then derived based on the 
procedures of developing (2.1). For example, if the one-port S-parameter of the first 
port is measured and denoted as 1mS , the reflection coefficients of the virtual 
  
31 
 
role in lowering numerical error. Special attention should be paid in the 
arrangements of calibration and measurement [44]-[46]. 
2.6  Results 
As expected, the reflection coefficient of the virtual auxiliary termination is 
identified as being close to unity after comprehensively surveying the twelve 
possible values. Typical results of the virtual auxiliary termination are shown in Fig. 
2.10. 
Fig. 2.11 shows the condition numbers of the DUT when terminating in 
virtual auxiliary terminations. The similarity between the pattern of Fig. 2.11 and 
that of Fig. 2.9 validates the conclusion from the computer simulation in Section 
2.3. 
The port enumeration of the DUT illustrated in Fig. 2.4 suggests that 
elements of each column of the S-matrix can be categorized into four operation 
coefficients as reflection, forward transmission, isolation and backward leakage. 
Although the operation coefficients of one port are not identical to those of another 
port, they do behave in similar way. For the sake of brevity, only the operation 
coefficients of the first port are presented in Figs. 2.12-2.15. 
Figs. 2.12-2.15 show the benchmark, the first step result based on (2.2) and 
the final result. The benchmark for verifying the results is the four-port S-matrix 
prepared for the computer simulation in Section 2.3. They are obtained from 
  
33 
 
measurement with the use of a two-port VNA and leaving the rest of the ports of the 
DUT unconnected. The 2-norm condition number of   is studied as an indicator 
for one to tell the accuracy of the result evaluated from (2.2). If the calculation of 
(2.2) suffers from numerical difficulty at certain frequencies, it is complemented by 
a remedy which uses both Newton’s method given in (2.18) to solve those points 
iteratively and the simple moving average given in (2.20) to remove the remaining 
glitches in the curve of the S-parameter. 
The formulation and approach presented in this chapter can acquire the 
S-matrix of an n-port network with the use of a two-port VNA and virtual auxiliary 
terminations. By reviewing the DUTs on which we have experimented, we then 
give the following observation on a three-level difficulty in implementing virtual 
auxiliary terminations. As shown in Figs. 2.1-2.3 and 2.16, the three-port S-matrix 
of a Mini-Circuits
®
 D17I 17 dB directional coupler can almost be reconstructed by 
(2.2) due to having peak values of the condition numbers lower than 40 over the 
operational bandwidth. As shown in Figs. 2.17-2.21, using (2.2) and (2.18) is 
capable of reconstructing the three-port S-matrix of a DiTom
®
 three-port circulator 
D3C2040. The peak values of the condition numbers of this device are below 90 
from 1 to 5 GHz. For the four-port circulator Narda
®
 COF-2040 given in Section 
2.5 as shown in Figs. 2.4 and 2.11-2.15, the moving average operation defined in 
(2.20) is further applied to remove the remaining glitches after performing (2.2) and 
(2.18). In other words, moving average is a complementary approach to (2.2) and 
(2.18) for better reconstructing the S-matrix of a DUT with the highest level of 
difficulty, which is observed as a four-port device with the peak values of the 
  
35 
 
 
 
 
Fig. 2.1  Picture of the three-port DUT. 
  
37 
 
0 1 2 3 4 5
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
0 1 2 3 4 5
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
E x p e r i m e n t
B e n c h m a r k
 
(a) 
0 1 2 3 4 5
-50
-40
-30
-20
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
0 1 2 3 4 5
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
E x p e r i m e n t
B e n c h m a r k
 
(b) 
0 1 2 3 4 5
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
0 1 2 3 4 5
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
E x p e r i m e n t
B e n c h m a r k
 
(c) 
Fig. 2.3  Measured results of (a) S22, (b) S23 and (c) S33 in magnitude and phase. 
  
39 
 
 
 
 
 
 
1 2 3 4 5
0
1
2
3
4
F r e q u e n c y  [ G H z ]
P
d
 ,a
 v
 g
  [
 d
 B
 ]
 
 
 
 
 
 
Fig. 2.5 Average power dissipation of the circulator. 
 
  
41 
 
 
(a) 
 
 
 
 
 
cond2(Σ) 
–––– 16 
– – – 8 
········ 4 
·−·−· 2 
 
(b) 
Fig. 2.7  Condition number distribution patterns in (a) 3-D plot and (b) contour 
plot of the circulator at 2.95 GHz. 
  
43 
 
 
 
 
 
1 2 3 4 5
0
10
20
30
40
50
60
70
80
F r e q u e n c y  [ G H z ]
c 
o 
n 
d 
2
 (
 
 )
 
 
 
Fig. 2.9 Computer-simulated condition numbers of the circulator with the 
reflection coefficients of auxiliary terminations to be unity. 
  
45 
 
 
 
 
 
1 2 3 4 5
0  
5
20 
40 
60 
80 
100
120
140
160
F r e q u e n c y  [ G H z ]
c 
o 
n 
d 
2
 (
 
 )
 
 
 
 
Fig. 2.11 Condition number of the four-port circulator terminated in virtual 
auxiliary terminations. 
  
47 
 
1 2 3 4 5
-20
-15
-10
-5
0
5
10
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(a) 
1 2 3 4 5
-200
-150
-100
-50
0
50
100
150
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(b) 
 
Fig. 2.13 Forward transmission coefficient S21 in (a) magnitude and (b) phase. 
  
49 
 
1 2 3 4 5
-80
-70
-60
-50
-40
-30
-20
-10
F r e q u n e c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(a) 
1 2 3 4 5
-200
-150
-100
-50
0
50
100
150
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(b) 
 
Fig. 2.15 Backward leakage coefficient S41 in (a) magnitude and (b) phase. 
 
  
51 
 
 
 
 
 
 
 
 
 
 
Fig. 2.17 Port enumeration of a DiTom
®
 D3C2040 three-port circulator. 
 
 
 
  
53 
 
1 1.5 2 2.5 3 3.5 4 4.5 5
-70
-60
-50
-40
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(a) 
1 1.5 2 2.5 3 3.5 4 4.5 5
-200
-150
-100
-50
0
50
100
150
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l s t e p
 
(b) 
 
Fig. 2.19 Reflection coefficient S11 in (a) magnitude and (b) phase. 
  
55 
 
1 1.5 2 2.5 3 3.5 4 4.5 5
-50
-45
-40
-35
-30
-25
-20
-15
-10
-5
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(a) 
1 1.5 2 2.5 3 3.5 4 4.5 5
-200
-150
-100
-50
0
50
100
150
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
b e n c h m a r k
f i r s t  s t e p
f i n a l  s t e p
 
(b) 
 
Fig. 2.21 Backward leakage coefficient S31 in (a) magnitude and (b) phase. 
  
57 
 
several kinds of transmission lines have been employed to design the Butler matrix, 
many successful applications exemplify the potential for an mm-wave Butler matrix 
using SIW [48]-[50]. 
In this chapter, a 4 x 4 Butler matrix operating around 30 GHz is designed 
using SIW and fabricated on Rogers RO4003
®
 substrate with 8 mil thickness. 
3.2  Basic Components 
Fig. 3.1 illustrates the block diagram of a 4 x 4 Butler matrix. It is an 
eight-port network comprising components of 90
o
 hybrid, crossover, 45
o
 and 0
o
 
phase shifters. Depending on the type of the adopted transmission line and the 
number of the substrate layers, these components can be designed in numerous 
different architectures with specific advantages and disadvantages. Specifically 
speaking, a key issue for single-layer structure is how to design the crossovers 
efficiently and the accompanied phase shifters precisely. As a result, the directional 
coupler architecture capable of achieving both 3 dB and 0 dB coupling is preferred 
by considering the 0 dB coupler as a crossover. 
The short-slot coupler juxtaposes two rectangular waveguides and 
eliminates the common narrow wall to form a coupling region with the width large 
enough for the propagation of TE20 mode [51]. By controlling the physical size of 
the coupling region to generate a proper interference pattern of TE10 and TE20 
modes, one can theoretically achieve arbitrary power ratio of the transmitted signal 
to the coupled signal. 
  
59 
 
 
 
 
10 20
10 20
1 1 1
1
2 2 2
1
3 3 3
4 4 4
0
2
2
0
e o
j j
e o
j j
e o
e o
b b b
a
b b b e e
a
b b b e e
b b b
 
 
  
 
  
 
  
  
  

    


    

   
. (3.2) 
In (3.2), ℓ is the length of the coupling region, while 10  and 20  are the phase 
constants of TE10 and TE20 modes respectively. Besides, the reflections of both 
even- and odd-mode are neglected in (3.2) to simplify the problem and are taken 
into account later when developing the condition of reflection cancellation [50]. 
According to (3.2) and the definition of S-parameter [6], one then has 
 
 
 
 
 
10 20
10 20
1 1
2
2 1 10 20
2
3 1 10 20
4 1
0
cos
2
sin
2
0
j
j
S
S e
S j e
S
 
 
 
 
 
 
 
 
 
 


      

       


. (3.3) 
Being fully symmetric, the short-slot coupler can be completely characterized by 
(3.3). In consequence, a set of rudimentary design formulas is derived as 
 
  110 20 3 1
2
2
10
2
2
20
sin
2
2
S
k
w
k
w
 





 

  


  
   
 

       
,  (3.4) 
where k is the wavenumber and w is the width of the coupling region. 
In applying (3.4) for different magnitudes of coupling coefficient, the 
  
61 
 
 1021 0
j
e
  .  (3.6) 
In other words, without using capacitive post [52] which is unrealizable in 
single-layer structure, the magnitudes of S1'1' and S4'1' in Fig. 3.2 (a) can be 
minimized as the length of the coupling region becomes [50] 
 
 
10
2 1
2
n 


   (3.7) 
to satisfy the condition of reflection cancellation, where n is a non-negative integer. 
With the length of the coupling region constrained by (3.7), (3.4) is solved 
to give a set of final design formulas as 
 
   
 
 
1 1
3 1 3 1
1 1
3 1 3 1
2
2
2 1 4sin 3 2 1 4sin
8sin 2 1 sin
2 1
2
n S n S
w
k S n S
n
k
w
 



 
   
 
   
           
    
 

  
  
 
, (3.8) 
by which the HFSS
®
 simulation can be initiated. In the following design, the 
substrate parameters are substrate thickness h=8 mil, metal thickness t =0.67 mil, 
metal conductivity 75.8 10   S/m, relative permittivity 3.45r   and loss 
tangent tan 0.0036  . Note that the unit of length in this chapter is mil, and may 
be dropped hereafter for brevity. 
3.2.1  3 dB Short-slot Coupler 
By assigning 3 1 1 2S    , (3.8) can be further simplified as 
  
63 
 
compromised value of w'=170. 
Based on these dimensions, an HFSS
®
 model of a 90
o
 hybrid is set up using 
SIW with via diameter of 10 and via pitch of 20. By inferring from (3.4) and the 
preceding simulation result, the model is then tuned iteratively to attain the design 
goals at 30 GHz, which are 21 310.5 dB 0.5 dBS S    , 11 30 dBS    and 
41 30 dBS   . In regard to the finalized design, Figs. 3.2 (a), 3.5 (a) and (b) show 
the distribution of the magnitude of the electric field, the resultant dimensions and 
the simulated S-parameters. Represented by capital letters for being distinguishable 
from the ones evaluated by the design formulas, the resultant dimensions are 
W=280, L=208 and W'=178. The simulated S-parameters at 30 GHz, expressed in 
dB and degree values, are 11 44 159
oS   , 21 3.5 72
oS    , 
31 3.2 162
oS    and 41 49 142
oS    . 
3.2.2 0 dB Short-slot Coupler and Phase Shifters 
As the term of   10 20 2   in (3.3) equals 2 , a short-slot coupler 
becomes a 0 dB coupler having 2 1 0S     and 3 1 1S    . Effectively, a 0 dB 
coupler can play the role of the crossover as given in Fig. 3.1. A special case of (9) 
for 0 dB coupler is 
  
65 
 
4n   is close to the onset of TE30 mode whose effect is not taken into account in 
the design formulas. Secondly, with the considerations of propagation attenuation 
and the onset of higher order modes, the 0w  and 45w  are either too wide or too 
narrow to be implemented. 
In seeking for a practicable solution to the phase shifters, the required 
lengths for rectangular waveguides with widths equal to that of the input waveguide 
W'=178 to achieve the phase shifts given by (3.14) with m=0 is calculated. The 
required lengths denoted as 0  and 45  are normalized to the length of the 
coupling region  and then tabulated in Table 3.3. As shown in Table 3.2, the 
ratios of 0  and 45  to  are slightly larger than 1, which implies that the 
excess length can be implemented by curving the waveguides without much 
difficulty. 
Since the fabrication process limits the via diameter and via pitch to 10 and 
20, the design of the curved SIW is virtually restricted to the use of 20-mil long 
straight sections. Though the ratios and therefore the curvatures of the curved 
waveguides are about the same for n=1-3, a longer one is expected to not only relax 
the restriction on via dimensions but also have smoother changes and better 
performance. Consequently, n=3 is adopted. 
The HFSS
®
 is then utilized intensively by following the same design 
sequence of the 90
o
 SIW hybrid to optimize the design. Fig. 3.6 shows the resultant 
dimensions and the simulated S-parameters of the 0 dB SIW coupler. The 
dimensions are W=280 and L=424. The magnitudes of simulated S-parameters at 
  
67 
 
center-to-center spacing between output ports are adjusted to 198 which is half the 
vacuum wavelength of 30 GHz. The complete layout is illustrated in Fig. 3.9. 
3.4  Summary 
With the aid of the HFSS
®
 to visualize the field distributions, theory of the 
short-slot coupler is reviewed.  Explicit design formulas for the 3 dB and 0 dB 
short-slot couplers are derived accordingly. Based on the dimensions evaluated by 
these formulas, HFSS
®
 models are set up using SIW with via diameter of 10 and 
via pitch of 20 and then tuned iteratively to attain the design goal. The simulation 
results validate the design formulas as helpful estimates. In addition, it is proven 
analytically that the 0
o
 and 45
o
 phase shifters can be conveniently implemented 
with curved waveguides to gain excess lengths. 
A 4 x 4 mm-wave SIW Butler matrix is then fabricated on Rogers RO4003
®
 
substrate with 8 mil thickness.
  
69 
 
 
(a) 
 
(b) 
 
(c) 
Fig. 3.2 Electric field distributions of a short-slot coupler with (a) port 1, (b) 
even-mode and (c) odd-mode excitations.
  
71 
 
 
 
90 106 120 134 160 180 212
0.8
1
1.2
1.4
1.6
1.8
2
2.2
2.4
2.6
2.8
x 10
-3
T E 
1
 
0
T E 
2
 
0w / 2
W i d t h  [ m i l ]
A
 t 
t e
 n
 u
 a
 t 
i o
 n
  [
 d
 B
 / 
m
 i 
l ]
 
 
Fig. 3.4 Attenuation of TE10 mode in a rectangular waveguide. 
  
73 
 
 
 
(a) 
 
 
(b)  
 
 
(c) 
 
Table 3.1 (a) Widths and lengths of the coupling region and widths of (b) 0
o
 and (c) 
45
o
 phase shifters (dimension unit in mil). 
 
  
75 
 
 
 
(a) 
20 25 30 35 40
-35
-30
-25
-20
-15
-10
-5
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
1
 
1
S 
2
 
1
S 
3
 
1
S 
4
 
1
 
(b) 
Fig. 3.6 (a) Dimensions and (b) simulated results of the 0 dB SIW coupler. 
 
  
77 
 
 
 
(a) 
 
 
(b) 
 
Fig. 3.8 Field distribution of the 4 x 4 SIW Butler matrix with (a) port 1 and (b) 
port 2 excitations. 
 
  
79 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 3.9 Layout of the 4 x 4 SIW Butler matrix. 
  
81 
 
The DUT is the SIW short-slot hybrid designed in Chapter 3 but with 
waveguide-to-microstrip transitions. As illustrated in Fig. 4.1, it is embedded in two 
probe pads and two auxiliary terminations for one to perform on-board 
measurement using two ground-signal-ground (GSG) probes and a two-port VNA. 
By taking advantage of the method [35], [54] and the TRL calibration technique [4], 
the four-port S-matrix of the DUT is reconstructed and presented in Section 4.4. 
Discussion of the method is given in Section 4.4. 
4.2  Formulation 
Following the port enumeration shown Fig. 4.1, we divide the set of number 
of ports  1,2,3,4  into two disjoint subsets, which are  1,2J   for the two 
measured ports with probe pads and  3,4K   for the two terminated ports. The 
measured two-port S-matrix is given by [7] 
  
-1
1 -mJ JJ JK KK KJKKS S S S S
   .  (4.1) 
In (4.1), 
 
3
4
0
0
KK
 
    
,  (4.2) 
The diagonal elements in (4.2) are the reflection coefficients of the auxiliary 
terminations, which are connected to the terminated ports. JJS , JKS , KJS  and 
KKS  are partitioned matrices of the true four-port S-matrix S  and are defined as 
  
83 
 
 
0
0
KK
 
    
 (4.9) 
which is required to be different from KK  as shown in Fig. 4.1(b), one more 
two-port S-matrix is measured and denoted as 
    
-12 2 1 -
mJ
JJ JJJK KKS S S S
   . (4.10) 
After some algebraic operations on (4.8) and (4.10), they are rewritten as 
     1 11 2 2 1mJ mJJJ KK JJ JK KKS S S S S         (4.11) 
and 
     2 21 2 2 1mJ mJJJ KK JJ JK KKS S S S S        . (4.12) 
Subtracting (4.11) from (4.12), one has 
          
1
1 2 1 21 1 1 1mJ mJ mJ mJ
JJ KK KK KK KKS S S S S

              . (4.13) 
After (4.13) expresses JJS  in terms of measurable quantities, (4.8) is rearranged as 
 
   12 1 -mJ JJ JJJK KKS S S S   , (4.14) 
which then yields four possible solutions to JKS . That is 
  
 
 
 
 
1 1 2 2
1 1 2 2
31 41
2 2 1 1
2 2 1 1
180
180
180
180
o
o
o
o
A A
A A
S S
A A
A A
   
   
 
   

    
, (4.15) 
where 1A  and 2A  are two possible magnitudes, and 1 , 1180
o  , 2  and 
2180
o   are four possible phases. In general, one usually has a priori knowledge 
about the characteristics of DUT within the operation bandwidth. Therefore, extra 
  
85 
 
MMIC due to the following two features. Firstly, it functions normally with the use 
of strongly reflecting auxiliary terminations [16]. In contrast with the processes of 
soldering surface mount resistors for PCB and fabricating poly resistors for MMIC 
which suffer from large variation, the process of implementing strongly reflecting 
termination like short-circuited or open-circuited transmission line is repeatable and 
reliable for both applications. Secondly, the measurements of the abovementioned 
applications often need on-board or on-wafer probing. As shown in Figs. 4.1, a 
relatively inconvenient task of probing ports 1 and 4 on the same side of DUT is 
avoided using this method. 
In this chapter, a method for characterizing fully symmetric four-port 
devices using a two-port VNA is formulated [35], [54] and experimentally 
demonstrated by reconstructing the four-port S-matrix of a 30 GHz SIW short-slot 
hybrid with microstrip-to-waveguide transitions.  
  
87 
 
20 25 30 35 40
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
1
 
1
S 
4
 
1
 
(a) 
20 25 30 35 40
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
S 
1
 
1
S 
4
 
1
 
(b) 
Fig. 4.2 Reflection coefficient S11 and isolation coefficient S41 in (a) magnitude and 
(b) phase. 
89 
 
5.1  Introduction 
In general, the 4 x 4 SIW Butler matrix, shown in Fig. 3.9, can be mounted 
into a coaxial test fixture, thus allowing one measure the eight-port S-matrix by 
connecting to a multiport VNA. However, the use of the coaxial text fixture gives 
rise to another problem. It is difficult to extract the intrinsic characteristics of the 
Butler matrix circuit from the effect of the test fixture. In order to characterize the 
DUT up to the intrinsic ports denoted as 1-8 in Fig. 3.9, the virtual auxiliary 
5 
Chapter 
MEASUREMENT OF SIW 
BUTLER MATRIX 
  
91 
 
acquired from three more measurement samples constructed by placing one of the 
probe pads of port 2', 5' and 6' toward the opposite direction. A total of 18 
two-port S-matrices are then acquired from these four measurement samples. 
With the aid of the TRL calibration kits illustrated in Fig. 5.2, one can then move 
the reference planes from the probe pads or the extrinsic ports to the intrinsic 
ports. 
Whereas the two-port S-matrix mp qS
 
 is measured at the extrinsic ports p' 
and q' while leaving the other 6 unused ports unconnected, the TRL calibration 
technique remove the effects of the probe pads to acquire the calibrated two-port 
S-matrix mpqS . The calibrated two-port S-matrix mpqS  is equivalent to the one 
acquired by measuring at the intrinsic ports p and q while connecting the others to 
the bent probe pads. Based on the concept of virtual auxiliary termination, the 
bent probe pads can serve as probe pads for the measurements and virtual 
auxiliary terminations for the reconstruction of the eight-port S-matrix of the 
Butler matrix. 
For accurately evaluating the virtual auxiliary termination 1V , its own 
measurement sample and TRL calibrations kits are designed and illustrated on the 
right and left sides of Fig. 5.3 respectively. Consequently, the reflection 
coefficient of the virtual auxiliary termination 1V  can be expressed as 
 
10 01 1
1 11
001
( )V
m
V
e e
e
e
  
 
. (5.1) 
In (5.1), 1
m
V  is the one-port S-parameter and is measured at the straight probe 
pad of the measurement sample while leaving the other bent pad unconnected. 
  
93 
 
5.3  Results 
As shown in Fig. 5.5, although the magnitudes of 1V , 2V  and 3V  
are all large enough to have the peaks of their corresponding condition numbers 
greater than 10, their phase differences prevent the peaks from occurring at the 
same frequency. Therefore, as implied by the selection in Fig. 5.5 (b), the 
reconstructed eight-port S-matrices over the frequencies can have their 
corresponding condition number below 5 by a selection process. 
This selection process can be exemplified with the results of S51 presented 
in Fig. 5.6. Since the three curves in Fig. 5.6 (a) are individually reconstructed 
using the measurement samples of 1V , 2V  and 3V , they all have 
unreasonable results at certain frequencies in accordance with the peaks shown in 
Fig. 5.5 (b). By contrast, the selection curve in Fig. 5.6 (b), consisting of the one 
with the lowest value of the condition numbers at each frequency, has its 
corresponding condition numbers below 5 which is a comfortable value as studied 
in Chapter 2. Due to the measurement and numerical errors, the selection process 
also results in some discontinuities in the curve. The selection curve with 801 data 
points is then smoothed by a 21-point simple moving average as defined in (4.20) 
to give the final result shown in Fig. 5.6 (b). 
By the virtues of symmetry and reciprocity, the eight-port S-matrix of the 
DUT can be completely covered by 22 S-parameters. These S-parameters can be 
further categorized into three operation coefficients as reflection, isolation and 
transmission. Figs. 5.7-5.11 show the final results. 
  
95 
 
multiport measurement in microstrip or other non-coaxial media. 
The S-parameters of the Butler matrix at 29 GHz, 30 GHz and 31 GHz are 
tabulated in Table 5.1. Within an operating bandwidth of 2 GHz, the return losses 
of each port are greater than 11 dB, the insertion losses are lower than 5.5 dB and 
the port-to-port isolations are better than 14 dB. As depicted in Fig. 5.12, the 
resultant array factors show the agreement with the ideal patterns. 
The reconstructed eight-port S-matrix is shown not only to verify the 4 x 4 
SIW Butler matrix, but also to be advantageous for the follow-on design of the 
switched-beam array. 
  
97 
 
 
 
 
 
 
 
 
Fig. 5.2 TRL calibration kits. 
 
 
 
 
 
 
  
99 
 
 
 
 
 
 
 
 
 
 
Fig. 5.4 Three virtual auxiliary terminations. 
 
  
101 
 
20 25 30 35 40
-30
-20
-10
0
10
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
 
v
 
1
 
v
 
2
 
v
 
3
 
(a) 
20 25 30 35 40
-30
-20
-10
0
10
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
s e l e c t i o n
f i n a l
 
(b) 
Fig. 5.6 (a) Reconstructed results of S51 from three sets of measurement samples 
terminated with 1V , 2V  and 3V  and (b) the selection and final 
results.
  
103 
 
20 25 30 35 40
-50
-40
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
2
 
1
S 
3
 
1
S 
4
 
1
S 
3
 
2
S 
4
 
2
 
(a) 
20 25 30 35 40
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
S 
2
 
1
S 
3
 
1
S 
4
 
1
S 
3
 
2
S 
4
 
2
 
(b) 
 
Fig. 5.8 Isolation coefficients of input ports (a) magnitude and (b) phase of the 4 
x 4 SIW Butler matrix. 
  
105 
 
20 25 30 35 40
-50
-40
-30
-20
-10
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
5
 
1
S 
6
 
1
S 
7
 
1
S 
8
 
1
 
(a) 
20 25 30 35 40
-200
-150
-100
-50
0
50
100
150
200
F r e q u e n c y  [ G H z ]
R
 e
 l 
a 
t i
 v
 e
  P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
S 
6
 
1
 / S 
5
 
1
S 
7
 
1
 / S 
5
 
1
S 
8
 
1
 / S 
5
 
1
 
(b) 
Fig. 5.10 Transmission coefficients (a) magnitude and (b) relative phase of the 4 x 
4 SIW Butler matrix with port 1 excitation. 
  
107 
 
 
(a) 
 
(b) 
 
(c) 
Table 5.1 Final results of the S-matrix of the 4 x 4 SIW Butler matrix at (a) 29 
GHz, (b) 30 GHz and (c) 31 GHz. 
 
  
109 
 
 
 
 
 
(a) 
 
(b) 
Fig. 5.12 Calculated results of array factors with (a) port 1 and (b) port 2 
excitations. 
 
  
111 
 
With the aid of the HFSS
®
 of Ansoft Corporation to visualize the field 
distributions, theory of the short-slot coupler is reviewed in Chapter 3. Explicit 
design formulas for 3 dB and 0 dB short-slot couplers are arranged to estimate the 
structure dimensions for the HFSS
®
 simulations to begin with. According to the 
simulation results, a SIW 0 dB coupler, a SIW 3 dB coupler and a 30 GHz 4 x 4 
SIW Butler matrix are fabricated on Rogers RO4003
®
 substrate with 8 mil 
thickness. In order to verify their characteristics directly by the S-matrix, 
techniques relevant to multiport network measurement using two-port VNA are 
studied [7], adopted [31], [35] and developed [42]. 
For the measurement of the short-slot couplers, the method developed in [31] 
and [35] is experimentally demonstrated by reconstructing the short-slot 3 dB 
coupler. In Chapter 4, the results themselves in substance agree with the expectation 
of simulation. However, some unreasonable bumps or pits can be observed, and 
will be discussed and remedied in the Appendix A. 
By exploiting the concept of virtual auxiliary termination, a measurement 
procedure is developed in Chapter 5 to reconstruct the eight-port S-matrix of the 4 x 
4 Butler matrix using two GSG probes and a two-port VNA. This measurement 
procedure is feasible for the multiport measurement in microstrip or other 
non-coaxial media. 
For each DUT, the reconstructed S-matrix not only verifies its 
characteristics, but also is advantageous for the designs of the follow-on 
applications. 
113 
 
Since the calculation of (4.13) involves matrix inversion, the 2-norm 
condition number defined as 
 
    1 21 12 mJ mJKK KKcondX cond S S         (A.1) 
can be regarded as the indicator of accuracy [50]. A matrix with large condition 
number is known as ill-conditioned, whose solution to inverse matrix is overly 
sensitive to perturbations in its elements. In our case, numerical perturbations 
mostly originate from the measurement errors and the finite precision of 
Appendix 
A 
REMEDY FOR THE 
METHOD IN CHAPTER 4 
  
115 
 
 
 
 
 
 
 
20 25 30 35 40
1
2
3
4
5
F r e q u e n c y  [ G H z ]
c 
o 
n 
d 
X
 
 
 
 
Fig. A.1 The condX of measurement samples 1 and 2. 
  
117 
 
 
 
 
 
20 25 30 35 40
1
2
3
4
5
F r e q u e n c y  [ G H z ]
c 
o 
n 
d 
X
S a m p l e s  1  &  2
S a m p l e s  1 '  &  2 '
 
 
Fig. A.3 The condXs of measurement samples 1 and 2 in solid line and 
measurement samples 1′ and 2′ in dash line. 
  
119 
 
 
20 25 30 35 40
-25
-20
-15
-10
-5
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
2
 
1
S 
3
 
1
 
(a) 
20 25 30 35 40
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
S 
2
 
1
S 
3
 
1
 
(b) 
Fig. A.5 Transmission coefficient S21 and coupling coefficient S31 of the 3 dB 
coupler in (a) magnitude and (b) phase. 
  
121 
 
20 25 30 35 40
-30
-25
-20
-15
-10
-5
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
S 
2
 
1
S 
3
 
1
 
(a) 
 
20 25 30 35 40
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
S 
2
 
1
S 
3
 
1
 
(b) 
Fig. A.7 Transmission coefficient S21 and coupling coefficient S31 of the 0 dB 
coupler in (a) magnitude and (b) phase. 
 
  
123 
 
October 1997. 
[8] J. C. Tippet and R. A. Speciale, “A rigorous technique for measuring the 
scattering matrix of a multiport device with a 2-port network analyzer,” 
IEEE Trans. Microwave Theory & Tech., vol. 30, no. 5, pp. 661-666, May 
1982. 
[9] J. C. Rautio, “Techniques for correcting scattering parameter data of an 
imperfectly terminated multiport when measured with a tow-port network 
analyzer,” IEEE Trans. Microwave Theory & Tech., vol. 31, no. 5, pp. 
407-412, May 1983. 
[10] M. Davidovitz, “Reconstruction of the S-matrix for a 3-port using 
measurements at only two ports,” IEEE Trans. Microwave Guided Wave 
Lett., vol. 5, no. 10, pp. 349-350, Oct. 1995. 
[11] H. C. Lu and T. H. Chu, “Port reduction methods for scattering matrix 
measurement of an n-port network,” IEEE Trans. Microwave Theory & 
Tech., vol. 48, no. 6, pp. 959-968, June 2000. 
[12] D.Woods, “Multi-port-network analysis by matrix renormalization 
employing voltage-wave S-parameters with complex normalization,” 
Proc. IEEE, vol. 124, pp. 198–204, Mar. 1977. 
[13] D. F. Williams and D. K. Walker, “In-line multiport calibration 
algorithm,” in 51st ARFTG Conf. Dig., June 12, 1998, pp. 88–90. 
[14] W. Lin and C. Ruan, “Measurement and calibration of a universal six-port 
network analyzer,” IEEE Trans. Microwave Theory & Tech., vol. 37, pp. 
734–742, April 1989. 
  
125 
 
2438-2443, Dec. 1998. 
[24] J. Hirokawa and M. Ando, “Efficiency of 76-GHz post-wall 
waveguide-fed parallel-plate slot arrays,” IEEE Trans. Antennas Propagat., 
vol. 48, no. 11, pp. 1742-1745, Nov. 2000. 
[25] D. Deslandes and K. Wu, “Design Considerations and Performance 
Analysis of Substrate Integrated Waveguide Components”, Milano, 
European Microwave Conference, pp. 881-884, Sept. 2002. 
[26] F. Xu and K. Wu, “Guided-wave and leakage characteristics of substrate 
integrated waveguide,” IEEE Trans. Microwave Theory & Tech., vol. 53, 
no. 1, pp. 66-73, Jan. 2005. 
[27] R. S. Elliott, Antenna theory and design, Revised Ed., John Wiley & Sons, 
2003. 
[28] Y. Cassivi, L. Perregrini, P. Arcioni, M. Bressan, K. Wu, and G. Conciauro 
“Dispersion characteristics of substrate integrated rectangular waveguide,” 
IEEE Microwave and Wireless Components Lett., vol. 12, no. 9, pp. 
333-335, Sep. 2002. 
[29] D. Deslandes and K. Wu, “Integrated transition of coplanar to rectangular 
waveguides”, 2001 IEEE MTT-S Int. Microwave Symp., vol. 2, pp. 
619-622 May 2001. 
[30] D. Deslandes and K. Wu, “Integrated microstrip and rectangular 
waveguide in planar form”, IEEE Microwave and Wireless Components 
Lett., vol. 11, no. 2, Feb. 2001. 
[31] C. J. Chen and T. H. Chu, “Multiport scattering matrix measurement with 
  
127 
 
IEEE Trans. Microwave Theory & Tech., vol. 33, no. 3, pp. 286-287, 
March 1985. 
[39] J. R. Rice, Matrix Computations & Mathematical Software, McGraw-Hill, 
1985. 
[40] D. S. Bernstein, Matrix Mathematics: theory, facts, and formulas with 
applications to linear systems theory, Princeton University Press, 2005. 
[41] D. G. Zill and M. R. Cullen, Advanced Engineering Mathematics, 2
nd
 Ed., 
Jones and Bartlett, 2000. 
[42] S. C. Chapra and R. P. Chnale, Numerical Methods for Engineers, 4
th
 Ed., 
McGraw-Hill, 1989. 
[43] A. V. Oppenheim, R. W. Schafer, and J. R. Buck, Discrete-Time Signal 
Processing, 2
nd
 Ed., Prentice Hall, 1999. 
[44] Application Note 1287-11, “Specifying calibration standards and kits,” 
Agilent Technologies, Inc., 2006. 
[45] Application Note 1291-1B, “10 hints for making better VNA 
measurements,” Agilent Technologies, Inc., 2001. 
[46] Application Note 1363-1, “Understanding and improving dynamic 
range,” Agilent Technologies, Inc., 2000.  
[47] B. Pattan, “The versatile Butler matrix,” Microwave Journal, vol. 47, no. 
11, pp. 126-138, Nov. 2004. 
[48] J. H. Lee, S. Pinel, J. Papapolymerou, J. Laskar, and M. M. Tentzeris, 
“Low-loss LTCC cavity filters using system-on-package technology at 60 
GHz,” IEEE Trans. Microwave Theory & Tech., vol. 53, no. 12, pp. 
 1 
出席國際會議報告：瞿大雄教授 
(1) 會議名稱：2010亞太微波國際會議（2010 Asia Pacific Microwave Symposium, 
APMC 2010） 
(2) 會議時間地點：99 年 12月 7日起至 12月 10日於日本橫濱 
(3) 發表論文題目： 
(中文)多部網路 S-參數重建之實驗檢驗 
(英文)Experimental characterization of S-matrix reconstruction transforms on multiport 
networks 
(中文)串接回饋微波振盪器之最大不穩定曲線 
(英文)Maximum instability curves of a microwave series-feedback oscillator 
(4) 參加會議經過 
第 22 屆亞太微波國際會議於 99 年 12 月 7 日起至 12 月 10 日，於日本橫濱
之 Pacifico Yokohama 會議及展覽中心舉行，本人經國科會專題計畫經費補助，
得以參加，並發表論文兩篇。 
亞太微波國際會議為微波領域之三項國際會議之一，另二項微波國際會議則
為年中在美國之微波國際會議，及秋季在歐洲之歐洲微波國際會議。首屆亞太微
波國際會議係1986年於印度舉行，此次會議係第六次於日本舉行，其主題為“由
歷史港出發之新技術波”，與往年相同，主要係由亞太各國之微波相關領域之研
究人員、工程師及廠商，相聚一處，發表一年來，個人、群體乃至公司之研究開
發成果。共計有39國810篇論文(包含台灣156篇、日本144篇、及韓國93篇)投稿，
在四天會議議程中有604篇論文發表(包含66場次之328篇論文口頭報告，及5場次
之276篇論文海報報告)，此外尚有6場次工作坊及2場次短期課程，以及亞洲最大
之微波產品展示會，共有350家微波公司展示參加。涵蓋微波及毫米波積體電路、
主動及被動元件、天線、天線陣列、次系統及系統、以及設計軟體等。 
本次亞太微波國際會議，國內參加人數較往年增加，計有台大、交大、中大、
元智等多位教授同學，及工研院同仁參加，亦有國內微波廠商參展，包含微波晶
體、接頭、天線及量測服務等性質之多家。 
會議並於 12月 8日安排二場專題演講，講題分別為 University of 
Electro-Communications Prof. Kazuhiko Honjo 之“A technology perspective on 
active microwave circuits”及KDDI R&D Laboratories Dr. Shinichi Nomoto之“Further 
evolution of wireless technology toward world of ambient intelligence”，說明微波主動元
件之主 要技術，以及從學術研究關點看無線技術之演進。近兩小時之專題演講，
收穫頗多。 
會議並於各場次之專題論文中，特別安排具有代表性的16篇主題演講包括
“Innovative solutions for compact waveguide filters”、“MEMS tunable metamaterials 
surfaces and their applications”、 “Semi-active satellite antenna front-ends: a 
successful European innovation”、“Miniaturization of substrate integrated bandpass 
filters”、 “Recent advances in Doppler radar sensors for pervasive healthcare 
Maximum Instability Curves of a Microwave Series-feedback 
Oscillator 
Rong-Fa Kuo1 and Tah-Hsiung Chu2 
Graduate Institute of Communication Engineering, National Taiwan University, 
Taipei, Taiwan, 106, R.O.C. 
1
 rfkntu@ntu.edu.tw 
2
 thc@ntu.edu.tw 
Abstract  —  An analytical approach to acquire the maximum 
instability curves of a two-port microwave series-feedback 
oscillator for the design of its feedback network is presented. 
This approach is given by utilizing inequality expressions of the 
input reflection coefficients inΓ  and outΓ  of a two-port series-
feedback network defined at port 1 and port 2 with a feedback 
termination SFΓ . Then the explicit expressions are derived for 
the maximum instability curves in the SFΓ -plane to lead one to 
properly design the feedback network based on the instability 
consideration. For the selected SFΓ  value, the conditional 
instability regions of  1Γ  and 2Γ  can also be calculated for the 
design of the loads 1 and 2. The resulting instability expressions 
are implemented in the Agilent ADS software to enhance its 
computer-aided capability on the design of microwave 
oscillators. 
Index Terms — Instability, reflection coefficient, series-
feedback network. 
I. INTRODUCTION 
The stability analysis [1-4] of a two-port network as shown 
in Fig. 1(a) is an essential step of the design of microwave 
amplifiers or oscillators. One can use the inequality equations 
of stability factors or the plots of the source and load stability 
circles to find the stability regions for the source and load 
terminating networks from the given two-port S-parameters 
of the active device.  
In practice, the series-feedback configuration as shown in 
Fig.1(b) is commonly used in the design of microwave 
oscillators. It then leads to this study of the instability 
analysis of a two-port series-feedback network, especially the 
microwave oscillator, to find the optimal design of the 
feedback network from the instability considerations. 
In [5], three methods are given for the design of the 
feedback network of a microwave transistor oscillator. The 
method two among the three methods in [5] describes the 
design method based on the transistor three-port S-
parameters by taking the feedback network as the terminating 
load. For example, the transistor emitter terminal is taken as 
the series-feedback (SF) port terminated with feedback 
network SFΓ to result in a two-port series-feedback network 
as shown in Fig. 1(b) with port 1 as the transistor base 
terminal and port 2 as the transistor collector terminal. In 
order to acquire the maximum values of the reflection 
coefficients inΓ  and outΓ  of this series-feedback network 
from the instability consideration for microwave oscillator 
design, [5] describes a method to map the SFΓ -plane to the 
inΓ - and outΓ -planes to find the optimum SFΓ  value for the 
feedback network. 
The method given in [5] results with the feedback network 
to be an inductor or a capacitor. However, as the circuit 
operates in the microwave frequency range, the impedance of 
the feedback network is not a pure imaginary value but a 
complex value. For this reason, the feedback network design 
is based on the circuit instability consideration to be analyzed 
in this paper especially for the microwave oscillator design.  
Based the instability analysis of a two-port active network 
[6] as shown in Fig. 1(a), this paper describes an analytical 
approach to map the inΓ - and outΓ -planes onto the SFΓ -
plane based on the unconditional instability of the series-
feedback network as shown in Fig. 1(b). With the use of this 
approach, one can find the optimal SFΓ  value in terms of two 
maximum instability curves in SFΓ -plane to result in the 
maximum values of  inΓ  and outΓ .  
 
[ ]Sij
1Γ inΓ 2ΓoutΓ  
(a) 
[ ]Sij
inΓ 2ΓoutΓ1Γ SFΓ
 
(b) 
Fig. 1 (a) A two-port network and (b) a three-port transistor in a 
series-feedback configuration terminated with two loads 1Γ  and 2Γ , 
and a feedback network SFΓ .  
Proceedings of Asia-Pacific Microwave Conference 2010
Copyright 2010 IEICE
WE3G-27
461
instability curves 1L  and 2L  having the maximum values of 
outΓ  and inΓ  in the SFΓ -plane. By having k h=  and 
θ = φ , the intersection point P of the curves 1L  and 2L  is 
proved at SF 331/ SΓ =  in the SFΓ -plane in the following. 
By setting k h=  and θ = φ  in (13) and (14), (13) and (14) 
are expressed as 
 ( ) 21 2 3 4A cos A sin k 2A k A cosθ+ θ + + θ  
                               5A sin 0+ θ =  (15) 
 ( ) 21 2 3 4B cos B sin k 2B k B cosθ+ θ + + θ    
                               5B sin 0.+ θ =  (16) 
After multiplying (15) by 3B  and (16) by 3A  respectively, 
one then subtracts these two expressions and divides it by 
cosθ  to give 
 ( ) ( ) ( )21 3 3 1 2 3 3 2A B A B A B A B tan k 1 0.− + − θ − =⎡ ⎤⎣ ⎦ (17) 
Because k  is not a constant value, (17) equals zero implies ( ) ( )1 3 3 1 2 3 3 2A B A B A B A B tan 0− + − θ =  to give 
 
( )
( )
33
33
Im S
tan tan .
Re S
θ = φ = −  (18) 
Furthermore, one can prove the following identity using the 
expressions given in Appendix A 
 
( )
( )
331 3 3 1 3 4 4 3
2 3 3 2 3 5 5 3 33
Im SA B A B A B A B .
A B A B A B A B Re S
− −= =− −  (19) 
The expressions of 1 3 3 1A B A B−  and 2 3 3 2A B A B−  are given 
as 
( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
2 2* *
33 22 11 33 11 33 22 11 11
2 2* * *
22 11 11 22 33 33 11 22 33 22
2 2* * *
11 22 22 11 33 33 11 22 22
Im S [ Re S Im S Re S Im S
Re S Im S S ] Im S [ Re S Im S
Re S Im S S Re S Im S ]
− Δ Δ + Δ Δ
+ Δ Δ − − Δ Δ
+ Δ Δ + Δ Δ
                                                                                       (20) 
( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) ( )
2 2* *
33 22 11 33 11 33 22 11 11
2 2* * *
22 11 11 22 33 33 11 22 33 22
2 2* * *
11 22 22 11 33 33 11 22 22
Re S [ Re S Im S Re S Im S
Re S Im S S ] Re S [ Re S Im S
Re S Im S S Re S Im S ].
− Δ Δ + Δ Δ
+ Δ Δ − − Δ Δ
+ Δ Δ + Δ Δ
                                                                                       (21) 
(18) means ( )33 33cos Re S / Sθ =  and ( )33 33sin Im S / Sθ=− . 
One then uses these two expressions and the expressions of 
1A , 2A , 4A , and 5A  to acquire the following two terms in 
(13) as 
 1 2 33 3A cos A sin S Aθ+ θ = −  (22) 
 4 5 3 33A cos A sin A / S .θ+ θ = −  (23) 
Therefore, by substituting (22) and (23) into (18), one can 
prove that the intersection point P of 1L  and 2L  in the SFΓ -
plane is at SF 331/ SΓ =  because of 33k 1/ S= . 
In practice as one designs a series-feedback microwave 
oscillator, the following design steps based on the instability 
analysis of given above are suggested. 
(1) Terminating port 1 and port 2 with matched loads gives 
the two-port network to be mostly conditionally instable. 
(2) Plot the maximum instability curves 1L  and 2L  using (13) 
and (14). The intersection of 1L  and 2L  gives the SFΓ  
value having the maximum values of outΓ  and inΓ . 
(3) Select SFΓ  value based on the considerations of the 
maximum stability curves. 
(4) Design the feedback network based on the selected SFΓ  
value. 
If the intersection point of 1L  and 2L  is outside of the 
unitary Smith chart, one should select the proper SFΓ  value 
based on the practical consideration. The SFΓ  value on the 
circumference of the unitary Smith chart closes to the curves 
1L  and 2L  can give large values of outΓ  and inΓ  for 
oscillation consideration. However, the pure inductor or 
capacitor is not available in the microwave frequency range. 
Therefore the curves 1L  and 2L  inside the unitary Smith 
chart can lead the designer the most favorable choice for the 
feedback network to have large values of outΓ  and inΓ .  
III. EXAMPLE 
To illustrate the analytical approach for the instability 
studies of the two-port series-feedback network developed in 
Sec. II, the example [5]  
11 12 13
21 22 23
31 32 33
S S S 0.413 78.5 0.33 61.67 1.031 42.42
S S S 0.919 61.71 0.904 37.98 1.374 96.2
S S S 0.629 39.99 0.296 63.87 0.774 59.97
∠ ° ∠ ° ∠− °⎡ ⎤ ⎡ ⎤⎢ ⎥ ⎢ ⎥= ∠− ° ∠− ° ∠ °⎢ ⎥ ⎢ ⎥⎢ ⎥ ⎢ ⎥∠ ° ∠ ° ∠− °⎣ ⎦ ⎣ ⎦
   
(24)                     
is adopted here for comparison. In this numerical study, all 
the expressions developed in Sec. II are implemented with 
the use of Agilent ADS to enhance its computer aided 
capability for the design of a microwave series-feedback 
oscillator. 
Based on the expressions given in Sec.II, one can plot the 
maximum instability curves  1L  and 2L  with the use of (13) 
and (14) by sweeping θ  and φ  from 0°  to 360°  to acquire 
the curves of the maximum values of outΓ  and inΓ in the 
SFΓ -plane as shown in Fig. 2. The curves of 1L  and 2L  are 
useful for the design of the feedback network. The 
intersection point P of the maximum instability curves 1L  
and 2L  is the maximum value of outΓ  and inΓ  given by 
331/ S . Note the points P1 and P2 on the circumference of the 
unitary Smith chart are the local maximum value of outΓ  
and inΓ  with impedances P1Z j1.491= and P2Z j1.71=  as 
those in [5]. In practical design of the feedback network, 
463
  
Experimental Characterization of S-matrix Reconstruction Transforms 
on Multiport Networks 
Chih-Jung Chen #1, Tah-Hsiung Chu *2 
#Department of Communications, Navigation and Control Engineering, National Taiwan Ocean University 
No. 2 Pei-Ning Road, Keelung 20224, Taiwan, R.O.C. 
1cjchen@ntou.edu.tw 
*Graduate Institute of Communication Engineering, National Taiwan University 
No. 1, Sec. 4, Roosevelt Road, Taipei 10617, Taiwan, R.O.C. 
2thc@ntu.edu.tw
Abstract  —  The characteristics of three existing S-matrix 
reconstruction transforms on the multiport network 
characterization are studied for the case of using a single kind of 
auxiliary terminations. Three unifying properties are discerned 
and experimentally verified. It is found that the three existing S-
matrix transforms prefer auxiliary terminations with small 
reflection coefficients. When auxiliary terminations with large 
reflection coefficients are taken, it may encounter numerical 
difficulty whose destructiveness depends inversely on the power 
loss of the device under test. These findings may lead more 
studies on the cause and remedy of the numerical difficulty. 
Index Terms —Scattering matrix measurement, port 
renormalization, Gamma-R parameters, multiport network. 
I. INTRODUCTION 
Thanks to the pioneering research on the multiport network 
characterization, many mathematical formulas for correcting 
the mismatch-induced errors have been developed [1]-[8]. 
Consequently, one can reconstruct the multiport scattering 
matrix (S-matrix) from the measured two-port S-matrices. 
For each two port measurements of an n-port device under 
test (DUT), the unused n-2 ports are terminated in auxiliary 
terminations that can be imperfectly matched loads. 
 Note that the two-port vector network analyzer (VNA) is 
presently more popular than the multiport one. This is 
because there is not only the powerful two-port TRL 
calibration [9]-[10], but also the higher operating frequency 
and the lower price. Therefore, the techniques for measuring 
multiport devices with the use of a two-port VNA can 
complement the weaknesses of the multiport VNA. 
Since low-loss terminations, such as short-circuited or 
open-circuited transmission lines and RF connectors, are 
more repeatable and handier than resistors, the utility of the 
S-matrix reconstruction method can be considerably extended 
with the use of strongly reflecting terminations. In addition, 
the reconstruction procedures can be further streamlined by 
using a single kind of auxiliary termination. Therefore, the 
case of using a single kind of strongly reflecting terminations 
is of most interest for practical applications. 
Among the exiting methods [1]-[8], the first four ones [1]-
[4] apply to the case of all identical auxiliary terminations. 
While the first three ones [1]-[3] marshal n(n-1)/2 pieces of 
two-port S-matrix to reconstruct the n-port one, the fourth 
one requires various incident wave power levels and, 
therefore, involves more measurements [4]. 
Methods [1]-[3] are all based on two stages of matrix 
transformation. For reconstructing the S-matrix of an n-port 
DUT with a single kind of auxiliary termination having 
reflection coefficient ΓA, the measured two-port S-matrices 
are first, respectively, transformed to 
  1 2 11     mj jJJ A I S ,  (1) 
    1 2 1 2 1 2 1 21     mj j mj j mj j mj jJJ A AS S I S I S I S , (2) 
and 
   1 2 1 2 1*    mj j mj jJJ A AR S I S .  (3) 
In (1)-(3), I  and 1 2mj jS  are the identity matrix and the 
two-port S-matrix acquired from measuring j1 and j2 ports, 
respectively.  1 2,J j j  stands for the set of number of 
measured ports. Accordingly, JJ , JJS  and JJR  are, 
respectively, the submatrices of the  , S  and R . 
When all the required combinations of the two-port 
measurements are completed, the reconstructed n-port S-
matrix is then acquired, respectively, by another matrix 
transform as 
 1 1 1   R AS I , (4) 
     12          R A AS S I S I S I S , (5) 
or 
    13 *   R A AS I R R I   (6) 
given by [1]-[3], respectively. 
Although the reconstruction transforms impose no 
constraint on the use of auxiliary terminations, different 
auxiliary terminations could result in distinct condition 
numbers of  ,  ( ) AI S  and    AI R  in (4)–(6), 
respectively. This determines the accuracy of the S-matrix 
Proceedings of Asia-Pacific Microwave Conference 2010
Copyright 2010 IEICE
TH3G-41
1428
  
coefficients of the auxiliary terminations or Γ1 are measured 
indirectly [11]. 
For the two-port measurements to reconstruct  2RS , the 
unused connectors of the DUT are terminated with the 1-dB 
attenuators while leaving the attenuator second connector 
unconnected. The reflection coefficients or Γ2 are then 
measured via one-port measurement on the attenuator. 
The typical characteristics of Γ1 and Γ2 are shown in Fig. 
2. The four-port S-matrix is then reconstructed by the three 
methods and denoted as  1RS  and  2RS . Also, the 
corresponding condition numbers are evaluated and 
illustrated in Fig. 3. The condition numbers are shown 
smaller for the case with less strongly reflecting auxiliary 
terminations. 
As shown in Fig. 4, it is apparent that the increase of the 
condition number  1   in Fig. 3 causes the reconstructed S-
matrix  1RS  to deviate from the benchmark. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 3. Condition numbers of the reconstructed S-matrices of Γ1 
and Γ2 [12]. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 4. Comparison of reflection coefficient S11 among 
benchmark and reconstructed S-parameters of Γ1 and Γ2. 
By contrast, due to the relatively lower condition numbers, 
the reconstructed S-matrix  2RS  reasonably coincides with 
the benchmark over the frequency span. Furthermore, as can 
be seen in Figs. 2-3, the rapidly changing phase of Γ2 results 
in more condition number peaks than Γ1 does. 
From the above observations, the first implication is 
experimentally verified. 
B. Implication 2 
By inspecting the results of the previous experiment, one 
already can see that when auxiliary terminations with large 
reflection coefficients are taken, it may encounter, rather than 
necessarily cause, a numerical difficulty. 
To reinforce the point, two more sets of reconstructed S-
matrices  3RS  and  4RS  are acquired by using 
subminiature A (SMA) male-to-male adapters as Γ3 and 
SMA male-to-female adapters as Γ4. 
The reflection coefficients of the auxiliary terminations Γ3 
and Γ4 acquired from one-port measurements are shown in 
Fig. 5. It can be seen that the magnitudes are both close to 0- 
dB but the phases are slightly different. The corresponding 
condition numbers are evaluated and illustrated in Fig. 6. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Fig. 5. Reflection coefficients of an SMA male-to-male adapter 
Γ3 and an SMA male-to-female adapter Γ4. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
1 1.5 2 2.5 3 3.5 4 4.5 5
0
10
20
30
40
50
60
70
80
90
100
F r e q u e n c y  [ G H z ]

 
 
  (  
1
 )
  (  
2
 )
1 1.5 2 2.5 3 3.5 4 4.5 5
-60
-40
-20
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 . 
 S
 1
 1
  [
 d
 B
 ]
 
 
1 1.5 2 2.5 3 3.5 4 4.5 5
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  
S
 1
 1
  [
 d
 e
 g
 ]
 
 
S R (  
1
 )
S R (  
2
 )
S B
S R (  
1
 )
S R (  
2
 )
S B
1 1.5 2 2.5 3 3.5 4 4.5 5
-0.2
-0.15
-0.1
-0.05
0
F r e q u e n c y  [ G H z ]
M
 a
 g
 n
 i 
t u
 d
 e
  [
 d
 B
 ]
 
 
1 1.5 2 2.5 3 3.5 4 4.5 5
-200
-100
0
100
200
F r e q u e n c y  [ G H z ]
P
 h
 a
 s
 e
  [
 d
 e
 g
 ]
 
 
 
3
 
4
 
3
 
4
1 1.5 2 2.5 3 3.5 4 4.5 5
0
10
20
30
40
50
60
70
80
90
100
F r e q u e n c y  [ G H z ]

 
 
  (  
3
 )
  (  
4
 )
1430
國科會補助計畫衍生研發成果推廣資料表
日期:2012/01/15
國科會補助計畫
計畫名稱: 使用2-埠網路分析儀量測n-埠微波網路之研究
計畫主持人: 瞿大雄
計畫編號: 98-2221-E-002-062-MY2 學門領域: 電磁
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
