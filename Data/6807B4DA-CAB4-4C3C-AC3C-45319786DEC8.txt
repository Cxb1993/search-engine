I 
 
摘要 
本計畫主要目的為設計與實現具有高性能的並聯式主動電力濾波器系統。
過去並聯式主動濾波器常用的控制器為比例-積分(PI)控制器，而當 PI 控制器的
參數面臨不同負載變化時，其控制器參數可能必須經過重新調整。有鑑於此，
本論文針對單相並聯式主動電力濾波器提出具有強健性及適應性的控制器，來
改善市電功率因數及緩解電流諧波污染等問題。本計畫所提出來的電力濾波器
系統，分別包含了 Takagi-Sugeno (T-S) 模糊控制及參考模型適應控制器(MRAC)
的控制演算法。然而，此並聯式主動電力濾波器的數學模型為一個雙線性系統，
不易設計其控制器及分析穩定度。因此，本計畫先利用一般線性化的方法，來
近似系統的非線性特性，並同時解決穩定度的問題。 
本計畫 T-S 模糊控制器的設計上，是基於平行分佈補償器(PDC)的設計方
法，其中穩定的控制器回授增益值與共同之正定矩陣，則是以李亞普諾夫
(Lyapunov)穩定理論為基礎，最後藉由 MATLAB 應用軟體的線性矩陣不等式
(LMI)求解，以確保每個子系統均能滿足李亞普諾夫不等式。而在本計畫參考模
型適應控制器的設計上，是根據李亞普諾夫穩定理論與 Barbalat 定理設計出一
適應控制律，而系統輸出根據此律與參考模型參數進行追蹤比較，最後保證系
統能漸進穩定。與傳統比例-積分控制器相比，本計畫所提的 T-S 模糊及適應控
制器應用，具有較高的設計彈性、強健性與適應性，可因應系統不同負載的劇
烈變化，同時保持一致的輸出性能。 
    為了證明所提出的控制方法之可行性，除了運用數位訊號微處理器
(dsPIC30F4012)來實現複雜的控制法則運算外，也建構實現一 1kVA 的測試原
型機，來實際測試系統的性能。最後經模擬與實驗結果驗證本系統可提高功率
因數、降低電流諧波及暫態響應的強健性。 
關鍵字：主動式電力濾波器，T-S 模糊控制，參考模型適應控制，功率因數，
電流諧波。 
 
 
 
III 
 
目錄 
第一章 緒 論........................................................ 1 
1.1 研究背景.................................................... 1 
1.2 諧波及其產生原因............................................ 1 
1.3 諧波改善方法................................................ 2 
第二章 並聯式主動電力濾波器分析..................................... 3 
2.1 主動電力濾波器簡介.......................................... 3 
2.2 全橋式交-直流轉換器分析..................................... 3 
2.3 雙極性模式分析.............................................. 4 
2.4 系統線性化分析.............................................. 5 
第三章 系統架構與硬體電路設計分析................................... 8 
3.1 感測及運算控制模組.......................................... 9 
3.2 功率級模組................................................. 12 
3.3 電源供應模組............................................... 13 
第四章 以 LMI 為基礎的 T-S 模糊控制器設計 ........................... 17 
4.1 前言....................................................... 17 
4.2 T-S 模糊控制器設計 ......................................... 17 
4.3 模擬與實驗結果............................................. 22 
第五章 參考模型適應控制設計........................................ 30 
5.1 前言....................................................... 30 
5.2 參考模型適應控制器設計..................................... 30 
5.2 參考模型模擬............................................... 33 
5.3 實驗結果................................................... 35 
第六章 結論與未來研究方向.......................................... 40 
6.1 結論....................................................... 40 
6.2 未來研究方向............................................... 40 
Reference ..................................................................................................................... 41 
 
  
V 
 
圖 5-3 PI-主動式濾波器之變載實驗 (a)負載變化(200W -> 600W -> 200W) (b)
加載(200W -> 600W) (c)卸載(600W -> 200W) ............................................. 35 
圖 5-4 MRAC-主動式濾波器 (a)負載變化(200W -> 600W -> 200W) (b)加載
(200W -> 600W) .............................................................................................. 36 
圖 5-5 PI-主動式濾波器之電流補償圖形 (a) 負載功率 200W (b) 負載功率
600W ................................................................................................................ 37 
圖 5-6 MRAC-主動式濾波器之電流補償圖形(a) 負載功率 200W (b) 負載功率
600W ................................................................................................................ 38 
圖 5-7 PI 與 MRAC-主動式濾波器在不同負載下 THD 與 PF 之比較 .................. 39 
圖 5-8 IEC61000-3-2 Class D諧波電流規範與 PI與 MRAC主動式濾波器之諧波
電流比較 .......................................................................................................... 39 
 
表 1-1 電力品質之污染源與受害對象 ....................................................................... 2 
表 4-1 系統實驗參數值 ............................................................................................ 22 
2 
 
表 1-1 電力品質之污染源與受害對象 
電力品質項目 污染源 受害對象 
電力諧波 非線性負載、電力電子 電力設備發熱 
電壓閃爍 
重負載變動、非線性負 
載 
眼睛不適發電機自動調
整器不穩 
三相不平衡 單相負載高週波電爐 電動機過熱損失增加 
電壓與電流突波 雷擊、開關及電容切換 
電力設備過電壓或過電
流而產生故障 
電壓驟降與湧昇 雷擊、鹽害接地等事故 
電磁開關跳脫過壓及低
壓電驛動作 
頻率驟降與昇高 電力供需不平衡 發電機共振 
電磁干擾 無線電、輸電線路 電信雜音 
電力中斷 電力事故 停電保護電驛動作 
 
1.3 諧波改善方法 
目前在電力系統中改善諧波問題的方法為在諧波源裝設電力濾波器，針對
諧波抑制或功因改善補償設備。而本計畫中主要使用並聯式主動電力濾波器，
這類型的電力濾波器無論是研究上或工業界都被廣泛的應用[2]-[6]。依其電力
電路有幾種類型，其中最常被採用的兩種類型為電流型反流器與電壓型反流器，
其濾波的基本概念是由主動式濾波器產生一個和負載諧波成分完全反相的電流
波形，因此負載所需的基頻波形電流由系統提供，諧波電流則由主動式濾波器
提供，如此就不會有諧波電流流入系統端；故可將並聯型主動式濾波器視為一
種「諧波補償器」。圖 1.1 是並聯式主動電力濾波器基本架構。 
非線性負載
(non-linear load)
主動濾波器
(active power filter)
Si Li
Fi
sv
 
圖 1-1 並聯式主動電力濾波器基本架構 
 
 
4 
 
2.3 雙極性模式分析 
 操作模式一 
等效電路如圖2-3所示，在此模式下Q2、Q3導通，Q1、Q4截止在0<t<DTs。
其中Ts = 1/fs為切換週期，D=Ton/Ts為Q2責任週期，Ton為導通時間。在此操作模
式下電感處於充電的狀態，對輸出電容作釋放能量的動作。 
L
+ -
L
V
2Q
3
Q
+
-
xV
C
LR
i
L
RSV L
i
Ci
 
圖 2-3 操作模式一之等效電路圖 
依克希荷夫(Kirchhoff)電壓與電流定律可得： 
 1( ) [ ( ) ( )]
L S C
i t v t v t
L
   (2-1) 
 ( )1( ) [ ( ) ]C
C L
L
v t
v t i t
C R
    (2-2) 
由(2-1)式可知電感電流斜率為正，此模式下電感電流為上昇狀態。 
 操作模式二 
等效電路如圖2-4所示，在此模式下Q1、Q4導通，Q2、Q3截止在DTs<t<Ts。
其中Ts = 1/fs為切換週期，D=Ton/Ts為Q2責任週期，Ton為導通時間。在此操作模
式下電感處於釋放能量的狀態，對輸出電容作充電的動作。 
L
+ -
LV
4Q
1Q
+
-
CV
C
LR
i
LR
Ci
S
V
Li
 
圖 2-4 操作模式二之等效電路 
依克希荷夫(Kirchhoff)電壓與電流定律可得： 
 1( ) [ ( ) ( )]
L S C
i t v t v t
L
   (2-3) 
 ( )1( ) [ ( ) ]C
C L
L
v t
v t i t
C R
   (2-4) 
由(2-3)式可知電感電流斜率為負，此模式下電感電流為下降狀態。 
6 
 
 2 1 2
( ) (1 2 ) ( ) ( )
L
dx t u x t x t
dt C R C

   (2-13) 
其中
1
( )x t 與
2
( )x t 表示狀態變數在每個切換週期上的電感電流
L
i 與電容電壓
C
v 的
平均值。 ( )u t 代表系統平均控制輸入(責任週期) 。 
平均狀態空間變數改寫成以下矩陣形式 
 1 1 1
2 2 2
1 2
0 10
( ) ( ) ( )
( ) ( )
1 1( ) ( ) ( )2
00
S
L
x t x t x tL L
u t v tL
x t x t x t
C R C C

  
 
   
                                   
 (2-14) 
或者改寫成以下式子 
 ( ) ( ) ( ) ( ) ( )x t Fx t Gx t u t Ew t    (2-15) 
其中 
1
2
( )
( )
( )
x t
x t
x t

 
 
 
, 
1
0
1 1
L
L
F
C R C



 
 
 
 
  
, 
2
0
2
0
L
G
C


 
 
 
 
  
, 1 0
T
E
L

 
  
以及 ( ) ( )
S
w t v t   
( )w t 代表系統的擾動量。 
    考慮雙線性 (Bilinear)動態方程式 (2-15)式，假若
0
x x 和
0
u u 滿足
0 0 0 0 0
( ,  ) ( ) 0f x u Fx Gx u Ew t    ，
0 0
( , )x u 為系統操作點。可以將微分方程式(2-12)
和(2-13)令為零,求得平均電感電流
1(t) x 和平均電容電壓 2  ( )x t 的操作點 
 0 02
(1 2 )
0S
u x v
L L
 
   (2-16) 
與 
 02 0 01
(1 2 )
0
L
x u x
R C C

    (2-17) 
從(2-16)式中可得 
 
02
0
(1 2 )
S
v
x
u


 (2-18) 
與從(2-17)式中得 
 02
01
0
(1 2 )
L
x
x
R u


 (2-19) 
其中
01
x 和
02
x  分別為平均電感電流
1
(t) x 和平均電容電壓
2
  ( )x t 操作點。平均
控制輸入
0
u 的操作點可以從(2-18)式中得到 
8 
 
第三章 系統架構與硬體電路設計分析 
近年來由於積體電路技術發展成熟，許多常用之電路大多已模組化，在設
計上不僅方便許多，電路面積也大幅縮小，且提高系統穩定度，減少雜訊干擾，
因此本系統之電路設計亦朝向此目標著手，使其更接近商品化。 
本系統之硬體架構如圖 3-1 所示，分為三大部分：感測及運算控制模組、
功率級模組和電源供應模組。以下將針對這三大部分之硬體電路設計作一介紹，
在設計此系統前，須先考慮額定之輸出容量、工作電壓、穩壓範圍、元件之耐
壓耐流程度、驅動方式、過載保護、負載電流偵測、散熱裝置及擴充維修等問
題，針對此問題採取最佳化相關電子零件及電路[10]，以達最低成本之設計。 
主動電力濾波器之架構包括：功率級模組、感測與運算控制模組、電源供
應模組及散熱裝置。 
 
dsPIC30F4012
Timer
10 bit A / D
Converter
External 
Interrupt
MOSFET Gate Drivers
( Photo Couplers TLP 250 )
DC Voltage Sensor Circuit
( Differential Amplifier )
+
-
+
-
+ -
L
v Xv C
L
C
v
L
R
Q
1
Q
2
Q
3
Q
4
S
i Li
Fi
Ci
4 Gate Signals
 Control Signals
Micro Electronic Board
Cv
Sv
Zero Crossing Detection 
Circuit & Line voltage 
S
v
Si
Current Sensors Circuit
( Hall Sensors )
+
-
PWM
Modules
Detection Circuit
LR
i
 
圖 3-1 並聯式主動電力濾波器硬體架構圖 
感測與運算控制模組負責偵測市電、直流儲能電容電壓與市電電流，且使
各偵測電壓的地能與微控制器之電源地隔離，並透過運算控制電路提供適當之
補償電流；功率級模組則提供愈補償之電流波形與直流儲能電壓之穩壓；電源
供應模組則是提供穩定之電源給予驅動級、感測與運算控制等等各級電路。散
熱裝置則主要用於系統所使用之功率元件上，以避免切換損失或高電壓造成元
件之溫升而導致元件之損壞。 
 
  
10 
 
3.1.2 驅動級電路 
此電路由獨立之驅動穩定電源、光耦合放大電路所組成。如圖 3-4 所示，
驅動級電路主要功能是將數位訊號控制器產生之控制訊號，經隔離與放大後再
接至功率開關。 
光耦合放大
驅動電路
dsPIC
控制訊號
功率
開關
5V
18V
 
圖 3-4 驅動級電路架構圖 
本級電路使用光耦合放大器（TLP250）將控制訊號與電路訊號作直流性絕
緣，使得功率級的上下臂功率開關得以浮接，避免使閘-源級電壓受到輸出電壓
變動的影響。而且以光耦合器作為信號轉換，可以達到電性完全隔離，電性的
隔離可以阻止電路中所產生的雜訊傳送到另一電路，所以可以用於雜訊大的場
所，避免雜訊導致誤動作。光耦合電路圖，如圖 3-5 所示 
1 2 3 4
A
B
C
D
4321
D
C
B
A
Title
Number RevisionSize
B
Date: 28 -Feb -2009 Sheet    of 
File: E:\學弟論文\東益的論文光碟\Layou t\APF.ddb Drawn  By:
CC1
104/50V
R1
470R
+CE1
10uF/25V
dsPIC-PWM in
MOSFET-G
MOSFET-S
1
2
3
4 5
6
7
8
TLP250
Photo-coupler
GND1GND
GND1
R2
47R
D1 1N4148
+18V
R3
10k
 
圖 3-5 光耦合電路圖 
3.1.3 電壓偵測電路 
此部分分為直流儲能電容電壓偵測電路與交流電壓偵測電路，如圖 3-6 所
示，其中直流儲能電容電壓偵測電路是利用一差動放大器和緩衝電路構成之電
壓偵測電路。至於交流電壓偵測電路部份，由於 dsPIC30F4012 的 A/D 轉換模
組輸入範圍為正 0~5V，所以必須將降壓後的訊號準位作提升的動作，以配合
數位訊號微處理器可以正常工作的範圍。對於欲感測之電壓做隔離與倍率衰減
後，送至微控制器作類比轉數位的處理，此電路值得一提的是在於其量測對象
的地與微控制器的電源地並未相連接，這將對微控制器的電源穩定度上有所助
益。 
12 
 
LM393
60Hz
ZCD Signal
60Hz
Zero Crossing Detection Circuit
0V
0V
5V
Sv
 
圖 3-8 零點偵測器示意圖 
使用快速運算放大器(LM393)組成零交越點偵測器，以防輸入或輸出訊號
有相位差。當輸入弦波訊號大於零伏特時，輸出產生正電位，相反地，則輸出
零電位。將產生與正弦波同頻率的方波訊號接至數位訊號控制器外部中斷接腳，
使數位訊號微控制器得知市電之狀態，進而決定切換策略。零點偵測器電路圖，
如圖 3-9 所示 
1 2 3 4 5 6
A
B
C
D
654321
D
C
B
A
Title
Number RevisionSize
B
Date: 28 -Feb -2009 Sheet    of 
File: E:\學弟論文\東益的論文光碟\Layou t\APF.ddb Drawn  By:
OPA
LM393
+12
-12V
R2
1K
R3
9.1K
R4
91K
R5
1K
Q1
2SA1015
R6
510K
ZD1
5.6V
Zero Cross
CC1
104 / 50V
LM3
GND
Q1BLM1
VDD
Q1E
ZCD
AC 110V/10V
TRANS3
10V
+
-
VR1
5K
R1
22K
GND
GND
GND
Q1C
VSS
AC in  1
AC in  2
 
圖 3-9 零點偵測器電路 
 
3.2 功率級模組 
在功率級電路的設計上，我們必須考量到系統操作在各級電路必須承受的
電壓電流規格，進而決定元件的選用。由於本系統屬於交流 110V 電源，在功
率元件之規格選擇上，必須符合最大額定值，因此選用MOSFET STW45NM60，
耐壓 600V、耐流 45A 的功率開關，因其具有比 IGBT 切換速度更快且價格便
宜等優點。 
3.2.1 全橋式交-直流轉換器電容設計 
電壓變動的大小由流入直流儲能電容的交流功率成份之大小、頻率以及直
流匯流排上的電壓值來做決定。當頻率變低時則需使用較大的電容來穩壓，故
直流儲能電容之大小取決於並聯式主動電力濾波器之功率額定和所接之負載所
處的狀態，雖然電容值越大其電壓變動越小。但基於體積與成本的問題，故需
審慎的考量。以下分析電容最小值由(3-1)式可知[11]。 
 22
o
o
P
C
f V

   (3-1) 
   其中
o
P 為輸出功率，
o
V 為允許峰對峰值輸出漣波電壓， f 為操作頻率。 
    在直流電壓匯流排的電壓值考量方面，當匯流排之電壓值越高時並聯式主
14 
 
F1
XC1 XC2
YC1
YC2
.
.
L1
SW1
AC
110V
V1_22V
V2_22V
V3_22V
G1
G2
G3
電源保護電路 EMI 濾波電路
 
圖 3-11 電源保護、EMI 濾波電路 
3.3.2 EMI 濾波器 
EMI 濾波器主要是消除、減弱外界環境之 EMI 對系統之干擾及系統本身產
生之雜訊對外界環境之干擾，圖 3-11 中之 EMI 濾波器電路。XC1 電容主要是
濾外部輸入的高頻雜訊，避免影響內部系統動作；YC1 及 YC2 電容主要是濾
除系統內部的高頻雜訊，避免影響外在環境之電路動作；而 L為環形鐵心電感，
主要是避免外在環境及系統內部之高頻雜訊通過。 
3.3.3 獨立驅動穩定電源電路 
此電路需要三組獨立電源供應各驅動電路，其中由 AC/DC 整流電路轉換
成直流電源，須經穩壓調整器，穩壓成所需之電源，才能驅動各個電路動作，
如圖 3-12 所示。 
Vin
1
GND
2
Vout
3
Q3
+
CE3_1
+
CE3_2
C3_1
C3_2
+18V
DZ3_1
+
-
24V
AC BUS+_3
AC BUS-_3
VCC-3
ADP 3
GND-3
LED 3
R3_1D3_1
D3_2
D3_3
Vin
1
GND
2
Vout
3
Q2
+
CE2_1
+
CE2_2
C2_1
C2_2
+18V
DZ2_1+
-
24V
AC BUS+_2
AC BUS-_2
VCC-2ADP 2
GND-2
LED 2
R2_1D2_1
D2_2
D2_3
Vin
1
GND
2
Vout
3
Q1
+
CE1_1
+
CE1_2
C1_1
C1_2
+18V
DZ1_1
+
-
24V
AC BUS+_1
AC BUS-_1
VCC-1ADP 1
GND-1
LED 1
R1_1D1_1
D1_2
D1_3
 
圖 3-12 獨立驅動穩定電源電路 
16 
 
 
圖 3-14 實驗用並聯式主動電力濾波器系統 
  
18 
 
式所示。而圖 4-1(a)及(b)，分別為  1z t 與  2z t 之歸屬函數圖形，其中常數 1 和
2
 分別為誤差與誤差積分之最大值。 
 
  
0 z       
      for 1, 2
2
1 z        
j j
j j
P j j j j
j
j j
z
z z j


  


 

    








 (4-4) 
  
0 z       
      for 1, 2
2
1 z        
j j
j j
N j j j j
j
j j
z
z z j


  


 

    








 (4-5) 
1
0.5
Negative Positive
0 11
))(( 1 tz
)(1 tz  
(a) 
1
0.5
Negative Positive
0 22
))(( 2 tz
)(2 tz  
(b) 
圖 4-1 輸入變數之歸屬函數圖 (a) z1(t) . (b) z2(t). 
  
20 
 
 
   
   
   
   
   
1 2
1
1 2
2
1 2
  1:  If  is  and  is ,
                          then f
  2 :  If  is  and  is ,
                          then f
  3 :  If  is  and  
Control Rule z t P z t P
u t x t
Control Rule z t P z t N
u t x t
Control Rule z t N z t
 
 
 
 
   
   
   
3
1 2
4
is ,
                          then f
  4 :  If  is  and  is ,
                          then f
P
u t x t
Control Rule z t N z t N
u t x t
 
 
 
 
 (4-8) 
其中
1
f ，
2
f ，
3
f ，
4
f 分別代表控制器之回授增益值。 
另外，(3-23)式可整理成 
 
 
    
  
    
4
1
4
1
4
1
f
         f    
i i
i
i
i
i i
i
z t x t
u t
z t
h z t x t








 
 



 (4-9) 
由上述方法，即可列出控制規則庫中每一條規則所代表的局部回授值
1
f ，
2
f ，
3
f ，
4
f ，而其中回授增益值 f
i
將藉由線性矩陣不等式(Linear Matrix Inequality, 
LMI)來加以求得。 
4.2.3 穩定度分析與控制器增益設計 
    模糊控制系統穩定度的分析與控制器增益回授值(4-8)式，乃基於李亞普諾
夫穩定定理 (Lyapunov stability theory) 與線性矩陣不等式 (Linear Matrix 
Inequality, LMI)[15]為基礎去設計。接下來將簡述在開迴路情況下的穩定定理。 
 
定理 1: 在一連續模糊系統中，若存在有一個共同之正定矩陣 P 使得(4-10)式成
立，則(4-7)式在   0u t  將會是全面性漸近穩定。 
 0,      1,  2,  3,  4T
Pi Pi
A P PA i    (4-10) 
接下來在閉迴路系統的穩定度探討中，我們將(4-9)式代入(4-7)式，可得到 
           
4 4
1 1
f
i j Pi Pi i
i j
x t h z t h z t A B x t
 
 
   (4-11) 
並且令 
 f
ij Pi Pi j
G A B   (4-12) 
22 
 
T-S Fuzzy 
Controller
PLL
Hysteresis
Controller
e
 e

)sin( t
Sv
Cv

CV
PWM
Generator
+
-
SI

Si
+
_
Si
+
_
1Q
2Q
 
圖 4-2 T-S Fuzzy 控制方塊圖 
4.3 模擬與實驗結果 
本系統實驗參數值如表 4.1 所示，最後將以模擬結果與實驗結果驗證本文
所提出控制架構之可行性與性能，並探討負載變化時系統之補償結果。 
表 4-1 系統實驗參數值 
項目 數值 
輸入電壓 Vs = AC 110V/60Hz 1ψ  
負載 RL = 10kΩ 
鏈結電感 L = 6mH 
直流儲能電容 C = 1000μF/400V 
直流儲能電容電壓 Cv = 250V 
切換頻率 fs = 13k-15kHZ 
定義直流儲能電容電壓的平衡點為 250V ，因此，我們可以得到平均控制
輸入
0
0.19u  及平均電感電流
01
0.04x A 。並定義一調整誤差之變數 
    3
0
t
C C
x t V v t dt


   (4-21) 
或是將上式微分，可得到 
     3 2C Cx t V v t x 

     (4-22) 
將
0
u 、
01
x 與
02
x 代回(4-5)式，因此系統的狀態模型可以改寫成以下 
 
0 02
1 1
0 01
2 2
3 3
03
2 1 2
0 0
1 2 21
0
0 1 0
L
u x
L Lx x
u x
x x u
C R C C
x x
x
 
  
 

 
 

   
   
      
      
      
         
   
      
 (4-23) 
    根據歸屬函數(4-4)式與(4-5)式的定義，我們可以得到 T-S 模糊模型(4-6)式
24 
 
 
 
控制理論
硬體電路
 
圖 4-3 模擬架構圖 
  
26 
 
4.3.2 主動式濾波器穩態之模擬與實驗 
圖 4-5 所示為 600W 情況下之模擬與實驗結果。圖 4-6 為加入主動式濾波
器與無主動式濾波器之電流諧波比較。 
Li
Fi
Si
100V
20A
20A
20A
5ms
S
v
 
(a) 
200V
20A
20A
20A
Li
Fi
Si
5ms
S
v
 
(b) 
圖 4-5 600W 主動式濾波器穩態模擬與實驗結果 (a) 模擬結果 (b) 實驗結果 
 
圖 4-6 600W 之電流諧波補償前後比較 
0
10
20
30
40
50
60
70
80
2 3 4 5 6 7 8 9 10 11 12 13
各次諧波
電
流
諧
波
含
量
百
分
比
 (
%) APF補償前
APF補償後
28 
 
圖 4-9 為比較 PI 控制器與 T-S 模糊控制器之主動式濾波器的總諧波失真(Total 
Harmonic Distortion, THD)與功率因數(Power Factor, PF)。圖 4-10 為 IEC 61000
諧波規範系列[16]、PI 主動式濾波器與 T-S 主動式濾波器諧波電流比較。 
10.8
7.3
9.1
8.1
0
5
10
15
20
0 200 400 600 800
L oa d (W )
T H D  (% )
P I
T -S  fuzzy
PF=0.99
PF=0.99
PF=0.98
PF=0.99
 
圖 4-9 比較 PI 主動式濾波器與 T-S 主動式濾波器之總諧波失真與功率因數 
 
圖 4-10 比較 IEC 61000-3-2 Class D 規範、PI主動式濾波器與 T-S主動式濾波器之諧波電
流(600W 的情況下) 
  
30 
 
第五章 參考模型適應控制設計 
5.1 前言 
使用 PI 控制器的主動式電力濾波器的缺點，在上一章我們已經提出使用
T-S 模糊控制來使我們的系統能更為強健。然而 T-S 模糊控制有著複雜的模糊
與解模糊的運算過程。因此為了簡化其複雜的數學運算與控制法則，在此採用
廣泛應用於適應控制系統中的參考模型適應性控制(Model Reference Adaptive 
Control, MRAC)來解決上述的問題。 
在MRAC藉由適應律(Adaptive Laws)來達到控制原系統狀態能控制到所設
計的參考狀態。一方面可以更有彈性滿足設計者達到所預設目標，另一方面本
計畫使用參考模型適應控制最主要理由的是可以藉由參考模型 (Reference 
Model)設計來消除過大超越量(Overshoots)和低射現象(Undershoots)。 
本計畫主動式濾波器藉由 MRAC 理論達到消除輸入電流諧波達到與單位
功因為目的。由於本系統為雙線性(Bilinear)系統是無法按照傳統控制分析與控
制，而在第二章中，我們已經將系統線性化得到其近似擾動線性方程式
(Perturbed Linear System)，並利用李亞普諾函數(Lyapunov Function) 設計法則，
求得適應律(Adaptive Laws)並確保閉迴路系統穩定，並且可藉由 Barbalat‟s 
Lemma 證明誤差收斂到零。 
5.2 參考模型適應控制器設計 
在 MRAC 理論中，參考模型能提供設計者所期望的系統響應，故首先將考
慮一穩定可控的線性非時變參考模型(Reference Model) ，其表示如下 
 ( ) ( ) ( )
r r r r
x t A x t B r t   (5-1) 
其中 2 2
r
A R

 、 2 1
r
B R

 與 ( )r t  為參考輸入。 
根據以上分析，定義誤差方程式為 
      re t x t x t   (5-2) 
由於 MRAC 的最終目標為尋找一組會隨著誤差而自行調整的適應控制律，將使
 x t 去跟隨著  rx t 狀態，並且希望狀態誤差 )(te 在 t 無窮大時趨近於零。為了
達到目標，根據(2-25)式設計一可調式控制器(Adjustable Controller) 
 ( )u Z t    (5-3) 
其 中 ( ) [ ]TZ t r x

 與 [ ]
f b
   適 應 控 制 器 參 數 ， 而 ( )
f
t 與
1 2
( ) [ ( ) ( )]
b b b
t t t   分別為可調前饋增益與可調反饋增益。接下來將由誤差方
32 
 
接著將(5-13)式與(5-14)式代入(5-12)式中可得 
 
1
( ) 0
2
T
V t e Qe    (5-15) 
根據 Lyapunov stability theory，若 ( ) 0V t  則系統為漸進穩定。接著對(5-15)式作
積分 
 
0
( ) ( ) (0)V t dt V V

    (5-16) 
根據 Barbalat‟s lemma [17]，當 t 時，若對(5-16)式結果滿足 
 
0
1
(0)
2
T
eQe dt V

  (5-17) 
則系統穩態時，狀態將會跟隨到所設計狀態響應，即 0e  與 0e  。 
接著因為適應律無法直接從系統參數中求得為此先將(5-6)式與(5-7)式微分得 
 
p b
B    (5-18) 
與 
 
p f
B    (5-19) 
分別比較(5-13)式、(5-18)式與(5-14)式、(5-19)式我們可以得到適應律 
 
1
1
1
2
( )
( )
T T T
b p p p
T T T
f p p p
B B B Pex
B B B Per

 
 







 (5-20) 
令 1( )T T
p p p
K B B B

 , 則 
 1
2
T
b
T
f
KPex
KPer

 
 





 (5-21) 
最後適應律可以藉由(5-21)式中得到，設計出可隨著狀態誤差調而自行調整
增益影響的適應律進而改變控制器輸出，所以設計者可以更容易控制系統狀態
達到所設計的響應與性能而誤差方程式將會隨著時間增加趨近於零。其控制方
塊圖如圖5-1。 
34 
 
 
 
1b

2b

f

1
e
2
e
 
圖 5-2 控制器狀態誤差與增益參數模擬圖 (a) 狀態誤差 e1 (b) 狀態誤差 e2 (c)前饋增益 θb1 (d)
前饋增益 θb2 (e)反饋增益 θf 
36 
 
without undershoot
without overshoot
(a)
(b) (c)
L
i
S
i
L
i
S
i Si
L
i
 
圖 5-4 MRAC-主動式濾波器 (a)負載變化(200W -> 600W -> 200W) (b)加載(200W -> 600W)  
(c)卸載(600W -> 200W) 
5.3.2 固定負載實驗 
實驗以市電電壓 110V 為實驗條件；針對輕重載不同情況下進行補償， 並
觀察輸入電壓與電流之間變化。
S
V 為市電電壓波形、
L
I 為負載電流波形、
F
I 為
補償電流波形、
S
I 為補償後輸入電流波形。圖 5-5 為 PI-主動式濾波器的實驗，
圖 5-6 為 MRAC-主動式濾波器的實驗結果。圖 5-7 為 PI 與 MRAC-主動式濾波
器之總電流諧波(THD)和功率因數(PF)比較。圖 5-8 為 IEC61000-3-2 Class D 諧
波規範[17]與 PI 與 MRAC-主動式濾波器之諧波電流比較。 
  
38 
 
 
S
v
L
i
F
i
S
i
(a) 
 
S
v
L
i
F
i
S
i
(b) 
圖 5-6 MRAC-主動式濾波器之電流補償圖形(a) 負載功率 200W (b) 負載功率 600W 
  
40 
 
第六章 結論與未來研究方向 
6.1 結論 
隨著電子工業的日益發達，主動式電力濾波器之架構與技術也不斷地在進
步，許多新的電力電子產品也應用在其中，藉以改善各種電力品質的問題。而
傳統一般常用的 PID 控制器雖然控制簡單，但卻沒有優越的強健性來處理系統
的異常變化。因此，本計畫在第四章中提出 T-S 模糊控制應用在單相主動式電
力濾波器上，藉由 PDC 設計控制器的規則庫，再利用 LMI 去求解出控制器的
回授增益值與一共同正定矩陣 P 以確保每一個子系統均能滿足 Lyapunov 不等
式。 
然而，T-S 模糊控制有著複雜的模糊與解模糊的過程，因此，本計畫於第
五章中，提出參考模型適應性控制(Model Reference Adaptive Control)應用在單
相主動式電力濾波器上，首先將原本雙線性(Bilinear)系統藉由線性化並且設計
可自行跟隨狀態誤差調整控制器。而所設計出來控制器可用來幫助經由線性化
的系統狀態去追蹤所設計參考模型(Reference Model)。而且並可藉參考模型
(Reference Model)設計解決傳統控制一些問題如過大超越量(Overshoots)、低射
現象(Undershoots)或者是強健性的問題。 
根據 Lyapunov 穩定理論與 Barbalat‟s Lemma 推導之適應律(Adaptive Law)
可以保證系統穩定且狀態誤差收斂到零。經實驗得知，當負載出現長期或短期
異常變動情況時，透過系統補償，使輸入電流維持為正弦波減少虛功浪費增加
系統效能且當負載越大之情況下，其功率因數亦隨之增加。 
最後可歸納幾項結論： 
 利用高性能的數位信號控制器(dsPIC30F4012)簡化整個系統架構，降低成
本且提供極高的處理速度，並藉由軟體修正使系統容易升級。 
 其電流總諧波失真可抑制到約 8%，並符合 IEC 61000 3-2 國際諧波規範，
以增加商品化之可行性。 
 由實驗結果證明，可控制功率因數達約 0.99。因此，是未來高效率高品質
電力轉換系統的關鍵性技術。 
6.2 未來研究方向 
(1) 由於開關切換將造成電力轉換的損失，使得轉換器之效率降低。若能針對開
關的緩衝電路作改良，並應用零電壓或零電流切換技術於高頻切換電路，應
能提昇整體系統效率。 
(2) 針對國際工業測試標準，進行一系列測試，含雷擊突波干擾、穩定度測試、
EMI 安規等，進而提高本系統之穩定性。 
(3) 可結合交流穩壓器或不斷電系統，以改善系統的輸入諧波與功率因數。 
  
42 
 
linear matrix inequality approach, John Wiliey ＆ Son Inc., 2001. 
[16] J. Arrillaga, and N. R. Watson, Power System Harmonics, 2
nd
 Edition, 
Chichester, West Sussex, England; Hoboken, NJ: J. Wiley & Sons, 2003. 
[17] F. J. Lin, P. K. Huang, C. C. Wang, and L. T. Teng, "An induction generator 
system using fuzzy modeling and recurrent fuzzy neural network," IEEE Trans. 
Power Electron., vol. 22, no. 1, pp. 260–271, Jan. 2007. 
  
國科會補助計畫衍生研發成果推廣資料表
日期 2010年10月25日
國科會補助計畫
研發成果名稱
發明人
(創作人)
技術說明
技術移轉可行性及
預期效益
技術/產品應用範圍
產業別
計畫名稱:
計畫主持人:
計畫編號: 學門領域:
(中文)
(英文)
成果歸屬機構
(中文)
(英文)
模糊適應控制之主動電力濾波器設計
徐國鎧
96 -2221-E -008 -121 -MY3 電力電子
模糊適應控制之主動電力濾波器設計
Design of Fuzzy and Modeling Control Active Power Filter System
國立中央大學 徐國鎧,楊銘基
過去並聯式主動濾波器常用的控制器為比例-積分(PI)控制器，而當PI控制器的
參數面臨不同負載變化時，其控制器參數可能必須經過重新調整。有鑑於此，
本計畫針對單相並聯式主動電力濾波器提出兩種具有強健性及適應性的控制器
，來改善市電功率因數及緩解電流諧波污染等問題，包含Takagi-Sugeno(T-S)
模糊控制及參考模型適應控制器(MRAC)，並利用一般線性化的方法，來近似系
統的非線性特性，同時解決控制器穩定度的問題。
In the past, most shunt active power filter (APF) systems used
proportional integral (PI) control. However, it may be necessary to
retune the PI parameters for different operation conditions.
Therefore, this dissertation proposes two kinds of controller, which
are robust and adaptive, for single-phase shunt APF to improve line
power factor (PF) and mitigate line current harmonics. The APF system
respectively include a Takagi-Sugeno (T-S) fuzzy and model reference
adaptive controllers (MRAC), and also employs the linearization
method to approach the nonlinearity of the system and solve the
stability problem.
電力供應業；機電工程業
電力濾波設備
可取代現有PI控制之主動電力濾波器，若有廠商有意願，願意提供協助
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
