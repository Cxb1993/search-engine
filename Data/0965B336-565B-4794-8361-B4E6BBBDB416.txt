 II
 
具認證功能無線網路金鑰協議機制之研究與實現 
 
計畫編號：NSC 95－2221－E－274－012 
執行期間：95 年 8 月 1 日至 96 年 7 月 31 日 
計畫主持人：李永振 
共同主持人：郭文中、張耿魁 
計畫參與人員：唐放之、馮佑玄、鍾旻憲、朱榮祿 
 
中文摘要 
 
 
金鑰協議為網路安全應用之一重要機制。公開金鑰基礎建設為提供安全之網路認證與
金鑰交換之重要平台。但公開金鑰基礎建設之系統甚為複雜與龐大，且若干場合無法提供
完整之基礎建設，各使用者或伺服器間可能僅共享通行碼。故如何有效運用通行碼進行安
全認證與金鑰交換，為一重要之課題。本文提出一種無須公開金鑰基礎建設之無線網路安
全認證與金鑰分配機制，此機制能抵抗猜測攻擊、仿冒攻擊與中間人攻擊，且同時具有公
開金鑰與對話金鑰協議之功能。 
 
關鍵詞：猜測攻擊，金鑰協議，認證技術。 
 1
具認證功能無線網路金鑰協議機制之研究與實現 
On the Study and Implementation of the Authenticated Key Agreement for Wireless Networks 
 
計畫編號：NSC 95－2221－E－274－012 
執行期間：95 年 8 月 1 日至 96 年 7 月 31 日 
計畫主持人：李永振 
共同主持人：郭文中、張耿魁 
計畫參與人員：唐放之、馮佑玄、鍾旻憲、朱榮祿 
 
一、 前言 
資訊安全為網路應用之一重要技術。透過密碼技術使在公開網路上傳送之資訊，達到
私密性、完整性與不可否認性之需求。密碼技術包括對稱金鑰密碼系統(symmetric key 
cryptosystems)與非對稱金鑰密碼系統(asymmetric key cryptosystems)。對稱金鑰密碼系統如
DES或AES，發送者與接收者分享一相同之私密金鑰，它具有資料處理快度之優點，但亦
有金鑰分配較困難與金鑰過短易被猜中之缺失。非對稱金鑰密碼系統亦稱公開金鑰密碼系
統(public key cryptosystems)，公開金鑰密碼系統中之每一使用者均擁有公開金鑰(public key)
與秘密金鑰(private key)等一對金鑰。公開金鑰密碼系統如RSA與橢圓曲線密碼系統等，具
有較長金鑰且金鑰分配較簡單之優點，但需耗費較大之儲存空間與較長之運算時間。 
公開金鑰密碼系統中秘密金鑰需妥善保管，公開金鑰可公開供他人取用。公開金鑰雖
為公開資訊，但應確保其正確性。若使用錯誤之公開金鑰進行加密，則接收者將無法解密；
且可能因使用不當之公開金鑰，致使秘密資料遭攻擊者破解之危險。因此如何保護公開金
鑰使其不被更改與替換，為公開金鑰系統中非常重要之技術。 
公開金鑰基礎建設(public key infrastructure, PKI)提供一個平台，供使用者方便安全地
使用公開金鑰密碼系統。公開金鑰基礎建設中設立許多階層式認證中心(certification 
authority, CA)，認證中心對使用者之公開金鑰進行簽章，可確保公開金鑰之正確性。X.509
即為公開金鑰基礎建設標準之一，透過公開簽署之金鑰憑證(certificate)提供安全的金鑰分配
與通信。 
許多場合如一般簡易網路系統、緊急救難或戰場中，無法擁有健全之公開金鑰基礎建設
供使用者應用，使用者間僅共享通行碼(password)而已。不幸地，為記憶方便使用者通常選
取甚短之通行碼，致使無法安全地以此通行碼進行加解密或簽章。因此通常以此通行碼進
行認證(authentication)與金鑰分配(key distribution)工作，待認證與金鑰分配成功，始以公開
金鑰進行加解密或簽章程序。由於公開金鑰系統之金鑰較長，攻擊者甚難有效破解，故可
進行安全通信。若能適當地結合非對稱金鑰密碼系統與公開金鑰密碼系統，則將有效改善
金鑰分配之不便並提升運算速度，確保資訊安全。 
以通行碼進行認證與金鑰分配時，若系統設計不當，則可能易受猜測攻擊(guessing 
attack)、竄改攻擊(modification attack)或重送攻擊(replay attack)等等威脅[1,2]。因通行碼甚
短，故對於猜測攻擊之威脅甚大。猜測攻擊可分為即時(on-line)與離線(off-line)攻擊二種。
與 H(ID, PKS, PW) 送還給使用者。 
使用者收到後若驗證成功，伺服器與使用者之間即可以公開金鑰方式進行通信。原通
行碼即應予作廢，另行產生新的通行碼並用公開金鑰方式進行金鑰分配。爾後若公開金鑰
受某種原因失效或有安全疑慮時，即可依同樣方式再進行新的公開金鑰交換程序。完整之
流程如圖1。 
 (二) 第三種方法： 
在第三種公開金鑰分配機制中，作者企圖利用亂數以提高其安全性。此機制如下： 
1. 使用者先產生一亂數 RC，並產生金鑰對 PKC 與 SKC，計算 H(ID, PKC, PW, RC)，再將 
ID、PKC 與 H(ID, PKC, PW, RC) 傳送給伺服器。 
2. 伺服器端收到信息後，因不知 RC 故無法進行驗證。此時先產生一亂數 RS 並計算 H(ID, 
PKS, PW, RS)，再將 ID、PKS 與 H(ID, PKS, PW, RS) 送還給使用者。 
3. 使用者收到後亦無法進行驗證。將亂數 RC 用伺服器之公開金鑰 PKS 加密後，傳送給伺
服器。 
4. 伺服器收到後即可解得 RC，藉此即可檢驗步驟1收到信息之正確性。若正確無誤，同法
將亂數 RS 用使用者之公開金鑰 PKC 加密，再傳送給伺服器。 
⎯⎯⎯⎯⎯⎯⎯⎯ ⎯←
⎯⎯⎯⎯⎯⎯⎯⎯ →⎯
⎯⎯⎯⎯⎯⎯⎯⎯ ⎯←
⎯⎯⎯⎯⎯⎯⎯⎯⎯ →⎯
)(,
)(,
),,,(,,
),,,(,,
SC
CS
S
C
RePKID
RePKID
RPWPKsIDHPKsID
RPWPKcIDHPKcID
伺服器端使用者端
圖2、Peyravian等學者所提之第三種金鑰分配機制 
5. 使用者收到後解得 RS，再依此驗證於步驟 2 收到之信息是否正確性。驗證成功後，伺
服器與使用者之間即可以公開金鑰方式進行通信。完整之流程如圖2。 
攻擊方式分析 
Peyravian等人所提之第一與第三種機制，均易受離線猜測攻擊，說明如下： 
(一) 第一種方法之猜測攻擊 
第一種方法之極易遭受離線猜測攻擊。雖然作者假設系統之通行碼 PW 甚長，不易
遭受猜測攻擊。但一般系統使用者為記憶方便，通常選用較短之通行碼，故實際上系統易
遭受即時與離線猜測攻擊。離線猜測攻擊方式說明如下： 
由步驟 1 當攻擊者截獲 ID、PKC 後，即可以離線方式嘗試猜測通行碼 PW，並由接
收之 H(ID, PKC, PW) 之值，可驗證是否猜測成功。當攻擊者猜中通行碼 PW後，即可仿冒
使用者登入系統。攻擊方式說明如圖 3。 
 (二)第三種方法之猜測攻擊 
 3
1. 使用者C計算首先選擇一個位元長度大於128之亂數 並計算 後，將  傳送給
伺服器。 
Cx Cxg CxgPW ⊕
2. 因為 ，故伺服器可由PW解得 。伺服器選擇另一個大的亂數 並
計算 後，將公鑰 和 傳送給使用者。 
CC xx gPWgPW =⊕⊕ )( Cxg Sx
Sxg sPK ),(, SCS xxs
x gPKhgPW ⊕
 5
xx
3. 使用者用其PW即可解得 ，並由 即可驗證伺服器是否正確。若驗證不成功
系統即要求伺服器重送或使程序停止。驗證成功後使用者傳送自己的公鑰
, 給伺服器。伺服器收到後透過 即可驗證使用者。若驗證無
誤，二者即可以公開金鑰系統方式進行認證或通信。當然若系統需要，雙方亦可使用
作為對話金鑰(Session key)。系統說明如下圖： 
Sxg ),( SC xxs gPKh
cPK ),( SC xxc gPKh ),( BA
xx
c gPKh
SCgK =
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ →⎯
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ ⎯←
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ →⎯
⊕
⊕
),(,
),(,,
.3
.2
.1
SelectSelect
SxCx
CC
SxCx
S
Sx
S
Cx
gPKhPK
gPKhgPWPK
gPW
SC xx
伺服器端使用者端
圖5、能抵抗猜測攻擊之改善機制 
四、安全性分析 
本機制達到安全認證與安全金鑰協議之需求，說明如下： 
1. 假設入侵者欲仿冒使用者登入系統。 
由於入侵者不知通行碼PW之值，若他於步驟1中任意選擇一亂數 X 送給伺服器，伺服器
將求出 ，並將於步驟2中傳送 給入侵者。由於入侵者
缺乏正確之通行碼致無法解出 亦無法驗證 。入侵者將無法於步驟3中
送出正確之 供伺服器驗證，因此伺服器收到步驟3之信息後將拒絕
其登入。即入侵者將無法成功仿冒使用者登入系統。若入侵者欲設法猜測通行碼，成功
猜中通行碼登入系統之機率僅為
PWX ⊕ ))(,(,, SS xsxs PWXPKhgPWPK ⊕⊕
Sxg ))(,( Sxs PWXPKh ⊕
)})(,(,{ SxII PWXPKhPK ⊕
PWP −= 2 ，其中 PW 為通行碼之位元長度。 
2. 假設入侵者欲仿冒伺服器與使用者通信。 
由於入侵者不知通行碼PW，無法自步驟1中所截獲之資料 獲得正確之 。缺乏正
確之 ，入侵者將無法於步驟2中仿冒伺服器，傳送正確之資料與 給使用者。
入侵者成功猜中通行碼以仿冒伺服器之機率仍僅為
CxgPW ⊕ Cxg
Cxg ),( SC xxs gPKh
PWP −= 2 。 
3. 假設入侵者欲進行中間人攻擊。 
 7
可供推廣之研發成果資料表 
□ 可申請專利  □ 可技術移轉                                      日期： 年 月 日 
國科會補助計畫 
計畫名稱：具認證功能無線網路金鑰協議機制之研究與實現 
計畫主持人：李永振         
計畫編號：NSC 95－2221－E－274－012           
學門領域：EA(資訊學門一) 
技術/創作名稱 無線網路認證與金鑰協議機制 
發明人/創作人 李永振 
中文： 
金鑰協議為網路安全應用之一重要機制。公開金鑰基礎建設為提供
安全之網路認證與金鑰交換之重要平台。但公開金鑰基礎建設之系
統甚為複雜與龐大，且若干場合無法提供完整之基礎建設，各使用
者或伺服器間可能僅共享通行碼。故如何有效運用通行碼進行安全
認證與金鑰交換，為一重要之課題。作者提出一種無須公開金鑰基
礎建設之無線網路安全認證與金鑰分配機制，此機制能抵抗猜測攻
擊、仿冒攻擊與中間人攻擊，且同時具有公開金鑰與對話金鑰協議
之功能。 
 
技術說明 
英文： 
Cryptosystems provide variety of secure mechanisms for networks. 
Among them, key agreement mechanism is an important technique to 
ensure network security. Through public-key infrastructure (PKI), key 
agreement can be performed successfully and easily. However, in 
many cases such as ad-hoc network that there has no PKI supported, it 
is need to develop an efficient and secure key agreement mechanisms
for wireless network systems. In this project, we propose a new 
authenticated key agreement mechanism for wireless non-PKI 
environment. The developed protocol is secure and that not only 
provides key distribution for symmetric/asymmetric key systems, but 
also provides users authentication. The protocol can resist guessing 
attack, masquerade attack and man-in-the-middle attack. 
 
可利用之產業 
及 
可開發之產品 
資訊產業 
網路認證與金鑰管理技術機制 
