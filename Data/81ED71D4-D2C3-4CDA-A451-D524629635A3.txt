 1 
行政院國家科學委員會專題研究計畫成果報告 
一般化圖案取代之無失真資料隱藏技術及其應用之研究 
A Study on Reversible Image Steganography with  
Generalized Pattern-Substitution Schemes and Applications 
 
計畫編號: NSC99-2221-E-328-001 
執行期限:99 年 8 月 1 日至 100 年 7 月 31 日 
計畫主持人:吳美宜 副教授 國立高雄餐旅大學 圖書資訊館 
 
 
一、中文摘要 
  無失真資料隱藏技術，或稱為可
回復式、可逆式(reversible)資料隱藏技術，
是將隱藏在偽裝影像中的機密資訊取出後，
還能夠無失真的還原回原始影像的資料隱
藏技術，該技術可使用於某些不容許影像
失真的特殊應用，例如在醫學影像(如X
光片、核磁共振影像等)、軍事用途上，
用於診斷或情資研判等或是執法人員的搜
證資料方面等。無失真資料隱藏必須能夠
完整地還原回原始影像，所以其嵌入的資
料除了機密訊息外，為了記錄還原所需的
資訊，可能還需要嵌入一些額外資料
(Extra Data)。而取出資料的流程是先將偽
裝影像的特徵值進行分析，取出機密資訊
與額外資料後，再利用演算法的設計與額
外資料記錄的配合，進行無失真的還原回
原始掩護影像。 
過去十多年來，有關資料隱藏技術的
研究，大多數論文都只是提出新的資料隱
藏技術與演算法，只有少部份論文落實到
實際的應用，本研究的目的是針對我們所
要解決的兩個應用問題，提出相對應的無
失真資料隱藏技術之解決方案。 
 
關鍵字：圖案取代資料隱藏法、無失真資
料隱藏、半色調影像、影像保護、影像回
復 
 
二、本計畫之研究問題與研究成果 
研究問題一：具存取品質控制的彩色影
像保護問題(color image protection) 
    部份學者近年來陸續提出彩色影像保
護的機制，認為數位內容的提供者可以提
供不同等級的品質內容來行銷，這種行銷
策略是允許非法使用者取得某種較低品質
的數位內容，而只有合法使用者可以取得
完全品質的數位內容。換句話說，這樣的
目的是故意以較低品質的數位內容商品免
費贈送或推銷給潛在的顧客，雖然所提供
的樣品屬於較低品質的內容，卻已經能引
起顧客興趣轉而購買，以取得較高品質的
數位內容商品；另有學者進一步提出具存
取品質控制的模式，讓數位影像販售的商
家，可以提供多種不同品質的彩色影像當
作偽裝影像。在此計畫中，我們針對一般
灰階影像，以及具存取品質控制的方式，
提出新的影像保護方法，使得影像保護的
目的更加完備。這一部分目前共發表一
篇 國 內 英 文 期 刊 論 文 (Journal of 
Computers)與一篇國內研討會論文(資訊
管理學術研討會ICIM)如附件1、附件2。 
 
研究問題二：半色調影像還原為灰階影
像(inverse halftoning) 
    所謂inverse halftoning的過程是將半
色調影像轉換回灰階影像的過程，由於經
半色調過程後所得到的影像為二元影像，
只有原灰階影像八分之ㄧ的資訊量，因此
無法完全回復原影像，針對此一問題，最
常用Look-Up Table(LUT)方法或是使用濾
波器來進行還原處理。若直接使用低通濾
波器(如高斯濾波器)，所還原回來的影像
品質，約為30dB左右，若使用LUT的方
 3 
        的容量與偽裝影像品質符合期望，
結束流程，輸出圖案大小與配對圖 
        案；否則重新執行步驟二，尋找
下一個高頻圖案與其配對圖案。 
－圖案定義與設計(Pattern Design) 
    所提出的新方法，是根據直方圖調整
觀念而來，針對一張灰階影像，我們將影
像分割成m n 個區塊 u，區塊中每個像
素取 a 個位元平面來組合，將m n a  個
bit 組合成一個新的值組，定義為所謂的
圖案(pattern)，我們希望所定義的圖案所
形成的統計直方圖，最好有一些較高的波
峰，以及一些頻率為零的波谷，以利我們
利用配對來進行無失真資料隱藏。 
首先我們以 C. Shannon 信息理論來探討
一般影像，我們可以使用熵 (Entropy) 來
計算使用各種不同區塊的資訊量，熵 
(Entropy)的值愈大表示資訊量愈大，而我
們可以作資料隱藏的量也就愈少。公式為 
      2
1
1
log
n
i
i i
in fo p
p
             
先來看看一般影像的 8 個位元平面所代表
的意義，將 Lena 以 8 個位元平面表示，
如下圖所示，最後三個位元平面幾乎全為
亂數，具有很高的熵值，代表可以再壓縮
的空間極小，因此若只使用最小三個位元
平面來定義圖案，可想而知，每一種圖案
的組合出現的次數會差不多，如此所形成
的統計直方圖中，沒有明顯的波峰(高頻
率)存在，無法做有效的無失真資料隱藏。 
圖二、Lena 的 8 個位元平面，由最高位
元平面到最低位元平面(a)-(h) 
 
為了使所定義的圖案所形成的統計直方圖
具有波峰與零點，我們將研究兩種方法的
圖案內容設計以決定m n a  的圖案區塊
該怎麼選擇，詳細說明如下： 
 
－ 拓 展 圖 案 種 類 的 方 法 (pattern 
substitution method) 
    原始 Ni 的方法，以每個像素為單位，
所以其圖案種類只有 256 種(即 256 種灰
階值)，我們要能拓展圖案種類，使得零
點的可能性增加。比如使用3 3 區塊，從
MSB 到 LSB 各取一個 bit 輪流去作實驗
並且計算各個位元的熵 (Entropy)值，如
此就有 512 種可能的圖案，但是要取 8 個
位元中，哪一個位元平面較合理呢？ 如
表一所示，以 Lena 影像為例，位元的選
擇需要到第 3-4 個位元平面時，才可能產
生多個重複圖案與零點圖案，但是選擇越
重要位元(MSB)，雖然可以得到越多重複
圖案與零點圖案，但是當執行圖案取代的
資料隱藏時，相似圖案間的距離越大(因
為是高位元)，造成的品質誤差越大。 
 
表一、各種位元平面熵 (Entropy)值 
 
我們作一個簡單實驗，若 2 2 個像素組
成一個區塊  1 2 3 4, , ,u u u u u ，若區塊中
每個像素再各取 3 bit 作組合，就會產生
一個新的 12 bit 值組，如此就有 4096 種
可能的圖案，我們計算各種取法的熵 
(Entropy)來作選擇的參考，選擇位元的組
 5 
次數低群中，圖案較為相似作為配對，總
計挑選 10 組配對，然後存入 Look-up 
Table(LUT)中，接著以區塊大小掃描整張
圖，若遇到LUT上的圖案，與LUT中的高
頻圖案hi相同，則紀錄0，與LUT中的低
頻圖案hi’ 則紀錄1，最後輸出這些位元
序列，進行無失真壓縮，壓縮後的結果與
欲藏入的秘密訊息串接起來，轉換成為藏
入的位元流 (bit stream) ，再透過 pair 
toggling的方式將位元流藏入半色調圖中。 
另外，在抽取資料時，先解壓之藏入的壓
縮序列資料，掃描整張圖，依照LUT的定
義，更正相對應的圖案，最後即可還原為
原半色調影像，完成無失真資料隱藏的抽
取動作。 Pan等人方法，大約可以在
512×512影像中，藏入1000位元左右而維
持還不錯的品質。但是這個數量在某些應
用上卻顯不足；另外所使用的方法中，圖
案變化序列必須壓縮後藏入圖中(以利抽
取後，解壓縮後還原)的方式，當壓縮率
很低時，會導致整體可以藏入的量變的更
少。為解決此問題，我們根據圖案取代與
直方圖位移的觀念來修改Pan等人的方法，
所提出新的方法，如下節說明。 
 
－所提出基於圖案取代之無失真半色調影
像資料隱藏方法 
    上述方法可藏的容量少的原因，主要
是所使用的圖案大小為4×4，圖案可能的
組合有65536種，在一張512×512的影像
中，只有262144個點，切成4×4後，只有
16384個圖案，因此即使有一些圖案出現
頻率較高，其值亦不大，因此在所提出的
方法中，我們選用3×3大小的圖案，如此
可 能 的 圖 案 組 合 為 512 個 ， 而 一 張
512×512影像中，可有28900個圖案。因
此我們以3×3大小的視窗來掃描Lena影像，
所得到的直方圖如下：X軸為圖案編號
1..512，Y軸為各個圖案的出現次數。 
 
 
圖六、Lena半色調影像之圖形直方圖(3×3
大小圖案) 
 
表三、可藏入 LUT 容量與最大隱藏量 
Images 
樣本 LUT
組數 
最大可隱藏容量
(bit) 
Lena(26317bit)* 4x4 995 26330 
Lena(5146bit) 3x3 290 26330 
Pepper(26575) * 4x4 1005 26585 
Pepper(4995) 3x3 279 26585 
Airplane(24985) * 4x4 974 24999 
Airplane(6706) 3x3 386 24999 
Baboon(9541) 4x4 380 9544 
Baboon(8315) * 3x3 469 9544 
 
其中波峰值為1027，零點個數有132個。
會產生零點的原因為半色調影像在灰階轉
二原圖過程中，利用能量擴散的方式，所
以容易產生固定的圖案，另外我們也實作
其他常見影像包含 Pepper 、 Baboon 、
Airplane等影像的半色調圖，幸運的所得
的情形類似(參考表三)。說明以圖案取代
之半色調資料隱藏技術容量方面的可行性。 
    根據所討論之圖案取代之資料隱藏技
術執行步驟，我們修改成半色調影像資料
隱藏方法，初步的演算步驟如下： 
步驟一、定義圖案的大小與內容，將所形
成的圖案的組合依照圖案在影像中出現的
次數，計算每種圖 
        案組合的出現頻率。  
步驟二、依照出現頻率大到小的順序，利
 7 
復的品質。演算法的過程如下，O 為原始
的半色調影像，F 為 Flipping 的影像，
'H 為半色調偽裝影像，MP1 為出現次數最
高的樣板，TMPl為 MP 出現的頻率，SP1出
現次數最少的樣板，TSPl 為 SP 出現的頻
率，SPBl 為 SP1 轉換為位元流的樣本資
訊： 
1. 根據 Flipping 的公式，先將原始
的半色調影像 O 轉換為 Flipping
的影像 F。 
2. 將影像 F 以連續性不重疊的 4*1
方式進行影像切割。 
3. 計算所有樣板出現的頻率，並
根據樣板中 1 出現的次數進行
分群，若 1 出現的次數為奇
數，則為奇數群；反之則為偶
數群。 
4. 找出出現次數最高的樣板 MP1，
出現的頻率為 TMPl，並在相同
群組中找出出現次數最少的樣
板 SP1，出現的頻率為 TSPl。 
5. 將影像 F 中，樣板為 SP1取代為
MP1，並將 SP1樣本在影像 F 中，
全部出現的位置(x,y)與 SP1 轉
換為位元流(bit stream)SPBl，
作為在擷取資料時，將半色調
影像回復的依據。 
6. 以水平掃描影像F中所有樣板區
塊，若區塊中的樣板為MP1，且
要隱藏的數值為0，則維持原本
樣板MP1；若要隱藏的數值為1，
則將樣板取代為SP1。 
7. 最後，當完成資料隱藏後，我
將影像 F 執行反 Flipping 運算，
如公式(1)所示，最後將轉換後
的半色調影像 'H 輸出。 







)1,('),(
),1('),(
),(
),('
ijHjiF
ijHjiF
jiF
jiH  
otherwise
iandjif
iandjif
11
11


            (1)
 
 
在執行 FPS 演算法時，我們考慮到配
對的樣本不能進行資料隱藏的情形，以公
式(2)計算。 lDEC  為此配對的可隱藏
量，我們為了要能無失真的回復半色調影
像，所以需記錄下 SP1 的資訊，故每一組
SP1 需記錄在影像中的位置，此處以
512*512 的影像為範例，故需要 16 bits
進行隱藏，另外 4 bits 為 SP1 樣板資
訊。在完成 lDEC 計算後，若 0lDEC  
則代表此組配對可以被用來進行資料隱
藏；反之則不行。  
)416*()(  llll TSPTSPTMPDEC                 
(2)
 
 
表四、以 Lena 為例的樣板出現頻率，透
過公式(2)計算，我們可得知，兩個樣板
群組中，不僅僅只最高頻率的樣板才能進
行配對，其他出現頻率較高的樣板，若與
該群組中出現頻率較少的樣板做配對，仍
可增加隱藏量。以此表為例，共有四組組
合可以被使用來進行資料隱藏，但考慮隱
藏後半色調影像的品質，假如我們使用越
多組配對進行隱藏，便會使得隱藏後半色
調影像的品質降低，所以此處需以隱藏後
半色調影像的品質優先考慮。公式(3)為
總隱藏量的計算，TP為使用的組數。 




1
0
Tp
i
iDECTDEC  
(3) 
 
 
 
 9 
轉換為半色調影像。因此，在擷取的過程
中，此方法先將隱藏的資訊擷取出，接下
來將 Flipping 影像還原，並透過公式將
原始半色調影像還原。 
 
圖九、FPS 的半色調影像回復範例 
 
 
圖十、FPS 半色調影像回復範例 
 
 
 
 
 
 
 
 
 
四、實驗結果 
表五與表六為本計畫所研究的方法與其他
學者所做的比較，很明顯地，所提出的方
法確實改善了半色調影像回復影像之品
質。 
 
表五、其他學者所提出的半色調影像回復
方法之影像品質 
Images 
PSNR(dB) 
Gaussian  LIH ELIH 
Lena 29.40 27.53 28.54 
Pepper 29.30 27.33 29.29 
Airplane 28.29 26.94 28.05 
Baboon 22.22 22.35 22.22 
 
表六、本研究所提出的半色調影像回復方
法之影像品質 
Images 
PSNR(dB) 
隱藏量(bit) 
半色調 
資料隱
藏
(DMM) 
半色調 
資料隱藏
(QIM) 
基於 LUT 
資料隱藏 
合併
DWT 與
LUT 資料
隱藏 
FPS 
資料隱藏 
Lena 51.10 55.44 
30.11 
(26330) 
30.38 
(26330) 
30.61 
(27849) 
Pepper 51.13 
52.16 
30.72 
(26585) 
32.22 
(26585) 
32.42 
(26612) 
Airplane 51.01 55.81 
29.75 
(24999) 
31.41 
(24999) 
30.60 
(14849) 
Baboon 51.14 52.92 
23.99 
(9544) 
22.63 
(9544) 
22.58 
(6912) 
 
 
 
 
 
 
 
 11 
議主席針對本人報告提出幾個問題，包含影像實際應用的可行性等討論。 
與會心得  
  關於這次研討會的地點，位於海德公園附近的倫敦帝國學院，倫敦交通十分發達，
該區的交通十分方便，由於所落腳的旅館在機場附近郊區，所以必須經由火車、地
鐵再步行20分鐘，倫敦市市民水平很好，問路時常得到相當有禮貌的回答與幫助。
會議地點必須經過物理系教師研究室，這些老舊建築並不起眼，其間有些教授研究
室的門是敞開的可以看見研究室內空間格局並不大，但是白板上密密麻麻是數學公
式的推導，可知該校學術研究的扎實，讓人聯想到目前該校有十四位諾貝爾得主在
校任教，並非浪得虛名。 
  這次研討會論文報告獲得Certificate of Merit的論文獎(附件5)，十分開心，本次與
會十分感謝國科會的補助，使本人有機會走向國際接觸相同領域的學者，互相交流
與討論，增進專業領域的視野以及深度。 
 
 
攜回資料 
  會議論文光碟片一片，研討會論文如附件4。 
 
 
  
Color Image Protection with Palette Information Embedded into Its 
Grayscale Image 
Jia-Hong Lee1,* and Mei-Yi Wu2 
 
1 Department of Information Management 
National Kaohsiung First University of Science and Technology 
 Kaohsiung 811, Taiwan, R.O.C 
jhlee@ccms.nkfust.edu.tw  
2 Department of Information Management  
Chang Jung Christian University  
Tainan 711, Taiwan, R.O.C 
barbara@mail.cjcu.edu.tw 
Received 6 March 2009; Revised 2 April 2009; Accepted 5 April 2009 
Abstract. In this paper, a novel reversible data hiding scheme with color replacement is proposed to embed 
the palette information of a palette image into its corresponding grayscale image. Two different qualities of 
images can be provided with the proposed scheme. They are the marked grayscale image and the original pal-
ette image, one for free access, and another for limited access, respectively. The proposed method reordered 
the palette colors of the image according to their occurrence frequencies and then repeated performing a pal-
ette color replacement procedure to embed the palette information into the grayscale image. Consequentially, 
we can reconstruct the palette image by extracting the embedded information from the marked grayscale im-
age. The performance of the proposed method is demonstrated by showing the good qualities of both the 
marked and the rebuilt images.  
Keywords: reversible data hiding, color image protection, palette color replacement  
 
References 
[1]  J.S. Pan, H.C. Huang, L. C. Jain, W.C. Fang, Intelligent Multimedia Data Hiding: New Directions, Springer, Berlin-
Heidelberg, Germany, 2007.  
[2]  H. J. Shim, J. Ahn, B. Jeon, “DH_LZW : Lossless Data hiding in LZW Compression,” IEEE International Conference 
on Image Processing, Vol. 4, pp. 2195-2198, 2004.  
[3] H. Liu, Z. Zhang, J. Huang, X. Huang, Y.Q. Shi, ”A High Capacity Distortion-free Data Hiding Algorithm for Palette 
Image”, IEEE International Symposium on Circuits and Systems, Vol. 2, pp. 916-919, 2003.  
[4] Z. Ni, Y.Q. Shi , A. Ninvan, S. Wei, S. Qibin, L. Xiao,” Robust Lossless Image Data Hiding”, IEEE International Con-
ference on Multimedia and Expo, pp. 2199-2202, 2004.  
[5]  J. Fridrich, M. Coljan, R. Du, “Distortion-free Data Embedding for Images,” in Proceedings of 4th Workshop Informa-
tion Hiding, Vol. 2137, Springer-Verlag, New York, pp. 27-41, 2001.   
[6]  Z. Ni, Y.Q. Shi, N. Ansari, W. Su, “ Reversible Data Hiding,” IEEE Transactions on Circuits and Systems for Video 
Technology, Vol. 16, No. 3, pp. 354-362, 2006. 
[7] C.C. Lin, W.L. Tai, C.C. Chang, “Multilevel Reversible Data Hiding Based on Histogram Modification of Difference 
Images”. Pattern Recognition, Vol. 41, No. 12, pp. 3582-3591, 2008. 
                                                          
*Correspondence Author   
利用可逆式資料隱藏技術於彩色影像保護機制之研究
 
李嘉紘 
國立高雄第一科技大學資訊管理學系 
jhlee@ccms.nkfust.edu.tw 
柳冠宇 
國立高雄第一科技大學資訊管理學系 
u9625811@ccms.nkfust.edu.tw 
 
摘要 
 
近年來隨著電腦與網路的普遍
化，數位資料逐漸被大量的使用，因
此衍生出數位資料保護的問題，而許
多相關的研究也針對此問題相繼被提
出。本文提出一個可逆式資料隱藏方
法實做彩色影像的保護機制，方法是
將彩色影像的色彩資訊藏入相對應的
灰階影像中，再藉由合法的金鑰抽取
色彩資訊以重建彩色影像。使用此方
法可產生二種不同品質的影像，分別
為彩色影像與灰階影像，其中灰階影
像可以自由取得，而僅有授權的使用
者可從灰階影像重建出彩色影像。此
方法主要有二個步驟，第一是色彩編
碼(轉換色盤顏色資訊為相對應灰階索
引值)，並產生灰階的索引影像，第二
是資料隱藏(將色彩資訊使用可逆式資
料隱藏方法藏入灰階索引影像中)。實
驗結果證實我們可以從偽裝灰階索引
影像重建彩色索引影像，而主要的失
真是在全彩影像轉換成彩色索引影像
的過程，在資料隱藏與擷取的過程並
不會造成彩色索引影像的失真，並且
在資料隱藏過程中，偽裝影像也提供
了良好的品質與容量。 
關鍵詞：可逆式資料隱藏、彩色影像
保護、差值影像、灰階影像。  
1. 前言 
 多媒體安全技術在近幾年逐漸被
重視，但是這些研究大多為技術的探
討，實際的應用較為少數，而本文提
出彩色影像保護的保護機制，我們提
供二種品質的影像，其中低品質的影
像可以自由取得，而高品質影像必須
是授權的使用者才可由低品質重建。
我們提出的方法建立在可逆式資料隱
藏技術上，一張灰階影像可以自由取
得，但僅有授權的使用者可以重建彩
色影像，主要的目的是藉由可逆式資
料隱藏技術，將色彩資訊藏入灰階影
像中以保護彩色影像。 
為了使灰階影像藏入色彩資訊，
首先要將彩色影像色盤索引值對應到
灰階影像，再將色彩資訊藏入灰階索
引影像中，如此就可產生二種不同品
質的影像，並且可由灰階索引影像重
建彩色索引影像。 
以一個販售彩色影像的網站為
例，對彩色影像的保護機制的架構如
圖 1 所示，彩色影像隱藏至灰階影像，
首先需要將 24 位元全彩影像轉換成
256 色彩色索引影像，在本文我們使用
色彩量化的演算法[14]，色彩量化後把
彩色索引影像對應轉換成灰階影像，
最後將色彩資訊藏入偽裝灰階影像
中，使用者從網站下載到偽裝灰階影
顏色的更換以嵌入訊息到灰階影像
中，此方法為可逆式調色盤資料隱藏
技術，除了所產生的偽裝灰階影像品
質較好之外，所回復的256彩色影像為
無失真的影像。但是使用此方法，灰
階影像必須是調色盤影像的格式，不
適用於一般灰階影像。 
 
 
圖3：色盤顏色更換方法 
資料來源：Lee et al.[8] 
 
2 可逆式資料隱藏  
 可逆式資料隱藏又可稱為無失真
資料隱藏，是將隱藏在偽裝影像中的
機密資訊取出後，還能夠無失真的還
原回原始影像的資料隱藏技術，該技
術可使用於某些不容許影像失真的特
殊應用，如醫學、法律、軍事及其他
須維持原始資料的影像等，而可逆式
資料隱藏技術與一般資料隱藏技術的
不同點在於，可逆式資料隱藏必須可
完整還原回原始影像，所以其嵌入的
資料除了機密訊息外，為了記錄還原
所需的資訊，可能還需要嵌入一些額
外資料。 
 近年來，一些可逆式資料隱藏技
術已經陸續被發表，第一個方法首先
由 Honsinger [1] 等人所提出。另外其
它可逆式資料隱藏技術，主要有以最
低位元無失真壓縮為基礎[3,4,12,13]，
以差值擴張為基礎[6,7]，以及本文使用
以直方圖操作為基礎的方法[15,16]。 
 Ni[16]等人提出灰階統計直方圖
操作的方法，透過灰階值出現頻率最
高的峰點(Peak Point)，與出現頻率最
低的空點(Empty Point)，來做取代以達
到可逆式資料隱藏的目的，如圖 4。此
方法有偽裝影像品質佳以及容量大的
優點，但是偽裝影像的灰階直方圖容
易有波谷(Valley)的產生如圖 5 所示，
而偽裝影像的灰階值統計直方圖容易
讓瞭解此概念人產生懷疑。 
 
圖 4：灰階直方圖的峰點與空點 
 
圖 5：Ni[16]方法直方圖產生的波谷 
 為了改善這個問題，Lee[15]等人
入流程如圖 8 所示。 
 
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
圖 8：資料嵌入流程 
 
 
 
 
 
 
 
圖 9：差值影像直方圖 
 
針對灰階編碼影像的特性，若要
在M N× 大小的灰階編碼影像 ( , )f i j′
嵌入資料，提出的可逆式資料隱藏方
法依照下列幾個步驟： 
步驟 1. 建立差值影像 D(i,j)：取二個
像素為一單位，D(i,j)大小為
/ 2M N× 。 ( , )f i j′ 與 ( , 1)f i j′ +
分別為前像素與後像素。 
 
D ( , ) ( , ) ( , 1)i j f i j f i j′ ′= − +        (2) 
步驟 2. 統計差值影像直方圖：將差值
影像 ( , )D i j ，-255 至 255 值統
計為直方圖，如圖 9。 
步驟 3. 直方圖平移：將 ( , )D i j 大於等
於 1 的每一單位的前像素+1，
如公式(3)，考慮溢位問題，若
前像素等於 255 則改為後像素
-1，如公式(4)，並紀錄該單位
資訊為額外資料。如此，產生
掩護差值影像 ( , )D i j% 。 
 
( , ) ( , ) ( , 1)
( , ) 1 ( , ) 1
( , )
( , )
D i j f i j f i j
f i j if D i j
f i j
f i j otherwise
′ ′= − +
′ + ≥⎧ ⎫′ = ⎨ ⎬⎩ ⎭
%%
%        
           
(3) 
 
( , ) ( , ) ( , 1)
( , 1) 1 ( , ) 1
( , 1)
( , 1)
D i j f i j f i j
f i j if D i j
f i j
f i j otherwise
′ ′= − +
′ + − ≥⎧ ⎫′ + = ⎨ ⎬+⎩ ⎭
%%
%        
           
 
(4) 
步驟 4. 嵌入隱藏資訊：將色盤的 6144 
bits 色彩資訊，與溢位的額外
資料轉成二元資料 w 藏入掩
護影像中，若 ( , )D i j% =0 表示
可藏入資料，藏入方法如式(5)
所示，考慮溢位問題，若
( , )D i j% =0 但
( , )f i j′% = ( , 1)f i j′ +% =255 的話
則該單位略過不做動作，最終
產生偽裝影像 ef 。 
( , ) 1 ( , ) 0 1
( , ) ( , ) 0 0
i
w
i
f i j if D i j and w
f
f i j if D i j and w
⎧ ⎫′ + = =⎪ ⎪= ⎨ ⎬′ = =⎪ ⎪⎩ ⎭
% %
% %
        
            
                 (5) 
 此方法可以提供良好的品質與資
像素，分別為圖 11(a) Lean，圖 11(b) 
Baboon，圖 11(c) Peppers。首先進行的
色彩量化的彩色索引影像如圖 12，色
彩對應後的灰階索引影像如圖 13，偽
裝影像如圖 14，以及還原重建的彩色
索引影像如圖 15，其他影像的實驗結
果分別展示在圖 16、圖 17。 
另外，灰階索引影像與偽裝影像
灰階值統計直方圖，如圖 18 所示，我
們很難從裡面發覺有秘密資訊的存
在。 
 
(a) 
 
(b) 
 
(c) 
圖 11：24 位元全彩影像 a)Lena、
b)Baboon、c)Peppers。 
 
圖 12：彩色索引影像 
 
圖 13：灰階索引影像 
 最後我們使用 PSNR 值衡量偽裝
影像的品質，實驗結果證實我們提出
的方法皆有超過 54dB，更有高達 55dB
的水準，另外扣除額外資料量後，可
以隱藏的資料量至少達 17,820 bits，足
夠藏入 6,144 bits 的色盤資訊，相關實
驗結果如表 1 所示，另外計算重建的
彩色影像與原始全彩影像的 PSNR
值，與其他方法的比較如表 2 所示。 
 
表 1：實驗結果數據(灰階索引影像、
偽裝影像) 
Images 
PSNR 
(dB) 
Capacity 
(bits) 
Overhead 
(bits) 
Pure 
capacity(bits)
Lena 55.01 26,494 45 26,449 
Baboon 54.52 18,873 1,053 17,820 
Peppers 54.97 31,127 3,357 27,770 
表 2：Baboon 影像實驗結果與其他方
法比較(原始彩色影像、重建彩色影像) 
Method PSNR(dB) 
Chaumont[9] 32.89 
Chaumont[10] 35.86 
Proposed 41.91 
5 結論  
 在本文中，我們提出一個可將彩
色影像轉換成灰階影像，並且可以回
復的方法，該方法主要分為二個部
份，色彩對應與資料隱藏，色彩對應
利用彩色影像亮度值作對應以轉換成
灰階影像，而資料隱藏部份利用可逆
式資料隱藏技術將色盤資訊隱藏在灰
階影像中。 
 實驗結果證實，色盤資訊可以隱
藏在灰階索引影像中，藉此可以重建
的彩色索引影像，並且偽裝影像有高
度的視覺品質，以及大量的資料隱藏
空間足夠藏入色盤資訊。 
參考文獻  
1. C. W. Honsinger, P. Jones, M. 
Rabbani, and J. C. Stoffel, “Lossless 
Recovery of an Original Image 
Containing Embedded Data,” U.S. 
Patent 6 278 791 B1, Aug. 21, 2001. 
2. C.H. Tzeng, Z.F. Yang, and W.H. 
Tsai, “Adaptative Data Hiding in 
Palette Images by Color Ordering 
and Mapping With Security 
Protection,” IEEE Transaction on 
Communications, vol. 52, no. 5, pp. 
791–800, 2004. 
3. J. Fridrich, M. Goljan, and R. 
Du, ”Invertible Authentication,” 
Proc. SPIE, Security and 
Watermarking of Multimedia 
Contents, Vol. 3971, pp. 197-208, 
January 23-26, 2001. 
4. J. Fridrich, M. Goljan, and R. Du, 
“Lossless Data Embedding-New 
Paradigm in Digital Watermarking,” 
EURASIP Journal on Applied Signal 
Processing, Vol. 2002, pp. 185-196 , 
February 2002 
5. J. Fridrich, “A New Steganographic 
Method for Palette-Based Images,” 
in Proceedings of the IS&T PICS 
conference,Apr. 1998 
6. J. Tian, “Reversible data embedding 
 
Abstract—The objective of inverse halftoning is to 
reconstruct high quality grayscale images from bi-level halftone 
images. Different from the previous inverse halftoning 
approaches, our algorithm computes the difference image 
between the predicted image using Gaussian filtering from a 
halftone image and the original grayscale one. The difference 
image is then compressed and embedded into the halftone 
image using a reversible data hiding method. In the image 
reconstruction process, the marked halftone image is scanned to 
extract the embedded data. Finally, a better quality of 
reconstructed image can be generated by adding the extracted 
difference image to the predicted image. Experimental results 
show that the proposed approach can efficiently improve the 
quality of reconstructed images for inverse halftoning when 
compared to the previous approaches.    
 
Index Terms—inverse halftoning, pattern substitution, 
reversible data hiding, Gaussian filtering 
 
I. INTRODUCTION 
ALFTONE techniques have been widely applied to many 
fields, including the printing of newspapers, magazines, 
books, and display devices. It is a process of converting 
grayscale images into halftone images for the devices that can 
only process bilevel images. Halftone images are binary 
images that provide a rendition of gray-scale images and 
consists of „0” and „1”. In the halftoning process, it needs to 
use a kernel to carry out the conversion, and the common 
kernel is such as Floyd-Steinberg kernel, and is difficult to 
recover a continuous-tone image through halftone 
manipulation, conversion, compression, etc. Inverse 
halftoning is a process which transforms halftone images into 
grayscale images. The objective of inverse halftone 
reconstruction is to convert halftone bilevel images into 
gray-level images with the minimum distortion. In the past 
few years, many efficient inverse halftoning algorithms have 
been proposed, but there is no way to construct a perfect 
gray-scale image from a given halftone image. There exist 
several inverse halftoning methods, including kernel 
estimation [1], wavelet [2], filtering [3][4], and set theoretic 
approaches[5]. Most of these methods can obtain good 
 
Manuscript received March 19, 2011; revised April 15, 2011. This work was 
Mei-Yi Wu. Author is with General Education Center, National 
Kaohsiung University of Hospitality and Tourism. No.1, Songhe Rd., 
Xiaogang Dist., Kaohsiung City 81271, Taiwan (e-mail:barbara 
@mail.nkuht.edu.tw) 
Jia-Hong Lee. Author is with Information Management Department, the 
National Kaohsiung First University of Science and Technology, 2 Jhuoyue 
Rd., Nanzih, Kaohsiung City, 811, Taiwan (corresponding author, phone: 
886-7-6011000; fax: 886-7-6011069; e-mail: jhlee@ nkfust.edu.tw).  
Hong-Jei Wu. Author is with Information Management Department, the 
National Kaohsiung First University of Science and Technology. 
. 
reconstruction image quality but require relatively high 
computational complexity. 
The halftoning and inverse halftoning processes can be 
regarded as the encoding and decoding processes of vector 
quantization. Therefore, the codebook design methods can be 
applied to build the inverse halftoning lookup tables [6] [7]. 
The content of a table entry is the centroid of the input 
samples that are mapped to this entry. The results are optimal 
in the sense of minimizing the MSE for a given halftone 
method. Although the table lookup method has the 
advantages of good reconstructed quality and fast speed, it 
faces the empty cell problem in which no or very few training 
samples are mapped to a specific halftone pattern.  
In this paper, a reversible data hiding scheme is proposed 
to embed some “useful” information into the halftone images. 
Then users can extract the embedded information and 
reconstruct the original halftone image from the marked 
halftone image. The extracted information can improve the 
quality of generated grayscale images by using a filter based 
inverse halftoning method.  
II. REVIEW OF INVERSE HALFTONING AND REVERSIBLE 
DATA HIDING  
A. LUT-based Inverse Halftoning (LIH) Method  
The LUT-based method includes two procedures: the LUT 
build-up and the LUT-based inverse halftoning (LIH) 
procedures. The LUT build-up procedure is to build the LUT 
information by scanning selected grayscale images and their 
corresponding halftone images with a 3×3 or 4×4 template. 
Template is used as a sliding window to build up the LUT. In 
the LIH procedure, a grayscale image can be reconstructed 
from a given halftone image using the LUT information. The 
LUT information contains a set of pairs of binary pattern and 
its corresponding estimated gray value. Assume that there are 
L training image pair sets and }1|),{( LiHO ii   represents 
the i
th
 pair, where 
iO  denotes the i
th
 original image and 
iH  
the corresponding halftone image of
iO . The LUT build-up 
and LIH procedures using 4×4 template F are described as 
follows:  
 
Procedure LUT build-up: 
Step 1: Let arrays LUT[] and N [] be zero as the initial values. 
LUT[] is used to record the mapped gray value 
corresponding to a specific binary template with index I 
which is appeared in the input halftone image and N[] is 
used to store the occurrence frequency of this specific 
binary template in the halftone image. Select L training 
grayscale images and generate their corresponding 
halftone images, respectively.  
Inverse Halftoning Method Using Pattern 
Substitution Based Data Hiding Scheme 
Mei-Yi Wu, Jia-Hong Lee and Hong-Jie Wu 
H 
Proceedings of the World Congress on Engineering 2011 Vol II 
WCE 2011, July 6 - 8, 2011, London, U.K.
ISBN: 978-988-19251-4-5 
ISSN: 2078-0958 (Print); ISSN: 2078-0966 (Online)
WCE 2011
  
 
Fig. 2.  The process of generating a difference image. 
 
B. Reversible Data Hiding for Binary Images 
Reversible data hiding can embed secret message in a 
reversible way. Relatively large amounts of secret data are 
embedded into a cover image so that the decoder can extract 
the hidden secret data and restore the original cover image 
without any distortion. Recent, a boundary-based PWLC 
method is presented [8]. This method defines the same 
continuous 6 edge pixels as an embeddable block through 
searching for binary image edges. And then one can embed 
data in the pair of the third and fourth edge pixels. A 
reversible data hiding method for error diffused halftone 
images is proposed[9] (Pan, Luo & Lu, 2007). This method 
employs statistics feature of pixel block patterns to embed 
data, and utilizes the HVS characteristics to reduce the 
introduced visual distortion. The method is suitable for the 
applications where the content accuracy of the original 
halftone image must be guaranteed, and it is easily extended 
to the field of halftone image authentication. However, these 
two methods both have a drawback that the capacity of data 
hiding is still limit.  
Recently, Ho et al. [10] proposed a high-capacity 
reversible data hiding method for binary images using pattern 
substitution. The method is capable of both successful 
extraction of secret data from a stego-image and restoring the 
binary image completely after the extraction of secret data. 
Their method gathers statistical data concerning the 
occurrence frequencies of various patterns and establishes the 
pattern exchange relationships. Pattern substitution can be 
used according to the pattern relationships for data hiding. In 
this paper, Ho‟s scheme is applied to embed some “useful” 
information into the halftone images and the information can 
be extracted and used to improve the quality of generated 
grayscale images. The flowchart of Ho‟s method is displayed 
in Figure 3. 
 
 
 
 
 
 
 
 
 
Fig. 3.  The flowchart of data embedding process in Ho‟s 
method.   
 
It is not discernible to human eyes if we modify or add a pixel 
on the edge of a binary image. Therefore, the image flipping 
operation of Ho‟s method is to find the boundaries where 
black and white pixels meet. The flipping formula is as 
follows. 
 







)1,(),(
),1(),(
),(
),(
ijPjiP
ijPjiP
jiP
jiD
   
otherwise
iandjif
iandjif
11
11


 
(5) 
 
 
For a flipped image, we divide it into non-overlapped  4×1 
image blocks. Each four-pixel block from the flipped image 
can be regarded as a pattern. Then we can compute the 
occurrence frequencies for each kind of pattern type. TABLE 
I is the computed results for Lena image.  
 
In this study, we modified Ho‟s method to embed more 
capacity. All patterns are classified into two groups, high 
frequent pattern and low frequent pattern. For each high 
frequent pattern A, a low frequent pattern B which content is 
the most closest to pattern A will be selected to form a pair 
for data embedding. In the data embedding process, the 
original halftone image is partitioned into a group of 4×1 
non-overlapping patterns. Then, any pattern p on the halftone 
image with the same content of A will be selected to embed 
1-bit data. If a data bit “0” is embedded on p, then the content 
of p is remained as A. If a data bit “1” is embedded on p, then 
the content of p is updated as the content of pattern B. In data 
extraction process, the embedded message is obtained 
depending on the pattern A, B when the test image is scanned. 
For example, assume that the highest frequent pattern in the 
image is PH=1111 and its corresponding lowest frequent 
pattern is PL=0101. If the content of the pattern PH is 
encountered, then check the bit value which is currently 
embedded. If the bit value is “0” then remain the content as 
PH. If the value is “1” then we replace PH with the PL pattern. 
Figure 4 shows an example of the data embedding and 
extracting processes for the used method. However, we had 
found that the usage of pattern type with PL=0000 would 
cause “black spot” effect in the marked image. Therefore, we 
avoid the selection of this pattern type in the data embedding 
process.  Figure 5 is an example to demonstrate the results 
with and without the usage of pattern type PL=0000. TABLE 
I shows the frequencies of different  4×1 patterns appeared in 
Lena Image of size 512×512. 
 
 
TABLE I 
THE FREQUENCIES OF DIFFERENT PATTERNS APPEARED IN LENA IMAGE 
 
Pattern type Frequency Pattern type Frequency 
P0000 4615 P0001 2115 
P0011 3620 P0010 103 
P1100 244 P1000 122 
P1001 5281 P1001 4486 
P1010 1526 P1110 2226 
P0101 230 P0101 6068 
P0110 3600 P1101 6072 
P1111 20913 P1011 4315 
 
 
 
Cover image 
Image 
 flipping 
Pattern 
selection for 
modification  
Capacity 
computation 
Hiding by 
key 
Pattern 
substitution 
Bit stream Secret data 
Marker image 
Proceedings of the World Congress on Engineering 2011 Vol II 
WCE 2011, July 6 - 8, 2011, London, U.K.
ISBN: 978-988-19251-4-5 
ISSN: 2078-0958 (Print); ISSN: 2078-0966 (Online)
WCE 2011
 D. Data Embedding and Extracting 
The way to embed SH information is important since the 
receiver cannot extract any data from the marked images if he 
doesn‟t have the SH information before data extracting. We 
divided the halftone image into two regions: one is the place 
to embed SH sequence and the other one is the place to 
embed the DH sequence. Since the size of SH information is 
very small when compared to the entire image size. Two 
kinds of embedding data can be chosen here. One is the fixed 
position method to arrange the SH and DH in faxed regions, 
such as the example in Figure 7(a) and the other is the random 
position method to randomly select different pixels for 
embedding DH information. Then we directly replace the 
selected pixels with the SH sequence. The implementation of 
the second method requires a secret key K to select the 
positions for embedding SH sequence and the receiver should 
also have the key to extract the data. Although the second 
method needs more computation in SH embedding, it owns a 
higher security than the first method. 
 
  
 
 
 
Fig. 7.   Two kinds of methods to embed SH and DH. 
 
The block diagram of data extraction is shown in Figure 1, 
with steps as follows. 
 
Procedure－Data Extraction from a marked halftone image 
Step1.  The SH and DH sequence reconstruction: we use the 
same Key K to find the 3 + 9×2×TC pixel locations and 
arrange the pixel values into the selected pattern pairs 
( iPH , iPL ). Extract the embedded DH sequence by 
scanning the entire image according to the SH 
information.  If a pattern in the iPH  is found then output 
bit 0. If a pattern in the pattern iPL is found then output 
bit 1.  
Step2. Decompression: DH sequence is decoded using 
inverse digital wavelet transform (IDWT) and a 
predicted difference image D‟ is obtained.  
Step3.  Restore the original halftone image H: The scan of the 
whole marked image is performed. If a pattern belongs 
to the pattern iPL then replace the pattern with the 
corresponding pattern iPH .  Then, we will update a part 
of patterns iPH  using the coordinate information of all 
original iPL  extracted from SH.  
Step4.   Compute the predicted image G‟:  A predicted image 
of the halftone image H is output using a Gaussian filter.  
Step5. Image reconstruction:  A recovery image is obtained  
by adding the image D‟ to the predicted image G‟.  
IV. EXPERIMEANT RESULTS 
Four 512× 512 error diffused halftone images, Lena, 
Baboon, Airplane, and Pepper are selected to evaluate the 
performance of the proposed method, as shown in Figure 8. 
These halftones are obtained by performing Floyd–Steinberg 
error diffusion filtering on the 8-bit gray-scale images.   
Comparison of different inverse halftoning methods, 
including Gaussian filtering, LIH, ELIH are implemented. 
The PSNR values of the predicted image from different 
inverse halftoning method and the original grayscale image 
are computed as listed in Table III.  The marked images of the 
proposed methods are shown in Figure 8.  
 
 
Fig. 8.  The marked images with different amount of data bits 
embedded using the proposed method.(a)(c) two pairs of 
patterns were used (e)(g)three pairs of patterns were 
used;(b)(d)(f)(h) maximum capacity of data were embedded. 
In addition, image quality of restored grayscale images was 
evaluated.  
 
Three sub-images extracted from the restored images using 
different inverse halftoning methods are shown in Figure 9.   
We can found that the print words in the reconstructed image 
in Figure (c) look clearer than the other two methods.  
Proceedings of the World Congress on Engineering 2011 Vol II 
WCE 2011, July 6 - 8, 2011, London, U.K.
ISBN: 978-988-19251-4-5 
ISSN: 2078-0958 (Print); ISSN: 2078-0966 (Online)
WCE 2011
Hindawi Publishing Corporation
EURASIP Journal on Advances in Signal Processing
Volume 2010, Article ID 430235, 13 pages
doi:10.1155/2010/430235
Research Article
A New Inverse Halftoning Method Using Reversible Data Hiding
for Halftone Images
Jia-Hong Lee,1 Mei-Yi Wu,2 and Hong-Jie Wu1
1Department of Information Management, National Kaohsiung First University of Science and Technology, Kaohsiung 811, Taiwan
2Department of Information Management, Chang Jung Christian University, Tainan 711, Taiwan
Correspondence should be addressed to Mei-Yi Wu, barbara@mail.cjcu.edu.tw
Received 26 December 2009; Revised 28 July 2010; Accepted 5 October 2010
Academic Editor: Alex Kot
Copyright © 2010 Jia-Hong Lee et al. This is an open access article distributed under the Creative Commons Attribution License,
which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.
A new inverse halftoning algorithm based on reversible data hiding techniques for halftone images is proposed in this paper. The
proposed scheme has the advantages of two commonly used methods, the lookup table (LUT) and Gaussian filtering methods.
We embed a part of important LUT templates into a halftone image and restore the lossless image after these templates have
been extracted. Then a hybrid method is performed to reconstruct a grayscale image from the halftone image. In the image
reconstruction process, the halftone image is scanned pixel by pixel. If the scanned pattern surrounding a pixel appeared in the LUT
templates, a gray value is directly predicted using the LUT value; otherwise, it is predicted using Gaussian filtering. Experimental
results show that the reconstructed grayscale images using the proposed scheme own better quality than both the LUT andGaussian
filtering methods.
1. Introduction
Inverse halftoning is a process which transforms halftone
images into grayscale images. Halftone images are binary
images that provide a rendition of grayscale images and
consists of “0” and “1”. It has been widely used in the
publishing applications, such as newspapers, e-documents,
and magazines. In halftoning process, it needs to use a
kernel to carry out the conversion, and the common kernel
is like Floyd-Steinberg kernel and is diﬃcult to recover
a continuous-tone image through halftone manipulation,
conversion, compression, and so forth. In the past few
years, many eﬃcient inverse halftoning algorithms have been
proposed, but there is no way to construct a perfect gray
image from the given halftone image. There exist several
inverse halftoning methods, including kernel estimation [1],
wavelet [2], filtering [3, 4], and set theoretic approaches [5].
Most of thesemethods can obtain good reconstruction image
quality but require relatively high computational complexity.
The halftoning and inverse halftoning processes can be
regarded as the encoding and decoding processes of vector
quantization. Therefore, the codebook design methods can
be applied to build the inverse halftoning lookup tables
[6, 7]. The content of a table entry is the centroid of the
input samples that are mapped to this entry. The results
are optimal in the sense of minimizing the MSE for a
given halftone method. Although the table lookup method
has the advantages of good reconstructed quality and fast
speed, it faces the empty cell problem in which no or
very few training samples are mapped to a specific halftone
pattern.
In this paper, a reversible data hiding scheme for
halftone images is proposed to embed specified information
to improve the LUT-based inverse halftoning method. We
embed a part of important LUT templates into a halftone
image and generate a stego image in the data embedding
process. Then, we can restore the halftone image without
any distortion from the stego image after these templates
have been extracted. Finally, we can obtain higher quality
reconstructed images than the traditional LUT method by
performing the proposed hybrid method with the extracted
templates and the halftone image. The rest of the paper
is organized as follows. Section 2 introduces related works
about inverse halftoning methods and reversible data hiding
methods for binary images. Section 3 presents the proposed
reversible data hiding method for halftone images and
EURASIP Journal on Advances in Signal Processing 3
P0 P1 P2
P3 P4 P5
P6 P7 P8
P0 P1 P2 P3
P4 P5 P6 P7
P8 P9 P10 P11
P12 P13 P14 P15
X X
Figure 1: The 3× 3 and 4× 4 templates with symbol X denoting the estimated pixel, respectively.
4× 4 halftone pattern
Original gray image
Halftone image
X: predicted gray value
X
(a) LUT buildup
23459 50
LUT Table
Halftone image Predicted gray image
Halftone pattern
X
Predicted X value
(b) LUT-based inverse halftoning
Figure 2: LUT-based method includes two procedures (a) LUT Buildup (b) LUT-based inverse halftoning (LIH).
continuous 6 edge pixels as an embeddable block through
searching for binary image edges. And then one can embed
data in the pair of the third and fourth edge pixels. A
reversible data hiding method for error-diﬀused halftone
images is proposed [9]. This method employs statistics
feature of pixel block patterns to embed data and utilizes
the HVS characteristics to reduce the introduced visual
distortion. The method is suitable for the applications, where
the content accuracy of the original halftone image must
be guaranteed, and it is easily extended to the field of
halftone image authentication. However, these two methods
have a drawback that the capacity of data hiding is still
limited.
3. Proposed Method
The proposed inverse halftoning method based on reversible
data hiding techniques can be divided into two phases: the
embedding process and the extracting process. Figure 3(a)
shows the diagram of the proposed method. In the embed-
ding process, a grayscale image is transferred into a halftone
image by error diﬀusion process. Then pattern selection is
performed to determine the pattern pairs for the use in
reversible data hiding. Meanwhile, a part of LUT templates
are selected to keep high quality of recovery images in
the reconstruction process. These templates along with the
pattern pairs will be encoded in bit streams and embedded
EURASIP Journal on Advances in Signal Processing 5
0
0
0
0
0
0
0
0
1
1
0
0
1 1
1
1
170 155 16015
10
Halftoning
Original grayscale image
Halftone image Predicted by LUT
by Gaussian filteringpredicted
Figure 6: An example for the comparison of image quality loss using two diﬀerent methods.
Grayscale image Halftone image Gaussian filtering Predict image
Construct LUT template
T and temple F Predict image
LUT entry selection
Figure 7: The flowchart of LUT entry selection.
In this study, all patterns are classified into two groups,
used and unused. For each used pattern A, an unused pattern
B, its content is the most closest to pattern A, will be selected
to form a pair for data embedding. In the data embedding
process, the original halftone image is partitioned into a
group of 3 × 3 nonoverlapping patterns. Then, any pattern
p on the halftone image with the same content of A will be
selected to embed 1-bit data. If a data bit “0” is embedded
on p, then the content of p remains as A. If a data bit “1”
is embedded on p, then the content of p is updated as the
content of pattern B. This scheme works because patterns
A, B look similar. In data extraction process, the embedded
message is obtained depending on the patternsA, B when the
test image is scanned. For example, assume that the highest
frequent pattern in the image is PH = 010, 011, 011 and its
corresponding unused pattern is PL = 010, 001, 001. We can
embed three secret data bits (e.g., 011) into the following
6 × 6 image block with the proposed pattern substitution
method. The image is firstly divided into four nonoverlapped
3 × 3 patterns, and these patterns are scanned horizontally
from top to buttom. If the content of the pattern PH is
encountered, then check the bit value which is currently
embedded. If the bit value is “0,” then keep the content
as PH. If the value is “1,” then we replace PH with the
PL pattern. This example of data embedding is shown in
Figure 3(b).
To achieve a higher capacity of embedding data, more
pattern pairs should be determined, whose steps can be
presented as follows.
(1) Partition the original image into nonoverlapping 3×3
blocks.
(2) Compute the occurrence frequencies for all appeared
patterns. Sort these used patterns decreasingly, and
denote them as PHi according to their occurrence
frequencies. For instance, PH0 is the pattern with the
highest occurrence frequency.
(3) Find out all unused patterns. Assume that there are
totally TC unused patterns; TC pairs of patterns (PHi,
PLi) are selected to perform the data embedding
operation, where the distance of pattern pair (PHi,
PLi) owns the minimal distance. Based on the raster
scan order, pattern PH and PL can be denoted as
9 elements PH0, PH1, PH2,. . ., PH8 and PL0, PL1,
PL2,. . ., PL8, respectively. The calculation of pattern
similarity for pattern PH and PL can be defined using
the following distance equation:
Dist(PH,PL) =
8∑
j=0
∥∥∥PH j − PL j
∥∥∥, (5)
where j is the location in the 3× 3 block.
EURASIP Journal on Advances in Signal Processing 7
region region
region region region
region
(a) (b) (c)
SH embedded SH embedded
LH embedded LH embedded LH embedded
HLi SH
HLi embedded
Figure 10: The flowchart of data embedding process: (a) embed SH and LH into the halftone image in horizontal scanning, and generate a
stego image S; (b) extract data from the last row of stego image S, and denote it as HLi; (c) HLi is then embedded into the stego image S with
pair-based method, and generate another stego image S′.
region region
LH embeddedLH embedded
HLiSH
region
HLi embedded
Figure 11: The flowchart of data extracting process.
1200
1000
800
600
400
200
0
1 31 61 91 12
1
15
1
18
1
21
1
24
1
27
1
30
1
33
1
36
1
39
1
42
1
45
1
48
1
51
1
Figure 12: The pattern histogram of halftone image Lena.
Apply the LIH procedure to an input halftone image H , and
generate a corresponding predicted image H ′.
Step 2. Perform the inverse halftoning using Gaussian filter-
ing for image H , and generate a predicted image G′.
Step 3. Compute the diﬀerence of the absolute values of G
minus G′ and G minus H ′ using the following equation:
D
(
x, y
)=∣∣(G(x, y)−G′(x, y))∣∣−∣∣(G(x, y)−H ′(x, y))∣∣.
(8)
If the D value is greater than zero, it means that the LUT
method can obtain a better predicted value than Gaussian
method on the pixel with location (x, y).
Step 4. Scan the image block by block with block size 4 × 4.
For a processed block, if (x, y) is the predicted position and
the image block on the halftone image is with index I , then
the sum of diﬀerence B[I] can be accumulated as
B[I] = B[I] +D(x, y). (9)
B[I] can be regarded as the quality improvement of the
predicted image by replacing Gaussian filtering with the LUT
method.
Step 5. Sort B[ ] decreasingly, and generate the correspond-
ing templates index SI[i], where 0 ≤ i ≤ 65535. Since the
embedding capacity is limited, we can only embed part of the
top LUT templates into the halftone image. The total quality
improvement is denoted as
∑P−1
i=0 B[SI[i]], where P represents
the number of embedded templates.
Figure 8 shows an example of the sum of diﬀerences B[I]
for Lena image, where x-axis represents the pattern index I in
the halftone image with 4×4 templates and y-axis represents
the B[I] value. If B[I] is greater than zero, it means that
the LUT-based method works better than Gaussian filtering
method on the pixel value prediction under all image blocks
with the same context of the template indexed by I .
Assume that P1 is the number of parts of top LUT
templates to be embedded into the halftone image using
3 × 3 templates, and P2 is the number of parts of top LUT
EURASIP Journal on Advances in Signal Processing 9
(a) (b)
(c) (d)
Figure 14: Four images for experiments: (a) Lena, (b) Pepper, (c) Airplane, and (d) Baboon.
filtering on the 8-bit gray-level images. Figure 12 shows the
pattern histogram of the halftone image Lena with x-axis
indicating the pattern index ranging from 0 to 511 and
y-axis indicating the occurrence frequency of each pattern
index. The highest peak among the histograms is with value
1058, and the number of zero value is totally 134. Figure 13
displays the top ten matching patterns which own the
highest occurrence frequency in the halftone image Lena. In
addition, we have also applied the proposedmethod on other
images including Pepper, Baboon, and Airplane. Figure 14
shows the original grayscale images. Figures 15(a), 15(d),
15(g), and 15(j) are the generated halftone images from the
images in Figure 14, respectively. Figures 15(b), 15(e), 15(h),
and 15(k) are the generated stego images with 2072, 2329,
3086, and 2603 bits of data embedded, respectively. Figures
15(c), 15(f), 15(i), and 15(l) show the generated stego images
with maximum capacity, respectively.
Figure 16 shows the diﬀerence between the generated
stego images with and without applying the weight adjusting
operation. Obviously, the stego image with weight adjusting
operation owns better perceptive quality than the other one
since the operation can reduce the possibility of forming
black spots.
Table 1 shows the used templates, the number of selected
pairs and embedding capacities using the proposed method
for diﬀerent images. The embedding capacities for image
Lena, Pepper, and Airplane are all about 25000 bits. But
the capacity for image Baboon is only 9544 bits. This is
because the number of zero patterns is smaller than the other
three images. It means that there is more diﬀerent “texture”
patterns existing in the Baboon halftone image. Due to the
smaller embedding capacity, only few templates information
are selected to embed into the halftone image. In the case for
Baboon image, 3× 3 template is used to be replaced by 4× 4
template to obtain a better quality of reconstructed image.
To evaluate the performance of the proposed method,
diﬀerent inverse halftoning methods are used for compar-
ison. They include the Gaussian filtering with parameter
σ = 1.41, traditional LUT and Edge-based LUT methods
with ten images for training. Table 2 shows the PSNR
values for the recovery images using these diﬀerent methods.
Experimental results show that the reconstructed grayscale
images using the proposed scheme own better quality
than Gaussian filtering, traditional LUT, and Edge-based
LUT methods. Figure 17 shows the experimental results
for image Lena using diﬀerent methods. The reconstructed
EURASIP Journal on Advances in Signal Processing 11
(a) (b)
Figure 16: The generated stego images with and without applying the weight adjusting operation: (a) without the weight adjusting and (b)
with the weight adjusting.
(a) (b)
(c) (d)
Figure 17: The inverse halftoning results using diﬀerent methods: (a) the reconstructed image using Gaussian filtering; (b) the reconstructed
image using LUT method; (c) the reconstructed image using ELUT method; (d) the reconstructed image using the proposed method.
EURASIP Journal on Advances in Signal Processing 13
Table 2: The experiment result for four images using diﬀerent
methods.
Images
(embedded
capacity)
PSNR(dB)
Gaussian
filtering∗
[10]
LUT [6] ELUT [7]
The
proposed
method
Lena (26317) 29.40 27.53 28.54 30.11
Pepper (26575) 29.30 27.33 29.29 30.72
Airplane (24985) 28.29 26.94 28.05 29.75
Baboon (8315) 22.22 22.35 22.22 23.99
∗Gaussian filter σ = 1.41.
Table 3: Complexity comparison of diﬀerent inverse halftoning
schemes.
Algorithms (ref.) Complexity
MAP [11] High
Wavelet [1] Median
Gaussian filtering [10] Low
LUT [6] Low
ELUT [7] Low
The proposed method Low
paper. We embed a part of important LUT templates into
a halftone image and restore the lossless image after these
templates have been extracted. Then a hybrid method is
performed to reconstruct a grayscale image from the halftone
image. Experimental results show that the proposed scheme
outperformed Gaussian filtering, LUT, and ELUT methods.
The proposed method can be also modified by selecting
diﬀerent filtering methods for practical applications.
Acknowledgments
This work was supported by the National Science Council,
Taiwan, under Grants 99-2220-E-327-001 and 99-2221-E-
328-001.
References
[1] P. W. Wong, “Inverse halftoning and kernel estimation for
error diﬀusion,” IEEE Transactions on Image Processing, vol. 4,
no. 4, pp. 486–498, 1995.
[2] Z. Xiong, M. T. Orchard, and K. Ramchandran, “Inverse
halftoning using wavelets,” in Proceedings of the IEEE Inter-
national Conference on Image Processing (ICIP ’96), vol. 1, pp.
569–572, September 1996.
[3] Z. Fan, “Retrieval of images from digital halftones,” in
Proceedings of the IEEE International Symposium on Circuits
Systems, pp. 313–316, 1992.
[4] T. D. Kite, N. Damera-Venkata, B. L. Evans, and A. C. Bovik,
“A fast, high-quality inverse halftoning algorithm for error
diﬀused halftones,” IEEE Transactions on Image Processing, vol.
9, no. 9, pp. 1583–1592, 2000.
[5] P.-C. Chang, C.-S. Yu, and T.-H. Lee, “Hybrid LMS-MMSE
inverse halftoning technique,” IEEE Transactions on Image
Processing, vol. 10, no. 1, pp. 95–103, 2001.
[6] M. Mes¸e and P. P. Vaidyanathan, “Look-up table (LUT)
method for inverse halftoning,” IEEE Transactions on Image
Processing, vol. 10, no. 10, pp. 1566–1578, 2001.
[7] K.-L. Chung and S.-T. Wu, “Inverse halftoning algorithm
using edge-based lookup table approach,” IEEE Transactions
on Image Processing, vol. 14, no. 10, pp. 1583–1589, 2005.
[8] C.-L. Tsai, H.-F. Chiang, K.-C. Fan, and C.-D. Chung,
“Reversible data hiding and lossless reconstruction of binary
images using pair-wise logical computation mechanism,”
Pattern Recognition, vol. 38, no. 11, pp. 1993–2006, 2005.
[9] J.-S. Pan, H. Luo, and Z.-M. Lu, “Look-up table based
reversible data hiding for error diﬀused halftone images,”
Informatica, vol. 18, no. 4, pp. 615–628, 2007.
[10] S. Hein and A. Zakhor, “Halftone to continuous-tone conver-
sion of error-diﬀusion coded images,” IEEE Transactions on
Image Processing, vol. 4, no. 2, pp. 208–216, 1995.
[11] R. L. Stevenson, “Inverse halftoning via MAP estimation,”
IEEE Transactions on Image Processing, vol. 6, no. 4, pp. 574–
583, 1997.
出席國際學術會議心得報告 
計畫編號  NSC99-2221-E-328-001 
計畫名稱  (中文) 一般化圖案取代之無失真資料隱藏技術及其應用之
研究  
(英文) A Study on Reversible Image Steganography with  
Generalized Pattern-Substitution Schemes and Applications 
 
出國人員姓名  
服務機關及職稱  
吳美宜     
國立高雄餐旅大學 資訊圖書館 副教授 
會議時間地點  2011年七月六日到八日, 英國倫敦  
6
th 
~ 8
th
, July, 2011 London, U.K.  
會議名稱  (中文)世界工程年會-2011訊號與影像工程國際研討會 
(英文) World Congress on Engineering 2011(WCE 2011)  
The 2011 International Conference of Signal and Image 
Engineering 
發表論文題目  (中文) 利用圖案取代之資料隱藏方法 
(英文) Inverse Halftoning Method Using Pattern Substitution 
Based Data Hiding Scheme 
 
一、參加會議經過  
 
  本次出國主要的目的是去參加世界工程年會WCE 2011並報告論文 - Inverse 
Halftoning Method Using Pattern Substitution Based Data Hiding Scheme，藉由報告論
文的空檔，觀摩國際間在訊號處理以及多媒體應用領域上的發展趨勢、方法、以及
目前的現況。  
  WCE 2011是 International Association of Engineers (IAENG)協會聯合舉辦的國際
工程年會，在英國倫敦舉行，共有十四個重要的研討會議，其領域涵蓋了人工智慧、
生物資訊、電腦科學、資料探勘等，我們投稿至其中的訊號與影像工程國際研討會。
整個年會有來自50多個不同國家超過一千三百篇的投稿，顯示有相當多的研究者投
入這次的研討會。 
  本人參加報告的Session屬於訊號以及影像工程，是在第一天上午的九點半開始，
順位是第二個，但第一篇論文發表者缺席，所以提前上台報告。會場有許多此一領
域的學者參與，也與本人做簡短的討論交流。這篇論文主要是發展一套以半色調影
像資料隱藏方法，將重要資料藏入半色調影像中，用以回復高品質的灰階影像，此
方法首先計算原始灰階影像與半色調影像的差值影像，經由失真壓縮轉成二元影像，
藏入半色調影像中；並透過所提出的高容量可回復式資料隱藏技術，以樣版配對方
式，找出大量配對組合，並透過配對組合，將串流資訊藏入影像。本研究所提出的
方法，能重建比傳統方法較佳的高品質的灰階影。每個作者的報告約有20分鐘，會
附件5、Paper Award – Certificate of Merit WCE 2011 London 
 
Dear Dr. Mei-Yi Wu, 
  
  Congratulations! Your following paper has been selected as  
 
Certificate of Merit for The 2011 International Conference of Signal and Image 
Engineering 
 
Paper No.: ICSIE_59 
Paper Title.: Inverse Halftoning Method Using Pattern Substitution Based Data Hiding 
Scheme 
  
  Thanks for your participation in the World Congress on Engineering 2011  
(WCE 2011).  It is our pleasure to tell you that your paper has been selected  
for the above award, based on the reviewer reports and the evaluation score  
results of our conference committee members during the conference period.  
 
Best regards, 
Anna Lee 
Assistant Secretary 
International Association of Engineers (IAENG) 
 
 
 
 
99 年度專題研究計畫研究成果彙整表 
計畫主持人：吳美宜 計畫編號：99-2221-E-328-001- 
計畫名稱：一般化圖案取代之無失真資料隱藏技術及其應用之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 0%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 0%   
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 2 2 100%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 1 1 100%  
研究報告/技術報告 0 0 0%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 0% 章/本  
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 0 0%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 0% 
人次 
 
