I 
 
摘要 
 
針對循環式 ADC，本計畫提出兩種電容切換技術，名為隨機回授電容互換(RFCI)
及平均隨機回授電容互換(ARFCI)，用來降低因為電容不匹配所造成的諧波失真。
RFCI及 ARFCI技術不需要複雜的電路。RFCI技術可以在不犧牲 SNDR的情況下，
改善傳統 ADC的 SFDR，而 ARFCI擁有比 RFCI好的 SNDR特性，但 ARFCI的 SFDR
改善能力沒有 RFCI來得好。使用 RFCI及 ARFCI，高 SFDR規格的電容匹配需求可
以變得寬鬆。如此 ADC的推動力需求即可降低而整體的功率消耗及面積也會降低。
現存之回授電容交換(CFCS)技術雖然不太能改善循環式 ADC的 SFDR但確能改善其
SNR。因此，本計畫提出一個可重新設定的循環式 ADC架構，此架構可以透過簡單
的時序控制電路來輕易地設定成 RFCI、ARFCI及 CFCS其中一種技術。此一可重新
設定的架構，以一個智財(intellectual property, IP)提供了三種轉換特性而不是三個分離
的智財，因此大為提升了循環式 ADC的能力，為目前全世界 cyclic ADC最佳的架構。 
本計畫亦提出一偏壓及輸入互換(BII)技術以重設運算放大器(opamp)的總和節點
(summing node)，藉此消除使用共享運算放大器(opamp sharing)之架構的循環式與導
管式 ADC的殘值記憶效應。不同於其他運算放大器總和節點重設(OSNR)技術，所提
出之 BII 技術不需要額外的前級放大器(preamplifier)也不需犧牲信號振幅(signal 
swing)。因此驅動電路的大小與功率消耗皆可減少，FOM比現有架構都好。 
針對 Nyquist頻率 DAC，本計畫提出了兩種動態元件匹配技術及一種數位類比轉
換器的創新架構。在使用這兩種技術時將同時搭配佈局切換技術(layout switching 
scheme)來使用。本計畫所提出之隨機增量式資料加權平均技術擁有隨機
(randomization)及連續選擇(consecutive selection)兩種特性。其中隨機特性可有效抑制
由元件不匹配所產生的諧波失真，進而得到高無諧波失真動態範圍；而連續選擇特性
則使得它在與旋轉式走法(rotated walk)切換技術同時使用時，可得到小的靜態輸出誤
差。本計畫更提出了第二種用於 Nyquist 頻率 DAC 的技術，名叫隨機式溫度計編碼
技術。此技術可同時提供隨機、連續選擇及低元件切換活動(low element switching 
activity)等三種特性，除了擁有隨機多重資料加權平均技術及隨機增量式資料加權平
III 
 
Abstract 
This project proposes two capacitor-swapping techniques, RFCI and ARFCI 
techniques, for cyclic ADCs to reduce the harmonic distortion caused by capacitor 
mismatch with simple circuits. The RFCI improves upon the SFDR of conventional ADCs. 
The ARFCI has better SNDR characteristics than RFCI. The prior CFCS technique can 
improve SNR. This work proposes a reconfigurable cyclic ADC architecture to provide the 
conversion characteristics of RFCI, ARFCI, and CFCS techniques with one item of 
intellectual property (IP), rather than three separate IPs and thus greatly enhances the 
capabilities of cyclic ADCs.  
A BII technique is proposed to remove the memory effect of residue signals in 
cyclic/pipelined ADCs with opamp-sharing architectures. The proposed BII technique does 
not need an additional preamplifier stage or need to sacrifice signal swing, as do other 
opamp summing node resetting techniques. Thus, the size of driving circuits and power 
consumption can be reduced. Prototypes are constructed to demonstrate the BII technique. 
  For Nyquist-rate DACs, two DEM approaches are proposed to be used with a proper 
layout switching scheme in a proposed new DAC structure. RIDWA have randomization 
and consecutive selection properties. Randomization effectively suppresses harmonic 
distortions to achieve good SFDR. Consecutive selection obtains small static output errors 
when it is used with the presented rotated walk switching scheme. The second DEM 
approach proposed for Nyquist-rate DACs is RTC, which provides randomization, 
consecutive selection, and low element switching activity properties. In addition to the 
benefits of earlier proposed RMDWA and new proposed RIDWA, low element switching 
activity can achieve small dynamic errors caused by element switching. 
The measured SFDR is up to 80dB for single-tone tests at a 10MHz sampling 
frequency. The measurement results show that the RTC can improve the SFDR by 16dB. 
The 14-bit current-steering DAC has an active area of less than 0.28-mm2. The active area 
of the DAC is smaller than those of the state-of-the-art DACs with 14-bit resolution. The 
V 
 
Contents 
 
1  Introduction                1 
1.1  Motivation  …………………………………………………………………… 1 
1.2  Organization  ………………………………………………………………… 4 
 
2 Capacitor-Swapping Cyclic A/D Conversion Techniques with Reduced Mismatch 
Sensitivity 5 
2.1  Introduction …………………………………………………………………… 5 
2.2  Capacitor Swapping Schemes ………………………………...……………… 6 
 2.2.1 RFCI ……………………………………………………………………..7 
2.2.2 ARFCI ..…………………………………………………………………..13 
2.2.3 Three-in-one Architecture with RFCI, ARFCI, and CFCS Technique …...15 
2.3 Behavior Simulation …………………………………….……………………… 16 
2.4 Circuit Implementation ……………………………………………………….….19 
2.5 Measurement Results ……………………………………………………………21 
2.6 Summaries ………….…………………………………………………………..24 
 
3 Random Feedback-Capacitor Interchanging Technique for Cycl ic  
 Analog-to-Digital Converters             25 
3.1  Introduction …………………………………………………………………… 25 
3.2  Bias-and-Input Interchanging Technique …………………………………… 26 
 3.2.1 Pipelined ADC Architecture with Opamp Sharing …………………….…26 
 3.2.2 Fully Differential BII Architecture ……………………………………….30 
3.2.3 Pseudo-differential BII Architecture ………………………………..……30 
3.2.4 Comparisons of Opamp Summing Node Resetting Architectures……..…32 
3.3  Prototype Veficication ………………………………………………………… 34 
VII 
 
6  Conclusions                80 
 
Bibliography                82 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
IX 
 
List of Figures 
 
Fig. 2.1 An N-bit cyclic A/D converter ………………………………………………….7 
Fig. 2.2 Residue curve of MDAC ………………………………………………………....8 
Fig. 2.3 (a) Architecture of cyclic ADC. (b) Averaging operation in cycles 2 and 3 for  
 ARFCI technique ……………………………………………………………..….10 
Fig. 2.4 Transfer cuves in the RFCI case when (a) C1<C2 and Flag=0, or C1>C2 and  
 Flag=1. (b) C1>C2 and Flag=0, or C1<C2 and Flag=1…………………………11 
Fig. 2.5 Transfer curves in the conventional case when (a) C1<C2 and (b) C1>C2…….12 
Fig. 2.6 Transfer curves in the ARFCI case when (a) C1<C2 and Flag=0, or C1>C2 and  
 Flag=1. (b) C1>C2 and Flag=0, or C1<C2 and Flag=1………………………15 
Fig. 2.7 Control circuit blocks to the switches of the three-in-one ADC……………...…16 
Fig. 2.8 (a) SFDR and (b) SNDR Monte-Carlo simulations with respectively conventional 
, CFCS, RC, RCFCS, RFCI, and ARFCI techniques………………17 
Fig. 2.9 Plots of the SNDR with respectively RFCI and ARFCI techniques versus input  
level……………………………………………………………………………18 
Fig.2.10 (a) A gain-boosted, folded cascade opamp, (b) SC common-mode feedback  
circuit. …………………………………………………………………………19 
Fig. 2.11 (a) Differential SC comparator and (b) latched comparator…………………….20 
Fig. 2.12 Die photograph……………………………………………………….………….21 
Fig. 2.13 Measured FFT plot with the conventional technique ………………...…………22 
Fig. 2.14 Measured FFT plot with the RFCI technique………………………………….23 
Fig. 2.15 Measured FFT plot with the ARFCI technique……………………………........23 
Fig. 3.1 A 10-bit, 1.5-bit/stage pipelined ADC……………………………………………27 
Fig. 3.2 (a) Architecture of two 1.5-bit MDACs with opamp sharing. (b) Timing diagram.  
 (c) Residue curve of 1.5-bit MDAC……………………………………………28 
Fig. 3.3 (a) A gain-boosted FD-BII opamp. (b) A gain-boosted PD-BII opamp………….29 
XI 
 
each inversion) = 64, (c) partitioned DWA, (d) DWA with randomly reversal 
direction of rotation and RI = 64, (e) bi-directional DWA , and (f) rotated DWA  
with six circles and MTBS (mean time between switching) = 64…………… 54 
Fig. 4.15 DAC spectra employing (a) adaptively randomized DWA (b) DWA with  
 randomly reversal direction of rotation and (c) rotated DWA with proper  
 design parameter………………………………………………………….…..55 
Fig. 5.1  Operation principles of the RTC approach for (a) RP=2 and (b) RP=4 ………. 59 
Fig. 5.2  An M-bit, N-element DAC  …………………………………………………61 
Fig. 5.3  (a) A joint error distributed profile for the DAC elements and (b) their  
corresponding values  ……………………………………………………… 62 
Fig. 5.4  Mismatch spectra of the DAC applying the RTC approach with RP = (a)1, (b)2,  
(c)4, (d)8, (e)16, and (f)32…………………………………….……………… 63 
Fig. 5.5  The maximum mismatch tone power and the total number of switched elements 
of the simulated DAC employing the RTC approach with different RPs….….64 
Fig. 5.6  (a) Maximum tone power of the DAC with different input frequencies and 
amplitudes, (b) DAC output spectrum employing the RTC approach for the  
two-tone test ……………………………………………………………….… 65 
Fig. 5.7  Block diagram of the RTC approach ….………………………………………66 
Fig. 5.8 DAC architecture ...……………………………………………………………68 
Fig. 5.9  Output spectrum of the 14-bit DAC applying RTC and the corresponding  
element mismatches with a 2% standard deviation  …………………………69 
Fig. 5.10 Monte-Carlo simulation results for SFDRs of the 14-bit DAC with 6-bit  
matching accuracy  …………………………………………………………70 
Fig. 5.11 (a) DAC architecture with current-splitter (b) DAC architecture used in this  
work  …………………………………………………………………………73 
Fig. 5.12 (a) Sequence arranging rule of the QN rotated walk for N=2 and (b) its final  
switching sequence  ………………………………………………….………74 
Fig. 5.13 DAC floorplan  ………………………………………………………………76 
1 
 
Chapter 1 
 
Introduction 
 
 
Nowadays, multi-media and communication applications grow rapidly because of the 
advancement in system on a chip (SoC). Digital signal processing (DSP), which has extra 
advantage over its counterpart, becomes an important role in many applications. Therefore, 
the interface between the analog and digital part of the system is the indispensable key of 
the integrated system design [1]. Regardless of an analog-to-digital converter (ADC) or a 
digital-to-analog converter (DAC), it is a trend of low-cost and high-resolution indeed. 
Demand for low-cost and high-resolution ADCs and DACs continues to grow every year, 
driven primarily by strong growth of the market for wired and wireless communication 
systems. Such applications require ADCs and DACs to be capable of handling data of 
several tens or hundreds of MS/s, with data word resolution on the order of 10-16bits. 
 
1.1 Motivation 
 
High resolution CMOS analog-to-digital converters (ADCs) are applied in many 
fields, including medical instruments, multimedia, and communicational. These 
applications are developed toward low power and low cost capabilities with the expanding 
demand for portable and wireless-transmission products. The cyclic/pipelined ADC 
architecture has been proven to be suitable for these applications, owing to its ability to 
achieve high resolution within small silicon area. 
However, the performance of cyclic/pipelined ADCs is usually limited by various 
circuit non-idealities, such as capacitor mismatch, comparator offset, and the finite dc gain 
of operation-amplifier (opamp). Various architecture and circuit techniques are exploited to 
3 
 
bias-and-input interchanging (BII) technique that eliminates the memory effect without 
adding current branches or sacrificing signal swing. Prototype ADCs are constructed to 
verify the BII technique. 
In fields as modern wired and wireless communications, the video signal processing, 
the direct digital synthesis and the arbitrary waveform generation, the DACs have become 
crucial building blocks. However, due to the inherent nonlinearities of practically 
fabricated DACs, harmonic distortions are introduced to the output spectrum of the DACs 
which decrease their SFDR. Similar to ADCs, trimming and calibration are the popular 
ways to reduce the distortion resulted form mismatch. But to realize them, special 
processing and complex circuits will be needed of this DAC. Moreover, the dynamic 
element matching (DEM) can successfully reduce the correlation of DAC noise to the 
input signal thus eliminates the DAC output’s harmonic distortions. 
For Nyquist-rate DACs, randomization is mostly used to spread the harmonics as 
white noise over the output spectrum. However, the possible maximum output errors of 
randomization are still large because the elements are selected randomly. In order to 
improve it, a new structure which can achieve the benefits of both the dynamic element 
matching approach and the proper layout switching scheme is proposed for Nyquist-rate 
DACs. For the new structure, the DEM should have consecutive selection and 
randomization properties. DWA-like approaches have been found to be able to have these 
two properties and firstly used for Nyquist-rate DACs. However, the increased element 
switching activity of DWA-like approaches increases dynamic errors. To maintain the two 
properties while decreasing the element switching activity, a new DEM approach named 
“randomized thermometer-coding (RTC)” is proposed. To experimentally verify the 
proposed DAC structure and the RTC approach, the design and implementation of a 
low-cost high-resolution current-steering digital-to-analog converter (DAC) is also 
presented in this project. Using the RTC, a 14-bit current-steering DAC is implemented in 
a 1P6M 0.18-μm 1.8-V CMOS process. The area of the DAC can be very small because 
the mismatch effect can be greatly suppressed by using the RTC approach. Hence, for 
DACs, both high spurious-free dynamic range (SFDR) and small active area can be 
achieved without increasing dynamic errors by the use of the RTC approach. 
 
5 
 
Chapter 2 
 
Capacitor-Swapping Cyclic A/D 
Conversion Techniques with Reduced 
Mismatch Sensitivity 
 
 
 
2.1 Introduction 
 
Cyclic analog-to-digital converters (ADCs) are developing toward low-power 
consumption and low-cost features. Hence, components must be shrunk to reduce power 
and cost, but induced component mismatch reduces accuracy. Many approaches have been 
presented to solve problems of component mismatch. Some are used in pipelined ADCs 
and can also be employed in cyclic ADCs because the basic building block of a pipelined 
ADC stage is similar to that of a cyclic ADC stage. Although digital calibration schemes 
[2-5] can be used to reduce the difficulty of analog block design, the complexity and 
overhead of the digital circuits are increased. Capacitor swapping methods, such as 
ratio-independent [6], error-averaging [7], and commutated feedback-capacitor switching 
(CFCS) [8], relax the matching requirement in the analog domain with a simple circuit 
structure. Among them, the ratio-independent and error-averaging techniques affect the 
sampling rate because additional clock phases are required. Although the CFCS technique 
can improve the differential nonlinearity (DNL) of cyclic ADCs without loss of conversion 
7 
 
 
Fig. 2.1 An N-bit cyclic A/D converter 
2.2.1 RFCI 
 
An N-bit cyclic ADC block diagram, as shown in Fig. 2.1, illustrates the RFCI 
technique. A sample/hold amplifier (SHA), a sub-ADC, and a multiplying digital-to-analog 
converter (MDAC) are used cyclically. The digital code in each cycle has 1-bit resolution 
with extended range, and Fig. 2.2 plots the residue curve of the MDAC. A digital error 
correction circuit [11] produces an N-bit digital output for a complete conversion. For 
simplicity, a single-ended architecture is demonstrated in Fig. 2.3(a). The SHA is 
connected to the input signal Vin in cycle 1 and to the amplified residue Vres from MDAC in 
cycles 2, 3,…, N, of which each cycle consists of phases A and B. Phase A indicates that 
the SHA and MDAC are in sampling and amplifying states, respectively. Phase B means 
that the SHA and MDAC are in holding and sampling states, respectively. During phase B, 
in cycles 1 to N, the MDAC samples the output signal of SHA on capacitors C1 and C2. 
The other capacitor C0 is connected to Vref/2. During phase A, the SHA samples signals on 
capacitors CA1 and CA2 simultaneously, and the arrangement of capacitor connection of the 
MDAC is as given in Table 2.1. The feedback capacitor is commutated according to the 
9 
 
( )
( )
( ) ( )
( ) ( )ï
ï
î
ï
ï
í
ì
=---+++
=--++
=+
-=+++
=
2
3
ref0/20/12
3
i0/20/1
ref1/2i1/2
i2/1
2
1
ref2
1
i0/20/1
res
;2
1;12
0;2
;2
dVV
dVV
dV
dVV
V
eeee
ee
e
ee
  (2-2) 
 
When Flag = 1, the residue equation of MDAC in cycle 2 becomes (2-2) and that in each 
remaining cycle becomes (2-1). 
 
Table 2.1 Capacitor connection of MDAC for RFCI and ARFCI techniques (FB: feedback) 
 
 
 
11 
 
 
 
Fig. 2.4 Transfer curves in the RFCI case when (a) C1 < C2 and Flag = 0, or C1 > C2 and 
Flag = 1. (b) C1 > C2 and Flag = 0, or C1 < C2 and Flag = 1. (Solid line: with capacitor 
mismatch; dotted line: ideal) 
 
For C1 < C2, the analysis is described as follows. When Flag = 0, the slope of the 
residue curve is (2 + e2/1) > 2 and (2 + e1/2) < 2 if d = 0 and d = 1 in cycle 2, respectively. 
Fig. 2.4(a) plots the transfer curve under this condition. In the following cycles, cycles 3, 
4,…, N, the slope of the residue curve is (2 + e1/2) < 2 and (2 + e2/1) > 2 if d = 0 and d = 1, 
respectively. This opposite deviation of residue slopes in the later cycles compensates for 
the capacitor mismatch errors in cycle 2, and corrects the overall transfer curve, which 
evidenced by the transfer curves in cycles 3 and 4, as shown in Fig. 2.4(a). When Flag = 1, 
the transfer curve in each cycle can be derived as a mirror of that with Flag = 0, as shown 
in Fig. 2.4(b), and so the same effect is evident.  
 
13 
 
capacitor mismatch errors are reduced, the RFCI technique can achieve high SFDR while 
maintaining good SNDR. Here, the employed Flag has to be random enough to suppress 
in-band tones with enough sequence length for the pseudo-random number generator. In 
the other case in which C1 > C2, the transfer curves in the RFCI case in cycles 2 to 4 with 
Flag = 0 and Flag =1 are as shown in Figs. 2.4(b) and (a), respectively, and those in the 
conventional case are as shown in Fig. 2.5(b). The transfer curves have similar features to 
those in the C1 < C2 case. Hence, the RFCI technique also outperforms the conventional 
technique. However, when the input signal is small, the SNDR improvement by the RFCI 
technique is decreased because the mismatch error dominates in the mid codes. 
 
2.2.2 ARFCI 
 
The circuit blocks and architecture of cyclic ADCs using the ARFCI technique 
resemble those using the RFCI one, as shown in Figs. 2.1, 2.2, and 2.3(a). The discrepancy 
between the operation mechanisms is as follows. In cycles 2 and 3, phase A is divided into 
two clock phases A1 and A2 for the averaging operation, as shown in Fig. 2.3(b). The 
capacitors C1 and C2 in MDAC are fixed in the feedback path in phases A1 and A2, 
respectively, and the residues in phases A1 and A2 are sampled on the capacitors CA1 and 
CA2 in SHA, respectively. In the remaining cycles, cycles 4, 5,…, N, the cyclic ADC 
executes the RFCI operation during phase A, as listed in Table 3.1. The ARFCI technique 
costs an additional clock cycle for a conversion and lowers the conversion rate to 
)1N/(N +  times the conventional one. 
With capacitor mismatch, the averaged residue of MDAC in cycles 2 and 3 can be 
expressed as 
( )
( )
( ) ( )
( ) ( )ï
ï
î
ï
ï
í
ì
=---++
=--++
=+
-=+++
=
2
3
ref322
3
i1
ref2i1
i1
2
1
ref32
1
i1
res
;2
1;12
0;2
;)(2
dVV
dVV
dV
dVV
V
ggg
gg
g
gg
  (2-3) 
15 
 
 
 
Fig. 2.6 Transfer curves in the ARFCI case when (a) C1 < C2 and Flag = 0, or C1 > C2 and 
Flag = 1. (b) C1 > C2 and Flag = 0, or C1 < C2 and Flag = 1. (Solid line: with capacitor 
mismatch; dotted line: ideal) 
 
2.2.3 Three-in-One Architecture with RFCI, ARFCI, and CFCS Techniques 
 
The RFCI and ARFCI techniques require only simple control logic and a 1-bit 
pseudo-random number that can be produced by a linear feedback shift register (LFSR) 
circuit. The hardware overhead associated with these two techniques is small. Their circuit 
structure and control logic are similar to those using the CFCS technique, so these three 
techniques can be combined in the same architecture, as shown in Fig. 2.3(a). Fig. 2.7 
depicts the control circuits, verified using transistor-level simulation. All required 
control-timing signals are produced by a timing generator and selected by a multiplexer. 
The control signals for the multiplexer comprise the pseudo-random signal, mode 
switching signals, and digital codes. The mode switching signals determine which 
technique is adopted. The selected control-timing signals drive the switches of the ADC 
through digital buffers. When the operation mode is changed, the driving signals of the 
switches are rearranged for different capacitor connections of the required technique. The 
RFCI, ARFCI, and CFCS techniques have distinct characteristics and applications. The 
RFCI technique can be used for applications that receive large input signals and require 
17 
 
randomly chooses either of the capacitor-connection arrangements in Table 2.1 when Flag 
is updated. The full-scale input signal is applied in the simulations, and the noise sources 
exclude thermal noise. The number of Monte Carlo simulations is 300 for each case. 
 
 
 
Fig. 2.8 (a) SFDR and (b) SNDR Monte-Carlo simulations with respectively conventional, 
CFCS, RC, RCFCS, RFCI, and ARFCI techniques 
 
The random scheme can also be joined with conventional or CFCS techniques to 
improve SFDR, but the SNDR is simultaneously decreased by the additional shuffled 
mismatch errors. The simulation results indicate that the RFCI and ARFCI techniques can 
further reduce the harmonic distortion of the conventional ADC to achieve high SFDR 
without sacrificing SNDR. Averaging over 300 results in each case yields the SFDR and 
19 
 
2.4 Circuit Implementation 
 
To demonstrate the effect of the adopted techniques on reducing errors caused by 
capacitor mismatch, other errors from non-idealities of circuits such as opamp finite gain, 
settling errors, and switch-induced errors, are designed small enough. 
Fig. 2.10(a) plots the fully differential architecture of opamps used in the SHA and 
MDAC. The main amplifier circuits use a wide swing, folded cascode architecture to 
obtain a high gain and a wide bandwidth. The gain-boosted amplifiers are added to further 
increase the opamp dc gain that reduces the finite gain errors in the ADC. A 96-dB high 
opamp gain is designed. A high opamp bandwidth of 120 MHz is also obtained to reduce 
the settling errors. Therefore, these two opamp non-idealities have less effect on increasing 
ADC nonlinearities. Fig. 2.10(b) shows the switched-capacitor (SC) common-mode 
feedback circuit of this fully differential opamp. With a 3.3-V supply, the  
 
21 
 
 
Fig. 2.11.  (a) Differential SC comparator and (b) latched comparator. 
 
latch phases. The switch Mc6 is applied to avoid large dc current during track phases. The 
S-R latch is used to hold the logic signal when the previous latch circuit is reset. 
 
2.5 Measurement Results 
 
 
Fig. 2.12.  Die photograph. 
23 
 
 
Fig. 2.14.  Measured FFT plot with the RFCI technique. 
 
 
Fig. 2.15.  Measured FFT plot with the ARFCI technique. 
 
higher SFDR and SNDR, respectively, than the conventional technique for the prototype 
ADC. The ARFCI technique has about 10 dB and 6 dB higher SFDR and SNDR, 
respectively, than the conventional technique. The measurement results demonstrate that 
the RFCI technique can improves upon the SFDR of conventional cyclic ADCs without 
sacrificing the SNDR. The ARFCI technique enhances both the SFDR and SNDR of 
conventional cyclic ADCs while only slightly lowering the conversion rate. Table 2.2 
summarizes the measured ADC performance. 
 
 
25 
 
Chapter 3 
 
Bias-and-Input Interchanging Technique 
for Cyclic/Pipelined ADCs with Opamp 
Sharing  
 
 
 
3.1 Introduction 
 
power consumption is a typical demand of analog-to-digital converters (ADCs) in 
many systems such as mobile and wireless-transmission products. Cyclic/pipelined 
architectures are commonly used for high-resolution and medium-to-high speed ADCs to 
achieve low-power consumption [10]. Various approaches have been proposed to reduce 
power consumption of cyclic/pipelined ADCs. Removing the front end sample-and-hold 
(S/H) [12]–[14] eliminates power consumption induced by the dedicated S/H stage. Stage 
scaling [7] lowers the driving power of the subsequent pipelined stages due to their relaxed 
accuracy requirement. Some methods dynamically operate opamps in ADCs to save power 
and can be combined with approaches for removing front end S/H and stage scaling. 
Among these schemes, the switched-opamp scheme [15], [16] turns off power for opamps 
during idle phases. Sharing opamps between two stages in one channel or across two 
parallel channels reduces the number of opamps [7], [17]–[19]. Although switched opamps 
can save power, their area cost is not reduced and additional turn-on delay issues 
accompany opamp switching. Opamp sharing saves power and area cost simultaneously 
and is superior to switched-opamp schemes; however, non-reset opamp summing nodes 
induce a memory effect on residue signals. Although a high opamp gain can be used to 
reduce the memory effect, a complex opamp structure and high circuit cost are required. 
27 
 
 
Fig. 3.1.  A 10-bit, 1.5-bit/stage pipelined ADC. 
 
multiplying digital-to-analog converter (MDAC). The sub-ADC resolves digital codes for 
the stage input, and the MDAC produces the corresponding residue for the following 
stages. The ADC uses eight 1.5-bit stages with opamp sharing between two stages. The 
ninth stage is a 2-bit sub-ADC. All sub-ADC codes are added with digital error correction 
to generate a final 10-bit digital output. Fig. 3.2 shows a single-ended architecture of two 
1.5-bit MDACs with the opamp sharing in one channel or across two parallel channels. 
The residue equation of a 1.5-bit MDAC is refinout 2 VdVV ×-= , where the sub-ADC code, d, 
Î {–1, 0, 1}. When f1 is high, the ith MDAC samples the signal from the preceding stage, 
and the jth MDAC amplifies the residue for the following stage. When f2 is high, the ith 
MDAC amplifies the residue, and the jth MDAC samples the signal from its preceding 
stage. The ith and jth MDACs use the opamp alternately when in amplifying phases. In 
conventional opamp sharing, the same opamp input pair is always used without resetting 
the opamp summing nodes; this results in the memory effect of the residue signal. We 
assume Cp is the parasitic capacitance at the opamp summing node, and A is the finite 
opamp gain. Hence, the residue equation with the memory effect can be written as 
 
 
29 
 
 
 
 
Fig. 3.3. (a) A gain-boosted FD-BII opamp. (b) A gain-boosted PD-BII opamp. 
 
 
31 
 
simultaneously, as shown in Fig. 3.3(b). With input and bias transistor pairs in the same 
current branches, this PD-BII opamp architecture also has the feature of current reuse, and 
can be regarded as a modified PD version of the opamp architecture proposed in [19]. The 
PD-BII opamp architecture removes tail current sources and can achieve a wider output 
swing. When f1 is high, transistors M1 and M2 are switched as the input pair, and M7 and 
M8 are set as the bias pair. When f2 is high, M7 and M8 become the input pair, and M1 and 
M2 are connected as the bias pair. The input and bias transistor pairs are interchanged 
dynamically to remove the memory effect without an additional preamplifier. Furthermore, 
the PD-BII opamp does not need additional signal-path switches of the FD-BII opamp.  
 
 
 
Fig. 3.4.  Half circuits of (a) flip-around and (b) charge-redistribution PD MDACs with 
floating interconnection. 
 
 
33 
 
 
Table 3.1 Comparison of Opamp Summing Node Resetting Architectures 
Opamp Architecture [8] [19] FD-BII PD-BII 
Redundant Current 
Branches 
Yes No No No 
Normalized Current a  6 b 1 2 1 
Signal Swing c 2 1 2 2 
Power Consumption d 6 4 2 1 
a Opamp current divided by input transconductance. 
b In [8], the current ratio of 1st-stage to 2nd-stage of the opamp is 1:4 . 
c The works with 1.8-V supply are compared; with 1.8-V supply, the signal  
 swing in [8] is assumed to be equal to that in this work. 
d The same SNR and opamp bandwidth are assumed. 
 
÷
÷
ø
ö
ç
ç
è
æ
×+×
=÷
÷
ø
ö
ç
ç
è
æ
=
L
2
PP
PP
noise(rms)
)signal(rms
kT
22log20log20SNR
CV
V
V
V
ba
 (3-2) 
 
where α is a noise factor that depends on jitter noise and quantization noise, and β is a 
noise factor that depends on thermal noise sources from switches and opamps; the impact 
of other noise sources is assumed negligible. The signal swing of opamps in [19] is only 
50% of that in this work. With a 1.8-V supply, the signal swing of opamps in [8] is 
assumed equal to that in this work; i.e., VPP1 = 2VPP2 = VPP3 = VPP4. To compare ADC power, 
the same SNR is considered. The compensation capacitance, CC, of opamps in [8] is 
assumed equal to CL1, and α and β are assumed here to maintain constant for i = 1–4. Thus, 
L1PP1 CV  = L2PP2 CV  = L3PP3 CV  = L4PP4 CV from (2). Hence, 4CL1 = CL2 = 4CL3 = 
35 
 
of opamps are about 66dB and 700MHz, respectively. The turn-on delay accompanied with 
the FD-BII opamp is about 0.6 ns. The series resistances of the switches at summing nodes 
are designed small enough to reduce their effect on the settling behavior. The 
charge-injection and clock-feedthrough of these switches, which are nearly 
signal-independent, are reduced with transmission gates and only cause common-mode 
offsets. 
 
 
Fig. 3.5.  Summing node waveforms of the first shared opamp of the (a) FD-BII ADC 
({M1, M2} is used as input and bias pairs in f1 and f2 phases, respectively. The other 
identical pair is not shown) and (b) PD-BII ADC. ({M1, M2} is used as input and bias pairs 
in f1 and f2 phases, respectively. {M7, M8} is used as input and bias pairs in f2 and f1 
phases, respectively.) 
 
With a 1.8-V supply, a 2-V peak-to-peak differential sine-wave input is adopted in 
simulations. Fig. 3.5 shows opamp summing node waveforms. The BII pairs have finite 
gain errors when they are used as input pairs. When they are then used as bias pairs in the 
next phase, their gate voltages can be reset. Fig. 3.6(a) shows the fast Fourier transform 
(FFT) plot of the FD-BII ADC with a 4.84-MHz input. The ADC has a 
signal-to-noise-and-distortion ratio (SNDR) of 57.2 dB and spurious-free dynamic range 
(SFDR) of 64.7 dB. The power consumption of the ADC is 26 mW, including analog 
37 
 
Chapter 4 
 
 
 
New Nyquist-Rate Current-Steering DAC 
Structure Combining Dynamic Element 
Matching Approaches 
 
 
4.1 Introduction 
 
High-speed high-resolution current-steering DACs are increasingly used for direct 
digital synthesis [1], arbitrary waveform generation and video signal processing. The main 
requirement of the DACs for these applications is good linearity which implies high 
spectral-purity and small output errors. In order to maintain good linearity, trimming and 
calibration have been used to directly decrease element mismatches which results in high 
SFDRs and small maximum output errors. Another approach, dynamic element matching 
(DEM), has been successfully applied to reduce the correlation of the DAC noise to the 
input signal for achieving high SFDRs [1] [25]. Randomization, one of the DEM 
approaches, is mostly used for Nyquist-rate DACs to spread the harmonics as white noise 
over the output spectrum. However, the possible maximum output errors of randomization 
are still large because the elements are selected randomly. In order to improve it, a DEM 
approach, designated “random incrementing data weighted averaging” (RIDWA), is 
39 
 
  
 
Fig. 4.1 Block diagram of a 6-bit DAC 
 
Figure 4.3(a) shows the DAC’s output spectrum where the DAC is ideal, which 
implies that no element mismatches are involved. All the spectra in this chapter are 
obtained by averaging 32 periodograms, each corresponding to 213 samples [1] [25] unless 
explicitly stated otherwise. If element mismatches are included in the simulation, noises 
combining with harmonic distortions appear as shown in Fig. 4.3(b). Randomization, one 
of the stochastic DEM approaches, stochastically selects the elements to represent the 
DAC input codes, which spreads the DAC output distortions widely across the spectrum as 
shown in Fig. 4.3(c). Hence, the stochastic DEM DAC’s mean INLs and output harmonic 
distortions are reduced [25]. However, the maximum output error of each input code is still 
large. For example, the mean INL of input code 3 is nearly equal to zero after randomly 
selecting the elements, but the maximum output error of input code 3 is 0.2428 LSB when 
the sixth, seventh and fifteenth elements are selected, i.e. the three maximum error values 
(E6, E7 and E15) shown in Fig. 4.2(b) are accumulated. 
41 
 
 
Fig. 4.3 DAC output spectra (a) without mismatch errors, (b) with mismatch errors in Fig. 
4.2, (c) with the same mismatch errors and randomization applied, and (d) with the same 
mismatch errors and conventional DWA applied 
 
In order to remedy this problem, proper layout switching schemes, low-area and 
low-power approaches for improving maximum output errors, are used simultaneously. 
The main property of proper layout switching schemes, i.e. the consecutive selection order 
of elements, should be reserved. Therefore, another deterministic DEM, called data 
weighted averaging (DWA) [26], is considered. DWA selects elements consecutively 
without the use of random control bits. However, DWA suffers from mismatch-dependent 
harmonics, as shown in Fig. 4.3(d), due to its input-dependent repetitive selection of 
elements, and so does not meet our requirements. 
43 
 
 
 
 
Fig. 4.4 An example of the element selection of RMDWA 
 
By cycling through all elements a limited number of times, the error is summed to 
zero. Because R is a random bit, cycle1 and cycle2 can be chosen randomly with equal 
probabilities. Therefore, the signal-dependent or mismatch-dependent harmonics caused by 
element mismatches are reduced. Figs. 4.5(a) and 4.5(b) show the output and mismatch 
spectra of the DAC in Fig. 5.1 employing RMDWA with the same element-mismatch 
pattern as shown in Fig. 4.2(b). It can be seen that the noise shaping characteristic arises 
due to DWA, although this characteristic is not useful for Nyquist-rate applications. 
Furthermore, no harmonic appears because of the random selection of the two pointers. 
45 
 
4.3.2 Proposed Random Incrementing Data Weighted Averaging 
 
RMDWA was first proposed to apply DWA-like approaches for Nyquist-rate DAC 
applications. With RMDWA, the Nyquist-rate current-steering DAC structure can achieve 
both benefits of the DEM approach and the proper layout switching scheme, i.e., high 
SFDR performance and small maximum output errors. For this structure, the DEM 
approach should maintain both consecutive selection and randomization properties. In 
order to achieve the two properties with lower complexity and higher speed than the 
state-of-the-art approach (RMDWA), a new DEM approach, called “Random Incrementing 
Data Weighted Averaging (RIDWA)”, is proposed. 
 
4.3.2.1 Operation Principle of RIDWA 
 
As shown in Fig. 4.7, a 3-bit thermometer-coded DAC is used to demonstrate the 
principle of RIDWA with an incrementing factor (IF) of 5, where the selected IF is just for 
illustration. Based on the simple selection principle of conventional DWA [26], RIDWA 
also cycles through the DAC elements by consecutively selecting the elements according 
to the input codes, but increments the starting element for the next input by a fixed step, i.e. 
the incrementing factor, randomly. Random bit, Ran, as shown in Fig. 4.7, determines 
whether the incrementing action will be performed or not. DAC input codes of 5, 7, 4, 2, 6 
and Ran inputs of 0, 0, 1, 1, 0 are used as an example to illustrate the operation principle of 
RIDWA. In the beginning, the values of ptr and newptr are 0, where ptr and newptr are the 
starting pointers of the selection for the next input code before and after the incrementing 
action, respectively. For an initial input of 5 and Ran=0, elements {U0, U1, U2, U3, U4} are 
selected. As a result, the value of ptr becomes 5 as conventional DWA. Because Ran=0, no 
incrementing action is performed, i.e., newptr equals ptr. For the second input of 7 and 
Ran=0, elements {U5, U6, U7, U0, U1, U2, U3} are selected. The value of ptr becomes 4 and 
newptr equals ptr. For the third input of 4 and Ran=1, elements {U4, U5, U6, U7} are 
47 
 
truth table. When Ran=0, i.e. there is no incrementing action performed, newptr remains 
the value of ptr. When Ran=1, i.e. the incrementing action should be performed, newptr 
will be changed according to the value of ptr. If ptr=0, newptr will be incremented to be 1, 
else if ptr=1, newptr will be minus-incremented to be 0. Therefore, the incrementing action 
of RIDWA can be performed by an XOR array instead of an adder. 
 
 
 
 
 
Fig. 4.8 XOR gate and its truth table 
 
 
For the 3-bit, 8-element example described in section 4.3.2.1, the operations become 
those shown in Fig. 4.9. Because the incrementing factor 5 in decimal is “101” in binary, 
two XOR gates are used at the newptr[2] and newptr[0] bits for comparison with section 
4.3.2.1, where newptr[n] means the nth bit of newptr. For the first input of 5 and Ran=0, 
elements {U0, U1, U2, U3, U4} are selected and the value of ptr becomes 5 as conventional 
DWA. Because Ran=0, newptr equals ptr. For the second input of 7 and Ran=0, elements 
{U5, U6, U7, U0, U1, U2, U3} are selected. The value of ptr becomes 4 and newptr equals 
ptr. For the third input of 4 and Ran=1, elements {U4, U5, U6, U7} are selected and the 
49 
 
 
 
Fig. 4.10 The low-cost implementation of RIDWA 
 
Fig. 4.10 shows the block diagram of the low-cost implementation for RIDWA. One 
M-bit binary-to-thermometer encoder, 2M barrel shifters, one M-bit adder, one M-bit 
register, one L-bit XOR array and one K-bit pseudo random number generator are 
required.  
For the DAC in Fig. 4.1 employing RIDWA, the selection of the incrementing factor 
(IF) is discussed and verified by simulation. Fig. 4.11 shows the verification results for the 
maximum mismatch tone power of the DAC employing RIDWA with different IFs. When 
the value of IF is small or large, the randomization property of RIDWA is not strong 
enough to whiten the mismatch spectrum. Thus, medium values of IF are suggested to be 
used except the value of N/2. Because the codes of the input sinewave have the average 
value of N/2 and are symmetrical to the average value, the IF value of N/2 causes 
51 
 
 
 
Fig. 4.12 (a) Output and (b) mismatch spectra of the DAC employing RIDWA 
 
4.3.3 Performance Verifications of RIDWA 
 
In order to evaluate the performance of RIDWA, several verifications are performed. 
Fig. 4.13(a) shows the plots of maximum tone power, which is the power of the highest 
tone above the noise floor in the output spectrum, relative to a full-scale input signal power 
of the DAC for input amplitudes from 0dBc to -74dBc with -1dBc step corresponding to 
full-scale and input frequencies from (73/4096)·fs to (1993/4096)·fs with (60/4096)·fs step. 
All the maximum tone powers are lower than -63dB, which implies that RIDWA can 
obtain very high spurious-free dynamic range (SFDR) performance. For the two-tone test, 
RIDWA performs as well as in the single-tone test, where no observable tones appeared, as 
shown in Fig. 4.13(b). In the two-tone test, the amplitudes of the two sinusoidal 
components are 1/2 full-scale with (313/4096)·fs and (1033/4096)·fs frequencies.  
 
 
 
 
53 
 
Recently, several DWA-like approaches [27]-[38] have been proposed to circumvent 
the DWA tone problem for oversampling-rate data converters [26]. However, the purpose 
of these approaches is to disturb the repetition of mismatch patterns caused by the DAC 
input codes due to the property of delta-sigma modulation at medium input for 
oversampling-rate data converters, which is different to that of RMDWA and RIDWA to 
de-correlate the DAC noise from the input signal for Nyquist-rate data converters. 
Adaptively randomized DWA [37] resets its starting pointer for each randomization 
interval (RI) depending on its input amplitudes. Pseudo DWA [31] modifies the 
conventional DWA scheme by periodically inverting the LSB of the DAC input code used 
to update the index pointer in respective clock cycle. Partitioned DWA [30] partitions the 
DAC into two sub-DACs with half number of elements and independently performs the 
conventional DWA behavior, where one accepts the quotient plus remainder of the DAC 
input code divided by 2 and another only applies the quotient. DWA with randomly 
reversal direction of rotation [38] changes its rotation direction for each RI randomly. 
Bi-directional DWA [29] uses two separate pointers for the odd and even clock cycles and 
perform conventional DWA behavior. Rotated DWA [28] keeps different circular patterns 
for the selection of DAC elements in memory which the hardware becomes complex and 
large for the DAC with more than 8 elements. 
As shown in Fig. 4.14, adaptively randomized DWA with RI = 64, pseudo DWA with 
ninv (the number of clock cycles between each inversion) = 64, partitioned DWA, DWA 
with randomly reversal direction of rotation and RI = 64, bi-directional DWA, and rotated 
DWA with six circles and MTBS (mean time between switching) = 64 all suffer from 
tones because their randomization components are not strong enough to de-correlate the 
DAC noise from the input signal for Nyquist-rate data converters. 
 
55 
 
If the design parameters of these approaches are modified to fit the randomization 
requirement of Nyquist-rate data converters, adaptively randomized DWA, DWA with 
randomly reversal direction of rotation, and rotated DWA can achieve good spectral-purity 
as shown in Fig. 4.15. However, the implementation of rotated DWA is very complex 
especially for DAC bit number larger than 3 [28]. DWA with randomly reversal direction 
of rotation needs extra implementations of repeating the arithmetic block and performing 
subtraction [38]. For adaptively randomized DWA, although it only needs one pointer to 
perform DWA behavior, M K-bit pseudo random number generators for M bit DAC and 
other circuits for adaptive behavior are required [37]. Therefore, RIDWA is an appropriate 
approach specifically for Nyquist-rate data converters with good spectral purity and low 
implementation complexity. 
 
 
 
Fig. 4.15 DAC spectra employing (a) adaptively randomized DWA (b) DWA with 
randomly reversal direction of rotation and (c) rotated DWA with proper design parameters 
 
57 
 
Chapter 5 
 
Low-Cost 14-Bit Current-Steering DAC 
with a Randomized Thermometer-Coding 
Approach 
 
 
 
5.1 Introduction 
 
Current-steering digital-to-analog converters (DACs) are widely used in wired and 
wireless transmitters, direct digital synthesis, and video signal processing because of their 
high operation speed. One of the major impairments of high-resolution current-steering 
DACs is element mismatch. Trimming, calibration, proper layout switching scheme and 
dynamic element matching (DEM) have been successfully used to reduce element 
mismatch effects. As a DEM approach, Data weighted averaging (DWA) is widely used for 
oversampling-rate applications [35]. In Nyquist-rate applications, random multiple data 
weighted averaging (RMDWA) [41] was first proposed for current-steering DACs. The 
RMDWA owns the properties of randomization and consecutive selection. With a proper 
layout switching scheme, the effect of large mismatch caused by small transistors can be 
reduced and small-area DACs can be realized. However, with RMDWA, element switching 
activity is increased and thus dynamic errors are increased [44]. In this chapter, a new 
DEM approach, randomized thermometer-coding (RTC), is proposed [44]. In addition to 
59 
 
 
Fig. 5.1 Operation principles of the RTC approach for (a) RP=2 and (b) RP=4 
 
5.2.1 Operation Principle 
 
To maintain low switching activity, the starting element of the thermometer-coding 
approach remains unchanged for a specified number of input samples. The number is 
named as randomization period (RP). For the next RP, the starting element of the 
thermometer-coding approach is randomly regenerated. Figs. 5.1(a) and 5.1(b) show an 
8-element DAC to illustrate the principle of the RTC approach with RPs of 2 and 4, 
respectively. DAC input codes of 5, 7, 4, 2, 6, 1, 3, and 5 were used as examples. Initially, 
the value of SP was 0, where SP is the starting pointer of the element selection for the 
respective input code. As shown in Fig. 5.1(a), for RP=2 and an initial input of 5, elements 
{U0, U1, U2, U3, U4} were selected. For the second input of 7, elements {U0, U1, U2, U3, U4, 
U5, U6} were selected, which are the same as those for the conventional 
61 
 
conversion errors for 1][ =nar  and 0][ =nar . Hence, l
T
h
T enaenane ][][][ += . If ][na  
is a sequence of independent random variables, ][ne  has a white spectrum and is 
uncorrelated with x[n] [46]. Therefore, the value of RP for the RTC approach affects the 
shape of the white spectrum of ][ne . 
 
S
to
ch
as
tic
E
nc
od
er
 
 
Fig. 5.2 An M-bit, N-element DAC 
 
To verify the performance of the RTC approach, a 6-bit 64-element DAC is used. The 
element-mismatch error profile with joint error distribution (50% linear + 50% quadratic) 
shown in Fig. 5.3(a) is used. The respective element mismatch values are shown in Fig. 
5.3(b) and have a 3.3% standard deviation. A full-scale dithered sinusoid with a frequency 
of (11/4096)·fs is applied to the DAC, where fs is sampling frequency. The dither sequence 
is a white sequence with a triangular probability density function distributed on (-Δ, Δ), 
where Δ is the least significant bit size of the DAC. All simulated spectra in this section 
were obtained by averaging 32 periodograms, each corresponding to 213 samples, unless 
explicitly stated otherwise. 
63 
 
 
   (a)   (b) 
 
   (c)  (d) 
 
   (e)    (f) 
 
Fig. 5.4 Mismatch spectra of the DAC applying the RTC approach with RP = (a)1, (b)2, 
(c)4, (d)8, (e)16, and (f)32. 
 
65 
 
well as that in the single-tone test with no observable tone, as shown in Fig. 5.6(b). In the 
two-tone test, the amplitudes of the two sinusoidal components are 1/2 full-scale with 
(313/4096)·fs and (1033/4096)·fs frequencies, respectively. 
 
 
 
Fig. 5.6 (a) Maximum tone power of the DAC with different input frequencies and 
amplitudes, (b) DAC output spectrum employing the RTC approach for the two-tone test 
 
 
5.2.3 Low-Complexity RTC Realization 
 
Fig. 5.7 shows a block diagram of the low-complexity RTC realization. Using an 
M-bit binary-to-thermometer encoder and 2M barrel shifters, the RTC approach encodes the 
M-bit DAC input codes into 2M RTC selection signals. Thus, the 2M RTC selection signals 
have consecutive selection property. A K-bit pseudo random number generator and a clock 
divider are also required. The clock divider is used to generate a time period as the value of 
RP so that the thermometer codes are barrel-shifted to the specific positions according to 
the pseudo-random-generated starting pointer for each RP. 
 
67 
 
part is a concern. To obtain a 99.7% yield for B-bit matching accuracy using the equation 
derived in [47], the relative standard deviation of the LSB unit current can be obtained as 
 
BB
LSB
I
CI
LSB
21.32
1
22
1
××
=<
s
,                     (5-1) 
 
where ÷
ø
ö
ç
è
æ +=
2
5.0_ YinorminvC , inv_norm(.) is a inverse cumulative normal 
distribution function, Yi is the relative yield of the DAC with an INL < 0.5LSB. If more 
bits are dedicated to the binary-code part, the required accuracy of the DAC and the area of 
the current cell are both increased. If more bits are dedicated to the thermometer-code part, 
the implementation complexity and the power consumption of the RTC approach are both 
increased. To further reduce the complexity and power consumption of the RTC approach, 
if 2M bits are dedicated to the thermometer-code part, the 2M-bit thermometer-code part is 
divided into two M-bit thermometer-code sub-parts. Therefore, the DAC is segmented into 
M most significant bits (MSBs), M upper least significant bits (ULSBs), and B lower least 
significant bits (LLSBs). Considering the above for the 14-bit DAC, Table 5.1 lists the 
segmentation tradeoff options. For example, if the segmentation of 4+4+6 is adopted, the 
required relative standard deviation of the LSB unit current is two times smaller than that 
of the segmentation of 5+5+4, i.e. the required area of the current cell is four times larger 
than that of the segmentation of 5+5+4. However, the number of unary elements of the 
segmentation of 5+5+4 is more than two times larger than that of the segmentation of 
4+4+6, resulting in greatly increased implementation complexity and power consumption 
of the RTC approach. In addition, the layout complexity of the proper layout switching 
scheme employed with the RTC approach is also increased. 
 
 
 
 
69 
 
Fig. 5.9 shows the output spectrum of the 14-bit DAC with the segmentation of 4 
MSBs, 4 ULSBs and 6 LLSBs. Its corresponding element mismatches are generated with 
a 2% standard deviation according to (5-1). As shown in Fig. 5.9, the spectrum shape of 
the noise floor is similar to that of the noise floor shown in Fig. 5.4(c), which is affected 
by the value of RP. Some high frequency spurs, which can be caused by the mismatches 
of the LLSB elements, are observed because there is no DEM approach applied to the 
LLSB elements. Monte-Carlo simulation results confirm that if current sources with 6-bit 
matching accuracy are adopted for the 14-bit DAC with the segmentation described above, 
the RTC approach can suppress harmonic distortions caused by mismatches to achieve 
SFDRs of over 80dB as shown in Fig. 5.10. 
 
Normalized frequency (fs)
 
 
Fig. 5.9 Output spectrum of the 14-bit DAC applying RTC and the corresponding element 
mismatches with a 2% standard deviation 
71 
 
mismatch process parameter, respectively. Using the square-law model, the W/L ratio can 
be expressed as  
 
( )2
2
tgsox
LSB
VVC
I
L
W
-
=
m
  (5-3) 
 
where ILSB is the current value of the LSB current cell, μ is the effective surface mobility of 
the carriers in the transistor channel and Cox is the gate capacitance per unit area. With an 
overdrive voltage, i.e., Vgs - Vt, of 300-mV and a full-scale output current of 10mA, the 
LSB current-source transistor has dimensions of 0.68μm/2.94μm. 
 The cascoded transistor is designed with a 150mV overdrive voltage and with the 
same channel width as that of the current-source transistor to simplify layout and to reduce 
parasitic capacitance. The current switch transistors use the minimum channel length for 
high operation speed and power saving. 
 
5.3.2 Return-to-Zero Circuit 
 
The dynamic performance of the current steering DAC is limited by many factors [51]. 
Digital control signal feed-through to the output nodes is one of the major factors. A new 
return-to-zero circuit with isolation transistors is proposed to improve the dynamic 
performance of the DAC. Isolation transistors Mi1 and Mi2, as shown in Fig. 5.11(a), 
cascoded to the drains of the switching transistors for the current cells of the DACs, can be 
used to decrease the coupling of the control signals to the output nodes [51]. Unfortunately, 
these isolation transistors increase the output settling time and result in different rise and 
fall times [51]. Fig. 5.11(b) shows a simplified half-branch schematic of the current cell 
used for settling time analysis. When the gate state of M2 is changed from low to high, the 
current through M2 is switched off. However, due to the stored charge in the parasitic 
capacitor CA, there is a discharging current flowing to the output node through Mi2. The 
73 
 
 
Fig. 5.11 (a) Current cell with isolation transistors, (b) its simplified half-branch schematic 
and (c) its simplified half-branch schematic with a discharging transistor 
 
 In order to solve this problem, an extra discharging path is added to node A as shown 
in Fig. 5.11(c). When Mdis is switched on, the charge stored in CA is discharged rapidly 
because of the designed high driving capability of Mdis. In addition to discharging node A, 
the added transistors MRTZ1 and MRTZ2, as shown in Fig. 5.12(a), can also be used as RTZ 
transistors. When the RTZ control signal turns MRTZ1 and MRTZ2 on, the current from M3 
will flow through MRTZ1 or MRTZ2 according to the control signals of current switches M1 
and M2. Therefore, no current will flow through the isolation transistors Mi1 and Mi2, i.e., 
Mi1 and Mi2 are turned off, and the output voltages will settle to zero with a time constant 
of RLCL. Because the isolation transistors Mi1 and Mi2 are turned off, the signal dependent 
coupling of the control signals will be isolated during the RTZ period. Therefore, the 
proposed RTZ circuit can achieve the properties of RTZ and isolation. Instead of using two 
large RTZ transistors at the DAC output nodes, each current cell of the DAC contains its 
own RTZ transistors. For low-cost concerns, the RTZ transistors should be properly 
75 
 
5.4 Measurement Results and Comparisons 
 
Fig. 5.13 shows the measured DAC output spectrum for 1MHz single-tone signal 
sampled at 10MHz with the RTC approach and the RTZ circuits both enabled. Harmonic 
distortions are labeled in Fig. 5.13 and some other un-labeled tones can be caused by the 
mismatches of the LLSB elements. The SFDR is 80.7dB. The measured noise floor, 
especially the low-frequency noise, in Fig. 5.13 is dominated by the intrinsic noise of the 
spectrum analyzer [53], such that the measured noise floor is not matched to the simulated 
one in Fig. 5.9. If the RTC approach is disabled and the RTZ circuits is still enabled, the 
measured SFDR becomes 63dB. It shows that the RTC approach greatly suppress 
harmonic distortions caused by element mismatches. For the input frequencies of 400kHz, 
1MHz, 2MHz, 3MHz, 4MHz and 4.88MHz, the measured SFDRs are 80.7dB, 80.7dB, 
80.0dB, 80.0dB, 80.0dB and 80.6dB as shown in Fig. 5.14, respectively. Measurement 
results show that the RTC approach is a very effective means to obtain high SFDR when 
small transistors with less matching are used. Fig. 5.15 shows a measured two-tone 
spectrum. The two tones are spaced 293kHz apart centered on 2.5MHz at a sample rate of 
10MHz. The third-order inter-modulation distortion spur is -77.7dB with respect to the 
signal amplitude of the two output tones. 
77 
 
 
 A 
CLRWR
1 AP
Ref -10 dBm
500 kHz/Start 0 Hz Stop 5 MHz
*
*
RBW 300 Hz
VBW 1 kHz
SWT 56 sAtt  20 dB*
SGL
PRN
-110
-100
-90
-80
-70
-60
-50
-40
-30
-20
-10 1
Marker 1 [T1 ]
          -17.35 dBm
     2.411858974 MHz
2
Delta 2 [T1 ]
          -77.34 dB 
     2.051282051 MHz
3
Delta 3 [T1 ]
          -77.70 dB 
   392.628205128 kHz
Date:      11.JUL.2008  17:47:34  
 
Fig. 5.15 Measured two-tone spectrum 
 
The DAC was fabricated in a 0.18μm 1P6M CMOS process. Fig. 5.16 shows a 
photograph of the chip, which has an active area of less than 0.28mm2. Table 5.2 
summaries the specifications of the DAC and state-of-the-art 14-bit DACs. Compared to 
the state-of-the-art 14-bit DACs, the implemented DAC using the proposed RTC approach 
achieves the smallest active area, as shown in Fig. 5.17. Furthermore, compared to other 
10-bit and 12-bit DACs, the area of the DAC is still smaller than those of them. 
 
 
79 
 
 
Fig. 5.17 Area comparison to other DACs with different resolutions 
 
 
5.5 Summaries 
 
A new DEM approach, named “randomized thermometer-coding (RTC)”, has been 
proposed. The proposed RTC approach has been analyzed and simulation results show that 
the harmonic distortions are greatly suppressed by it. The implemented 14-bit 
current-steering DAC using the RTC approach achieves a small active area less than 0.28 
mm2 in a 0.18-μm CMOS process. For very high speed DAC applications, such as 
gigahertz communication systems, the operation speed of the RTC approach and the 
segmentation tradeoff of the DAC should be further improved and investigated to meet the 
high speed requirements. 
 
81 
 
To verify the approaches proposed in this project, a 14-bit current-steering DAC has 
been implemented in TSMC 1.8V, 0.18μm, 1P6M CMOS process. The DAC uses a new 
proposed DEM approach, named “randomized thermometer-coding”, to substantially 
suppress harmonic distortions and decrease maximum output errors with low element 
switching activity. The 14-bit DAC with the proposed RTC approach has an active area 
less than 0.28 mm2. Measurement results show that the RTC approach is a very effective 
means to obtain high SFDR when small transistors with less matching are used. The active 
area of the DAC is smaller than those of the state-of-the-art DACs with 14-bit resolution. 
The active area of the DAC is also smaller than those of other published 12-bit and 10-bit 
DACs. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
83 
 
[12] D. Y. Chang, “Design techniques for a pipelined ADC without using a front-end 
sample-and-hold amplifier,” IEEE Trans. Circuits Syst. I, Fundam.Theory Appl., vol. 
51, no. 11, pp. 2123–2132, Nov. 2004. 
[13] Y. D. Jeon, S. C. Lee, K.-D. Kim, J.-K. Kwon, and J. Kim, “A 4.7mW 0.32mm2 10b 
30MS/s pipelined ADC without a front-end S/H in 90nm CMOS,” in IEEE Int. 
Solid-State Circuits Conf. Dig. Tech. Papers, pp. 456–457, 615, Feb. 2007. 
[14] J. Li, X. Zeng, L. Xie, J. Chen, J. Zhang, and Y. Guo, “A 1.8-V 22-mW 10-bit 
30-MS/s pipelined CMOS ADC for low-power subsampling applications,” IEEE J. 
Solid-State Circuits, vol. 43, no. 2, pp. 321–329, Feb. 2008. 
[15] M. Waltari and K. A. I. Halonen, “1-V 9-bit pipelined switched-opamp ADC,” IEEE J. 
Solid-State Circuits, vol. 36, no. 1, pp. 129–134, Jan. 2001. 
[16] H. C. Kim, D. K. Jeong, and W. Kim, “A partially switched-opamp technique for 
high-speed low-power pipelined analog-to-digital converters,” IEEE Trans. Circuits 
Syst. I, Fundam.Theory Appl., vol. 53, no. 4, pp. 795–801, Apr. 2006. 
[17] K. Nagaraj, H. S. Fetterman, J. Anidjar, S. H. Lewis, and R. G. Renninger, “A 
250-mW, 8-b, 52-Msamples/s parallel-pipelined A/D converter with reduced number 
of amplifiers,” IEEE J. Solid State Circuits, vol. 32, no. 3, pp. 312–320, Mar. 1997. 
[18] B. M. Min, P. Kim, F. W. Bowman, III, D. M. Boisvert, and A. J. Aude, “A 69-mW 
10-bit 80-MSample/s pipelined CMOS ADC,” IEEE J. Solid-State Circuits, vol. 38, 
no. 12, pp. 2031–2039, Dec. 2003. 
[19] S. T. Ryu, B. S. Song, and K. Bacrania, “A 10-bit 50-MS/s pipelined ADC with 
opamp current reuse,” IEEE J. Solid-State Circuits, vol. 42, no. 3, pp. 475–485, Mar. 
2007. 
[20] C. H. Kuo, C. C. Lin, T. H. Kuo, and K. L. Wen, “Bias-and-input interchanging 
technique for cyclic/pipelined ADCs with opamp sharing,” IEEE Trans. Circuits Syst. 
II. (minor revision) 
[21] D. Miyazaki, S. Kawahito, and M. Furuta, “A 10-b 30-MS/s low-power pipelined 
CMOS A/D converter using a pseudodifferential architecture,” IEEE J. Solid-State 
Circuits, vol. 38, no. 2, pp. 369–373, Feb. 2003. 
[22] E. B. Blecker, T. M. McDonald, O. E. Erdogan, P. J. Hurst, and S. H. Lewis, “Digital 
background calibration of an algorithmic analog-to-digital converter using a 
simplified queue,” IEEE J. Solid-State Circuits, vol. 38, no. 6, pp. 1059–1062, Jun. 
85 
 
[32] M. Vadipour, “Techniques for preventing tonal behavior of data weighted averaging 
algorithm in Σ-Δ modulators,” IEEE Trans. Circuits Syst. II, vol. 47, no. 11, pp. 
1137-1144, Nov. 2000. 
[33] I. Fujimori, A. Nogi, and T. Sugimoto, “A multibit delta-sigma audio DAC with 
120-dB dynamic range,” IEEE J. Solid-State Circuits, vol. 35, no. 8, pp. 1066-1073, 
Aug. 2000. 
[34] K. D. Chen and T. H. Kuo, “An improved technique for reducing baseband tones in 
sigma-delta modulators employing data weighted averaging algorithm without adding 
dither,” IEEE Trans. Circuits Syst. II, vol. 46, no. 1, pp. 63-68, Jan. 1999. 
[35] T. H. Kuo, K. D. Chen and H. R. Yeng, “A wideband CMOS sigma-delta modulator 
with incremental data weighted averaging,” IEEE J. Solid-State Circuits, vol. 37, no. 
1, pp. 11-17, Jan. 2002. 
[36] D. H. Lee, “Advanced data weighted averaging technique for multi-bit oversampling 
data converters,” Master Thesis, June 2001. 
[37] Y. I. Park, S. Karthikeyan, W. M. Koe, Z. Jiang and T. C. Tan, “A 16-bit, 5MHz 
multi-bit sigma-delta ADC using adaptively randomized DWA,” in Proc. IEEE CICC, 
Sept. 2003, pp. 115-118. 
[38] M. R. Miller and C. S. Petrie, “A multibit sigma-delta ADC for multimode receivers,” 
IEEE J. Solid-State Circuits, vol. 38, no. 3, pp. 475-482, March 2003. 
[39] Y. Cong and R. L. Geiger, “Switching sequence optimization for gradient error 
compensation in thermometer-decoded DAC arrays,” IEEE Trans. Circuits Syst. II, 
vol. 47, no. 7, pp. 585-595, July 2000. 
[40] Y. H. Lin, D. H. Lee, C. C. Yang and T. H. Kuo, “High-speed DACs with random 
multiple data-weighted averaging algorithm,” in Proc. IEEE ISCAS, May 2003, pp. 
I-993-I-996. 
[41] D. H. Lee, Y. H. Lin and T. H. Kuo, “Nyquist-rate current-steering digital-to-analog 
converters with random multiple data-weighted averaging technique and QN rotated 
walk switching scheme,” IEEE Trans. Circuits Syst. II, vol. 53, no. 11, pp. 1264-1268, 
87 
 
quadrature modulator with on-chip D/A converter,” IEEE J. Solid-State Circuits, vol. 
38, no. 10, pp. 1635-1642, Oct. 2003. 
[52] K. O’Sullivan, C. Gorman, M. Hennessy and V. Callaghan, “A 12-bit 320-MSample/s 
current-steering CMOS D/A converter in 0.44mm2,” IEEE J. Solid-State Circuits, vol. 
39, no. 7, pp. 1064-1072, July 2004. 
[53] Spectrum Analyzer R&S FSU Data Sheet. ROHDE&SCHWARZ. 
[54] K. L. Chan, J. Zhu and I. Galton, “A 150MS/s 14-bit segmented DEM DAC with 
greater than 83dB of SFDR across the Nyquist band,” in Symp. VLSI Circuits Dig. 
Tech. Papers, June 2007, pp. 200-201. 
[55] J. Hyde, T. Humes, C. Diorio, M. Thomas and M. Figueroa, “A 300-MS/s 14-bit 
digital-to-analog converter in logic CMOS,” IEEE J. Solid-State Circuits, vol. 38, no. 
5, pp. 734-740, May 2003. 
[56] Q. Huang, P. A. Francese, C. Martelli and J. Nielsen, “A 200MS/s 14b 97mW DAC in 
0.18μm CMOS,” in IEEE ISSCC Dig. Tech. Papers, Feb. 2004, pp. 364-365. 
[57] T. Chen and G. G. E. Gielen, “A 14-bit 200-MHz current-steering DAC with 
switching-sequence post-adjustment calibration,” IEEE J. Solid-State Circuits, vol. 42, 
no. 11, pp. 2386-2394, Nov. 2007. 
[58] H. H. Chen, J. Lee, J. Weiner, Y. K. Chen and J. T. Chen, “A 14-b 150MS/s CMOS 
DAC with digital background calibration,” in Symp. VLSI Circuits Dig. Tech. Papers, 
June 2006, pp. 51-52. 
[59] A. Van den Bosch, M. Borremans, M. Steyaert and W. Sansen, “A 12b 500MSample/s 
current-steering CMOS D/A converter,” in IEEE ISSCC Dig. Tech. Papers, Feb. 2001, 
pp. 366-367. 
[60] J. Deveugele, M. S. J. Steyaert, “A 10-bit 250-MS/s binary-weighted current-steering 
DAC,” IEEE J. Solid-State Circuits, vol. 41, no. 2, pp. 320-329, Feb. 2006. 
[61] A. Van den Bosch, M. A. F. Borremans, M. S. J. Steyaert and W. Sansen, “A 10-bit 
1-GSample/s Nyquist current-steering CMOS D/A converter,” IEEE J. Solid-State 
Circuits, vol. 36, no. 3, pp. 315-324, March 2001. 
89 
 
Patents 
l D. H. Lee and T. H. Kuo, “Return-to-Zero Current-Steering DAC with Clock-to- 
Output Isolation,” U.S. Patent 7,576,675, Aug. 18, 2009. 
l D. H. Lee, T. H. Kuo, "Randomized Thermometer-Coding Digital-to-Analog 
Converter," US Patent (pending) 
可供推廣之研發成果資料表 
□ 可申請專利  ■ 可技術移轉                                  日期：2009 年 10 月 30 日 
國科會補助計畫 
計畫名稱：高解析低成本高速類比/數位及數位/類比轉換器設計 
計畫主持人：郭泰豪 
計畫編號：NSC95-2221-E-006-447-MY3  
學門領域：積體電路與系統設計 
技術/創作名稱 應用於極低成本高解析度數位類比轉換器之動態元件匹配技術 
發明人/創作人 李大輝、郭泰豪 
技術說明 
一個名為隨機式溫度計編碼的技術，可應用於數位類比轉換器電
路，以改善因非理想電路之不匹配效應所造成的諧波失真問題。本
技術屬於一種新的動態元件匹配技術，擁有隨機化、連續選擇及較
少切換動作等三種特性，這三種特性使得本技術可以獲得高無失真
訊號動態範圍以及低最大輸出誤差。因此，數位類比轉換器的雜訊
將可被隨機化而仍能有較低的元件切換動作及元件連續選擇特
性。本技術是獲得高無失真訊號動態範圍的極有效技術，即便電路
使用了較差匹配特性的小面積電晶體。本技術可以顯著地抑制因為
小面積電晶體之較差匹配特性所造成的諧波失真問題，因此可以被
應用在實現極低成本數位類比轉換器電路上。本技術的實現電路相
當簡單，加上數位類比轉換器電路中之電流源電路面積可以因本技
術有效抑制電路不匹配效應而變得很小。因此，對數位類比轉換器
電路而言，使用本技術將能同時得到高無失真訊號動態範圍及低實
現面積。 
A randomized thermometer-coding (RTC) approach applied on 
digital-to-analog converters (DACs) for the reduction of harmonic 
distortion due to non-ideal circuit mismatch is presented. The present 
invention introduces a new dynamic element matching technique that 
contains three properties of randomization, consecutive element 
selection and less element switching activity to achieve good 
spurious-free dynamic range (SFDR) and small maximum output error. 
Thus, the DAC noise is randomized with less element switching 
activity and consecutive element selection. The RTC approach is a very 
effective means to obtain high SFDR when small transistors with less 
matching are used. It can be used to significantly suppress harmonic 
distortion caused by large mismatch of small-area transistors and thus 
very low-cost DACs can be realized. The RTC circuit is very simple. 
Additionally, the area of DAC current cells can be very small because 
the mismatch effect is substantially suppressed by using the RTC 
method. Hence, for DACs, both high SFDR and small active area can 
be achieved with the RTC method. 
可利用之產業 
及 
可開發之產品 
IC 設計產業/ 
手機晶片、數位電視晶片、DVD 撥放晶片、通訊相關之收發器、
直接數位頻率合成(DDFS) 
91
附錄 
出  國  結  案  報  告  書 
 
2009 IEEE Asia Pacific Conference on 
Circuits and Systems 
 
 
經  費  來  源 : 行政院國家科學委員會       
出    差    人 : 劉家銘 
出  國  期  間 : 2008/11/30 ~ 2008/12/03 
會  議  期  間 : 2008/11/30 ~ 2008/12/03 
出  國  地  點 : 澳門 
指  導  教  授 : 郭泰豪 教授     
學  校  單  位 : 國立成功大學 
 
 
 
 
中 華 民 國 97 年 12 月 05 日 
 
主辦單位澳門大學許多電機電子相關領域畢業學生都會進入這家公司工作。論文
發表順序為第四位，共五位。以英文口頭報告約十分鐘左右，之後由與會者提問。
提問情況踴躍，共有五到六個問題之多，席間包括吉林大學的教授、任職於
Chipidea 的工程師以及 Session 主席暨永雄教授等均對發表內容感興趣。 
    詳細會議議程如下： 
 
 
 
 
四、心得 
    IEEE Asia Pacific Conference on Circuits and Systems與會人數眾多，有許多交
流的機會，此行除了做好份內發表會議論文之工作外，磨練自己以英文口頭報告
並針對即席提問回答的能力，對於一博士班學生而言是相當重要之訓練，非常感
謝國科會能夠對此加以補助。除此之外，也抓緊機會在會議之休息時間與各國在
同技術領域菁英交流並對其發展現況積極瞭解。 
 
 
 

