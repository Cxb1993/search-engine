 2
新的應用方向，都需要有容量大且易
於管理的視訊資料庫(Video Database)
系統(如圖 1)，以存放龐大的視訊資料
及提供使用者存取搜尋的索引功能。 
根據我們的研究結果顯示[2]，電
腦中數位視訊的結構是影響其資料表
達、內容分析計算量、查詢、推理與
認知等功能，是否正確且有效率的主
要因素。因此，結構化的數位視訊
(Structured Video) 是整合電腦與視訊
資料的重要橋樑。以電視新聞為例，
電視新聞的主要結構，依目前的電視
新聞播報方式，節目進行的順序基本
上離不開：新聞片頭、主播提示新聞
內容或直接報導新聞細節、新聞報導
相關訪問與拍錄剪接畫面或新聞現場
連線報導、氣象預報、股市行情、廣
告等過程。在結構化新聞中，必須將
此一順序播報、畫面分項等特性加以
歸納分析，以尋求其結構的規律性，
做為日後對視訊內容進行推理與認知
時的重要依據。本系統即是提供一個
視訊資料庫前端處理工具，協助資料
庫管理者完成結構化視訊分割及場景
類別判別工作。本計畫將以運動類視
訊內容為例，展示其結構化視訊分割
與場景分類工具之應用模式。 
三、結果與討論 
1、相關研究 
本論文中主要以場景變動偵測
(Scene Change Detection, SCD)以及關
鍵畫面擷取這兩個模組完成結構化視
訊分割動作後，再進一步進行場景分
類，而場景變動偵測及場景分類已存
在其相關研究，簡述如下： 
[1]場景變動偵測之相關研究： 
在視訊的拍攝剪輯過程，一個場
景(Scene, Shot)是一個最小單位。因
此，為了藉由場景發生的先後順序，
提昇對視訊內容的整體性了解，進而
提供如關鍵性畫面或小示意圖片
(Thumbnail Images)，視訊資料庫之檢
索 (Indexing)與影片摘要瀏覽 (Video 
Users
Indexing Module
Database Management 
Module
Knowledge Store
Compressed 
Video Data
Annotation
and
Index Store
Raw Data 
Source
Server Video Database
Admin.
Video Object
Annotation
 Module
Query Processing 
Module
Client
Interactive Interface
Module
 
圖 1 視訊資料庫系統 
 4
視訊內容的理解(Understanding)，是語
意層級 (Semantic Level) 非常高且困
難的工作。較易於進行的部分，則是
使用視訊物件特徵值計算或統計來判
斷。而場景分類是重要且有效的一種
方法。 
[2]場景分類之相關研究： 
現今在場景分類方面相關研究，
可分為三種型態，第一種為測量影片
特徵差異(Feature Difference)演算法，
第二種為分群(Clustering)演算法，第三
種為影片動能分析(Motion Analysis)演
算法 
第一種測量影片特徵差異演算法
[7]利用影片中每格畫面的靜態特徵，
如像素的顏色統計值、顏色分布、邊
緣出現強度或比例等，累積計算其平
均值或變化量值後，與場景間特徵值
比較差異，如果差異過大超過所設定
時，此差異過大場景為不同類別場
景。舉例來說，先從每個場景中第一
個畫面開始，循序計算整個場景的顏
色 統 計 平 均 值 （ Color Histogram 
Average）。接下來，比較各場景顏色統
計平均值的差異，以決定兩場景間的
相似度。此種概念是利用影片中相似
場景與場景之間應會有其顏色統計上
相似性，若是差異性過大時，表示此
場景不是同類的。 
第二類場景分類方法為使用分群
（Clustering）[8]演算法將影片場景分
成適當群數，群的距離公式採用畫面
顏色特徵或是其他影像特徵皆可，每
群內之場景畫面相似度高。若經由計
算知道每一個場景特徵值，再經由
K-Mean 分群方式，或是 Fuzzy K-Mean
等演算法將其場景做群組動作，類似
場景將會被分至同群。 
第三類為計算影片中畫面中的動
能分析，畫面動能為畫面與下一張畫
面間物件移動或是變動量，利用區域
間移動值為分類之依據[9]。我們可以
利用光流（Optical Flow）[10]計算影片
中所有畫面間的動能，接著取出區域
最低點（Local Minima）與最高點。此
最低點為區域動能最少的畫面，較靜
態畫面（Stillness），也就是拍攝影片者
要讓觀賞者想要注意的地方，最高點
反之。此動能變化量便可直接對其場
景內容進行分析，進而分類。 
 
2、視訊分割與場景分類系統架構 
本結構化視訊分割與場景分類工
具 系 統 （ A Structured Video 
Segmentation and Scene Classification 
Tool for Video Database Systems, 
表 1、場景變動偵測演算法比較表 
場景變換型態 
場景變動演算法 
停拍 溶景 淡入淡出 
Color Histogram Differences √   
Edge Change Ration √ √ √ 
Standard Deviation of Pixel Intensities  √  
Edge-Based Contras   √ 
 6
我們改良的 ECR 場景變動偵測法
定義兩個邊緣變化率，其一為離開邊
緣像素（Exiting Edge Pixel，Outgoing 
Edge Pixel），此為在畫面 In 邊緣像素，
卻不存在於下一個畫面 In+1 之邊緣像
素中，也就是原屬於畫面 In 之邊緣像
素，卻消失在在畫面 In+1 中。其二為進
入邊緣像素（Entering Edge Pixel，
Incoming Edge Pixel），是在畫面 In 邊
緣像素不存在，卻存在於下一個畫面
In+1 之邊緣像素中，也就是原不屬於畫
面 In 之邊緣像素，卻出現在畫面 In+1
中。此離開邊緣像素與進入邊緣像素
比例關係，可用來偵測場景內容改變
的份量。離開邊緣像素與進入邊緣像
素值，需經過畫面邊緣計算流程計算
出來，此計算流程步驟如下。 
 
[1] 第一步驟，是將全彩畫面轉成灰
階。也就是把 RGB 色彩空間轉成
YCrCb 色彩空間，取其明亮度元
件(Luminance Component) Y 值，
做為轉換後影像灰階值。 
[2] 第二步驟，是對其兩個連續畫面
In 與 In+1 分別做 Sobel 邊緣偵測
（Edges Detection），計算畫面中
邊緣出現的位置與強度。邊緣偵
測處理後，此兩個畫面分別為
sobel
nE 和
sobel
nE 1+ ，每一像素值都被調
校在 0 到 255 之間。 
[3] 第三步驟，是進行
sobel
nE 與
sobel
nE 1+ 兩
畫面的二值化（Thresholding），以
保留兩影像中邊緣強度夠大的像
素，判斷方式如公式（1）， 
⎩⎨
⎧ ≥=
otherwise
TyxEif
yxE
sobel
nthresh
n ,0
),(,255
),(
               （1） 
其中，x, y 代表畫面中的像素座
標，T 是邊緣強度的臨界值，T 的
值由公式(2)中的 S 值決定。 
∑∑
=
−
=
≤≤
T
g
T
g
gpSgp
0
1
0
)()(
  （2） 
其中，p(g)為
sobel
nE 圖片之灰階統計
(Histogram)機率值，g 為 0~255 間
之灰階值，因此
∑
=
T
g
gp
0
)(
表示由 0
起始累加至灰值 T 之灰階統計機
率總值，而 S 介於 0~1 之間。當需
要考慮保留強度夠大較明顯的像
素時，可將 S 設為接近 1 之值。在
本論文實驗中，我們設為 0.8，表
示將圖中最強的前 20%邊緣像素
轉換為 255，其餘較弱的像素值清
除為 0。 
[4] 第四步驟，是將
thresh
nE 和
thresh
nE 1+ 這
兩 個 二 值 畫 面 經 過 形 態 學
(Morphological Operation)中的膨
脹（Dilation）運算，目的在增強
邊緣的厚度。
thresh
nE 和
thresh
nE 1+ 膨脹
過後的圖片為
dilation
nE 和
dilation
nE 1+ 。 
此後，
thresh
nE 與
dilation
nE 1+ 可經過公式
（3）求得離開邊緣像素影像
out
nX 。此
離開邊緣像素影像，是找出出現在
thresh
nE 中，但不存在於
dilation
nE 1+ 的邊緣像
素。式（3）中 AND 與 NOT 為二元影
 8
此黃金區域中空間分割比例更改成
2：6：2，以更能適應更多類型影片。
權重區域分配上依黃金區域為優先，
黃金區域之左右上下權重次之，四個
角落(左上、左下、右上、右下)為權重
最低的部分依此規則進行權重調整。
所以權重調配上邊緣特徵值會根據區
域不同權重也會不同。 
因此，我們將前述畫面邊緣清晰
度，使用黃金區域分割規則加以修
正。將屬於黃金區域之物體視為主
角，加重其清晰度權重，並對非黃金
區域之空間，減輕其權重。畫面清晰
度值配合黃金區域分割權重分配，修
正後公式為 
∑ ×=
yx
thresh
ni yxEweightnEdges
,
),()( （7） 
其中 x, y 像素座標決定所屬區
域，i 依 x, y 的區域位置決定出權重。 
第三項畫面色階分佈分類法，是
畫面在空間域中，有一項重要的特
徵，就是像素在色階上之統計分佈
(Histogram)。明亮度像素色階分佈圖可
幫助了解影像的明亮度像素色階分
佈，也就是明亮度空間特性。根據我
們實驗結果，色階分佈上若是能夠越
趨於平均，此照片的整體畫面明亮對
比會較強烈。我們也可利用此特性做
為分類的計算考量。 
此色階分佈計算方法，是利用明
亮度分佈機率，套入熵(Entropy)之計算
方式，此處顏色為灰階值(0~255)之顏
色分佈來做計算，式子如下， 
)),((log),()( 2 nxpnxpnH
x
∑−=  (8) 
其中 p(x,n)表示在畫面 n中灰階值
為 x 時之統計機率值。 
H(n)值代表整張圖所需要的位元
(Bit)數，由於 log 以 2 為底，所以會介
於 0~8 之間，此值越大代表，代表顏
色空間活動性(Spatial Active)越好，也
代表明亮度色階分佈上更加平均，畫
面對比上將會更加強烈。 
第四項畫面變動量，是影片中常
見有晃動或是物體移動之現象，我們
將場景畫面定義成靜態圖片，此靜態
的意思代表著畫面與畫面間變動程度
較低，越是靜態的圖片越能捕捉到導
演所要強調的事件。所以畫面變動差
異程度，也可做為一個重要的計算分
類之特徵值。在此我們使用邊緣變化
率中的比例，來做畫面變動程度的依
據，此值越大，表示畫面改變程度越
大，此特徵值越小，改變程度越小。 
根據上述四種考慮場景分類的因
素，總共整合出三種場景分類特徵
值，計算影片畫面 n 時，需計算依黃
金 區 域 比 例 關 係 的 畫 面 清 晰 度
Edges(n)、畫面變動度 ECR(n)與畫面
明亮對比度 H(n)。計算完畢後，還需
將 其 各 特 徵 值 做 正 規 化
（Normalization），方式如(9)10)(11)，
正規化後特徵值範圍均為 0 到 1 之間。 
minmax
min)()(
EdgesEdges
EdgesnEdgesnEdges Normal −
−=   
(9) 
若 )(nEdgesNormal 為 1，則表示畫面
n 為此群中畫面最清晰者，反之 0 為此
群中最不清晰者。 
minmax
min)(1)(
ECRECR
ECRnECRnECR Normal −
−−=    
(10) 
若 )(nECRNormal 為 1，則表示畫面
n 為此群中變動率最低者，反之 0 為此
群中畫面變動率最高者。 
 10
畫面變動量，以及顏色屬性共五大類
特徵方法的場景分類後，我們便可有
效的分析出相似場景或預期的重要畫
面等。 
此後，對不同應用領域之視訊畫
面，可再由系統管理者以人工方式加
上場景註釋，進一步完成場景分類動
作，便可由前述之視訊資料庫中進行
相關內容的查詢。 
 
6、系統發展與運作展示 
本系統實作使用 Microsoft Visual 
C++ 及 Microsoft DirectX 9.0 
DirectShow 開發，系統主要介面如圖
3。當使用者開始執行本程式時，程式
會開始進行暫存緩衝區記憶體初始配
置。使用者開啟視訊檔案後，視訊檔
案內容將會在視訊播放區出現，使用
者可使用播放控制功能檢視觀看面，
並可透過工具選單，執行場景變動偵
測、關鍵畫面擷取、場景分類等功能。
在主要介面的場景管理區，以每一個
場景第一張畫面，做為場景代表圖示
顯示於場景管理區中。使用者可執行
關鍵畫面擷取後，場景圖示將以系統
選出的關鍵畫面替代。使用者同時可
從場景管理區中，選擇某一場景段
落，進行視訊內容的人工註解，檔案
儲存、類別分析等動作。在影像資訊
區會有此場景段落的相關資訊顯示。 
根據我們對運動視訊中棒球比賽
內容的了解，為了讓棒球視訊能具有
結構化視訊（Structured Video）的特
性，並有效的整合內容記錄資料，我
們首先定義我們的棒球事件「視訊物
件（Video Object）」是一段視訊序列
（Video Sequence），其中包含了我們
有興趣的棒球內容，如一組投打對戰
過程、一段全壘打畫面、一段得分狀
況鏡頭等重要畫面為主。在視訊物件
中，除視訊物件的代碼及代表性小圖
像畫面(Thumbnail)外，視訊物件也必
須附加上具有能描述出該段視訊內容
的屬性及屬性值或文字描述等註解
(Annotation)，以及其包含此棒球視訊
物件的棒球片集段落資訊，一般以時
 
圖 3 結構化視訊分割與場景分類工具主要介面 
 12
四、參考文獻 
[1] C. W. Chang and K. I. Lee, “Video 
Contents Analysis and 
Representative Images Selection,” 
Proc. of Sym. on Digital Life and 
Internet Technologies, Tainan 
Taiwan, 2004. 
[2] C. W. Chang and S. Y. Lee, “Video 
Contents Representation, Indexing 
and Matching in Video Information 
Systems,” Journal of Visual 
 
圖 5 視訊資料查詢介面 
 
圖 6 查詢結果介面 
