grouping performance on the other. 
英文關鍵詞： ensemble empirical mode decomposition； filter 
design； intrinsic mode function； multi modes； 
signal processing 
 
Structural Engineering and Mechanics, Vol. 39, No. 6 (2011) 813-831 813
A hybrid algorithm based on EEMD and EMD for
 multi-mode signal processing
Jeng-Wen Lin*
Department of Civil Engineering, Feng Chia University, Taichung, Taiwan 407, R.O.C.
(Received January 26, 2011, Accepted June 22, 2011)
Abstract. This paper presents an efficient version of Hilbert-Huang transform for nonlinear non-
stationary systems analyses. An ensemble empirical mode decomposition (EEMD) is introduced to
alleviate the problem of mode mixing between intrinsic mode functions (IMFs) decomposed by EMD. Yet
the problem has not been fully resolved when a signal of a similar scale resides in different IMF
components. Instead of using a trial and error method to select the “best” outcome generated by EEMD, a
hybrid algorithm based on EEMD and EMD is proposed for multi-mode signal processing. The developed
approach comprises the steps from a bandpass filter design for regrouping modes of the IMFs obtained
from EEMD, to the mode extraction using EMD, and to the assessment of each mode in the marginal
spectrum. A simulated two-mode signal is tested to demonstrate the efficiency and robustness of the
approach, showing average relative errors all equal to 1.46% for various noise levels added to the signal.
The developed approach is also applied to a real bridge structure, showing more reliable results than the
pure EMD. Discussions on the mode determination are offered to explain the connection between mode-
grouping form on the one hand, and mode-grouping performance on the other. 
Keywords: ensemble empirical mode decomposition; filter design; intrinsic mode function; multi
modes; signal processing
1. Introduction
Hilbert-Huang transform (HHT), i.e., empirical mode decomposition (EMD) and the Hilbert
transform (Huang et al. 1998, Huang et al. 2003), has received a wide variety of attention and
application in many fields. Applying EMD to the signal will produce intrinsic mode functions
(IMFs), each represents a physical meaning for the system. Then applying the Hilbert transform to
convert the IMFs into the frequency domain in a time-frequency-amplitude display makes the HHT
sophisticated and versatile. 
However, one of the major drawbacks of the EMD is the frequent appearance of mode mixing,
which is defined as a single IMF either consisting of signals of widely disparate scales, or a signal
of a similar scale residing in different IMF components (Wu and Huang 2009). When the problem
of mode mixing occurs, an IMF can cease to have a physical meaning by itself, suggesting falsely
that there may be different physical processes represented in a mode (Wu and Huang 2009, Lei and
Zuo 2009). This mode mixing was initially avoided by an “intermittency” test (Huang et al. 1999),
*Corresponding author, Associate Professor, E-mail: jwlin@fcu.edu.tw
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 815
Based on these arguments, this study aims to (1) assess the performance of EEMD by an
orthogonality check on each resulting IMF, and (2) compare the grouping efficiency of IMFs
generated by EEMD with that of the bandpass-EMD based approach (Lin 2010) for the multi-mode
signal processing. First, a historical account of the development of EEMD is provided. Second, the
bandpass-EMD approach is applied to the combined IMFs generated by EEMD, so as to produce
proper IMFs for the mode determination. The proposed approach comprises the steps from a
bandpass filter design for regrouping modes of the new signal obtained from EEMD, to the mode
extraction using EMD, and to the accurate assessment of a single mode in the frequency spectrum.
Third, a simulated signal with two-modes is tested to demonstrate the efficiency of the proposed
approach. A linear sum of two cosine waves to form a two-mode signal possessing similar scales is
considered. To embark the EEMD process, various noise levels with a standard deviation of 0%,
5%, 10%, 20%, and 40% are added to the signal, respectively. The signal is then decomposed into a
variety of IMFs using EEMD, followed by combining the multi-mode into a single mode, and
sifting it again to produce proper IMFs one by one using the bandpass-EMD based approach, which
divides the outcome into different groups. The resulting evaluated frequencies of the two-mode
signal are compared with the real values. Application of the proposed approach to a real bridge
structure is also conducted. Finally, discussions on the determination of modes are offered to explain
the connection between mode-grouping form and type on the one hand, and mode-grouping
performance on the other. 
2. Methodology: a hybrid algorithm based on EEMD and EMD
Fig. 1 illustrates the hybrid algorithm based on EEMD and EMD (with the assistance of the
EMD/EEMD evaluation code by Wu and of the Hilbert spectrum evaluation code by Gabriel.Rilling
(at) ens-lyon.fr), which consists of (1) the EEMD to alleviate the mode mixing problem, (2) the
design of a bandpass filter to fully resolve the mode mixing problem, (3) the mode extraction using
EMD, and (4) the modal frequency estimation in the marginal spectrum. First, a historical account
of EEMD is provided. The EEMD is an improved version of EMD using an ensemble average of
IMFs decomposed by EMD. The EMD associated with the Hilbert transform comprises the Hilbert-
Huang transform (HHT) (Huang et al. 1998, Huang et al. 2003). 
2.1 Hilbert-Huang transform
The Hilbert transform for an arbitrary time series  can be defined by  as
(1)
which is the convolution of the signal  with 1/t, and the associated analytic signal  of 
is described by
(2)
x t( ) y t( )
y t( ) 1
π
--
x t( )
t τ–
-------- τd
∞–
∞
∫=
x t( ) z t( ) x t( )
z t( ) x t( ) iy t( )+ a t( )eiθ t( )= =
a t( ) x2 t( ) y2 t( )+=
θ t( ) arctan y t( )/x t( )( )=⎩
⎪
⎨
⎪
⎧
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 817
By using these expressions, the time-frequency-amplitude relationship of the signal can be
adequately represented. Since the phase  is a function of time t, the frequency will be a
function of time by taking the derivative of  to yield the instantaneous frequency (Huang et al.
1998) as
(3)
The EMD method can decompose a signal into a collection of individual and almost
monocomponent signals called intrinsic mode functions (IMFs) (Huang et al. 1998). The EMD
process can be summarized as follows (Huang et al. 1999, Peng et al. 2005) 
(a) Initialize , and ;
(b) Extract the nth IMF (i.e., cn, ) by 
(1) Initialize , ;
(2) Connect all the local maxima of  by a cubic spline line as the upper envelope of
, and repeat the procedure for the local minima to produce the lower envelope;
(3) Calculate the local mean mnk of the upper and lower envelopes of ;
(4) Repeat the sifting up to k times, and designate ;
(5) If hnk is an IMF, set ; otherwise go to step (2) with ;
(c) Define  ( );
(d) If rn becomes a monotonic function, the EMD process is stopped; otherwise go to step (b)
with .
The EMD method is adopted to resolve the signal  into the final form as
(4)
where  ( ) are the IMFs and  is the residue of . The IMF is a mode
function characterizing: (1) in the whole data set, the number of extrema and the number of zero-
crossings must either equal or differ at most by one; and (2) at any point, the mean value of the
envelope defined by local maxima and the envelope defined by the local minima is zero (Huang et
al. 1999). An IMF represents a simple oscillatory mode embedded in the signal. With the simple
assumption that any signal consists of different simple IMFs, the EMD method is able to
decompose a signal into IMFs (Lei and Zuo 2009).
After employing the Hilbert transform on each IMF by using Eqs. (1)-(4), it is possible to express
the signal  (Huang et al. 1998) as
(5)
Using Eq. (5), one can represent the variable amplitude  on the time-frequency plane to
yield the Hilbert spectrum . Hence, the Hilbert transform with EMD is able to generate the
time-frequency-amplitude distribution to describe the signal . The Hilbert spectrum can be
integrated with respect to time to give the marginal spectrum as 
(6)
θ t( )
θ t( )
ω t( )
θ t( )d
dt
-----------=
r0 x t( )= n 1=
n 1 2 … N, , ,=
hn k 1–( ) r n 1–( )= k 1=
hn k 1–( )
hn k 1–( )
hn k 1–( )
hnk hn k 1–( ) mnk–=
cn hnk= k k 1+=
rn rn 1– cn–= n 1 2 … N, , ,=
n n 1+=
x t( )
x t( ) cn t( )
n 1=
N
∑ rN t( )+=
cn t( ) n 1 2 … N, , ,= rN t( ) x t( )
x t( )
x t( ) an t( )exp i ωn t( ) td∫( )
n 1=
N
∑=
an t( )
H ω t,( )
x t( )
h ω( ) H ω t,( ) td
0
T
∫=
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 819
number of modes of  is equal to the number of the orthogonalization coefficient (Huang et al.
1998) between the signal  and its IMFs yn generated by EEMD being equal to 0.50 (round-off
value) while the remaining orthogonalization coefficients being equal to zero, as shown in Fig. 1.
The orthogonalization coefficient ranges from 0 to 0.5 and is defined as 
(9)
where  denotes the index of orthogonality between the two signals, Cf and Cg. 
If the criterion is satisfied, the overall signal processing procedure can be stopped. Otherwise, the
bandpass-EMD filtering approach (Lin 2010) should be followed and applied to the signal
containing combined IMFs generated by EEMD. The filtering approach comprises the steps from a
bandpass filter design for separating and regrouping modes of the IMFs obtained from EEMD, to
the mode extraction using EMD, and to the accurate assessment of a single mode in the frequency
spectrum. The bandpass filter is utilized to regroup and extract the modes of the signal containing
combined IMFs (i.e., ). The bandpass filter uses a cutoff frequency that corresponds in
amplitude to 10% of the peak value for the signal in the frequency spectrum (Etter 1993). There is
no transition band between the passband and the stopband for the designed filter, i.e., the cutoff
frequency equals the rejection frequency. The signal is only allowed oscillations between the cutoff
frequencies, and amplitudes in other intervals are set to zero so as to filter out lower and higher
portions of the signal arising from measurement errors (Lin 2010). 
After the signal is undergone the bandpass filter, the wide band signal to be processed is
regrouped into a series of narrow band signals, each representing one mode. Each mode is further
processed using the orthogonalization coefficient, Eq. (9), to select a most appropriate IMF among
the IMFs obtained from the EMD of the signal’s mode. The IMF possessing the highest
orthogonalization coefficient between the signal’s mode and its IMFs (usually equal to 0.50 round-
off value) is selected to represent the modal signal. Each IMF that represents a modal signal can be
obtained sequentially according to the number of modes of .
3. Numerical examples and analyses
3.1 Evaluation of a two-mode signal
A simulated signal with two-modes is tested to demonstrate the efficiency of the proposed
approach. A linear sum of two cosine waves (Huang et al. 1998) to form a two-mode signal
containing similar scales is considered and described in Eq. (10) over t from 1-512 s, with the time
interval ∆t = 0.1 s. The real frequency values are 1/34 (0.02941) Hz and 1/30 (0.03333) Hz.
(10)
In order to understand the impact of noise on the EEMD outcome, the noise level with a standard
deviation of 0%, 5%, 10%, 20%, and 40% is added to the signal, respectively. It is noted that
adding 0% noise level to the signal to undergo the EEMD process is equivalent to the signal to
directly undergo the EMD process. The upper left portion of Fig. 2 shows the time history of the
original signal. The signal is decomposed into IMFs using EEMD, followed by combining the
x t( )
x t( )
IOfg
CfCg
Cf
2
Cg
2
+
----------------
t
∑=
IOfg
Σn 1=
N
yn
x t( )
x t( ) cos 2
30
-----πt cos
2
34
-----πt+=
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 821
multi-mode into a single mode, and sifting it again to produce a proper single IMF as a mode using
the bandpass-EMD based algorithm, which divides the outcome into different groups to find modes
one by one. The estimated frequencies of the two-mode signal are compared with the real values.
First, the EEMD is applied to the two-mode signal to result in a variety of IMFs that are the
ensemble means of 500 trials of EMD. Fig. 3 shows the decomposed IMFs using EEMD: the left
and right portions are for the signal with 0% and 20% noise level, respectively. Table 1 lists the
orthogonalization coefficients between the signal and the decomposed IMFs using EEMD with 0%,
5%, 10%, 20%, and 40% noise levels, respectively. The number of “distinguished” orthogonalization
coefficients (in bold) in each noise level (except for the 0% noise level which refers to the EMD
procedure) is two, implying that the possible mode number is two. This mode number determination
is clarified and discussed in the next section.
Fig. 2 shows the outcomes, including the Hilbert spectra and marginal spectra, of EEMD for the
cases of 0% and 20% noise levels, respectively. In particular, the upper right portion of Fig. 2
shows the Fourier spectrum of the original signal, suggesting that two modes exist in the original
signal. Hilbert spectra also suggest that two modes exist in the signal, but the spectrum becomes
noisier when the 20% noise level is added. However, the marginal spectra appear to have one
Fig. 3 The decomposed IMFs using EEMD: the left and right portions are for the signal with 0% and 20%
noise levels, respectively
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 823
Fig. 4 The Hilbert spectra and marginal spectra of the signal containing combined all IMFs generated by
EEMD with 20% noise level (left portion) and the correspondingly filtered signal after the bandpass-
EMD filter (right portion), respectively (× indicate the real modal frequencies)
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 825
Table 2 Orthogonalization coefficients between the signal containing combined all IMFs generated by EEMD
with 0%, 5%, 10%, 20%, and 40% noise levels, respectively, and the decomposed IMFs
0% Noise 5% Noise 10% Noise 20% Noise 40% Noise
Self 0.5 0.5 0.5 0.5 0.5
IMF1 0.4995 0.0000 0.0000 0.0000 0.0003 
IMF2 0.0046 0.0036 0.0000 0.0000 0.0001 
IMF3 -0.0009 0.4916 0.3430 0.0630 0.0000 
IMF4 -0.0004 0.0304 0.1140 0.4885 0.4890 
IMF5 -0.0002 -0.0083 -0.0190 0.0186 0.0048 
IMF6 0.0000 -0.0073 -0.0037 -0.0083 0.0248 
IMF7 0.0000 -0.0030 -0.0010 -0.0030 -0.0021 
IMF8 0.0000 0.0000 0.0000 -0.0005 -0.0017 
IMF9 0.0000 -0.0013 0.0000 0.0000 0.0000 
IMF10 0.0000 0.0000 0.0000 0.0000 0.0000 
IMF11 0.0000 -0.0006 0.0000 -0.0001 0.0000 
Residual -0.0002 -0.0026 -0.0008 -0.0010 -0.0023 
Fig. 6 The decomposed IMFs of mode 1 (left portion) and mode 2 (right portion), respectively, for the signal
undergone the bandpass-EMD filter after combining all IMFs generated by EEMD with 20% noise
level
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 827
represents a simple oscillatory mode embedded in the signal (Huang et al. 1999, Lei and Zuo 2009).
Table 4 lists the final estimated frequencies of the two-mode signal using FFT for the original
signal, EEMD for the original signal, EMD for the signal containing combined all IMFs generated
by EEMD, and bandpass-EMD for the signal containing combined all IMFs generated by EEMD,
respectively. Obviously, the bandpass-EMD has solved the mode mixing problem. In fact, directly
applying EEMD or EMD will produce one “averaged” modal frequency with a higher average
relative error of either 6.05% or 6.25%, when compared to that of 1.46% and 1.47% using the
bandpass-EMD and FFT, respectively. Regardless of the signal with 0%, 5%, 10%, 20%, or 40%
noise level, the bandpass-EMD algorithm is able to achieve accurate and stable results in modal
frequency estimation, which is characteristic of a robust filter.
3.2 Evaluation of a real bridge structure
The proposed approach is also applied to a real bridge structure (e.g., Mao-Luo-Hsi Bridge in
Table 4 Estimated frequencies of the two-mode signal using FFT for the original signal, EEMD for the
original signal, EMD for combined all IMFs generated by EEMD, and bandpass-EMD for combined
all IMFs generated by EEMD, respectively
Noise
Frequency (Hz) Relative Error Average
Relative ErrorMode 1 Mode 2 Mode 1 Mode 2
Real 0.02941 0.03333 
0%
FFT 0.02930 0.03419 0.37% 2.56% 1.47%
EEMD 0.03125 0.03125 6.25% 6.25% 6.25%
EMD 0.03125 0.03125 6.25% 6.25% 6.25%
Bandpass-EMD 0.02930 0.03418 0.39% 2.54% 1.46%
5%
FFT 0.02930 0.03419 0.37% 2.56% 1.47%
EEMD 0.03027 0.03027 2.93% 9.18% 6.05%
EMD 0.03125 0.03125 6.25% 6.25% 6.25%
Bandpass-EMD 0.02930 0.03418 0.39% 2.54% 1.46%
10%
FFT 0.02930 0.03419 0.37% 2.56% 1.47%
EEMD 0.03125 0.03125 6.25% 6.25% 6.25%
EMD 0.03027 0.03027 2.93% 9.18% 6.05%
Bandpass-EMD 0.02930 0.03418 0.39% 2.54% 1.46%
20%
FFT 0.02930 0.03419 0.37% 2.56% 1.47%
EEMD 0.03027 0.03027 2.93% 9.18% 6.05%
EMD 0.03125 0.03125 6.25% 6.25% 6.25%
Bandpass-EMD 0.02930 0.03418 0.39% 2.54% 1.46%
40%
FFT 0.02930 0.03419 0.37% 2.56% 1.47%
EEMD 0.03125 0.03125 6.25% 6.25% 6.25%
EMD 0.00195 0.00195 93.36% 94.14% 93.75%
Bandpass-EMD 0.02930 0.03418 0.39% 2.54% 1.46%
A hybrid algorithm based on EEMD and EMD for multi-mode signal processing 829
the surrounding environment resulting from a slight vibration force, the measured signals are
susceptible to interference, such as vehicles passing through during measurement, and thus
contaminated by noise. Hence, it is beneficial to directly adopt the bandpass-EMD approach to
preprocess the contaminated signals by the bandpass filter, followed by the mode extraction using
EMD and evaluation of the mode in the marginal spectrum. It is noted that the EEMD process is
omitted in this case since the optimal noise level producing the best outcomes of EEMD is usually
not available and requires a considerable amount of time to properly train the algorithm. 
Fig. 8 shows the marginal spectrum vs. Fourier spectrum of Mao-Luo-Hsi Bridge (from top to
bottom refers to the indicated section 1, section 2, and section 3 of the bridge, respectively). It is
clear to see that there are a few local peaks in amplitude representing possible modes in each
frequency spectrum. However, these local peaks can be attributed to vehicles passing through during
measurement, and thus only the global peak is selected to represent its principal frequency. Table 5
lists the estimated principal frequencies of Mao-Luo-Hsi Bridge in sections 1-3 using the FFT,
EMD, and bandpass-EMD, respectively. The results of the bandpass-EMD are quite close to those
of FFT while the outcomes of the pure EMD demonstrate some deviations, implying that the
bandpass-EMD approach is able to acquire more reliable results than the pure EMD. 
4. Discussions on the determination of mode number
The bandpass filter for the signal in Eq. (10) is designed to allow two zones of oscillations (pass-
bands), as the signal contains two remarkable peaks in the frequency spectrum. The Fourier
spectrum of the original signal in Fig. 2 tells that there are two peaks, indicating two modes for the
two-mode signal that represents a stationary system. Hence, the Fourier spectrum components can
assist in determining the mode number for a stationary process. For non-stationary systems, the
local spectrum components are not corresponding to the true frequencies. In such cases, a criterion
to determine the possible number of modes for the signal of interest is developed that springs from
the works by Peng et al. (2005) and Bao et al. (2009), who presented a selection criterion for IMFs
decomposed from the signal based on the correlation coefficient, µn ( ; N is the
number of IMFs), between each IMF and the signal to be processed. A threshold ρ is defined as
, (11)
where η is a factor lager than 1.0 and is usually decided empirically. The criterion is to keep the nth
IMF as the mode if , while eliminate the remaining IMFs. By using the η equal to 10 (Peng
et al. 2005) and substituting the correlation coefficient with the orthogonalization coefficient used in
this study, Eq. (11) becomes
n 1 2 … N, , ,=
ρ
max µn( )
η
--------------------= n 1 2 … N, , ,=
µn ρ≥
Table 5 Estimated principal frequencies of Mao-Luo-Hsi Bridge in sections 1-3 using FFT, EMD, and
bandpass-EMD, respectively 
Section 1 Section 2 Section 3
FFT 2.0269 3.2479 2.3443 
EMD 7.9038 1.0934 5.9981 
Bandpass-EMD 2.0306 3.4364 2.3118 
