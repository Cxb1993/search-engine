 II
ABSTRACT 
 
The purpose of this project is to store up the solar power energy in the battery 
for the applications of the horticulture and park streetlamp detached lighting or 
the outlying scenic resort electric power-driven vehicle charging systems. It can 
be also used as a backup power for the first aid, radio communication or mobile 
phone stations during the unexpected utility power failure in the mountain or 
off-shore island. The problems of the independence power and battery tank are 
studied for independence backup power, lighting and series/parallel charging with 
three years durations. These study include equalization charging, capacity 
prediction, maximal backup capacity, temperature rise and usable life of the 
battery, whereas the output powers of the solar power energy are unstable, the 
charging modes with constant pulse amplitude constant power and variable power 
are studied. For the study and design of charging/discharging controller, the series 
charging/series supply and parallel charging/series supply are also discussed. 
Finally, the chargers and inverters with power rating of 500 W and 3 kVA are 
implemented to satisfy the system integrated requirements.  
 
Keywords: solar power energy, charge, battery 
 IV
第三章 研究方法………………………………………………………………56 
3.1 太陽光電能板最大功率點追蹤之設計………………………………… 56 
3.2 太陽光電能充電器之設計……………………………………………… 58 
3.3 電池均充器之設計……………………………………………………… 67 
3.3.1 電池均充器系統架構設計………………………………………… 67 
3.3.2 電池均充器之軟體設計…………………………………………… 69 
3.4 電力轉換器之設計……………………………………………………… 73 
3.4.1 電力轉換器之硬體設計…………………………………………… 74 
3.4.2 電力轉換器之軟體設計…………………………………………… 78 
3.5 鉛蓄電池殘餘電量估測之設計………………………………………… 82 
3.5.1 殘量預估模組硬體設計…………………………………………… 82 
3.5.2 殘量預估模組軟體設計…………………………………………… 90 
第四章 實驗結果與分析………………………………………………………99 
4.1 太陽光電能板最大功率追蹤實測…………………………………………99 
4.2 太陽光電能充電器實測………………………………………………… 102 
4.2.1 充電器之模擬……………………………………………………… 102 
4.2.2 充電器之實測……………………………………………………… 104 
4.3 電池均充器實測………………………………………………………… 112 
4.4 升壓型轉流器之模擬與實測…………………………………………… 130 
4.4.1 各點電壓與電流波形模擬與實測………………………………… 132 
4.4.2 升壓式轉流器加載實測…………………………………………… 135 
4.4.3 不同輸入電壓模擬與實測………………………………………… 141 
4.4.4 獨立型太陽光電能系統供電實測………………………………… 142 
 VI
圖次 
圖 2-1 太陽能電池等效電路……………………………………………………12 
圖 2-2 太陽光電能板於不同日照強度下電壓-電流特性曲線………………．14 
圖 2-3 太陽光電能板於不同日照強度下電壓-功率特性曲線………………．14 
圖 2-4 太陽光電能板於不同溫度下之電壓-電流特性曲線…………………．15 
圖 2-5 太陽光電能板於不同溫度下之電壓-功率特性曲線…………………．15 
圖 2-6 二段式定電流定電壓充電法示意圖……………………………………23 
圖 2-7 脈衝電流充電法示意圖……………………………………………… 23 
圖 2-8 ReflexTM充電法之示意圖……………………………………………… 24 
圖 2-9 三段式定電流定電壓充電法示意圖…………………………………  24 
圖 2-10 四段式定電流定電壓充電法示意圖………………………………… 24 
圖 2-11 鉛酸電池定電流充電之電壓變化曲線圖…………………………… 26 
圖 2-12 鉛酸電池定電流放電之電壓變化曲線圖…………………………… 26 
圖 2-13 電解液比重與電池殘量關係圖……………………………………… 28 
圖 2-14 加載電壓與電池殘量關係圖………………………………………… 29 
圖 2-15 電池起始放電電壓曲線圖…………………………………………… 30 
圖 2-16 電池內阻示意圖………………………………………………………31 
圖 2-17 電池放電期間內阻變化曲線圖………………………………………31 
圖 2-18 開路電壓與電池殘量關係圖…………………………………………32 
圖 2-19 電池開路之電壓回復曲線……………………………………………32 
圖 2-20 電池加成效應電流與真實電流之關係圖……………………………35 
圖 2-21 降壓型直流轉換器在連續導通模式下之等效電路圖………………38 
圖 2-22 降壓型直流轉換器操作在連續導通模式下之各點波形……………39 
 VIII
圖 3-11 均充控制流程圖………………………………………………………72 
圖 3-12 太陽光電能系統升壓式轉流器系統架構圖…………………………73 
圖 3-13 升壓式轉流器電壓參考信號…………………………………………75 
圖 3-14 主程式流程圖…………………………………………………………80 
圖 3-15 Boost1 與 Boost2 之 PWM 值計算程式流程圖………………………81 
圖 3-16 典型的電池管理系統架構圖…………………………………………86 
圖 3-17 殘量偵測模組整體架構………………………………………………86 
圖 3-18 殘量預估模組整體電路………………………………………………87 
圖 3-19 鉛酸電池電壓偵測電路………………………………………………88 
圖 3-20 鉛酸電池電流偵測電路………………………………………………88 
圖 3-21 通訊電壓準位轉換電路………………………………………………89 
圖 3-22 殘量預估模組硬體電路………………………………………………89 
圖 3-23 殘量預估模組程式設計主流程圖……………………………………93 
圖 3-24 電池電流取樣流程圖…………………………………………………94 
圖 3-25 電池電壓取樣副程式流程圖…………………………………………95 
圖 3-26 開路電壓法副程式流程圖……………………………………………96 
圖 3-27 改良式庫侖計法副程式流程圖………………………………………97 
圖 3-28 充電殘量預估副程式流程圖…………………………………………98 
圖 4-1 最大功率追踨實驗硬體架構圖……………………………………… 99 
圖 4-2 △duty 為 1/256 擾動量之最大功率追踨歷程圖………………………100 
圖 4-3 △duty 為 3/256 擾動量之最大功率追踨歷程圖………………………101 
圖 4-4 △duty 為 5/256 擾動量之最大功率追踨歷程圖………………………101 
圖 4-5 IsSPICE 充電模擬電路圖………………………………………………102 
 X
圖 4-29 A 組電池未使用均充系統之四只電池充電歷程圖…………………122 
圖 4-30 A 組電池使用均充系統之四只電池充電歷程圖……………………122 
圖 4-31 A 組電池不同充電架構之電池放電歷程圖…………………………123 
圖 4-32 A 組電池不同充電架構之充電溫升歷程圖…………………………123 
圖 4-33 B 組電池未使用均充系統之四只電池充電歷程圖…………………125 
圖4-34 B組電池使用均充系統之四只電池充電歷程圖……………………．126 
圖4-35 B組電池不同充電架構之電池放電歷程圖…………………………．126 
圖4-36 B組電池不同充電架構之充電溫升歷程圖…………………………．127 
圖 4-37 均充系統之實體圖……………………………………………………128 
圖 4-38 電池充放電監控測試平台……………………………………………129 
圖 4-39 升壓式轉流器 IsSpice 電路與系統模擬圖…………………………．130 
圖 4-40 功率晶體驅動信號與 VCE 波形………………………………………134 
圖 4-41 功率晶體 VCE 與升壓式轉換器輸出電壓波形………………………134 
圖 4-42 升壓式轉換器與轉流器輸出電壓波形………………………………134 
圖 4-43 升壓式轉流器輸入與輸出電壓、電流波形…………………………135 
圖 4-44 升壓式轉流器輸出電流與儲能電感電流波形………………………135 
圖 4-45 各負載下輸出電壓與電流波形………………………………………137 
圖 4-46 輸出效率量測結果……………………………………………………140 
圖 4-47 輸入電壓 75 V、輸出 85 W 之輸出電壓與電流波形………………142 
圖 4-48 太陽光電能實測波形…………………………………………………143 
圖 4-49 太陽光電能板實體圖與升壓式轉流器電路之實體圖………………144 
圖 4-50 空載之輸出電壓與電流波形…………………………………………145 
圖 4-51 負載 900 W之輸出電壓與電流波形…………………………………146 
 XII
表次 
表 2-1 電池真實放電電流與加成效應電流比較表……………………………34 
表 3-1 升壓式轉流器電氣規格…………………………………………………76 
表 4-1 每只電池電量狀態……………………………………………………．120 
表 4-2 不同充電架構實驗結果………………………………………………．128 
表 4-3 電路模擬元件參數……………………………………………………．131 
表 4-4 輸出電壓總諧波與奇次諧波量測……………………………………．139 
表 4-5 系統轉換效率量測結果………………………………………………．140 
表 4-6 殘量預估模組於電池不定電流放電之量測誤差表…………………．153 
 
 
 - 2 -
發電系統仍以較大容量之國外產品為主，導致價格居高不下。國內雖有不少
研究人員積極從事太陽能之相關研究，惟其研究主軸仍以太陽能發電系統或
功率追蹤控制等為主。由於太陽能用於公園路燈或園藝景觀照明在國外已逐
漸被接受，其工作原理主要將日照期間之太陽能利用蓄電池加以儲能，夜間
再提供照明所需之電力。雖然目前國內已有部分園藝廠商如中港園區之維勝
特及和成等已積極投入此種獨立式園藝照明用電系統之研發，但礙於技術及
人力之不足致心有餘而力不足。此外，在風景地區由於位處偏遠地區，電力
輸送之成本即損耗頗大，因此若能部分採用太陽能提供獨立照明用電，除可
提供潔淨能源外，亦具有相當經濟效益，加以近年來休閒娛樂盛行，風景地
區之電動休閒車乃應運而生，針對此種電動休閒車之充電乃成為當務之急。
此外在民國 88 年之 728 大停電及 921 大地震期間，由於電力系統之解聯導致
市電中斷時間相當長久，使得電池儲存之電能耗盡，對於偏遠地區之通訊或
急難設備，因無電力供應而被迫中斷，除造成生活之不變外，更增加救援之
困難度。因此本計劃乃提出以太陽能在日照期間進行休閒電動車及蓄電池之
充電，日照期間結束後平時則由蓄電池之儲能提供照明用電，急難期間則可
作為通訊與急難系統之電力，故即使台電之供電線路因不可預期之因素而被
迫中斷或解聯，通訊與急難系統之電力仍可因太陽能在日照期間獨立運作，
而持續維持緊急之電力供應，以確保救難所需之通訊線路暢通加速救援工作
 - 4 -
流流入電池，除造成電池本體之溫度升高外，過度而無控制之充電電流亦將
造成電池極板之損壞，進而縮短電池之使用壽命。為解決上述初始充電電流
太大之問題，因此又有二級定電壓充電法之充電方式，其方法為在充電初期
以較低之充電電壓進行充電，待電池端電壓逐漸上升至某特定準位時，再將
充電電壓加以提升，以免過低之充電電壓無法達到電池之完全充電。除了上
述二法之外，脈衝充電法[24]亦為常用之充電方法，脈衝充電法由於在充電過
程中可提供充電休息時間，使電池之電解液獲得中和之緩衝時間，故可採用
較大之充電電流進行充電，以減少電池之充電時間達到快速充電之目的。此
外，Christie  Electic 亦提出 ReflexTM充電法[25]，所謂 ReflexTM充電法係在
充電過程中於每一充電脈衝之後緊跟著一放電脈衝，利用放電脈衝提供電池
之〝打嗝〞（Burp）作用，以去除電極之氣泡。經由先前本實驗室有關於單顆
電池充電之初步研究結果[8,12]發現：脈衝充電法除可提升電池之充電速率，
減少電池之充電時間外，其充電效率（電-化學轉換效率）在上述四種方法中
最高，其次為 Christie  Electic 所提出之 ReflexTM充電法。經由本實驗室先期
之實驗結果雖然獲得脈衝充電法與 ReflexTM充電法在大容量鉛蓄電池可獲得
較佳之充電效率，且已初步獲得大容量鉛蓄電池（26 及 42AH）之脈衝電流
大小、週期及脈衝責任（duty）比與電-化學轉換效率之互動關係。但由於獨
立式太陽能發電系統可採用之電池種類繁多，鉛蓄電池、鎳氫電池及鋰離子
 - 6 -
架構。在並聯/串接架構方面，通常電池先以並聯充電，由於電池因各別差異
而有不同充電速率，當電池充電到設定電壓後，再由電壓監視電路控制切換
開關改為串接繼續充電，直到充電電流降到最初充電電流的 10(%)時，即表示
電池都已充飽[3-4]。在串聯充電/電池分流(Series Charging/Cell Shunting)架構
方面，個別電池有其各自之控制電路，且其參考電壓可隨需要而調整設定，
再利用電阻分壓偵測電池之已充電電壓，經電阻分壓後與參考電壓進行比
較，由比較結果再控制分流用功率晶體，將已達設定電壓之電池的充電電流
分流，以避免該電池過度充電，其控制由電路自動偵測後直接進行切換，所
以整個過程是先由電源供給器對全部串聯電池以定電流充電，若其中任一電
池達設定電壓值時，則自動偵測並加以分流。電阻均充架構之作法則將待充
電池串接，而每個電池有其各自之電壓監視電路，當達到設定之充電電壓準
位後，控制開關使負載接上達到分流目的，分流之多餘電流純粹用電阻來消
耗能量，因此將產生散熱問題[4]。變壓器均充架構是將串接電池以定電流充
電，當電壓監視電路偵測到某一電池已達設定電壓時即將開關接上，此時較
高電壓電池所並聯之變壓器線圈會有較大電流通過，經過變壓器能將能量轉
移且繼續對較低電壓之電池進行充電，如此對電池組之全部電池充電直到每
個電池都充飽才停止充電程序。由於前述之各種電池組等量充電控制技術皆
各有其優缺點及適用性，且獨立式太陽能電池連接方式已經固定，因此本計
 - 8 -
以維持正常運作；其次為減少電池之串聯充電數目及避免充電器之輸出電壓
太高，本計劃亦將嘗試前述並聯充電串流供電之可行性，在充電期間以 128V
並聯充電，充電完成後再轉換電池組為串聯供電，並比較兩者之優劣。本計
劃在日照期間之工作模式依應用情況而有所不同，若為休閒電動車之充電則
太陽能板發電之功率主要將提供作為休閒電動車之蓄電池充電，此時之工作
模式將依負載與太陽能板發電之互動關係，而區分為由蓄電池提供部分電力
或仍進行不定功率充電。此外，若系統設計為園藝或公園路燈等照明用途則
日照期間之太陽能將全部儲存於蓄電池中，待夜間再由蓄電池提供所需之照
明用電。為防電池電能耗盡導致無預警斷電，本計劃亦將提供電池殘量資訊，
使操作者在系統電力中斷前，可採取適當之應變措施或作為系統容量擴充之
參考。因此串聯電池組殘量指示亦為本計劃研究重點，在電池之殘量指示方
面，本計畫擬先經由實驗收集各種應用之電池放電資料，再利用電腦進行電
池之放電資料分析，以建立電池運用於各種用途之放電模式作為設計及建立
供電系統之參考。由於本計劃採用實測電池放電資料收集，再進行資料分析
以建立各種應用之電池放電模式，因此無論高效率充放電之資料收集或殘量
偵測均與電池容量偵測(或油量指示)技術互有關聯。目前國內外在電池容量之
偵測多以單一電池為主，有關串聯電池組之殘量偵測由於牽涉到個別電池特
性差異，導致複雜性與困難度提高而不多件，目前在單一電池之容量偵測歸
 - 10 -
法係以連續加總方式累計目前電池之可用容量，為免累計誤差產生，因此在
本計劃中除採用平均加載電壓法配合庫侖計量測監視串聯電池之充放電狀態
外，亦將再增加電池組內阻量測法，藉由電池組之瞬間(µs 範圍)放電脈衝，
量取並計算電池組之各項參數，以消除前述之累積誤差，並可有效預估電池
之使用壽命期限，以維持系統之高可靠度。由於上述方法不需要開路電壓之
等待時間，故較適合本計劃之實際需求。同時配合微電腦之計算及控制，使
此種殘量監測技術具有學習功能，亦即在更換任 何形式之電池後，經由充放
電程序，即可由微電腦記憶其放電特性，往後即可經由充放電程序進行資料
之修正，以避免電池老舊或電池容量更換所導致之誤差。故在本計劃之電池
容量偵測方面，擬先發展並建立各類型電池放電之測試資料收集分析系統，
經由實測且儲存於電腦之資料再以電腦統計分析各種電池放電資料，以建立
各種應用之放電模式，作為系統殘量指示(容量偵測)之設計參考。 
在供電系統方面，本計劃之額定輸出電壓為 AC 110V 均方根值，以符合
一般家庭用電之負載需求，且因本計劃之供電系統為獨立式，在考慮價格與
穩定度等商業量產需求下，初期規劃之系統將以類正弦波為主，代系統研製
完成後於第三年再研製高頻正弦波輸出，以符合歐美日等地區之電磁相容要
求。 
 - 12 -
第二章 文獻探討 
2.1 太陽光電能板最大功率追蹤之探討 
太陽光電能板是由許多太陽能電池經串並聯組合封裝程序後所組成，太
陽能電池基本上是一種光-電伏特的能量轉換元件，係一種利用太陽光直接發
電的光電半導體薄片，其將極高純度的半導體材料加入一些不純物質使其呈
現不同的性質，加入三價元素可形成 P 型半導體，而加入五價元素可形成 N
型半導體，PN 兩型半導體相結合後，當太陽光照射 PN 接面產生電子電洞對
而產生電流。太陽能電池之等效電路如圖 2-1 所示[35-36]。 
 
圖 2-1 太陽能電池等效電路 
 
sh
soso
satpho R
VRI
AKT
RIqV
III
+−⎥⎥⎦
⎤
⎢⎢⎣
⎡ −⎟⎟⎠
⎞
⎜⎜⎝
⎛ +−= 1exp    (2-1) 
其中電流源 Iph 用來表示太陽能電池經由光照射後所產生內部的短路電
流，等效電路中之串聯阻抗 Rs為太陽能電池在上、下接面引出之電極網之歐
 - 14 -
 
圖 2-2 太陽光電能板於不同日照強度下電壓-電流特性曲線 
 
 
 
 
圖 2-3 太陽光電能板於不同日照強度下電壓-功率特性曲線 
 
 
 - 16 -
由太陽光電池特性的分析，可以得知太陽光電能板電壓與電流輸出特性
會隨著周圍環境和負載變動而改變，且在每一個不同的溫度與日照度之操作
環境下，均有一特定之工作曲線和最大功率操作點(Maximum Power Point)，
然而在大氣條件改變與加入負載之後，太陽能板則無法工作在最佳工作點之
下，使太陽光電板組列的光電能轉換效率無法提升。因此若要得到太陽能板
之最大功率輸出則必須要使提供電源的太陽能板其等效輸出阻抗等於負端的
等效輸入阻抗，此為電路學上的最大功率轉移定理。為了進行最大功率的追
蹤，一般以直流-直流轉換器(DC to DC Converter)與太陽能板串聯藉由調整轉
換器的功率開關的工作週期，使負載端的等效阻抗與太陽能板能匹配，而在
實際上，太陽能板的輸出電壓與電流會隨著轉換器開關週期的變動而改變，
使太陽能板的輸出電壓與電流乘積最大的操作點，即為最大功率點。 
最大功率追蹤控制方法之選用與該充電器之良窳有密切之關係，目前已
有許多文獻提出最大功率追蹤(Maximum Power Point Tracking, MPPT)的方
法，歸納這些最大功率追蹤之控制法有電壓迴授法、功率迴授法、曲線近似
法、增量電導法與擾動觀察法[36]。 
電壓迴授法是最簡單的控制方法，此一迴授的方法是事先將太陽光電能
板在一個特定照度與環境溫度條件之下，使太陽光電能板操作某一最大功率
點所對應的參考電壓，不論日照度、溫度與負載的變動，均由控制器操作在
 - 18 -
所謂的增量電導法(Incremental Conductance Method)是利用迴授的電壓及
電流訊號分別計算出電壓、電流的變動量和瞬間電導值[38,41-42]，其架構如
圖 2-8 所示，藉由太陽能板在最大功率輸出點時輸出功率對電壓之變化率為 0
之原則即： 
               
0=
dV
dP
                   (2-3) 
因為 
               IVP =                  (2-4) 
所以將(2-3)式代入(2-2)可得到   
          V
I
dV
dI −=
                  (2-5) 
若上式成立則代表太陽能板之輸出操作在最大功率點上，功率追蹤控制
器應控制太陽能板之輸出電壓與電流保持不變，若不成立則再利用上述不等
式判斷此時的工作點位在最大功率點的左半邊、或者是右半邊。若迴授之電
導與電流對電壓變化量符合下列之條件式： 
              V
I
dV
dI −<
                  (2-6) 
則根據圖 2-2與圖 2-4的太陽光電能板電壓與電流曲線可以知道目前功率
點操作在最大功率點之右邊，控制器應降低太陽能板的輸出電壓，反之若迴
 - 20 -
2.2 鉛酸電池特性分析 
2.2.1 鉛酸電池快速充電探討 
  在變動氣候環境下，為了能將太陽光電能板所產生的電能快速儲存於鉛
蓄電池組內，除了需要最大功率追蹤將能源有效的轉換利用外，更需要配合
電池快速充電方法來達到這個目的。「快速充電」一詞乃是相對於傳統充電時
間長達 8 至 10 小時以上的慢速充電而言。近年來已有多種快速充電策略提
出，其中主要是以兩段式充電法、脈衝電流充電法、ReflexTM充電法及多段式
充電法 [2-14]。以下就是這些快速充電法的簡介： 
1. 兩段式充電法： 
  根據文獻[15-17]指出，兩段式充電法常見的方法有：兩段式定電壓法
(CV-CV)、兩段式電流法(CC-CC)、兩段式定功率法(CW-CW)及兩段式定電流
定電壓法(CC-CV)。其中以兩段式定電流定電壓法應用最為廣泛，圖 2-6 為二
段式定電流定電壓充電法之示意圖，這種充電方法結合了定電流及定電壓的
優點。在電池充電初期以定電流源對電池充電，可由充電電流來設定充電時
間及充電量；當電池端電壓上升至設定電壓時，即轉換為第二階段的定電壓，
並使用小電流對電池進行充電至充飽為止。這種方法可以避免定電流充電時
為了快速充飽使用較大電流而造成電池端電壓過高、溫度上升過快，損壞電
池。同時也可以避免定電壓在電池充電初期會產生較大的充電電流，讓電池
 - 22 -
此種方法也和脈衝充電法相同，對脈衝電流高度、脈衝寬度及脈衝頻率等參
數的決定都是需要針對電池加以測試後，找到較佳的參數組。 
4. 多段式充電法： 
  為了改善兩段式定電流定電壓充電法在第二階段的定電壓充電時間難以
估計這項缺點，文獻[20,21]也提出更多段的充電策略，圖 2-9 為三段式定電流
定電壓充電法(CC-CV-CC)，增加了第三段的定電流浮充階段。由於定電流浮
充容易產生過電壓，為了提高充電效率及保護電池，因此又將兩段式定電流
定電壓充電法改善為四段式(CC-CC-CV-CV)，在第一階段以較低的充電電流
讓電池活化，然後進入第二及第三快速充電階段，在這兩階段具有高充電電
流及過高的電壓，當快速達到 80%左右即進入第四段的低電壓浮充，將電池
穩定充飽。圖 2-10 為四段式定電流定電壓充電法示意圖，在文獻中也提出多
段式的充電法可以減少充電時間，並增加電池循環壽命，其原因為電池處於
高溫的時間減少。 
 - 24 -
I
t
休息時間
充電脈衝 t1
t2
充電週期
放電脈衝
 
圖 2-8 ReflexTM充電法之示意圖 
 
V, I
T
V
I
V
I
 
圖 2-9 三段式定電流定電壓充電法示意圖 
 
CONDITIONING BULK TOPOFF MAINTENANCE
V
I
 
圖 2-10 四段式定電流定電壓充電法示意圖 
 - 26 -
充滿的依據[25]，再從圖 2-12 觀察鉛酸電池定電流放電之電壓變化曲線可發
現，當電池在放電末期時，電池電壓將會急遽下降，而在此轉折點後電池所
能供應的容量，僅佔總供電量的極小部份，因此若將電池放電至此轉折點，
電池所供應之電容與理論容量相差不大，且在實際應用上，為了保護電池避
免過度放電的前提下，一般皆採用此點定義作為電池容量完全釋放的依據。 
11
12
13
14
15
16
17
18
0 4000 8000 12000 16000
Time(sec)
V
ol
ta
ge
(V
)
 
圖 2-11 鉛酸電池定電流充電之電壓變化曲線圖 
 
8
9
10
11
12
13
0 500 1000 1500 2000 2500
Time (sec)
V
ol
ta
ge
 (V
)
 
圖 2-12 鉛酸電池定電流放電之電壓變化曲線圖 
 - 28 -
2.2.4 電池殘量預估方法之探討 
目前估測鉛酸電池的殘量，已經發展出許多的技術，而其中主要的方法
有下列幾種： 
（1）比重計法（Specific Gravity）：比重計法主要是量測鉛酸電池電解液
的濃度變化，在放電過程中，電解液的濃度會逐漸減小，與電池目前的剩餘
容量成一比例關係，如圖 2-13 所示，因此利用比重計來量測目前電解液的濃
度就可以得知目前電池的剩餘電量[26]，但這種方法的缺點在於電池在充放電
時，電解液的濃度上層較低而下層較高，所以要測量到比較精確的容量時，
在測量前需要靜置一段時間待電解液本身擴散反應達到平衡後，才能夠量測
出正確之電解液濃度，且電池製造時必需先將比重計加裝於電池內部，造成
電池製造成本的增加。 
 
1050
1100
1150
1200
1250
1300
0 20 40 60 80 100
State of Charge (%)
Sp
ec
ifi
c 
G
ra
vi
ty
 (g
/c
m
 )
 
圖 2-13 電解液比重與電池殘量關係圖 
 
 
 - 30 -
測電池剩餘電量，但這種方法的缺點在於只適用在電池充飽時，且由於谷值
與峰值的電壓變化太小，需要使用較精密的儀器來量測，因此並不適合應用
在一般微處理器上。 
12.23
12.31
12.39
12.47
12.55
12.63
12.71
12.79
0 50 100 150 200 250 300
Time (sec)
V
ol
ta
ge
 (V
)
Trough Voltage
Plateau Voltage
 
圖 2-15 電池起始放電電壓曲線圖 
（4）內阻法（Internal Resistance）：內阻法主要是量測電池在放電期間的
內阻變化，進而估測目前電池剩餘的容量[29]，圖 2-16 為電池內阻示意圖，
內阻的計算方程式如下： 
IL
RLILVBZ )( ×−=           （2-8） 
Z 為電池內部阻抗 
VB 為電池內部電壓源 
IL 為電池加載電流 
RL 為外接負載 
 - 32 -
容量成一比例關係，因此我們可以從這個關係來獲得目前電池所剩餘容量，
其主要缺點為電池在放電後，電池需要 30 分鐘的時間，電壓才能趨於穩定，
圖 2-19 為電池開路之電壓回復曲線，從圖中可以發現若在 30 分鐘內量測電
池電壓作為電池剩餘容量的估測，由於電池電壓尚未趨於穩定，將會造成一
定程度的誤差。 
11
11.5
12
12.5
13
13.5
0 20 40 60 80 100
State of Charge (%)
V
ol
ta
ge
 (V
)
 
圖 2-18 開路電壓與電池殘量關係圖 
 
12.2
12.3
12.4
12.5
12.6
12.7
12.8
12.9
0 5 10 15 20 25 30
Time (min)
V
ol
ta
ge
 (V
)
 
圖 2-19 電池開路之電壓回復曲線 
 
 - 34 -
電流與電池容量有一加成效應。 
  觀察表 2-1 可發現鉛酸電池放電時，加成效應電流與真實電流之間，並
不是線性之關係，其加成效應電流與真實電流的關係圖如圖 2-20 所示。因此
當我們使用庫侖計法在累計電量時，我們必需考慮到加成效應電流之影響，
如此才能夠比較精確的計算出電池的殘餘電量，因此我們應該要把式 2-2 中
的 I 改變為與加成效應電流之函數，如下所示： 
∑
=
×−=
n
t
ininow tIfAhAh
0
)(                 （2-10） 
  
表 2-1 電池真實放電電流與加成效應電流比較表 
放電電流 
(A) 
放電時間
(Hr) 
放電電量
(Ah) 
額定容量
(Ah) 
加成效應電流
(A) 
倍率 
0.45 9.67 4.35 4.5 0.46 1.0222 
0.9 4.38 3.94 4.5 1.02 1.1333 
1.35 2.75 3.71 4.5 1.63 1.2074 
1.8 1.95 3.51 4.5 2.30 1.2777 
2.25 1.47 3.30 4.5 3.04 1.3511 
2.7 1.16 3.13 4.5 3.86 1.4296 
3.15 0.94 2.96 4.5 4.78 1.5174 
3.6 0.77 2.77 4.5 5.80 1.6111 
4.05 0.65 2.63 4.5 6.91 1.7061 
4.5 0.55 2.47 4.5 8.14 1.8088 
5 0.46 2.3 4.5 9.62 1.924 
8.3 0.2 1.66 4.5 22.28 2.6843 
 - 36 -
2.3 電力轉換器設計之探討 
2.3.1 降壓型直流轉換器設計 
太陽光電能系統利用降壓型直流轉換器對電池組做充電，經由調整功率
開關元件之工作週期提供充電電流與獲得太陽光電能板最大功率，將太陽光
電能板所獲得之能量完全轉移至電池組中，以提供高充電率對電池組充電，
使串聯電池組快速提升電量。為了提高降壓式直流轉換器之效率，因此必須
將直流轉換器操作在連續導通模式(Continuous-Conduction mode, CCM)。 
降壓型直流轉換器其電路架構如圖 2-21(a)所示，由功率開關 Q1、二極體
D1、電感 L 與電容器 C 所構成。當功率開關 Q1 導通時其等效電路如圖 2-21(b)
所示，輸入電壓 VI會經由電感 L 將能量傳送至負載並且對電容器 C 充電，而
電感器 L 上的電流會呈線性增加以儲存能量，由於 Q1導通時二極體 D1之陰
極等於 VI，故 D1處於逆向偏壓狀態因此不導通。若功率開關 Q1 在截止時其
等效電路如圖 2-21(c)所示，儲存在電感器 L 上之能量將被釋放，由於電感電
流必須保持同一方向，因此電感器上之電壓極性會被反轉，此時二極體 D1陰
極之電位為負電位，故二極體處於順向偏壓狀態因此導通，提供電感及電容
將能量釋放至負載的一個放電路徑。此電路中，LC 構成一個低通濾波器，以
減小漣波電壓使輸出為一穩定之直流[45-48]。 
    在功率開關 Q1 導通等效電路如圖 2-21(b)所示，電感器的電壓與電流如
 - 38 -
 
(a) 
 
(b) 
 
(c) 
圖 2-21 降壓型直流轉換器在連續導通模式下之等效電路圖 
 - 40 -
所示，耦合電感 N1一次側繞組會有初級電流 IP流過，並將能量儲存於其中，
因此 IP 電流呈線性上升。由於耦合電感的一次側繞組與二次側繞組極性相
反，此時二極體 D1處於逆偏狀態，因此輸出能量由電容器 CO所提供[45-48]。
一次側電感 LP之電壓方程式為: 
    
ON
L
P
P
PI t
IL
dt
dILV ∆==                                        (2-17) 
電流 IP的變化率為: 
    ON
P
I
L tL
VI =∆                                               (2-18) 
    minmax IIIL −=∆                                            (2-19) 
當功率開關 Q1截止時，由於耦合電感的能量釋放，且一次側與二次側繞
組極性相反，使得二體極 D1 處於順偏狀態，此時輸出電容器 CO 被充電，負
載 RL有 IS電流流過，其等效電路圖如圖 2-23(c)所示。跨於二次側繞組 NS的
壓降為 VS = VO ，二次側電感 LS之電壓方程式為: 
    
OFF
L
S
S
SO t
IL
dt
dILV ∆==                                        (2-20) 
電流 IS變化率為: 
    OFF
S
O
L tL
VI =∆                                               (2-21) 
    minmax nInIIL −=∆                                           (2-22) 
 - 42 -
     
( )
S
SfO
L
O
L
TDVV
R
V 22
2
1 +×=                                     (2-29) 
由於 SP LLn /2 = ，其輸出電壓如下: 
      
( )
P
SfOL
O L
nTDVVRV
22
2
2
+×=                                  (2-30) 
由上式可以得知，當返馳式直流轉換器操作在不連續導通模式，當負載變大
時其工作週期會變大;反之，負載變小時其工作週期變小，以獲得固定的輸出
電壓。 
 
Co
D1
Q1
VoN1 N2
T1
VI Ci
RL
 
(a) 
 
Co
D1
Q1
VoN1 N2
T1
VI Ci
RL
IP
 
(b) 
 
Co
Q1
VoN1 N2
T1
VI Ci
RL
IS
 
(c) 
圖 2-23 返馳式直流轉換器在連續導通模式下之等效電路圖 
 - 44 -
2.3.3 升壓式轉換器架構與原理 
    升壓式轉換器輸出電壓高於輸入電壓，因此被廣泛的應用於須將低準位
輸入電壓轉換為高準位輸出電壓之場合，例如升壓式直流電源供應器、直流
馬達再生制動、功因修正電路中[45,49]。太陽光電能系統中，如太陽光電能
板輸出電壓較低，則可使用升壓式轉換器來轉換電壓準位。 
    圖 2-26 為升壓式轉換器的基本架構圖，是由一個電感器 L、功率元件 1Q 、
二極體 1D 與電容器C 所組成。電感器 L 又稱為扼流圈，主要用途為傳送與儲
存能量。電容器C 主要用途也是傳送與儲存能量，且有濾波之作用。而功率
元件 1Q 與二極體則是作為開關之用，並控制能量傳送、儲存與能量傳送方向。 
 
圖 2-26 升壓式轉換器基本架構圖 
    升壓式轉換器運作時，當功率元件 1Q 導通時，輸入電壓 INV 將跨於電感器
L 之兩端，電感將儲存由輸入電壓 INV 所輸入之能量，電感電流將成線性上
升。此外，假設一開始電容器C 之電量已經充飽，因此在功率元件 1Q 導通的
同時，由於電容器兩端電壓高於功率元件之端電壓，因此使得二極體 1D 逆向
 - 46 -
Conduction Mode, CCM)與不連續電流導通模式(Discontinuous Conduction 
Mode, DCM)。所謂連續電流導通模式是指當一個切換週期結束時，流經電感
之電流其最小值不降為零，使得電流保持連續狀態[47,49]。圖 2-29 為連續電
流導通模式下，升壓式轉換器的電壓與電流波形。 
 
圖 2-29 升壓式轉換器連續電流導通模式電感電壓與電流波形 
    假設輸入、輸出電壓固定，由電感伏秒平衡(Volt-second Balance)之關係
可得知電感電流變化量 Li∆ 為： 
L
TDVVV
L
DTVi SINFOSINL
)1()( −⋅−+=⋅=∆                          (2-31) 
D：為 1Q 的工作週期 
ST ：為 1Q 的切換週期 
FV ：二極體 1D 的順向導通電壓，當 OV 遠大於 5V 時可忽略 
    式(2-31)代表電感電流的變化於 1Q 截止與導通的時候應相同，其中 SDT 表
 - 48 -
 
圖 2-30 升壓式轉換器不連續導通模式電感電壓與電流波形 
    在不連續導通模式下，可以電流的變化來區分成三個操作時間：一為 1Q 導
通、 1D 截止，其時間為 SaTD ；二為 1Q 截止、 1D 導通，其時間為 SbTD ；三為
1Q 與 1D 皆截止，其時間為 ScTD 。在 ScTD 時間內，由於此時輸出電壓已大於
LIN VV + ，使得 1D 形成逆向截止。在不連續導通模式下，輸入、輸出平均電
壓之關係為： 
b
ba
IN
O
D
DD
V
V +=                                                 (2-35) 
    當負載變輕時，將使得升壓式轉換器進入不連續導通模式，若負載變輕
將使 bD 變小，由(2-35)可知當 bD 變小時會使輸出電壓隨之增加，大量的能量
將由輸入轉至電容與負載，如電容耐壓不足將導致燒燬[49]。因此當進入不連
續導通時須對 OV 嚴加控制以防電壓過高。 
 
 - 50 -
壓式轉換器將無法提供逆流電流必要的電流路徑，必須使用具有雙向電流能
力的升壓式轉換器[50]。圖 2-32 所示為雙向電流升壓式轉換器之電路，此電
路將傳統升壓式轉換器之二極體以具有逆向整流二極體之功率晶體替換，其
電路運作與一般升壓式轉換器相同。值得注意的是，當功率開關 2Q 截止、 1Q
與其逆向二極體導通時，此時電流可由 1Q 之逆向二極體流出，亦可經由功率
開關 1Q 流入。 
 
 
圖 2-32 雙向電流升壓式轉換器 
    圖 2-33 為升壓式轉流器的基本電路架構，使用了兩組雙向電流升壓式轉
換器所構成。功率開關 1Q 、 2Q 與電感 1L 、電容 1C 構成 Boost1，功率開關 3Q 、
4Q 與電感 2L 、電容 2C 則構成 Boost2，而負載則位於這兩組升壓式轉換器間。 
 - 52 -
週期間的關係[54-55]。此外，電感器與電容器的微分方程式為： 
dt
dILIRV LLLL 11111 +=                                           (2-38) 
dt
dVC
dt
dICRI OCCC 111111 =+                                       (2-39) 
1LR ：電感 1L 內阻 
1CR ：電容 1C 內阻 
    由(2-38)電感器的微分方程式經拉氏轉換即可獲得 1LV 與 1LI 間的轉移函
數，再由(2-36)中 INV 、 1LV 與 11 D− 的關係即可獲得電感電流受控模型。另外，
由(2-39)電容器的微分方程式經拉氏轉換取得 1CI 與 1OV 間的轉移函數，再由
(2-37)中 11 D− 、 1LI 與 1OI 之關係即可獲得輸出電壓的受控模型[55]。升壓式轉
換器的受控模型如圖 2-34 所示。 
sLRL 11
1
+× +−
INV
11 D− 1LI sC
sCRC
1
111+× + −
1OI
1OV
R
1
1LV
1CI
 
圖 2-34 升壓式轉換器受控模型 
    本文採用[55]所提出的雙迴路控制架構。雙迴路控制主要是建構在平均連
續時間模型上，由前述得知升壓式轉換器的受控模型可分為電感電流與輸出
電壓兩者，因此在雙迴路控制中即分為電感電流與輸出電壓兩個控制迴路。 
 - 54 -
    在控制升壓式轉流器時，需要提供控制器輸出電壓的參考信號，才能使
升壓式轉流器輸出正弦波。目前有三種電壓參考信號的產生方式可供選擇。
第一種方式是對升壓式轉流器內部的兩組轉換器分別給予相差 180 度的弦波
參考信號，各參考信號為： 
)2sin( ftVVOref π=                                             (2-40) 
)2sin(
221
ftVV
V
VV DC
Oref
DCrefO π+=+=                            (2-41) 
)2sin(
222
ftVV
V
VV DC
Oref
DCrefO π−=−=                            (2-42) 
OrefV ：輸出參考信號 
refOV 1 、 refOV 2 ：升壓式轉流器內兩組轉換器的參考信號 
V ：輸出電壓最大值 
DCV ：直流準位電壓 
    此方法的優點是控制較為單純且簡單，但當其中一組轉換器故障時，另
一組轉換器將無法反應而持續工作，此將造成輸出電壓不穩且會有直流準位
的現象，亦無法抵抗負載的擾動所引起的電壓變動[55]。 
    第二種電壓參考信號產生方式是讓第二組轉換器對第一組轉換器的輸出
電壓做取樣，並將該電壓取樣與輸出參考信號相減以作為第二組轉換器的參
考信號，其參考信號為： 
 - 56 -
第三章 研究方法 
3.1 太陽光電能板最大功率點追蹤之設計 
為了確保太陽光電能板能夠操作在最大功率點，本文使用擾動觀察法，
擾動觀察法具有原理簡單、容易實現等優點[42]，圖 3-1 為擾動觀察法最大功
率點追蹤示意圖，太陽光電能板的工作可分為兩個特性區域，假設進行追踨
時的工作點落在左半區時，電壓的增加會使輸出功率增加，若工作點在右半
區時，太陽光電能板的電壓增加會使輸出的功率減少。由上述之太陽光電能
板相關特性的探討中可以得知，太陽光電能板要得到最大功率必須調節直流
轉換器與負載間的阻抗使其與太陽光電能板電源的阻抗相等。若在固定的時
間間隔內以直流-直流轉換器對太陽光電能板作出電壓擾動，再量測其功率
P(n)，假使輸出功率較變動前之功率 P(n-1)大， 
)1()(
)1()(
−−
−−=
nVnV
nPnP
dV
dP                                         (3-1) 
則將輸出功率繼續朝同一方向變動；反之若輸出功率較變動前小的話，
則表示需要在下一週期改變電壓擾動的方向，其判斷如表所示，經由反覆地
擾動、觀察及比較，可以獲得太陽光電能板輸出的最大功率點，圖 3-2 為單晶
片實際應用擾動觀察法來實現最大功率追蹤的控制流程圖。 
 - 58 -
3.2 太陽光電能充電器之設計 
本文提出的太陽光電能系統之電池組充電器包括七個主要部分，其系統
架構如圖 3-3 所示，分別為(1)太陽光電能板組列(2)HT46R22 微處理器(3)升壓
式轉換器(4)返馳式轉換器(5)脈寬調變器(6)類比開關(7)串聯電池組。 
 
太陽能光電板組列
升
壓
式
轉
換
器
微處理器
類比開關
電
流
取
樣
儲能電容 電流取樣
串
聯
電
池
組
脈
波
寬
度
調
變
返馳式轉換器
電壓
取樣
放
電
訊
號
升壓式轉換器
電
壓
取
樣
充
電
訊
號
PWM　command
 
圖 3-3 充電器系統架構圖 
1.太陽光電能板組列 
考慮轉換器本身之轉換效率與太陽光電能板之特性，本研究使用六只最
大輸出功率為 110 W 之太陽光電能板組列，其最大開路電壓為 43.2 V，最大
短路電流為 19.4 A，於最大功率點操作時之電壓為 34.56 V，電流為 19.2 A。
理論上，太陽光的照度為 1 kW/m2時，太陽光電能板組列可獲得最大功率 660 
W 輸出，實際接線如圖 3-4 所示。 
 - 60 -
感器 L1 上的電流增減量△IL1應該相同。 
L
tVV
L
tVI offdoonsL
)(
1
1
−=⋅=∆  (3-6) 
so VD
V ⋅−= 1
1                   (3-7) 
藉由控制驅動功率晶體的 PWM 訊號之工作週期 D，可以改變充電電壓
VO，並控制太陽能板之輸出充電電流。 
 
3.返馳式轉換器 
本文之放電回路由四個返馳式轉換器所構成，返馳式轉換器主要為控制
開關、四組變壓器初次側繞組與一組二次側繞組所組成，由微處理器控制放
電時序，將初次側放電負脈衝電流與變壓器電磁耦合所產生的能量，經由返
馳式轉換器架構回送至前級的儲能電容中，供給下次之正脈衝充電使用，減
少放電能量的損耗。 
on
P
P
P
PB t
IL
dt
diLV ∆==1                    (3-8) 
on
P
B
P tL
VI 1=∆                          (3-9) 
minmax IIIP −=∆                                             (3-10) 
當功率晶體截止時，由於變壓器的磁場消失，繞組的極性相反，使得二
 - 62 -
其中 n 為匝數比，其值為，而一、二次電壓與電流的關係為： 
D
D
N
N
V
V
S
P
B
O
−⋅= 11
   (3-15) 
藉由控制驅動功率晶體的 PWM 訊號之工作週期 D，可以改變充電電壓
VO，並控制電池組之放電電流。 
 
4.微處理器 
基於電路設計與可程式化的方便考量，採用盛群（HOLTEK）半導體生產
的 HT46R22 單晶片微處理器進行充電控制，其內部架構如圖所示，HT46R22
內部具有19個雙向 I/O接腳與一個9位元解析度之類比/數位(Analog to Digital, 
A/D)轉換器，藉由軟體進行內部切換可達到 8 組 A/D 訊號輸入(PB0~RB7)，
配合取樣電路可利用於偵測太陽光電能板最大功率追蹤的電壓、電流回授訊
號與鉛酸電池電壓偵測。而單晶片內部在固定的時間間隔內使用內部計時器
中斷，對太陽能板組列進行最大功率追蹤的擾動與觀察，並根據太陽能板組
列回授的電壓與電流訊號，進行功率變動量的觀察，將擾動後的結果經由程
式的判斷，使驅動升壓轉換器 PWM 訊號的週期改變並改變太陽能板組列的輸
出電壓，進而獲得最大功率輸出。升壓轉換器高頻 30kHz 的 PWM 訊號並非
由單晶片產生，而是由 I/O 接腳產生 30Hz 的低頻 PWM 訊號，經由低通濾波
後得到直流電壓準位，再送至脈波寬度調變器電路而產生。 
 - 64 -
6.類比開關 
正脈衝控制訊號與四個負脈衝控制訊號，這些訊號由單刀單擲(Single Pole 
Single Throw ,SPST)類比開關 ADG201 所控制。為了使充放電控制時序能夠互
相配合，達到精確的正負脈衝充放電之控制，由單晶片 HT46R22 之 PA3~PA7
產生一組 30Hz 之正脈衝控制訊號與四個負脈衝控制訊號，這些訊號的控制由
內部具有四組單刀單擲(SPST)開關的 ADG201 類比開關 IC 達成，該元件具有
低導通阻抗、截止低時漏電流與高切換頻率等特性，適合用於控制本文 TL494
高頻 PWM 信號的導通與截止，如圖 3-7 所示，當傳送至類比 ADG201 之 IN
訊號腳為低態時，開關處於導通狀態，接於開關 D 腳之 TL494 訊號會將訊號
傳送至 S 腳，並驅動升壓式與返馳式轉換器之 MOSFET 閘極接腳使轉換器進
行切換動作。 
 10V/divVGS1
 10V/divVGS2
10V/divVGS3
 10V/divVGS4  T  10ms/div
 
圖 3-7 充電器之功率晶體驅動訊號波形 
 - 66 -
 S t a r t
讀 取
電 池 端 電 壓
串 聯 電 池 組
電 壓 到 達 5 8 V？
否
是
6 0 V 定 電 壓 充 電
正 脈 衝 充 電
最 大 功 率 追 蹤
電 池 電 流 > 1 . 3 5 A
是
負 脈 衝 充 電
否
跳 至 S t a r t
讀 取 電 流
跳 至 S t a r t
 
圖 3-8 充電控制流程圖 
 - 68 -
均充架構，返馳式直流轉換器由一個功率開關及一只多重繞組變壓器所構
成，經由控制功率開關之工作週期獲得穩定輸出電壓，由於多重繞組變壓器
二次側採用多繞組輸出且匝數比相同，因此在二次側可獲得多組且相同的輸
出電壓對電池充電，而高電量之電池其內部電動勢較高因此所獲得的充電電
流較小；反之，低電量電池可獲得較高的充電電流，經過一段充電時間每只
電池充入的電量接近相同，以達到串聯電池組均充之目的，此方法之優點為
能量轉換較大，且均充時間短較符合日照時間。 
4.串聯電池組:串聯電池組是使用湯淺(YUASA)公司所生產之密閉式鉛酸電
池，其端電壓為 12 V 容量為 4 AH，使用 4 只鉛酸電池串接成電池組，根據
電池特性，串聯電池組端電壓上升至 48 V，而容量仍維持 4 AH。 
5.微處理器:微處理控制器本文選用盛群(Holtek)半導體所生產之單晶片微處
理器 HT46R23，此單晶片微處理器具有 23 支 I/O 接腳，內建 8 通道 10 位
元之 A/D 轉換與 2 組 8 位元之 PWM 模組，經由微處理器可做電壓電流取
樣與提供多組控制訊號，以簡化電路的複雜度及降低電路成本，並且縮短
開發設計的時間。 
6.電壓電流取樣:太陽光電能板之電壓與電流取樣是利用分壓電阻與霍爾元件
所組成，且配合微處理器之 A/D 轉換得知太陽光電能板之輸出電壓與電流
值。 
 
 - 70 -
1.最大功率追踨 
當串聯電池組端電壓低於 54V 時，利用降壓式直流轉換器並配合最大功
率追踨進行充電，本文所使用的最大功率追踨演算法為擾動觀察法，此演算
法具有原理簡單及容易實現優點，其最大功率追踨控制流程如圖 3-3 所示
[42]。首先將參數 S 設為正 1，而參數 S 在流程中主要是來辨別增加工作週期
或減少工作週期，因此 S 不是為正 1 即是負 1。接下來量測太陽光電能板目前
輸出電壓 V(K)與電流 I(K)，並且利用所量測到的電壓與電流來計算太陽光電
能板輸出功率 P(K)，然後與前一次輸出功率 P(K-1)做比較，如果與前一次功
率相等表示為最大功率點因此不需調整工作週期，如果 P(K)大於 P(K-1)則做
同一方向之擾動，反之當 P(K)小於 P(K-1)則參數 S 取反向即可做反方向之擾
動，經過反覆調整達到最大功率追踨之目的。 
 
2.均充控制 
均充控制流程如圖 3-11 所示，由於微處理器在做類比/數位轉換時僅能轉
換一個通道，因此要量測多組端電壓必需透過程式切換不同的類比/數位轉換
通道才可量測多組電壓。每只電池端電壓可利用程式計算得知，首先將量測 4
只電池串聯之端電壓，接下來量測 3 只電池串聯之端電壓，再將兩電壓值相
減即可獲得電池 1 之端電壓依此類推即可獲得電池 2、電池 3 及電池 4 之端電
壓，當知道各別電池端電壓之後需找出最高端電壓之電池來做電壓回授控
 - 72 -
 
 
圖 3-11 均充控制流程圖 
 
 
 - 74 -
3.4.1 電力轉換器之硬體設計 
    升壓式轉流器所使用的主要元件為儲能電感、電容與功率元件，本節將
分別討論此三種元件的設計與選擇。設計升壓式轉流器的第一步是要訂定轉
流器的電器規格，關於升壓式轉流器的規格，可分為以下幾項： 
1. 輸入電壓：電力轉換器使用於太陽光電能系統中，轉流器的輸入電壓即為
太陽光電能板組列之輸出電壓，由前述中可知當太陽光電能板組列開路時
電壓最大可達 86.4IV，但事實上因受溫度影響，實際的開路電壓會低於
86.4IV，經實際量測測得太陽光電能板的開路電壓約在 75IV，因此設定轉
流器的輸入電壓最高為 75IV。考量最低輸入電壓時，先假設當系統有安裝
串連電池組時，每顆電池充飽時為 15IV 而放電截止電壓設為 11IV，因此
在太陽光電能板組列輸出可安裝 5 顆電池串組，這五顆電池串組於充滿電
時可達 75IV，而放電截止時則達到 55IV，故設定系統最低輸入電壓為
55IV。在此即可訂定升壓式轉流器的輸入電壓為 55~75IV。 
2. 輸出電壓：電力轉換器使用兩組轉換器分別輸出具有直流準位的交流弦
波，對於此兩組轉換而言，輸出的電壓大小與波型如圖 3-13 之波形所示，
為使輸出的交流能達到最大值 155IV，因此兩組轉換器的輸出最大落差必
須達到 155IV，由於升壓式轉換器輸出電壓必大於輸入電壓，因此設定兩
組升壓式轉換器的最低輸出電壓為 82.5IV。而升壓式轉流器的最高輸出電
 - 76 -
5. 漣波電流：通常漣波電流需小於兩倍電流最小值，因此可定義漣波電流必
須小於 0.3IA。 
6. 漣波電壓：通常漣波電壓需小於輸出電壓的 1I%，考量輸出電壓最小值為
83IV，因此訂定漣波電壓必須小於 0.83IV。 
    表 3-1 為以上升壓式轉流器的電氣規格整理，為使系統於運轉時能較為
穩定，在進行設計時將把升壓式轉流器設計於連續導通模式下。 
表 3-1 升壓式轉流器電氣規格 
輸入電壓( INV ) 55~75(V) 
輸出電壓( OV ) 82.5~237.5(V) 
輸出電流( OI ) 0.15~3(A) 
工作頻率( Sf ) 15.625(kHz) 
漣波電流( LI∆ ) 0.3(A) 
漣波電壓( OV∆ ) 0.83(V) 
    在暸解升壓式轉流器的電氣規格後，即可開始設計轉流器內所需使用的
元件。首先進行電感器的設計，連續導通模式下，電感器必須大於邊界條件
值[49]，在邊界條件下電感器平均電流為： 
IILB ∆= 2
1
                                               (3-17) 
由於電感器伏秒平衡，且不論是連續或不連續均需符合邊界條件，因此可得
 - 78 -
0.825IA。將電壓漣波與表 3-1 內之設計條件代入(3-22)，可得到所需電容量約
為 22IµF，電容之耐壓則必須大於輸出電壓最高值的 1.2 倍以上，即大於
285IV。在此則使用容量 22IµF 耐壓 250IV 之電解電容，並以串二並二的方式
以提高電容組的耐壓並降低因 ESR 所造成的電容溫升。 
    最後，關於功率晶體的選用方面功率晶體所必須承受的電壓等於輸出電
壓的最高值，電流部份則為輸入電流加上一半的電流漣波，為了安全起見所
有的耐壓與耐流均需要選用 1.2 倍以上，因此功率晶體的選擇方面則需要耐壓
需要 285IV 以上，耐流則需要 12.5IA 以上。 
 
3.4.2 電力轉換器之軟體設計 
    控制程式主要的功能是取得輸出電壓參考信號與各電壓、電流之回授進
行運算，以取得驅動轉流器功率晶體所需要的 PWM 驅動信號，藉以使轉流
器能輸出正弦波電源。電力轉換器之控制架構採用雙迴路控制，須執行多達
四次的 PI 控制運算，需要的運算時間較長，因此電力轉換器的 PWM 驅動信
號的週期採用 15.625IkHz，並且令微處理器每四個 PWM 切換週期更新一次
PWM 值，如此就有 256Ius 的時間可進行控制程式的運算，而產生弦波的查
表數量也可減少。圖 3-14 所示本系統的主程式流程，各流程說明如下： 
1. PWM 更新：此程式將把執行 PWM 計算程式後所得到的 PWM 值，藉由微
處理器本身的 PWM 模組輸出，以控制升壓式轉流器。為求準確的控制，
 - 80 -
 
 
 
 
 
圖 3-14 主程式流程圖 
 - 82 -
3.5 鉛蓄電池殘餘電量估測之設計 
3.5.1 殘量預估模組硬體設計 
圖 3-16 為一個典型的電池管理系統架構圖，從圖上可以看到裡面包括一
個電池充電器，而其充電電源可以是一般的市電、太陽能發電或風力發電等
方法獲得，而圖中的電池管理系統的主要的功能如下： 
1.電池殘量的估測 
2.電池殘量的顯示 
3.電池損壞的檢測 
4.電池過放電保護 
5.電池過充電保護 
6.電池資料的收集 
由以上得知，一個良好的電池管理系統是非常重要的，而電池管理系統
中，電池殘量的預估又是控制電池過充與電池損壞的依據，因此本研究特別
對電池的殘量預估進行設計，圖 3-17 是本文的電池殘量預估模組的整體架構
圖，主要核心為 1.微處理器電路、2.鉛酸電池電壓偵測電路、3.鉛酸電池電流
偵測電路、4.通訊介面電路、5.液晶顯示電路、6.控制訊號電路、7.儲存記憶
體與 8.資料接收軟體，各電路方塊圖及動作分析如下： 
 
 
 - 84 -
由式 3-24 我們可以知道電池總共被降壓 1/4 後，再經由 A/D 模組加以讀
取，且因為 A/D 模組為 10 位元解析度，因此能夠量測的最低電池電壓解析度
是 mV56.19
1023
45 ≅× 。 
 
3.鉛酸電池電流偵測電路： 
本文電流偵測電路使用 0.1Ω的電阻來感測電流，如圖 3-20 所示，根據
歐姆定律
I
VR = 可以計算出線路上之電流值，也就是假設電阻上的壓降為 0.1
伏特，我們可以求得線路上的電流為 1 安培，電路中的多工器（U2）用來選
擇電流方向，也就是電池充電或放電之狀態，而電路中之齊納二極體(ZD1)
與肖基二極體(D1)是用來確保輸入微處理器之電壓小於 5.1 伏特與大於-0.2 伏
特，本電路所能量測的最低電流解析度是 mA219.12
1.041023
5 ≅×× 。 
 
4.通訊介面電路： 
本文用來與電腦通訊方法是使用標準 RS232 通訊協定與電腦進行資料傳
送，但由於電腦的訊號準位是負邏輯準位，電壓 15~5 伏特之間為低邏輯準位，
電壓-5~-15 伏特之間為高邏輯準位，而 HT46R23 的電壓訊號是以 5~3.5 伏特
之間為高邏輯準位，1.5~0 伏特之間為低邏輯準位與電腦的訊號準位不同，因
此必需使用電壓轉換 IC 來轉換訊號準位，如圖 3-21 所示，以便達成通訊之
目標。 
 - 86 -
 
圖 3-16 典型的電池管理系統架構圖 
 
 
圖 3-17 殘量偵測模組整體架構 
 - 88 -
R13
150k
R14
10k
R4
150k
R15
10k
R3
150k
R16
10k
R2
150k
R17
10k
R18
10k
R1
150k
B1
B2
B3
B4
-9V
0X12
1X14
2X15
3X11
0Y1
1Y5
2Y2
3Y4
A10
B9
INH6
X 13
Y 3
VCC 16
VEE 7
GND 8
U2
4052
PB2
VCC
PD1
12
13
14
U1D
LM324
PD0
10
9
8
U1C
LM324
5
6
7
U1B
LM324
R13
0.1/1w
R6
30k
AN0R520k
-9V
R7
30k
+9V
3
2
1
4
11
U1A
LM324
D3
DIODE
R10
100k
R9
100k
D2
5.1v
R8
100k
R11
100k
T1
T1
T2
T2
 
圖 3-19 鉛酸電池電壓偵測電路 
12
13
14
U1D
LM324
10
9
8
U1C
LM324
5
6
7
U1B
LM324
R6
30k
R5
20k
R7
30k
R10
100k
R9
100k
R8
100k
R11
100k
D2
5.1v
D3
DIODE
3
2
1
4
11
U1A
LM324
+9V
-9V
AN0
VCC
PD0
PD1
PB1
0X12
1X14
2X15
3X11
0Y1
1Y5
2Y2
3Y4
A10
B9
INH6
X 13
Y 3
VCC 16
VEE 7
GND 8
U3
4052
-9V
B1
R13
0.1/5w
R23
圖 3-20 鉛酸電池電流偵測電路 
 
 - 90 -
3.5.2 殘量預估模組軟體設計 
  本文之程式撰寫，完全使用組合語言，並遵循高階程式語言之匈牙利命
名原則來指定變數名稱，程式設計也朝向模組化之方式寫作，這種方法不但
在初次撰寫程式時，能夠快速的將所需功能完成，最大的經濟效益是在日後
的程式除錯與維護上，因為程式碼被分解成獨立且功能簡單的流程，因此只
需稍有程式設計能力的程式設計師，就能夠簡單的將該模組修改成他所需要
的程序。 
  在整個軟體設計中最重要的是每個副程式的執行時間，與整體流程的時
序觀念，簡單的說就是我們必需在確定的時間內，將該執行的程式碼全部執
行完畢，才不會造成程式的誤動作，例如全部的程式流程執行完畢所要花的
時間是 100 毫秒，也就是說我們最快的電壓與電流取樣時間，也頂多是 100
毫秒取樣一次，太快的取樣速度沒有辦法完成全部的執行流程，造成程式之
誤動作，太慢的取樣也會降低程式計算殘量的誤差增加，因此程式時序的觀
念，對於殘量預估時，電壓電流的取樣時間非常重要，且對於輸出控制方面，
錯誤的時序輸出訊號也將造成電路的誤動作，甚至於損毀電路元件。 
  本文之程式設計主流程如圖 3-23 所示，主流程包括 1.電池電流取樣副程
式、2.電池電壓取樣副程式、3.開路電壓法副程式、4.庫侖計法副程式、5.充
電殘量預估副程式、6.資料顯示副程式、7.通訊副程式、8.鍵盤掃描副程式與
 - 92 -
壓值，VNOW 為目前之電池開路電壓值，開路電壓修正程式流程圖如圖 3-26
所示。 
4.改良式庫侖計法副程式： 
如圖 3-27 為改良式庫侖計法副程式之流程圖，程式一開始先計算出加成
電流所消耗之電量，再與原本電池所剩的容量相減後，即可獲得目前的電池
容量值，並在程式最後依不同之放電電流來判斷電池是否到達放電終止電壓。 
5.充電殘量預估副程式 
持續累積充電器對電池供給之電流，當累積之電池容量到達 100%時，表
示電池目前為充飽之狀態，如圖 3-28 所示。 
6.資料顯示副程式 
本程式主要將電池之電壓、電流、電池狀態與殘量的值，經過轉換顯示
於液晶顯示器中，方便使用者即時觀察。 
7.通訊副程式 
通訊副程式使用標準 RS232 通訊協定，使用的鮑率為 57600BPS，不使用
同位元檢查碼，一個停止位元，為避免資料傳送接收錯誤，送出資料時，會
先送 55H 與 AAH 的前置位元組，如此可以讓接收程式判斷所接收的資料是
否為正確。 
 - 94 -
 
 
 
 
圖 3-24 電池電流取樣流程圖 
 - 96 -
 
 
 
 
 
 
 
圖 3-26 開路電壓法副程式流程圖 
 
 
 
 - 98 -
 
 
 
 
 
圖 3-28 充電殘量預估副程式流程圖 
 - 100 -
率點附近振盪較小。圖 4-3 及圖 4-4 分別為△duty 等於 3/256 與△duty 等於
5/256 的最大功率追踨歷圖，圖中可看到當△duty 為 5/256 追踨到最大功率點
時會在最大功率點附近產生較大振盪，因此無法獲得較多功率而造成功率損
失。使用△duty 為 3/256 的擾動量來進行擾動，其最大功率追踨之速度與穩定
性都較△duty 為 1/256 與△duty 為 5/256 較好，因此本文以△duty 為 3/256 進
行擾動。 
 
0 10 20 30 40 50 60 70 80 90
0
20
40
60
80
100
120
140
160
180
Voltage(V)
Po
w
er
(W
)
0.2kW/m2
0.4kW/m2
0.6kW/m2
0.8kW/m2
 
圖 4-2 △duty 為 1/256 擾動量之最大功率追踨歷程圖 
 - 102 -
4.2 太陽光電能充電器實測 
4.2.1 充電器之模擬 
    在電路實作之前，本文以 IsSPICE 軟體模擬充電器對單顆電池進行之充
電動作，以驗證電路之可行性，模擬電路如圖 4-5 所示，在此充電電池模型
參考電池手冊以直流電源 12V、電阻 10Ω及電容 1F 代替，而以 Vcon1與 Vcon2
代表單晶片微處理器產生的 30Hz 正負脈衝充電控制訊號，用以控制 S1與 S2
的線性開關的截止與導通，而高頻 30kHz 的 PWM 訊號由 Vpwm1與 Vpwm2產生，
並利用 S1與 S2的導通與截止，控制高頻 PWM 的通過產生驅動訊號，驅動升
壓轉換器功率開關 Q1與返馳式轉換器 Q2之閘極，對電池形成正負脈衝充放電
迴路，以產生 Reflex TM 充電之效果。 
 
圖 4-5 IsSPICE 充電模擬電路圖 
 
 
 - 104 -
如圖 4-7 之 VGS1與 VGS2之控制訊號，VGS1訊號用以驅動升壓式轉換器的閘極，
而 VGS2 則用來驅動返馳式轉換器的閘極，電池的充放電波形如圖中 IBAT1 所
示，可以看出正脈衝 4 安培、負脈衝 6 安培對電池進行模擬衝放電的動作。 
 
圖 4-7 Reflex TM 充電模式操作下控制訊號與充電電流模擬波形圖 
    模擬結果證實本文提出之電路，可經由簡單的時序控制可以使升壓式轉
換器與返馳式轉換器對電池進行 Reflex TM 充電的控制，亦可經由控制停止返
馳式轉換器之動作，僅使用升壓式轉換器對電池進行一般的充電。 
 
4.2.2 充電器之實測 
    實測方面，充電器操作於最大功率追蹤模式下，由升壓式轉換器進行最
大功率追蹤的動作，其 VGS1、VDS1、VL1、IL1各點動作波形如圖 4-8 所示，圖
中可以看出閘極之驅動電壓 VGS1 約為 10V，切換頻率為 30 kHz，而 VDS1 在
 - 106 -
 
圖 4-9 充電器於最大功率模式下 VGS1與充電電流波形 
     
當日照度增強時，太陽能板組列的輸出功率變大，能夠對電池充電的電
流也相對提高，此時充電器工作於 Reflex TM 充電模式對蓄電池組進行充電。
微處理器產生的充放電控制訊號如圖 4-10 所示，用以控制類比開關 ADG201
的導通與截止，由於 ADG201 為反向開關，當充電控制訊號 S1低態的期間，
ADG201 導通使 TL494 所產生的高頻 30kHz 通過，同樣地，S2、S３與 S４之放
電控制訊號在低態時亦會使高頻訊號通過，而產生如圖 4-11 之波形，VGS1用
來驅動升壓轉換器之閘極，而 VGS2、VGS3 與 VGS4 為各組反馳式轉換器之閘極
驅動訊號。 
 - 108 -
(30kHz)PWM 通過，藉由正負脈衝時序對直流轉換器的控制，可以得到充電 
電流 IBAT1，其每個週期之正脈衝時間為 26.65ms，電流約為 5A，負脈衝時間
為 1.3ms，電流約為 8A，其各電池之充電電流波形如圖 4-13 與圖 4-14 所示，
四只電池之 Reflex TM 充電電流波形乃依照單晶片微處理器送出的充放電控制
訊號來動作。 
 
 
圖 4-12 Reflex TM 充電模式下之功率晶體控制訊號波形與電池 1 充電波形圖 
 - 110 -
與功率晶體兩端 VDS1之電壓波形如圖 4-15 所示，由 VDS1可以看出此時的輸出
電壓約 60V，而控制訊號 VGS1相對於充電電流波形 IBAT1如圖 4-16 所示，由圖
中可看出在充電器為達到定電壓控制，使蓄電池之充電電流較為平穩。 
 
圖 4-15 充電器於定電壓模式下之 VGS1與 VDS1動作波形圖 
 
 
圖 4-16 充電器於定電壓模式下之控制波形 VGS1與電池組充電電流 IBAT1 
 - 112 -
4.3 電池均充器實測 
電池均充器包含了降壓式直流轉換器及返馳式直流轉換器，以下將針對
所實作之電路來做實際波形量測。首先量測降壓式直流轉換器之各點波形，
圖 4-19 為在低日照強度下 MOSFET 之各點波形，分別為 VGS(Ch1)、VDS(Ch2)
及 IDS(Ch3)，由閘極控制訊號可知閘極驅動電壓為 12V 且操作頻率約為
31.25kHz。在 VGS處於導通時 VDS也跟著導通而獲得太陽光電能板之電壓，因
此電感器開始儲存能量所以 IDS的電流呈線性上升，當 VGS截止時在 VDS有一
突波電壓約為 125V 左右，本電路中所採用的 IRF740 MOSFET 功率開關其
VDS最高可承受 400V，仍在安全使用範圍之內。圖 4-20 所示為低日照強度下
降壓式直流轉換器之電感電流 IL(Ch1)、二極體電流 ID(Ch2)及輸出電流
IO(Ch3)，在 VGS 截止時儲能電感開始釋放能量所以電感電流下降，其輸出電
容器、負載與二極體構成一釋放能量之路徑，因此電感電流下降斜率與流過
二極體之電流相同，根據電感電流可知目前處於連續通模式，所以輸出電流
等於電感電流之平均值，在此輸出電流即為充電電流約為 0.5A(0.12C)。 
圖 4-21 及圖 4-22 所示為在高日照強度下降壓式直流轉換器之各點波形，
圖 4-21 中 VGS(Ch1)之工作週期明顯增加且流過功率開關汲極(Drain)源極
(Source)電流 IDS(Ch3)比在低日照強度的 IDS高，而 VDS突波電壓增加至 175V
仍為在安全操作之內。圖 4-22 中電感電流 IL(Ch1)、二極體電流 ID(Ch2)及輸
 - 114 -
 
圖 4-21 高日照強度下降壓式直流轉換器之各點波形圖(VGS-VDS-IDS) 
 
 
 
 
圖 4-22 高日照強度下降壓式直流轉換器之各點波形圖(IL-ID-IO) 
 
VGS 10V/div 
VDS 100V/div 
IDS 2A/div 
T  10us/div 
T  10us/div 
IL 2A/div 
ID 2A/div 
IO 800mA/div 
 - 116 -
 
圖 4-23 均充初期返馳式直流轉換器之各點波形(VGS-VDS-IDS) 
 
 
 
圖 4-24 均充初期返馳式直流轉換器之各點波形(IS1-IS2) 
 
VGS 10V/div 
VDS 100V/div 
IDS 2A/div 
T  10us/div 
IS1 500mA/div IS2 500mA/div 
T  10us/div 
 - 118 -
 
圖 4-27 均充後期返馳式直流轉換器之各點波形(IS1-IS2) 
 
 
 
圖 4-28 均充後期返馳式直流轉換器之各點波形(IS3-IS4) 
 
 
 
IS1 100mA/div IS2 100mA/div 
T  10us/div 
IS3 100mA/div IS4 100mA/div 
T  10us/div 
 - 120 -
表 4-1 每只電池電量狀態 
 初始電量狀態
(%) 
放電電流 
(A) 
放電時間
(min) 
殘餘電量
(%) 
A1 100 2 48.0 60 
A2 100 2 51.6 57 
A3 100 2 55.2 54 
A4 100 2 58.8 51 
B1 100 2 36.0 70 
B2 100 2 48.0 60 
B3 100 2 60.0 50 
B4 100 2 72.0 40 
 
圖 4-29 為 A 組電池未用均充系統之充電歷程圖，由於 A 組每只電池的電
量狀態相差較少，因此充電初期端電壓相差較小，在充電截止時可明顯看出
VA1及 VA2的電池端電壓已超過 14.5V 已進入過充電領域，而 VA3及 VA4未達
充飽電壓，其最高端電壓與最低端電壓相差為 2V，有充電不均之現象。  
圖 4-30 為 A 組電池使用均充系統之充電歷程圖，由於充電前期是利用降
壓式直流轉換器搭配最大功率追踨，在前 50 分鐘是對串聯電池組充電，由圖
中可看出每只電池之端電壓上昇斜率相同，因此每只電池獲得的充電電流也
相同，而在充電截止時最高端電壓與最低端電壓相差約為 90 mV，與未使用
均充相比明顯沒有過充現象，且電池有達到均充之成效。 
圖 4-31 為 A 組電池放電歷程圖，其中 AV1為未使用均充的電池放電歷程，
AV2 為使用均充的電池放電歷程。當電池充完電之後利用電子負載以定電流
設定參數 
電池編號 
 - 122 -
0 20 40 60 80 100 120 140
12
12.5
13
13.5
14
14.5
15
15.5
16
Time(min)
V
ol
ta
ge
(V
)
VA1
VA2
VA4
VA3
 
圖 4-29 A 組電池未使用均充系統之四只電池充電歷程圖 
 
0 50 100 150 200 250
12
12.5
13
13.5
14
14.5
15
Time(min)
V
ol
ta
ge
(V
)
VA1
VA2
VA3
VA4
 
圖 4-30 A 組電池使用均充系統之四只電池充電歷程圖 
 - 124 -
圖 4-33 為 B 組電池未使用均充之充電歷程圖，B 組電池每只電量狀態相
差較大，所以電池端電壓也相差較大，由於 B 組電池的 VB1電量較高因此充
電至 35 分鐘電池端電壓已超過 14.5V 進入過充狀態，而 VB2也在 100 分鐘進
入過充狀態，在充電截止時 VB3及 VB4電池未達充飽電壓 14.5V，其最高端電
壓與最低端電壓相差為 2.5 V，由此可知當串聯電池組中每只電池電量相差較
大時，充電不均之現象更加明顯。 
圖 4-34 為 B 組電池使用均充系統之充電歷程圖，前期充電時日照強度較
大所以前期的充電時間較短，大約充電 18 分鐘就可充電至設定電壓而轉為均
充模式。由於 VB1電量較高所以電池端電壓相對的較高，因此 VB1較快達到充
飽電壓，為了避免 VB1過充在電池電壓達到 14.5 V 左右開始進行工作週期的
調整，在調整減少 VB1的充電電流時相對的 VB4充電電流也減少，因此每只充
電狀態相差較大時均充的時間就會比較長，而在充電截止時最高端電壓與最
低端電壓相差約為 180 mV，與未使用均充相比明顯沒有過充現象，且電池有
達到均充之成效。 
圖 4-35 為 B 組電池放電歷程圖，其中 BV1為未使用均充的電池放電歷程，
BV2為使用均充的電池放電歷程，其放電電流為 1.6A(0.4C)，放電截止電壓設
為 40V，圖中 BV1放電 120 分鐘而 BV2放電 135 分鐘，明顯看出有使用均充的
充放電效率較未使用均充的高。 
 - 126 -
0 50 100 150 200 250
12
12.5
13
13.5
14
14.5
15
Time(min)
V
ol
ta
ge
(V
) VB1
VB2
VB3
VB4
 
圖 4-34 B 組電池使用均充系統之四只電池充電歷程圖 
 
0 20 40 60 80 100 120 140
38
40
42
44
46
48
50
52
Time(min)
V
ol
ta
ge
(V
)
BV1 BV2
 
圖 4-35 B 組電池不同充電架構之電池放電歷程圖 
 - 128 -
表 4-2 不同充電架構實驗結果 
 
 
 
 
圖 4-37 均充系統之實體圖 
電池組 充電 架構 
總充電 
時間
(min) 
充電截止
時最大電
壓差(V) 
充電最
高溫度
(℃) 
充電量
(AH) 
放電量
(AH) 
充放電 
效率 
(%) 
無均充
電路 127 2.00 32.8 3.97 3.22 81.1 
A 組 有均充
電路 220 0.09 30.0 3.98 3.50 87.9 
無均充
電路 126 2.50 34.1 3.98 3.27 82.1 
B 組 有均充
電路 250 0.18 29.6 3.99 3.57 89.7 
 - 130 -
4.4 升壓型轉流器之模擬與實測 
    進行電路實作前，先以 IsSpice 來進行電路的模擬以確保系統電路的可行
性後，再進行電路的實作。圖 4-39 所示為升壓式轉流器的 IsSpice 電路與系統
模擬圖，在此將升壓式轉流器的控制系統與電路一併建構到 IsSpice 中，藉以
得到近似真實的模擬情況與結果。 
1
8
1 2
L1
1.2m
34
VIN
31
RL1
10m
19
RC1
10m
19
C1
4.5u
7
1
GATE1
Voltage
8
GATE2
Voltage
9
LOAD
142VO1
VIN
4
28
4
L2
1.2m
RL2
10m
16
RC2
10m
16
C2
4.5u
25
4
GATE3
Voltage
28
GATE4
Voltage
VO2
25
4
7
1
∆9
VO
volts
ISEN1
∆
1
VGS1
volts
1
∆
4
VGS3
volts
44
VGS4
volts
VGS2
volts
ISEN2
VO1
volts
VO2
volts
VIN
volts IIN
amps
IO
amps
IL1
amps
IL2
amps
1
∆
1
VCE1
volts
1
∆
4
VCE3
volts
4
VCE2
volts
VCE4
volts
V1
Vtri
SUM2
K1
K2
X3
SUM2
K/S
X5
SINT
GAIN
X8
GAIN
SUM2
K1
K2
X10
SUM2
SUM2
K1
K2
X11
SUM2
A 
B 
A/B
X22
DIVIDE
A3
LIMITC
ONESOUBD1
A4
LIMITCSUM2
K1
K2
62
X23
SUM2
GAIN
X24
GAIN
K/S
X25
SINT
SUM2
K1
K2
X26
SUM2
SUM2
K1
K2
X27
SUM2
A 
B 
K*A*B
X28
MUL
A 
B 
A/B
X29
DIVIDEVO1
IO
IL1REF
IL1
VO1
VO1
VIN
VIN
IL1REF
SUM2
K1
K2
X30
SUM2
K/S
X31
SINT
GAIN
X32
GAIN
SUM2
K1
K2
X33
SUM2
SUM2
K1
K2
X34
SUM2
A 
B 
A/B
X35
DIVIDE
A12
LIMITC
A13
LIMITCSUM2
K1
K2
66
X36
SUM2
GAIN
X37
GAIN
K/S
X38
SINT
SUM2
K1
K2
X39
SUM2
SUM2
K1
K2
X40
SUM2
A 
B 
K*A*B
X41
MUL
A 
B 
A/B
X42
DIVIDE
IO
VINFILT
VIN
VO2
IL2REF
VO2
IL2
VO2
ONESOUBD2
66
V10
62
V11
IL2REF
 
圖 4-39 升壓式轉流器 IsSpice 電路與系統模擬圖 
 - 132 -
解電路的工作原理與特性。第二為進行升壓式轉流器的負載測試，並紀錄各
負載下系統輸出的諧波與效率，以藉此來確認系統在各負載下皆能正常運
轉。第三為進行不同輸入電壓的運轉模擬與實測，藉以確認系統在不同的輸
入電壓下依舊能夠正常運轉。在電路實際量測時將先以電源供應器作為系統
的輸入電壓源，當系統運作正確後再進行第四部份的太陽光電能板進行實測。 
 
4.4.1 各點電壓與電流波形模擬與實測 
    圖 4-40 為系統運轉時功率晶體驅動信號與 CEV 波形的模擬與實測， 1Q 與
2Q 為同一轉換器內上下兩顆功率晶體，而 1CEV 與 1GEV 分別為 1Q 的集-射極電壓
與閘極驅動信號之波形，而 2CEV 與 2GEV 則為 2Q 之的集-射極電壓與閘極驅動信
號之波形。在系統運轉時，此兩顆功率晶體的驅動信號為互補之關係，即 1Q 導
通則 2Q 截止，而 1Q 截止則 2Q 導通，此關係是因兩組轉換器輸出電壓不同時，
電流將會流回電壓較低轉換器中，為提供此逆流電流一個路徑，因此在 2Q 截
止時將 1Q 導通，以提供電流逆流的路徑。 
    圖 4-41 是將功率晶體 CEV 的波形的量測時間加長為 5ms/DIV，由圖中可
觀察到 CEV 的波形是由切換弦波所組成，這是由於系統運轉時控制器會不斷的
調整 PWM 的工作週期，使輸出可得到弦波，而 CEV 的波形包絡，即為該轉換
器的輸出電壓之波形。 
    圖 4-42 為升壓式轉換器與轉流器的輸出電壓，在圖上方的兩個波形為轉
 - 134 -
現電流逆流之現象。 
1CEV
1GEV
2GEV
2CEV
     
1CEV
1GEV
2GEV
2CEV
 
(a)模擬波形                      (b)實測波形 
圖 4-40 功率晶體驅動信號與 CEV 波形 
 
1CEV
2CEV
     
1CEV
2CEV
 
(a)模擬波形                      (b)實測波形 
圖 4-41 功率晶體 CEV 與升壓式轉換器輸出電壓波形 
 
   
1OV
2OV
OV
     
1OV
2OV
OV
 
(a)模擬波形                      (b)實測波形 
圖 4-42 升壓式轉換器與轉流器輸出電壓波形 
 - 136 -
弦波。接下來使用一顆燈泡作為負載，系統輸出電壓與電流波形如圖 4-45(b)
所示，由圖中可看出系統於加載情形下輸出穩定，電壓有效值為 110IV，電流
有效值則為 0.78IA，經由計算可知燈泡上實際功率約 86.58IW。 
    圖 4-45(c)使用兩顆燈泡作為負載，圖中電壓於接近峰值時已有些許的變
形，電壓有效值為 110IV，電流峰值則增加至 1.56IA，經由計算可知燈泡的消
耗功率約為 171.6IW。在圖中可發現，電壓與電流間似乎有些許的相位差，這
可能是燈泡內或線路上有些許電感成分所造成的現象。將負載增加至三顆燈
泡，圖 4-45(d)中可觀察到電壓波形於接近峰值時的變形亦增加，此時電壓還
是能維持在 109IV，電流則增加至 2.33IA 左右，經由計算可知燈泡的消耗功
率約為 254IW。最後，將負載增加至四顆燈泡，其結果如圖 4-45(e)所示，由
圖中可以發現，電壓波形失真現象增加，但電壓依舊穩定的維持在 109IV，電
流則為 3.1IA，燈泡之消耗功率約 338IW。 
表 4-4 為輸出電壓波形的諧波失真量測結果，當空載時僅 1.08I%。然而
隨著負載加諧波失真也跟著增加，當加載 85IW 時總諧波失真已增加至
3.57I%；當負載再加至 170IW 時，諧波失真已達 4.13I%；255IW 時諧波失真
達 5.26I%；最後，當負載增加至 340IW 時諧波失真達到近 7I%左右。造成諧
波失真增加的原因可能是查表次數較少所致，因此系統無法快速的反應並改
變 PWM 之輸出，致使輸出弦波產生變形。 
 - 138 -
             
OV
OI
 
圖 4-45(c)負載 170IW 時輸出電壓與電流波形 
 
 
 
 
             
OV
OI
 
圖 4-45(d)輸出 255IW 之輸出電壓與電流波形 
 - 140 -
表 4-5 系統轉換效率量測結果 
 
85IW 170IW 255IW 340IW 
輸入電流平均值(A) 1.84 3.41 5 6.71 
輸入功率(W) 110.4 204.6 300 402.6 
輸出電壓有效值(V) 111 110 109 109 
輸出電流有效值(A) 0.78 1.56 2.33 3.1 
實際輸出功率(W) 86.58 171.6 254 338 
轉換效率 0.78 0.84 0.85 0.84 
 
 
0
0.2
0.4
0.6
0.8
1
0W 85W 170W 255W 340W
輸出功率(W)
轉
換
效
率
(P
ou
t/
Pi
n)
 
圖 4-46 輸出效率量測結果 
  負載 項目 
 - 142 -
   
OV
OI
INV
II
      
OV
OI
INV
II
 
(a)輸入電壓 55IV                     (b)輸入電壓 65IV 
OV
OI
INV
II
 
(c)輸入電壓 55IV 
圖 4-47 輸入電壓 75IV、輸出 85IW 之輸出電壓與電流波形 
 
4.4.4 獨立型太陽光電能系統供電實測 
    為驗證升壓式轉流器確實能應用於太陽光電能系統中，在此將使用太陽
光電能板做為本電路的輸入電壓來源。此實測中除將使用太陽光電能板供電
外，為減少太陽光電能板的電流漣波，在此實測中使用了 LC 倍頻濾波器以穩
定太陽光電能板的輸出電壓與電流，負載則使用一顆 115IV/100IW 之燈泡來
做測試，並量測系統的電壓與電流波形。最後使用本電路來推動一台約 50IW
的家用電風扇，並量測其輸出電壓與電流之波形。太陽光電能板進行量測時
之開路電壓約為 75IV。 
 - 144 -
      
(a)太陽光電能板實體圖                   (b)電路實體圖 
圖 4-49 太陽光電能板實體圖與升壓式轉流器電路之實體圖 
 
  我們將前述之系統以並聯方式連接，使其能提供更大之負載使用。同樣
地，我們將分別測量此並聯系統於加載情形下的輸出電壓與電流波形。負載
使用額定 110IV、900IW 之熱風扇。圖 4-50 為並聯系統輸出空載時的電壓模
擬與實測波形，由於並聯系統輸出並無任何負載，因此電流為零，電壓有效
值量測結果為 111IV 之交流正弦波。 
    接下來使用一台熱風扇作為負載，系統輸出電壓與電流波形如圖 4-51 所
示，由圖中可看出系統於加載情形下輸出穩定，電壓有效值為 110.8IV，電流
有效值則為 8IA，經由計算可知熱風扇上實際功率約 886.4IW。 
    圖 4-52 使用兩台熱風扇作為負載，電壓有效值為 110.5IV，電流峰值則
增加至 16IA，經由計算可知燈泡的消耗功率約為 1768 W。在圖中可發現，電
壓與電流間似乎有些許的相位差，這可能是熱風扇內或線路上有些許電感成
 - 146 -
 
圖 4-51 負載 900IW 之輸出電壓與電流波形 
 
 
 
 
 
圖 4-52 負載 1.8 kW 之輸出電壓與電流波形 
 
 
)/5( Divms
)/100( DivVVo
)/50( DivAIo
)/100( DivVVo
)/20( DivAIo
)/5( Divms
 - 148 -
侖計法與本文之改良式之庫侖計法做比較，驗證本文之殘量偵測模組應用於
不定電流放電的可行性與準確性。 
  第三個實驗使用緊急照明燈進行放電實驗，將一個完全充滿電之電池使
用緊急照明燈進行放電，並於放電過程中擷取放電資料，最後將資料以一般
庫侖計法與本文之改良式庫侖計法做比較，驗證本文之殘量偵測模組應用於
緊急照明燈之實用性。 
 
4.5.2 殘量預估模組定電流放電實驗 
  圖 4-54 為 HP 萬用電表所擷取之電池定電流放電歷程圖，本實驗使用定
電流負載對電池進行放電，電池放電截止電壓為 9.6 伏特，放電時間約為 89
分鐘，放電平均電流為 2.223 安培。圖 4-55 為本文之殘量預估模組所擷取之
電池定電流放電歷程圖，放電平均電流為 2.219 安培，與 HP 萬用電表量測之
值平均少 4 毫安培，誤差約為 0.18%，因此可以發現在定電流放電時，電流
值之誤差極小，可以忽略不計。 
  圖 4-56 是電池定電流放電時，以庫侖計法配合開路電壓法之殘量預估結
果，放電初期以開路電壓法作預估，由於電池處於浮充狀態，所以預估容量
為 100%，開始放電後，則由庫侖計法進行殘量之預估，從圖中可以發現當放
電到達截止電壓時，殘量預估之結果約為 27%，因此可以得知單純只使用庫
侖計法作為殘量預估之方法時，誤差將會非常明顯，因此本文使用庫侖計法
 - 150 -
9
10
11
12
13
14
0 1000 2000 3000 4000 5000
Time (sec)
V
ol
ta
ge
 (V
)
0
20
40
60
80
100
R
es
id
ua
l C
ap
ac
ity
 (%
)
 
圖 4-56 電池定電流放電以庫侖計法殘量預估結果 
 
 
9
10
11
12
13
14
0 1000 2000 3000 4000 5000
Time (sec)
V
ol
ta
ge
 (V
)
0
20
40
60
80
100
R
es
id
ua
l C
ap
ac
ity
 (%
)
 
圖 4-57 電池定電流放電以改良式庫侖計法殘量預估結果 
 
 
 - 152 -
9
10
11
12
13
14
0 1000 2000 3000 4000 5000 6000 7000
Time (sec)
V
ol
ta
ge
 (V
)
0
1
2
3
4
5
C
ur
re
nt
 (A
)
 
圖 4-58 電池不定電流放電歷程圖（HP 萬用電表） 
 
 
9
10
11
12
13
14
0 1000 2000 3000 4000 5000 6000 7000
Time (sec)
V
ol
ta
ge
 (V
)
0
1
2
3
4
5
C
ur
re
nt
 (A
)
 
圖 4-59 電池不定電流放電歷程圖（殘量預估模組） 
 
 
 - 154 -
4.5.4 緊急照明燈放電實驗 
  將本文設計之殘量預估模組外掛於一般市面上常見之緊急照明燈進行放
電程序，圖 4-62 為緊急照明燈放電歷程圖，其中使用之電池為 12V/4.5Ah 的
鉛酸電池，電池放電電流介於 1.85A 至 1.51A 之間，電池放電截止電壓為
9.96V，放電時間為 138 分鐘。 
  依照停電自動照明燈放電過程所擷取之資料，以本文之改良式庫侖計法
進行殘量之估測，圖 4-63 為緊急照明燈放電以庫侖計法配合開路電壓法之殘
量預估結果，放電初期由於緊急照明燈之電池是處於浮充狀態，所以開路電
壓法估測之殘量為 100%，放電至截止電壓時，庫侖計法預估的殘量約為
15%。圖 4-64 為緊急照明燈放電以改良式庫侖計法配合開路電壓法之殘量預
估結果，從圖中得知當放電之截止電壓時，殘量預估模組預估之殘量約為
-4%，因此本文所設計之殘量預估模組在實際電路的使用上，也能夠達到相當
之準確度。 
 - 156 -
9
10
11
12
13
14
0 1000 2000 3000 4000 5000 6000 7000 8000
Time (sec)
V
ol
ta
ge
 (V
)
-20
0
20
40
60
80
100
R
es
id
ua
l C
ap
ac
ity
 (%
)
 
圖 4-64 緊急照明燈放電以改良式庫侖計法殘量預估結果 
 
 - 158 -
電率進行串聯電池組充電，當電池組充到設定電壓時，則啟動均充模式，而
均充電路由返馳式直流轉換器提供四組固定輸出電壓，高電量之電池其內部
電動勢較高因此獲得之充電電流較小；反之低電量電池可獲得較高之充電電
流，進行串聯電池組均充。經由實驗證明，使用均充電池組充電將不會發生
電池過充之現象，及電池組最高電壓與最低電壓差為 180mV 內，同時能有效
提高電池組充放電效率至 89.7%，而電池組溫升最高不超過 30℃因此可延長
電池組使用命，降低系統營運成本。 
 4、本計劃使用單級雙迴路架構結合升壓式轉流器研製一穩定並具備高轉
換效率及低總諧波失真之轉流器。應用微處理器為核心控制雙迴路升壓式轉
流器，經實驗證明，本轉流器可提供 110V/60Hz 與最大 340VA 之能量供給負
載，其總諧波失真最高為 6.92%，轉換效率為 85%。且可操作於輸入電壓為
55V 至 75V 範圍內，系統能可維持穩定輸出電壓、頻率。 
 最後在電池組之殘餘電量預估模組研製上，應用微處理器為控制核心，發
展一套具準確的殘餘電量估測方法，本計劃之殘量估測策略主要利用開路電
壓法、庫侖計法並配合加成效應電流之修正，經實驗結果證明在電池定電流、
不定電流與緊急停電照明燈之殘量估測上，其結果皆可準確地預測電池電
量，並建構一使用者介面，供使用者了解電池狀態，並在合理之範圍內使用
電池，以延長電池使用壽命。 
 - 160 -
參考文獻 
[1] 國科會工程處電力學門研究發展規劃書，12 月，民國 91 年。 
[2] 鄭培璿，高頻快速充電電路策略之研究，國立臺灣大學，博士論文，民
國 93 年。 
[3] 張弘昇，電池充電方法與殘量預估之研究，國立彰化師範大學，碩士論
文，民國 93 年。 
[4] 黃士航，串聯電池組之均勻充電研究，國立彰化師範大學，碩士論文，
民國 92 年。 
[5] 林書漢，降壓型切換式整流器應用在鋰電池串並聯均勻充電之研究，大
同大學，碩士論文，民國 92 年。 
[6] 王志民，電容切換式等量充電之研究，國立彰化師範大學，碩士論文，
民國 91 年。 
[7] 蔡易陞，串聯電池之平衡充電，國立中山大學，碩士論文，民國 90 年。 
[8] 黃俊盛，電動車用鉛酸電池快速充電策略之研究，國立彰化師範大學，
碩士論文，民國 90 年。 
[9] 杜茂河，電動車車上型等量充電控制充電器之研製，國立彰化師範大學，
碩士論文，民國 90 年。 
[10] 蔡志明，串並聯電池組均壓充電及放電管理之研究，大同大學，碩士論
 - 162 -
[21] 鄭福剛，智慧型電動機車充殘電管理與診斷，國立中山大學，碩士論文，
民國九十年。 
[22] 張文地，電動車電池殘量預估之研究，國立彰化師範大學，碩士論文，
民國九十年。 
[23] 張永昌，鉛酸電池殘量預測及壽命分析之研究，國立彰化師範大學，碩
士論文，民國九十二年。 
[24] M. Gonzalez, M. A. Perez, J. C. Campo, and F. J. Ferrero, “Accurate 
Detection Algorithm of Battery Full-Capacity Under Fast-Charge,” 
Proceedings of the Instrumentation and Measurement Technology Conference 
1998, Vol. 2, pp.755 – 759, May. 1998. 
[25] J. H. Aylor, et. al., “A Battery State-of-Charge Indicator for Electric 
Wheelchairs,” IEEE Transactions on Industrial Electronics, pp.398-409, 1992.  
[26] T. Yanagihara and A. Kawamura, “Residual capacity estimation of sealed 
lead-acid batteries for electric vehicles,” Power Conversion Conference, pp. 
943-946, 1997. 
[27] D. Heacock and D. Freeman, “Capacity monitoring in advanced battery 
chemistries,” The 10th Annual Battery Conference on Applications and 
Advances, pp.185-191, 1995. 
[28] M.J. Hlavac and D. Feder, “VRLA Battery Monitoring using Conductance 
Technology,” The 17th International Telecommunications Energy Conference, 
INTELE ’95, pp.284-291, 1995.  
[29] G. J. Markle, “AC impedance testing for valve regulated cells,” The 14th 
International Telecommunications Energy Conference, INTELEC’92, pp. 
 - 164 -
Conference, Vol.2, pp.826-832, Apr. 2002. 
[39] C. C. Hua and C. M. Shen, “Control of DC/DC Converters for Solar Energy 
System with Maximum Power Tracking,” The 23rd International Conference 
on Industrial Electronics, Vol.2, pp.827-832, Nov. 1997. 
[40] M. Frederick, et. al., “Design and Implementation of a Digitally Controlled 
Stand Alone Photovoltaic Power Supply,” Nordic Workshop on Power and 
Industrial Electronics, Vol.1, pp.1-5, Aug. 2002. 
[41] V. Salas, et. al., “The Control Strategies for Photovoltaic Regulators Applied 
to Stand-alone Systems,” The 28th IEEE Industrial Electronics Society 
Annual Conference, Vol. 2, pp.3274-3279, Nov. 2002.  
[42] E. Koutroulis, et. al., “Development of a Microcontroller-Based Photovoltaic 
Maximum Power Point Tracking Control System,” The IEEE Transactions on 
Power Electronics, Vol.16, pp.46-54, Jan. 2001.  
[43] N. Mohan, T. M. Undeland, and W. P. Robbings, Power Electronics, John 
Wiley & Sons Inc., New York, 1995. 
[44] 鄭培璿 著，電力電子分析與模擬，全華科技圖書公司，台北市，民國 94
年。 
[45] A. I. Pressman, Switching Power Supply Design, McGraw-Hill Inc., New 
York, 1999. 
[46] 梁適安 著，交換式電源供給器之理論與實務設計，全華圖書，台北市，
民國 88 年 10 月，頁 7~127。 
[47] 鄭振東 編譯，轉換式電源穩定器設計要訣，建興出版社，台北市，民國
92 年 4 月，頁 17~53。 
 - 166 -
計畫成果自評 
在為期三年之「太陽能充電與供電系統之研製」計劃執行中，承蒙國科會
經費補助，使本計畫得以順利完成。計畫除已依進度分年確實執行完成外，
在量化之研究成果方面，本計畫之研究成果三年累計發表論文 11 篇，另有 4
篇已投稿且將發表於 2006 年第五屆電力電子研討會與電力研討會中。在人才
培育方面，三年累計培育博士生一位，碩士生七位，成果相當豐碩。 
 
研究成果發表： 
[1] 劉景富、卓峰斌、陳財榮、吳宗庭、張弘昇，”太陽能光電系統特性探討
與研究”，第二十五屆電力工程研討會，pp.88-93，11 月，2004 年。 
[2] 張弘昇、陳財榮、李義隆、陳文資、陳世昌，”鉛酸電池殘量預估之研究”，
第二十五屆電力工程研討會，pp.1542-1547，11 月，2004 年。 
[3] 陳士椀、李義隆、陳財榮、陳德超、張家豪，”惡劣環境溫度對鉛酸電池
充放電效率影響之研究”，第二十五屆電力工程研討會，pp.1666-1670，
11 月，2004 年。 
[4] 劉景富、陳財榮、卓峰斌、蘇柏昭、黃柏穎，”太陽能光電系統電池組充
電器之研製”，第二十五屆電力工程研討會，pp.1683-1688，11 月，2004
年。 
 - 168 -
電力電子研討會，9 月，2006. 
[13] 張家豪、陳財榮，“太陽光電能系統電池組均充器之研製”， 將發表於第
五屆電力電子研討會，9 月，2006. 
[14] 林騰平、陳財榮，“太陽光電能系統升壓式轉流器之研製”， 將發表於第
五屆電力電子研討會，9 月，2006. 
[15] 林騰平、陳財榮，“微電腦應用於升壓式轉流器控制之研究”， 將發表於
第五屆電力電子研討會，9 月，2006. 
 
學生畢業論文： 
 
博士論文： 
[1] 陳德超（民 93）。鉛酸電池最佳化充電技術之研究。國立彰化師範大學
工業教育學系博士論文，未出版，彰化市。 
 
碩士論文： 
[1] 張弘昇（民 93）。電池充電方法與殘量預估之研究。國立彰化師範大學
電機工程學系碩士論文，未出版，彰化市。 
[2] 黃柏穎（民 93）。智慧型鉛酸電池殘量預估模組之研製。國立彰化師範
大學電機工程學系碩士論文，未出版，彰化市。 
[3] 劉景富（民 93）。太陽能光電系統電池組充電器之研製。國立彰化師範
