proposed a new source authentication scheme based on 
Merkle-tree to protect against attacks from malicious 
intruders. 
英文關鍵詞： Key Management, Intrusion Detection System, 
Heterogeneous Wireless Sensor Networks, Wireless 
Network Security 
 
 2
行政院國家科學委員會專題研究計畫成果報告 
具高回復能力之異質性無線感測網路金鑰管理 
及入侵防禦整合系統設計 
The Design of the Key Management and Intrusion Prevention Mechanisms with High 
Resilience Ability in Heterogeneous Wireless Sensor Networks 
計畫編號：NSC 99-2628-E-415-002 
執行期限：99 年 8 月 1 日至 100 年 10 月 31 日 
主持人：王智弘  wangch@mail.ncyu.edu.tw 國立嘉義大學資訊工程系 
計畫參與人員：  吳宗哲、陳昭權、范家毓、林芝佑 
國立嘉義大學資訊工程系 
 
一、 摘要 
近年來無線感測網路(WSNs)成為研究的
焦點，無論是軍事用途、環境偵測、居家照護
或是其他商務應用方面，都可以看到無線感測
網路的應用。在這樣的環境下，無線感測器屬
於無人控管的裝置，因此建構入侵偵測與金鑰
分配之機制均是重要的安全基本需求。而入侵
偵測的部分主要是可以用來預防攻擊者對於
網路路由的阻斷等之攻擊，並且利用偵測機制
找出破壞網路的攻擊者，可將它稱之為第一道
防線；而金鑰的加入可以對資料作保護，使得
資料的傳送兼具保密性及認證。因此，本計畫
的主要目的是提出 a.金鑰管理機制與 b. 入侵
偵測機制，以提供異質性無線感測網路環境安
全的綜合解決方案。在金鑰管理上，我們使用
多項式雜湊樹配合節點的佈署知識設計出一
個新的金鑰管理方法。我們所提出的方法只需
要較少的計算以及較少量的通訊成本但具有
較高的連結性與回復性。在入侵偵測機制上則
提出一個植基於 Merkle-tree 的來源認證機制
以防禦入侵者的攻擊。 
 
關鍵字：金鑰分配、入侵偵測系統、異質性無
線感測網路、無線網路安全 
 
Abstract 
Recently, wireless sensor networks (WSNs) 
become the focus of researches. We can find that 
the wireless sensor devices have been widely 
used in the military application, environment 
monitor, home-care application, and many other 
commercial applications. However, due to the 
unattended operation feature of the sensor 
network, it is necessary to consider the two basic 
security requirements of intrusion detection and 
key management. The intrusion detection system 
is mainly to prevent and detect the malicious 
attacks on the network routing, which can be the 
first line of defense, whereas using the key can 
provide the confidentiality and authentication of 
the transmitted data. Therefore, the main purpose 
of this project is to propose a) the key 
management mechanism and b) the intrusion 
detection system, to offer an integrative security 
solution in the heterogeneous WSNs. In the key 
management mechanism, we design a novel key 
management strategy based on the polynomial 
hash tree method by using deployment 
knowledge. Our proposed strategy has lower 
computation and communication overheads but 
higher connectivity and resilience. In the 
intrusion detection system, we proposed a new 
source authentication scheme based on 
Merkle-tree to protect against attacks from 
malicious intruders. 
 
Keywords: Key Management, Intrusion 
Detection System, Heterogeneous Wireless 
Sensor Networks, Wireless Network Security 
 
二、 計畫緣由與目的 
 
本計劃主要研究在（異質性）無線感測
網路中的金鑰管理系統 (Key Management 
System, KMS) 與 入 侵 偵 測 系 統 (Intrusion 
Detection System, IDS)兩種安全的保護機制。
以對於無線感測網路的安全機制有一個多方
面的深入探討。以下就本計畫研究的動機與目
的說明如下。 
 4
attack, PDoS) [8]，大致來說，路徑式阻斷服務
攻擊的目標為整個通信路徑，假如訊息沒有安
全機制，每一個感測節點會將錯誤訊息傳入下
一個節點。因此，攻擊者可以耗盡位於在路徑
中的感測器的能源。如圖 1 表示，當攻擊者開
始進行路徑式阻斷服務攻擊便使網路壅塞癱
瘓，每個中間節點傳遞錯誤資料，直到資料抵
達基地台為止。 
最近，Perrig 等人[24]提出寬鬆時間同步
協定 (loosely time synchronized protocol) 稱
為 TELSA 。它是使用安全路由資訊，資料
聚合器訊息等等。然而，攻擊者可以在下一時
段的金鑰尚未公布前便進行阻斷服務攻擊。原
因是中間節點無法直接驗證廣播的訊息，每一
個中間節點儲存這些訊息在它的暫存區裡，直
到匯集點在下一個時間點揭露金鑰，然後便能
驗證這些訊息是否有效。有幾篇論文提出多階 
TELSA 去減緩此問題。特別是 Liu等人 [18] 
所提出克服 TELSA 阻斷服務攻擊的方式。
Liu 等人方法的概念是分配 TELSA 參數(例
如：金鑰鏈委任，開始的時間， TELSA 間
隔時間等等) 經由一個 Merkle hash tree [21] 
的方式。每位接收者有預先分配樹根節點參
數，一但傳送者傳送參數樹的部分資料，則每
位接收者可以立即驗證是否這些資訊包含在
此參數樹內。 
此外，Luk 等人 [20]在 2006 年提出 
regular-predictable TESLA (RPT) 以 及
low-entropy authentication (LEA)。RPT 協定規
定每個訊息在規律且可預測的時間間隔中傳
送，傳送者建立單向金鑰鏈，在每個時間間隔
中分配一把金鑰。之後，他們提出 LEA 協定，
節點必需分配多把公鑰以驗證單次簽章 
(one-time signature)。換句話說，當傳送者傳送
一個訊息必需使用私鑰簽章。但每個節點必需
儲存 n 把公鑰(n 代表網路中傳送者數量)以驗
證感測節點的單次簽章，因此無線感測網路需
儲存大量的資料。雖然 Liu 和 Luk 提出方法可
以增加原始 TELSA 的效率，但在他們的協
定中依然無法排除非同步問題。 
另外， Krau 等人提出 STEF [14]的方法
以防止攻擊者進行路徑式阻斷服務攻擊。然
而，在他們的方法中，攻擊者依然可以放入錯
誤資料至網路中。另外，攻擊者也可以進行路
徑式阻斷服務攻擊來癱瘓整個網路。 
本計劃在無線感測網路的研究中著重在
如何防禦阻斷服務攻擊和路徑式阻斷服務攻
擊。目標為設計一個弱認證機制 (weak 
authentication)並且供資料的不可偽造性。換句
話說，攻擊者不能濫用已授權訊息或注入許多
的錯誤資料來浪費感測器的少量資源。我們也
可以解決先前方法裡時間不同步的問題。接收
者不必再等待匯集點來釋放暗門金鑰，傳送者
傳遞資料報告中便含有可驗證之金鑰鏈。為了
驗證是否協議是由可信任的節點產生，我們必
需在感測節點裡預先建立及儲存一些額外資
訊。當然這會有多的儲存及通訊成本。 
 
三、 結果與討論 
 
本節將簡要說明本計劃的研究成果概
況。在 3.1 節中首先提出一個適合於異質性
感測網路的金鑰管理機制。在 3.2 節中提出
一個基於 Merkle hash tree 的入侵防禦機制。 
 
3.1 適合於異質性感測網路的金鑰管理機制 
     
在本節中將討論如何在異質性感測網路
中建構一個具高回復性的金鑰分配及管理機
制。 
 
3.1.1 網路模型及金鑰分配策略 
 
   我們所提出的網路模型是延伸 Du et al. [9 
以及 Yu 和 Guan [30]的研究。在大規模的異
質性感測網路裡，配置的模型會被假設成以群
為基準，如同 [9] 所述而節點的分類會如 [19]
定義。我們假設每一個叢集(cluster)的主控者
(cluster head) 是能力強大地且不會被攻擊者
所入侵的。較高等級的節點有著較高層級的防
禦能力，因此攻擊者必須花更多的時間才能破
解。如此一來，攻擊者會較願意去嘗試攻擊較
低等級的節點。 
在我們的網路模型裡假設有 L+1 個層級
的節點在感測網路中，其中 1L  。第 k 個層
級表示著不同的能力的節點，其中0 k L  。
在配置前，會先將這些感測節點分成多個佈署
的群。每個群裡有著多數的較低等級的節點與
少量的高等級節點。在配置過後，這些節點會
 6
Liu 和 Ning [16]將隨機金鑰池改成多項式
池。所有的節點將部分的多項式作為其儲存之
金鑰環。在佈署後，每一對感測點會有很高的
機會去共享至少一組多項式並藉以建立他們
之間的通訊金鑰 (session key)。雖然這樣的方
法可以透過設定安全等級去提高安全的要
求，但相對地它所花費的記憶體空間會比隨機
金鑰池來的大。 
 
3.1.2 金鑰分配策略簡述 
以下是我們的設計概念。圖 3 顯示一個經
過佈署後的網路拓樸的例子，六邊形表示有最
高的感測能力的感測節點，這些節點將是叢集
的主控者。在圖 3 中，有兩個網路群和兩個叢
集主控者。三角形表示中等能力的感測節點
(I-node)，它們負責處理部分的金鑰分配和資
料收集。在這個網路中，I-node 或者 L-node (低
能力的節點) 會選擇最近的較高層級的感測
節點當作金鑰分布中心(KDC)，或者稱作父節
點。然後 I-node 或 L-node 會向 KDC 去拿它的
金鑰環。每一個 I-node 不能計算自己的金鑰
環，但是它必須為它的子節點計算金鑰環。因
此一個層級的秘密資訊被較高層級的感測節
點保護著。在這個例子中，C 節點將選擇 B 節
點當作它的 KDC，而且 B 節點將選擇 A 節點
當作它的 KDC。在這種情況下，A 節點(也稱
作 CHA)是網路群 NGA的叢集頭而且 B節點和
C 節點都屬於 NGA。 
 
 
圖 3：網路拓樸和 mPHT 概念 
 
系統採用 mPHT (請參考圖 3(b))。一個 m
元樹的深度明顯少於二元樹的深度，而且便於
表示和實作複雜的網路拓樸。mPHT 中的每一
個樹節點表示一個多項式且屬於某些網路群
的感測節點。 
圖 4 展示出 m-ary PHT 的細節。在佈署
之前，系統產生一個隨機整數當作樹根。這個
整數被分成(佈署群的數量 +1)個部分，而且
每一個部分是每一個佈署群的多項式的種子
(seed)。例如，節點 P(1,1)表示這個系統的根，
P(2,1)表示來自 P(1,1)的種子的一部分。在佈署
之後，P(2,1)將變成所有屬於佈署群 D1 的CHs
之多項式生成種子 (polynomial generation 
seed)。在這個例子中，有三個佈署群 (i.e., 
d=3)。首先，系統將樹根分成(d + 1)個部分。
額外的部分(+1)表示秘密資訊。秘密資訊只有
匯集點 (sink) 知道且沒有任一個 CH 知道。
樹根 P(1,1)是用來產生多項式的種子，這個多
項式是用來計算不同佈署群的 CHs 之間的成
對金鑰。甚至就算攻擊者破解所有佈署群的種
子仍然無法得到 P(1,1)的多項式。 
圖 4 中，白色的樹節點是被預先分配到
個別的佈署群 D1, D2,…, Dd 的 CHs。在白色樹
節點下面的灰色的樹節點，是在佈署之後被分
配及決定。系統將應用階層式的方法來收集足
夠的資訊以進行多項式種子的分配。 
 
2 3 1
1 1 1,1 1.1 1,1P( 1,1) H(...H(H(H(Child CH ) ) )... )
LL n n n      
1
1,1
Ln 
 
圖 4：m-ary 多項式雜湊樹 
 
所有的灰色樹節點產生，是用 XOR 運算
和一個預先定義的雜湊函數 H(.)函數來產
生，在我們的網路模型中，假設每一個節點在
佈署之後都有一個獨特的身分
,i j
kn ，表示此節
點在網路群集 NGi 中的第 k 階層中的第 j 個節
點。 
以下是建立 PHT 的步驟。 
(1) 系統產生一個長整數 {0,1}aS 當作
P(1,1)，而 a 是此長整數的位元長度。假
設 h 表示雜湊函數 H 的位元數，d 表示
佈署群的個數，則等式 ( 1)a d h   成
立。 
 8
6(b)包含著許多圓圈，每一個圓表示叢集主控
者的覆蓋範圍。在我們的網路拓樸裡，每個佈
署群裡有 5 的叢集主控者，因此共有 180 個叢
集主控者在網路當中。如圖 6(a)我們將所有的
叢集主控者的覆蓋範圍給填滿，可以發現覆蓋
率接近 1- 16/ (3600-180) ≈ 0.996，而連結率大
約為 99%。 
 
 
(a) 
 
 
(b) 
圖 6：覆蓋率 
 
(2) 回復能力 (Resilience Ability) 
 
回復力被定義為被控制連結與被控制節
點數目的比率。在無線感測網路裡，假設一旦
攻擊者攻破了一個節點，它可以取得此節點所
有的金鑰。在隨機金鑰池系統 [9, 11, 19, 30]， 
一個金鑰可能被使用不只一次，因為每個節點
取得的都是隨機金鑰。反之，在成對式金鑰系
統裡一把金鑰只能使用於一個連線。在我們的
機制裡，一個節點的金鑰數數目相當於其鄰近
節點的數目，因此回復能力可以被視為鄰近節
點的平均數目。 
 
圖 7：回復能力的比較 
 
圖 7 表示著我們的成對式金鑰系統的方
法與 EG 的隨機金鑰池[11]的方法比較。控制
連線的比例被定義如下等式： 
 
number of  effected edge
number of  linked edge
 
回復能力在我們的方法裡會是線性的，因
為一個成對金鑰只用於一條連線。但是在隨機
金鑰池系統裡，被攻破的連線數目會快速的成
長因為攻破一把金鑰便可能可以破解多個連
線。 
 
(3) 效能 (Efficiency) 
 
    在我們的方法裡，所有的節點必須維護它
們的金鑰環。此外，中繼節點必須去維護和延
伸多項式種子以建立一個多項式及共同多項
式，並產生多項式種子給其子節點。更進一
步，所有的感測節點在佈署之前必須必須儲存
一個主金鑰。 
對於通訊成本，中繼節點須長時間處於
hello 狀態因為他必須去等待較高或較低的感
測節點的訊息。再進一步，感測節點必須將所
收集的資訊傳送至金鑰分配中心。計算的花費
集中於中繼節點與叢集主控者上，因為他們在
佈署之後必須分配金鑰環和多項式種子給較
低等級的節點。 
 
3.2 基於Merkle hash tree 的入侵防禦機制 
 
    本節將說明如何在無線感測網路上建構
一個有效率的入侵防禦機制，並能夠抵抗
PDoS 攻擊。 
 
3.2.1 符號說明與基本假設 
 10
個子節點，如圖 8 顯示一個認證樹有八個節
點，其中， 01 1 1( || )T H W K 、 12 1 2( || )T H T T 、
14 12 34( || )T H T T 等。 
此外，中央伺服器選擇一個隨機的數值
i (1 ≤ i ≤ n)，其中隨機亂數 i R  {0,1}
t 且 t 
是一個大整數。隨機亂數是用來計算工作金鑰
Wi。因此，工作金鑰包含了一個隨機數值 i ，
秘密金鑰 miK ，和用以撤回被破解節點的
iRK 。最後，匯集點必須先配置秘密金鑰
m
iK ，金鑰鏈
m
iKC ，以及驗證樹的根值給所
有的感測節點並且儲存這些資料在它自己的
儲存空間裡。 
 
(2) 建立階段(Establishment Phase) 
 
為了在感測節點之間產生一個安全的通道,
匯集點隨機選擇一個可信任的節點並根據認
證樹的資訊將認證的憑證傳送給它。每個 Si
的憑證包含了在認證樹中從第 i 個子節點到樹
根的路徑。舉例來說:在圖 8 中的第 2 個節點
的憑證為 02 2 2 1 3,4 5,8{ , , , , }Cert W K T T T 。對於
每個感應節點 Si，匯集點選擇對應的憑證並經
由群播的方式傳送至感應網路中。一旦中間的
節點接收到了憑證，他可以立刻利用認證樹先
前分配的根值來驗證憑證。舉例而言:假設使
用了 02 2 2 1 3,4 5,8{ , , , , }Cert W K T T T ,接收端可以
驗 證 02 2 1 3,4 5,8( ( ( ( || ) || ) || ) || )H H H H W K T T T 是
否與根節點 T1,8的數值相等來做認證的動作。
假如是相等的，則節點會儲存工作金鑰 W2 和
委任值 02K 以便將來驗證訊息。假若任一方驗
證失敗,則訊息會被中止。直到最後，目標節
點會接收到訊息並進行確認，若正確無誤則將
感測報告回傳給匯集點。 
 
(3) 資料傳送階段(Data Forwarding Phase) 
 
完成建立階段之後，當有節點接收到認證
時，它會開始使用金鑰鏈 KCi 來產生感測報告
的驗證值。 
當節點 Si 想傳送訊息時,假若這是其第一
次傳送感測報告，它會公開金鑰鏈的第二個數
值到網路上,並且沿著上游的路徑傳送報告
1 1{ , , ( || || )}i i iR M K H M K W 。如同圖 9 所示，
Si 會傳送報告內容包含了感測資料,金鑰鏈內
的第二個數值 ,工作金鑰和一個 MAC 的數
值。當中間節點接受到報告,他會先驗證 0iK = 
1( )iH K 的等式，當驗證式通過,中間節點會利用
1( || || )i iH M K W 來確認資料正確並且傳送這些
訊息到匯集點。若 Si 第二次以上傳送感測訊
息，此時中間節點已擁有 KCi 中的某些金鑰。
因此，Si 必須選擇一個尚未公開的金鑰來產生
資料報告的驗證值。 
 
 
 
圖 9: 感測資料由 Si 傳至匯集點 
 
(4) 撤銷階段(Revocation Phase) 
 
    感測網路提供許多在安全上需特別重視
的一些應用，例如軍事監控。但感測網路卻經
常被使用在無法被看顧(unattended operation)
的工作上。所以感測節點和廣播的訊息可能遭
攻擊者危害或是攔截。我們可以使用廣播認證
機制來抵抗惡意訊息，但攻擊者對於感測節點
裝置的實體攻擊卻很難以避免。因此，我們必
須得能夠對被危害的節點的做權力撤銷，並且
其他正常的節點也要能刪除其所儲存的被危
害節點的相關資訊。偵測遭危及或被攻擊的節
點的過程和技術可以參閱[2, 15, 31]。偵測遭危
及的節點確實是困難但在某些情境中仍然是
可實行的。 
    當一個節點被偵測為已遭危害時，匯集
點會廣播一個撤銷憑證，內容包含了此節點的
秘密資訊。另外，在起始階段，匯集點會利用
隨機亂數 i ,秘密金鑰Ki和節點身分 Si,來計算
工作金鑰，如同圖 10 所示。當匯集點要撤銷
某節點時，他只需要廣播 Si 的撤銷憑證 
RevoCert 到網路上即可。其中包含了撤銷金鑰
RKi 和身分 Si。假設中間節點接收到撤銷憑證,
他會計算並將 Si 的工作金鑰加入他的撤銷名
單中，然後中間節點會停止接收和傳送從此節
點所發出的訊息。在此，任何攻擊者皆不能偽
造撤銷憑證，因為只有匯集點保存了撤銷金
鑰，也因此保證了撤銷金鑰不會對其他正常的
 12
for Multi-level Heterogeneous Sensor 
Networks. The 2011 International 
Conference on Information Security 
(CSCIS 2011), pages 148-156, Hangzhou, 
China, April 13-15, 2011. 
3. C. H. Wang and T. C. Wei. The Design of 
the En-route Filtering Mechanism with 
Immediately Lightweight Authentication 
for Wireless Sensor Networks. 2010 
International Computer Symposium (ICS 
2010), Tainan, Taiwan, Dec. 16-18, 2010. 
 
參考文獻 
 
[1] I. F. Akyildiz, W. Su, Y. 
Sankarasubramaniam and E. Cayirci, 
“Wireless Sensor Networks: a Survey,” 
Computer Networks, Vol. 38, pp.393-422, 
2002. 
[2] V. Bhuse, and A. Gupta, “Anomaly 
Intrusion Detection in Wireless Sensor 
Networks,” IEEE Wireless Communications, 
vol. 15, pp. 34-40. 
[3] C. Blundo, A. D. Santis, A. Herzberg, S. 
Kutten, U. Vaccaro, and M. Yung, 
“Perfectly-Secure Key Distribution for 
Dynamic Conferences,” Advances in 
Cryptology - CRYPTO ’92, LNCS 740, pp. 
471–486, 1993. 
[4] H. Chan, V. D. Gligor, A. Perrig, and G. 
Muralidharan, “On the Distribution and 
Revocation of Cryptographic Keys in 
Sensor Networks,” IEEE Transactions on 
Dependable and Secure Computing, Vol. 2, 
pp. 233–247, Jul. 2005. 
[5] H. Chen, A. Perrig, and D. Song, “Random 
Key Predistribution Scheme for Sensor 
Networks,” Proc. of IEEE Symposium 
Security and Privacy (S&P’ 03), pp. 
197-213, 2003. 
[6] H. Chan, A. Perrig, and D. Song, “Key 
Distribution Techniques for Sensor 
Networks,” Wireless Sensor Networks, pp. 
277–303, 2004. 
[7] D. Coppersmith and M. Jakobsson. “Almost 
Optimal Hash Sequence Traversal.” Lecture 
Notes in Computer Science on Financial 
Cryptography, vol. 2357/2003, pp. 102-119. 
[8] J. Deng, R. Han, and S. Mishra, “Defending 
Against Path-based DoS Attacks in Wireless 
Sensor Networks,” 3rd ACM workshop on 
Security of ad hoc and sensor networks, 
2005. pp. 89-96. 
[9] W. Du, J. Deng, Y. S. Han, and P. K. 
Varshney, “A Key Predistribution Scheme 
for Sensor Networks using Deployment 
Knowledge,” IEEE Transactions on 
Dependable and Secure Computing, Vol.3, 
No.1, pp.62-77, Mar. 2006. 
[10] M. Enzmann, C. Krauß and C. Eckert, 
“PDoS-Resilient Push Protocols for Sensor 
Networks,” Third International Conference 
on Sensor Technologies and Applications, 
June 2009, pp. 455-461. 
[11] L. Eschenauer and V. Gligor, “A Key 
Management Scheme for Distributed Sensor 
Networks,” Proc. ACM Conf. Computer and 
Comm. Security (CCS’02), pp. 41-47, Nov. 
2002. 
[12] D. Huang, M. Mehta, A. van de Liefvoort, 
and D. Medhi, “Modeling Pairwise Key 
Establishment for Random Key 
Predistribution in Large-Scale Sensor 
Networks,” IEEE/ACM Transactions On 
Networking, Vol. 15, No. 5, pp.1204-1215, 
Oct. 2007. 
[13] F. Kausar, S. Hussian, L. T. Yang, A. 
Masood, “Scalable and Efficient Key 
Management for Heterogeneous Sensor 
Networks,” The Journal of Supercomputing, 
Springer, Vol. 45, No. 1, pp. 44-65, 2008. 
[14] C. Krauß, M. Schneider, K. Bayarou, and C. 
Eckert, “STEF: A Secure Ticket-Based 
En-route Filtering Scheme for Wireless 
Sensor Networks,” The Second 
International Conference on Availability, 
Reliability and Security, April 2007, pp. 
310 – 317. 
[15] T. Li, M. Song, and M. Alam, 
“Compromised Sensor Nodes Detection: A 
Quantitative Approach,” 28th International 
Conference on Distributed Computing 
Systems Workshops, 2008, pp. 352-357. 
[16] D. Liu and P. Ning, “Establishing Pairwise 
Keys in Distributed Sensor Networks,” 
Proc. of 10th ACM Conference on 
Computer and Communications Security 
(CCS’03), pp. 52–61, Oct. 2003. 
[17] D. Liu and P. Ning, “Location-Based 
Pairwise Key Establishments for Static 
1 
 
行政院國家科學委員會補助學者出席國際學術會議報告 
（請於出席會議後填寫）                                      填表日期：100 年 4月 30日 
報告人姓名 王智弘 服務單位 國立嘉義大學 
資訊工程系 
計畫名稱 具高回復能力之異質性無線感測網路金鑰管理及入侵防禦整合
系統設計（NSC 99-2628-E-415-002） 
會議時間  2011/4/13 – 15 地    點 杭州 
會議名稱 
中文：2011 年資訊安全國際研討會 
英文：The 2011 International Conference on Information Security 
(CSCIS 2011) 
發表論文題目 
中文： 以多項式雜湊樹為基礎之多層級異質性無線感測網路金
鑰分配策略 
英文：Polynomial Hash Tree Based Key Distribution Strategy for 
Multi-level Heterogeneous Sensor Networks 
 
一、參加會議經過 
  
本次會議由上海交通大學、杭州師範學院、台灣科技大學資訊安全中心及高雄
師範大學等學校共同舉辦，旨在促進資訊安全研究的發展以及海峽兩岸學術教交流。
在密碼技術方面的研究，兩岸的學者希望能夠建構一個共同交流開放的平台，進而促
進整個亞洲國家包含日本、韓國等之密碼及資訊安全應用等一個可以心得分享、共同
研究的合作架構。 
 
本次會議時間在 100 年 4 月 13-15 日，舉辦地點為浙江杭州的西子賓館，參
與的學者超過 60 人。會議舉行共三天，共發表約 34 篇論文。研討的主軸為密碼技
術與資訊安全應用。會議主要以交流為目的，因此與會均以教師為主，在發表會議的
過程當中也有許多的討論與合作洽談，場面十分熱絡。 
 
以下為會議的簡單流程描述： 
2011-4-12 註冊 
2011-4-13   
  8:45- 9:00    開幕 
  9:00- 16:10   學術交流(I)(II)(III)(IV) 
  18:30 – 20:30 歡迎晚宴 
2011-4-14 
  8:30-11:55    學術交流(V)(VI) 
  14:00 17:30   靈隱寺遊覽 
2011-4-15 
  9:00 – 14:55  學術交流(VII)(VIII)(IX)(X) 
 
3 
 
 
二、與會心得 
 
本次會議在密碼學與資訊安全上面可說是討論十分熱烈與精采的會議。議題中包
含許多學理以及深入的數學基礎，也包含高層的應用如雲端技術、RFID 及無線感測
網路等。因此，各方的專家學者能夠齊聚一堂，在自己熟悉與不甚熟悉的領域中皆
能夠參與研討，能夠學習更為多元的知識領域。 
 
    會議中所探討的領域大致可分成密碼數學基礎、密碼應用以及資訊安全應用三大
類。密碼數學基礎的部份包括二元函數、多變量密碼、數論等，而密碼應用的論文包
括積分攻擊法、可證明安全、格公開密碼技術等。在資訊安全應用方面則包含無線網
路安全、RFID 安全、影像安全以及其他安全協議等。 
 
    在密碼數學基礎方面最受矚目的便是多變量密碼技術  (Multivariable 
Cryptography)，由於目前大陸學者在這方面的研究相當多元且持續，因此許多延續性
的結果在會議中發表，也簡介的多項新研發成果，令人耳目一新。而在密碼應用方面，
可證明安全技術 （Provable Secure Cryptosystem） 仍是認為重要的，雖然會中上海
交通大學陳克非教授提及以工程的角度來詮釋安全，然而仍是一個嘗試的階段，也有
許多值得再討論之處。此外，杭州師範大學謝琪教授提到無證書技術 (Certificateless)
的安全等級問題，引發許多學者的討論。由政治大學左瑞麟教授與韓國 Cheonshik 
Kim 教授、澳洲 Xun Yi 教授所合作之無證書 Recovery Signature 議題，接續討論，
使得與會學者對這類題目更加的了解。最後在資訊安全應用系統方面，台灣的學者有
許多很精采的應用方面的成果，包括網路競標、量子密碼技術、雲端安全管理等，的
確感受到研究方向的多元性。 
 
    在整個會議有兩個特殊的研討議題，一個是來自大陸道理雲公司毛博士所介紹的
可信雲存儲，讓整個大會除了學術研討之外，也加入了產業界的資訊，令人印象深刻。
另外在大會最後一個研討議題由上海交通大學來學嘉博士所提出對密碼學的一些進
展，將一些未來發展的趨勢作了相當多的預測與評估，讓與會學者均感收穫良多。整
體而言，由於參與會議的學者專家領域接近，因此交流非常熱烈，許多相同或相似議
題的研討帶給與會人士許多的啟發，實不虛此行。 
 
  會議在 14 日下午參訪杭州著名的靈隱寺，此為大陸重要的佛教景點與古蹟，也可
藉由參觀了解許多的文化背景，在繁忙的會議研討之餘也能了解藝術文化的資訊，實
屬難得。此外，在 15 日空餘時間，參訪了杭州師範大學的各項設施，包括了解校史，
參觀設備以及初等教育學院，讓與會人士了解大陸在大學教育的情形，相關的建設及
制度可作為台灣教育發展的參考。最後在離開前遊覽了著名的錢塘江，風景宜人，也
令人心曠神怡。在晚間 7:00 左右搭機返台。 
 
5 
 
 
 
 
附件： 
 
附件一  會議議程表 
附件二  發表之論文 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
16:10-17:50 學 術 交 流 IV（ 主 持 ： 官 大 智 教 授 ， 中 山 大 學 /高 雄 ）
Certificateless Message Recovery Signatures Providing Girault’s Level-3 Security （左瑞麟教
授，政治大學）
CSREP可能等價于CDHP（張方國教授，中山大學/廣州）
可逆式JPEG資料隱藏技術（郭文中教授，虎尾科技大學）
Scale-up Web Security Analysis by Incremental Computation (Xin Li, JAIST, Japan)
序列的頻譜攻擊及安全協定的工程分析（陳克非教授，上海交通大學）
18:30-20:30 歡 迎 晚 宴 （ 知 味 觀 ）
週 四 （ 2011-4-14） ， 西 子 賓 館 飛 雲 廳
8:30-09:45 學 術 交 流 V（ 主 持 ： 雷 欽 隆 教 授 ， 臺 灣 大 學 ）
Cryptographic Properties of Boolean Functions （馮克勤教授，清華大學）
An estimation of information leakage in transmission of secret message using quantum bits （官大
智教授，中山大學/高雄）
Algebraic attack on post-quantum public key cryptosystems （胡磊教授，中科院研究生院）
09:45-10:15 茶 歇
10:15-11:55 學 術 交 流 VI（ 主 持 ： 林 東 岱 研 究 員 ， 中 科 院 軟 體 所 ）
可信雲存儲（毛文波博士，道裡雲公司）
A Secure and Efficient Delegation-based Authentication Scheme in Public Clouds（莊文勝教
授，高雄第一科技大學）
結合無硬碟Honeypot與入侵防禦系統之研究（葉禾田教授，南台科技大學）
格公開金鑰密碼的正態抽樣（胡予濮教授，西安電子科技大學）
12:00-13:30午 餐 （ 自 助 餐 廳 ）
14:00-17:30 遊 覽 （ 靈 隱 寺 ）
18:00-20:00 晚 餐 （ 農 家 樂 ）
週 五 （ 2011-4-15） ， 杭 州 師 範 大 學 圖 書 館 十 樓 報 告 廳
09:00-10:15 學 術 交 流 VII（ 主 持 ： 楊 竹 星 教 授 ， 成 功 大 學 ）
Study of Pitfalls of Enhanced Yoking/Grouping Proof Protocols（簡宏宇教授，暨南國際大
學）
Chosen Ciphertext Secure Encryption under  Factoring Assumption Revisited（李寶教授，中科
院研究生院）
基於CDMA的RFID雙向認證協議 (伍麗樵教授, 雲林科技大學)   
　
註 ： 建 議 每 個 報 告 的 時 間 不 要 超 過25分 鐘 ， 儘 量 多 留 一 點 時 間 大 家 交 流 。
議程 CSCIS 2011 Program http://crypto.nknu.edu.tw/2011/program.html
2／2
  
2     
 
used a post-distribution method with higher commu-
nication overheads in negotiation among sensor nodes 
for intergroup keys. Unfortunately, the power con-
sumption of communication is much larger than 
computation. The power consumption of the commu-
nication for high ability nodes is not a big problem; 
however, it may over exhaust the battery in the low 
ability nodes. In addition, most of these studies only 
considered the application for two-level heterogene-
ous sensor networks instead of multi-level ones. 
However, the multi-level mixed sensor networks can 
enhance the trade-off between cost and network abil-
ity; thus a multi-level key management strategy is 
much worthy of being considered. 
In this paper, we focus on designing a key man-
agement system for multi-level HSNs. We use the 
deployment knowledge [6, 11, 17] and m-ary Poly-
nomial Hash Tree (mPHT) to develop an efficient and 
secure scheme. The experiment shows that our 
scheme has higher connectivity and resilience but 
lower communication and computation overhead. The 
proposed mechanism ensures that each pair of nodes 
can share a pairwise key with lower computational 
and communicational costs. Furthermore, the amount 
of memory usages in both higher-level nodes and the 
lower-level nodes can be reduced. 
2   Preliminary 
2.1   Network Model 
The network model proposed in this section is 
extended from the studies of Du et al. [6] and Yu and 
Guan [17]. In large-scale heterogeneous sensor net-
works, deployment model is assumed to be 
group-based as described in [6] and the nodes classi-
fication is defined as [12]. It is assume that all the 
cluster heads are so powerful that the adversary can-
not compromise them. The higher nodes have a high-
er-level protection so that the attacker must spend 
much time to perform cracking. Therefore, compro-
mising a lower-level sensor node is more preferred for 
the attacker. 
Our network model is assumed that there are L 
+1 classes of nodes in this sensor network, where 
1L . The class k, where Lk 0 , represents the 
different abilities of sensor nodes. Before deployment, 
these sensor nodes are divided into several deploy-
ment groups. Each group contains large amounts of 
lower class nodes and a few higher nodes. After de-
ployment, these nodes will be located in their resident 
points and keep static. In addition, the distribution 
model always follows a probability density function 
(pdf) of 2-dimention Gaussian distribution. The high-
est ability sensor node is called a cluster head (CH) 
which can broadcast the hello message. Assuming that 
all the different ability sensor nodes can find their 
cluster heads, the network group will be created after 
bootstrapping phase. The data routing structure after 
deployment is based on the p2p model, but the key 
management system is hierarchical. The assumptions 
of the multi-level HSN are summarized as follow: 
1) There are totally 

N
k
k  0
L
 nodes arranged into |D| 
deployment groups, where k is the level of sen-
sor nodes, and 

N
k
 is the number of the nodes of 
level k. The lower index represents a higher abil-
ity node, and vice versa. The level 0 represents 
the sink of this network, and the level L is the 
lowest sensor nodes. 
2) For each level of sensor nodes,

1  k  L , the abil-
ity is 
Lk
AAAA  
21
, and the 
number of nodes is 
Lk
NNNN  
21
, which means this 
system is allocated a large amount of lower 
nodes and a few higher nodes. 
3) The deployment groups can be arranged as a grid 
or hexagonal distribution. In this paper we focus 
on the grid arrangement. And the distance be-
tween the deployment point and cell’s border is 
2σ. 
4) The resident point means the final location of the 
deployed node. The node n in the deployment 
group Di follows a pdf )|,( iDnyxpdf  of 
two-dimensional Gaussian distribution: 
]2/)()[(
2
222
2
1
y)(x, k
yiyxix
k
epdf




,
 
  
4     
 
tected by the higher-level sensor node. In this example, 
node C will select B as its KDC, and B will select node 
A as its KDC. However, both B and C are in the net-
work group of the CH A. 
 
Figure 2: Network topology and mPHT concept 
The proposed system employs the m-ary poly-
nomial hash tree (mPHT) (see Figure 2(b)). An m-ary 
tree is obviously less deep than the binary tree and 
convenient to represent and implement the complex 
network topology. Each tree node of the mPHT repre-
sents a polynomial belonging to a sensor node of a 
certain group.  
The detail of m-ary PHT is shown in Figure 3. 
Before deployment, the system generates a random 
integer as the root of the tree. This integer is divided 
into (the number of deployment groups +1) parts, and 
each part is the polynomial seed for each deployment 
group. For example, the node P(1,1) represents a root 
seed of this system, and P(2,1) represents a part of 
seed from P(1,1). After deployment, P(2,1) will be the 
polynomial generation seed for every CH that in the 
deployment group D1. In this example, there are 3 
D-groups (deployment groups) in the network. To 
deploy the seeds to them, the system divides the orig-
inal seed into (|D-groups| + 1) parts. The extra part 
(+1) represents secret information that only the sink 
knows so that any CH knows nothing about the origi-
nal seed. The root P(1,1) is the polynomial for calcu-
lating the pairwise keys between CHs within different 
deployment groups. Even an attacker compromises all 
seeds of the deployment groups, he/she still cannot 
get the polynomial of P(1,1).  
The white nodes D1, D2,…, Dn in Figure 3 are 
assigned to the CHs of each deployment group, and 
they will be pre-distributed the necessary seeds before 
deployment. The gray nodes, below these white 
nodes, are distributed and determined after deploy-
ment. The system will apply a hierarchical scheme for 
collecting enough information to perform polynomial 
seed distribution. 
 
Figure 3: M-ary polynomial hash tree 
All of the gray nodes are generated by an XOR 
operation and a predefined H(.) function. In our net-
work model, each node has one unique identity as 
ji
l
ln
nnnnIDC
ji
n
ji
,21
,
,
),,,(  . The number of fields l of 
node’s ID can show what the class this node belongs 
to, and the last field nl represents this node’s unique 
identity. 
The steps of building PHT are described as fol-
lows. 
1) The system generates a long inte-
ger kP }1,0{  
as P(1,1), where k is the number of bits. 
Let |H| denote the number of bits of the hash function 
and |D| denote the number of deployment groups. k 
must satisfy the equation of |H|)1|D(| k . 
2) For the nodes of P(2, *), the system divides 
P into (Child1,Child2,…,Child|D|, Child|D| + 1), and 
all parts of P except for the last part are distributed to 
the P(2, *) nodes. 
3) For the node under the P(2,*): 
) node  theof ID nodeparent  its(H),( jiP . 
For example, after deployment, CH1 will be as-
signed the node P(3,1), which is generated 
by )CH node of ID Child(H
11
 . The node of this PHT 
represents a polynomial seed, which can be used to 
build a polynomial by calculating 
  
6     
 
And the neighbor list contains each 
ID collection of each neighbor. 
3) Each intermediate node 
||1  where,
,
Lln
l
ji
  carries out the fol-
lowing steps: 
For l = |L| to 2: 
i. Updates its master key  Km = H( KI, 
ri,1). 
ii. Each node ||1  where,
,
Lln
l
ji
 , trans-
mits its id, NeighborList, and ID 
Collection together with the MAC to 
its KDC. 
iii. Finally KDCs collect these neighbor 
lists and some important information 
to CHs. Thus each CH can collect the 
entire information about inner nodes, 
neighbors, and neighboring groups 
for its belonging network group. 
4) Now each CH offers services for all the 
nodes ||1  where,
,
Lln
l
ji
 , who select it as 
their KDC. The KDC of l
ji
n
,
performs the 
following steps. 
i. Maintain a resource requirement table 
for l
ji
n
,
. By using mPHT establish-
ment procedure, CH can find the 
polynomial seeds and deploy them to 
l
ji
n
,
. 
ii. Use the polynomial of l
ji
neighbor
,
’s 
KDC (may use the co-polynomial as 
described in Section 3.1) to generate 
pairwise keys between l
ji
neighbor
,
 
and node l
ji
n
,
 , and adds it to l
ji
n
,
’s 
key ring l
ji
n
C
,
. 
5) Distribute the polynomial seeds to its all 
lower nodes or calculate the pairwise key 
rings for them like Step 4.i and Step 4.ii. 
 
After key distribution process, the nodes with the 
level numbers higher than sl have to drop out their 
seeds. Now the steps of the network group establish-
ment are done. All nodes can verify the distributed 
pairwise keys with the help of the higher sensor nodes, 
or ask the higher sensor nodes for other security ser-
vices according to the predefined hierarchical structure. 
4   Analysis and Discussion 
This session discusses some important properties 
and secueiry issues, and then gives experiements to 
show the superiority of the proposed strategy. 
4.1   The Network Connectivity 
The connectivity is based on two the basic fac-
tors. One is the key distribution function, and the oth-
er is the coverage rate of the key distribution centers 
(KDC). Our scheme applies the bivariate polynomial 
as a pairwise key generation function thus each pair of 
nodes can share an unique pairwise key. Consequent-
ly, the connectivity is much related to the coverage 
rate. In the multi-level environment, any one of sensor 
nodes can get its key ring if it can find at least one 
higher node as its KDC. However, a KDC also has to 
find at least one higher KDC for getting its polynomi-
al seed. 
There are two kinds of connectivity: local and 
global connectivities. The local connectivity is the 
probability that any two neighboring nodes sharing at 
least one key. The global connectivity is based on the 
probability of node being isolation of the great com-
ponents. Larger amounts of isolative nodes represent 
the less global connectivity because these nodes can-
not be reached by any secure links. In other words, the 
global connectivity is the probability that the sensor 
nodes are connected with the largest isolated compo-
nent. 
Due to the use of higher ability of the CHs, the 
coverage in our approach is almost 100%. The ex-
  
8     
 
equation: 
d edge# of linke
ted edge# of effec  
The resilience ability in our scheme is linear 
because the pairwise key is only used in one link. But 
in the random key pool system, the number of com-
promised links is quickly increasing because com-
promising one key may destroy multiple links. 
 
4.3   Efficiency 
In our approach, all the nodes must maintain 
their key rings. In addition, the intermediate nodes 
have to maintain and extend the polynomial seeds for 
building a polynomial, co-polynomial and generate 
the polynomial seeds for their children. Moreover, all 
the sensor nodes have to store one master key before 
deployment. The storage requirement is considered 
only for storing overheads of the keys and polynomial 
seeds. 
For the communication costs, the intermediate 
sensor node needs to take longer time in hello phase 
because it has to wait for the message from higher or 
lower sensor nodes. Moreover, the sensor node must 
transmit its collection information to its KDC. The 
computation overhead is required for the intermediate 
nodes and CHs because they have to deploy and dis-
tribute the key rings and polynomial seeds to their 
lower nodes after deployment. 
 
5   Conclusions 
This paper is the first work to define the mul-
ti-level heterogeneous sensor networks, in which there 
are several kinds of nodes with different abilities. A 
polynomial tree model has been proposed for distrib-
uting polynomials into higher nodes. Moreover, the 
deployment knowledge is applied. Compared with the 
previous studies, the proposed scheme used the com-
bination of the p2p model and the hierarchical model. 
This hybrid model can enhance the performance of 
the network as the result of flexibility. 
 
 
References  
[1] I. F. Akyildiz, W. Su, Y. Sankarasubramaniam and E. Cayirci, 
“Wireless Sensor Networks: a Survey,” Computer Networks, 
Vol. 38, pp.393-422, 2002. 
[2] C. Blundo, A. D. Santis, A. Herzberg, S. Kutten, U. Vaccaro, 
and M. Yung, “Perfectly-Secure Key Distribution for Dy-
namic Conferences,” Advances in Cryptology - CRYPTO ’92, 
LNCS 740, pp. 471–486, 1993. 
[3] H. Chan, V. D. Gligor, A. Perrig, and G. Muralidharan, “On 
the Distribution and Revocation of Cryptographic Keys in 
Sensor Networks,” IEEE Transactions on Dependable and 
Secure Computing, Vol. 2, pp. 233–247, Jul. 2005. 
[4] H. Chen, A. Perrig, and D. Song, “Random Key 
Predistribution Scheme for Sensor Networks,” Proc. of IEEE 
Symposium Security and Privacy (S&P’ 03), pp. 197-213, 
2003. 
[5] H. Chan, A. Perrig, and D. Song, “Key Distribution Tech-
niques for Sensor Networks,” Wireless Sensor Networks, pp. 
277–303, 2004. 
[6] W. Du, J. Deng, Y. S. Han, and P. K. Varshney, “A Key 
Predistribution Scheme for Sensor Networks using Deploy-
ment Knowledge,” IEEE Transactions on Dependable and 
Secure Computing, Vol.3, No.1, pp.62-77, Mar. 2006. 
[7] L. Eschenauer and V. Gligor, “A Key Management Scheme 
for Distributed Sensor Networks,” Proc. ACM Conf. Com-
puter and Comm. Security (CCS’02), pp. 41-47, Nov. 2002. 
[8] D. Huang, M. Mehta, A. van de Liefvoort, and D. Medhi, 
“Modeling Pairwise Key Establishment for Random Key 
Predistribution in Large-Scale Sensor Networks,” IEEE/ACM 
Transactions On Networking, Vol. 15, No. 5, pp.1204-1215, 
Oct. 2007. 
[9] F. Kausar, S. Hussian, L. T. Yang, A. Masood, “Scalable and 
Efficient Key Management for Heterogeneous Sensor Net-
works,” The Journal of Supercomputing, Springer, Vol. 45, 
No. 1, pp. 44-65, 2008. 
[10] D. Liu and P. Ning, “Establishing Pairwise Keys in Distrib-
uted Sensor Networks,” Proc. of 10th ACM Conference on 
Computer and Communications Security (CCS’03), pp. 
52–61, Oct. 2003. 
[11] D. Liu and P. Ning, “Location-Based Pairwise Key Estab-
lishments for Static Sensor Networks,” ACM Workshop on 
Security in Ad Hoc and Sensor Networks (SASN '03), pp. 
行政院國家科學委員會補助學者出席國際學術會議報告 
（請於出席會議後填寫）                                      填表日期：100年 10月 5日 
報告人姓名 王智弘 服務單位 國立嘉義大學 
資訊工程系 
計畫名稱 具高回復能力之異質性無線感測網路金鑰管理及入侵防禦整合
系統設計 NSC 99-2628-E-415-002 
會議時間  2011/9/9 – 11 地    點 寧波 
會議名稱 
中文：2011 電子、通訊及控制國際會議 
英文： 2011 International Conference on Electronics, 
Communications and Control (ICECC 2011) 
發表論文題目 
中文： 一個有效率的可抵抗阻斷服務攻擊之植基於授權的漫遊
付款協定 
英文：An Efficient Delegation-Based Roaming Payment 
Protocol Against Denial of Service Attacks 
 
一、參加會議經過 
  
ICECC 2011 國際研討會的目標為提供一個高水準之國際討論平台以提供研究
學者以及工程師能夠發表以及討論最先進以及最新關於電子資訊、通訊及控制等議
題。. 
 
ICECC 2011 會議在寧波市的寧波大酒店舉行，主要由寧波大學資訊科學與工程
學院主辦，相關論文均會由 IEEE 印製，並於 IEL 資料庫中檢索。會議有來自大陸、
台灣、新加坡、日本、加拿大、義大利等不同的國家發表論文或是演講，可說相當多
元與精采。會議總共進行三天 （9/9-9/11），分成邀請演講、論文口頭發表以及壁報
發表等時段。參加人數非常多，整體參與十分熱絡。 
 
本次會議 9/10 上午有三場 Keynote Speech，分別邀請 Prof. Ke Wu、Prof. 
Wolfgang-Martin Boerner 以及 Prof. Yoshio Yamaguchi 三位學者進行演說，我對第一
場演說十分印象深刻，題目為 Multiport Interferometer Techniques for Transceiver 
System Applications。Prof. Ke Wu 以其豐富的經驗，講述許多 Transceiver System 的
技術及其應用，讓人印象深刻，雖然我的研究領域並非在此，但聽其深入淺出的演說，
仍收穫豐碩。該演講有許多學者提出問題，非常的精采有趣。另外在 9/11 上午的
Keynote Speech 最後一場由 Prof. Yunqing Shi 講述 Information Forensics and 
Security。相關的議題正是我所興趣之處，因此相當仔細注意聆聽，得到許多關於影
像認證與防止竄改的一些新的技術與概念，實在是不虛此行。 
 
 
 二、與會心得 
 
本次會議除了與在場與會人士做學術交流之外，本人在會議上 9/10 下午於
Oral_2: Communication Engineering 上發表一篇論文：An Efficient Delegation-Based 
Roaming Payment Protocol Against Denial of Service Attacks。該論文描述一個有效的漫
遊付款機制，主要植基於授權認證系統，並能進一步防止 Denial of Service 的攻擊。
我所在的場次主要發表為通訊相關的議題，有些論文的內容為增加通訊效能，有些論
文則聚焦於通訊應用。而我發表的論文在通訊安全及其相關應用，因此在場與會的部
分學者對我發表的論文感到興趣，會後仍有相關的討論。 
 
    會議在 9/10 下午亦同步進行所有論文的 poster presentation。我為了與參加的專
家學者進行進一步的交流，當我 oral 報告的議程結束之後，我也到了 poster 的會場。
我也準備了海報張貼，跟在場人士談論我的論文，也利用機會參閱其他作者的相關研
究。有幾篇論文的議題是與 watermarking 及 data hiding 相關的論文，我覺得十分
有趣，因此也駐足觀看，並與作者討論。大會安排的議程十分緊湊，因此在有限的時
間內並無法了解相關論文的內涵，十分可惜。會議的主題分為 
1: Electronics Information Science 
2: Communication Engineering 
3: Automatic and Control 
4: Environmental Protection and Energy Application 
在涵蓋面上十分廣泛。前面的兩個主題與我的研究相關，因此我大部分有興趣的論文
都在這裡。最後一個主題十分特別，關於環境保護及能源問題，其為目前全世界所重
視的議題，因此我也特別花一些時間去了解這些議題所談論的焦點。 
 
    這次會議中遇到幾位來自臺灣、大陸、新加坡的朋友，因語言文化接近，因此能
夠多談一些關於研究上面的心得。整體而言，大陸、新加坡或是其他亞洲的國家，他
們在會議上已經漸漸能夠多參與討論、提問等，對於議題的探討能夠更為深入，因此
能夠激發許多的靈感。台灣的學者這方面較為保守，這是在參加國際會議時的一些看
法，個人感覺多與各種不同背景之專家交流，對於研究的開創多元性，是有非常大的
正面效益。  
 
   本次會議除了演講以及論文討論之外，在最後一天 9/11 下午，安排一個簡短的
參觀行程，參觀寧波市的重要文化景點。第一個參觀的地點是天一閣書院。這是一個
古代藏書及研究地方，充滿書香氣息。這啟發我了解古人對於研究方面的專注、堅持，
今人實難相比。研究貴在專注與博閱，這是不變的真理。 
 
第二個景點我們到了寧波市的博物館，裡面的陳列擺設包羅萬象，從考古的歷史
演進，一直到寧波的地理位置、都市發展，最後有文化傳承的介紹，將一個城市的發
展過程完整的保留下來。這讓我看到了一個都市的興起與蛻變。過去的寧波，與現在
已經現代化、國際化的寧波相比，現在多了許多的方便，但是其都市快速發展的結果，
交通問題、文化斷層等問題已經浮現，這給我許多的省思。 
 
 
  
 
 
附件： 
 
附件一  會議議程表 
附件二  發表之論文 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
An Efficient Delegation-Based Roaming Payment
Protocol Against Denial of Service Attacks
Chih Hung Wang
Department of Computer Science and
Information Engineering
National Chiayi University
Chiayi, Taiwan
Email: wangch@mail.ncyu.edu.tw
Chih Yu Lin
Department of Computer Science and
Information Engineering
National Chiayi University
Chiayi, Taiwan
Email: s0990420@mail.ncyu.edu.tw
Abstract—The payment system for many kinds of mobile
devices, such as smart phones, PDAs and mobile tablets, will be
increasingly developed in the near future. Youn and Lim in 2010
proposed an improved delegation-based authentication protocol
to add the unlinkability property for protecting user’s privacy.
Furthermore, this paper designs a new roaming payment system
for mobile environment combining the concepts of PayWord
and the delegation-based authentication. The denial of service
(DoS) threats on Youn and Lim, and multiple VLRs have also
been considered. The proposed protocol is specially suitable
for off-line fast payments and provides buyer’s privacy by
applying anonymity and unlinkability techniques. Further, the
computational costs are effectively reduced by using hash chains
for payments of small denomination.
Index Terms—Mobile Payment, wireless communication,
delegation-based authentication, unlinkability.
I. INTRODUCTION
Mobile communication or portable communication systems
(PCSs) provide a outstanding technology for removing the
distance limitation in communication. With the development
of many kinds of mobile devices, such as smart phones,
PDAs and mobile tablets, the mobile payment issue has been
highly noticed and discussed. However, due to the property
of resource constraint in mobile devices, the efficiency and
security are two challenges to the practice of e-commerce
applications in the mobile communication environment. Up
to now, many protocols for securing mobile communications,
including authentications and encryptions, have been proposed
[2], [5].
Roaming is a nice service provided by the PCSs for the
mobile user to extend the connectivity in the foreign area
different from his register location. Since the mobile user
may stay in an untrusted domain when roaming, the security
requirements such as authentication, anonymity, privacy and
confidentiality should be paid more attention to and be devel-
oped. The discussions of roaming security have been proposed
in the previous literature [4], [1], [3]. In 2005, Lee and Yeh
[4] proposed a new delegation-based authentication protocol
for PCSs in which the home location register (HLR) delegates
the signing power to the mobile user so that the authentication
and secure communication between the mobile user and visitor
location register (VLR) can be established. Furthermore, Lee
et al. [3] pointed out that the protocol of [4] has a weakness
for a malicious VLR to forge the authentication messages in
off-line authentication process. Lee et al. also presented an
enhanced one to avoid this kind of security flaw. Youn and
Lim [8] in 2010 added a nice property of unlinkability to fully
protect mobile user’s location privacy.
Lee and Yeh’s protocol [4] provided an important property
of non-repudiation that makes their authentication scheme can
be applied to e-commerce applications. The security of Lee
and Yeh’s protocol has been improved by the above two papers
[3], [8]. In this paper, we further point out Youn and Lim’s
protocol [8] suffers from the denial of service (DoS) attack,
since they change the keys stored in HLR each round but do
not consider the possible interruption in data transmissions.
The contribution of our paper is to present an efficient pay-
ment (micropayment) scheme for the mobile user in roaming
environment. The main idea is inspired from [4] combining
with PayWord [6] that the HLR delegates the signing power to
the mobile user to sign the anchor value of the hash chain (the
head of the hash chain for verification) as a commitment of his
payments in roaming stage. The proposed protocol considers
the following important features: a) it has the property of
user privacy with unlinkability and can avoid the denial of
service attacks; b) it supports multiple-VLR payments by using
UOBT (Unbalanced One-way Binary Tree)[7]; c) it is efficient
since combines the anonymous authentication and payment
verification.
The remainder of this paper is organized as follows. Section
II describes the related work and used techniques. The DoS
threats of [8] are also explained. Section III proposes an
efficient delegation-based roaming payment protocol against
DoS attacks. The security and discussions are stated in Section
IV. Finally, Section V draws concluding remarks.
II. RELATED WORK
Some used techniques, e.g., PayWord and UOBT are de-
scribed below. Moreover, the DoS attack appearing in [8] is
also explained in this section.
4136
978-1-4577-0321-8/11/$26.00 ©2011 IEEE
31 2 3
2 3 ,
3 2 2 1 ,
choose a random 
compute ( || || || ) as the session key
[ || || || || || ]
[ || || || || ]
i old
HVi
old
V new new i start
i start K
r
C h R r r
CC R r ID K P
CC CC r R C P
σ
σ
σ
=
=
=
5.2. choose 
      compute  ,
      ,
      store ,  in 
new
new
k
new new new new
new new new new
new new new
k
K g x k K
K K
K DBT
σ
σ σ
σ
′
′
′ ′ ′ ′= = +
′ ′← ←
5.1. if  can be found in 
           retrieve  from  according to 
           ,
           store ,  to 
           perform Step5.2
      else if  can be
new
new new new
old new old new
old old old
K DBT
DBT K
K K
K DBT
K
σ
σ σ
σ
← ←
 found in 
           retrieve  from  according to 
           perform Step5.2
      else  reject the request and quit
old
old old old
DBT
DBT Kσ
15. decrypt CC
 
MU VLRi HLR 
22. ,iVID r
,
( , , , )a bK P bσ 1,0 ,0( , , , , , )old old new new aK K P P bσ σ …
1. K
( 1)
1( )nR h r+=
3. compute (mod )tu g p=
2 ,0 ,( || || || || || )4. verify ( ) (mod )V i i startih R r ID P b Ps K ug vK u p=
1 2 ,compute [ || || || || ] HVii start KCC R r K P b=
1 , , iH V
CC ID ID
,0 ,( , ), , , , , ,H i i startu s K R ID P b P
2 ,0 ,( || || || || || ) (mod )iV i i starts h R r ID P b P t u qσ= × + ×
3
2
6. decrypt 
    verify ,
CC
r R
2
1 2 3
7.decrypt 
   compute ( || || || ) as the session key
   update ( , ) with ( , )
old
new new
CC
C h R r r
K K
σ
σ σ
=
3 , , iH V
C C ID ID
2 , iV
CC ID
Fig. 2. Authentication Phase
4138
TABLE I
THE COMPARISON
Unlink-
ability
Against
DoS
Roaming Anonymous
Authenti-
cation
Payment
Lee and Yeh [4] no - yes yes no
Lee et al. [3] no - yes yes no
Youn and Lim [8] yes no yes yes no
Ours yes yes yes yes yes
service, MU can only send the committed hash chain values
to VLR in roaming payment that can effectively reduce the
computational cost.
Table I shows the comparison among the proposed protocol
and the previous related works. From Table I, we can see that
the proposed protocol provides more properties and presents a
nice combination for anonymous authentication and payment
system.
V. CONCLUSION
This paper proposed an efficient payment protocol for the
roaming service based on the delegation-based authentication.
It focused on the roaming payment with small denomination
so that the regular payment protocol was omitted. The result
has considered the multiple VLRs and can be protected against
DoS attacks, The proposed protocol can also reduce the costs
by combining the authentication and signing payment commit-
ments. This paper only gives a demonstration of PayWord-like
micropayment scheme, while the complicated payment method
will be developed in the future work.
ACKNOWLEDGMENT
This work was supported in part by National Science
Council under the Grants NSC 99-2628-E-415-002.
REFERENCES
[1] R. J. Hwang, S. H. Shiau, and D. F. Jan, “A new mobile payment scheme
for roaming services,” Electronic Commerce Research and Applications,
vol. 6, pp. 184–191, 2007.
[2] Y. Jiang and C. Lin, “Mutual authentication and key exchange protocols
for roaming services in wireless mobile networks,” IEEE Trans. Wireless
Commun., vol. 5, no. 9, pp. 2569 – 2577, September 2006.
[3] T.-F. Lee, S.-H. Chang, T. Hwang, and S.-K. Chong, “Enhanced
delegation-based authentication protocol for PCSs,” IEEE Trans. Wireless
Commun., vol. 8, no. 5, pp. 2166–2171, May 2009.
[4] W.-B. Lee and C.-K. Yeh, “A new delegation-based authentication pro-
tocol for use in portable communication systems,” IEEE Trans. Wireless
Commun., vol. 4, no. 1, pp. 57–64, January 2005.
[5] P. Lin, H. Chen, Y. Fang, J. Y. Jeng, and F. S. Lu, “A secure mobile
electronic payment architecture platform for wireless mobile networks,”
IEEE Trans. Wireless Commun., vol. 7, no. 7, pp. 2705 – 2713, July 2008.
[6] R. L. Rivest and A. Shamir, “Payword and micromint: Two simple
micropayment schemes,” in Proceedings of the International Workshop
on Security Protocols. Lecture Notes In Computer Science, LNCS,
Springer-Verlag, 1997, pp. 69 – 87.
[7] S. Yen, L. Ho, and C. Huang, “Internet micropayment based on unbal-
anced one-way binary tree,” in CrtpTEC’99, Hong Kong, July 1999, pp.
155–162.
[8] T. Youn and J. Lim, “Improved delegation-based authentication protocol
for secure roaming service with unlinkability,” IEEE Commun. Lett.,
vol. 14, no. 9, pp. 791–793, September 2010.
4140
99 年度專題研究計畫研究成果彙整表 
計畫主持人：王智弘 計畫編號：99-2628-E-415-002- 
計畫名稱：具高回復能力之異質性無線感測網路金鑰管理及入侵防禦整合系統設計 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 0%  
研究報告/技術報告 0 0 0%  
研討會論文 1 0 30% 
篇 
C. H. Wang and T. 
C. Wei. The 
Design of the 
En-route 
Filtering 
Mechanism with 
Immediately 
Lightweight 
Authentication 
for Wireless 
Sensor Networks. 
2010 
International 
Computer 
Symposium (ICS 
2010), Tainan, 
Taiwan, Dec. 
16-18, 2010. 
論文著作 
專書 0 0 0%   
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 3 3 100%  
博士生 1 1 100%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 0 0 0% 
已將研究成果整
理，寫成論文初
稿，準備投搞期
刊。 
研究報告/技術報告 0 0 0%  
國外 論文著作 
研討會論文 2 0 60% 
篇 
1.C. H. Wang and 
T. C. Wei. A New 
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
1. 出國參加國際研討會共 2 次並發表論文。與大陸以及其他各國研究領域相
近的學者交換研究意見及經驗交流。 
2. 培養研究生在無線感測網路安全上面的學術及實驗能力。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
