2??
?????????????????
????????????????????
????????????????????
????????????????????
????????????????????
????????????????????
???
?????????????????
????????????????????
??????(PMSM)??????????
????(SPWM)????????????
? PID ????????????????
??????????????? PC ???
???????????
??????????????????
????????PID?
Abstract
The weight-lifting machine is used for
assistance of muscle training, generally couple a
stack of iron or lead weights as the load.
According to physical status, user can select
different weights to achieve fitness results.
However, it would cause the physical injury by
choosing improper weights without the
assistance of professional trainers.
This project uses the embedded system to
design and implement a weight-lifting machine.
A Permanent Magnet Synchronous Motor
(PMSM) drive controlling system based on an
microcontroller is used to control the torque of
PMSM via the Sinusoidal Pulse Width
Modulation (SPWM) method. The PID control
algorithm is applied to smooth the torque ripple.
Finally, the whole system is designed and
implemented in this project and the experimental
results would demonstrate the system
performance.
Keywords: The weight-lifting machine,
Permanent Magnet Synchronous Motor(PMSM),
Sinusoidal Pulse Width Modulation (SPWM)
?? ??
?????????????????
????????????????????
????????????????????
????????????????????
????????????????????
????????????????????
????????????????????
????????????????????
???????????????????
????????????????????
????????????????????
?????????????????? Hall
????????????????????
????????????????????
????????????????????
?????????????(BLDC)?
??????(PMSM)??????????
????????????????????
????????????????????
????????????????????
??????????? 1 ???
? 1. ?????????????????????
? 2. ????????
? 2 ????????????????
???????(120°??)????????
??????????????????
(180°??)???????????????
????? 60°?????????????
????????????????????
????????? 120°?????? 120°
??????????????? 60°???
????????????????????
???????????????????
????
???? ????
????
?????? ??????
Motor
VDC VC(High) VB(High) VA(High)
VCom(Low) VCom(Low) VCom(Low)
Q1
Q2
Q3 Q5
Q4 Q6
Vc
Vb
Va
PWM1H
PWM1L
PWM2H
PWM2L
PWM3H
PWM3L
a
b c
ia
ib
ic
4????????????SPWM ????
????
? 4. ?????????
?????????????????
????????????????????
?? 1ms?10ms?100ms?500ms ? 1s ???
???????????????????
????????????????????
?????????????? 5 ?????
????????????????????
????????????????????
??…?????????????? 1ms
??????????????????
10ms ???RC ?????????????
???????????????????
????????????? 100ms ???
????????? 500ms ? 1s ??????
????????????????????
??????????????????
????????????A/D ??????
????????????????????
??????????? 2 ????????
????????????????????
???
3.1 SPWM ???
??????????????????
???????????????????
???? PWM ?????????????
???????????????? 0?60 ?
? 60?90?120 ???????????
??120?180 ???????? 0?60 ??
???????????
?????
N
N
N
N
N
Y
Y
Y
Y
Y
?????
?????
?????????
?????????
???????????
Hall??LED??
?????????
RC??????on/off?100mS?
???????
????LED????
????????????????
?????
LED??????
??Timer3????
1ms ?
10ms ?
100ms ?
500ms ?
1s ?
? 5. ????????
3.2 ???????
????????????? PID ?
??????????? 1KHz??? 1ms ?
????????????(??)?????
PWM ?????????????????
???????? A ????????? A
???????Timer3 ??????????
?????????????? Timer3 ??
???????
? 2. ???????????????
?
?
?
??????? ?????
5 Timer1 ???? ? ? ? ? ? ? ? ? ?
???? Timer1?
4 Timer3 ???? ?? Timer3 ?????
6 ?????? ??????????
?????????
5 A/B ????
????
???????????
???????????
?????? PWM ??
????????
6 Index ???
??
??????????
??
3 ?????? ??????????
??
??
?
?
?
?
???
??
????
??
????
????
????
????
????
??
GP
IO
??
??/??
??
??
??
??
??
??
??
??
??
??
??
??
???
??
PC
???
???
Hall
??
???
??
PWM?
???
PWM1?6
6? 3. ?????????????????
????
(kg-cm)
????
(kg-cm)
????
(A)
??
(RPM)
2 0 1.96 1100
2 11.75 1.36 763
4 0 2.16 606
4 11.75 1.2 336
6 0 2.2 411
6 11.75 1.16 217
8 0 2.36 331
8 11.75 1.16 162
10 0 3.04 341
10 11.75 1.16 130
?? ??
?????????????????
????????????????????
???????????????????
????????????????????
??????? SPWM??? PID ????
????????????????????
????????????????????
???????????????????
????????????????????
?????????????? PID ????
????????????????????
????????????????????
????????????????????
???????????????????
??????
?? ????
[1] Fernado Bugalo., “Weight Lifting apparatus having 
increased force on the return stroke”, U.S Patent No.:
4563003 1983.
[2] Ryoji Mizutani; Takaharu Takeshita., “Current 
model-based sensorless drives of salient-pole
PMSM at low speed and standstil”, IEEE 
Transactions on Industry Applications, Vol. 34, No.
4, July/August 1998.
[3] Shashank Wekhande; Vivek Agarwal.,
“High-resolution absolute position Vernier shaft
encoder suitable for high-performance PMSM servo
drives”, IEEE Transactions on Industry Applications, 
Vol. 5, No. , February 2006.
[4] Charles B. Corbin; Ruth Lindsey., “Fitness for Life
5th ed”, Human Kinetics, c2005.
[5] American College of Sports Medicine., “ACSM's
resource manual for Guidelines for exercise testing
and prescription / American College of Sports
Medicine 5th ed”, Lippincott Williams & Wilkins,
c2006.
[6] ????“???????????????
?”???????? 95 ? 6 ??
[7] ????“? DSP ?????????????
??????”???????? 97 ? 7 ??
[8] ????“dsPIC???????????”???
????????
98年度專題研究計畫研究成果彙整表 
計畫主持人：何子儀 計畫編號：98-2220-E-035-002- 
計畫名稱：以嵌入式系統為基礎之電子重量訓練機設計與製作(智慧行動裝置之定位生活輔助科技) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 2 2 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
