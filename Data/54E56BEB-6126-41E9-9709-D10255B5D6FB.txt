 基於 OSC-ANF 多重頻率偵測器的演算法推導及系統規劃 
 
廖和恩、鄭光宏、柯朝凱 
逢甲大學通訊工程學系 
訊號整合處理實驗室 
 
 
     摘 要 - 本 文 主 要 是 使 用 OSC-
ANF(oscillator based adaptive notch filter) 的
頻率偵測架構為基礎，擴展到多個頻率偵測的
系統，並且探討及設計完整的架構。建立此系
統的方法主要是使用串聯和並聯架構來實現。
本篇主要針對串聯的結構來做設計及改良。不
僅考慮多重頻率偵測器的串聯架構完整性，而
且對整體的偵測精確度和偵測速度列入考量。
提出此新串聯架構來應用在多個頻率的偵測，
達到有效的偵測。 
一、 前言 
     針對信號處理的領域中，對於雜訊存在的
環境下，如何偵測和取得原信號，並保留其完
整性，及接收端的抗雜訊能力，是值得研究和
討論的。頻率偵測系統，應用在通訊、雷達、
即時控制以及影像處理等領域上，都有不錯的
效能；因此在推導頻率偵測演算法和設計多重
偵測架構是極具應用價值的。雖然目前已經有
許多的方法來達到偵測頻率的目的，例如 
adaptive line enhancer (A.L.E)、lattice adaptive 
notch filters、FFT… 等方法[1]-[3]，但在雜
訊存在的環境下，會因較複雜的計算量，而失
去時效性。 
    在 本 篇 中 ， 提 出 OSC-ANF (oscillator 
based adaptive notch filter) 結合自調適演算法
[4]，這是一種運算複雜度低及收斂速度快的
頻率偵測方法，能解決前面所遇到的問題；並
以此為基礎來延伸至多重頻率的偵測，增加整
個系統的應用範圍及價值。 
二、 頻率偵測架構 
     OSC-ANF 的自調適頻率偵測，主要是使
用數位振盪器的自迴歸模型來推導而形成的。
假設輸入信號表示為 ( ) )cos( 000 φω += And ，
0A 代表振幅， 0ω 、 0φ 代表信號的角頻率及相
位 。 藉 由 連 續 三 個 輸 入 信 號
( ) ( ) ( )2,1, −− ndndnd 與振盪器之間的關係，可
求的輸入信號的頻率，亦即 
( ) ( )
( ) ⎟⎟⎠
⎞⎜⎜⎝
⎛
−
−+== −
1
2
2
1cos 0
1
0 nd
ndndαω  (1)
     利用此基本的振盪器原理，再結合自適應
濾波器(帶通或帶拒) [5]-[6]，來組成整個基
本偵測架構，其系統的架構圖，可用方塊圖
(圖一)表示。在系統方塊圖中，輸入信號為受
雜訊干擾的弦波信號，以 NF ( Notch filter，帶
拒濾波器)來除去部分的輸入訊號；相當於偵
測並且濾出原信號。 
Adaptive
mechanism
IIR NF
noisy sinusoid
u(n)=d(n)+w(n)
coefficient
α(n)
reference
signal
x(n)
z(n)
 
圖一： ANF 系統方塊圖 
        接著為了與數位振盪器中的頻率參數
0α 結合，使用 All pass filter 的架構，導出其系
統轉換函數為 
( ) ( ) 210
21
0
11
21
2
1
−−
−−
++−
+−+=
zz
zzzH NF ββα
αβ  (2)
其中 β 為頻寬參數。 
      OSC-ANF 的自調適頻率偵測是利用疊代
的演算法來求的最佳的 ( )nα ；如用 LMS、
MSE、RLS…等演算法來實現，而此係數則對
 代運算的同時，改善了延遲的問題，對於整體
的收斂速度提升許多。下面的圖形是改變參考
值的模擬圖(SNR=20dB)(圖六) 
 
 
圖六：串聯偵測模擬圖(新參考值 )(nxnew ) 
 
     假設輸入信號的參數相同，但與之前的模
擬做比較，可以發現後者的收斂速度提升許
多。用新提出的參考值取代原本的，即是對收
斂速度過慢的情形做改善，來提升串聯架構的
效能。 
     針對 OSC-ANF 多重頻率偵測架構，在收
斂速度上已經有所提升，但偵測架構的精確度
和穩定度也必須探討。在精確度方面，將
0α (相對應於 0ω )與偵測得到的 ( )nα 做比較。
由於偵測器是使用疊代的方式做修正誤差的動
作，所以 ( )nα 會在 0α 值呈現正、副誤差值逼
近的漣波，如(圖七)； 
 
 
圖七：多重頻率串聯偵測模擬圖(ANF#1) 
 
    直 線 為 0α =0.3090 的 值 ( 對 應
0ω =0.4π)，漣波部份為偵測器得到的 ( )nα ，
可以發現 ( )nα 的值介於 0.3060~0.3168 (對應
0ω =0.4010π~0.3974π) 。 其 誤 差 值 介 於
0.0010π~ -0.0006π，此範圍會隨著輸入信
號的頻率個數增大，造成偵測的精確度變差。 
    雖然就整個系統而言，會因 notch filter 
的濾除作用，依序使各別單一個 OSC-ANF 頻
率偵測器的漣波範圍減小；但在頻率個數多的
情況下，對順序在前面的偵測器，則會有嚴重
的影響。原因是系統本身的 all pass filter 的濾
波效果不佳( β 值太小，頻寬太大)，所以產生
較大的漣波(在精確度的表現上較差)。同樣發
生在兩個頻率極接近的情況下，因系統的 β 值
太小，造成濾除不完全，產生偵測值變動的情
形，造成系統不穩定。如(圖八)所示， 
 
 
圖八：偵測產生變動的模擬圖 
 
     圖八中， β 值為 0.8， 0α =0.3090，
1α =0.3681 ( 0ω =0.4π， 1ω =0.36π)，因為頻
率太近，而 notch filter 的頻寬太大，導致濾除
效果差，使偵測系統的收斂線成交叉狀態，造
成系統不穩。 
     針對這兩個問題，將從 notch filter 的頻寬
β 做設計來修正與改善。提出的方法是在整個
all pass filter 的系統上，對 β 值做調整，加大
β 值，使頻寬縮小，達到良好的濾除效果
[8]。針對此概念，提出以下設計： 
 
(1).方法一：固定型的頻寬 β  
    將原先的 β 值由 0.8 調整到 0.9，縮小頻
寬。可以在頻譜上看出濾波器 notch filter 在濾
除表現上(相當於分割信號)的差異，如圖九、
十。由圖九，可以看出濾除效果並不好，頻帶
凹陷部分交疊在一起，容易產生偵測錯誤。 
 
 
圖九：偵測系統 notch filter 頻譜圖( β =0.8) 
 動型 β 值架構在收斂速度不只改善，而且在抗
雜訊的表現上也達到不錯的效果。  
 
 
圖十五：ANF#2 的 β 值收斂曲線圖 
(可變動 β 值) 
 
     圖十六、十七是在 SNR=10dB，頻率為
15、 20、 23 Hz，其中有頻率的變化產生
(20Hz→17.7Hz)。在雜訊干擾下，固定型 β
值，因為頻寬固定，使其收斂速度表現上會較
差，而且在頻率變動時，會有系統不穩定的情
形發生；變動型 β 值，則在收斂速度及穩定度
都有不錯的表現，也表現其抗雜訊的能力。 
 
 
圖十六：頻率偵測模擬圖( β =0.99, SNR=0dB)  
 
 
圖十七：頻率偵測模擬圖( β 可變動,SNR=0dB)  
 
     表I，呈現新架構在無雜訊及訊雜比為
10dB、0dB 的情形下；在精確度的表現上，與
原始架構差不多；但在頻率變動和雜訊加入的
情形下，新架構的表現是優於原架構的，若再
考慮其收斂速度，則原架構會因其收斂速度慢
且不穩定的因素，而選擇新架構為較佳。 
 
 
表 I 
偵測頻率變動情形的 MSE (頻率為 15、20 
(20HZ→17.7HZ)、23 HZ) 
原架構偵測
器 No noise SNR=10dB SNR=0dB 
ANF #1 1.046*10-7 2.222*10-7 1.354*10-6
ANF #2 2.183*10-7 5.693*10-7 2.046*10-6
ANF #3 3.762*10-8 2.082*10-7 2.376*10-6
 
新架構偵測
器 No noise SNR=10dB SNR=0dB 
ANF #1 1.427*10-7 2.98*10-7 1.86*10-6
ANF #2 1.343*10-7 2.491*10-7 2.026*10-6
ANF #3 4.251*10-8 2.169*10-7 1.98*10-6
 
結論 
    在 OSC-ANF 的頻率偵測架構為基礎下，
提出多重頻率偵測架構，並針對系統的效能做
設計；由提出的方法一，做進一步的改良，延
伸出方法二；可以發現提出的新架構不僅在偵
測速度上有所提升，更改善了依序延遲的收斂
速度問題；而在穩定度及抗雜訊的能力也有很
好的表現。 
參考文獻 
[1] B. Widrow et. Al, “Adaptive noise canceling: 
principles and applications”, Proc. IEEE, vol. 
63, pp.1692-1716, Dec. 1975. 
[2] N.I. Cho, S.U. Lee, “On the adaptive lattice 
notch filter for the detection of 
sinusoids,“ IEEE Trans.Circuits Syst. 40 (7) 
(July 1993) 405–416. 
[3] N.I. Cho, S.U. Lee, “Tracking analysis of an 
adaptive lattice notch filter,“ IEEE Trans. 
Circuits Syst. 42 (3) (March 1995) 186–195. 
[4] H. E. Liao, “Two Discrete Oscillator Based 
Adaptive Notch Filters (OSC ANFs) for Noisy 
Sinusoids,” IEEE Trans. Signal Processing, 
vol. 53, no. 2 Feb. 2005.  
[5] S. Haykin, “Adaptive Filter Theory”, 3rd ed., 
Prentice-Hall, Inc., 1996. 
[6] Sanjit K. Mitra. “Digital Signal Processing A 
Computer-Based Approach”. 2nd ed., 
McGraw-Hill Companies, Inc., 2002 
[7] 廖和恩、兵聖潔, “利用自調適濾波器偵測
多重弦波之頻率”, NO.13, June 2000. 
[8] A. Nehorai, “A minimal parameter adaptive 
notch filter with constrained poles and zeros,” 
