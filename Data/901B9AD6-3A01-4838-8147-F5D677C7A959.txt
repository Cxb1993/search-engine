2I. Introduction
現實世界的問題常有互相衝突的目標，而被表示為多目標最佳問題來分析。演化式演算法具有同時
計算多個解的特性，故常被用來求解多目標最佳化問題，但是當每個解的目標函數值必須以模擬估算時，
就要耗費相當多的運算時間才能逼近非凌駕解。然而，我們不能貿然縮短模擬時間的時間，因為模擬實
驗時間過短可能會造成模擬誤差過大，容易造成演算法誤判的情形發生；相對地如果模擬實驗時間過長，
可能會減少演算法搜尋較佳解的機會，Boesel et al.(2003)對於模擬最佳化的問題有相當完整的介紹。為了
順利結合模擬與演算法以求解多目標最佳化問題，本研究的重點在於發展篩選機制，從群體中挑選較具
潛力的子代進行模擬，以便節省運算時間。研究運用 Kriging 對產生的子代進行品質的推測，再參考 NSGA-
ⅡDominant Sorting 的做法進行篩選，放棄不具潛力的子代解以減少計算目標函數所需的模擬時間，實驗
結果顯示篩選機制不會明顯影響演算法求取非凌駕解集合的品質。
II. Literature Review
2.1 Multi-objective Optimization
許多工程與管理的應用都需要考量多個目標的最佳化，例如供應鏈網路的設計是企業營運的重要議
題，而顧客服務水準的最大化與庫存成本的最小化很難同時兼顧，必須互相權衡以達成決策。許志義(2003)
定義多目標規劃模式如(1)所示，其中
1 2, ,..., pZ Z Z 為p個單一目標函數。
     1 1 2 2 1 2 1 2
1
/ , ,..., , , ,..., ,..., , ,...,
. . , 1, 2,...,
0 , 1,2,...,
n n p n
n
ij j i
j
j
M in M ax Z X X X Z X X X Z X X X
S T a X b i m
X j n

  
 
 

(1)
多目標最佳化的主要目的是找尋 Pareto-optimal solutions，也就是沒有其他解可在每一個目標函數相
等或超越的解。Sukla and Deb(2007)提及多目標最佳化問題研究及應用之領域成長相當地快速，而求解多
目標最佳化問題也存在許多方式及演算法，可分為兩大類：(1)傳統方法依據某些數學準則，使用直接推
導或以 gradient 為基礎。這些傳統方法大多傾向將多目標問題純量化(scalarize)，然後重複執行同一應用
方法以找出 Pareto-optimal solutions。(2)非傳統方法依據自然界的某些現象而發展，其中又以演化式多目
標最佳化(evolutionary multi-objective optimization, EMO)，於近幾年最為廣泛使用來求解。EMO 傾向於單
一求解過程中，找出多個 Pareto-optimal solutions，盡可能求解出所有解的範圍及 Pareto-optimal front。
演算法如果能找到逼近真實 Pareto-optimal solutions 的解，就具有良好的收斂性(convergence)，如果
能找到分佈均勻的解，就具有良好的多元性(diversity)，但是只有優異的演算法才能同時兼顧收斂性及多
元性的表現。除此之外，演算法的求解速度也是研究所重視的議題。
2.2 Kriging
Beers and Kleijnen(2003)提及Kriging為一插值技術，由南非採礦專家D. G. Krige所研發，主要用於空
間插值或預估，即以現有觀察採樣資料為基礎，預測未開發區域的礦產品質。Kriging方法大多是應用在
地質統計學上，近年來，Kriging也被應用於模擬最佳化問題。
Kriging 是利用各資料點之間的變異數大小，來推估某一未知點與各已知點的權重關係，再由各資料
點的值與未知點的權重關係來推估未知點的值。而在地質統計學上，地形面本身即具有連續的性質，故
在一短距離內的任兩點必有空間上的關係，如果是在一不規則面上的兩點若相距較遠，則在統計意義上
可視為互為獨立，這種隨距離而改變的空間上連續性，可以用半變異圖(semivariogram)來表示。利用半變
異圖推求各已知點及欲求值點的空間上關係，再利用線性回歸方式呈現，則可由空間參數推求半變異數，
由各資料點間的半變異數可推求未知點與已知點間的權重關係，進而求出未知點的值(李達源與莊愷瑋，
2003)。李育明(2004)將 Kriging 分為以下兩種：
1. Linear Kriging：一般基於統計學線性模式推導，屬於傳統傳統型態模式。
2. Non-linear Kriging：亂數本身屬於離散變數、多變量或其它不具線性函數特性的模式。
Kriging 基本假設為期望值與變異數只和隨機變數的距離有關，與其所在空間無關。在空間中之隨機
變異的分佈，常用一種空間隨機函數 Z(x) 來表示，而一般的 Kriging 有以下基本假設，如下所示：
1. 隨機流程（random process）是由一固定平均值μ與誤差項δ(s)所組成。
  ,Z s s s D R      (2)
2. 對於欲估計點 S0 而言，為所有觀察輸出資料中的一加權線性函數。
   0
1 1
1
n n
i i i
i i
p Z s Z S with 
 
   (3)
而變異元模型主要用以描述空間的相關性，觀念與相關係數相似，但是與共變數特性相反，意思是
4所有非凌駕解和相鄰解之間的距離。當公式（1）所求得 D*越小則表示非凌駕之間距離分佈的越均勻，
則多元性程度越好。
d)(N-dd
d-ddd
D
lowhigh
N-
i
ilowhigh
i 1
||
1
1*




 （5）
3. 兼顧收斂與多元化的績效指標：應用 Bosman and Thierens（2003）研究中反向衡量真實的 Pareto optimal
front 到非凌駕解集合之間的距離可以同時評估非凌駕解的收斂和多元性程度。公式（6）計算加總每
個真實的 Pareto 到所有非凌駕解的最短距離，Dp越小代表非凌駕解的品質越好，且只有同時非凌駕解
都具有收斂性和多元性績效值才會小。
 )(),(min 110
0
zdfzzdD
p Sz
p  （6）
演算法的主要特色是利用 Kriging 來估算子代的目標函數值，將所求得資訊參考 NSGA-ⅡDominant
Sorting 來進行子代的挑選，對尚未進入系統模擬子代做一推估，以評估子代解的好壞來減少模擬運算時
間。本研究 Kriging 推估流程如下列步驟所示：
1. 數據收集與分區挑選
在未啟動篩選機制前，先收集一組非凌駕解數據為參考點(sample)，此組參考點若大於 200 個，則使用分
區挑選，將參考點依據目標函數值分 5 個區間，平均挑選 200 個參考點，使參考點分佈更均勻，讓 Kriging
更準確對子代進行目標函數值估計。
2. 計算變異元（variogram）
變異元是一種表現區域變數（regionalized variable）沿著某一特定方向的變化率值，以此量測已知樣本間
的空間變異度。沿著某方向任取兩點樣本配對，兩點間的距離為 h 個單位，則定義半變異數為
     
 2
1
1
2
N h
i j
i
h Z S Z S
N h


    。Si為第 i 點的區域變數值，Sj為與第 i 點相距 h 個間隔的區域變數值，N(h)
表示相對距離 h 之取樣點的配對組數。
3. 導出線性回歸方程式
經由求得的半變異數h 與距離 h 之間的關系，可推得參考點的二階線性回歸方程式。
4. 利用 Kriging進行預測
Kriging 是運用預估點與參考點之間的空間關係，來做權重線性組合並進行推估績效值，式子為
*
0
1
n
i i
i
Z Z

 ，
*
0Z 為預估點的績效值， iZ 為參考點的績效值。我們期望預估點的績效值等於參考點的績效值，
即  *0 iE Z E Z   。經由上述兩項特性可推得
1
1
n
i
i


 ，運用 Beers and Kleijnen (2003)研究的權重係數
'' 1
' 1
' 1
1 1
1
1 1
 



     
進行求解。為預估點到參考點之間的距離 h 單位，再代入所求得參考點的線性回歸
方程式所求得的值。為所有參考點各個之間的距離 h 單位，1 代表值全為 1 的矩陣，再將所求出的代
回式子 *
0
1
n
i i
i
Z Z

 以求得預估點的績效值。
IV. Experimental Results
本研究運用 Matlab7.1 軟體對演算法架構進行實驗測試，先以較為容易計算的數學範例進行測試。
雖然以數學範例而言，Kriging 會增加運算時間，但是數學範例皆有已知的 Pareto-optimal front，而且數學
範例的目標函數不需經由模擬估算，故可將 Kriging 預測的子代目標函數值與真實的目標函數值做比較。
4.1 無限制式的多目標數學範例測試（Ⅰ）
第一個數學範例測試採自於 Deb(2001)的研究，此數學範例具有兩個目標函數與兩個變數，為求取
最小化多目標數學問題（以下稱為 Min_Ex），Min_Ex 是不具有限制式條件。已知的 Pareto-optimal solution
分佈在 0Xand1X0.1 *2
*
1  ，數學式如公式（7）所示。












50
11.0
1
)(
)(
:Min_Ex
2
1
1
2
2
11
x
xtosubject
x
x
xfMinimize
xxfMinimize
（7）
6我們再以不同隨機亂數進行 10 次實驗，每次經過 100 代演化，平均結果列於表 1，由數據可看出
Kriging 在收斂與多元性指標上都明顯優於 P36 與 Distance。如果目標函數必須以模擬估算，則無論篩選
機制是 Kriging 或是 Distance，演算法的速度都會大幅提升。
表1 Min_Ex 第 100 代實驗結果(10 次實驗平均與標準差)
Convergence Diversity
Generation # 10 # 20 # 50 # 100 # 10 # 20 # 50 # 100
P36 0.50360.6208
0.1389
0.2297
0.0214
0.0222
0.0108
0.0116
0.8995
0.1786
0.8471
0.2104
0.7297
0.1183
0.7227
0.1341
Distance 0.50890.6183
0.1983
0.2945
0.1386
0.3030
0.0706
0.1673
0.90109
0.1686
0.7781
0.1059
0.7584
0.1260
0.7436
0.1126
Kriging 0.84650.9270
0.2524
0.4000
0.0198
0.0234
0.0073
0.0067
0.9318
0.1928
0.8172
0.1238
0.7166
0.1071
0.6979
0.0878
本研究也評估 Kriging 在預測子代目標函數值的準確性，以其預測值與實際值求得出預測誤差，圖 5
為十次實驗 Kriging 預測誤差的 MAD，由圖可得知在世代剛開始時，由於所收集之參考點無法有效預測
出績效，但是在 30 代過後 MAD 降至 1%之下且趨於穩定，表示 Kriging 可有效地預測子代的目標函數值。
本研究認為預測準確性高可篩選出較佳的子代，這影響了交配出的下一代，進而影響到產生的非凌駕解。
0
0.5
1
1.5
2
2.5
0 10 20 30 40 50 60 70 80 90 100
generation
M
A
D
f1-MAD f2-MAD
圖5 Min _Ex 100 代內 f1 與 f2的 MAD 變動情形
4.2 無限制式的多目標數學範例測試（Ⅱ）
此範例為 Deb（2001）中提出的 n 個變數雙目標最小化問題，本研究藉由此範例來測試篩選機制
Kriging 在多維變數的多目標問題的求解品質，其數學式如（8）下（以下簡稱為 ZDT2_Ex）：
]1,0[
)/(1)(
1
9
1)(
)(
:2
2
12
2
11











i
n
i i
x
gfxf
x
n
xg
xxf
ZDT
（8）
已知 Pareto-optimal region 為 02,3,....,3ifor0xand1x0 i
*
1  。本研究為簡化題目，因此設定決策
變數為 n = 3。實驗結果整理為圖 6 與圖 7，分別為前 20 代的收斂指標與多元性指標變動情形，表 2 為
為 100 代的結果，同樣是 10 次實驗的平均值與標準差。
ZDT2_Ex_Convergence after generation 20
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
0 2 4 6 8 10 12 14 16 18 20
generation
co
nv
er
ge
nc
e
No-Filtering-P36 Filtering-Distance Filtering-Kriging
圖6 ZDT2_Ex 20 代收斂指標變動情形
8Con_Ex_Diversity after generation 20
0.7
0.72
0.74
0.76
0.78
0.8
0.82
0.84
0.86
0 2 4 6 8 10 12 14 16 18 20
generation
di
ve
rs
ity
No-Filtering-P36 Filtering-Distance Filtering-Kriging
圖9 Constr_Ex 20 代多元化指標變動情形
表3 Constr_Ex 第 100 代實驗結果 (10 次實驗平均與標準差)
Convergence Diversity
Generation # 10 # 20 # 50 # 100 # 10 # 20 # 50 # 100
P36 0.01750.0043
0.011
0.003
0.0070
0.0017
0.0042
0.0003
0.8276
0.0697
0.7568
0.0521
0.7535
0.0387
0.7067
0.0412
Distance 0.02080.0076
0.0131
0.0050
0.0071
0.0040
0.0043
0.0034
0.7697
0.0666
0.7436
0.0399
0.7011
0.0293
0.6951
0.0496
Kriging 0.01820.006
0.0131
0.0064
0.0066
0.0014
0.0037
0.0006
0.7869
0.0715
0.7840
0.0607
0.7376
0.0470
0.7066
0.0445
4.4 模擬範例測試
數學範例測試後，本研究以一個顧客服務流程系統來測試演算法，在此顧客服務流程系統中，顧客
先進入服務站 1 接受服務，其後依據設定的比例進入服務站 2 或 3，如圖 10 所示。進入服務站 2 的顧客，
如果發現等候顧客數已達上限 n，則顧客將自行離開系統，不接受服務，即成為損失的顧客；反之若等候
顧客數未達上限 n，則顧客將進入服務站 2，等候接受服務，服務完成後才離開系統。而進入服務站 3 的
顧客則不論等候被服務的顧客數為多少，都是選擇排隊等候服務，直到在服務站 3 接受服務完後，才會
離開系統。多目標最佳化問題為降低損失顧客人數與降低顧客的平均服務流程時間，演算法將以模擬估
算這兩個績效指標，因此需要耗費大量運算時間來評估每個子代的優劣，但是系統績效也可經由等候理
論求解，故可以評估 Kriging 預測的準確度，亦可用數值計算方式推知理論解之 pareto-optimal front。
圖10 顧客服務流程示意圖
系統的決策變數如下：
：服務站 1 的顧客服務時間，服務站 2、3 顧客服務時間為（2.5-）
γ：顧客決定進入服務站 2 或 3 站之機率分派
n：服務站 2 允許之最大等候顧客人數 (此處設定 n=5)
相關績效指標為：
Station 2
Station 3
Customers going to
Station 2 or 3
$
Station 1
Queue limit
EXIT
10
Pareto-optimal front
0.01
0.015
0.02
0.025
0.03
0.035
15 20 25 30 35 40 45
Flow
B
al
ki
ng
.
Real P36 Distance Kriging
圖12 顧客服務流程系統第 50 代之 Pareto-optimal front 變化情形
Balking_Balance after generation 50
0
0.2
0.4
0.6
0.8
1
1.2
1.4
0 5 10 15 20 25 30 35 40 45 50
generation
ba
la
nc
e
P36 Distance Kriging
圖13 顧客服務流程系統之 Balance 指標變動情形
圖 14 比較三者所搜尋之非凌駕解數量，P36 較優，但是差距極小。在搜尋的準確度方面，圖 15 為
50 代期間內搜尋到的非凌駕解被真實非凌駕解凌駕的數量，圖 3 為 50 代期間內搜尋到的非凌駕解被真實
解凌駕的比率，綜合上述三個指標來說，雖然 P36 與 Distance 比 Kriging 所找到解較多一點，但是 Kriging
所找到非凌駕解被真實非凌駕解凌駕的個數，比 P36和Distance來得少，因此從被凌駕的比率來看，Kriging
也有較佳表現。由上述績效表現情形可得知，將 Kriging 運用在此顧客服務系統中，不僅能夠找到較多的
非凌駕解，而且 Kriging 非凌駕解的正確性也比 P36 好，並且能夠達到節省模擬運算時間的目的。
Balking_non-dominated solutions after generation 50
0
20
40
60
80
100
0 5 10 15 20 25 30 35 40 45 50
generation
no
n-
do
m
in
at
ed
so
lu
tio
ns
P36 Distance Kriging
圖14 顧客服務流程系統之非凌駕解的數量變動情形
Balking_dominated count after generation 50
5
15
25
35
45
55
65
0 5 10 15 20 25 30 35 40 45 50
generation
do
m
in
at
ed
co
un
t
NO-Filtering-P36 Filtering-Distance Filtering-Kriging
圖15 顧客服務流程系統之非凌駕解被真實解凌駕的個數變動情形
 5
 
國科會補助專題研究計畫項下出席國際學術會議心得報告 
                                     日期：99 年 10 月 23 日 
一、參加會議經過 本會議為第 40 次舉行，地點在交通較不方便的淡路島，大會主
題是 Soft Computing Techniques for Advanced Manufacturing and Service Systems，發
表論文超過 290 篇，有許多本國學者參加此次會議。 
二、與會心得 本計劃研究領域為多目標演化式演算法，會議有不少相關論文研究可
供參考，其中以大阪府立大學 Hisao Ishibuchi 所討論的 Memetic Algorithms for 
Evolutionary Multiobjective Combinatorial Optimization 最具參考價值。 
三、考察參觀活動(無是項活動者略) 
四、建議 日幣匯率變化大，建議可允許挪動部分業務費以補貼出國費用。 
五、攜回資料名稱及內容  大會手冊與論文光碟 
六、其他 
計畫編號 NSC 98－2221－E－327－023  － 
計畫名稱 應用克利金預測與限制式處理於多目標模擬最佳化演算法(I) 
出國人員
姓名 郭幸民 
服務機構
及職稱 
國立高雄第一科技大學運籌管理系副教授 
會議時間 99 年 7 月 25 日至 99 年 7 月 28 日 會議地點 
Awaji island, Japan 
會議名稱 
(中文) 
(英文) The 40th International Conference on Computers and Industrial Engineering 
發表論文
題目 
(中文) 
(英文) Multi-Objective Optimization for VMI Operations in the LCD Supply Chain 
附件四 
98年度專題研究計畫研究成果彙整表 
計畫主持人：郭幸民 計畫編號：98-2221-E-327-023- 
計畫名稱：應用克利金預測與限制式處理於多目標模擬最佳化演算法(I) 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 1 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 3 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
