II 
英文摘要 
Tool dispatching and vehicle dispatching are important issues in wafer fab. 
However, they were discussed separately in the previous researches. Although the 
performanced can be improved for production or transport separatively, the operation 
between production and transport might not be cooperated in real fab. 
In this study, the integrated architecture of tool dispatching and vehicle 
dispatching is proposed. There are four procedures in the architecture include 
dispatching requests, conditions checking, dispatching mechanism and dispatching 
execution, in which dispatching mechanism is classified as five categories: 
FOUP-searches-Tool (FST), FOUP-searches-Stocker (FSS), Tool-searches-FOUP 
(TSF), FOUP-searches-Vehicle (FSV) and Vehicle-searches-FOUP (VSF). Further, 
two transport strategies, avoid blocking and avoid starvation are developed for fully 
support prodiction, and some local tool dispatching rules which are widly used in fab 
are evalueated for critical tools. The result shows that the SPT rule to serial tool and 
EDD rule to batch tool can obtain the better performance. Besides, dynamic 
dispatching developed based on classification tree which is one technique in data 
mining is used to re-assign the dispatching rule for tool under the different tool 
utilization. The result compared between static and dynamic dispatching shows that 
the dynamic dispatching is limited to improve the performance. 
 
Key words: wafer fab, tool dispatching, vehicle dispatching 
 
PDF created with pdfFactory trial version www.pdffactory.com
IV 
第六章 模擬模式發展 ............................................................................................28 
6.1 方法論 ..........................................................................................................28 
6.2 模擬模式建構 ...............................................................................................31 
6.2.1 目標系統設施規劃 ................................................................................31 
6.2.2 系統行為及物件需求分析 .....................................................................34 
6.2.3模擬模式假設 .........................................................................................40 
第七章 模擬實驗....................................................................................................41 
7.1實驗一：搬運策略 ........................................................................................41 
7.1.1 實驗目的................................................................................................41 
7.1.2 績效指標................................................................................................41 
7.1.3 實驗設計................................................................................................41 
7.1.4 實驗結果................................................................................................41 
7.1.5 實驗小結................................................................................................44 
7.2 實驗二：靜態派工 .......................................................................................45 
7.2.1 實驗目的................................................................................................45 
7.2.2 績效指標................................................................................................45 
7.2.3 實驗設計................................................................................................45 
7.2.4 實驗結果................................................................................................46 
7.2.5 實驗小結................................................................................................51 
7.3 實驗三：動態派工 .......................................................................................52 
7.3.1 實驗目的及程序 ....................................................................................52 
7.3.2 分類樹派工發展 ....................................................................................52 
7.3.3 模擬實驗................................................................................................57 
7.3.4 實驗小結................................................................................................59 
7.4 實驗討論.......................................................................................................60 
第八章 結論及建議 ................................................................................................61 
參考文獻 .................................................................................................................62 
計畫成果自評 .........................................................................................................66 
PDF created with pdfFactory trial version www.pdffactory.com
VI 
表目錄 
表 3- 1 各生產區主要派工議題 .............................................................................19 
表 6- 1 UML各觀點所使用之各種圖形 .................................................................28 
表 6- 2 機台需求規劃.............................................................................................32 
表 6- 3 整合派工之使用案例事件流程..................................................................35 
表 6- 4 整合派工模擬模式之物件階層關係表 ......................................................38 
表 7- 1 搬運策略實驗之變異數分析......................................................................42 
表 7- 2 搬運策略實驗之成對比較及 desirability多重反應 ...................................44 
表 7- 3 整合派工實驗之法則組合及績效 ..............................................................46 
表 7- 4 整合派工實驗之變異數分析......................................................................48 
表 7- 5 整合派工實驗之 desirability多重反應 ......................................................50 
表 7- 6 分類樹最終節點之條件狀況整理 ..............................................................56 
表 7- 7 各類別(節點)下之最佳派工組合 ...............................................................56 
表 7- 8 類別累計次數.............................................................................................58 
表 7- 9 靜態派工與動態派工比較 .........................................................................58 
 
PDF created with pdfFactory trial version www.pdffactory.com
2 
1.3 範圍 
晶圓廠的生產流程繁瑣，涵蓋的範圍相當廣泛，本研究主要以生產系統的派
工及搬運系統的派車為對象。為減少研究的複雜度，做出下列的研究範圍與限制： 
1. 本研究在既定的投料策略下，進行機台派工與搬運派車的研究。 
2. 本研究所探討的行為以晶圓製造廠中為主，對於後段封裝、測試等不予討論。 
 
1.4 重要性 
以往對於晶圓廠執行控制面的研究，皆將生產行為與搬運行為分開探討，但
是在 300mm以提倡無人化生產環境的晶圓廠而言，派工或是派車不當皆會影響
系統績效且若搬運派車僅考慮搬運績效而造成加工批的延遲搬運，則會導致機台
閒置及產能的損失。因此有必要將生產與搬運作適當的協調、相互支援。因此將
機台派工與搬運派車以整合的角度來探討是相當重要的議題。 
 
1.5 研究架構 
本研究首先進行文獻回顧並與晶圓廠人員進行訪談，以了解執行控制面相關
問題，並定義出研究問題及設定研究目的、發展機台派工與搬運派車之整合架
構。在所發展之整合架構下，首先實驗一，提出並評估能夠全力支援生產系統之
搬運策略，其次在實驗一所評估出之最佳搬運策略的環境下，進行實驗二機台靜
態派工法則之評估，接續實驗三根據實驗二蒐集之機台利用率資料，進行分類樹
分析以發展在動態機台狀況下的機台派工。上述實驗過程以系統模擬之方式進
行，模式建構為利用物件導向模擬軟體 eM-Plant 4.6，並利用統計軟體 Design 
Expert 6.0.4及 Statistica 6.0進行實驗設計及數據分析。研究架構如圖 1-1所示。 
 
PDF created with pdfFactory trial version www.pdffactory.com
4 
第二章 文獻回顧 
Kim，1990指出派工法則或許對系統績效的提升不如投料法則明顯，但是一
個好的投料法則若沒有合適的派工法則配合，也不能發揮投料的功效；然而，決
定派工法則，更需要派車法則來支援生產作業的順利進行。所以派工及派車的優
劣，對系統績效均扮演重要角色。 
因此第 2.1節將回顧相關派工文獻，包括一般晶圓製造廠瓶頸問題中的光罩
排程相關文獻、黃光關鍵層綁機派工文獻、爐管及蝕刻機台的批量機台派工文
獻。第 2.2節，將對搬運系統相關文獻做整理，包括 00mm搬運系統特性、搬運
車管理文獻、派車相關文獻。第 2.3 節，則回顧派工與派車的整合問題。第 2.4
節，對資料挖礦之分類樹技術做了解。 
 
2.1 派工相關 
Dabbas et al.2003提到派工法則的分類包括區域性(local)及全域性(global)，
如圖 2-1所示。 
 
Dispatching Rules
Local Rules
Global Rules
Ø Arrival Time Related
       ex : First In First Out (FIFO)
Ø Processing Time Related
       ex : Shortest Process Time (SPT)
Ø Due date Related
       ex :  Earliest Due date (EDD)
               Critical ratio (CR)
Ø Composite Related
       ex : Apparent Tardiness Cost (ATC) heuristic, Vepsalainen et al. (1987)
                 combines : Weighted Shortest Process Time (WSPT)
                                    & Minimum Slack (MS)
Ø Look Ahead
       ex : Workload Regulating (WR), Wein (1998)
              Starvation Avoidance (SA), Glassey et al. (1988)
              Minimum Inventory Variability Scheduler (MIVS), Li et al. (1996)
Ø Look Behind
       ex : Dynamic Batch Heuristic (DBH), Glassey et al. (1991)
              Next Arrival Control Heuristic (NACH), Folewr et al. (1992)
 
圖 2- 1 派工法則分類(資料來源：Dabbas et al.，2003) 
 
其中區域性法則無法考慮到機況或產品組合等不確定因素的改變，而且通常
是某一特定績效下的法則，而全域性的法則在派工決策同時，以考慮鄰近上下游
狀況為依據。 
PDF created with pdfFactory trial version www.pdffactory.com
6 
 
圖 2- 2 排程架構 (Dabbas et al.，2003) 
 
2.1.1 光罩排程相關文獻 
Chern et al.，2003提出減少黃光微影機台更換光罩(mask)次數，以提升機台
使用率的「族別為基(Family-Based)」派工法則。由於每種產品的每層光罩層之
線路圖都不同，所以需要不同的光罩，因此當加工不同產品或不同光罩層時皆需
要更換光罩。作者將使用相同光罩的晶圓批視為同族別(family)，在 CAS(current 
available set)的情況下，同族別的晶圓批優先派工。CAS的情況係指微影機台在
選擇待加工批時，優先選擇與上一個加工批為同族別的批量，若沒有同族別的產
品，則將各族別依據 FCFS、SRPT、EDD、LS 的法則，其中若優序相同，則以
FCFS方式指派。 
作者另外發展族別為基之步進機派工法 (Family-Based Stepper Dispatch 
Algorithm；SDA-F)，除了先將晶圓批分族別外，並將光罩層分為關鍵層(critical 
layer)與非關鍵層(non critical layer)，關鍵層的加工時間根據 w値(加工時間
threshold)再分為兩群：group 1> w；group 2 £ w。在 SDA-F法則下，派工優序為：
CAS-> group 1-> group 2->非關鍵層產品，各群間指派又以餘裕値(slack value)越
小越優先。 
PDF created with pdfFactory trial version www.pdffactory.com
8 
2.1.2 綁機派工相關文獻 
Akcalt et al.，2001提出兩種綁機策略： 
(1) 綁機(dedicated assignment policy)：所有層別(layer)皆在同一台微影機台加
工； 
(2) 非綁機(flexible assignment policy)：任何層別(layer)皆可在任一台微影機台上
加工。 
綁機策略下的晶圓批以一批一批平均分配到所有微影機台上的方式來平衡
機台負荷；另外派工法則採先進先出(FIFO)之方式。模擬指出，綁機限制下的週
期時間顯著增加，不同機台故障時間(MTBF、MTTR)對綁機限制下的平均週期
時間及週期時間變異皆有顯著影響。 
黎翠綾，2000 提出在黃光區機台群組限制下的投料派工模式。機台群組係
指當產品在某一台微影機台上加工第一關鍵層後，其後續關鍵層皆須限定在相同
的機台上加工。研究所提出之投料模式建立在綁機的基礎上，為利用 Lou et al.，
1989提出的雙界法(Two Boundary，TB)的概念，考慮再回流(re-entrant)的製程特
性，及將可綁機之微影機台視為不同的生產線的環境下，針對每一台可加工關鍵
層的機台，計算總時間負荷及區間時間負荷之界限值，並與目前實際的總時間負
荷與區間負荷作比較，在實際負荷皆小於負荷界限值的情況下，表示可投料於系
統中。進一步根據目前的負荷程度，計算可再接受的負荷量，並將可再接受負荷
之機台，依其可再接受之負荷量由大到小作排列，最後依據每日排定的生產計
劃，以負荷平衡的方式投入各關鍵層微影機台，且此晶圓批之關鍵層則皆限在該
機台上作業；若生產計劃投入量超過綁機機台負荷，則當日不投入，視次日生產
狀況投入。此法則為根據各關鍵層微影機台之負荷計算產品何時可投入系統，並
且投入的同時就已經決定所有關鍵層之綁機機台。 
楊桂峰，2003 提出以流量平衡為導向的黃光區綁機派工法。綁機機台的派
工模式，為考量避免綁機機台飢餓，以及使各產品之各關鍵層在製品流入速度皆
能維持相同的目標下進行派工。其流量平衡的方法為以 Little’s  law中 WL ´= l
的概念來解釋。其中 L表示該關鍵層的在製品(WIP)數目、 l表示單位時間進入
系統的速度、W 表示該關鍵層的生產週期時間(CT)。因此各關鍵層的流量平衡，
可由各關鍵層在製品數與生產週期時間之比値的控制來達成。其層別(layer)的定
義及所表示的流量平衡如下圖 2-5。WIPL1 / CTL1 = WIPL2 / CTL2 = … = WIPL3 
/ CTL3，其中WIPLi：表示第 i關鍵層的總在製品數；CTLi：表示第 i關鍵層的
生產週期時間。 
PDF created with pdfFactory trial version www.pdffactory.com
10 
2.1.3 批量機台派工文獻 
批量機台由於需進行集批加工、加工時間需6~12小時，以及晶圓批由上游蝕
刻機台來到後，等候加工時間的限制，因此在派工上衍生許多議題，包括集批批
數、如何進行集批、等候多久即必須進入爐管機台加工等等。 
Weng et al.，1993提出MCR(minimum cost rate)，利用批量的到達資訊來改善
派工法則在批量機台的應用，為利用未來在製品(future WIP)到達的資訊，來最小
化在工作站等候區的加工批數。此方法是透過在一排程時間內選擇一週期開始時
間，讓總加工批單位等候時間最小。 
在單一爐管及單一產品的加工過程中，當等候線上的批量小於爐管的容量
時，根據爐管的加工時間及未來可能到達的批次數量，計算原來等候線上既有批
次數量的等候時間，在開始進行加工之前新進入等候線的批次數量的等候時間，
以及爐管開始進行加工以後至完成時，才進入等候線的批次數量的等候時間，三
項數值和可視為這段期間的總持有成本，將總持有成本除以這段期間所花的時
間，即成本比率，如此可依最小成本率作為派工的依據原則。 
在單一爐管及多樣產品的加工過程中，假如等候線上的所有不同產品的數量
小於爐管的加工容量，則所有數量皆可進入加工程序; 但當等候數量超過設備容
量時，則依不同產品別，算出每項產品最低的成本率做比較，選出最低的產品為
優先派遣，而該項產品中的派工原則，其順序同單一產品派工時之派工原則，而
選擇的數量，一直到滿足單一爐管可納容量為止。 
Wolfgang Scholl和 Joerg Domaschke，2000提出以時間限制為基礎的批量機
台派工方法。在濕蝕刻與高溫爐管製程中間，必須在一定時間內進入爐管之作
業，其間需避免晶圓表面之氧化或是遭受污染，否則將可能導致晶圓之報廢或需
重工，即所謂 Time Window’s Constraint。 
 
圖 2- 7 時間窗限制示意圖(Wolfgang Scholl 和 Joerg Domaschke，2000) 
PDF created with pdfFactory trial version www.pdffactory.com
12 
Kaempf，1997提出天井式的自動化物料搬運系統架構，其 interbay與 intrabay
系統採分離式與整合式混何的結合方式，圖 2-9所示。由此系統架構可顯示出：
(1)藉自動化設備或是人力上下載加工批的裝置，形成 intrabay 系統、(2)interbay
與 intrabay系統藉由倉儲或是轉車台(turn table)來連結、(3)利用自動化設備與人
力混何的上下載裝置，連結兩個 intrabay系統以形成迴圈、(4)供搬運車停車的迴
圈及由天井式軌道將搬運車卸下的車站、(5)倉儲系統存在於 interbay 系統與
intrabay系統交接處，或是存在於 intrabay系統內。如此的 interbay與 intrabay結
合方式，可藉由倉儲的輔助或是直接將加工批搬運至機台。 
 
 
圖 2- 9 天井式 AMHS架構(Kaempf，1997) 
 
2.2.2 搬運車管理文獻 
隨著晶圓廠全面自動化的來臨，晶圓在製造過程中的傳送大多倚賴自動搬運
車的輔助，然而，面對搬運系統中眾多的搬運車，如何設計以避免車輛碰撞、死
鎖或壅塞情形而導致搬運系統癱瘓，有效管理車輛的派送、途程等問題，都是規
劃時需注意的地方。 
陳紹偉，1999 針對 300mm 晶圓廠自動化物料搬運系統可能會發生的壅塞
(blockage)及死鎖(deadlock)現象提出解決的方法。對於壅塞問題，其提出 PV(Push 
Vehicle)法則，將阻擋在執行搬運任務車輛之前，停靠在軌道上等待搬運任務的
車輛往前推進(push)，保持軌道的暢通藉以降低搬運時間。對於死鎖問題，其提
出 STS(Send to Stocker)法則，當負載加工批之搬運車的目的地無法卸載加工批
時，先將加工批送往 Stocker 暫存，避免因為無法卸載加工批而導致系統績效降
低。經由模擬的結果發現，將過去在無人搬運車系統裏表現良好的派車法則
(Nearest Vehicle及 FIFO)搭配 PV及 STS法則，無論是在晶圓產出量或搬運時間
都有最佳表現。 
PDF created with pdfFactory trial version www.pdffactory.com
14 
法則，從所有尚未被指派任務的車中，選擇一台空車來執行此搬運任務。當空車
多且待搬運的工件少時，適合此派車法則。工作站起始之任務指派問題也被稱作
工件選車問題(Task Search Vehicle)。所提出的派車法則有 Random Vehicle(RV) 
rule、Nearest Vehicle(NV) rule、Farthest Vehicle(FV) rule、Longest Idle Vehicle(LIV) 
rule和 Least Utilized Vehicle(LUV) rule。 
2. 以車為起始之任務指派問題(Vehicle initiated task assignment problems) 
是指當某一車子完成一個搬運任務後，車子即會根據某一選取法則，如：車
子行走的距離、加工中心的輸出暫存區之狀態等，從等待搬運的工件中，選擇最
適合的一個來進行搬運。通常發生在車大多滿載的情形之下。以車為起始之任務
指派問題也被稱作車選工件問題(Vehicle Search Task)。其所提出的派車法則有
Random work centre(RW) rule、Shortest Travel Time/Distance(STT/D) rule、Longest 
Travel Time/Distance(LTT/D) rule、Maximum Outgoing Queue Size(MOQS) rule、
Minimum Remaining Outgoing Queue Space(MROQS) rule、Modified First 
Come-First Serve(MFCFS) rule和 Unit Load Shop Arrival Time(ULSAT) rule。 
Egbelu, P. J.，1987指出先前所提出的派車法則，不論是工件選車或是車選
工件都是來源導向式(source driven)派車法則。但是 JIT是屬於需求導向的製造系
統，亦稱為拉式(pull)生產系統，並不適用來源導向式(亦稱為推式)的派車法則，
所以提出需求導向派車法則，其強調的重點是當進行派車時，所考量的因素是以
工作站的需求為依據。即需求導向的派車是當車子尋找搬運任務時，首先考慮所
有工作站的需求並從中挑選一個合適的工作站來服務，然後從所有等待搬運的工
件中選擇一個最合適此工作站的工件來進行搬運(被選擇的工件可能不是位於輸
出口的第一個，所以若是採用需求導向派車法則就需要加設工件選取機制)。而
來源導向派車即是選擇某一待搬運的工件後，再決定其目的地。 
Yim, D. S.和 Linn, R. J.，1993指出推式與拉式派車法則的最大差異在於選擇
工件(part selection)與選擇製程(process selection)的順序。推式派車法則是先選擇
合適的工件來搬運，再決定工件的目的地(下一個製程)。拉式派車法則是先選擇
最迫切需要工件的製程，再從所有待搬運的工件中選擇最合適此製程的工件來搬
運。經過斐氏圖為基礎的模擬(Petri-net-based simulation)，一個搬運量高的彈性
製造系統中，不論推式或拉式的派車在產出率方面都差不多。 
LIN, J. T. et al.，2001將派車法則應用於雙迴圈式自動化物料搬運系統，針
對系統環境的變化而引發加工批選車或是車選加工批法則。其使用多種傳統上廣
被討論之加工批選車及車選加工批法則，形成多個派車法則組合，探討 8種包含
軌道選擇、加工批選車及車選加工批機制之派車法則的績效表現。經由模擬分析
之結果顯示，在 9種環境下(3種車數*3種來到率)，採用 Shortest Distance-Nearest 
Vehicle/First Encounter First Service派車法則(其中 SD-NV是指加工批選車時，先
選擇搬運距離最短之軌道，再選擇最近之車輛；FEFS 是車選加工批法則，一遇
PDF created with pdfFactory trial version www.pdffactory.com
16 
 
圖 2- 11 狀態相依之派工法則分類樹  (Jonah C. Tyan et al.，2004) 
 
2.4 資料挖礦與分類樹(分類樹)相關 
近幾年來，資料挖礦技術引起業界很大的關注，主要是因為以往工程師或領
域專家往往無法從所收集的龐大資料中，迅速有效的分析出所需要的知識。現
今，藉由資料挖礦技術，將可對現存的大量資料轉換成有用的資訊。 
Jiawei Han和Micheline Kamber，2003在著作中提到，資料挖礦是從大量資
料中存取或探勘知識，也被視為知識發現過程的步驟。該步驟包括： 
(1)資料清理(data cleaning)：消除雜亂或不一致的資料。 
(2)資料整合(data integration)：將多種資料來源組合在一起。 
(3)資料選擇(data selection)：從資料庫中搜尋分析與任務相關的資料。 
(4)資料轉換(data transformation)：將資料轉換成統一或合適於探勘的形式。 
(5)資料探勘(data mining)：利用智慧方法存取資料模式。 
(6)模式評估(pattern evaluation)：根據有趣度度量，辨識並表達知識真正有趣的模
式。 
(7)知識表達(data knowledge presentation)：視覺和知識表達技術，向使用者提供
探勘出的知識。 
PDF created with pdfFactory trial version www.pdffactory.com
18 
性出現在一個節點上，就不必再考慮該節點的任何後代上。 
(6) 遞迴劃分步驟僅在當下列條件之一成立時才停止： 
(a) 給定節點的所有樣本都屬於同一類時； 
(b) 沒有剩餘屬性可被用來作進一步劃分樣本。在此情況，將使用多數表決
(majority voting)，這涉及到將給定的節點轉換成分類樹葉，並用樣本中多
數所在的類別來標記，或可以用在存放節點樣本的類別分佈。 
(c) 已經沒有樣本給分支，在這種情況下，以樣本中的多數類別建立一個分類
樹葉。 
PDF created with pdfFactory trial version www.pdffactory.com
20 
工及派車策略上更顯重要。集批策略的問題包括： 
l 最大集批批數： 
當集批數已經達最大集批數(6 批)，則可執行派工及派車將加工批送至機
台加工。最長等候時間：當集批數未達集批標準(4~6 批)，但是等候集批
時限已到，則需評估直接送入爐管加工，或回到上一道製程再重加工。 
l 集批等候時限(5)、(7)問題： 
集批等候時限問題則是發生在當加工批要進爐管機台前，需藉由濕蝕刻機
台將晶圓片表面的氧化物洗去，如此經由爐管機台進行長膜時，才不致因
品質不良而報廢。而經由濕蝕刻機台洗去氧化物，需在時間限制內進入爐
管加工，否則仍回有氧化物生成。 
(8)爐管機台備管： 
爐管機台內設有內部暫存區(Internal Buffer)，以便於在加工當時進行備管的動
作，減少產能的損失。因此何時開始需要備管，以及對爐管機台進行搬運派
車時，是一項突發性的大量搬運需求，對機台派工及搬運派車都是極大的影
響。 
由上述特徵，本研究將生產機台分為兩類，為序列(serial)機台及批量(batch)
機台。其中序列機台為晶圓片皆一片片加工，而批量機台需集批完成後加工，除
非是已達等待時間上限或其他因素，例如：急批(priority lot)，才允許在未完成滿
批情況下加工。 
 
3.2 搬運系統 
本研究對象之 300mm晶圓廠自動化物料搬運系統軌道的佈置規劃，經簡化
如圖 3-1。此搬運系統包括有 interbay以及 intrabay系統，其中 interbay系統的主
體是採用脊椎式(spine)的軌道佈置，intrabay與 interbay的軌道是採取直接連接的
方式，因此搬運車可以藉由控制程式活動於 intrabay及 interbay系統間。intrabay
並設有迴轉軌道(intrabay U-turn)，以利於搬運車迴轉進行 intrabay系統內(within 
bay)的搬運。而搬運策略上是採用單軌天井式的 OHT 搬運車，藉此搬運車可自
行對機台或倉儲系統的自動化載入埠(load port)進行上下載加工批的動作。另
外，加工中心前端皆設有兩座倉儲(stocker)系統，以作為暫存加工批或轉運的功
能。 
因搬運系統具有不同加工中心間將加工批由機台直接傳送至機台的能力，所
以搬運車可直接將加工批搬運至機台，但倉儲仍扮演暫存加工批或協助加工批轉
運的角色，因此面對 interbay及 intrabay系統軌道時，皆須設置自動化載入埠(load 
port)，以利暫存及轉運的執行。 
PDF created with pdfFactory trial version www.pdffactory.com
22 
1. 進行機台派工時的兩種情況： 
(1) 加工批尋找機台(FOUP-Searches-Tool；FST) 
當加工批完成加工後，在下一道製程有多台機台可以選擇進行加工時，
該如何決定機台。 
(2) 機台尋找加工批(Tool-Searches-FOUP；TSF) 
當機台加工完處於閒置狀態，且有多加工批等待加工時，該選擇哪一批
加工批進行後續加工。 
2. 進行搬運派車時的兩種情況： 
(1) 加工批尋找搬運車(FOUP-Searches-Vehicle；FSV) 
當加工批完成加工，需藉由搬運車搬運道下一道製程進行加工時，若有
多台限制的搬運車，該選擇哪一台搬運車執行搬運命令。 
(2) 搬運車尋找加工批(Vehicle-Searches-FOUP；VSF) 
搬運車完成搬運命令正處於閒置狀態時，且有多批加工批等待搬運時，
搬運車該選擇哪一批加工批進行搬運。 
在搬運派車該考量的問題不當僅是晶圓批當時的狀態，例如等待時間，而也
當評估目前機台對晶圓批的需求緊急程度，以避免機台產能的損失。 
瞭解上述搬運及生產特性，接續的問題包括： 
1. 定義機台派工的運作 
2. 定義搬運派車的運作 
3. 定義機台派工與搬運派車間的相互運作 
PDF created with pdfFactory trial version www.pdffactory.com
24 
一批晶圓批進行加工。 
(4) FSV：晶圓批定義閒置搬運車為候選搬運車，並根據FSV法則指派一台搬運
車執行搬運。 
(5) VSF：搬運車根據晶圓批特性，定義出候選待搬運晶圓批，並根據VSF法則
指派一批晶圓批進行搬運。 
上述 VSF 實為 Egbelu and Tanchoco (1984)所提之搬運車初始之派車問題
(vehicle-initialed dispatching)，因此當晶圓批滿足某些”條件”時，將有較高的搬
運優序，亦即，這些晶圓批在 VSF 階段會被選為候選搬運批。該”條件”將定
義於第五章之搬運策略發展中。 
最後一階層為派工/派車執行(dispatching execution)，其中經過上述四階層的
診斷之後，生產、搬運或儲存將會被執行。四階段整合程序如圖 4-1所示。 
Serial 
process?
Is there 
available port 
of the 
Downstream 
Tool?
yes
yes
yes
no
FST mech.
Is there 
available port 
of the Current 
Tool?
no
Waits on the 
current tool
Waits for 
TSF
e1
FSS mech.
Batch processno,
Is the available 
port number of 
the Downstream
>= batch size? no
Waits for 
TSF
Waits on the 
current stocker
e3
yes
Is there any 
idle vehicle?
FSV mech.
yes
Waits on 
the current 
location
Waits for 
VSF
no
Is there any 
WIP waiting 
for transport?
VSF mech.
Vehicle 
becomes idle 
(available)
Waits for 
FSV
yes
no
Transport
execution
Production
execution
yes
no
Store
push
push
e4
Is the 
destination tool?
Serial 
tool?
yes
Is there any 
WIP queuing 
in front of it?
yes
TSF mech.
Is the number
of available port 
>= batch size?
Is there any 
batch WIP
queuing?
no, 
Waits for 
FST
Port becomes 
idle (available)
e2
Batch tool
yes
no yes
no
no
pull
e1 FST mech.階段一: dispatching requests
階段二: conditions checking
階段三: dispatching mechanism 
階段四: dispatching execution
 
圖 4- 1整合架構圖 
PDF created with pdfFactory trial version www.pdffactory.com
26 
第五章 搬運策略發展 
搬運需求不僅是搬運待加工晶圓批至其下游機台，另外還需要進行一些”活
動(activity)”像是排除生產障礙。本研究所提出搬運策略為以後者為重點。 
另外，Egbelu and Tanchoco (1984)提出在較忙碌的生產系統中，搬運車初始
的派車的法則顯著影響產出，且建議搬運派車對於晶圓批的搬運優序應不同於生
產派工對於晶圓批的生產優序，該搬運優序應該被重新調整。二項搬運策略於本
研究中被提出，說明如下。 
 
5.1 避免壅塞(Avoid Blocking) 
該策略為避免機台之壅塞使生產更流暢。其作法為利用對port使用狀態之偵
測來避免。機台之port 有五種使用狀態，說明如下。 
(1) Pa: 可指派(available)之port，該port目前為閒置況態且可接受生產指派 
(2) Pr: 已被預約(reserved)之port，預約該port之FOUP正在被搬運至該機台的途中 
(3) Pp: 正加工(process)之port，該port上之FOUP內的晶圓片正在進行加工。 
(4) Pn: 等待加工(in)之port，該port上之FOUP內的晶圓片正等待進入機台加工。 
(5) Po: 等待搬運(out)之port，該port上之FOUP已加工完成，正等待搬離機台。 
 
上述port的使用狀態會動態的改變且僅為上述五種狀態其中之ㄧ種。nPa、
nPr、nPp、nPn、nPo分別為Pa、Pr、Pp、Pn、Po的數量，而可指派之port數量 nPa 
= nP - nPr - nPp - nPn - nPo ，其中 nP 為該機台之總port數量。壅塞發生的情況
定義為(1) nPa = 0 (2) nPo > 0 (3) 目前有晶圓批需送至該機台加工。則在機台 Po 
上等待被搬運的晶圓批定義為”壅塞晶圓批(blocking FOUP)”。 
例如圖5-1之機台有4個port，nP = 4，且晶圓批 f5 和 f6 目前暫存於晶圓廠
內某處(機台或倉儲系統)，且已被排定進入該機台加工。機台上，f3 正在加工、
f1 排定於 f3 後加工、f2 已經完成加工並於port上等待搬運，另外搬運車正搬運 f4 
至機台。則此時 nPn、nPp、nPr、nPo 皆為1。因此目前沒有可指派之port。在此
例中，機台壅塞發生，因為 nPa = 0、nPo = 1 > 0 且 f5 和 f6 還在等待被搬運至
機台加工。此時，壅塞晶圓批(blocking FOUP)為 f2，且在 f2 還未搬離該機台之
前，f5 和 f6 需持續等待。 
因此策略”避免壅塞(Avoid Blocking)”會給定一個較高的搬運優序給”壅塞晶
圓批”，使得機台壅塞的狀態能被排除且使下一批加工批能順利辦運至機台加工。 
 
PDF created with pdfFactory trial version www.pdffactory.com
28 
第六章 模擬模式發展 
6.1 方法論 
在多種方法論中，由世界級物件導向方法研究機構 Rational軟體公司於 1996
整合三位物件導向方法論大師 Booch、Rumbaugh 及 Jacobson 所提出的
Booch(1994)、OOSE(Object-Oriented Software Engineering, 1991)、OMT(Object 
Modeling Technique, 1991)方法論，成為統一化模式語言 (Unified Modeling 
Language, UML)。亦由國際物件管理組織(Object Management Group, OMG)於
1997年 11月接受為物件導向之標準模式語言，成為設計者共同語言。而以物件
(object)為中心的物件導向技術，強調物件及系統的可再利用、可擴充、易維護等
特性(郭曜賑，1999)。 
UML 是一種模式語言，其並非程式語言也不是一種設計方法(Method)。一
般而言，方法至少要包括一個模式語言及一個程序(process)。模式語言是一種大
部分利用"圖形"的方式來把設計表達出來的表示法；程序則是指在設計過程中這
個方法所建議採用的進行步驟(Martin Fowler & Kendall Scott，1998)。 
UML 基本上是將系統視覺化和文件規格所用的符號加以統一，其模型的觀
點，取決於不同的使用者是以哪種觀點來檢視系統的結果；不同的觀點來檢視所
發展的軟體系統，其所需要的圖表也不同。UML 的五種模型觀點及提供的九種
圖形如表 6-1。其中，UML的關鍵特性之ㄧ就是其以使用案例圖以擷取系統的功
能需求，也是系統發展其他工作的基礎(Kendall Scott & Martin Fowler，2001)。 
表 6- 1 UML各觀點所使用之各種圖形 (張正源，2005、吳仁和，2005) 
觀點(view) 圖形(diagram) 功能 
使用者模型 使用案例圖(Use Case Diagram) 系統行為者與系統之間之互動行為關係。 
類別圖(Class Diagram) 物件類型之結構上的關連。 
結構模型 
物件圖(Object Diagram) 系統於某一時間點的靜態資料結構。 
循序圖(Sequence Diagram) 
系統運作時，物件間的動態互動行為。著重時
間先後順序 
合作圖(Collaboration Diagram) 
系統運作時，物件間的動態互動行為。著重相
關物件間的連結結構。 
狀態圖(State Diagram) 物件在其生命週期中的狀態變化。 
行為模型 
活動圖(Activity Diagram) 執行某一作業行為中之活動、轉換與條件。 
實作模型 元件圖(Component Diagram) 系統設計過程中，各類別與物件的配置。 
環境模型 佈署圖(Deployment Diagram) 
系統各軟體元件的配置、關聯，及同一處理器
內執行處理的時程安排等。 
PDF created with pdfFactory trial version www.pdffactory.com
30 
名詞，定義了一群具有共同特性的物件。因此類別是物件的抽象，物件是根據類
別定義的屬性所衍生出的實體(instance)。類別可以有子類別(child class)及父類別
(parent class)，並形成階層(hierarchical)結構，而一般化(generalization)及特殊化
(specialization)是在建立父子類別關係中的主要觀念。另外，繼承性(inheritance)
是父類別與子類別間共享屬性和方法的機制(林則孟，2001、張正源，2005)。 
 
交通工具
陸上交通工具 海上交通工具 空中交通工具
客機 直升機遊艇客船巴士 轎車
一般化
特殊化
(父類別)
(子類別) (父類別)
(子類別)  
圖 6- 2 類別階層與關係之例 
類別圖(Class Diagram)則是顯示一群類別以及這些類別間的各種關係。當須
顯示發展中系統的結構，類別圖是最主要的作法。類別圖中類別的表示法如圖
6-3(a)，一個簡單的例子如圖 6-3(b)。若只有類別，通常無直接用途，而類別間
的各種關係才是系統結構的基礎，其符號如圖 6-3(c)。 
名稱 (class name)
屬性 (attribute)
操作 (operation)
(a) 汽車
屬性︰四個輪子
1. 向前開
2. 向後退
3. 煞車
操作︰
(b) (c) 關聯 (association)
聚合 (aggregation)
一般化 (generalization) 
 
圖 6- 3 類別圖之表示法、例子及關連 
根據類別圖之分析，除了可找出系統中的類別，亦可定義出類別間的關係，
包括階層結構(父子關係)及繼承關係，並進一步發展系統所需物件。藉由物件的
再使用(reuse)特性，可增加構模的正確性及速度。 
本研究之模擬模式之發展應用 UML之使用案例圖及類別圖進行系統分析，
包括行為及結構分析，程序如圖 6-4。在應用兩種圖進行分析前，首要需瞭解系
統中晶圓批生產與搬運的行為，與相互運作程度。 
 
行為分析 結構分析
使用案例圖 (Use Case Diagram) 類別圖 (Class Diagram) 
行為邏輯撰寫 系統物件建構
300mm 晶圓廠模擬模式  
圖 6- 4 模擬模式發展架構 
PDF created with pdfFactory trial version www.pdffactory.com
32 
WS
DF
ET
PH
Wx
IxDx
Px
Ex
Tx
Qx
Mx
Cx
TF
CMP
IMP
Cu
QC
Area:
tool              stocker              track              track direction
shortcut
bypass
intrabay track
interbay track
stop point
Dx
Dx
Dx
Dx
Dx
Dx
Dx
Dx
Dx
Dx
Ix
Ix
Ix
Ix
Dx
Dx
Tx
Tx
Tx
Tx Cx
Cx
Ix
Ix
Ix
Ix
Ix
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Cx
Cx
Cx
Cx
Px
Px
Px
Px
Px
Px
Px
Ex
Ex
Ex
Ex
Ex
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Tx
Dx
Dx
Dx
Px
Px
Px
Px
Px
Px
Px
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Ex
Px
Px
Px
Px
Px
Px
Px
Px
Px
Px
Px
Px
Px
Px
Ix
Ix
Ix
Ix
Ix
Wx
Qx
Qx
Mx
Mx
Cx
Cx
bay1bay2bay3bay4bay5
bay6bay7bay8bay9bay10
 
圖 6- 5 特徵化之 300mm晶圓廠設施規劃 
 
表 6- 2 機台需求規劃 
機群數量 機台數量 關鍵機群 
生產區 
生產機台 檢驗機台 總數 生產機台 檢驗機台 總數 總數 利用率% 
WS(下線) 1 0 1 1 0 1 0  
TF(薄膜沉積) 15 1 16 30 1 31 1 84.01 
ET(蝕刻) 14 5 19 34 6 40 5 83.98 
DF(爐管) 9 2 11 13 2 15 1 82.12 
PH(黃光) 6 6 12 15 13 28 2 84.46 
IMP(離子植入) 5 0 5 14 0 14 2 86.86 
CMP(研磨) 2 0 2 2 0 2 0  
CU(銅製程) 2 2 4 6 2 8 0  
QC(檢驗) 0 2 2 0 2 2 0  
Total 54 18 72 115 26 141 11 84.29 
 
PDF created with pdfFactory trial version www.pdffactory.com
34 
由於製程機密限制，僅一種產品(製程)考慮於本研究中。其中投片策略(wafer 
release policy)為採用(Glassey & Resende 1988)提到之 uniform loading (UL)方式，
即為固定期間內投入固定量之晶圓片於系統中。而搬運車之旅成路徑為根據最短
距離之路徑，令避免搬運車衝撞為利用軌道之區段控制(zone control)。 
 
6.2.2 系統行為及物件需求分析 
l 系統行為分析：使用案例圖(Use Case Diagram) 
根據使用案例圖之分析找出行為者(actor)包括：晶圓批(FOUP)、搬運車
(vehicle)、機台(machine)、倉儲(stocker)、軌道系統(track system)；使用案例包括：
晶圓批搜尋機台、晶圓批搜尋搬運車、晶圓批搜尋倉儲、機台搜尋晶圓批、搬運
車搜尋晶圓批、批量加工及批、軌道分流，如圖 6-7，並輔以使用案例事件流程
將使用案例之程序簡述如表 6-3。使用案例中所示之法則包括 FST、FSV、FSS、
TSF及 VSF。各使用案例的觸發時機，也指出了機台派工與搬運派車的推式(Push)
與拉式(Pull)運作，並由事件”FOUP完成某加工步驟，由機台送至 Out Put Port
時”，牽動整個機台派工與搬運派車的運作。 
 
PDF created with pdfFactory trial version www.pdffactory.com
36 
使用案例 
名稱 
FSS (FOUP-Searches-Stocker)：晶圓批搜尋倉儲 
行為者 晶圓批、機台、倉儲 
目標 晶圓批搜尋並選擇合適之倉儲進行儲存 
主事件流程 1.使用案例發生於當晶圓批加工完某步驟，送至機台 Out Put 
Port，且下一加工步驟之機群"無"機台閒置時；(2)該晶圓批需
集批加工時。 
2.依據系統指定的 FSS法則，指派合適之倉儲進行存放。 
3.倉儲指派完成，使用案例結束。 
使用案例 
名稱 
TSF (Tool-Searches-FOUP)：機台搜尋晶圓批 
行為者 晶圓批、機台、倉儲 
目標 機台搜尋並選擇合適之晶圓批進行加工 
主事件流程 1.使用案例發生於當機台加工完某晶圓批，正處於閒置狀態時。 
2.依系統指定的MSF法則，指派倉儲或機台上未被指派且合適的
晶圓批。 
3.晶圓批指派完成，使用案例結束。 
使用案例 
名稱 
FSV (FOUP-Searches-Vehicle)：晶圓批搜尋搬運車 
行為者 晶圓批、搬運車、機台、倉儲、軌道系統 
目標 晶圓批搜尋並選擇合適之搬運車執行搬運任務 
主事件流程 1.使用案例發生於(1)當晶圓批加工完某步驟，送至機台 Out Put 
Port，且已有指派之下步驟加工機台或倉儲時；(2)當晶圓批由
倉儲內送至倉儲 Out Put Port，且已被該下步驟加工機台指派
時。 
2.依據系統指定的 FSV法則，指派合適之搬運車。 
3.當指派之搬運車到達並將晶圓批由 Out Put Port上載至車時，使
用案例結束。 
使用案例 
名稱 
VSF (Vehicle-Searches-FOUP)：搬運車搜尋晶圓批 
行為者 晶圓批、搬運車、機台、倉儲、軌道系統 
目標 搬運車搜尋並選擇合適之晶圓批執行搬運 
主事件流程 1.使用案例發生於當搬運車完成某搬運任務，正處於閒置狀態時。 
2.依據系統指定的 VSF法則，指派於(1)機台 Out Put Port或(2)倉
儲 Out Put Port上，且未被指派之待搬運晶圓批作為下一搬運任
務。 
3.當搬運車到達所指派之晶圓批所在地並完成上載時，使用案例
結束。 
PDF created with pdfFactory trial version www.pdffactory.com
38 
 
圖 6- 8 整合派工模擬模式之類別分析圖 
 
表 6- 4 整合派工模擬模式之物件階層關係表 
模擬模式物件庫  模擬模式物件庫 
level 3 level 2 level 1 
功能 eM-Plant 
基本物件  level 3 level 2 level 1 
功能 eM-Plant 
基本物件 
FOUP   晶圓批  Entity   
TTrack 
(Machine Track) 機台軌道  Frame 
OHT   搬運車  
Transp
orter    Track 軌道  Track 
Fab 
(300mm Fab)  晶圓廠 Frame    InPort 輸入口 Buffer 
 Stool (Serial Machine) 序列機台 Frame    OutPort 輸出口 Buffer 
  InRead 讀取程式 Buffer  Interface 
  chamber 加工處 
 
Single
Proc  
  Branch 軌道分流  
 Connector 
  OutRead 更新資訊 Buffer   STrack (Stocker Track) 倉儲軌道  Frame 
 BTool (Batch Machine) 批量機台 Frame    Track 軌道  
Track 
  InRead 讀取程式 Buffer    InPort 輸入口 Buffer 
PDF created with pdfFactory trial version www.pdffactory.com
40 
6.2.3模擬模式假設 
本模擬模式有下列假設： 
(1) 爐管及黃光機台有4個port，其他機台有3個port。 
(2) 集批數量(batch size)為4批。 
(3) 晶圓批需再倉儲系統進行集批。 
(4) 加工時間為常數，沒有整備時間(set-up time)，沒有重加工(reworking)及良率
損失(yield loss)。 
(5) 機台及倉儲效率(efficiency)為100%。 
(6) 倉儲系統容量無限大(capacity is infinite)。 
(7) 搬運車行駛速率2公尺每秒(2m/sec)，加速度及減速度忽略。 
(8) 搬運車上載及卸載晶圓批至機台或倉儲系統之時間為20秒。 
(9) 閒置機台運行於interbay系統 
(10) 搬運車效率(efficiency)為100%，且不需充電。 
(11) 機台在同一時間中，只能由一台搬運車進行存取。 
PDF created with pdfFactory trial version www.pdffactory.com
42 
數之假設(Montgomery 2001)。表7-1中之ANOVA分析顯示因子A、B及其交互作
用在95%信賴水準下顯著影響績效產出(WO)、週期時間(CT)。這結果說明壅塞
(blocking)、飢餓(starvation)對績效指標之影響極為重要。 
 
表 7- 1 搬運策略實驗之變異數分析 
(a) Response: WO 
Source SS DF MS F-Value Prob > F  Contrib. (%) 
Model 112500 3 37500 257.14 < 0.0001* significant  
A 100000 1 100000 685.71 < 0.0001*  84.93 
B 6250 1 6250 42.86 < 0.0001*  5.31 
AB 6250 1 6250 42.86 < 0.0001*  5.31 
Pure Error 5250 36 145.83   R2: 0.9554 
Cor Total 117750 39    Adj R2: 0.9517 
 
(b) Response: CT 
Source SS DF MS F-Value Prob > F  Contrib. (%) 
Model 108.79 3 36.26 491.41 < 0.0001* significant  
A 5.21 1 5.21 70.54 < 0.0001*  4.67 
B 61.08 1 61.08 827.77 < 0.0001*  54.81 
AB 42.50 1 42.50 575.91 < 0.0001*  38.13 
Pure Error 2.66 36 0.07   R2: 0.9762 
Cor Total 111.44 39    Adj R2: 0.9742 
*=significant at 95% confidence level 
 
另外，若交互作用具有顯著影響，則交互作用的解釋甚而比主效應的解釋更
為重要(Montgomery 2001)。其中主效應及交互作用項之圖顯示於圖7-1中。在產
出(WO)極大方面，圖7-1(a.3)之AB交互作用圖說明A在A1及不論B為何水準有較
大產出，呼應了表7-1(a)中因子A對產出達84.93%的重要貢獻度；而在週期時間
(CT)極小方面，圖7-1(b.3)之AB交互作用圖說明因子B之水準在因子A為A2時有較
大影響，且A在A2及B在B1時能有較短之週期時間，圖中交互作用(強)趨勢也呼應
表7-1(b)中，交互作用對週期時間有38%的貢獻度。縱合上述討論，較佳產出發
生在A為A1時，而較佳週期時間發生在A2B1，因此將進一步將兩績效指標整合以
決定較佳之搬運策略組合。 
 
PDF created with pdfFactory trial version www.pdffactory.com
44 
表 7- 2 搬運策略實驗之成對比較及 desirability多重反應 
A: B: WO (pieces) CT (hrs) 
Scenario 
Blocking Starvation mean rank mean rank 
Desirability 
1 A1 B1 6020 A 704.922 B 0.781316 
2 A1 B2 6020 A 705.332 C 0.735189 
3 A2 B1 5945 B 703.582 A 0.636452 
4 A2 B2 5895 C 708.115 D 0.095185 
 
最後，提供模式方程式(model equations)用以預測各個有興趣之策略組合。
因各因子為類別因子，因此以編碼(code)方式表示因子水準。因子A為A1：-1、
A2：1；因子B為B1：-1、B2：1。 
1. WO = 5970.00 -50.00*A -12.50*B -12.50*A*B 
2. CT = 705.49 +0.36*A +1.24*B +1.03*A*B 
此模式方程式(model equations)也可提供決策者，根據所期望的績效指標，
選擇動態生產環境下之適合於該環境之策略組合。 
 
7.1.5 實驗小結 
針對上述結果分析，進一步討論如下 
(1) 策略組合 A1B1相較於目前搬運運作 A2B2，可以用來提升系統績效，另外也
說明現行運作策略不合適。 
(2) 機台壅塞必須避免，而後避免機台飢餓能更有效發揮其效用。換句話說，機
台之避免壅塞及避免飢餓之搬運策略需要協同合作，因為若機台飢餓是由於
機台壅塞所導致，是不該發生的嚴重過失且需要排除的現象。 
(3) 生產之推拉機制(push-pull mechanism)與搬運之搬運策略(A1B1)需要整合在
一起，用以提高生產績效。 
(4) 搬運策略 A1B1 在所提出之整合架構下能有效運作，且有不錯之績效。 
PDF created with pdfFactory trial version www.pdffactory.com
46 
(5) 因子E：IMP機台派工法則 
類別因子，三水準。水準設定為E1：FIFO、E2：SPT、E3：EDD。 
本實驗針對五種關鍵機台之派工，使用一個五因子之部分因子實驗(35-1 
design)，計有實驗組合為(35-1 design)=81種。本實驗重複數為3次，用以決定如果
因子交互作用存在時所需之平方和誤差項(Montgomery 2001)。因此實驗總數為
81(組合)*3(重複)=243次。本實驗執行4個月，每天執行24小時，系統暫態根據行
前模擬觀察，為2個月後可得到穩定之在製品數(WIP)，因此設定為2個月。 
 
7.2.4 實驗結果 
l 實驗組合及數據 
35-1部分因子實驗組合及各組合下之績效平均值如表7-3。 
表 7- 3 整合派工實驗之法則組合及績效 
Area Performance (average) 
Design No 
TF ET DF PH IMP WO (pieces) CT (hrs) WT (hrs) 
1 2 1 1 1 1 5852.69  707.87  339.00  
2 1 2 1 1 1 6002.34  710.78  340.93  
3 3 3 1 1 1 5926.02  712.75  343.22  
4 1 1 2 1 1 5852.00  705.99  336.20  
5 1 1 1 1 2 5852.57  702.22  332.64  
6 3 2 2 1 1 6001.76  702.83  333.76  
7 2 3 2 1 1 5852.43  726.44  357.00  
8 3 1 3 1 1 5926.37  718.73  349.28  
9 2 2 3 1 1 5777.04  717.91  348.32  
10 1 3 3 1 1 5775.57  727.17  357.30  
11 1 1 1 2 1 5926.43  703.62  334.18  
12 3 2 1 2 1 6002.53  706.64  336.73  
13 2 3 1 2 1 5812.94  714.48  344.74  
14 3 1 2 2 1 5913.52  705.43  335.51  
15 2 2 2 2 1 5852.44  707.11  337.51  
16 1 3 2 2 1 5852.08  713.93  344.03  
17 2 1 3 2 1 5927.33  702.84  333.74  
18 1 2 3 2 1 6001.28  711.76  342.47  
19 3 3 3 2 1 5777.19  719.24  349.44  
20 3 1 1 3 1 5902.67  713.63  344.11  
21 2 2 1 3 1 5927.45  701.10  332.34  
PDF created with pdfFactory trial version www.pdffactory.com
48 
60 3 3 2 1 3 5901.83  709.57  339.80  
61 1 1 3 1 3 5850.52  712.29  342.35  
62 3 2 3 1 3 5925.55  704.95  335.30  
63 2 3 3 1 3 5926.74  714.96  345.28  
64 2 1 1 2 3 5851.24  710.44  341.28  
65 1 2 1 2 3 5851.23  701.68  332.07  
66 3 3 1 2 3 5927.29  704.89  335.00  
67 1 1 2 2 3 5875.42  705.79  336.80  
68 3 2 2 2 3 5851.03  701.24  332.22  
69 2 3 2 2 3 5775.56  711.44  342.14  
70 3 1 3 2 3 5902.41  704.12  334.11  
71 2 2 3 2 3 5926.77  703.10  333.81  
72 1 3 3 2 3 5890.23  709.40  340.25  
73 1 1 1 3 3 5926.53  704.17  334.62  
74 3 2 1 3 3 5927.08  704.35  334.87  
75 2 3 1 3 3 5852.28  706.78  337.09  
76 3 1 2 3 3 5925.65  702.32  333.26  
77 2 2 2 3 3 5852.28  699.60  330.13  
78 1 3 2 3 3 5851.36  707.62  338.19  
79 2 1 3 3 3 5926.91  704.98  335.61  
80 1 2 3 3 3 5927.07  702.91  333.01  
81 3 3 3 3 3 5777.77  705.10  335.85  
 
l 變異數分析(ANOVA) 
實驗數據之殘差分析顯示模擬數據滿足模式之常態、誤差項獨立、常數變異
數之假設(Montgomery 2001)。表 7-4中之 ANOVA分析顯示因子 A、B、C及其
交互作用在 95%信賴水準下顯著影響績效產出(WO)、週期時間(CT)、等待時間
(WT)。 
表 7- 4 整合派工實驗之變異數分析 
(a) Response: WO 
Source SS DF MS F-Value Prob > F  
Model 615346.70 50 12306.93 10.0032 < 0.0001 significant 
A 6417.62 2 3208.81 2.6082 0.0763  
B 186209.78 2 93104.89 75.6767 < 0.0001  
C 9982.43 2 4991.21 4.0569 0.0188  
D 7404.32 2 3702.16 3.0092 0.0517  
E 7573.52 2 3786.76 3.0779 0.0483  
PDF created with pdfFactory trial version www.pdffactory.com
50 
B 2375.02 2 1187.51 136.8904 < 0.0001  
C 97.51 2 48.75 5.6202 0.0042  
D 550.75 2 275.37 31.7436 < 0.0001  
E 1311.68 2 655.84 75.6017 < 0.0001  
AB 140.89 4 35.22 4.0602 0.0035  
AC 25.11 4 6.28 0.7236 0.5768  
AD 261.99 4 65.50 7.5503 < 0.0001  
AE 145.56 4 36.39 4.1947 0.0028  
BC 85.58 4 21.40 2.4664 0.0464  
BD 298.53 4 74.63 8.6034 < 0.0001  
BE 254.69 4 63.67 7.3398 < 0.0001  
CD 532.27 4 133.07 15.3395 < 0.0001  
CE 178.89 4 44.72 5.1555 0.0006  
DE 399.46 4 99.87 11.5121 < 0.0001  
Residual 1665.58 192 8.67  R2: 0.8001 
Cor Total 8333.33 242   Adj R2: 0.7481 
*=significant at 95% confidence level 
 
l Desirability多重反應 
本階段實驗略過交互作用分析來預測最佳實驗組合，直接以多重反應法
(desirability)評估。Desirability function運算結果如表 7-5所示。 
 
表 7- 5 整合派工實驗之 desirability多重反應 
Area Performance Solution 
Number TF ET DF PH IMP WO (pieces) CT (hrs) WT (hrs) 
Desirability  
1 2 2 3 2 2 6010.12 700.23 331.03 0.9503 Selected 
2 2 1 3 2 2 5986.94 699.39 330.50 0.9396  
3 2 1 3 3 2 5968.92 699.20 329.82 0.9218  
4 3 2 2 1 3 5973.55 699.81 330.73 0.9122  
5 3 2 2 1 2 6023.02 701.98 332.79 0.9088  
6 1 2 3 2 2 5993.71 701.46 332.08 0.9075  
7 3 2 1 1 3 5964.41 699.97 330.63 0.8974  
8 3 2 1 1 2 5970.17 700.57 331.17 0.8938  
9 2 2 2 1 2 5978.02 701.68 332.41 0.8789  
10 1 2 2 1 2 5955.14 700.18 330.91 0.8772  
… … … … … … … … … …  
PDF created with pdfFactory trial version www.pdffactory.com
52 
7.3 實驗三：動態派工 
7.3.1 實驗目的及程序 
根據實驗二所蒐集之機台利用率差(UDi)，及週期時間之歷史記錄，評估因
應動態之派工法則。其做法為在設定的時間區間中，檢視目前機台利用率狀況，
調整派工法則的使用。 
本實驗程序包括兩部份，第一為利用分類樹分析，將不同機台利用率下之績
效做分類(class)，並在各績效類別中找出最佳之派工組合。因此當機台利用率變
動時，即重新指派派工組合；第二為利用模擬實驗，評估並比較該動態派工及上
述實驗二之靜態法則之優劣。在進行分類樹分析過程中，會先進行資料蒐集(已
由實驗二進行)，次之作資料之前置處理(data preprocessing)如第 2.4 節所述，最
後以統計軟體 Statistica進行分類樹分析。進行模擬評估時，以 12小時為時間單
位，每時間單位間，檢視當下之機台利用率以判斷當調整之派工法則。最後將實
驗結果與實驗三之結果做比較並下結論。 
 
7.3.2 分類樹派工發展 
由實驗二所蒐集的資料顯示如圖 7-2，資料收集期間以每 12小時為單位，所
蒐集之機台利用率差(UDi)之記錄、該區間中之產出晶圓批及其週期時間，並記
錄當時各關鍵機台之派工法則組合，共計有 4358筆資料。欄位名稱說明如下。 
(1) Design No：實驗組合之編號，可對應表7-3得知該組合下之機台派工法則。 
(2) Seq：各組合下之數據收集順序。 
(3) SimTime：資料收集之時間，時間格式為 天:時:分:秒 (00:00:00:00.0000)。 
(4) DF_xB~TF_xX：機台利用率差(UDi)。 
(5) WOMonit：該資料收集期間之晶圓產出批數(一批25片)。 
(6) CTMonit：該資料收集期間之晶圓產出平均週期時間。 
 
PDF created with pdfFactory trial version www.pdffactory.com
54 
有效運用。 
 
 
圖 7- 3 前置資料處理 
接續利用統計軟體 Statistica中之分類樹(classification tree)進行分析。其中相
依變數(Dependent variable)為廣義化後之週期時間，分 3級(28天、29天、30天)；
類別預測變數(Categorical predictors)為廣義化後之各生產區，分 5 級(TF、ET、
DF、PH、IMP)。分類樹架構圖顯示如圖 7-4、分類樹樹圖如圖 7-5，及摘錄自
Statistica 6.0之分類數符號說明如圖 7-6。 
PDF created with pdfFactory trial version www.pdffactory.com
56 
 
圖 7- 6 分類樹符號說明(Statistica 6.0) 
將圖 7-5中分類樹之最終節點(terminal nodes)之條件狀況由左至右整理如下
表 7-6，並將不同之條件狀況所產生之結果(節點)做分類如表中之”Class Name”
欄位。 
表 7- 6 分類樹最終節點之條件狀況整理 
Node No IMP PH DF ET TF Predict. class Class Name 
4 3 2,3    28 C1 
8 3 1  2,3  28 C2 
14 3 1  1 2,3 28 C3 
15 3 1  1 1 29 C4 
10 1,2 2,3 1   28 C5 
11 1,2 2,3 2,3   29 C6 
12 1,2 1  2,3  28 C7 
13 1,2 1  1  29 C8 
1: UDi > 0; 2: UDi = 0; 3: UDi < 0 
接續，找出各類別(Class Name)下之最佳最佳派工組合(Design No)並整理如
表 7-7。最佳組合的決定為該群下之最佳(短)平均週期時間之派工組合。 
表 7- 7 各類別(節點)下之最佳派工組合 
Class Name Design No TF ET DF PH IMP 
C1 13 2 2 2 3 3 
C2 13 2 2 2 3 3 
C3 38 3 2 3 1 3 
C4 18 3 2 3 3 1 
C5 12 2 2 2 1 2 
C6 46 3 3 2 3 1 
C7 58 2 1 2 1 3 
C8 49 1 1 3 3 1 
  1: FIFO; 2: SPT; 3:EDD 
PDF created with pdfFactory trial version www.pdffactory.com
58 
表 7- 8 類別累計次數 
 C1 C2 C3 C4 C5 C6 C7 C8 總次數 
累計次數 7 16 5 4 13 8 3 64 120 
累計% 5.8 13.3 4.2 3.3 10.8 6.7 2.5 53.3 100% 
實驗數據如表 7-9 所示，接續將實驗二之最佳派工組合(簡稱實驗二)及實驗
三之資料視為兩組獨立樣本並進行 t檢定。其結果顯示如圖 7- 7並說明如下。 
表 7- 9 靜態派工與動態派工比較 
生產區 績效(平均) 
實驗 
TF ET DF PH IMP WO (pieces) CT (hrs) 
實驗二 2 2 3 2 2 6010.12 700.23 
實驗三 Dynamic 6012.46 700.17 
(1) 平均產出(圖 7-7(a)) 
Ø 檢定實驗二及實驗三之變異數是否相等 
由雙尾 F檢定統計量 F = 9.19985及 p-value = 0.196079 > 0.05知，在 5%
顯著水準下，兩母體之變異數沒有顯著差異，即兩母體變異數相等。 
Ø 檢定實驗二及實驗三之平均數是否相等 
由雙尾 t檢定統計量 t = -1.08758及 p-value = 0.337926 > 0.05知，在 5%
顯著水準下，兩母體之平均數沒有顯著差異，即兩母體平均數相等。 
(2) 平均週期時間(圖 7-7(b)) 
Ø 檢定實驗二及實驗三之變異數是否相等 
由雙尾 F檢定統計量 F = 24.69081及 p-value = 0.077849 > 0.05知，在 5%
顯著水準下，兩母體之變異數沒有顯著差異，即兩母體變異數相等。 
Ø 檢定實驗二及實驗三之平均數是否相等 
由雙尾 t檢定統計量 t = 0.188710及 p-value = 0.859508 > 0.05知，在 5%
顯著水準下，兩母體之平均數沒有顯著差異，即兩母體平均數相等。 
 
PDF created with pdfFactory trial version www.pdffactory.com
60 
7.4 實驗討論 
本章節實驗為根據所發展之整合架構下，進行策略之模擬實驗。 
首先為發展能全力支援生產系統之搬運策略，策略之發展以能排除生產障礙
使生產流暢為出發點，包括： 
l 避免壅塞(avoid blocking) 
l 避免飢餓(avoid starvation) 
實驗結果也說明了所提出之避免壅塞 (avoid blocking)、避免飢餓 (avoid 
starvation)能使整合後之績效指標，包括產出及生產週期時間有較佳表現。 
次之，生產派工在上述搬運策略之前提下進行評估。評估之對象為機台利用
率大於80%之機群，本研究中定義為關鍵機群。派工法則之選用，為廣泛被晶圓
廠採用之傳統派工法，包括： 
l 來到時間相關(arrival time related)：先進先出法(First In First Out，FIFO) 
l 加工時間相關(processing time related)：最短加工時間優先(Shortest Process 
Time，SPT) 
l 交期相關(due date related)：最早到期日優先(Earliest Due Date，EDD) 
本階段實驗定義為靜態派工。實驗結果顯示，針對不同之機台加工特性，包
括序列性機台及批量加工機台，選用不同之派工法，對生產績效較佳。其中序列
性機台以最短加工時間優先(SPT)法，及批量加工機台以最早到期日優先(EDD)
之派工組合有較佳表現。 
最後，根據上述實驗所蒐集之機台利用率及產出時間之記錄，發展一以分類
樹技術為依據之動態派工法則。其作法為定期檢視目前機台利用率狀況，調整派
工法則的使用。唯實驗結果顯示動態方式派工相較於靜態方式派工成效相近，說
明了在搬運策略之發展(實驗一)加上依據機台特性進行派工(實驗二)，已能使整
合架構有效運作且有不錯表現。 
 
PDF created with pdfFactory trial version www.pdffactory.com
62 
參考文獻 
[1] 吳俊寬，”晶圓廠連接式自動化物料搬運系統搬運策略之模擬研究”，清華大
學工業工程與工程管理所碩士論文，2001。 
[2] 陳紹偉，“300mmIC 代工廠自動化物料搬運系統之系統模擬與派工法則的研
究”，台灣大學機械工程研究所碩士論文，1999。 
[3] 黃友錄，”考慮黃光區綁機特性之派工法”，交通大學工業工程與管理研究所
碩士論文，2003 
[4] 楊桂峰，”流量平衡為導向的黃光區綁機派工法”，交通大學工業工程與管理
研究所碩士論文，2003 
[5] 楊景如，” 晶圓廠自動化物料搬運系統之搬運車運作策略模擬研究”，清華大
學工業工程與工程管理所碩士論文，2002。 
[6] 黎翠綾，”在機台群組限制下的黃光區投料派工模式”，交通大學工業工程與
管理研究所碩士論文，2000 
[7] 鍾淑馨、周昱智、溫伊蓁，”生產活動控制之探討與文獻回顧”，管理與系統
學刊，第七卷，第四期，第 459-484頁，民國 89年。 
[8] 顏柄榮，“半導體晶圓廠自動化物料搬運系統之模擬分析”，清華大學工業工
程與工程管理所碩士論文，2000。 
[9] Akcalt, E., Nemoto, K. and Uzsoy, R., ” Cycle-Time Improvements for 
Photolithography Process in Semiconductor Manufacturing, ” IEEE Transactions 
on Semiconductor Manufacturing, Vol.14, No.1, pp.48-56, 2001. 
[10] Chern, C. C. and Liu, Y. L., ” Family-Based Scheduling Rules of a 
Sequence-Dependent Wafer Fabrication System, ” IEEE Transactions on 
Semiconductor Manufacturing, Vol.16, No.1, pp.15-25, 2003. 
[11] Dabbas, R. M. and Flower, J. W., ” A New Scheduling Approach Using 
Combined Dispatching Criteria in Wafer Fabs, ” IEEE Transactions on 
Semiconductor Manufacturing, Vol.16, No.3, pp.501-510, 2003. 
[12] Egbelu, P. J. and Tanchoco, J. M. A., ” Characterization of Automated Guided 
Vehicle Dispatching Rules”, International Journal of Production Research, Vol.22, 
No.3, pp.359-374, 1984. 
[13] Egbelu, P. J., ” Pull Versus Push Strategy for Automated Guided Vehicle Load 
Movement in a Batch Manufacturing System”, Journal of Manufacturing System, 
PDF created with pdfFactory trial version www.pdffactory.com
64 
[25] LIN, J. T., WANG, F. K., and WU, C. K., 2003.b, Simulation analysis of the 
connecting transport AMHS in a wafer fab. IEEE Transactions on Semiconductor 
Manufacturing, 16, 555-564. 
[26] LIN, J. T., WANG, F. K., and YEN, P. Y., 2001, Simulation analysis of 
dispatching rules for an automated interbay material handling system in wafer 
fab. International Journal Production Research, 39, 1221-1238. 
[27] LIN, J. T., WANG, F. K., and YOUNG, J. R., 2004, Virtual vehicle in the 
connecting transport automated material-handling system (AMHS). International 
Journal of Production Research, 42, 2599-2610. 
[28] Lou, S. and Kager, P. K., ” A Robust Production Control Policy for VLSI Wafer 
Fabrication, ” IEEE Transactions on Semiconductor Manufacturing, Vol.2, No.4, 
pp.159-164, 1989. 
[29] Lu, S. C. H, Ramaswamy, D. and Kumar, P. R., ” Efficient Scheduling Policies to 
Reduce Mean and Variance of Cycle-Time in Semiconductor Manufacturing 
Plants, ” IEEE Transactions on Semiconductor Manufacturing, Vol.7, No.3, 
pp.374-388, 1994. 
[30] Nakata, T., Matsui, K., Miyake, Y. and Nishioka, K., ” Dynamic Bottleneck 
Control in Wide Variety Production Factory, ” IEEE Transactions on 
Semiconductor Manufacturing, Vol.12, No.3, pp.273-280, 1999. 
[31] Sha, D. Y., Lin, J. T., Yang, C. J., 2006, “The evaluation of search range 
assignment in 300mm automated material handling system (AMHS),” 
International Journal of Advanced Manufacturing Technology (Accepted). (NSC 
95-2221-E-468-013) 
[32] Sha, D. Y., Yang, C. J., 2006.6, “A study on distance trend of vehicle's empty trip 
in 300mm automated material handling system”, Proceedings of the 36th 
International Conference on Computers and Industrial Engineering (ICCIE 2006), 
pp. 4239-4250, Taiwan, ROC (session chair) ( NSC 95-2221-E-468-013) 
[33] Sha, D. Y., Yang, C. J. and Huang, Ilanson C.W. 2007.5, “A study on integration 
of tool and vehicle dispatching in 300mm wafer fab”, Proceedings of the 2007 IIE 
Annual Conference IERC, Nashville, Tenn., U.S.A. pp. 1648-1653. (NSC 
95-2221-E-468-013) 
[34] Shen, Y and Leachman, R. C., ” Stochastic Wafer Fabrication Scheduling, ” 
IEEE Transactions on Semiconductor Manufacturing, Vol.16, No.1, pp.2-14, 
2003. 
PDF created with pdfFactory trial version www.pdffactory.com
66 
計畫成果自評 
 
1. 研究內容與原計畫相符程度 
研究內容依循原計畫所規劃之程序進行。唯過程中發現另有多項待評估之因
素，因此在原規劃之大原則下，修改些項目： 
原規劃將派工與派車同時評估，但影響因素過於複雜，因此將整合模式之發
展分兩階段進行。首先發展以機台運作狀況為考量之搬運策略，次之再評估
生產派工。 
 
2. 達成預期目標情況 
由於執行計畫過程中有部分修改(如上述)，因此與預期達成目標亦有些許變
動。但過程中亦證實所修改之部分有其研究之必要(搬運策略之評估)。 
另外，動態派工績效不如預期表現佳，其結果與靜態派工相當。由於動態派
工所須蒐集之資料量大及資料處理費時，改善之績效有限，因此可採靜態派
工即可。 
整理其原因為：(1)在搬運策略之運作上，已能根據機台之運作狀況(壅塞或飢
餓)決定合適之貨批執行搬運、(2)靜態法則為根據各關鍵機群，及生產機台特
性(序列性、批量加工)所評估出。因此，靜態派工之方式已有不錯之表現。 
 
3. 研究成果之學術或應用價值 
本計畫實為根據晶圓廠所面臨之問題尋求解決方案。由於研究過程中硬體(PC)
績效之限制，雖僅能以縮小化、特徵化之模擬模式呈現，但所提出之方法仍
可作為管理決策者之參考。 
 
4. 是否適合在學術期刊發表 
本計畫為半導體晶圓廠生產派工與搬運派車之整合策略評估，學術期刊多有
與本計劃相關之研究，因此已節錄部分研究成果發表於 2007年美國工業工程
年會(IIE)中(請參考文獻[33])，並已改寫為期刊論文投稿審查中。 
 
PDF created with pdfFactory trial version www.pdffactory.com
2 
二、 與會心得 
This is the first time for me to attend the abroad conference. The first job to attend this kind 
of activities is to overview the schedule and arrange in order of showings, in order to avoid the 
chances loss to obtain the latest knowledge. What I have learned in this conference is that try my 
best to ask what I want to know then I will gain these. The people whom I conversed with are 
friendly. I think it is because we have the unanimous purpose, share the results we study, 
understand what you do and expand the field of vision. 
The session I attend is modeling and simulation. To apply the IE technique like neural 
network or artificial intelligence into simulation evaluation has became a widespread tendency. 
The research objects are from the high technology environment, wafer fabrication, to the 
assembly line in traditional industry. Beside, the real-world, real-time and the integration stricture 
of data input, simulation and results analysis are the critical point in this session. Further, the 
objects development for accelerating modeling and increase the modeling flexibility are also 
emphasized. 
Through my presentation, the questions from the attendants make me think over how to 
diagnose the rationality of simulation model efficiently before statistics analysis. And form the 
continuity question asked by the second asker, guides me to answer the previously question 
which asked by the first asker. The thinking logic of the second asker is the most important what 
I have learned this time. 
Furthermore, Nashville, TN is a music city and the country music was originated in this city. 
There are many music pub located in the main street “Broadway” in downtown. The sightseeing 
information is abundant in the information center and hotel, especially the tour program: “one 
day pass” and “one hour pass” which mapped out by this city provide the visitors to overview 
their city fast. I think the tourism must be the core industry of their city, and this type of tour can 
be the object we learn. However, I’m so surprised that the activity about environmental 
protection is not brought into practice because the Styrofoam boxes are now in widespread use 
for food packaged. Most of people are enthusiastic but some high school students called us  
 
PDF created with pdfFactory trial version www.pdffactory.com
Proceedings of the 2007 Industrial Engineering Research Conference
G. Bayraksan, W. Lin, Y. Son, and R. Wysk, eds.
A study on integration of tool and vehicle dispatching in 300mm 
wafer fab
D. Y. Sha
Department of Business Administration
Asia University, Taichung 413, Taiwan, R.O.C.
Department of Industrial Engineering and Management
National Chiao-Tung University, HsinChu 300, Taiwan, R.O.C.
C. J. Yang
Department of Industrial Engineering and Management
National Chiao-Tung University, HsinChu 300, Taiwan, R.O.C.
Ilanson C.W. Huang
Fab12 Manufacturing Department
Taiwan Semiconductor Manufacturing Company Ltd. HsinChu 300, Taiwan, R.O.C.
Department of Industrial Engineering and Engineering Management 
National Tsing-Hua University, HsinChu 300, Taiwan, R.O.C.
Abstract
The procedure of tool dispatching and vehicle dispatching integration (TVDI) is proposed, and is evaluated using the 
simulation model which portrays a 300mm wafer fab from Taiwan, R.O.C., built using the object-oriented software 
eM-PlantTM, and analyzed using Design ExpertTM. The procedure is developed for blocking elimination, starvation
avoidance and waste movement reduction, executed using the five Push-Pull mechanisms: tool-searches-FOUP,
FOUP-searches-tool, vehicle-searches-FOUP, FOUP-searches-vehicle, and FOUP-searches-stocker. Under the 
proposed TVDI procedure, the performances, including throughput, cycle time, tool utilization, working in process,
and vehicle utilization can be improved because transportation can support production effectively.
Keywords
Tool dispatching, vehicle dispatching, integration, simulation, wafer fab
1. Introduction
The characteristics of multi-layers and the re-entrance wafer process through the tool’s different functions include
photography, etching, thin film deposition, diffusion, and ion implant, making the tool dispatching (TD) complex. 
Each function has 10~30 tool groups (TG), allocated as bay layout for effective processing. The TD issues originate 
from allocating the limited resources, the process restricted, like mask scheduling, exposure tool dedication, and 
form batch for diffusion process. The related studies of mask scheduling attempt to minimize the numbers of mask 
changes or reduce the setup time for increasing the tool’s utilization, or to balance the workload of a set of 
operations between two consecutive exposure operations [1–3]. The focal point of tool dedication is to balance the 
workload of the exposure tools which process the critical layer [4] [5]. The form batch is to combine many batches 
with the same recipe for the oxidation deposition. The related issues of the limited waiting time to form batch, batch 
selection, and so forth, are seeking to reduce the capacity loss [2] [6] [7]. The dispatching criteria that are usually
used in the above issues have been separated into local and global dispatching [8]. The local dispatching includes the 
related arrival time, process time, due date and composite, like FIFO, SPT, EDD and MS respectively. Two aspects 
in the global dispatching are look ahead and look behind. WR and SA are used in look ahead, while heuristic rules 
were developed for look behind.
ïêìè
PDF created with pdfFactory trial version www.pdffactory.com
 Sha, Yang and Huang
avoidance” is for pulling FOUP to tool for continuous process and to reach the target utilization. The above
approaches are used to enhance the traditional VD rules that do not consider the tool’s status, and only for FOUP 
attributes like the longest waiting time or the nearest first.
Î
å
=
n
1i
iqGVn å
=
n
1i
iqGVn
³
³
å
=
=
ni
1j
k,j,ik,i apTGap
å
=
=
ni
1j
k,j,ik,i opTGop
Î
Î
Figure 2: The TVDI procedure
Table 1: The procedures of PP mechanisms
FSS l rule: the lowest WIP level first (LW)
Identify the set Y of the STKs that corresponding to Gi,k (KGi,k).
a3 Identify the set yÎY that some FOUPs haven’t completed the form batch with the same recipe of the FOUP which 
triggers FSS in it. If y Ø, selects the STK in y. Else (y = Ø), selects one STK in Y based on rule.
a2 Selects one STK in Y based on rule.
FST l rule: the lowest utilization first (LU)
a1 Identify the set Z1 of the tools Ti,j,kÎGi,k that apTi,j,k > 0 (from b2). Selects one tool in Z1 based on rule.
a5 Identify the set Z2 of the tools Ti,j,kÎGi,k  that apTi,j,k > batch size(bs) (from b2). Selects one tool in Z2 based on rule.
FSV l rule: the nearest vehicle first (NV)
Identify the set V of the vehicles that are idle now (from b7). Selects one vehicle in V based on rule.
TSF l rule: the first come first service (FCFS)
Identify the set F of FOUP which non-assigned by tool and queuing in Gi (from b1, b3); Identify the set F1ÎF that the 
attribute of FOUP is hot. If F1 Ø, select one FOUP in F1 based on rule. Else, select one FOUP in F based on rule.
VSF l rule: the longest waiting time first (LW)
ïêëð
PDF created with pdfFactory trial version www.pdffactory.com
 Sha, Yang and Huang
working in process (WIP, lots) – the average WIP queuing in TG per two hours; (5) vehicle empty utilization
(Vemp, %) – the utilisation of a vehicle’s empty trips, which is the trip for a vehicle to pick up the assigned FOUP,
the lower the better. Further, two strategies for VD, VSF, are evaluated and set as two factors: (1) factor A, two
levels, A1 = blocking elimination when VSF, A2 = VD rule only; (2) factor B, two levels, B1 = starvation avoidance 
when VSF, B2 = VD rule only. A two-factor full-factorial design was used. The number of scenarios was 2(A1,
A2)*2(B1, B2) = 4, in which A2*B2 is the baseline situation that does not consider the tools status when executing
VD and only dispatching by the VD rule. The number of experiments was 4 *10 (replications) = 40. The simulation 
interval was 120 days, and the warm-up was 60 days.
Figure 4: The representative layout of a 300mm Fab
Table 2: Capacity information
TG number tool number Critical TG TG number tool number Critical TGArea
Prod. Insp. no. Prod. Insp. no. no. Util.%
Area
Prod. Insp. no. Prod. Insp. no. no. Util.%
WS 1 0 1 1 0 1 0 IMP 5 0 5 14 0 14 2 86.86
TF 15 1 16 30 1 31 1 84.01 CMP 2 0 2 2 0 2 0
ET 14 5 19 34 6 40 5 83.98 CU 2 2 4 6 2 8 0
DF 9 2 11 13 2 15 1 82.12 QC 0 2 2 0 2 2 0
PH 6 6 12 15 13 28 2 84.46 total 54 18 72 115 26 141 11 84.29
Prod.: production tools; Insp.: Inspection tools
4. Simulation Results
The ANOVA analysis summarised in Table 3 indicates that the A, B and their interactions significantly affect the
indices at 95% confidence level, and the factors’ contribution to indices also can be seen. Further, the least 
significant difference (LSD) method was carried out for the Post Hoc Multiple Comparisons (see Table 4). The 
value is the mean measured from the 10 replications, and the rank in the different alphabet means the effects were 
significant. Furthermore, a multiple response method called desirability [13] is used to integrate multiple indices into 
one. The result in the right side of Table 4 suggests that A1*B1 is the optimal for TVDI.
5. Conclusion and Further Research
The simulation results show that blocking elimination (A1) is the most important for improving the indices compared
to the baseline situation (A2*B2), and only the scenarios that include A1 can reach the wafer out target (set in Sec. 
3.1) and gain the higher Tutil. The blocking elimination (VSF) plus the push mechanism, FST and FSS, not only 
release the port’s capacity for the next FOUP to load in, but the next FOUP is backup for tools to reduce the capacity 
loss. Also, the pull mechanism, TSF, plus starvation avoidance (VSF), not only triggers the tools to backup WIP 
when the port’s capacity is just released, but the FOUP would be sent to the tool (max UD (Gi)) which requires the
WIP most. Hence, the blocking has to eliminate first, and then the effect of starvation avoidance can be brought into 
full play. Through the proposed TVDI structure, transportation could support production effectively. Further
research will evaluate the VD mechanism to support the batch tools which need FOUPs to form a batch before the
process.
ïêëî
PDF created with pdfFactory trial version www.pdffactory.com
