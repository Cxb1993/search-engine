 1
一、研究摘要 
目前學校對於排課問題始終無法找出最好的解決模式，而排課作業又
是每學期初必須面對的問題，因此學校發展完整之排課作業系統，是學
校與教育當局共同努力之目標。排課限制條件中包括課程、教師、教室、
班級、及設備等複雜因素之影響，導致排課問題只能找出可行解，但不
見得為最佳解。為解決此多重限制滿足的最佳化問題，本論文嘗試設計
一套符合國內高中職或大專院校使用的自動排課系統。設計中首先運用
學校以往排課經驗考慮規則基礎（Rule Based）的概念並與從事多年排課
之專家共同討論排課評估要項，再建置規則的搜尋方式，找出符合使用
者需求的條件，然後再以推論引擎（Inference Engine）來建置規則的搜尋
方式，之後再輔以微調方式，以進一步改善所有衝突之課程及教師，最
後再將所推演流程配合電腦程式建構發展及規劃為協同軟體平台系統，
以達自動化排課之目標，並將所有研究過程之文件標準化，配合知識管
理之運用，提供國內高中職及大專院校排課時之參考。 
 
關鍵字：規則基礎，推論引擎，協同軟體，知識管理 
 3
三、技術研發成果說明 
教務處在處理排課作業上，主要依據過去排課的經驗為準則，學校依照上下學期課
程區分，因此每年均需面對兩次不同之排課結果。而不同的學校有其特殊及獨特之作業
方式，對排課而言相對產生不同的特色與風格。當然目前學校如果仍然經營，表示其排
課結果一定是個可行解，否則必遭抗議，唯一不同的是其過程所遭遇之困擾及完成之時
效性。本文研究的主要對象依據是高中職全校的排課作業，並依據專家的經驗及過去排
課的 Know How，轉化成知識管理的模式作為可管理及儲存的資料，再配合規則流程，
且考量限制條件，最後在相同條件下以亂數方式產生可行解，以下將分別說明各定義。 
3.1 知識管理目標與架構 
知識管理可說是企業價值創造的基礎。而知識管理能否順利遂行，端視高層人員有
無堅強的意志力，以及制定策略時是否有通盤之考量。而此兩項因素同時關係著「顧客
導向」主義的企業文化、全球化及通訊高速化的環境背景下，企業能否建立競爭優勢與
核心能力之關鍵因素。為了達到此目標，需分層次逐步建構學習型組織。欲達成學習型
組織，必須先達成知識共享；而欲達成知識共享，必須先能將知識有效地累積與儲存。
故知識管理之各目標具階段性及順序性。 
如圖 3-1 所示，知識管理之主要目標包括知識獲得、知識保留、知識創新、知識整
合與知識共享。這些目標具有由下而上之順序關係。而知識共享可說是知識管理之最終
目標，因此知識共享位於所有目標之最上層。而知識獲得可說是知識管理最基礎之目
標，其主要是擴充企業知識之來源。由於知識是由資訊與經驗結合而成，因此除了獲得
外顯知識外，並應獲得員工之內隱知識，獲得之知識需經適當編碼以便儲存於企業知識
庫中。因此，知識保留是將外顯知識編譯並儲存至知識庫。當知識庫中擁有足夠之內隱
與外顯知識時，員工即可利用此知識庫整合彼此間之新舊知識。知識能被創新與整合
後，即可提昇知識來源之全面性與時效性，達成高品質之知識共享及全面化之知識管
理，提昇企業之競爭優勢。 
 5
圖 3-2、知識管理於排課作業改善之概念 
3.3 規則基礎(Rule based)及限制條件 
學校依照過去人工排課之經驗，初期由於許多限制條件，導致配合規則執行時，
仍然產生無法滿足條件之情況，而且資料量龐大，只要調整任一資料，可能造成其
他已排好之課程改變，正所謂〝牽一髮，而動全身〞，以下利用數學模式簡單說明
排課所需條件及限制情況： 
假設全校有 a 位教師，b 個科目，c 個節次及 d 個班級，另有四個集合 T＝﹛t1, 
t2,….., ta﹜，X＝﹛x1, x2,….., xb﹜，Y＝﹛y1, y2,….., yc﹜，Z＝﹛z1, z2,….., zd﹜，
代表此四個因子之變數，理論上每位教師可以講授任何一門課，相對的每一個科目
可由任何一位教師授課，其配對關係如圖 3-3，而每一個配對(教師，科目)可重複排
入任一個節次中如圖 3-4，最後每個老師的科目在任一節次中，需對應到相關之班
級，其對應關係如圖 3-5。此時的排課目標就是要確定每個班級在每一個節次都要
有一位教師在教授一個科目，若是技術學院以上之學校則不考量班級。 
 
 
 
 
 
 
 
 
 
圖 3-3、教師與科目的配置關係 
 
KM＝ (P＋K) S
改善排
課作業
教務處
課務組、
教師
排課人
員專業
知識
自動排
課系統
彼此分享
排課之作
業流程
○
(教師，科目) 節次
…
…
…
…
(t1, x1)
(t2, x2)
(ta, xb)
y1
y2
yc
○
○
○
○
○
…
…
…
…
 7
5. 排課慣例，依各學校排課習慣，如第一堂課針對某一門科目決不能排課。 
6. 學生選課意願，針對選修科目，有時必須考量學生願意上課時段。 
3.4 協同軟體開發工具 
本研究之平台軟體開發工具為 PowerBuilder，是美國 PowerSoft 公司在 1990 年
所開發出來的主從架構前端應用程式開發工具，由於它的強大功能和足夠的專業性
以及採用圖形化界面的設計方式，在短短的數年內很快席捲北美洲的主從架構前端
應用程式開發工具市場。 
1. PowerBuilder Object 
PowerBuilder 是一個物件導向(Object-Oriented)式的應用程式開發工具，結
合了事件驅動(Event-Driven Processing)的程式設計理念，並提供了
PowerBuilder 本身的開發語言 PowerScript，同時提供豐富的 PowerScript 
Function 讓使用者可以更輕鬆的開發一個完整的應用程式。表 3-2 是它所提供
的物件及使用的時機： 
表 3-2 PowerBuilder Object 
Object Use 
Application 應用程式的進入點 
Window 主要的使用者界面 
DataWindow 擷取或維護資料庫的資料 
Menu 命令的表列形式 
Global 
Function 執行通用目的的程序 
Query 可定義重覆使用的 SQL 語法 
Structure 收集單一或多個相關的變數集合成一個單一的名字 
User Object 可重覆使用的模組或控制元件 
Library 儲存 PowerBuilder 的物件 
Project 包裝應用程式，分散給其他使用者使用 
當使用者在開發應用程式的時候，Application Object 是一個很重要的物
件，他儲存了開發過程中的 Window、menu、function 及 DataWindow object 等
的 library 如下圖 3-6。 
 
圖 3-6 Application Object 所包含的 Library 
 9
四、技術特點說明 
在系統設計上我們運用知識管理之架構並考量現有軟體的開發平台與硬體設備
及未來開發軟體與開發人員對開發工具的熟悉程度，我們將排課資訊系統也架設在
Client / Server架構下，而本論文之研究流程如圖4-1所示： 
 
圖4-1、研究流程圖 
4.1 排課邏輯討論 
整體排課探討包含系主任、教務處課務組、各科系辦公室及老師各介面間之互
動情況，其間關係如圖 4-2 
圖 4-2、物件互動關係圖 
排課邏輯討論
系統架構分析
資料庫分析
系統操作
產出報表文件製作
系統開發
效益
修
正
提
供
系主任 教務處課務組 各科系辦公室 老師
要求排課
提供課程資料 請求老師意願表
取得老師意願表
輸入排課規則優先順序
自動排課
輸出排課結果
微調或協調
 11
4.2 系統架構分析 
軟體平台採用 Windows 環境( Intranet )以達到快速列印之需求，老師亦可由
Intranet 來查詢或輸入相關資訊，系統採用主從架構作業模式，前端應用程式採
用 PowerBuilder 開發，後端資料庫為資料庫 MS SQL 7.0 或 SQL 2000 或
ORACLE，並可配合學校原有之資料庫架構開發，簡單易用的操作圖形介面方
式，方便各相關作業人員使用。而 PowerBuilder 強大的 DataWindow 功能更可依
使用者所需快速地製作出各種分析報表。 
本系統所需之相關作業環境及技術工具規劃如下： 
1. 作業系統： 
Server：NT Server/ Novell Netware/ UNIX 
Client：Win2000 / WinXP 
2. 資料庫：MS SQL 2000/2003/ ORACLE 或 Workgroup Server 
3. 開發工具： PowerBuilder 
4. 系統分析：PowerDesigner 
其硬體架構圖如圖 4-4，而主機規格建議如下： 
1. 中央處理器速度 2.4GHz，多重處理器支援雙 CPU 運作（2-Way） 
2. 為新一代的中央處理器。內建 256KB 快取記憶體 
3. 記憶體有 256MB，有支援 ECC 功能 
4. 有溫控，電壓偵測功能，並具有防上外殼開啟之偵測 
5. 配有 PCI 插槽五個以上 
6. 顯示卡記憶體容量 32MB 
7. 光碟機 50 倍速 
8. 介面規格 IDE/ATAPI 
9. 緩衝記憶體 2MB 
10. 滑鼠適用接頭型式 USB/PS2 
11. 網路資料傳輸，具有 Bus Master 32-bit 之資料傳輸介面 
12. TFT 液晶顯示螢幕高解析度 1024*768 
13. 低輻射安規 TCO99 
另外系統伺服器之規格建議如下： 
1. 作業系統版本別 2000 以上 
2. 授權數含伺服器 1 台+工作站 5 台的授權 
3. 支援 4 顆 CPU 系統 
4. 包含有效的 DHCP 伺服器 
5. 使用者身份驗證和存取控制的管理都可與 Active Directory 完全結合在一起；
具資訊安全性。 
6. 在 TCP/IP 網路電腦上執行的程序可相互識別並進行連接，與 DNS 整合一起。 
7. Active Directory 是可擴充的；具擴充性 
8. 可藉由遠端遙控的方式來管理網路 
9. 支援二種磁碟儲存的方式 
◆ 基本（basic）磁碟 
◆ 動態（dynamic）磁碟 
系統軟體架構以關聯式資料庫為基礎，透過圖形化介面工具構成分散式架構
(Client / Server)，並與 Internet 連接整合通路，以利將 Internet 應用程式(如網路選
課、網路成績查詢、教師課程成績輸入等……)整合於同一系統架構之中，軟體
 13
4.3 資料庫分析  
學校校務行政管理系統之整合性資料庫其檔案主要分成學生資料、教
職員資料、行政資料、各科系所資料及訊息資料，系統檔案目錄內容如表 4-2。 
表 4-2、系統檔案目錄 
大類 中類 資料來源 權責單位 使用單位 
1-1 基本資料 學生 註冊組 全校各單位 1 學生資料 
1-2 學業資料 學生、教師、各
系所 
課務組、註冊
組 
各系所、教務
處 
2-1 基本資料 教職員工 人事室 各單位 
2-2 薪資資料 人事室 人事室 會計室、出納
組 
2-3 教學資料 課務組 課務組 各單位 
2 教職員資
料 
2-4 考勤資料 各單位 人事室 各單位 
3-1 預算資料 各單位 會計室 各單位、會計
室 
3-2 採購資料 事務組 事務組 事務組、會計
室 
3-3 保管資料 各單位 保管組 各單位 
3 行政資料 
3-4 維運資料 事務組、營繕組 事務組、營繕組 各單位 
4 系所資料 4-1 系所課程資料 各系所 課務組 學生、各系所
5-1 電子郵件資料 各使用者 各使用者 各使用者 
5-2 公用性文件 各單位 各單位 各單位 
5-3 簽核中資料 各單位 各單位 各單位 
5 訊息資料 
5-4 公文資料 各單位 各單位 各單位 
而本系統對於資料庫運用之工作項目包括：  
1.重新檢視編碼原則，如課程代碼、單位代碼、教職員代碼等。  
2.重新檢視文件表單內容，包括各式單據及報表。  
3.整合性資料庫規劃，依資料相關性，建置關聯式資料庫。  
4.原始資料轉檔，依新編碼原則、整合性資料庫結構，整理原始資料庫
系統，並執行轉檔作業。  
5.原始書面資料回朔建檔，對無電子檔案資料，整理搜集，進行回朔建
檔。  
6.系統測試導入，藉由轉檔資料，進行作業測試，以確定轉入資料正確
性。  
針對排課系統本研究主要需探討之整體資料庫所必須維護之主要
資料分成三個部分：  
1.代碼檔維護：包含課程分類、級職檔、職別檔、特殊需求、共同上課、
教師意願。  
2.開課檔維護：包含學年學期、開課序號、課程代碼、課程名稱、
課程堂數、教師代碼、限制人數、教室編號、間隔
天數。  
3.教師檔維護：教師代碼、職別名稱、行政職務、所屬系別、到校
日期、需求情況。  
