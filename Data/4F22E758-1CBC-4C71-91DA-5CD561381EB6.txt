摘要 
本計劃所推動可攜式生理訊號不同之用法，提供老年人與失能者生理訊號
量測儀表，提高使用率，發展生理訊號擷取、紀錄、傳輸及實時分析平台，並
結合其他子計劃中的行動位置監視，實時無線傳輸，可以讓老人的行動不受到
限制，且達到無線居家照顧的理念。可攜式即時醫療訊號蒐集與分析系統平台
發展第一年著重在建構生理訊號量測、記錄及傳輸平台。第二年著重在建構（1）
連續血壓波形分析; （2）發展其他生理訊號及與本整合相關資訊讀入裝置;
（3）可硬體實現之心電圖分析方法之研發; （4）以 FPGA 作處理在平台結合
在 FPGA 所設計之數位訊號處理（DSP）用來將 ECG 訊號從時域轉換到頻域並
且在頻域分析病患的心率變異。此計畫之生理訊號量測、記錄及傳輸平台為可
攜式生理訊號擷取系統在生理事件發生時，即時錄取生理各項訊號，分析訊號之
意義，且及時示警；可攜式之生理訊號擷取系統量測容易且簡單易於瞭解已普遍
為大眾接受外之數據，如、心電圖及血壓之量測等常用之生理訊號，利用訊號分
析系統將量得之訊號轉譯成使用者能瞭解之資訊呈現。可攜式生理訊號擷取系統
在生理事件發生時，即時錄取生理各項訊號，分析訊號之意義，且及時示警；可
攜式之生理訊號擷取系統量測容易且簡單易於瞭解已普遍為大眾接受外之數據，
如、心電圖及血壓之量測等常用之生理訊號，利用訊號分析系統將量得之訊號轉
譯成使用者能瞭解之資訊呈現。本計劃將推動可攜式生理訊號不同之用法，提供
老年人與失能者生理訊號量測儀表，提高使用率，發展生理訊號擷取、紀錄、
傳輸及實時分析平台，並結合其他子計劃中的行動位置監視，實時無線傳輸，
可以讓老人的行動不受到限制，且達到無線居家照顧的理念。第三年整合弟及
第二年之技術成果以 FPGA 做為平台發展個生理系統分析晶片平台，此成果報
告將包含所累積之成果及 FPGA 為基礎之生理訊號分析平台晶片設計，三年之
計畫共申請了 10 各發明專利。 
關鍵詞：即時訊號處理硬體平台、可攜式生理訊號分析系統、心率變異、無線傳
輸、血壓分析 
前言 
 本研究發展一套可長時間蒐集資料並且即時分析心率變異度的SoC系統做
為系統平台，以心電圖之生理訊號擷取，做 HRV(Heart Rate Variability)分
析前處理運算，透過 FFT 演算法，即可達到心率變異度在頻譜上的分析做為系
統施行之展示，本系統可長時間蒐集個人的生理資訊、即時分析心率變異度在
時域、頻域上的變化，日後便可定期或者隨時比較個人心率變異度的變化，即
可立即得到個人個體差異值，達到即時監控分析效果，藉此顯示系統發展之成
果已達到可攜式即時醫療訊號蒐集與分析系統利用於發展老年人長期健康照
護之目的。 
此份報告敘述可攜式即時醫療訊號蒐集與分析系統平台發展，之發展過程
及最後研發成果研發成果，所有研發成果共申請了 10 個發明專利，所有之發
明專利皆有實體可驗證之雛形成品，所申請之發明專利之名稱如下： 
1. 具即時分析生理訊號之醫療裝置 
2. 接觸式感測裝置 
3. 睡意辨識系統 
4. 可記錄生理訊號之醫療裝置 
5. 心率變異度之量測方式 
6. 心律變異度之量測耳機 
7. 心率變異之量測裝置 
8. 心率變異之量測電路 
9. 具測量血管硬化之血壓計 
間心率不整發生次數，及心率不整之狀況，提供醫師參考，可減少溝通不良之
情形並提供醫療檢查之方向，提高診察治療時效，使病人回復正常生活等，此
等例子有效施行後，可讓醫療單位能夠或得更多有關病患的生理相關資料並降
低健保給付。 
本計劃所針對的對象主要為老年人與失能者，主要可以區分為兩類，一為
可自由行動的老人，其二為不可自由行動之老人與失能者。對於可自由行動的
老人，實時無線傳輸生理訊號技術可以讓老人的行動不會因為長時間監測而受
到限制。結合其他子計劃中的行動位置監視，可用定位技術監控可自由行動但
容易走失的老人，達到無線居家照顧的理念。 
 第二年著重在建構（1）連續血壓波形分析; （2）發展其他生理訊號及與
本整合相關資訊讀入裝置;（3）可硬體實現之心電圖分析方法之研發; （4）
以FPGA作處理在平台結合在FPGA所設計之數位訊號處理（DSP）用來將ECG 訊
號從時域轉換到頻域並且在頻域分析病患的心率變異。在可攜式裝置上以軔體
做數位訊號處理，監測病患的心率變異度(HRV)，及時提供警訊，提供使用者
就醫時之參考資料。 
第三年彙整前兩年之發展成果著重在建構一個可程式化之生醫訊號處理
平台，前兩年之研究成果顯示，生醫訊號之分析與處理需要時間與頻率之分析
與處理才能運用，因此、生醫訊號處理平台之雛形以FPGA建構一套微控器及富
利葉訊號轉換器（Fourier Transformation）以平行處理方式處理生醫訊號。 
研究目的 
本計劃的實時生理訊號無線傳輸系統主要目的在於能夠及時擷取病患生
果。本系統核心使用 Altera cyclone II  EP2C35F484C6 FPGA 晶片，完成心
率變異度即時頻譜分析系統平台，其所有演算模組及周邊控制均由一顆系統核
心 FPGA 晶片實現，生理資訊可以在系統裝置中儲存及顯示，也可以透過 USB
通訊傳輸介面與電腦溝通，經由 Borland C++ Builder 編輯撰寫視窗化軟體使
用者介面程式，顯示系統平台的分析結果及儲存。 
第三年目的在於發展一套以FPGA (Field Programmable GateArray, 現場
可程式化邏輯閘陣列)為核心的SoC(System on Chip)系統平台，並控制整合周
邊裝置、LCD、USB、Flash Memory、SRAM Memory；建構可程式化MIPS (Million 
Instructions Per Second)運算系統及即時平行處理輸入訊號之功率頻譜（FFT
，Fast Fourier Transform），分析生理訊號達到可程式化運算即時量測分析
的效果。以FPGA可程式化系統晶片針對生醫訊號處理之時域及頻域分析需求，
設計以MIPS架構為基礎之具體可行生醫晶片訊號處理系統晶片指令集共有兩
類，可做即時訊號處理，資訊儲存，及資訊顯示等。將以心率變異度分析為例
研發之生醫電訊號處理特殊需求之SoC系統晶片與平台，建置與驗證之生醫訊
號處理雛型系統。MIPS的設計以Pipeline架構之完成設計，其指令集分為兩大
類：尋常指令集在生醫晶片上主要功能為搬動資料判斷比較資料等；特殊指令
集為起動平行運算旗標。系統運算流程分為兩大主軸：MSIP主要運作為QRS自
動偵測(微分-絕對值-視窗平均法)、Berger重新取樣定理(Resample)等處理；
即時運算FFT頻譜分析，系統可將原始訊號及運算結果送出，經UART至電腦端
接收顯示分析，將即時運算之FFT頻譜結果將與MATLAB運算FFT頻譜結果作驗證
比對，其驗證頻譜圖結果為一致；並且將已知的公式數據代入未知的系統做驗
術，在一定距離內將心電圖及心率變異特性傳輸至監測主機上(電腦)，可在不
致限制了病患的活動下(亦可將本系統安置在輪椅上)，協助醫師即時監測身心
障礙者、心臟血管病患心電圖及心率變異特性變化情形[4]。 
蔡安津等人設計接受血液透析之慢性腎衰竭患者之心率變異性分析，血液
透析治療中體液電解質之改變亦會造成心律不整，尤其是鉀離子過高或過低皆
會引發心室型心律不整。為了能即時得知心率之變化，以 5 分鐘心電圖做時域
及頻域之分析，取得時域及頻域之各項參數。為了找出電解質與自主神經系統
之相關性，本研究就透析前後電解質濃度與心律變異性參數比較並找出其相關
性[5]。 
李啟弘等人設計以時域和頻域的方法來探討禪坐心電圖的特性，分析方法
為時域分析和頻域分析，而其結果是根據一些要素如受測者的性別和坐姿來加
以分析，最後量化的特徵將依時域和頻域分析中的各個參數以 FCM(Fuzzy 
C-means)來作分類。由實驗結果得到兩個結論：(1) 在時域分析方面，實驗組
中採雙盤坐姿的受測者平均來說，在禪定過程當中所有的參數值(Standard 
Deviation of R-R interval, SDRR 、 Root-Mean-Square of Successive 
Difference,RMSSD)都是減少的，而控制組平均而言，參數 SDRR 和 RMSSD
在休息過程中是呈現增加的趨勢；(2) 在頻域分析方面，代表交感神經活性的
參數 nLF 和代表自律神經系統平衡的參數 Ratio of LF/HF，實驗組中採單盤坐
姿的受測者平均來說，是低於控制組的；相反的，代表副交感神經活性的參數
nHF、HF，實驗組中採單盤坐姿的受測者平均來說，則是高於控制組的[6]。 
林汶正等人設計以 PSoC設計可程式微控制系統晶片為基礎之生理訊號監
的生理訊號的規格及量測方法。在本論文中以心電圖與腦波之分析之流程為
例，因此、本章節討論將以心電圖、腦波以及系統架構所包含之相關理論背景、
相關資訊、心律變異度頻譜分析之前處理的各種運算以及 FFT 演算法。 
表 1 人體生理訊號參數與量測方法 
 
 
心電圖簡介 
心臟的肌肉是人體肌肉中，唯一具有自發性跳動及節律性收縮的肌肉。心
臟肌肉收縮是由於一連串的心肌去極化、再極化的過程所促成，此一過程產生
的電流傳怖全身，可藉由貼於表皮的電極感應出來，經機器的描繪波形顯示，
即為心電圖(Electrocardiogram 簡稱 ECG)。心電圖描繪了此一心肌收縮電流的
起源、順序、方向、大小及間期的長短，提供了解心肌電生理活動的參考。 
正常心臟傳導系統包括︰竇房結（S-A node）、房室結（A-V node）、希氏
束（bundle of His）、左右束支（left and right branch）和蒲金氏纖維（Purkinje 
fiber）。還包括結間束及房間束。其分布如圖 2-1。肌肉的跳動是受神經的電波
控制的，而神經的末端可以接到竇房結，所以電波可以由竇房結再傳到心房、
房室交界區、心室內希氏束、左右束支、普金氏纖維、心室肌，引發心肌協調
收縮，維持心臟正常節律和排血功能。而心肌是由很多很多的肌肉細胞所構成
（Purkinje Fiber）中。由於竇房結細胞自動去極化的能力最強，因此，它主宰
了心臟的節律。 當心臟跳動時，心電圖由 12 個不同的軸來記錄心臟的電氣
活動，其中包含了 6 個額平面導程為標準雙極導程（bipolar standard leads）與
加壓單極肢導程（unipolar augmented extremity leads），標準雙極導程所測得訊
號為兩特定點之間的電位差，分別將電極連接於左手、右手及左腳之上，量取
兩電極間的電位差，得到三組訊號，如圖 3 所示[10]。以及 6 個橫平面導程為
胸導程(chest leads) 是將 LA、RA、LL 三肢的電極分別經由緩衝放大器輸出，
共同連接在一起，形成中心點，再與單極訊號形成電位差。胸前導程通常使用
的接法為 V1、V2、V3、V4、V5、V6，其各相關導程。 
 
 
Lead I = LA-RA 
Lead II = LF-RA 
Lead III = LF-LA 
Bipolar leads(雙極誘導)及 Einthoven 正三角形[10] 
V2：左側第四肋間胸骨線 
V3：在 V2 -- V4 之中點 
V4：左側第五肋間索鎖骨中線上 
V5：左側第五肋間前腋線上，於 V4、V6 間之中點 
V6：左側第五肋間中腋線上 
 
心電圖(ECG)波形的組成包括了 P 波，QRS 複合波(complex)，T 波及 U
波。如圖 2-5 所示。 
P 波：竇房結向外傳道心房心肌細胞，造成心房去極化，範圍為 0.06~0.11
秒，正常< 25mm 在 aVR 必為負波 (negative)，aVF 必正波(positive)。 
QRS 複合波：代表心室去極化收縮，正常不超過 0.1 秒，R 波在 aVL 須
小於 13mm，在 aVF 須小於 20mm。QRS axis 正常為負 30 度
到正 90 度，Q 波正常小於 0.04sec 寬，深度須少於同誘導
之 QRS 高之 25%。 
T 波：代表左、右心室去極化後，再極化(repolarization)時所產生的波，
正常小於 45 度。 
U 波：代表心室內 Purkinje fiber 的再極化，正常為小圓的向上波，約為
同誘導 T 波的 5-25%,在 V2-V4 最高。 
PR interval：評估心房至心室間的傳導速度，正常值約 0.12 - 0.20 秒 (3-5 
小格)。 
ST segment：心臟早期的再極化，ST segment 位置(高低)較長短來得重要，
在基線(baseline)，不能偏離基線上、下 1mm(± 1 mm)。 
譜圖可分為：高頻(high frequency,HF ) 0.15~0.4 Hz；低頻(low frequency,LF ) 
0.04~0.15 Hz；超低頻(very low frequency,VLF ) 0~0.04 Hz；低頻功率代表交感
與副交感神經系統共同作用，高頻功率則代表副交感神經系統作用的情形，高
頻部份大約( 0.3Hz )與呼吸有關，其主峰頻率即為呼吸頻率[14]。 
 
心率變異訊號 
特徵點偵測所得到的 QRS 波取其相鄰 R 波之間距，但每一個 R 波出現的
時間間隔並不一樣，此間距在時間上可以代表即時心率（instantaneous heart 
rate）， 並非等時距取樣的訊號，而執行頻譜分析時，均要求所要處理的時間
序列訊號係經均勻取樣處理後的，為了避免頻譜失真，使用 Berger 等人於 1986
年提出的視窗內插法來執行再取樣工作。[18] 
假設再次取樣的頻率為 5Hz，而原來的取樣頻率為 303Hz，將原來的取樣
頻率除以再次取樣的頻率再乘以二，可得原訊號每隔約 121 個取樣點（取樣區
間）產生一個新的心率訊號點，其大小之決定可依兩個規則： 
（1）當新取樣點前後各一個取樣區間僅分佈在一個 R-R 間隔（I2），則
其大小為 a/I2。 
（2）當新取樣點前後各一個取樣區間分佈在兩個相鄰 R-R 間隔（I3、I4），
則其大小為 b/I3+ c/I4。如此便得到了等距時間取樣的心率訊號。  
 
般區分為高頻功率( 0.15~0.4Hz)與呼吸有關，其主峰頻率即為呼吸頻率；低頻
功率( 0.04~0.015Hz)來自壓力接受器的反射調控，與體內恆定性有關；極低頻
功率( 0.0033~0.04Hz)來自末梢血管舒縮張力的律動，與熱調節有關，影響不
同頻帶的各項成因，可大致分為以下三種生理作用機制，如表所示[12][13][24]。 
 
 
心律變異度分析於各頻帶之影響生理機制[14] 
 
 
        心律變異度（HRV） 
VLF（0~0.04Hz）  溫度調節系統 （Thermoregulatory system） 
LF（0.04~0.15Hz）  交感神經以及副交感神經活性交互影響 （Sympathetic and Parasympathetic activity） 
HF（0.15~0.4Hz）  副交感神經活性以及呼吸影響 （Parasympathetic and respiratory activity） 
 
 
(a)心率變異度頻譜主要的三個頻峰。 (b)副交感神經抑制時之頻譜[14] 
 
QRS 特徵點的偵測 
心電圖波形中以 R 波的振幅最大且特徵最明顯，一般在做心率分析時，
首先必須偵測 QRS 波的位置，再透過閥值之設定將 R 波的峰值位置找出，藉
以算出 R 波和 R 波的間隔時間（R-R interval,RRI），再由 R 波和 R 波之間的間
 
心電圖 QRS 波偵測。（a）原始心電圖訊號； （b）經過帶通濾波器處理過之訊號； （c）
取其絕對值平方後之訊號； （d）最後經低通濾波後之訊號，每一個峰值代表一個 QRS 
波。[17] 
 
腦波簡介 
腦神經細胞的活動，可用神經電生理的方法偵測而得到腦波。早在 1875
年，英國利物浦的生理學教授李察卡通首度從兔子的大腦皮質表面紀錄到記錄
到一種電波，此電波與呼吸或心跳無關，是一種腦部的生理變化，隨著動物受
麻醉或缺氧而破壞，且動物在死亡後消失。後來他又發現刺激動物的身體能使
腦波發生變化，他利用這種變化來研究身體之部位與大腦皮質區的關係，並探
討大腦皮質區的功能，成為後來神經診斷學中誘發電位（evoked potential）發
展的基礎。 
一直到 1929 年，從李查克通發現腦波以後經過了 50 多年，一位德國精神
科醫師漢斯伯格（Hans Berger），經過多年潛心研究，在人類完整的頭蓋骨上
紀錄到相同的電氣活動，這是首次發表人類的腦波記錄，並命名為腦電波圖
的較多。 
Alpha(α波)：α波的頻率是 8~13 Hz，呈現著像正弦曲線的波形，振幅都
在 20~80 微伏左右，α波是於安靜閉眼時顯著的出現，但
張開眼就減少或消失，又閉眼時給予光刺激的話即可看到
刺激後的零點五秒~數秒鐘之久的α波之消失或抑制，此
外加以音或觸、痛覺之刺激時，也會出現同樣的抑制。 
Beta(β波)：β波為 13.5Hz 以上的波。在安靜閉眼的全部正常成人多少都
會出現，於額葉的前半部(從額葉前面至中央區)較多，有
時在顳葉也會出現，振幅為 10 微伏以下，但數微伏的為
多，到了年老時比年輕者，β波的出現就多起來了，又因
開眼而α波就被抑制，取而代之在枕葉出現β波。 
現今使用的腦波電極位置是依據國際通用的 10-20 的腦波電極裝置法；裝
置前量測腦殼半球圓周長，然後以其 10%及 20%長度切等分，而將等距的電
極置放位置標示出來，如圖所示。 
 
時頻域分布圖去觀察長時間睡眠的變化。 
 
MIPS CPU 介紹 
MIPS CPU 依指令執行的階段可分成五個 stages，分別為指令擷取
(instruction Fetch)、指令解碼(instruction decode)、指令執行(execution stage)、
資料記憶體儲存(data memory)、資料寫回暫存器(write back)五個階段，圖為指
令執行經過每一個階段的先後順序。 
 
z Instruction Fetch(指令提取階段) 
在指令提取週期，CPU 提取存放在指令記憶體裡的指令，對指 
 
Instruction 
Fetch
Data 
Memory
Execution 
Stage
Instruction 
Decode Write Back
 
指令執行階段與順序[32] 
 
令記憶體而言，指令記憶體依 CPU 運算過後的 PC 值，作為指令在記憶體取
得的位置，將提取的指令與下一個位址值送至下一個階段。 
 
z Instruction Decode(指令解碼階段) 
在此階段 CPU 依前一個階段(指令提取階段)所提取的指令作解碼，其中一
部份送至控制單元(control unit)，讓控制單元依照指令送出控制訊號，控制各
個單元的動作，另外一部分則是送至暫存器，依照接收到的數值對應於暫存器
的位置並且將暫存器內的數值傳送出去，同時暫存器接受暫存器讀寫的控制訊
號，可以選擇將資料寫入暫存器中。 
 (1)R-type 指令： 
R-type 指令前第 31bit~26bit 為指令的運算碼，25bit~11bit 分三組 5bit 放置
暫存器(Rs、Rt、Rd)的位置，第 10bit~6bit 放置指令的偏移值(Shamt)，最後 6bit
放置 R-type 的功能碼，此指令集主要為算數及邏輯運算指令集，如 ADD、
SUB、AND、XOR…等等的指令，MIPS 大多數的指令為此指令格式，例如： 
add $s1,$s2,$s3        //  $s1= $s2+$s3; 
and $s1,$s2,$s3       //  $s1= $s2&$s3; 
xor $s1,$s2,$s3       //  $s1= $s2|$s3; 
 
(2) I-type 指令： 
I-type 指令前第 31bit~26bit 仍為指令的運算碼，25bit~16bit 分兩組 5bit 放
置暫存器(Rs、Rt)的位置，最後面 15bit 為立即資料，其指令的功能包含對立
即值的算數邏輯運算指令、分支跳躍指令、載入儲存指令，例如： 
addi  $s1,$s2,3       //  $s1= $s2+3; 
beq  $s1,$s2,JUMP   //  if($s1==$s2)PC=PC+JUMP; 
 
(3) J-type 指令： 
J-type 指令前第 31bit~26bit 仍為指令的運算碼，後面 26bit 為跳躍位置，
包含跳躍指令，例如： 
J 20             //  無條件跳躍至 20 的位置 
本研究指令集將以心電圖與腦波圖做頻譜分析前的參數萃取所需指令設
計，兩者均透過 ADC特殊指令將外部 AD資料傳送至 MIPS 做運算；以及由 FLASH
及 FFT 指令將資料作儲存與傳送至 FFT 演算法做運算，心電圖做 QRS 波偵測及
pipeline MIPS CPU 與 signal cycle CPU 不同的地方除了指令執行方式的不
同外，另外還多了許多硬體，如管線暫存器、前饋單元、危障單元、以及多工
器等等，其硬體架構與資料路徑如圖所示，利用四個管線暫存器(IFID register、
IDEX register、EXMEM register、MEMWB register)將 CPU 切成五管。[32,33] 
 
 
分割成五管 Pipeline MIPS CPU 的五個階段指令執行狀況[32] 
 
 
圖2-2 Pipeline MIPS CPU 的架構及 Data Path 路[32] 
數位訊號處理(FFT 演算法) 
數位訊號處理可以應用於廣泛的領域，只要經過數位化之處理過程，均屬
於數位訊號處理範圍，本系統要做頻譜分析。因Radix-4的快速傅立葉轉換(FFT)
演算法運算效能比 Radix-2 的快速傅立葉轉換(FFT)演算法來的快速，主要是具
有更少的分解層數，所以計算 DFT 時所需要的總乘法數降低，因此使平台用
的頻譜分析演算法是 Radix-4 的快速傅立葉轉換(FFT)演算法。 
  
(a)radix-2 FFT 演算法，(b) radix-4 FFT 演算法[34] 
 
 
 
 
生理訊號主要闡述交感與副交感神經系統交互作用與調控所產生的變異
特性反映出心率變異度之生理意義與背景，在心電圖之生理訊號擷取，萃取參
數之演算法包含 QRS 波自動偵測(微分-絕對值-視窗平均法)、RR-interval 擷取
並做 Berger 重新取樣定理，將取樣後之訊號由 FFT 演算，即可達到心率變異
度在頻譜上的分析，可以直接對自律神經功能的變化給予量化性的描述。 
MIPS 微控器闡述指令執行的階段可分成五個 stages 和三種指令格式及
pipeline MIPS CPU 與 signal cycle MIPS CPU 之設計差異。 
本研究主要以可程式化萃取不同生理訊號的參數並做頻譜分析。ㄧ個有特
殊疾病的病患，透過即時頻譜分析來觀察自主神經調控是否失調，由自主神經
調控機制頻譜的顯示來預知特殊疾病是否有發作現象。因此本系統將利用現場
可程式邏輯陣列系統晶片(field programmable gate array, FPGA)為核心，建構實
系統發展規格 
先透過生理訊號擷取卡擷取生理訊號(Ex：ECG、EEG、EMG…等)，並用
ADC0804 晶片做 A/D(analog-to-digital)轉換，以 FPGA 為系統核心做 MIPS 微
控器及數位處理單元如快速傅立葉轉換，MIPS CPU 運算萃取生理訊號參數與
傳送萃取參數至快速傅立葉轉換，以達到心率變異度在頻譜上的分析，並控制
周邊裝置 LCD、FLASH、USB 等，完成可長時間即時分析顯示 HRV 頻譜變
化於 LCD 上與電腦端，電腦端顯示部份是透過視窗化軟體 Borland C++ Builder
編輯撰寫，發展一套可程式化生醫數位訊號處裡晶片之 SoC(System On Chip)
系統平台。 
有許多國內外學者做一些相關研究，用心率變異度來評估人體的生理參
數，心率具有週期性的變化，心跳速率與血壓會有變異，且呼吸週期、血壓與
心跳週期之間具有相關性。心率變異的分析方式可以分為兩種 : 一是用時域
(time domain)分析，二是用頻域(frequency domain)分析，將心率變異度作
功率頻譜分析，可發現心率的頻譜上有三個主要頻帶，低頻部份(小於 0.04 Hz)
與末梢血管舒張力有關，中頻帶部分 (0.10~0.12Hz) 與壓力接受器
(baroreceptor)的反射調控有關， 高頻帶部份(0.3 Hz)則與呼吸有關，其中
高頻帶的主頻就是呼吸頻率。是故心率變異度有其正常的變動範圍，我們計畫
將心率變異異常的時間點與異常值找出來加以記錄分析或即時傳送到醫療單
位藉以找出病患心率異常的因素，以期能及早預防病情的惡化。 
在 1991 年 Francisco Vaz 等人便發展了一套遠端監控病人心電圖的系統
模型，他們將病人的 EEG 信號經過 A/D 轉換，經由個人電腦與 DOS 的環境透過
心率變異度的高低可以反應一個人的自律神經是否失調，1975 年 Hyndman 
等人首先利用功率頻譜分析應用於心率變異度的研究分析上，由功率頻譜圖下
發現三個明顯的尖峰值存在，他發現低頻( 0.02~0.09Hz )來自末梢血管舒縮
張力的調節，與熱調節有關；中頻( 0.1~0.12Hz )來自壓力接受器的反射調控；
高頻部份( 0.3 Hz )與呼吸有關[1]。Akselrod 等人於 1981 年的研究，就更
確立心率變異之頻譜可以反映出自主神經系統作用的論點。他們的研究提出低
頻頻譜訊號 : 0.04~0.15Hz 與交感、副交感、腎素血管收縮素有關，而高頻
頻譜訊號 :  0.15~0.4Hz 與副交感神經活動有關[2]。1996 年歐洲心臟學會
和北美電生理學會公開發表及制訂有關心率變異訊號量測與標準：頻譜分析後
之頻域的範圍定在 0.04 至 0.4Hz 之間，高頻( High Frequency, HF )定在
0.15~0.4Hz，反應副交感神經調節；低頻( Low Frequency, LF )定在
0.04~0.15Hz，為交感、副交感神經所作用；LF/HF 為交感與副交感神經作用
之平衡指標，並完整的描述，供後續研究者參考[3]。 
 
第一年研究方法 
第一年研發之系統其系統硬體主要包括：（1）訊號前處理模組（2）MSP430
微控制器與周邊硬體（3）PCI 數位輸出入卡、USB、Bluetooth 部分，做為乒
系統規格之雛形。 
 
 
 
結果 
以 ECG 及 EEG 為例，當作前端所要擷取的生理訊號，主要訊號頻率訊號都
在 1Hz~40Hz 左右， 類比訊號模組分為儀表放大、濾波線路、放大、減法四
部分，可以用此類比訊號模組結取 ECG 及 EEG 訊號，已完成的硬體線路如下圖
所示。 
 
類比訊號模組頻率響應圖，實測結果高通截止頻率在0.5Hz，低通截止頻
率在40Hz，再60Hz有個帶拒濾波效果符合原始電路設計之規格。 
 
目前發展出的可攜式即時醫療訊號蒐集平台，由 MSP430F149 作核心搭配
周邊硬體，可長期擷取ㄧ個通道心電圖、六個通道腦波圖，如下圖所示： 
取樣頻率以 200Hz 為例，擷取ㄧ個通道的 ECG 訊號以及六個通道的 EEG 訊
號，所使用的 Flash Memory 為 128 MByte。4 顆三號電池為例來當電源，容量
為 2500mAh，整體消耗電流為 140mAh。 
 
 
討論 
本年度已發展出的可攜式即時醫療訊號蒐集平台，下年度將透過硬體直接
運算，將已數位化的 ECG 資料經由快速傅立葉轉換到頻域，求出心率變異的參
數。硬體可使用 FPGA 或者是市面上現有的 SOC 系統整合晶片(合邦 A122)，我
們打算透過這兩種方式並行分別去執行。SOC 系統整合晶片(合邦 A122)，包含
ZSP、RSC51、PIC 三個處理器，可在硬體設備上直接做 DSP 運算，可以減少所
量測到的訊號在外部硬體與電腦間做傳輸的次數，也就是可以一次傳輸就直接
將完整有用的訊號傳輸到電腦。未來會把 MSP430 系統轉移 SOC 晶片上。 
 
輸至電腦端顯示儲存；而電腦端的顯示分析、儲存方面是透
過視窗化軟體 Borland C++ Builder 來編輯撰寫。 
本系統平台設計之即時心率變異度頻譜分析流程如圖(2)
所示，經由心電圖之生理訊號擷取，其後做的演算法包含 QRS
波自動偵測(微分-絕對值-視窗平均法)、RR-interval 擷取
並做 Berger 重新取樣定理[4]，得到頻譜轉換之輸入訊號，
透過 FFT 演算，即可達到心率變異度在頻譜上的分析，可以
直接對自律神經功能的變化給予量化性的描述。 
在模組電路設計實現方面，本系統使用 Verilog HDL 語
言，以 50MHz 的時脈為主系統頻率下去設計本系統平台所要
求的規格與功能，並以平行處理的方法下去設計模組電路，
在同一時間點同時做許多運算處理，即可使執行功能的時間
大幅的縮短，以達到即時的效果。 
ECG擷取
類比電路處理
MSP 430
微控制器
AD轉換
FPGA
系統核心
運算及周邊控制
LCD
即時顯示ECG
、HRV訊號
Flash
儲存ECG訊號
Flash
儲存HRV訊號
USB
即時傳輸訊號
PC
即時顯示儲存
HRV訊號
 
 
圖(1) 硬體架構方塊圖 
及 PORT 3 提供與 Flash Memory 的通訊埠口，可做記憶體的
寫入、讀取以及抹除。由 PORT 4 及 PORT 5 提供與 LCD 的通
訊埠口，可顯示即時的訊號波形，以及相關的功能選單。訊
號經由 MSP430F149 處理後可經由 USB、PCI 輸入輸出卡、
Bluetooth 傳送出去，以達成接收人體生理訊號。 
USB 傳輸介面是利用 PL-2303HX 將 RS232 的訊號轉換成
USB 傳輸到電腦，傳輸速度可從 75 bps to 12M bps。工作
電壓 3.3V~1.8V。 
 
結果 
以 ECG 及 EEG 為例，當作前端所要擷取的生理訊號，主
要訊號頻率訊號都在 1Hz~40Hz 左右， 類比訊號模組分為儀
表放大、濾波線路、放大、減法四部分，可以用此類比訊號
模組結取 ECG 及 EEG 訊號，已完成的硬體線路如下圖所示。 
 
類比訊號模組頻率響應圖，實測結果高通截止頻率在
0.5Hz，低通截止頻率在40Hz，再60Hz有個帶拒濾波效果符
20cm*15.7cm*6cm。左上角的圖為正面俯視圖，包括 LCD 面
板、按鍵、LED 等；右上角的圖為 USB 連接口；左下角的圖
為電源輸入口與電源開關、LCD 背光開關；右下角的圖為 ECG
電極以及連接口；系統平台在 LCD 上可以顯示即時 ECG 訊
號，如圖(4)所示，也可以切換顯示即時 HRV 訊號，因為在
LCD 顯示程式並沒有編寫點跟點之間連線，所以 LCD 顯示 HRV
訊號是以點來表示其值，比對電腦端收到的即時 HRV 訊號，
確實為同一筆資料，如圖(5)所示。 
本系統在電腦端的軟體實現是使用視窗化軟體 Borland 
C++ Builder 編輯撰寫，可透過撰寫的程式來顯示分析結果
以及儲存於電腦端，其編譯的使用者程式介面如圖(6)所
示，包括串列傳輸的通訊協定，用來與系統裝置做溝通；2
個 HRV 功率頻譜分析圖，顯示頻率範圍分別為 0~1.5Hz 以及
0~0.5Hz，可用來觀察 HRV 曲線的功率頻譜變化，其中又以
0~0.5Hz 的頻域範圍最具有生理意義，可用來觀察交感神經
和副交感神經的變化；1個時頻域分析圖，可用圖示的方法，
利用色彩的分佈來監測長時間的 HRV 頻譜變化；1 個 ECG 顯
示圖，在 Off Line 的時候可將量測儲存於系統裝置的 ECG
訊號讀取至電腦端儲存顯示。 
系統平台所運算出來的 HRV功率頻譜分析結果如圖(7)所
示，Matlab軟體所運算出來的HRV功率頻譜分析結果如圖(8)
所示，兩者運算是使用相同的 1024 點 Resample 值為輸入訊
號，圖(9)為系統平台運算出來的結果與 Matlab 運算出來的
結果做相減，其誤差範圍大約都在 0.2 左右；將 FPGA 系統
平台運算結果與 Matlab 運算結果比較其線性相關度 R2值，
如圖(10)所示，結果顯示，如果包含第一筆 DC 值，其線性
相關度 R2值高達 0.9999，若不包含第一筆 DC 值，如圖(11)
所示，其線性相關度 R2值可以高達 0.9922，由此可得知其運
算結果幾乎是完全一樣，誤差值相當的微小，即可證明經由
本 FPGA 系統平台運算出來的結果準確度相當的高，具有相
當大的可靠性。 
 
圖(7)系統平台 HRV 頻譜分析演算結果 
測者坐在可靠背椅子上作聽抒情音樂休息以及身心作較劇
烈之互動運動(如電腦互動遊戲)兩種不同狀態下的實際量
測，每種狀態的測量時間大約各 40 分鐘左右。觀察期測量
結果，受測者在聽抒情音樂休息狀態下的 HRV 時頻域分析圖
如圖(12)所示，在身心作較劇烈之互動運動下的 HRV 時頻域
分析圖如圖(13)所示，可以很明顯的發現，在聽音樂休息的
狀態下，由於心情放鬆，呼吸則會比較平順，呼吸速度變異
不大，經由長時間蒐集心率變異度的時頻域分析圖可發現，
在高頻部份很明顯的會出現一條平穩的曲線；而在身心作較
劇烈之互動運動的狀態下，由於情緒興奮，其呼吸速度變異
也很大，時頻域分析圖則呈現比較雜亂的分布。 
 
圖(12)受測者時頻域分析圖(聽音樂休息) 
將訊號存檔並將長時間量測的血壓（另附圖於後）、ECG 及
EEG 訊號顯示在螢幕上〉。 
透過 ECG 訊號，找出每個 R波，求出 R-R Interval，並
做重新取樣的動作，再把重新取樣的值做快速傅立葉轉換，
把時域之心博週期轉成頻域之心率頻譜，觀察心率變異，進
ㄧ步去求得心率變異度的高頻與低頻成分比例。如下圖可找
出心率變異度中的高低頻比例。 
本年度已發展出的可攜式即時醫療訊號蒐集平台，硬體使用 FPGA
及市售的 SOC 系統整合晶片(合邦 A122)，透過這兩種方式並行完成
發展平台之設計，透過硬體直接運算，將已數位化的 ECG、EEG、及
血壓資料處存並傳送至 PC 電腦，經由快速傅立葉轉換到頻域，求出
心率變異的參數。合邦 A122 SOC 系統整合晶片，包含 ZSP、RSC51、
PIC 三個處理器，可在硬體設備上直接做 DSP 運算，可以減少所量測
到的訊號在外部硬體與電腦間做傳輸的次數，也就是可以一次傳輸就
直接將完整有用的訊號傳輸到電腦。 
第三年成果 
生理訊號監測系統係指對病患之心電圖、腦波圖、血壓及呼吸等
生理訊號做監測之系統，可同時具有長期記錄病患之生理狀況、統計
分析及顯示圖表等功能。透過分析心率變異頻譜可觀察心率變異頻譜
居家看護之目的，一些體積小、重量輕、價格便宜的醫療儀器已成為
現在趨勢。隨著微電子技術迅速發展，積體電路製程技術有了很大的
提高，使得單位面積之矽晶片能放入上億的電晶體元件，因此積體電
路趨向於系統晶片(system on chip,SOC)設計，系統晶片不在是單一
種功能而是可以架構實現各種生理訊號監測系統的訊號控制與演算
法運算處理，因此可以提昇許多的功能性、縮小整個電路的面積與重
量及降低成本，讓特殊疾病的病人能夠攜帶方便及長期的監測。本研
究將以系統晶片之概念設計一個可程式化的生理訊號監測，其在不更
改架構下，修改指令碼來達到萃取不同生理訊號參數並做頻譜分析，
指令集將以心電圖與腦波需求之分析所設計之。 
本研究主要是發展一套可程式化之即時生理訊號資料參數萃取
之生理訊號處運算器，可即時分析生理訊號頻譜如心律變異度或腦波
的 SOC 系統晶片平台，系統能夠針對不同生理訊號來源，透過可程
式化修改所要萃取的參數方式，並且做即時的訊號運算與顯示。本章
節描述了 FPGA 為核心架構出 pipeline MIPS CPU、周邊控制驅動與
FFT 頻譜分析生理訊號系統裝置，如圖 3-1 所示。並描述 pipeline MIPS 
CPU 與 FFT 頻譜分析生理訊號系統各環節的組成結構與流程，包括
MISP 指令執行 QRS 自動偵測、Berger 重新取樣定理等和 FFT 演算
法及視窗化軟體 Borland C++ Builder 編輯顯示資料與分析。 
儲存 FLASH 裝置，用電腦端使用者接收資料介面透過 UART 接收
FLASH 資料儲存於電腦端做資料分析與顯示。 
 
 
圖3-2 系統架構圖 
FPGA 現場可程式化邏輯閘陣列 
FPGA 的全名為 Field Programmable Gate Array，它是由許多邏輯
元件(logic cell)經由垂直通道(vertical channel)及水平通道(horizontal 
Channel)的連線所構成。一般而言，FPGA 之邏輯元件間及對應的 IO 
繞線採用複雜長距離之網路繞線，可繞性強，邏輯元件使用率高，但
長繞線同樣的造成頻率響應較低。 
FPGA 和 CPLD（complex programmable logic device）都是可編
程的 ASIC 元件，可供使用者編程的邏輯閘元件，以硬體描述語言
（Verilog HDL 或 VHDL）所完成的電路設計，可以經過簡單程序的
合成與佈局，快速的燒錄至 FPGA 上進行測試，是現代 IC 設計驗
Cyclone II FPGA系列的封包選擇與I/O最大使用數[35] 
 
 
Cyclone II Device Resources[35] 
 
 
表為 Cyclone II 裝置的資源，圖為 Cyclone II 的邏輯元件單元
Logical Element (LE) 方塊圖以及邏輯元件單元之正常模式與運算模
式的方塊圖。 
 
 
LE in Arithmetic Mode[35] 
 
硬體描述語言(Hardware Description Language) 
長久以來電腦程式設計語言(如 C、FORTRAN、BASIC)以循序方
式由上而下逐一執行指令。以此方式欲描述具有並行處理或共時性
(concurrent)硬體動作之特性，傳統電腦語言根本無法發揮。因此一種
全新針對硬體共時性特色而設計之硬體描述語言於焉誕生，一般而言
硬體描述語言需擁有以下特性： 
(1) 具有共用性 
(2) 好的設計方法及技術支援 
(3) 與技術及製程無關 
(4) 廣泛的描述能力 
(5) 具有設計之互換性 
(6) 利於大型 IC 設計及設計再使用 
 誤差值最大是±1LSB。 
 與 TTL、CMOS 相容。 
 可直接與微處理機相連。 
 
ADC0804轉換頻率主要取決於 CLK IN 與 CLK OUT之腳位上的
電阻與電容值，轉換頻率公式如式(3.1)，REF/2 腳位為參考電壓。 
  
RC
F
1.1
1=           式(3.1) 
本研究將以 5V 單電源提供，晶片內部轉換頻率約為 162KHz，
參考電壓為 2.5V，其設計控制流程圖(如圖 3-6)與應用電路圖(如圖
3-7)。 
 
控制流程圖 
 
 Flash 作用區塊圖[36] 
 
 
Array Organization[36] 
 
Flash memory 的程式設計流程，大致分為四個步驟：一、記憶體初始
化(如圖)所示；二、抹除區塊(如圖)所示；三、寫入流程(如圖)所示；
四、讀取資料流程(如圖)所示。 
 
 
Flash寫入流程[36] 
 
 
Flash資料讀取流程[36] 
 
圖3-4 PL2303HXD應用電路圖 
 
SRAM MEMORY 記憶體 
系統平台選用之 LCD 模組並沒有內部記憶體功能存在，資料傳
輸時只能顯示及時的資料，舊資料將會被覆蓋，須搭配一組 SRAM，
來解決此問題。因 LCD 模組為 320 x 240 x RGB 顯示畫面與 6.2MHz 
畫面掃描，所以將選用 ISSI 所生產的 IS61LV5128AL SRAM 
memory，此記憶體具有 512K x 8 bit 容量及存取速度高達 10ns，作用
區塊如圖所示。 
 
 
IS61LV5128AL 作用區塊 
中央處理單元基本架構 
中央處理單元主要的功能為執行資料的計算與控制資料的流
動，在整個架構將可分為算術與邏輯單元、暫存器、控制單元及記憶
體等部份。這些功能簡述如下： 
z 算術與邏輯單元： 
主要是執行算術與邏輯運算。此單元的運算模式是由控制單元的
訊號來決定的，且輸入資料來自於暫存器，運算結果也會輸出於暫存
器中。 
z 暫存器： 
主要功能為暫時儲存資料。一個中央處理單元的設計應該都會有
一個以上的暫存器以方便資料的儲存及管理，每個暫存器的資料儲存
與提供是由控制單元訊號決定之。 
z 控制單元： 
此單元為中央處理單元設計最重要的部份。主要負責中央處理單
元所有資料運算及流動的控制，來完成使用者所指定的工作項目。首
先控制記憶體的計數器來抓取指令碼以了解工作內容，在控制暫存器
及算術與邏輯單元來完成此工作內容，而不斷的重複以上的動作。 
z 記憶體： 
主要提供指令碼及儲存將來可用到的資料。指令碼的內容即是使
 
修改後Pipeline MIPS CPU架構 
Pipeline MIPS CPU 設計 
在討論 pipeline MIPS CPU 的整體架構後，以下將逐一討論每個
元件的設計。 
 
z PC(Programmer Counter) 
此單元可稱為程式計數器，其對應處理為程式遞增、BEQ 相等
跳躍指令、BNE 不相等跳躍指令、J 跳躍指令、Hazard 動作及 Branch 
Stalling 動作等指令與動作對應於 PC 運作處理，由於 PC 相對位址必
須作相加運算，因此必須使用加法器來運算要分岔的指令記憶體位
址；當 Hazard 動作或 Branch Stalling 動作輸出為 1 時將停止 PC 輸出
運作。 
 
z 指令記憶體 
指令記憶體外觀架構圖所示，其 code_data、address、clk 及
code_wren 為輸入；Instruction 為輸出。clk 為正緣觸發時才有動作；
code_wren代表資料的存取功能；指令碼 32位元定址資料由 code_data
載入至記憶體內；透過 address 的 10 位元數值變化來選擇指令碼資料
存取位置；Instruction 為指令碼資料的輸出。應此依上所述此空間容
量為 1k* 32bit。 
 
暫存器檔案 =
clk
Read
Register 1
Read
Register 2
Write
Register
Write
Data
Read
Data 1
Read
Data 2
5bit
5bit
5bit
16bit
write_data
WB_write_reg
IFID_RS
IFID_RT
read_data_1
read_data_2
zero
1bit
1bit
1bit
WB_RegWrite
16bit
16bit
 
暫存器檔案外觀圖 
 
 
寫入之功能；讀取部分沒有受到 clk 所控制，當讀取位址數值進入時，
暫存器檔案資料將立即輸出。當 Read Register 1 及 Read Register 2 資
料相等時 zero 為 1 則表示有可能為跳躍指令的運作，故需再與跳躍
指令作判別，如確定為跳躍指令時，將會抹除即將進入第二階段的
IFID 管線暫存器內的指令與資料。 
 
z 控制單元 
為 MIPS CPU 設計裡最重要的部份，這關係到每個指令的執行與
運算等運作，控制單元外觀如圖所示。此單元將可視為解碼器，各旗
標訊號動作將由 OP 來作解碼得到如表 3-6、3-7 所示。但當發生危障
(HALT)動作時，則將所有旗標訊號以'0'發送，可視為 NOP 動作。 
旗標對應訊號名稱 
歸屬階段 旗標名稱 對應訊號名稱 
指令擷取 
Branch Beq 
nBranch Bne 
Jmp J 
指令執行 
MovEn MOVI 
RegDst R_format MULT_DIV 
ALUSrc 
Lw  
Sw  
MOV  
I_data 
I_MD 
MOVI 
I_format I_data I_MD 
ALUOp(0) Beq Bne 
ALUOp(1) 
R_format 
I_data 
MULT_DIV 
I_MD 
ALUOp(2) MULT_DIV  I_MD 
資料記憶體儲存 
MemEn MOV 
MemRead Lw 
MemWrite Sw 
資料寫回暫存器 
MemtoReg MOV LW 
RegWrite 
R_format  
LW 
MOV 
I_data 
MULT_DIV 
I_MD 
指令
記憶體
M
U
X
PC
+
1
M
U
X
I
F
I
D
暫存器檔案
Hazard Unit
控制
單元
I
D
E
X
M
U
X
=
有號
擴充
+
計數器
IDEX_MemRead
IDEX_MemEn
IDEX_Rt
HALT
IFID_Rt
IFID_Rs
Instruction
 
Hazard Unit資料路徑 
 
z 分支延遲單元(Branch Stalling) 
分支危障發生在當分支指令，在第四個階段才做分支的判斷時，
接著再分支指令後面的其他指令已經在第二與第三階段執行，如果分
支的情況發生，便要丟掉正在第二與第三階段執行的資料，在實作上
並不容易，在此解決分支危障採用的分法為提早偵測分支，將分支偵
測移至第二階段，當分支指令在解碼階段時，就可立即判斷，分支是
否發生，當發生時即可立即決定分支的下一個位址控制 PC 值的變
z 前回饋單元(ForWarding Unit) 
當發生管線中某ㄧ指令在執行時，需要用到還在管線中前面的指
令所產生的結果，發生的情況舉例如下: 
sub   $t3,  $t0,  $t1………(1) 
add   $t2,  $t3,  $t4………(2) 
如上所示，指令(2)的加法必須使用到前一個指令(1)計算後所產
生的資料，然而當指令(2)在作運算時，指令(1)執行到記憶體讀寫階
段，其計算過後的資料尚未寫入暫存器；在此採用前饋與暫停的方法
來解決管線危障的問題。 
為了使能夠正確的將資料前饋，首先要先解決危障的偵測，了解
在什麼情況下危障的情形會發生，其危障發生的情況如下； 
EXMEM_RegisterRd = IDEX_RegisterRs 
EXMEM_RegisterRd = IDEX_RegisterRt 
MEMWB_RegisterRd = IDEX_RegisterRs 
MEMWB_RegisterRd = IDEX_RegisterRt 
然而在某些情況下指令並不做寫入暫存器的動作，因此必須要視
RegWrite 訊號是否拉起，同時加入 EXMEM_RegisterRd ≠ 0 的條件，
便可使得前饋可以正確工作如圖所示，再利用前饋單元產生的
ForWardA 與 ForWardB 的訊號控制多工器選擇前饋的資料如表所
示，下面為前饋單元的運算式： 
IF  ((EXM_RegWrite='1') AND (EXM_write_reg /= "00000")) 
    AND  (EXM_write_reg  = IDEX_Rs)  
    THEN    ForwardA <= "10" ;   
 
ForWardA與ForWardB的訊號控制 
ForwardA read_data_D1 
01 write_data 
10 EXM_ALU_result 
others IDEX_read_data_1 
 
ForwardB read_data_D2 
01 write_data 
10 EXM_ALU_result 
others IDEX_read_data_2 
 
z 算術與邏輯單元 
算術與邏輯單元完整外觀如圖所示，其 Ainput、Binput 及 ALU_ctl
為輸入；ALU_output_mux 為輸出。輸入 Ainput 及 Binput 代表執行運
算之運算單元，各為 16 位元；ALU_ctl 代表運算功能選者，為 4 位
元；ALU_output_mux 代表運算結果，為 16 位元。由下表可知算術與
邏輯單元共可執行 11 種運算：AND、OR、XOR、加法、直接加法、
減法、直接減法、乘法、直接乘法、除法、直接除法。 
 
 
算術與邏輯單元外觀架構圖 
z 位移單元(Shift) 
R-type 的 Barrel Shift 作位移運作是相當消耗電路邏輯閘，但是
這個指令在 DSP 運算時為相當重要的功能，其此設計將以指令解碼
位移 2 種模態 Shift 分別作不同指令的位移的運作，再以多工器做選
擇到 Sinput 輸入端，如圖所示。 
 
Shift電路設計圖 
 
z MOV 單元 
此單元主要為搬移資料用，當外部資料要進來 MIPS CPU 作運算
和運算結果要丟至外部顯示時，都不需透過此指令來搬移。設計方法
與多工器一樣，主要由 IDEX_Rd 來選者輸入訊號如表所示，輸出訊
號則由 IDEX_MovEn 和 IDEX_Op 控制如表所示。 
MOV輸入控制 
IDEX_Rd MOVREG 
00001 Ainput 
00010 IDEX_Sign_extend 
00011 P1 
00100 ADC 
00101 ACCIN 
others x"0000" 
參數萃取流程及運算 
本系統運算流程主要分為 2 大主軸：(1)MSIP 主要運作為 QRS
自動偵測(微分-絕對值-視窗平均法)、Berger 重新取樣定理(resample)
等處理；(2)即時 FFT 頻譜分析。其運算流程如圖所示。 
 
 
即時MIPS運算與FFT頻譜分析運算流程圖 
 
MIPS 
運 
算 
流 
程 
FFT 
運 
算 
流 
程 
 
電腦端資訊 
 
模組電路設計驗證 
MIPS CPU 指令集共設計 22 個指令，其中尋常指令設計共有 18
個指令與 4 個特殊指令；此節將透過實際硬體驗證自動偵測 QRS 波
與 Berger 重新取樣定理在 MIPS 運作及各周邊硬體控制是否正常運
作。 
 
自動偵測 QRS 波驗證 
QRS 的自動偵測的處理流程，主要是針對生理訊號週期內，相
鄰 2 個以上約相同之波峰，透過微分取絕對值、視窗平均、R 波偵
A 
B 
C D
  
微分取絕對值模組設計實現結果 
下為ECG 模擬訊號，上為MIPS CPU做微分取絕對值的訊號 
 
在視窗平均法方面，本模組電路設計了 16 點的 moving-average
演算，其運算公式如下 ： 
15........,2,1,0][*)1(
1)( ==++= ∑−= NninxNny
N
Ni
  式(3) 
MIPS 特殊指令集中的 ACC 指令本身設計為 16 階累加器，此指
令用法為 ACCIN 將資料數值導入累加器中；ACCOUT 則從累加器讀
出數值。故使用本指令可簡單的用作視窗平均法。在 MIPS 設計流程
圖如所示，Slope 所得$6 Reg 數值導入 ACCIN 中；經過一個 CLK，
ACCOUT 讀出數值於$8 Reg；因是平均法故$8 Reg 數值需除以 16，
並存於$7 Reg。將可得到如圖所示之訊號，曲線變的比較平滑，便可
以設閥值抓取 R 波訊號。 
為零作為計數器用；$11 Reg 設為 1000；當運算完 moving-average 後，
將開始比較與計數，$10 Reg 不等於$11 Reg 時，$7 Reg 數值是否比
$9 Reg 大，是則把$7 Reg 數值存於$9 Reg 內，反之$9 Reg 數值保持
不變；$10 Reg 做加 1 動作，重複以上動作直到$10 Reg 等於$11 Reg
後$9 Reg 就可得到一組最大數值；並且將$9 Reg 數值作右移動作以
得到最大值 50%之數值；繼續比較$7 Reg 數值是否比$9 Reg 數值小，
是則將$12 Reg 設為 1 且$13 Reg 做加 1 動作，否則再判斷$12 Reg 是
否為 1，若為否則單純運作$13 Reg 加 1 動作，若是則代表$13 Reg 運
算完成 R-R interval 數值且$12 Reg 設為 0 及$13 Reg 數值存於$14 
Reg，依序重覆動作運算。運算結果使用 Signal TapII 即時擷取，如圖
中 Fdata 數值所示。 
 
 
取R-R Interval設計流程 
內，所以再以$18 Reg 做判斷是否有為 0，是表示第一次運作，將開
始做參數導入，將 R-R Interval 數值$14 Reg分別存入$20 Reg、$24 Reg
內並判別$24 Reg 是否小於$26 Reg，不是則不斷的將$24 Reg 減去$26 
Reg，直到$24 Reg 小於$26 Reg 成立為止，再將$24 Reg 的數值存於
$17 Reg 並乘上 100 且$20 Reg 數值也存於$18 Reg 內，因此$18 Reg
不為 0 成立；當$18 Reg 不為 0 時開始運算，先把$24 Reg 數值作累
加$14 Reg 數值之動作、$14 Reg 數值存於$20 Reg、$17 Reg 數值作
累加$27 Reg 數值之動作、$25 Reg 數值減去$17 Reg 數值存於$19 Reg
內、$17 Reg 數值除去$18 Reg 數值存於$22 Reg 內、$19 Reg 數值除
去$20 Reg 數值存於$23 Reg 內、$22 Reg 數值加上$23 Reg 數值存於
$21 Reg 內方可得第一筆取樣資料；$24 Reg 數值減去$26 Reg 數值存
於$24 Reg、$17 Reg 數值加上$27 Reg 數值存於$17 Reg、$25 Reg 數
值加上$7 Reg 數值存於$19 Reg、$17 Reg 數值除去$18 Reg 數值存於
$22 Reg 內、$19 Reg 數值除去$20 Reg 數值存於$23 Reg 內、$22 Reg
數值加上$23 Reg 數值存於$21 Reg 內方可得第二筆取樣資料；最後
$24 Reg 數值減去$26 Reg 數值存於$24 Reg 並判斷$24 Reg 是否小於
$26 Reg；否則將$25 Reg 數值除去$20 Reg 數值存於$21 Reg 內、24 
Reg 數值減去$26 Reg 數值存於$24 Reg 在跳回判斷重複動作，可得一
串取樣資料；若$24 Reg 小於$26 Reg 成立則將$24 Reg 的數值存於$17 
a 為 121 個取樣點、I 為 Fdata 之 304 (130h)數值，可得 0.39 此數值，
但本系統有放大 100 倍，所以數值為 39，本系統所運算之 tdata 結果
為 39(27h)，故 MIPS 運算與公式推導一致。 
 
3.1.1  FFT 演算法驗證 
本系統晶片平台 1024 點 FFT 演算法使用 Matlab Simulink 之
Synplify DSP FFT 方程式，且透過 SynDSPTool 介面轉換出 VHDL 程
式。Resampling 訊號透過快速傅立葉轉換(FFT)，即可得到時頻域之
訊號，Resampling 訊號為 16bit 資料，第一筆快速傅立葉轉換資料將
在 Resampling 訊號輸入 2048 筆資料量後產生，之後每 1024 筆資料
將產生一筆 FFT 運算資料；FFT 運算後資料包含實部與虛部兩種，
且實部與虛部資料都帶有正負號的數值，所以必須增加平方開根號程
式運算來得到 HRV 資訊。 
在驗證系統做 FFT 頻譜分析正確性方面，本研究將量測儲存
FLASH 資料透過 UART 傳至電腦端，同樣 1024 筆 resample data 用
Matlab 作 1024 點的 FFT 演算法運算；並與本系統所運算出來的 FFT
資料結果作比對驗證， Matlab 算出來的數值並做取絕對值所得資料
與本系統即時 FFT 演算法驗算結果，兩者運算是使用相同的 1024 點
Resample 值為輸入訊號，圖為系統平台運算出來的結果與 Matlab 運
算出來的結果做相減，其誤差範圍大約都在 1.5 左右；將系統平台運
系統平台演算與Matlab 演算之相減誤差(2~128筆)
-1.5
-1
-0.5
0
0.5
1
1.5
2
0 20 40 60 80 100 120 140
 
系統平台運算出來的結果與Matlab運算出來的結果做相減 
 
線性相關度(2~128筆) R2 = 0.9926
0
50
100
150
200
250
300
350
400
0 50 100 150 200 250 300 350 400
系統平台運算結果
M
A
TL
A
B運
算
結
果
數列1 線性 (數列1)
 
系統平台運算結果與Matlab運算結果比較其線性相關度 
 
ADC0804 控制模組電路驗證 
系統使用 ADC0804 晶片來做類比訊號轉數位訊號 IC，本系統頻
率為 50MHz，在生理訊號處理上的採樣率大多都使用 100Hz~400Hz
就足夠做訊號上的處理；因此本模組電路設計有除頻電路模組與控制
模組，設計一個除以 15 的除頻電路模組以約為 1.525KHz 的速度控制
Flash memory 控制模組電路設計共有三種功能為抹除、寫入、讀
取等動作，但要驗證此三種功能前，可以由原廠資料所提供由 Flash 
memory 的 ID 讀取來判別模組達到功能性控制系統平台上的 Flash 
memory，若讀的到 Flash memory 的 ID 便可開始進行控制抹除、寫
入、讀取等動作；其所使用之 Flash memory 型號 ID 依序為 ECh、F1h、
00h、95h、40h[36]，圖為 Signal TapII 所擷取到的 Flash memory 控制
模組即時信號。由 Flash memory 元件資訊得知[36]，90h 為 commad 
指令，00h 為 address，由圖可知模組給予 Flash memory 的控制訊號
為正確。 
Flash memory 要做寫入動作，就必須先進行抹除才能做寫入，
如果控制寫入的資料為正確，即代表抹除的控制一定正確，要知道控
制寫入的資料是否正確，可由讀取控制將寫入的資料讀出來比對即可
得知。下圖為模組寫入 Flash memory 的即時信號，此訊號些入 data
為 00h~0Fh，模組讀取 Flash memory 的即時信號，讀出來的資料依序
為 00h~0Fh，若抹除後，未寫入資料，其讀取出來的均為 ffh，即驗
證了 Flash memory 的控制模組電路設計為正確。 
 
脈的 16 倍。因此，在串列傳輸部分最快只能到 3.1Mbps。在串列傳
輸介面，以傳送端而言，資料串流是經由 TXD 送出；以接收端而言，
由另一端傳送過來的資料出現在 RXD 上。 
資料傳送模組實現如圖所示。TXD 上的腳位資料包含 Start bit、
data、Stop bit，其 Start bit 設為 0、data 由低位元開始傳送、Stop bit 設
為 1，而 TXD 腳位資料與實際資料相反，所以圖中 Sent 計數器 0~A
這範圍可觀察出傳送資料為 x”41”；實際以超級終端機接收硬體端資
料如圖所示，超級終端機與硬體端溝通包率為 115200 bps，無限依序
傳送 A~Z 等 26 個字母。 
資料接收模組實現如圖所示。RXD 上的腳位資料包含 Start bit、
data、Stop bit，其 Start bit 設為 0、data 由低位元開始傳送、Stop bit 設
為 1。其電腦端是自行開發介面，將數值由電腦端介面傳送如圖所示，
並由 Signal TapII 比對驗證。 
 
 
Signal TapII 即時信號-控制模組TXD送出 
 
SRAM MEMORY 控制模組驗證 
系統平台主要搭配 SRAM來做LCD的RAM，當資料須傳送LCD
顯示時先由 SRAM 作儲存；LCD 掃描時需 Data 的傳送，此記憶體寫
讀功能速度最高可達 10ns；此頻率控制均以對記憶體寫入與讀出端控
制。本電路模組將實際驗證資料的寫進與讀出 00~0F 資料。如圖寫入
資料、圖讀出資料所示。 
 
 
Signal TapII 即時信號-控制模組SRAM寫入 
 
 
Signal TapII 即時信號-控制模組SRAM讀出 
 
LCD 控制模組電路驗證 
系統平台搭配 LCD 裝置用來顯示 ECG 訊號和 HRV 頻譜分析訊
號，LCD 因有速度上的限制，最高只能以 6.4MHz 做掃描，故必須透
過一除頻電路將頻率降低，才能有效的讓 FPGA 去控制 LCD；因此，
設計一個 3 階除頻電路恰好為 6.25MHz。 
演算法及周邊模組電路加以探討，各個模組電路會依其設計同時進行
處理動作，尤其是在運算方面，每個模組的運算結果將為下一個模組
所使用，各個模組之間的時序動作與溝通都是環環相扣，在系統中會
有許多延遲發生，例如傳輸延遲、元件延遲和連接延遲、輸出延遲、
保持時間和設定時間…等，這些延遲都會直接影響到整個系統的操作
頻率，如何設計才會減少延遲現象，整個電路的架構設計即相當的重
要，只有反覆的時序模擬和實際驗證，才能夠保證達到設定規格的要
求。 
 
 
 
 
 
110 
接孔等；右下圖為左側邊俯視圖，其為 Power 連接孔。 
 
自行規劃之系統整合 PCB 電路板 
 
  
系統裝置外觀圖 
電源部份
 
Flash
FPGA
SRAM
LCD
USB
ADC Button
LED
112 
按鈕 1：FLASH 內指令碼載入 MPIS ROM。 
按鈕 2：系統平台開始運作。 
按鈕 3：抹除原始資訊 FLASH、MIPS 運算資訊 FLASH 
        及 HRV 資訊 FLASH。 
按鈕 4：停止儲存原始資訊 FLASH、MIPS 運算資訊 FLASH 
        及 HRV 資訊 FLASH。 
按鈕 5：LCD 顯示畫面切換，可顯示原始資訊與運算後資訊。 
燈號 1：電腦端傳送 MIPS 指令碼完成或按鈕 1 功能完成亮起。 
燈號 2：按鈕 3功能完成亮起。 
燈號 3：按鈕 2功能啟動亮起。 
 
 
LCD 初始畫面 
114 
 
硬體端 HRV 功率頻譜與 ECG 訊號 
 
 
 
軟體端與 LCD 同組 HRV 資料 
 
軟體實現 
電腦端的軟體實現是使用視窗化軟體 Borland C++Builder 編輯
撰寫，主要分 2 個使用者介面：資料接收與發送、資料讀取顯示。 
在接收與發送介面，如圖所示，須先開通系統平台與電腦端通訊
阜，發送部份，MIPS指令碼由電腦端編輯後，透過USB傳輸至 FLASH
內，而再指令碼前後各加一個啟動碼(R)與終止碼(G)，當系統接收到
A B 
116 
 
 
使用者介面-資料接收與發送 
 
圖為 HRV 功率頻譜圖，可顯示欲觀察的 HRV 功率頻譜變化，顯
示範圍為 0~0.65Hz，其橫軸單位為頻率，每一小格的尺度為
0.0049Hz，並在每次更新 256 個 R-R interval 時，作一次更新顯示以
及重新計算更新的 HRV 相關參數。時頻域分析圖縱軸單位為頻率，
顯示範圍為 0~0.5Hz，利用繪圖程式透過圖形使用者介面以視覺直覺
的顯示方式，也就是將功率的數值大小對應到色彩來顯示，藍色及代
表無功率的狀況，紅色及代表最大功率，橫軸單位為時間，每次更新
256 個 R-R interval 產生的功率頻譜所需的時間，一張時頻域分析圖
有 16 次的 HRV 頻譜功率轉換，一張時頻域分析圖大約可顯示 60 分
鐘的功率頻譜變化；此外，在程式設計裡添加了可利用滑鼠左鍵去點
118 
 
 
HRV 功率頻譜圖 
 
 
時頻域分析圖 
 
 
ECG 顯示圖 
 
120 
軟體端所讀功率頻譜圖與時頻域分析圖所示；由頻譜功率圖可得知，
主要頻譜分析的 power 確實落在所預期出現的地方 0.047Hz，由於頻
率組合為類似方波，因此經過 FFT 演算法後，其他頻率地帶則會有
諧波的出現，其時頻域分析圖同樣也顯示出在預期出現的頻率其
power 為最大。 
 
硬體即時運算顯示功率頻譜圖 
 
 
軟體端-功率頻譜圖與時頻域分析圖 
 
設計二：以一個 0.9Hz 與 1.0Hz 的心跳頻率變化組合，每段頻率
122 
 
硬體即時運算顯示功率頻譜圖 
 
 
 
軟體端-功率頻譜圖與時頻域分析圖 
設計三：以一個 0.9Hz、1.0Hz 與 1.1Hz 的心跳頻率變化組合，
每段頻率均為 5 下依序重覆，並以每次 256 點作更新訊號的頻譜分
析，如圖所示，其可推算出主要的頻譜分析 power 會落在 0.04Hz 左
右，其公式推算如下： 
Hz04.0
5*0.1
15*9.0
15*1.1
15*0.1
15*9.0
1
1 =++++  
124 
 
 
軟體端-功率頻譜圖與時頻域分析圖 
 
 
設計四：以一個 0.9Hz、1.0Hz、1.1Hz 與 1.2Hz 的心跳頻率變化
組合，每段頻率均為 3 下依序重覆，並以每次 256 點作更新訊號的頻
譜分析，其可推算出主要的頻譜分析 power 會落在 0.079Hz 左右，其
公式推算如下： 
Hz079.0
3*2.1
13*1.1
13*0.1
13*9.0
1
1 =+++  
 
0.9Hz
1.2Hz
1.0Hz
3下 3下3下3下
1.1Hz
 
0.9Hz、1.0Hz、1.1Hz 與 1.2Hz 心跳頻率組合，間距 3 下檢測圖(4) 
 
系統平台檢測訊號組合結果，硬體即時運算結果功率頻譜圖與軟
126 
 
設計五：一個具有 60Hz 雜訊之心電圖訊號，使用設計一組 6 階
的 FIR 濾波器，以濾除雜訊。FIR 濾波器的響應會在有限的取樣時間
內衰減，對於有限的輸入，其輸出響應必為有限，因此可視為是輸入
值的加權平均。其如架構圖所示，數學表示為： 
0][)(
0
1 ≥−=∑
=
nmnxbny
n
m
       式(4.1) 
 
 
FIR 濾波器直接式 
 
以上面公式將可求得： 
)()(......)()()()( 65210 nxhnxhnxhnxhnxhny +++++=    式(4.2) 
 
透過 Matlab 軟體的 FDAtool 工具先設計出 FIR 濾波器濾除 60Hz
頻率響應圖所示，選擇 FIR filter、Bandstop、系統平台之取樣率為
303Hz、passband 的截止頻率為 45Hz、stopband 的截止頻率為 80Hz
及濾波階數為 6 階。輸入完規格將可得到頻率響應圖所示及濾波係數
所示。利用系數代入公式便可撰寫出 MIPS 指令，實際硬體實現圖所
示，下圖為具有 60Hz 雜訊心電圖訊號，上圖則經過六階 FIR 濾波器
心電圖訊號。 
128 
 
硬體實現 FIR 濾波器 
 
實際測量人體訊號與討論 
本實驗共作 7 組測量 subject，有 5 組 ECG subject，均量測睡覺
休息及身心劇烈互動運動(電腦互動遊戲)，兩種不同狀態，並規定不
與人交談；與 2 組 EEG subject，均量測閉眼睛及張開眼睛並同時聽
抒情音樂，兩種不同狀態。以上測量時間大約 60 分鐘左右，受測者
均為正常人，其年齡大約在 24 歲左右。 
ECG subject 實際測量 
人的心跳速率沒有固定規則，並不會呈現恆定跳動，或者是有規
則性的跳動，因此，可經由心率變異度的頻譜分析，直接對自律神經
功能的變化給予量化性的描述。 
Subject1 在睡覺休息狀態下的觀察期測量結果如 HRV 時頻域分
130 
 
Subject 1(睡覺休息) 
 
Subject 1 睡覺休息-PC 端 (1)心電圖訊號；(2)R-R interval； 
(3)功率頻譜圖；(4)時頻域分析圖 
 
(A) 
(B) 
(C) 
(D) 
132 
Subject 2(睡覺休息) 
 
Subject 2 睡覺休息-PC 端 (1)心電圖訊號；(2)R-R interval； 
(3)功率頻譜圖；(4)時頻域分析圖 
(A) 
(B) 
(C) 
(D) 
134 
Subject 3(睡覺休息) 
 
Subject 3 睡覺休息-PC 端 (1)心電圖訊號；(2)R-R interval； 
(3)功率頻譜圖；(4)時頻域分析圖 
 
 
(A) 
(B) 
(C) 
(D) 
136 
Subject 4(睡覺休息) 
 
Subject 4 睡覺休息-PC 端 (1)心電圖訊號；(2)R-R interval； 
(3)功率頻譜圖；(4)時頻域分析圖 
 
 
 
 
(A) 
(B) 
(C) 
(D) 
138 
Subject 5(睡覺休息) 
 
Subject 5 睡覺休息-PC 端 (1)心電圖訊號；(2)R-R interval； 
(3)功率頻譜圖；(4)時頻域分析圖 
 
 
(A) 
(B) 
(C) 
(D) 
140 
文獻的敘述[25]-[30]，α波是於安靜閉眼時顯著的出現，在
Subject 6 閉眼睛聽抒情音樂的狀態下，由於聽有助睡眠的抒情音樂，
經由長時間蒐集腦波的時頻域分析圖可發現，在α波約 12Hz~13Hz
左右很明顯的會出現一條平穩的曲線；Subject 7 閉眼睛聽抒情音樂的
狀態下，因受測者已進入睡眠中的第三期及第四期，因此可明顯發現
δ波約 2Hz~4Hz 左右出現一條平穩的曲線，在張開眼睛聽抒情音樂
的狀態下量測時，眼睛會不自主的快速扎眼，使得訊號漂移，因此時
頻域分析圖則呈現比較雜亂的分布，如下圖所示。 
 
142 
Subject 7(閉眼睛聽抒情音樂) 
 
Subject 7 閉眼睛聽抒情音樂-PC 端 (A)EEG 訊號；(B)EEG interval； 
(C)功率頻譜圖；(D)時頻域分析圖 
Subject 7(張開眼睛聽抒情音樂) 
 
Subject 7 張開眼睛聽抒情音樂-PC 端 (A)EEG 訊號；(B)EEG interval； 
(C)功率頻譜圖；(D)時頻域分析圖 
(A) 
(B) 
(C) 
(D) 
(A) 
(B) 
(C) 
(D) 
  
 
結論與未來展望 
本研究利用FPGA為核心建構可程式化生醫數位系統晶片具有即時FFT頻譜
分析生理訊號系統，透過本系統平台裝置可即時顯示儲存心率變異度的頻譜分析
於系統平台裝置以及電腦端。本系統平台利用 Altera 公司出產的 CycloneII 
EP2C35F484C6 FPGA 為系統處理核心來做 MIPS CPU、演算處理以及周邊控制。
其資源消耗如下 
 
圖5-1  晶片系統資源消耗 
利用 ADC0804 晶片將擷取到的生理訊號作 AD 轉換傳至 FPGA 內規劃之
MIPS 作不同的萃取參數與資料交換，以心電圖為例 MIPS 所萃取參數包括 QRS
自動偵測(微分-絕對值-視窗平均法)、Berger 重新取樣定理並將資料傳至 FPGA
內規劃之 FFT 演算法及平方開根號，且控制周邊裝置，完成一套可程式化生醫數
位系統晶片系統平台。 
未來可再擴展系統晶片平台功能，包括多通道的生理訊號擷取，如腦波、血
壓分析等，且同時可處理與分析多通道訊號，即可得到更多相關的生理資訊；並
且朝微小晶片化方向邁進，提共更多研究者或企業界做研究與 3C 產品開發，即
可提升生理量測系統之普及性。 
  
from finger arterial pressure",Proc. Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., 
12, pp. 1446-1047, 1990. 
[14] Nitzan, M., Babchenko, A. and Khanokh, B. "Very low frequency     
variability in arterial blood pressure and blood volume pulse",Med.     Biol. 
Eng. Comput. 37, 54-58, 1999. 
[15] B.W.Hyndman, J. R. Gregory "Spectral Analysis of Sinus Arrhythmia During 
Mentall Loading",Ergonomics, vol.18, pp. 255-270, 1975. 
[16] Pan, J and W.J. Tompkins, "A real-time QRS detection algorithm",IEEE Trans 
Bio-Med Eng, Vol.32, no.3, pp.230-236, 1985. 
[17] Hamiltin, P. S. and W. J. Tompkins, "Quantitative investigation of QRS 
detection rules using the MIT/BIT arrhythmia database",IEEE Trans Bio-Med 
Eng, Vol.33,no.12,pp.1157-1165,1986. 
[18] 蔡明曄，"以即時心率變異度分析系統探討麻醉之影響"，中原大學醫學工
程所.碩士論文，2001 
[19] Berger, R.D., S. Akselrod, D.Gordon and R.J. Cohen, "An efficient algorithm 
for spectral analysis of heart rate variability",IEEE Trans Bio-Med Eng, vol.33, 
no.9, pp.900-904,1986. 
[20] Parer WJ, Parer JT, Holbrook RH, Block BS, "Validity of Mathematical 
Method of Quantitating Fetal Heart Rate Variability",Am J Obstet Gynecol, 
1985, 153, 402-409 
[21] Kay SM, Marple SL, "Spectrum Analysis： A Modern Perspective",Proc IEEE, 
1981, 69, 939 
[22] Phillips, C. A., and Petrofsky, J. S. "Cardiovascular responses to    isometric 
neck muscle contractions： results after dynamic exercises with various 
headgear loading configurations, Aviat",Space, Environ. Med. 55： 740-745, 
1984. 
[23] Keselbrener, L., Oz, O. and Aldelrod, S. "Autonomic Alteration in 
Hypertension as Unmasked by a Change of Posture and Investigated by a 
Time-Frequency Analysis of HR and BP Fluctuations",Computers in 
Cardiology IEEE, pp.661-664, 1996. 
[24] Kuo, B. J., Chern, C. M., Sheng, W. Y., Wing, W. J. and Hu, H. H. "Frequency 
Domain Analysis of Cerebral Blood Flow Velocity and Its Correlation With 
Arterial Blood Pressure",Journal of Cerebral Blood Flow and Metabolism, 18：
pp. 311-318, 1998. 
  
Passariello， and Guy Carrault.,  “Real-Time ECG Transmission Via Internet 
for Nonclinical Applications”, IEEE Trans Inf Technol Biomed., 2001, 
Sep;5(3):253-7. 
[40] B. Woodward， R. S. H. Istepanian，and C. I. Richards，“Design of a 
Telemedicine System Using a Mobile Telephone”， IEEE Transactions on 
Information Technology in Biomedicine，2001, March, VOL. 5， NO. 1，  
[41] Donald Witters, Stuart Portnoy, Jon Casamento, Paul Ruggera, and Howard 
Bassen, “Medical Device EMI:FDA Analysis of Incident Reports，and Recent 
Concerns for Security Systems and Wireless Medical Telemetry”,  Center for 
Devices and Radiological Health Food and Drug Administration Rockville  
[42] Francesco Beltrame， Member, Piergiulio Maryni, and Giorgio Orsi, “On the 
Integration of Healthcare Emergency Systems in Europe: The WETS Project 
Case Study”, IEEE Transactions on Information Technology in Biomedicine, 
1998, Jun 2(2): 89-97. 
[43] Francisco Vaz, Osvaldo Pacheco, Antionio Martins da Silva,  “A Telemedicine 
application for EEG signal transmission”, Proceedings of the 13th Annual 
International Conference of the IEEE Engineering in Medicine and Biology 
Society, 1991, Volume: 13, Number: Pt 1,  466-7 
[44] H. Murakami，K. Shimizu，K. Yamamoto，T. Mikami，N. Hoshimiya，and K. 
Kondo， “Telemedicine Using Mobile Satellite Communication”，IEEE 
Transactions on Biomedical Engineering， VOL. 41， NO.5， May 1994 
[45] Iredale. F.， etc， Global， “Fine and Hidden Sports Data_Applications of 3-D 
Vision Analysis and a Specialised Data Glove and Athlete Biomechanical 
Analysis System”， Mechatronics and Machine Vision in Practice， 1997. 
Proceedings.， Fourth Annual Conference on，Page(s): 260 –264， 1997. 
[46] Lawrence Larson， Petter Asbeck， Gary Hanington， Edward Chen， Arun 
Jayamaran， Robert Langridge， And Xuejun Zhang ., “Device and Circuit 
Approaches for Improved Wireless Communications Transmitters.”, University 
of California-San Diego., IEEE Personal Communications, vol. 6, no. 5, 
October 1999 pp. 18-23 
[47] Ledin, T.;  Kronhed, A . C .，Moller，C. Moller，M.Odkvist，L.M.&Olsson，
B. ”Effects of balance t raining in elderly evaluated by clinical tests and 
dynamic posturography.”,  Journal of Vestibular Research，1，129-138. 1990 
[48] 王志元，以個人數位助理為基礎之腳底壓力量測系統設計，中原大學醫學
  
可供推廣之研發成果資料表 
█ 可申請專利  █ 可技術移轉                                     日期：96 年 5 月 10 日 
國科會補助計畫
計畫名稱：老年人長期健康照護系統之建構(子計畫一)可攜式即時
醫療訊號蒐集與分析系統平台發展 
計畫主持人：胡威志         
計畫編號：NSC 95－2221－E－033－034－MY3 
學門領域：醫學工程 
技術/創作名稱 即時心率變異分析 
發明人/創作人 胡威志 
技術說明 
中文：一套可長時間即時蒐集分析心率變異度的系統，本系統可長
時間蒐集個人心率變異度的統計平均值，或者蒐集多人心率變異度
的統計平均值做為基準，便可日後定期或者隨時比較心率變異度，
即可立即得到個人個體差異值，或者個人與常態分佈差異值，達到
即時監控分析效果。一個可攜式即時醫療訊號蒐集與分析系統平
台，系統的構成由前端人體心電圖(Electrocardiogram 簡稱 ECG)
訊號擷取，透過類比電路處理，以 16 位元單晶片去將擷取到的 ECG
訊號做數位轉換，與高速處理晶片 FPGA 做非同步 Hank shake 資料
傳輸，並將整體系統建構於 FPGA 上，以 FPGA 為核心，做 HRV 頻譜
分析前時域訊號處理，以及 FFT 演算法完成 HRV 頻譜分析，並控制
周邊配備，如 Flash 做即時訊號存儲、LCD 做訊號即時顯示、Keypad
做訊號 AD 轉換存儲和顯示之開關，並一同擷取人體呼吸訊號之
Interval 與 HRV 頻譜分析為比對，最後透過通用序列介面
(Universal Serial Bus 簡稱 USB)與 HOST 電腦端做連結，達到即
時(Real-Time)訊號蒐集、分析、監測及進階應用的效果。 
英文：A portable ECG monitor that can be used as a long-term ECG 
recording, ECG feature extraction, and Heart Rate Variability (HRV) 
analysis system. The system will be having a Short-term Fourier 
transformation (STFT) as process kernel with a real-time display. The 
system will be using a Field Programmable Gate Array (FPGA) as a 
digital signal process kernel for real-time short term Fourier 
transformation (STFT) calculation and a microprocessor for acquired 
ECG from an ECG amplification circuit board. It will have a real-time 
LCD display and a 128Mbytes Flash memory for recording. The heart 
rate R-R interval feature extraction and HRV STFT frequency spectrum 
calculation will be processed in FPGA. The recorded and processed 
data can be interfaced with a host PC via Universal Serial Bus (USB) 
for further usage. 
  
可供推廣之研發成果資料表 
█ 可申請專利  █ 可技術移轉                                     日期：97 年 5 月 31 日 
國科會補助計畫
計畫名稱：老年人長期健康照護系統之建構(子計畫一)可攜式即時
醫療訊號蒐集與分析系統平台發展 
計畫主持人：胡威志         
計畫編號：NSC 95－2221－E－033－034－MY3 
學門領域：醫學工程 
技術/創作名稱 即時心率變異分析 
發明人/創作人 胡威志 
技術說明 
中文：一套可長時間即時蒐集分析心率變異度的系統，本系統可長
時間蒐集個人心率變異度的統計平均值，或者蒐集多人心率變異度
的統計平均值做為基準，便可日後定期或者隨時比較心率變異度，
即可立即得到個人個體差異值，或者個人與常態分佈差異值，達到
即時監控分析效果。一個可攜式即時醫療訊號蒐集與分析系統平
台，系統的構成由前端人體心電圖(Electrocardiogram 簡稱 ECG)
訊號擷取，透過類比電路處理，以 16 位元單晶片去將擷取到的 ECG
訊號做數位轉換，與高速處理晶片 FPGA 做非同步 Hank shake 資料
傳輸，並將整體系統建構於 FPGA 上，以 FPGA 為核心，做 HRV 頻譜
分析前時域訊號處理，以及 FFT 演算法完成 HRV 頻譜分析，並控制
周邊配備，如 Flash 做即時訊號存儲、LCD 做訊號即時顯示、Keypad
做訊號 AD 轉換存儲和顯示之開關，並一同擷取人體呼吸訊號之
Interval 與 HRV 頻譜分析為比對，最後透過通用序列介面
(Universal Serial Bus 簡稱 USB)與 HOST 電腦端做連結，達到即
時(Real-Time)訊號蒐集、分析、監測及進階應用的效果。 
英文：A portable ECG monitor that can be used as a long-term ECG 
recording, ECG feature extraction, and Heart Rate Variability (HRV) 
analysis system. The system will be having a Short-term Fourier 
transformation (STFT) as process kernel with a real-time display. The 
system will be using a Field Programmable Gate Array (FPGA) as a 
digital signal process kernel for real-time short term Fourier 
transformation (STFT) calculation and a microprocessor for acquired 
ECG from an ECG amplification circuit board. It will have a real-time 
LCD display and a 128Mbytes Flash memory for recording. The heart 
rate R-R interval feature extraction and HRV STFT frequency spectrum 
calculation will be processed in FPGA. The recorded and processed 
data can be interfaced with a host PC via Universal Serial Bus (USB) 
for further usage. 
  
可供推廣之研發成果資料表 
█ 可申請專利  █ 可技術移轉                                     日期：97 年 5 月 31 日 
國科會補助計畫
計畫名稱：老年人長期健康照護系統之建構(子計畫一)可攜式即時
醫療訊號蒐集與分析系統平台發展 
計畫主持人：胡威志         
計畫編號：NSC 95－2221－E－033－034－MY3 
學門領域：醫學工程 
技術/創作名稱 估算大動脈血壓之方法與裝置 
發明人/創作人 胡威志 
技術說明 
中文：一套可長時間即時蒐集分析血壓之裝置用以估算尋常血壓及
大動脈之舒張及縮收壓的系統裝置，本系統可長時間蒐集個人之血
壓波形，可計算心率、及心率變異度的統計。此裝置系統可計算心
率及心率變異之平均值，或者蒐集多人心率變異度的統計平均值做
為基準，便可日後定期或者隨時比較心率變異度，即可立即得到個
人個體差異值，或者個人與常態分佈差異值，達到即時監控分析效
果。此系統為一個可攜式即時醫療訊號蒐集與分析系統平台，系統
的構成由前端人體動脈波形訊號擷取，透過類比電路處理，以 16
位元單晶片去將擷取到的血壓訊號做數位轉換並將整體系統建構
於微處理器上，以為處理器為核心，做大動脈血壓估算及 HRV 頻譜
分析前時域訊號處理，以及 FFT 演算法完成 HRV 頻譜分析，並控制
周邊配備，如電動馬達、洩氣閥及 Flash 做即時訊號存儲、LCD 做
訊號即時顯示、Keypad 做訊號 AD 轉換存儲和顯示之開關，最後透
過通用序列介面(Universal Serial Bus 簡稱 USB)與 HOST 電腦端
做連結，達到即時(Real-Time)訊號蒐集、分析、監測及進階應用
的效果。 
  
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                             97 年 10 月 10 日 
報告人姓名  胡威志 
 
服務機構 
及職稱 
 
中原大學醫工系副教授 
 
     時間 
會議 
     地點 
97 年 9月 14 日至 97 年 9月 17 日
波隆那(Bologna) 
本會核定 
補助文號 
計畫中補助 2-951361 
平台發展(3/3) 
會議 
名稱 
 (中文) 第 35 屆電腦在心臟應用國際學術研討會 
 (英文)The 35th annual international conference on Computer in Cardiology  
發表 
論文 
題目 
 (中文)以多時序多切面電腦斷層影像評估左心房肺靜脈心房運動 
 (英文) Assessing the Wall Motion of Pulmonary Veins of the Left Atrium 
(中文)高雜訊手握方式量測之心電圖心跳檢測 
(英文) Heart Rate Detection in Highly Noisy Handgrip Electrocardiogram 
報告內容應包括下列各項： 
一、 參加會議經過 
為參加此次（2008 年）第 35 屆電腦在心臟應用國際學術研討會，於九月十四日開始，第一天有一下午之
專題演講，以無線傳輸在心臟檢測研究發表四個歐洲之應用，第二天開始為學術研討會，此次所發表之
文章排在第二天，下午一時三十分口頭發表高雜訊手握方式量測之心電圖心跳檢測（Heart Rate 
Detection in Highly Noisy Handgrip Electrocardiogram）之論文，在論文中討論如何檢測運動中心
跳，引起多位臨床醫師注意，且第二天下午壁報中展示之論文壁報展示以多時序多切面電腦斷層影像評
估左心房肺靜脈心房運動（Assessing the Wall Motion of Pulmonary Veins of the Left Atrium），
與多位與會外籍學者討論心臟影像之應用。 
二、 與會心得 
此次（2008 年）第 35 屆電腦在心臟應用國際學術研討會，論文發表量大增，口頭論文研討外，並增設多
個時段之海報時間，在技術競賽部分，另開闢一個時段，作為講評及討論時間，20 多篇競賽論文就同一
主題作答，內容不僅精闢深入且參與者參加討論，十分引發觀察者之益智。此次國際學者研討之範圍從
學術與技術面延伸至臨床實用層面，論文相當務實，值得參考。 
三、 考察參觀活動(無是項活動者省略) 
（略） 
四、 建議 
（略） 
五、 攜回資料名稱及內容 
大會手冊及摘要一份  
六、 其他 
 
論文發表於 2008 Computer in Cardiology 
如下 
附件三
 
  
diastolic volume of left atrium was at the 30% time of R-R interval. And, the end systolic volume 
was at the 90% time of R-R interval. Please see Figure 1 for detail illustration. Through the 
reconstruction and volume extraction and ejection fraction calculation process, one may also process 
the dimension of superior and inferior pulmonary veins. In this way, one may study if the sleeve of 
pulmonary veins has an important role that contributes to the atrial fibrillation. One may further 
study the motion of myocardium adjacent to the pulmonary veins before and after AF ablation.  
Thus, the more effected method of evaluation the function of left atrium non-invasively using CT 
cardiac images becomes important.  
2. Methods 
A self-developed program with a user friendly interface was integrated as a image processing tool for 
analyzing 4D cardio CT image data set. The program was developed in visual C++ 6.0 that runs on 
window XP operating system. The 3D reconstruction and the atrial function analysis were able to use 
a minimal user interface in extracting the contour information.  
The CT images were recorded in DICOM format. The cardio images data set at two distinctive time 
will be reading into the processing system. Then, a 3D cardio image will be reconstructed and 
displayed for inspection and further process. Two set of 3D cardio image (at ECG gated 30% time 
and 90% time, see Figure 1) will be registered using the rib bone as reference. The two set of images 
were aligned with the minimum difference of rib bone images. After the registration process, the two 
set of cardio images were ready for image re-sampling to extract the atrial contour. The atrial contour 
information will be used in the reconstruction of 3D wire mesh view display, volume calculation and 
wall motion. The flow chart of process was illustrated in Figure 2. Twenty sets of cardio 4D images 
were used in this study with patients’ consent. 
The atrial contour was extracted using guided active contour method. [7-8] In this study, the atrial 
volume of two distinct time frames in a heart cycle was evaluated. One was at 30% of heart cycle 
which was at the end of systole of left ventricle. And, the other one was at 90% of heart cycle which 
was at the end of diastole of left ventricle. For each patient, there are more than 600 frames of CT 
gated cardio-images in one data set for processing. The processing flow chart is illustrated in Figure 
  
 
Figure 2. Processing Flow Chart 
  
  
end-systolic phase (ES) of left atrium (LA). The wall motion at the root of pulmonary vein was 
tallied and shown in Figure 6. For the patient without AF symptom, the distribution of movement 
was concentrated between 4 to 7 mm. For the AF patient, the movement was either small (< 5mm) or 
larger than 7 mm. The distribution was at two extreme of spectrum. This indicated that the abnormal 
wall motion of AF patient.  
The wall motion at PV ostial areas except left inferior PV was significantly larger in AF patients. The 
higher incidence of paradoxical dilatation at ED of right superior PV (82% versus 37%, p<0.05) and 
left superior PV (82% versus 43%, p<0.05) were observed in AF patients. In addition, poorer 
contractility of right superior PV was noted in AF patients (30% versus 1%, P<0.05). Whereas, the 
incidence of paradoxical dilation and contractility of right inferior and left inferior PV were similar 
between the two groups. However, the motion vector of left inferior PV did not show significant 
different between two groups, whereas, the motion at the inferior and posterior quadrant of right 
inferior pulmonary vein for the subject without AF symptom was significantly less than AF patient. 
See Table 1 for reference. This result is paralleling to the previous finding.  
4. Discussion and conclusions 
This paper is to report the development of 4D cardio-images analysis system that successfully 
assesses atrial volume and wall motion of pulmonary veins using multi-Slice CT (MSCT) cardiac 
images non-invasively. The procedure of the program will be, first, aligning the 3D CT images 
dataset, then, reconstructing the 3D volume of heart. A cut plane method is utilized to accurately 
delineate the 4 pulmonary veins and set the boundary at mitral valve for the left atrial contour 
extraction. The delineated information can be mapped onto the original CT images. The method of 
active contouring and seed region growth were implemented in the program for 3D atrial 
segmentation. The contour information will be re-sampled for the reconstruction of wire-mesh 
display. Using cut plane method, we were able to visualize and delineate intersection of the 
pulmonary veins. The volume of atrium was accurate estimated. 
Acknowledgements 
This study was supported by a grant from Nation Science Foundation, Taiwan, Republic of China 
(NSC-96-2221-E-033-034-MY3 and NSC 95-2221-E-033 -034 –MY3).  
References 
Tsao HM, Wu MH, Yu WC, Tai CT, Lin YK, Hsieh MH, Ding YA, Chang MS, and Chen SA. Role 
of Right Middle Pulmonary Vein in Patients with Paroxysmal Atrial Fibrillation. Journal of 
Cardiovascular Electrophysiology, 2001; 12: 1353-1357. 
Tsao HM, Yu WC, Cheng HC, Wu MH, Tai CT, Lin WS, Ding YA, Chang MS, and Chen SA. 
Pulmonary Vein Dilation in Patients with Atrial Fibrillation: Detection by Magnetic Resonance 
Imaging. Journal of Cardiovascular Electrophysiology. 2001; 12 (7), 809–813. 
Verma A, Kilicaslan F, Adams JR, Hao S, Beheiry S, Minor S, Ozduran V, Elayi SC, Martin DO, 
Schweikert RA, Saliba W, Thomas JD, Garcia M, Klein A, Natale A. Extensive Ablation During 
Pulmonary Vein Antrum Isolation Has No Adverse Impact on Left Atrial Function: An 
Echocardiography and Cine Computed Tomography Analysis. J Cardiovasc Electrophysiol, 2006; 
17: 741-746. 
Pappone C, Rosanio S, Oreto G, Tocchi M, Gugliotta F, Vicedomini G, Salvati A, Dicandia C, 
Mazzone P, Santinelli V, Gulletta S, and Chierchia S. Circuferential Radiofrequency Ablation of 
  
 
Table 1. Comparison of  magnitude of atrial wall motion at the root of pulmonary vein.   
(* indicate the significant different of two groups). 
 Right Inferior Pulmonary Vein Left Inferior Pulmonary Vein 
Inferior Anterior Superior Posterior Inferior Anterior Superior Posterior
AF Patient Average 0.09 0.05 0.06 0.08 0.08 0.09 0.07 0.08 
SD 0.04 0.02 0.03 0.03 0.04 0.04 0.04 0.05 
Patient without AF Sympto
m 
Average 0.05 0.08 0.08 0.05 0.09 0.06 0.07 0.06 
SD 0.02 0.07 0.06 0.02 0.03 0.04 0.03 0.04 
t-Test (p value) 0.01* 0.31 0.28 0.01* 0.66 0.11 0.97 0.38 
 
 
 
  
chart of process was illustrated in Figure 2. Twenty sets 
of cardio 4D images were used in this study with 
patients’ consent. 
The atrial contour was extracted using guided active 
contour method. [7-8] In this study, the atrial volume of 
two distinct time frames in a heart cycle was evaluated. 
One was at 30% of heart cycle which was at the end of 
systole of left ventricle. And, the other one was at 90% of 
heart cycle which was at the end of diastole of left 
ventricle. For each patient, there are more than 600 
frames of CT gated cardio-images in one data set for 
processing. The processing flow chart is illustrated in 
Figure 2. The self-developed image analysis program will 
read in the data set, for example, the data set at 30% of 
heart cycle. And, the program will reconstruct 3D volume 
of heart. Then, using a cutting plane as reference, one 
may re-sample images for accurately cutting at the root of 
4 pulmonary veins from the atrium and set the boundary 
(as shown in Figure 3 and Figure 4). Then, the user may 
select few slices of CT image as the seed to make a 
starting delineation. The self-developed heart function 
evaluation program will be starting to delineate the 
completed data set using given active contour method and 
seeded regional growth to delineate the atrial contour. A 
cubic spline procedure was performed to better fitting the 
atrial contour.  
The method of active contour is to calculate the 
minimal cost function to determine the delineated contour 
and the edge of image. [7-8] In the case of endocardial 
atrial chamber, the cost function of Esnake is integrated 
from the weighting product of internal energy and the 
weighting product of external energy. The internal 
weighting, wi = 0.3, in this process is set to 0.3. And, the 
external weighting, we, in the process is set to 0.5. 
Patients with suspected AF normally underwent an ECG-
gated, multi-detector computed tomography (MDCT) 
before or after the ablation. The objective of the program 
is to obtain the dimension and wall motion at ostial areas 
of four pulmonary veins (PVs). The volume of atrium 
(LAV) obtained at the end-diastolic phase (ED) and end-
systolic phase (ES) of left atrium (LA). The paradoxical 
dilatation of PV might indicate the poor sphincter 
function of PV area (PVA) [1]. The wall motion of the 
atrium at the root of four pulmonary veins will be 
calculated from the normal vector of surface between two 
timings of cardiac cycle. The resulting vector will be 
representing by the magnitude and phase. The program 
will calculate the dimension of the PVs area (PVA) at ED 
and will compare the dimension PVA at ES. The 
contractility of PV was defined as (PVA ES-PVA 
ED)/PVA ES. The atrial ejection fraction (EF) is defined 
as (LAV ED – LAV ES)/LAV ED. It will be calculated 
from the reconstructed atrial 3D volume representation. 
 
Figure 2. Processing Flow Chart 
  
addition, poorer contractility of right superior PV was 
noted in AF patients (30% versus 1%, P<0.05). Whereas, 
the incidence of paradoxical dilation and contractility of 
right inferior and left inferior PV were similar between 
the two groups. However, the motion vector of left 
inferior PV did not show significant different between 
two groups, whereas, the motion at the inferior and 
posterior quadrant of right inferior pulmonary vein for the 
subject without AF symptom was significantly less than 
AF patient. See Table 1 for reference. This result is 
paralleling to the previous finding.  
4. Discussion and conclusions 
This paper is to report the development of 4D cardio-
images analysis system that successfully assesses atrial 
volume and wall motion of pulmonary veins using multi-
Slice CT (MSCT) cardiac images non-invasively. The 
procedure of the program will be, first, aligning the 3D 
CT images dataset, then, reconstructing the 3D volume of 
heart. A cut plane method is utilized to accurately 
delineate the 4 pulmonary veins and set the boundary at 
mitral valve for the left atrial contour extraction. The 
delineated information can be mapped onto the original 
CT images. The method of active contouring and seed 
region growth were implemented in the program for 3D 
atrial segmentation. The contour information will be re-
sampled for the reconstruction of wire-mesh display. 
Using cut plane method, we were able to visualize and 
delineate intersection of the pulmonary veins. The 
volume of atrium was accurate estimated. 
Acknowledgements 
This study was supported by a grant from Nation 
Science Foundation, Taiwan, Republic of China (NSC-
96-2221-E-033-034-MY3 and NSC 95-2221-E-033 -
034 –MY3).  
References 
[1] Tsao HM, Wu MH, Yu WC, Tai CT, Lin YK, Hsieh MH, 
Ding YA, Chang MS, and Chen SA. Role of Right Middle 
Pulmonary Vein in Patients with Paroxysmal Atrial 
Fibrillation. Journal of Cardiovascular Electrophysiology, 
2001; 12: 1353-1357. 
[2] Tsao HM, Yu WC, Cheng HC, Wu MH, Tai CT, Lin WS, 
Ding YA, Chang MS, and Chen SA. Pulmonary Vein 
Dilation in Patients with Atrial Fibrillation: Detection by 
Magnetic Resonance Imaging. Journal of Cardiovascular 
Electrophysiology. 2001; 12 (7), 809–813. 
[3] Verma A, Kilicaslan F, Adams JR, Hao S, Beheiry S, 
Minor S, Ozduran V, Elayi SC, Martin DO, Schweikert 
RA, Saliba W, Thomas JD, Garcia M, Klein A, Natale A. 
Extensive Ablation During Pulmonary Vein Antrum 
Isolation Has No Adverse Impact on Left Atrial Function: 
An Echocardiography and Cine Computed Tomography 
Analysis. J Cardiovasc Electrophysiol, 2006; 17: 741-746. 
[4] Pappone C, Rosanio S, Oreto G, Tocchi M, Gugliotta F, 
Vicedomini G, Salvati A, Dicandia C, Mazzone P, 
Santinelli V, Gulletta S, and Chierchia S. Circuferential 
Radiofrequency Ablation of Pulmonary Vein Ostia: A New 
Anatomic Approach for Curing Atrial Fibrillation. 
Circulation, 2000; 102: 2619-2628. 
[5] Kim YH, Marom EM, Herndon JE, McAdams HP. 
Pulmonary Vein Diameter, Cross-sectional Area, and 
Shape: CT Analysis. Radiology, 2005; 235: 43-50. 
[6] Hauser TH, Yeon SB, McClennen S, Katsimaglis G, 
Kissinger KV, Josephson ME, Rofsky NM, Manning WJ. 
Subclinical pulmonary vein narrowing after ablation for 
atrial fibrillation. Heart, 2005; 91: 672-673. 
[7] Kass M, Witkin A, Terzopoulos D. Snakes: Active 
Contour Models. International Journal of Computer Vision. 
1988;  1(4): 321-331. 
[8] Wolf I, Hastenteufel M, Simone RD, Vetter M, Glombitza 
G, Mottl-Link S, Vahl CF, Meinzer HP. ROPES: A 
Semiautomated Segmentation Method for Accelerated 
Analysis of Three-Dimensional Echocardiographic Data. 
IEEE TRANSACTIONS ON MEDICAL IMAGING, 2002; 
21(9): 1091-1104. 
[9] Hu WC, Wu MH, Tsao CC, Shyu LY, Wang JJ. 
Assessment of Left Atrial Function Using Multi-Slice CT 
Images. Computers in Cardiology 2007;34:85−88. 
 
Address for correspondence 
Weichih Hu, Dept. of Biomedical Engineering, Chung Yuan 
Christian University, Chung Li, Taiwan, ROC 
weichih@be.cycu.edu.tw 
 
Table 1. Comparison of  magnitude of atrial wall motion at the root of pulmonary vein.   
(* indicate the significant different of two groups). 
 Right Inferior Pulmonary Vein Left Inferior Pulmonary Vein 
Inferior Anterior Superior Posterior Inferior Anterior Superior Posterior
AF Patient Average 0.09 0.05 0.06 0.08 0.08 0.09 0.07 0.08 
SD 0.04 0.02 0.03 0.03 0.04 0.04 0.04 0.05 
Patient without AF Symptom Average 0.05 0.08 0.08 0.05 0.09 0.06 0.07 0.06 
SD 0.02 0.07 0.06 0.02 0.03 0.04 0.03 0.04 
t-Test (p value) 0.01* 0.31 0.28 0.01* 0.66 0.11 0.97 0.38 
 
