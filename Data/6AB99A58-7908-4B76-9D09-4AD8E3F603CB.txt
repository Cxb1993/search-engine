2 
 
Directory as the fire extinguisher 
identification and verification system. The 
owner can verify every fire extinguisher and 
the certification thought the Internet. It 
allows the end user to easily verify the 
authenticity of the fire extinguisher at the 
item level. The signatures of the fire 
extinguisher identification information are 
wrapped and embed into the NFC tag. It 
embeds the specified serial numbers as the 
digital certification into the NFC tag to 
achieve the information security objectives 
of non-repudiation, integrity and security. 
This system authority can use the traitor 
tracing of the Fire Extinguisher electronic 
pedigree system to revoke the certification. 
We also implement Lagrange multinomial in 
our scheme to enhance NFC and Electronic 
Fire Extinguisher Pedigree system security 
with the group signature and the group 
verifier. This Fire Extinguisher group signer 
system provides user identification, 
non-repudiation, integrity and security by a 
digital Fire Extinguisher Identification. With 
the proposed digital Fire Extinguisher 
Identification system for Internet transaction, 
it can help prevent counterfeits, aid product 
recall, and improve the security of the 
general supply chain. 
 
二、緣由與目的 
 
為了提升消防局檢查消防設備滅火器
的效率、提升驗證滅火器能力的重要性，
並將消防設備滅火器檢查作業的資料處理
電子化。在本研究結合 NFC 標籤與數位證
書相互鑑別機制結合，能解決目前滅火器
電子履歷管理系統所面臨的安全性問題。
但因 RFID 標籤內的生產履歷屬於數位證
書，是數位內容的一種，要避免被複製、
散播、盜用及竄改，而產生的資安問題。
本研究提出一個針對滅火器的移轉，設計
一套商業流程來模擬滅火器從數位證書認
證、出售，到不同情境下使用者讀取的狀
況，並且依照生產履歷需求來確保 NFC 
滅火器標籤生產履歷資訊正確、不遭到竄
改。本計畫將針對數位版權管理(DRM)於
RFID 標籤生產履歷的流程、一般的對稱、
非對稱加密技等加密技術與金鑰控管深入
探討，建構此系統的基本安全需求分析與
情境使用安全分析，為日後滅火器線上檢
測提出解決方案。 
    本研究之目的在於提出了一個完整的
NFC 滅火器電子履歷管理系統架構，讓供
應鏈上各個廠商透過身份認證的機制並取
得正確的權利和權限來對產品履歷進行存
取。在系統架構方面，使用了認證票劵、
簽章、時戳、權限控制…等技術來對廠商
的身分、工作站、RFID 設備、有效存取
時間和權限做一認證，而在 RFID 系統，
為了讓其可以和電子履歷管理系統緊密結
合，除了使用雜湊函數和亂數來對 RFID
標籤內的 EPC 內容作加密的動作，同時也
結合了『任務導向』(Task-Oriented)的概念
來設計其認證之通信協定，使滅火器於每
次運送時其標籤內容都會有所變動，以防
止 RFID 讀取器和標籤在通訊的過程當中
造成資訊的外洩或是標籤遭到偽造，此機
制對於供應鏈內部經過身份認證的合法廠
商可以正確的依照認證中心所給予的授權
和權限來對產品履歷作存取。因為產品每
經過籤同的合法廠商更新資訊後，其內容
都會變動，大幅的增加了 RFID 系統的安
全強度，同時也有效的確保產品履歷的正
確性和安全性。 
 
三、文獻探討 
 
4 
 
 
在  IDC 的 研 究 白 皮 書 中 [1] 認 為 
DRM （Digital Rights Management）是管
理所授權使用的數位資訊，並紀錄其使用
過程的軟硬體服務和科技的結合。數位權
利管理可保護數位內容的版權，如電子文
件、電子郵件、電子書、數位影音、軟體
使其無法被隨意傳遞、複製、修改。所以
經由 DRM 存取權限的設定與內容的加
密，確保數位內容的安全。 
 
3.2.1 DRM 系統的交易流程 
 
本研究藉由 DRM 系統應用於滅火器 
NFC 數位證書安全。數位證書屬於數位內
容的一種，目前在保護數位內容的 DRM 
系統交易方式如下圖所示。首先，數位內
容創作者把創作的內容加密，並把解密金
鑰傳送到許可伺服器，而加密後的數位內
容傳送到傳遞伺服器，內容創作者也能夠
定義內容的使用方式。消費者可向傳遞伺
服器要求數位內容，但必須同時具備觀看
的權利與解密金鑰才能觀看內容，因此消
費者必須先透過金融票據交換中心付費給
零售商，才能從零售商取得觀看的權利與
解密金鑰來開啟數位內容，最後零售商可
憑使用清單從金融票據交換中心取款。 
 
 
交易流程圖 
 
3.2.2  DRM系統的安全機制 
 
數位文件可以利用一些特徵資料形成
數位簽章儲存於其中；而數位照片可以應
用數位浮水印的技術將時間戳記，把相關
資訊儲存其中，並且不會影響數位照片的
品質。本研究藉由這些技術的應用來鑑識
與鑑別數位內容，以提升證明能力來驗證
數位證書的正確性。鑑識與鑑別技術又可
區分為顯性特性、隱性特性與司法特性。 
1. 顯性特性：明顯且易見的安全特性，不 
需要讀取器或其他工具就可以檢測。 
2. 隱性特性：無法直接觀察到的安全特 
性，屬於隱藏資訊，例如縮印、嵌入數 
據。  
3.司法特性：更為隱蔽，必須透過特殊的 
檢測手段或儀器進行檢驗，例如：電子產
品碼（EPC）、鑑別加密法中的數位簽章
資訊、群體驗證導向、浮水印資訊與時戳
資訊。 
 
3.2.3 DRM 系統的鑑別加密技術 
 
鑑別加密法是由 Horster、Michels 與 
Petersen[4]在 1994 年提出的，主要的目
的在於能同時達到數位簽章以及加密的功
能，可以降低通訊與計算成本。本研究採
用鑑別加密技術應用於滅火器 NFC 數位
證書的流程機制，以認證中心（CA）擔任
第三方公正單位，所有的交易程序必須先
從認證中心（CA）取得數位權利憑證方可
進行，而鑑別加密的金鑰交換使憑證訊息
6 
 
內容的真確性。 
3. 簽章必須要由認證中心（CA）來進行
認證，以避免日後有所爭議。 
而數位證書在嵌入數位簽章時，具有驗證
的功能，但必須具備的條件如下所述[6]：  
1. 數位簽章的內容必須取決於被簽署的
訊息。 
2. 數位簽章必須用到一些只有傳送者才
有的訊息，才能有效避免簽章被偽造。 
3. 數位簽章的產生方式、辨識與驗證必須
簡單且能達到簽章目的。 
4. 數位簽章必須要能實際複製到記憶體
之中。 
 
3.2.5 DRM 的時戳機制 
 
時戳機制是其中一種替代流水號的方
式[6]，它的作法是：當接收者收到一個訊
息時，根據現有的資訊來判斷依附在此訊
息上的時戳是不是接近現在的時間。如果
斷定是合理的時間資訊，接收者就認為這
是一個可接受的新訊息，因此，同樣的時
間脈動是兩者間相互傳遞所必須具備的重
要條件。 時戳的目標是在一定片刻保證任
何電子資料的存在，保護文件的公平價
值，經由關聯任意指定的資料摘要和時序
相關的資訊，兩兩相互對應而成，使其具
備不可否認與更改的特性[7]；實際運作
上，通常是以網路校時協定(Network Time 
Protocol)[5]維護時間源準確度，使系統時 
間與世界協調時(UTC)能在控制的時間源
頻率誤差範圍內。時戳服務是使用數位簽
章技術在想要時戳的資料中戳記上時間，
在本研究提出的方法中，可依此服務表示
數位權利憑證的使用時效資訊，基本的運 
作流程原理是把需要時間戳記的資料 D 
利 用 單 向 抗 碰 撞 雜 湊 函 式  h(One-Way 
Collision-Resistance Hash Function )， 對一
個固定點的大小順序製訂一份任何尺寸的
資料程式， 像 MD5 和 SHA-1 一樣，分
別有 128 和 168 位元的雜湊產生；以此
雜湊為訊息摘要(Message Digest,MD)MD
＝ h(D)， 並 MD 之後附加上時間訊息 
T，再對資訊( MD || T )進行數位簽章得到 
時戳 TS。如果實際應用在本研究所提出
的數位權利憑證上， 時戳本身需具有法律
的效力，它必須被一個可信賴且公信力的
權威機構以數位方式所簽署，並能夠明確
證明此數位權利憑證存在於某段時效內，
使時戳具有不可否認的特性，除了考慮時
戳的時效性之外，還要考量其正確性與可
比較性，具備上述條件的時戳資訊，才能
成為未來起訴時的證據。 
 
四、研究方法 
 
4.1. 線上NFC滅火器認證系統方案設計 
 
本研究所提出之安全機制包含了兩個
主要的部份，分別為廠商身份認證以及
RFID系統的加密機制，為了有效的確保產
品履歷籤會遭受到非法的竄改而造成消費
者權益的受損，在產品的生產和運送過程
中，上下游的各個廠商對於產品履歷的存
取都必須嚴格的控管，因此本研究提出了
一個安全的產品履歷管理系統架構，可以
確認廠商真實身份的認證機制，以提高
NFC滅火企電子履歷管理系統的安全性和
8 
 
統的相依性問題。 
系統的功能模組方面，其操作介面可
分作電子履歷系統管理介面、廠商操作介
面和消費者介面，電子履歷系統管理介面
主要負責管理廠商和產品的資訊和供應鏈
的管理，廠商操作介面則提供了各廠商來
存區所負責之產品的履歷記錄，消費者介
面則提供了商品履歷的查詢和回饋功能。 
 
4.2 數位證書認證商業流程 
 
4.2.1 滅火器註冊認證與產生數位證書程
序 
 
滅火器供應商、使用單位向認證機構
註冊，並提供註冊相關資料，包括廠商基
本資料、使用單位基本資料，並且從認證
單位取得專屬的會員編號、雜湊過&加入
時戳的次密鑰、廠商名冊。欲購買使用滅
火器的單位從認證機構提供的廠商名冊中
挑選適合的滅火器供應商，並且聯絡談妥
交易事宜。確認交易事項後，聯絡認證中
心、安排認證時間，並更新生產履歷。認
證中心確認雙方交易簽約後，驗證雙方的
雜湊過&加入時戳的次密鑰，確認這些次
密鑰都在有效時間內、並且正確無誤，然
後使用 Lagrange 多項式插入法還原成秘
密金鑰，將滅火器資訊更新後，用秘密金
鑰加密簽屬 NFC 標籤的數位證書。 
 
4.2.2 線上滅火器代驗操作程序 
 
使用者可使用 NFC 讀取裝置來讀取
滅火器上的 NFC 標籤以驗證滅火器的合
法及有效性。先到認證機構網站取得秘密
金鑰的公開金鑰，即可解密 NFC 標籤內
的數位證書內容。若是解密完成後的內容
是有意義的明文，則內容正確無誤；若是
無法解出有意義的明文，則代表生產履歷
可能損毀或遭受竄改或破壞攻擊。 
 
4.2.3 線上滅火器證書更新與轉移程序 
 
使用者欲更新或轉移憑證，須向認證
機構提出申請，由認證機構網站登錄作
業，藉由 NFC 讀取器讀取出欲更新或轉移
之滅火器憑證與認證機構中的就有資料進
行核對動作，確認無誤再進入更新或轉移
的程序。與更新資料，則在與認證機構核
對相符後上傳期更新後的資料。轉移動作
則須向認證機構申請新使用者與滅火器的
憑證，也就是憑證 A 的封條，取得後再與
舊有的憑證封條 A 作更換動作即可。 
 
4.3 NFC 加密機制 
 
各廠商端之 NFC 讀取器與貨物之間
的 NFC 系統，使用本研究所提出的加密機
制來保護 NFC 標籤和讀取器之間的安全。  
 
在 NFC 標籤中使用的驗證方式，則是
運用 K1、K2、K3 三把鑰匙分別對憑證封
條 A、B 做驗證檢測。憑證封條 B 使用
10 
 
交易 Key A：讀取資料或驗證時用，Key 
B ：寫入資料或檢驗時用。因 Master key A
與 Master key B 為 NFC 標簽與 NFC+PDA
相互認證用之基碼，故 Master key A 與
Master key B 必須分別儲存於 NFC 標簽與
NFC+PDA 中，而實際上將主機碼 Master 
key 存於 NFC 標簽中是很危險的事，因為
NFC 標簽被破解之的機率很高，加入雜湊
函數使實際儲存於每一張票卡中之基碼
key A 與 key B 之值都不一樣，即使有
NFC 標簽之基碼被破解，也不會使全部票
卡 之 基 碼 被 破 解 。 H(Master Key A 
*16@IDnfc 序 號 )H(Master Key B *16 
@IDnfc 序號)  
 
4.3.3 NFC+PDA 設備基碼多樣化 
 
當在設備上傳每筆檢驗資料時，必須
在資料上加上 MAC，故理論上 NFC+PDA
設備中應要存有 Master MACing key 來計
算出每筆交易資料之 MAC，實際上將
Master MACing key 存於設備中非常危
險 ， 因 為 若 一 部 NFC+PDA 驗 票 機 之
MACing key 被破解話，會導致所有驗票設
備之 MACing key 都被破解，故加入雜湊
涵數使儲存於所有驗票設備中 MACing 
key 之值都不一樣。  h(Master MACnfc 
Key@ IDpda 設備序號)於每筆檢驗後資料
由 NFC+PDA設備上傳至 NFC 滅火器驗證
系統中心時， NFC+PDA 設備會利用儲存
於設備中之 MACing key 與該筆檢驗資料
內容帶入 MAC 演算法計算公式，計算出
該筆交易之 MAC，Append 在該筆資料
上，一併送至 NFC 滅火器驗證系統中心，
而 NFC 滅火器驗證系統中心之電腦中亦
存有 MACing key，當一筆檢驗資料送至
NFC 滅火器驗證系統中心時， NFC 滅火
器驗證系統中心亦會將 MACing key 與該
筆交易資料內容帶入 MAC 演算法計算公
式，由軟體計算出該筆交易之 MAC 後，
並與上傳交易資料之 MAC 比對，若相
等，則表示資料正確，沒有被竄改過。 
 
4.4 存取權限控制 
 
經過使用這身分識別之後，系統必須
對於存取 NFC 標籤之資訊的權限應有所
分割。如一般使用者，其最大權限也只能
知道滅火器上的 NFC 標籤，最基礎的資
料，像是標籤的有效期限、名稱、編號、
使用年限、維修紀錄…等。此控制可以防
止竄改資料之造假的行為，而對於日後的
責任追究或是稽核行動也可以做為較為顯
著的追查參考方向。 
12 
 
進行比對。 
(4) 確認次密鑰正確無誤之後，就使用 
Lagrange 多項式插入法進行恢復還原秘
密金鑰。 
 （當擁有 t 對次密 ki1，ki2，…kit 時，，
即可藉由 Lagrange 多項式插入法恢復：
 ） 
(5) 將相關資訊寫入 NFC 標籤，更新完 
NFC 標籤內容後，使用秘密金鑰將 NFC 
標籤內容加密簽署數位證書 
 
4.6 本研究系統安全性分析 
 
4.6.1 認證機制之安全分析如下 
 
1. 保密性(Confidentiality)：  
電子履歷資料庫只允許經過認證的廠
商進行存取，而在 RFID 系統方面，我們
所提出的加密機制也可以有效的保護標籤
內容籤會遭到未經授權的使用者竊取。  
2. 認證性(Authentication)：  
在供應鏈上所有的廠商甚至是其所屬
的設備都必須要經過認證，才可對履歷資
料庫或是 RFID Tag 進行存取的動作，藉此
可以避免未經授權的使用者的非法存取、
企圖竄改產品履歷等籤法行為。  
3. 資訊完整性(Integrity)：  
資訊的完整性是指訊息內容遭受到竄
改、插入等，而本研究中所提出之 RFID
系統認證機制，可以有效的防護標籤本
身，對於未經授權的存取予以拒絕，以避
免資訊的洩漏進而遭到破解、竄改。  
4. 可稽核性(Audit ability)：  
由於電子履歷系統本身會紀錄所有的
廠商對於產品存取的紀錄，因此對於產品
出問題時可以有效的向上追溯發生問題的
節點，因此對於一個有效的電子履歷管理
系統來說，可稽核性是其基本所應具備的
功能，換言之，電子履歷管理系統正是為
了『稽核』而產生的資訊系統。 
 
4.6.2 NFC 滅火器系統安全性分析 
 
1. 中間人攻擊(Man in the middle attack)：  
對於中間人的竊聽，在通訊的過程中
加入了雜湊函數、亂數和系統內部所分享
之秘密後，可以有效的防範，因為每一個
產品在籤同的生產週期，其任務識別(Task 
ID)皆籤相同，因此籤同生產週期但是相同
的產品之 Tag 所回覆之訊息內容也皆籤相
同，在外界也無法得知其生產和任務識別
的情況下，需要得知其訊息內容的難度也
相對的提高。  
2. 重送攻擊(Reply attack)：  
由於 Tag 本身對於非法的 Reader 所提
出之 Request 接籤會有所回應，因此攻擊
者並籤會從標籤獲得系統內的資訊，因此
也無法對系統做出重送的動作，因為攻擊
者無法得知正確的回應訊息為何。  
3. 標籤偽造(Forgery)：  
由於標籤本身的回應防護機制，攻擊
者沒有辦法取得正確的內容，而要取得廠
商識別或是任務識別也有難度，因此很難
對於標籤的內容進行複製的動作。  
4. 阻斷服務(Denial of Service)：  
阻斷服務攻擊在 RFID 系統當中，通
常是攻擊者仿效電子標籤之訊息，主動的
14 
 
Linnartz,"Digital rights management in 
consumer electronics products"IEEE 
SIGNAL PROCESSING MAGAZINE, 
MARCH 2004,p82-91.  
[7] Yan, Z.”Mobile Digital Rights 
Management,”Nokia Research Center,In 
Telecommunications Software and 
Multimedia TML-C7 ISSN 
1455-9749,2001. 
www.tml.hut.fi/Studies/T-110.501/2001/
papers/zheng.yan.pdf  
98年度專題研究計畫研究成果彙整表 
計畫主持人：陳俊德 計畫編號：98-2221-E-211-020- 
計畫名稱：結合 NFC 之消防設備安全登錄驗證系統之研製 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 1 0 100% 碩士學位論文 
研討會論文 1 0 100% 
篇 
數位科技與創新
管理研討會 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 4 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 3 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
 
