1行政院國家科學委員會補助專題研究計畫
成果報告
□期中進度報告
惡意網站的偵測研究
計畫類別：個別型計畫 □整合型計畫
計畫編號：NSC 99－2218－E－231－002－
執行期間： 99 年 8 月 1 日至 100 年 7 月 31 日
執行機構及系所： 清雲科技大學資訊工程系所
計畫主持人：林大為
共同主持人：
計畫參與人員：吳迪/李兆峻/鍾旻燕/莊惟安/黃柏修
成果報告類型(依經費核定清單規定繳交)：精簡報告 □完整報告
本計畫除繳交成果報告外，另須繳交以下出國心得報告：
□赴國外出差或研習心得報告
□赴大陸地區出差或研習心得報告
□出席國際學術會議心得報告
□國際合作研究計畫國外研究報告
處理方式：除列管計畫及下列情形者外，得立即公開查詢
□涉及專利或其他智慧財產權，□一年□二年後可公開查詢
中 華 民 國 100 年 10 月 20 日
3電腦中植入惡意程式碼或後門，而後伺機竊取各
種機密性的資料，如帳號/密碼、信用卡等的資
訊。在網路上包含惡意連結或程式碼的 Web 伺服
主機，有可能是攻擊者所建立的或是經由入侵正
常 Web 伺服網站之後，竄改網站內容而得。其中
尤其以入侵大家所熟知的入口網站後，植入惡意
的連結或程式碼最為恐怖，通常用戶端的使用者
基於對於知名入口網站的熟悉與信任，於不察覺
中感染而不自知 [1][3][4]。
依據 SANS 與 Symantec 的資料顯示網際網
路的攻擊行為中有超過 60%是以攻擊 Web 應用
為主，而攻擊行為除了攻擊網站之外，更進一步
轉向攻擊用戶端的使用者，攻擊的動機也以金錢
利益為主[1][2][3]。其中尤以入侵大眾所熟知的
入口網站後，然後植入惡意的連結或程式碼最為
恐怖，用戶端的使用者基於對於知名入口網站的
熟悉與信任，於不懷疑中開啟惡意連結後遭感染
而不自知[1][2]。
Symantec 發現 2008 年惡意程式碼的數量快
速增加遠超以往[2]，因此展望未來對網站與用戶
端電腦進行攻擊的威脅將更形嚴重，使用者本身
也必須提昇安全意識，加強用戶端電腦的安全性
[9]。
惡意網站的定義如下，用戶端的使用者連上
此伺服網站後，該伺服網站未經使用者同意即會
下載與安裝惡意程式於使用者的電腦上，此種伺
服網站稱為惡意網站。此惡意網站為攻擊用戶端
電腦的跳板，首先藉由入侵 Web 伺服主機，加入
惡意的連結或程式碼，伺機等候用戶端電腦連
接，藉由用戶端電腦的弱點，於使用者無察覺任
何異狀下，植入後門，控制用戶端的電腦。本來
Web 伺服端是無法主動攻擊用戶端的，利用用戶
端所主動發起的連線行為，使得惡意的伺服器能
夠突破防火牆的限制而攻陷用戶端的電腦，取得
用戶端的電腦的控制權，這是新見的攻擊手法。
近期來看，攻擊目標除了瀏覽器本身的弱點
之外，也包含 ActiveX 控制項、瀏覽器外掛程
式、多媒體、文件檢視器和其他第三方應用程式
上等。只要使用者造訪某個受到攻擊的網頁，其
中某個應用程式中的一個漏洞就可能讓使用者
的系統毫無防禦能力並遭到攻擊[4]。要找出使用
者環境中的可攻擊漏洞並不容易，但網站攻擊工
具組使這項工作輕鬆了許多。網站攻擊工具組是
專為探測使用者的電腦並自動攻擊安全性漏洞
而編寫的軟體程式，它可以為攻擊者提供一條可
供利用的入侵使用者系統的路徑。這類現成的軟
體工具組可讓任何懷有惡意的人員自動攻擊成
千上萬個系統。此類常見工具組的範例包括
Neosploit、MPack、Icepack、El Fiesta 和 Adpack。
網站攻擊工具組具有易於使用的介面，並且不需
要任何技能便可進行實際攻擊。它們透過攻擊存
在漏洞的瀏覽器、ActiveX 控制項和多媒體外掛
程式版本中的漏洞來進行攻擊。一旦成功攻擊某
個漏洞，攻擊者就可以在終端使用者的系統上隨
意插入任何特定惡意軟體。
Symantec[4]資料顯示來自主流網站的偷渡
式下載每天都會發生數千次。受到感染或攻擊的
企業與消費者客戶數量已經多到令人擔憂。使用
者渾然不覺自己已經受到感染，因為此類攻擊不
需要使用者互動即可發動。依據 SANS 2009 的
The Top Cyber Security Risks 網路安全威脅[1]，
利用瀏覽器漏洞的網站攻擊逐漸增加，特別是針
對合法網站，從現有趨勢可以看出，攻擊者越來
越傾向透過入侵那些使用者信賴的網站來發動
攻擊。
目前網路上充斥許多的惡意網站，網際網路
的攻擊行為中超過 60%是以攻擊 Web 應用為主，
Web 應用程式的漏洞，如 SQL Injection 和
Cross-Site Scripting 缺陷，在 Open Source 以及客
制化的應用軟體中佔被發現的漏洞的 80％以
上。網站的內容是隨時間變動的，不久前可信任
的網站可能在不久的將來轉變成包含有入侵用
戶端電腦程式碼的惡意網站，用戶端的使用者極
易輕忽易於未察覺中誤入惡意網站，遭植入惡意
程式而不知，因此惡意網站的偵測與用戶端電腦
的防護都是刻不容緩的事。
網路上的攻擊行為具有隨時間一波一波的
特性，當有一個新的弱點出現而尚未有修補程式
時，一個未知的新攻擊出現，受害者快速大量的
出現，當這個事件引起注意，專家學者研究發現
其原因、入侵的方式或管道，在廠商提供修補程
式或因應對策後，這一波的攻擊將逐漸消退，在
5(B)瀏覽器加上 Sandbox [10]的方式
(C)以真實瀏覽器系統(內含偵測惡意行為與系
統還原機制)
(A)的優點乃系統不易受到真正感染，由於
並不完整具有瀏覽器的特性，只適合偵測某種類
型的攻擊行為，初期以此系統做初步的試探。(B)
以真實瀏覽器配合 Sandbox 的使用來偵測惡意網
站，當惡意網站企圖感染瀏覽器時，Sandbox 可
將惡意程式碼，鎖定於 Sandbox 的環境中，無法
感染系統。(C)以真實瀏覽器系統來做為偵測系
統，此系統需含偵測惡意行為與系統還原機制，
因此應用 Client Honeypot[11][12]的技術來建置
此一偵測系統，系統內含監控機制，用來偵測惡
意網站的感染行為，與還原機制，可將受感染的
系統迅速還原。
Client Honeypot 在建置上有 Low Interaction
與 High Interaction 兩種類型，高互動性以真實的
瀏覽器來建構的系統，能夠真實反應所有瀏覽器
真實特性，低互動的 Honeypot 則是以模擬瀏覽
器的方式來進行，此種方式優點是偵測系統容易
掌控，但可能流於未能完全真實反應瀏覽器的偏
差，未來將評估於不同的實驗階段採用不同的
honeypot。
偵測系統以完全未修補 Patch 的系統方式進
行探測，偵測網際網路上惡意網站的情形，稍後
再以完全修補的系統進行探測，以了解於此情況
下惡意程式碼能否感染用戶端。在偵測惡意程式
碼的是否存在，除了藉助偵測系統本身的判斷
外，再輔以市場上較為有名的防毒軟體與偵測間
諜軟體用來協助偵測惡意程式。再來進一步探討
瀏覽器的設定或加上外掛軟體下，受惡意網站影
響的情形。
建置上述 A/B/C 三種型式偵測系統，模擬的
與真實的系統，真實偵測系統還需考量系統的保
護或還原，考量採用 Low Interaction 與 High
Interaction Honeypot 的用戶端電腦系統，並進一
步考量系統安裝 plug-in 軟體，如:Acrobat reader
或 Flash player 等，這些外掛軟體可能包含有未知
的漏洞，系統採用虛擬機器，虛擬機器
(如:VMware[14]或 VitualBox[15])通常有快速還
原的機制，如 Vmware 的 snapshot 的功能，可以
將被感染的系統迅速還原。
(四)結論
惡意程式碼的攻擊目標的趨勢，已由防護較
為嚴密的伺服器轉而向防護較為鬆散的用戶端
使用者，用戶端使用者的數量遠大伺服器的數
量，對惡意攻擊者而言，這是極大的誘因，大量
的用戶端的電腦極可能被種入後門而不自知。一
般用戶者安裝防毒軟體雖可防治大部份的惡意
程式碼，但日新月異的惡意軟體，對防毒軟體而
言，但仍有存在漏網之魚，為了能有效的防治未
知的惡意軟體，除了安裝防毒軟體之外，並持續
更新病毒碼外，使用者在使用瀏覽器時上網時可
採下列措施，以防範未知的惡意程式碼:
(i)可以搭配沙盒機制(Sandbox)，如Sandboxie
之類的軟體，可將惡意網站的攻擊行為鎖定在沙
盒之中，除了有利於觀察系統是否在上網期間，
自動下載了一些不尋常的檔案之外，萬一發現有
問題更可以迅速還原。
(ii)在電腦資源允許的情況下，可建置虛擬機
器，採用VMware或Virtualbox來建置一部虛擬電
腦，並於系統建置完成的時候，建立還原點，若
將來系統遭受攻擊，可迅速還原。對於安全性要
求高的行為，如網路交易行為，需有帳號密碼信
用卡資訊等，最好能夠建立單獨專用的虛擬機
器。
不同電腦所安裝的軟體會不一樣，這些差異
會導致防毒軟體對於未知惡意程式的偵測更加
困難更容易誤判。本研究歸納惡意程式碼的重要
行為特徵，有些行為特徵是很難避免的[16][17]，
這些重要特徵歸納有檔案系統存取、Registry存
取、程序(Process)、網路存取等幾項，這些行為
特徵的原因簡要歸納於下表中，成為可觀察惡意
程式碼行為的一些有用通則，然後使用高階的觀
察工具，一般的使用者使用這樣的工具與觀察的
通則，能用來協助找出潛藏於系統中的未知的惡
意程式。可用來檢測系統中是否存在有的惡意程
式碼[18]。
表1 惡意程式碼重要的行為特徵
7Pointillist Approach for Comparing
Honeypots”, Proceedings of the 2nd 
Conference on Detection of Intrusions and
Malware & Vulnerability Assessment (DIMVA
2005), Lecture Notes in Computer Science,
3548, pp 51-68
13. The MITRE Honeyclient Project,
http://www.honeyclient.org/trac, Jan 2010
14. VMware, http://www.vmware.com/, Jan 2010
15. VirtualBox, http://www.virtualbox.org/, Jan
2010
16. 黃獻德、蔡一郎、邱敏乘、李健興、莊宗嚴，”
知識本體於惡意程式行為分析之應用”，臺
灣網際網路研討會暨全球 IPv6 高峰會議，
2009。
17. 吳金庭、蔡文能，”以 Snort 偵測並封鎖網路
異常行為之研究”，碩博士論文網，2008。
18. C. Kolbitsch, P. M. Comparetti, C. Kruegel, E.
Kirda, X. Zhou, and X. Wang. , "Effective and
efficient malware detection at the end host".
18th USENIX Security Symposium, 2009.
19. Process Explorer v14.11,
http://technet.microsoft.com/en-us/sysinternals
/bb896653.
20. Malware Protection Center ,
https://www.microsoft.com/security/portal/Sub
mission/Submit.aspx.
21. 如何將傳送到 Microsoft 的惡意程式碼分
析,
http://support.microsoft.com/kb/939288/zh-tw
。
22. Anubis, http://anubis.iseclab.org/
(六)計畫成果自評
本研究主題惡意網站研究，主要在探討惡意
程式碼入侵系統的如何入侵用戶端的電腦，雖屬
於應用性的研究，但其意義與價值都非常重要，
現今大眾生活都與電腦與網路息息相關，各式各
樣的資訊都透過網路傳送，因此若電腦中藏有惡
意程式碼，被用來竊聽偷取各種資訊，將會對個
人隱私財富造成極大威脅，若惡意程式碼是有計
畫或規模的話，甚至會危及社會與國家安全。一
般廣大的電腦用戶通常較缺乏資安意識，喜歡享
受電腦與網路所帶來的便利，忽略背後看不見的
潛藏危機，因此如何確保廣大群眾能夠安全的使
用電腦，是非常重要的，否則一旦發生危害，輕
者造成個人損失，大者可能會造成社會或國家動
蕩與傷害，瓦解人們使用電腦與網路的信心。實
務上這是個可持續研究的議題。
研究成果除了針對惡意網站進行偵測與探
討之外，對於用戶端的安全，提出安全使用電腦
的方法，並提出一套快速檢查系統中是否潛藏惡
意程式碼的檢查方法。
其中對於惡意程式碼的進一步分析有其難
度，受限於時間因素與技術深度，僅能進行較為
初步的分析。
對於使用者方面，我們提出一套快速檢測系
統中惡意程式碼的方法，可幫助使用者使用簡單
的工具 processor explorer 嘗試找出潛藏於系統的
惡意程式碼，補防毒軟體之不足。
註: 本研究已有一篇研討會論文發表
1. 林大為、吳廸、王福東、蔡蕙逢，”快
速檢測惡意程式碼的方法”, Proc. of
the 2011 Conference on Network and
Information Security,台灣中壢, 2011/06
99 年度專題研究計畫研究成果彙整表 
計畫主持人：林大為 計畫編號：99-2218-E-231-002- 
計畫名稱：惡意網站的偵測研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 0%  
研究報告/技術報告 0 1 0%  
研討會論文 1 1 100% 
篇 
 
論文著作 
專書 0 0 0%   
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 3 2 100%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 0% 
人次 
 
期刊論文 0 0 0%  
研究報告/技術報告 0 0 0%  
研討會論文 0 0 0% 
篇 
 
論文著作 
專書 0 0 0% 章/本  
申請中件數 0 0 0%  專利 已獲得件數 0 0 0% 件  
件數 0 0 0% 件  
技術移轉 
權利金 0 0 0% 千元  
碩士生 0 0 0%  
博士生 0 0 0%  
博士後研究員 0 0 0%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 0% 
人次 
 
