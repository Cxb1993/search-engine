 2 
行政院國家科學委員會補助專題研究第一年計畫成果報告 
計畫編號：NSC-97-2219-E-305-001 
主 持 人：陳裕賢 教授    共 同 主 持 人：莊東穎 教授 
執行單位：台北大學資訊工程系 
計畫參與人員：卓卿雄、林耀祖、何智恩、易衛漢、 
洪家祥、黎炤均、黃宥威 
中文摘要 
子計畫四第一年主要核心是研究與設
計 Cognitive 網路架構下 MAC Protocol 與
mobility management的各項行動管理機制，
以 cross- layer 的跨層考慮來設計，並將針對
在各個網路架構中做垂直式換手（vertical 
handoff）所造成的影響作深入的研究與探討。
我們理論的結果: (1) 在認知網路下設計出
有效率的媒體存取協定, (2) 在認知網路下
設計出換手協定,  (3) 在 LTE 網路下設計
出以跨層伙伴協助並考慮安全機制之換手
協定, (4) 設計出網路移動協定在車載隨意
行動網路。子計畫四必須利用感知無線電終
端設備（Cognitive Radio Device）去獲得在
授權頻帶中閒置的頻帶且不影響授權用戶
情況下利用此頻帶, 實作的結果：(1) 頻譜
感測（Spectrum sensing）: 利用最有效的方
式偵測授權頻帶中的空閒頻譜（Spectrum 
hole）且不行干擾到授權使用者通訊為原則。 
(2) 頻譜移動性（Spectrum mobility）: 利用
Radio terminal 來達成動態存取頻譜並且是
極佳可用的頻道。(3) 配合其他子計畫整合
需求。確實達到預期目標。 
關鍵字：感知、協力、軟體定義無線電、
媒體存取控制、頻譜移動性。 
 
 
 
 
 
Abstract (英文摘要) 
The first year, subproject IV focuses on 
researches on Cross- layer cognitive and coop-
erative under MAC protocol and mobility 
management over 4G mobile networks. We 
have investigated, and to be aimed at Cogni-
tive and Cooperative network infrastructure to 
design vertical handoff. Our theoretical results: 
(1) E-MAC: an efficient MAC protocol in 
cognitive radio network, (2) a handoff mecha-
nism in cognitive radio network, (3) A re-
lay-assisted handover protocol with security 
for proxy mobile IPv6 in 3GPP LTE systems, 
(4) network mobility protocol for vehicular ad 
hoc networks. We have also implemented our 
research methods into SDR (Cognitive Radio 
Device) to obtain the real simulation results. 
Therefore, we must be used in Cognitive Ra-
dio Device to obtain spectrum hole in license 
band. To achieve our goals, (1) spectrum 
sensing: using the most effective way detec-
tion spectrum hole, (2) spectrum mobility: 
using Radio terminal achieves the dynamic 
access spectrum, (3) we adjust our model in 
order to integrate our project with other sub-
project. 
keywords：Cognitive、Cooperative、SDR、
MAC、Spectrum mobility。 
  
 4 
動裝置能在感知網路的環境中，能夠取得較
好的頻寬（bandwidth），在移動間還能夠持
續通訊，達到無縫隙換手（seamless handoff）
的目標。 
本子計畫即是在其中研究與設計
Cognitive 網路架構下 MAC Protocol 與
mobility management的各項行動管理機制，
以 cross- layer 的跨層考慮來設計，並將針對
在各個網路架構中做垂直式換手（vertical 
handoff）所造成的影響作深入的研究與探討。
以 下 是 Cognitive MAC 和 mobility 
management 的相關研究成果。 
二、 研究方法 
理論研究方法 
A. E-MAC: A Efficient MAC Protocol in 
Cognitive Radio Network (This result is 
accepted by Mobile Computing, Jun, 
2009) 
    在目前感知網路中，有許多感知無線電
媒體存取控制相關的研究，部份學者主要在
探討未授權使用者如何去感測授權使用者
不使用的頻帶且未授權使用者不可干擾到
目前授權使用者的通訊。另一方面亦在探討
當授權使用者須要使用時，此時未授權使用
者必須設法找到其它空閒頻帶使得資料持
續傳輸不中斷。而感知網路的媒體存取控制
中，我們將分成下列三個部分討論，分別是
隨機存取協定(Random Access Protocol)、時
槽協定 (Time-slotted Protocol)與混合協定
(Hybrid Protocol)： 
(1) 隨機存取協定 
    Ma et al.  提出 Dynamic Open Spec-
trum Sharing (DOSS) MAC protocol 將利用
多頻帶概念(Multichannel)，提供即時動態頻
譜 配 置 且 不 需 要 依 靠 基 礎 建 設
(infrastructure)。此方法同時可以避免隱藏節
點問題(Hidden terminal Problem)及曝露節
點問題 (Exposed Terminal Problem) 。其
DOSS 運作原理分為五個步驟：(1)偵測授權
用戶是否有再利用頻帶；(2)建立三個運作頻
帶：Busy Tone、控制頻道、資料頻道；(3)
頻譜對應；(4)頻譜協商；(5)傳送資料。相
關流程簡述如下：A 節點與 B 節點兩者相互
通訊，A 節點分配到兩個可用頻道 B 節點分
配到三個可用頻道，節點 A 透過 REQ 封包
傳送可用頻道給 B，在節點 A 與節點 B 兩
者相互交集頻帶之處找到一個共同協商頻
帶(Negotiated Band)並且馬上找出相互對應
的頻帶(Busy Tone)用來傳送 REQ_ACK 封
包。 
(2) 時槽協定 
Cordeiro et al. 提出 C-MAC protocol，如圖 
1，擁有 superframe 的想法，每個 superframe
有一個信標週期 (Beacon Period) 和一個資
料傳輸週期 (Data Transfer Period)，並 利用
動態約會頻道(Dynamic rendezvous channel，
RC)概念，想法來自於協調每個相異頻道並
且在靜止週期內偵測現行使用者，從眾多可
用頻道中指定一個 RC，由 RC 去指派最可
靠頻道供給其他使用者利用。透過 RC 可以
完成下列事項：一、提供外部頻道同步
(Inter-channel synchronization)，目的是為了
不讓頻道與頻道之間不要有所重疊。二、鄰
居找尋：透過 RC 可以快速計算出網路相互
連結的資訊。三、負載平衡：RC 所扮演共
享的角色使得在各種不同的頻道都有平均
使用流量達到平衡之效果。為了改善在
C-MAC 只保留兩個 signaling slot 來提供新
的節點加入，當遇到有許多為授權使用者要
加入時，容易造成碰撞，拉長新加入節點加
入群組的時間，進而影響整體傳輸效能。 
(3) 混合協定 
Zhao et al. 提出 Decentralized Cognitive 
MAC(DC-MAC)在感知無線網路中分為兩
類：一、集中式 (Centralized)二、分散式
(Decentralized)，本篇在 Ad Hoc 環境下設計
Cognitive MAC。DC-MAC 下探討每個節點
(Node)如何自行去感測可利用的頻譜，及如
何去收集周遭環境資訊。在此作者研究重點
放在利用統計方式來得知每個節點的頻譜
 6 
點可以快速加入並進行傳輸資料的動作。如
此一來我們就可以節省一個以上的超訊框
時間，當發生六個以上的節點想要加入群組
時，C-MAC 原始的方法最好的情況需要三
個超訊框完成六個節點加入群組的動作，而
我們的 MAC 方法只需要兩個即可完成，比
C-MAC 少一個超訊框。 
本計畫所設計的 MAC 協定會分成兩個階段，
分別是初始階段和資料傳輸階段。接下來我
們將利用文字闡述這兩個階段各自的運作
方法。 
(1) 初始階段 
    初始階段適用於領導節點在一開始設
定好約會頻道後，一直到發生資料傳輸前。
會這樣設計的原因在於，當一開始群組正在
形成時，節點跟節點之間的通訊通常尚未開
始，而每個節點都不知道要傳輸資料的目的
端是否在自己的傳輸範圍裡。由於通訊傳輸
尚未開始，不需要考慮到傳輸效能，我們可
以將信標週期長度拉到最大，同時，也兼顧
了節點加入群組的效率，讓能夠每個節點可
以馬上找到目的端，加快傳輸起始時間。以
這樣的想法作為基礎，當初始階段時，我們
將信標週期擴展到最大信標週期長度
(Maximum Beacon Period Length)，如圖四，
當發現有資料需要傳輸時，大部分的節點都
已經做好加入群組的動作，這樣就可以進入
下一個階段。 
BP
Superframe
DTP
Time
Channel 1 (RC)
BP
Superframe
BP DTP
Max BP length Max BP length Max BP length
Initial Stage
DTP
Superframe
 
圖四：初始狀態 
(2) 資料傳輸階段 
    在這個階段裡，我們不能像初始階段一
樣，將信標週期擴展到最大，這樣會壓縮到
資料傳輸週期時間，進而降低整體傳輸效能。
也不能如 C-MAC 一樣，只固定兩個
signaling slot 來讓新加入的節點發出信標，
遇到較多的新加入節點也會降低整體效能。
所以在這裡我們套入自己的 dynamic sig-
naling slot 方法，由創造 RC 頻道的領導者，
利用新加入的節點在 signaling slot中發生碰
撞的次數，與目前 signaling slot 的個數，預
測出目前可能想加入群組的節點數期望值。
除此之外，我們也先行算出在多少個
signaling slot 下與多少個節點下加入群組時
會發生碰撞的期望值，如表格 一，我們再
利用先前實際碰撞次數 coli和實際 signaling 
slot數 m所計算出的碰撞數期望值COL(coli, 
m)反查表格 一，就可以推估出目前想加入
的節點數 n。另外扣除實際成功加入群組的
節點數(REALSUC)，並加上下一個超訊框
可能想要加入的節點數(NEWARRI)，算出
來的值即為目前推估想要加入群組的所有
節點數(REALNODE)。 
表格 一：碰撞數期望值 
n\m 2 5 10 15    …  38 
2 0.5000 0.2000 0.1000 0.0667 …  0.0263 
5 1.6250 1.3136 0.8146 0.5821 …  0.2496 
10 1.9785 3.1210 2.6390 2.1014 …  1.0290 
12 1.9990 4.1644 4.5096 3.9614 …  1.4577 
20 2.0000 4.6541 6.0825 5.8340 …  3.6585 
 
表格 二：成功數期望值 
n\m 2 5 10 15    …  38 
2 1.0000 1.6000 1.8000 1.8667 …  1.9474 
5 0.3125 2.0480 3.2805 3.7942 …  4.4941 
10 0.0195 1.3422 3.8742 5.3744 …  7.8662 
12 0.0009 0.6597 3.4315 3.9614 …  8.9491 
20 2.0000 4.6541 6.0825 5.8340 …  12.0497 
 
    當我們預估出目前想加入群組的節點
後，我們將成功率設為 p％，意思在 n個想
加入的節點下，我所希望的期望值為 。
得到 的數值後，將此值反查表格 二，
就可以查到在 個成功節點數下，需要 m
 8 
用空閒頻帶的非授權使用者必須隨時保持
感知頻譜的變化、學習頻譜中個頻帶的使用
率和相關的資訊，當非授權使用者在感知頻
譜發現授權使用者有要使用的時候，則非授
權使用者必須馬上跳離開該頻帶並根據目
前感知頻譜的學習資訊選擇出一個最佳的
頻帶進行頻譜移動 (spectrum mobility)以保
持連線不中斷，頻譜的決策和移動在感知網
路中是非常重要的步驟，選擇最適合的頻帶
必須考量到訊號強度、頻帶使用率、頻帶大
小等資訊來做一個最佳的決策機制以確保
頻帶免於過多的碰撞和頻繁的切換。 
Frequency
Power
Time
 
圖 六：頻譜分布圖 
 到目前為止大部份的頻譜管理著重於
減少非授權使用者系統與授權使用者系統
干擾的問題，所以基本上授權使用者系統都
不容易受到非授權使用者的影響。然而，頻
譜管理問題應該要走向提供服務品質，不僅
是對授權使用者維持服務品質，在未授權的
使用者也必須考慮其頻譜頻寬、特性來提供
其適合的服務的品質。而感知無線電網路系
統的效能可以再提高，透過頻譜管理系統智
慧的頻譜分配經由考慮頻譜頻頻帶的特性。
如果有一個空閒頻帶在沒有考慮頻譜特性
的情況下配置給一個未授權的使用者，則可
能會有許多未授權的使用者會經歷頻繁的
頻譜換手 (spectrum handoff)，而若是某個空
閒頻帶的佔有時間不足以讓未授權的使用
者將資料傳送完，則未授權使用者將會換其
他的頻帶來繼續傳送。這樣的情形對於即時
性 (real-time)的服務是無法提供任何保證
且有害其傳輸的即時性，對於空閒頻譜的分
配也有可能將頻寬大的頻帶和佔有時間長
的頻帶分配給只需要傳送小資料或資料服
務的時間短的未授權使用者，這是非常沒有
效率的分配。因此作者提出了配對演算法，
針對不同資料服務的需求和空閒頻帶的大
小來對資源的有效利用和配置，如圖 七，
每個不同的未授權使用者所使用的服務將
被配置到各自適合的頻譜空間使得整個頻
譜空間的配置將更有效率。 
1 2 3 ……… N-1 N
1 2 3 1N N
1B 2B 3B 1NB NB
serv
ice 1
serv
ice 2
serv
ice 3
serv
ice N
-1
serv
ice N
 
圖 七：提供服務品質的頻譜配置 
 對於有效分配頻帶和服務品質的概念，
我們思考在多個基地台的情況下的頻譜分
配和決策機制，如圖 八，在 old eNB 基地
台中的非授權使用者有兩個，SU_1、SU_2
分別代表兩種不同的場景，第一個場景是當
SU_1 感知到該使用頻帶的授權使用者出現
時，由於目前 SU_1 接收到 new eNB 的訊號
還未超過可以服務連線的門檻，此情境為圖 
九中的紅色區域，SU_1 只需要對感知頻譜
所感知到的空閒頻譜進行我們最適合頻譜
頻戴演算法選出最適合的頻帶做為頻譜移
動。第二個場景是當 SU_2在 old eNB和 new 
eNB 的訊號重疊區域，如圖 九中黃色區域
且感知到目前使用頻帶的授權使用者的出
現，此時 SU_2 可以感知到 old eNB 和 new 
eNB 目前的頻譜各自使用情形。但由於
SU_2 是位於訊號重疊區域，如果 SU_2 選
 10 
中選擇一個最小完成時間的空閒頻譜即為
最適合頻譜頻帶。 
iSHreqiu
t
HLreqiureqi
RtrP
d
TtrPtSHC


),(
)),(1(),( 2
 而在圖 九中的黃色區域中的未授權使
用者，我們必須考慮到換基地台的情形和新
基地台的頻帶單位時間的使用頻率，而所需
要花費的服務完成時間計算跟單一基地台
情形類似，差在某些參數和換基地台的時間
不 同 而 有 所 改 變 ， 如 下 面 式 子 。











j
i
SHreqju
t
HL
SHreqiu
t
HLreqiureqi
RtrP
d
T
RtrP
d
TtrPtSHC
),(
),(
)),(1(),(
3
2
最後將所計算出的兩種可能做最後的選擇，
選擇最小花費時間的頻帶做頻譜移動，由於
每個頻帶能夠使用的機率都不同，所有可能
遭遇換手或傳輸失敗的情形都考慮進去，因
此，在兩種情形的總花費皆有可能為最小，
能夠有效的決策哪一個頻戴的選擇為最適
合換手的頻帶並減少頻譜換手的頻率和增
進頻譜的利用率。 
C. Mobility Management Research 
(1) Proxy Mobile IPv6 
 
圖 十：Proxy Mobile IPv6 
PMIPv6 協定允許 UE 保持原本取得的
IP 位址，意思是在新的網路下就像已經取得
address prefix(es)。UE 不需要執行位址運算，
當改變連接網路時。這個 PMIPv6 方法中定
義兩個核心功能元件，Local Mobility Anchor 
(LMA)和 Mobile Access Gateway (MAG)。所
有在 PMIPv6環境下的移動性管理功能都由
LMAs 和 MAGs 取代 UE。提出的方法中，
當一個 UE 移動並且連接到新的 MAG，而
MAG 必須偵測 UE 的連接和初始所需的程
序來認證和授權 UE，讓 UE 連接到網路，
而 UE 延續其 IP 通訊。如圖 十所示 PMIPv6
介紹了兩個新的功能元件： 
The Local Mobility anchor (LMA)，相似
home agent，它是地域性錨接點，給予 home 
network prefix(es)和紀錄 UE 目前的 binding 
state。 
The Mobile Access Gateway (MAG)，是扮演
proxy (foreign) agent和掌控傳送移動性信令
給 LMA 當 UE 移動時。在 PMIPv6 雖然使
用 network-based 移動性管理可以減少信令
過載，但是在換手期間依然遭受換手延遲時
間及封包遺失的影響。 
(2) A Relay-Assisted Handover Protocol 
with Security for Proxy Mobile IPv6 in 
3GPP LTE Systems 
3GPP 目前定義 3G Long term Evolution
正在進行中，它將是 all-IP 的網路架構，並
且提供高 bit rate 和 lower latencies 和 wider 
array服務。3GPP 的 LTE 系統是想成為未來
十年的有競爭力的主要 3GPP 連接技術，它
可以處理快速發展的 IP data traffic。當
UMTS 系統目前正建置在世界各地中，而系
統的效能以及成本的最佳化是必須考慮到
的兩個問題。首先在提升 UMTS 效能上有
HSDPA 提出標準在 3GPP Release 5 和
HSUPA 提出標準在 3GPP Release 6。理論上
可以達到的最高傳輸速率 14.4Mbps 而後者
則有 5.76Mbps in uplink。在 long-term 的部
分，必須完成 evolved radio interface 以及
3GPP 定義的 Evolved UTRA 和 E-UTRAN
中的封包網路架構。在 long term evolution
的主要目標是要達到 100Mbps的 data rate in 
downlink 和 50Mbps 的 data rate in uplink，
並且小於 20MHz的頻譜分配。 
 12 
機制，因此，在我們方法中多了 Relay來幫
助換手流程，也要有完善的安全性考慮。接
下來會介紹本計畫方法中主要的機制。 
 
圖 十二：Propose System Architecture 
 
圖 十三：ANDSF request procedure 
    如圖 十三所示為 Access Network and 
Discovery and Selection Function (ANDSF)，
在本計畫的方法中，當換手時加入了 Relay
來幫助使用者裝置，因此在還沒進入基地台
邊緣時，使用者裝置需要找找一個 Relay來
幫忙。由於在 LTE 的標準中有定義了
ANDSF 這個元件，用來提供使用者關於不
同基地台的資訊，以及可連接網路資訊，作
為判斷決策的依據。因此我們擴充 ANDSF
的功能，加上了提供 Relay資訊。當使用者
需要 Relay資訊時，會向 ANDSF 發出一個
請求。這時，儲存在 ANDSF 中有一個之前
各個終端使用者裝置所記錄的表格，藉由這
一個表格的資訊。分析出在發出請求的使用
者周邊有沒有合適的Relay可以供使用者使
用。資訊包含了，使用者名稱，所屬基地台
資訊，訊號強度，是否穩定的移動，是否支
援 Ad Hoc 通訊模式以及位置資訊。透過以
上資訊，提供給使用者準確可用的 Relay，
應用在換手的程序中。 
    如圖 十四所示為本計畫方法中另一個
重點，安全性管理。我們沿用在 LTE 原有
的密鑰管理以及安全認證機制。當使用者裝
置在換手期間，需要有 KeNB 這個密鑰來作
為認證的依據。然後在兩個不同基地台之間
也要溝通不同的資料加密機制，包含 NAS
和 AS 等不同層的協定通訊加密。換手的流
程中透過換手請求訊息交換剛剛所提及的
密鑰以及加密機制，達到換手時的安全性，
免於遭受惡意攻擊。另外，由於加入的 Relay，
因此安全機制也要從原有的機制中加以延
伸。本方法中在使用者裝置與 Relay之間加
上了兩把密鑰，一為認證用 KRelay，另一為
使用者裝置與 Relay 資料加密所使用
KRelay_enc。使用者裝置順利找到 Relay 來幫
助換手流程後，必須向此一Relay驗證身份，
確保使用者安全。因此，會發出 relay請求，
包含驗證密鑰以及加密密鑰，透過基地台在
道核心網路到達 Relay 所在基地台再到
Relay。如果過程順利 Relay通過驗證，使用
者及 Relay既可利用 Ad Hoc 通訊協定建立
連線。使用先求所交換的資料加密密鑰保護
之前通訊的安全，達到安全的目的。 
    完成上述幾個步驟後，既可安全的透過
Relay來協助使用者裝置換手。如圖 十五為
透過 Relay協助換手的是意圖。由圖中可以
看出，當使用者裝置在左邊基地台時使用的
是左方的通訊路徑，此時 PMIP 的 tunnel 保
持在做方的路徑中。一般的換手中一直到使
用者正確換到右方的基地台之後，才會把
tunnel切換過去，這時容易造成封包遺失以
及換手的延遲。因此，在本方法中利用 Relay
 14 
的 IP-mobility 的架構中並不適用在 VANET
環境，因為車輛的環境中有過高的移動性。
即使將 NEMO 的通訊協定套用到 VANET
的網路環境下時，也會找成過道延遲時間，
不適用一些即時的應用服務。MR 取得 CoA
的 DAD 程序的時間會造成第三層的延遲時
間。 
如圖 十七為本計畫主要的系統架構，
主要是以高速公路為主要道路模型，然後在
網路環境是以 WiMAX 以及 WLAN 並存的
異質網路，然後在車輛的通訊上都會有一個
Mobile Router，負責連線到網際網路，另外
車輛與車輛間的通訊也可以透過 DSRC 的
通訊協定來彼此通訊。 
 
圖 十七：System Architecture 
在Mobile router上配置兩個網路裝置，
分別可以連線到 WiMAX 以及 WLAN。另
外在 Mobile Node 方面僅有一種通訊介面
802.11，可以對 Mobile router 進行存取，如
過是在公車上時，MN 也可以利用多重跳躍
(multi-hop)來連接 MR。 
這邊提出本方法基本的設計構想：思考
傳統的 IP 位址取的機制都是由 DHCP 機制
來取得，這會造成過長的延遲時間，是需要
改近的地方。 另一較新的 IP位址去的方法，
可以分成兩個部分，都是在公路上的環境下，
可以較快速的取得同向車道所不用的 IP 位
址，另一個方法為取得對向車道所還給 AP
的 IP 位址。 設計一個由多個 mobile router
互相合作的的幫助換手機制，可以藉此事先
作取得 IP 的動做，稱為 Pre-handoff。 
 
圖 十八：Pre-handoff and Binding 
如圖 十八這是本設計需要克服的問題，
當有一台車輛要來開原本的通訊範圍時，要
歸還所使用的 IP 位址(CMR1)，因此會透過
multi-hop 將他傳送到即將進入此通訊範圍
的車輛(CMR2BMR1BMR2)，藉此來增
加換手時取得 IP 位址的時間，不過會因為
BMR1 以及 BMR2 的距離過短，所減少的時
間有限，另外一輛公車上要配備兩個 MR 會
造成較大的建置成本。 
在此方法中有幾個部分是具有挑戰性
來解決：  
一個是如何克服建置多個 MR 所需的高硬
體設備成本。另一個是在第一個 BMR 在進
到另一個新的網路下時，他是需要幫後方
BMR 來做 pre-handoff，因此本身沒辦法在
高速的移動下並且提供無縫式的換手。 
在作者提出的方法中可以分成四個架
構如圖 十九所示： a)真實的公車：佈建兩
個MR，分別在前的FMR以及後方的RMR。
b)一次跳躍的虛擬公車：也就是利用兩輛車
來形成的虛擬公車。c)二次跳躍的虛擬公車：
利用三輛車所組成的虛擬公車。d)多次跳躍
的虛擬公車：利用多部車所形成的大型虛擬
公車。 
在虛擬的公車上的 NEMO 方法，在高
速的網路環境下時，由於兩個 MR 距離較長，
因此可以快速取的 IP 位址，因此不需要向
DHCP 來取得 IP 位址，即可減少換手延遲
時間。可由圖上看到，當要進到一個新的網
路時，RMR 會先發出請求給 FMR 來取的新
 16 
實作研究方法 
A. spectrum access and mobility 
目前 spectrum sharing and allocation 與
spectrum access and mobility 這兩大方向目
的是由實體層技術得知何處有空白頻譜，
spectrum sharing and allocation 發現可用頻
譜向授權用戶借用頻譜且在不得干擾到授
權通訊；spectrum access and mobility 當授權
用戶將要繼續使用原有頻譜此時未授權用
戶須在找出下一個空白頻譜，得以繼續通
訊。 
在不同類型網路中利用頻帶感測得知
何處有可用頻帶，透過感知媒介存取控制
（Cognitive MAC）可以達到： 
1、 在不影響授權使用者下，未授權使用者
可以自由存取頻譜，使得頻譜利用度大
增。 
2、 頻譜移動性：當發現授權使用者利用自
己所擁有的頻譜時，此時未授權使用者
正在授權頻譜工作，未授權使用者勢必
找尋可用頻譜繼續通訊。 
(1) Spectrum mobility of Cognitive Radio 
User 情境 
在 WLAN 802.11 環境下讓兩端使用者
各自安裝 USRP device 去 sensing 目前無人
使用的 spectrum 來使用，並且可以達到更換
其他 spectrum的功能，如圖 二十三。 
 
圖 二十三：Spectrum mobility of Cognitive 
Radio User 情境 
情境流程： 
 假設 CR User A 為發射端和 CR User B
為接受端，都含蓋彼此的訊號範圍。 
 假設一開始使用 spectrum 1 做兩端的通
訊頻帶。 
當 primary user 開機或者進入 CR User 
A (and B)訊號含蓋範圍時，spectrum 1 就會
歸還 primary user使用，而CR User A (and B)
就會切換到 spectrum 2 互相通訊，達到
spectrum mobility 的效果。 
(2) Spectrum mobility of Cognitive Radio 
AP 情境 
一樣在 WLAN 環境下，除了具備 A.的
功能外，並且能夠透過具有連接 Internet 的
USRP device 讓沒有連結 Internet 的 USRP
使用者可以連結 Internet 達到 Spectrum 
mobility of Cognitive Radio AP 的功能，如圖 
二十四。 
 
圖 二十四：Spectrum mobility of Cognitive 
Radio AP 情境 
情境流程： 
 假設將CR User B當作 cognitive base 
station，則 CR User A 則可透過
CogNet base station(CR User B)連結
到 internet，再與 IMS network 做應
用。 
 假設一開始使用 spectrum 1 做 CR 
User A 與 CogNet base station(CR 
User b)兩端的通訊頻帶。 
當 primary user 開機或者進入 AP 訊號含蓋
範圍時，spectrum 1 就會歸還 primary user
使用，而 CR User A (and B)就會切換到
spectrum 2 互相通訊，達到 spectrum mobility
的效果。 
r
r
r
r
AP
USB
CR User A
USB
CR User B
Internet
Spectrum 2
Spectrum 1
Spectrum 1
Primary User
WLAN 802.11
Primary user spectrumSecondary user spectrum
Primary user spectrum
USB
CR User A
Cognitive Base Station
USB
CR User B
Internet
IMS Network
Primary User
AP
Spectrum 2Spectrum 1
Spectrum 1
Cognitive AP
Primary user spectrum
Secondary user spectrum
Primary user spectrum
 18 
my_tunnel.py 
 
圖 二十九：MN 端建立 tunnel的畫面 
 功能: 
 和 GNU Radio 所發布的 tunnel.py功能
ㄧ樣，主要建立一個虛擬的 interface。再設
定該 interface 所使用的頻率來建立兩端的
通訊聯結。 
 修改: 
1. class cs_mac(object): 
  def main_loop(self): 
min_delay=0.001 
time_one=time.ctime() 
hour_one=time_one[11:13] 
minute_one=time_one[14:16] 
second_one=time_one[17:19] 
  while 1: 
    payload=os.read(self.tun_fd, 10*1024): 
會ㄧ直讀取虛擬 
interface，如果有資料則讀取出 
來設定給 payload。如果沒有，則ㄧ直
讀取。 
freq = open("freq.dat", "rb") 
frequency = freq.read(7):讀取存在檔案裡面
可以使用的頻率 
change = freq.read(1):讀取判 
斷是否換頻的 index 
freq.close() 
payload = payload + frequency  
+ change:將要傳出去的 payload 
加上頻率的資訊和是否換頻的 
index 
if not payload:                 
  self.tb.send_pkt(eof=True) 
  break 
if self.verbose: 
  print "Tx: len(payload) =  
  %4d" % (len(payload),)          
self.tb.send_pkt(payload): 
傳送 payload 
if int(change) == 1: 
  print time.time() 
       sys.exit(1):如果 index為 1 
  則判斷為換頻，所以跳出程式。 
2. def main(): 
 這邊是設定一開始作為 tunnel所使用
的頻率。 
if options.rx_freq is None or options.tx_freq is 
None: 
options.rx_freq=2462000000.0 
options.tx_freq=2462000000.0 
tx_frequency=options.tx_freq 
if tx_frequency = options.tx_freq 
這邊是修改頻率的表示方式 
   if tx_frequnecy>=le6: 
frequency=str((tx_frequency*le-6))+ "M" 
present_freq=open("freq.dat", "w") 
present_freq.write(frequency+ "0") 
present_freq.close() 
3. def open_tun_interface (tun_device_filename): 
建立虛擬的 interface 
4. class my_top_block (gr.top_block): 
設定與 USRP receive 以及 transmit 的連結 
spectrum_sensing.py 
 功能： 
 在使用者所指定的頻率內，sensing 目
前所有頻率的使用情形計算該頻率的 dB 值。
在利用每個頻率的 dB 值計算每個 channel
平均的 dB 值判斷該 channel 是否處於使用
狀態（平均的 dB 值會根據不同的環境而有
所不同）。不過這邊會產生誤判的情形，因
為每個 channel 跨越的頻率範圍相當廣泛，
所以可能受到其他 channel 的 dB 值影響。
所以在利用每個 channel 的中心頻率的 dB
值來判斷一次。 
 最後，紀錄可以使用的 channel 的中心
頻率在 freq_list.dat中，以便換頻程式使用。 
 20 
可）。 
yy = 0  
while yy < channel_number: 
if total_mean[yy] > 6000000 and 
center_freq[yy] > 6000000: 
use_ornot[yy] = 'Yes' 
 """else: 
use_ornot[yy] = 'not'""" 
 yy = yy+1 
data.close() 
這邊是當執行 sensing 的次數等於預設的次
數後，則將目前可以使用的 channel 的中心
頻率存至 freq_list.dat 中，以便換頻使用。 
2. class tune(gr.feval_dd): 
 傳回下一次要判斷的頻率。 
3. class my_top_block(gr.top_block): 
 設定與USRP receive 和 transmit 的連結
並且判斷使用者所指定的頻率是否在該子
版所能 sensing的頻率範圍裡（目前是 802.11
的頻帶裡）。 
power.dat 
 功能： 
 為一個紀錄 sensing到的每個頻率的 dB
值。 
plot.p 
 功能： 
 將 sensing到的每個頻率的dB值利用圖
形畫出來。 
freq_list.dat 
 功能： 
 紀錄 sensing後可用的頻率資訊。 
freq.dat 
 功能： 
 當 MN 初始化建立第一次 tunnel 時，會
自動存放預設的頻率進來，並且換頻的
index設定成 0。因為虛擬 interface 做初始化
時，會將 interface 清空，這種情形並非要換
頻 ， 所 以 設 定 成 0 。 之 後 在
data_transmission.py 執行後，才需要換頻，
index也會被設定成 1。 
ifconfig.sh 
 功能： 
 設定虛擬 interface 的 IP address。 
data_transmission.py 
 功能： 
 固定一段時間，從 freq_list.dat 中取得
第一個可用頻率，傳送到 CN 端，作為換頻
的頻率。 
1. def main(): 
  while 1: 
print "---------------" 
freq=open("freq.dat","rb ") 
old_frequency=freq.read( 7) 
change=freq.read(1) 
 freq.close() 
new_frequency=set_freque ncy() 
print time.ctime(),"freq= 
%s"%new_frequency 
freq=open("freq.dat","w" ) 
freq.write(new_frequency +'1') 
freq.close() 
os.system("ping -c 1  192.168.1.100") 
print "------------" time.sleep(10) 
change_freq.py 
 
圖 三十一：MN 端執行換頻的畫面_1 
 
圖 三十二：MN 端執行換頻的畫面_2 
 22 
if int(change)==1: 
  sys.exit(1) 
else: 
  self.tb.send_ 
  pkt(payload) 
3. def main(): 
這邊是設定一開始作為 tunnel所使用的頻
率。 
   if options.rx_freq is None 
   or options.tx_freq is None: 
  options.rx_freq= 
  2462000000.0 
  options.tx_freq= 
  2462000000.0 
   tx_frequency=options.tx_fr 
eq 
if tx_frequency = options.tx_freq 
這邊是修改頻率的表示方式 
   if tx_frequnecy>=le6: 
frequency=str((tx_frequency*le-6))+ "M" 
present_freq=open("freq.dat", "w") 
present_freq.write(frequency+ "0") 
present_freq.close() 
4. def open_tun_interface (tun_device_filename): 
建立虛擬的 interface 
5. class my_top_block (gr.top_block): 
設定與 USRP receive 以及 transmit 的連結 
ifconfig.sh 
 功能： 
 設定虛擬 interface 的 IP address。 
freq.dat 
 功能： 
 當 CN 初始化建立第一次 tunnel時，會
自動存放預設的頻率進來，並且換頻的
index設定成 0。因為虛擬 interface 做初始化
時，會將 interface 清空，這種情形並非要換
頻，所以設定成 0。之後在記錄 MN 端所傳
送過來的頻率，才需要換頻，index也會被
設定成 1。 
 功能: 
 利用收到的頻率，重複執行建立 tunnel，
更改 tunnel的頻率。 
1. def main(): 
   while 1: 
  freq=open("freq.dat", 
  "rb") 
  frequency=freq.read(7) 
  my_tunnel =     
 "./my_tunnel.py --freq "+frequency 
  os.system(my_tunnel) 
change_freq.py 
 
圖 三十六：CN 端執行換頻的畫面 
B. 效能分析 
 在效能分析上，主要關注的焦點在於兩
台各自配備 USRP 的使用者在做通訊溝通
的時候  (此時假設初始狀態為兩端以
2.412GHz的頻率，如圖 三十七。) 
 
圖 三十七：USRP 以 2.412GHz建立 Tunnel 
 當使用者有移動的動作時，若使用者移
動逐漸遠離行動通訊服務的範圍之外，或是
Primary User 要使用已使用的頻帶時，使用
者必須做換頻的動作，此時先做 spectrum 
sensing，得到使用者自訂範圍的頻率分布，
緊接著使用者判斷此頻率分布哪些頻帶是
適合使用者作為換頻的依據，使用者可以依
據得到的頻率分布開始做移動換手的動作，
而我們的效能分析主要就在討論當使用者
做移動換手的時候，其中換頻所消耗的
latency time 為多少，這是我們所關心的事
情。 
 24 
六、 參考文獻 
[1] D. Niyato, E. Hossian, “A Noncoopera-
tive Game-Theoretic Framework for Ra-
dio Resource Management in 4G Heter-
ogeneous Wireless Access Networks”,  
IEEE Transactions on Mobile Computing 
2008, Vol.7, Much 2008, pp. 332-345. 
[2] 3GPP, at  http://www.3gpp.org/ 
[3] Yuh-Shyan Chen, Ming-Chin Chuang, 
and Chung-Kai Chen, "DeuceScan: 
Deuce- Based Fast Handoff Scheme in 
IEEE 802.11 Wireless Networks", IEEE 
Trans. on Vehicular Technology, Vol. 57, 
No. 2, March 2008, pp. 1126-1141. 
[4] Cordeiro and K. Challapali, ” C-MAC A 
Cognitive MAC Protocol for Mul-
ti-Channel Wireless Networks” IEEE In-
ternational Symposium on Dynamic 
Spectrum Access Networks (DySPAN '07), 
Page(s):147 – 157, 17-20 April 2007 
[5] C. Han, J.Wang, and S. Li, “A spectrum 
exchange mechanism in cognitive radio 
contexts, ” IEEE International Sympo-
sium on Personal, Indoors, and Mobile 
Radio Communications, Page(s): 1–5, 
Sep. 2006. 
[6] N. Jain and S. Das, “A Multichannel 
CSMA MAC Protocol with Receiv-
er-based Channel Selection for Multihop 
Wireless Networks”, IEEE ICCCN, Oct. 
2001. 
[7] L. Ma, X. Han, C.-C. Shen, ” Dynamic 
Open Spectrum Sharing MAC Protocol 
for Wireless Ad Hoc Networks” IEEE 
International Symposium on Dynamic 
Spectrum Access Networks (DySPAN '05), 
Page(s):203 – 213, 8-11 Nov. 2005 
[8] J. So and N. Vaidya, “Multi-Channel 
MAC for Ad Hoc Networks: Handling 
Multi-Channel Hidden Terminals Using a 
Single Transceiver,” ACM Mobihoc, May 
2004. 
[9] J. Tian and G. Bi, ”A new link mainte-
nance and compensation model for cog-
nitive uwb radio systems, “ International 
Conference on ITS Telecommunications 
Proceedings, Page(s): 254 – 257, Jun. 
2006 
[10] D. Willkomm, J. Gross, and A. Wolisz,
“Reliable link maintenance in cognitive 
radio systems, ” IEEE International 
Symposium on Dynamic Spectrum Access 
Networks (DySPAN '05), Page(s): 371–
378, Nov. 2005. 
[11] S.-L. Wu, C.-Y. Lin, Y.-C. Tseng, and J.-P. 
Sheu, “A New Multi-Channel MAC Pro-
tocol with On-Demand Channel Assign-
ment for Multi-Hop Mobile Ad Hoc 
Networks,” in I-SPAN, 2000. 
[12] Q. Zhao, L. Tong, A. Swami, ” Decen-
tralized Cognitive MAC for Dynamic 
Spectrum Access,” IEEE International 
Symposium on Dynamic Spectrum Access 
Networks (DySPAN '05), Page(s):224 – 
232, 8-11 Nov. 2005 
[13] Q. Zhao, L. Tong, A. Swami, and Y. 
Chen, ” Decentralized Cognitive MAC 
for Opportunistic Spectrum Access in Ad 
Hoc Networks:A POMDP Framework” 
IEEE Journal on Selected Areas in 
Communications, Volume: 25, Issue: 3, 
page(s): 589-600, April 2007. 
 
  
 26 
一、 研究目的 
本子計畫” Cross-Layer Design for Cognitive 
and Cooperative 4G-IMS Wireless Net-
works-Mobility Management and MAC Pro-
tocol” 於整合型計畫中扮演一個重要的角
色，目的是在我們必須使用感知無線電終端
設備（Cognitive Radio Device）去獲得在授
權頻帶中閒置的頻帶且不影響授權用戶情
況下使用此頻帶。軟體無線電（SDR）具有
的感知（Cognitive）能力可以感測（Sensing）
可用的無線電的訊號，在此我們稱為頻譜感
測。感知無線電媒體存取控制（Cognitive 
Radio Medium Access Control ） 簡 稱
CR-MAC，CR-MAC 可以去配置可利用的頻
道（Channel）且進行存取達成資料傳送至
目的地。為了讓 Cognitive 特性發揮至最佳
化無線電終端設備不僅能借用自己所屬範
圍的空閒頻帶，加入相互合作（Cooperative）
的概念還可以感測本身範圍以外的可用頻
帶，增加可 使用頻帶 使得整體 產能
（Throughput）大幅提升。 
 當感知網路使用者移動而切換網路
（handoff）及切換頻譜（Spectrum handoff）
時，連線的穩定性和延遲時間不能受太大的
影響，我們必須要考慮在不同的網路環境，
當使用者移動而切換網路時，連線的穩定性
和延遲時間避免太大的影響，各層之間的互
相配合就顯得很重要，我們將以 cross- layer 
design來把不同網路的各層做協調工作。預
計在 mobility and session management 部分
將會跨 link、network、transport 與 application 
layer 四層。因此系統需要提供更好的無縫
隙換手（seamless handoff）機制及通訊管理
（session management）的能力，才可以滿
足使用者的需求。 
 於第二年期我們網路環境定義在異質
網路架構運作於 4G 與 Wireless 兩種型態網
路架構將第一年設計 MAC protocol 向上延
伸分為兩部份： cross-layer cognitive 與
cooperatiion spectrum sharing and allocation 
及 cross- layer cognitive 與 cooperatiion spec-
trum mobility and access 主要目的強化第一
年 MAC protocol 之設計。在移動式管理方
面相對的我們也加入跨層設計利用夥伴機
制（partner base）透過鏈結層（data link layer）
所提供資訊得知另一型態網路狀況達成無
縫式換手。 
 在不同的網路間，經由互動和協調建立
來保持一個不中斷的連線，是 cooperative
的功能所在。其主要的目的是讓使用者在不
同的網路下能夠確保端點對端點有無縫的
連接性。然而 cognitive 最大的優點能夠在
異質性網路下藉由其 self-configuration 功
能，然後以動態方式調整要操作和內容變更，
達到網路的高效能以及充分利用異質性網
路的資源。有以上使 terminal mobility 充分
發揮，達到我們的訴求，在異質網路下快速
換手且不中斷通訊中連線。我們將加入協力
(cooperative)的觀念，讓使用者裝置之間彼
此可以提供 handoff 資訊，降低換手延遲時
間(handoff latency)，並運用多重 IP (multi-IP)
來建立兩條以上的可用路徑，提供換手時較
低的封包遺失(packet loss)。 
 但在網路中，行動節點會隨時移動，對
於行動節點的繞徑(routing path)不斷的更新，
造成網路拓撲(topology)的不穩定，使得網
路大部分的時間都在尋找繞徑(routing path)。
造成封包遺失(packet loss)或是影響到換手
延遲(handoff latency)的時間增加。為了維持
網路拓撲(topology)的穩定，藉由無線隨意
型網路協力(cooperation)運作輔助的特性，
中繼(relay)節點可以幫忙傳送資料，並改善
整體網路的效能。 
 Cognitive 的網路架構提供了感知，多覆
蓋網路，並且藉由適應性為基礎來感測和學
習跨層的網路環境。未來網路將朝向把
cooperative 和 cognitive 整合的無線通訊網
路發展。在這新的網路下使用者裝置的移動
性，必須要有更完整的機制，才能使使用這
裝置有不中斷的連線。過去異質網路下使用
 28 
感知無線電實體層的主要工作為頻譜感測，
利用頻譜感測獲得有用資訊以及得知目前
存在的授權使用者。在資料鏈結層主要的工
作為動態的頻譜配置，使得未授權的使用者
可以分配到尚未分配的頻譜。圖三(a)為 LTE
架構下感知無線電系統的模型，包含 LTE
核心網路、授權使用者(PU)以及未授權使用
者(SU)。為了達到頻譜感測的目的，SDR 技
術被實做在感知無線電的往架構下。SDR
是第一個整合不同通訊頻帶的能力。在感知
網路中，它允許配備 SDR 的未經授權使用
者去存取這些未被授權使用者所使用的頻
譜，如圖三(b)所示。圖三(c)顯示出，使用
者利用 SDR 設備在 LTE 感知無線電下所感
測到的頻譜狀態。在 LTE 架構下最小的無
線電單位為 resource block(RB)，而每個
resource block 為 180k(Hz)，每個頻帶都為若
干個 resource blocks所組成。如圖三(c)所示，
PU1 所使用的頻帶為 RB1 和 RB2 所組成，
PU2 為 RB5 所組成，PU3 為 RB9 和 RB10 所
組成，PU4 為 RB5 所組成。然而其他不被授
權使用者所使用的頻帶則為空閒頻帶，可以
被未授權使用者所使用，如SH1、SH2和SH3。
而我們主要考慮在 LTE 感知無線電中的未
經授權使用者換手的問題。 
在我們的方法中，最基本的想法就是去
觀察每個頻譜在過去被使用的情況以便於
我們預測每個頻譜被授權使用者回收的機
率。接下來利用預測出來的機率在考慮我們
所要傳輸的資料量大小來計算每個頻譜預
期的傳輸時間，透過預期的傳輸時間大小我
們可以選擇最快速(預期傳輸時間最短)的頻
譜作為下一次未經授權使用者存取的對象，
近一步預先決定是否執行第三層的換手至
新的基地台。圖四為每個頻譜所計算出來的
預期傳送時間，其中 CH1 為 5s、CH3 為 4s
以及 CH5 為 6s，CH2、CH4 以及 CH6 為授權
使用者正在使用的頻譜。 
 
 
(a). System architecture 
 
(b). Primary user and secondary user architecture 
 
(c). The sensed spectrum distribution 
圖三 ：System model, user architecture, and spectrum 
distribution 
 在我們所提出的方法當中包括了三個
階段需要執行。如圖五所示： 
(1) 環境觀察階段：每一個未經授權的使用
者都必須利用 SDR 週期性的去觀察每
個頻譜的使用狀態、接收訊號強度以及
授權使用者的出現。 
(2) 計算和分析階段：每個未授權使用者利
用第一階段所得到的訊息來計算和分
析頻譜的特性，例如：傳輸速率、頻譜
不 被佔用的機率。 
 30 
在得知這些訊息後，未授權使用者就可以進
 
(a). 資料狀態 
 
(b). 計算結果 
圖八 ：Example of old_eNB in the overlapped area 
入計算和分析的階段。圖七(a)為三個頻譜的
資訊狀態且接收訊號強度為 15dB。利用訊
號強度我們可以測得訊號雜訊比 SNR 值。 
 接下來，利用訊號雜訊比、每個 resource 
blocks 的過去被使用情況、傳輸的資料量以
及 套 用 poisson distribution 
1
( , ) i req
m
t
u i req
i
P m t e
 

 來計算每個頻譜在未來
資料傳輸的時間內被授權使用者佔用的機
率。圖七(b)為三個頻譜被佔用的機率，SH1
在未來傳輸 5.6s 下被佔用的機率為 0.7 
、SH2 為 0.7 以及 SH3 為 0.3。 
 接下來在估計和傳送的階段，利用第二
階段所計算每個頻譜被佔用的機率估計每
個頻譜預期的傳送時間。圖八顯示出在舊的
基地台的資料訊息以及計算後的結果，利用
SH1 傳送需要 13.407s、SH2 需要 13.086s 以
及 SH3 需要 22.343s。 
 在計算新的基地台時，未授權使用者如
果要換手到新基地台必須額外花費 layer3
換 
 
(a). 資料狀態 
 
(b). 計算結果 
圖九 ：Example of new_eNB in the overlapped area 
手的時間，所以必須將 layer3 換手的時間加 
入考量。圖九為計算新基地台的 SH’1 顯示
額外加上 0.35s 的換手時間。所以 SH’1 為
11.739s、SH’2 為 6.569s 且 SH
’
3 為 9.789s。
綜合以上新舊基地台的每個頻譜傳送時間，
為新基地台的 SH’2 傳送時間最短，所以未
授權使用者將使用這個頻譜來作為下一次
傳送所需的頻譜。 
 接下來，我們分析了 total transmission 
time 以及 throughput 兩個部份。 
如 圖 十 (a)(non-overlapped area) 以 及
(b)(overlapped area)所示，在未授權使用者傳
輸下一個封包時，必須先滿足該存取的頻譜
中每個 resource block 都不被授權使用者佔
用。一旦某一個 resource block 被佔用，則
跳至換頻譜的狀態。 
 在 non-overlapped area 下，假設目前所
要傳輸的封包數為N 且目前的頻帶分為 j 個
頻譜可以被未授權使用者使用，則全部封包
 32 
2 3 _
1
1
[(1- ( , )) ( )
         ),1 ,                               (9)
j
TTT u i req L H L H new eNB
i
t
req req
i
T P SH t T T P
j
d
t i j t
R

   
    

2 3 _
1
,
[(1- ( , )) ( ) )
       1 ,                                                 (10)
t
TTT j
u i req L H L H new eNB req
i
t
req
i
d j
T
P SH t T T P t
d
i t
R



   
   

 
(a). Total transmission time vs. data size 
 
(b). End-to-end vs. number of primary users  
 
(c). Throughput vs. Data size 
圖十一 ：Simulation results in non-overlapped area 
 我們所提出的方法結合了第二層和第
三層的換手並且不只考慮到傳送的資料量、
接 
 
(a). Total transmission time vs. data size 
 
(b). End-to-end delay vs. number of primary users  
 
(c). Throughput vs. data size 
圖十二 ：Simulation results in overlapped area 
收的訊號強度，也考慮到頻譜的大小
(number of resource block )、過去被使用的次
數以及接下來被佔用的機率。從模擬的圖示
中可以顯示出我們方法在第二層比 max idle 
time 的方法來的較好 (max idle time 只單純
考慮接下來每個頻譜可以被使用的時間，沒
 34 
 在無線移動網路中，當使用者和其他人
通訊時，他們自由地且頻繁地去改變存取接
點。為了支援移動節點的移動性，MIPv6被
利用去通知移動節點的家目錄地址和現在
的暫時性位址。MIPv6有太長的延遲時間和
太高的封包遺失率，因為MIPv6沒有
micromobility。接下來，階層式的MIPv6被 
提出來提供 micromobility 和 macromobility
經由佈置階層式的網路來減少換手的延遲。
然而我們提出了一個 cross-layer part-
ner-based fast handoff mechanism based on 
HMIPv6，稱作 PHMIPv6。圖十三為
PHMIPv6 的系統架構圖。這個通訊協定結
合了二、三層的換手並且達到合作的效果。
一個合作的節點就叫做合夥節點(partner 
node)。一個新的第二層觸發方法被利用在
PHMIPv6 的通訊協定，它可以準確的預測
下一個存取點的位置以及邀請一個在下一
個存取點內的合夥節點。利用這個合夥節點，
暫時性的地址可以預先取得並且預先執行
頷首的相關程序。如圖十四，PHMIPv6 明
顯地減少了換手的延遲以及封包的遺失
率。 
 
圖十七 ：Handover latency vs. distance between ARs  
 
圖十八 ：The performance of sequence number vs. time  
D. A cross-layer partner-assisted handoff 
 scheme for hierarchical mobile IPv6 in 
 IEEE 802.16e systems  (Wireless  
 Communications and Mobile Computing, 
 published online: Sep 21 2009)) 
 
圖十九 ：The performance of handoff latency vs. LCoA 
DAD time 
在下一代移動網路中，設計一個無縫式
的換手是重要的議題。一個新的無線頻帶存
取叫做WiMAX，在IEEE802.16e中被定義了
一些標準文件，提拱了高頻寬和較大的覆蓋
範圍。在移動網路中，MIPv6通訊協定提供
binding update message去更新移動站的IP資
訊來支援第三層的移動性。HMIPv6被提出
來利用佈置階層式網路架構來減少換手的
延遲時間。但是HMIPv6仍然遭受長時間的
換手延遲和高封包遺失率。所以我們提出
cross-layer approach by the combination of 
 36 
    在情境二中 MN 和 Access Router 
1(AR1)與 Access Router 2(AR2)，各自安裝
USRP，MN 與 AR1 一開始會 sensing目前
的頻譜，並且利用感測到的可用頻帶建立通
訊，當通訊通道建立完成後 MN 就可以透過
AR1 向 Correspond Node(CN)取得資料。當
PU 開始使用與 MN 和 AR1 相同頻帶時，
MN 就透過 MIPv6 的機制移動到 AR2 的網
域底下。MN 的移動流程分為以下幾個步
驟： 
1. 當 MN 從 AR1 的網域移動到 AR2 的網
域底下時，會收到 AR2 所發出的 Router 
Advertisement(RA)，MN 透過 RA 查覺到 RA
中 Prefix與原來的不同後，MN 會自動的設
定 Care of Address(CoA)，並發送 binding 
update 給 Home Agent(HA)。 
2. HA 收到 binding update 後時會更新其
binding cache entry 並回覆 binding Ack 給
MN。並利用 tunnel替 CN 轉送至 MN 的封
包。 
3. MN 收到 HA 所轉送的封包後，MN 得
知 CN 尚未更新 binding cache entry，MN 將
對 CN 發送出 binding update。 
4. CN 更新 binding cache entry後會回覆
Binding ACK 給 MN。此時 MN 即可直接與
CN 通訊。 
B. 頻段的選擇 
  我們將 2.397GHz到 2.479GHz之間的
頻段以 180K 為單分為數個 Resource 
Block(RB)並使用 USRP 偵測目前各個 RB
的使用情形後，將未使用且連續的 RB 組成
為一個 Spectrum Hole，並利用下列式子挑
選出較好的 Spectrum Hole 作為 spectrum 
mobility的選擇。 
2log (1 ) (11)i i dbR m RB SNR      
式子(11)計算 SH 的傳輸率，其中  代表RB
的數量，RB 代表 Resource Block 的大小，
即 180KHz。 
2
                         (12)
log (1 )
t
req
i db
d
t
m RB SNR
 
  
並透過式子(2)計算出所需要傳輸時間。其中 
td 代表所需傳輸的封包大小。
1
1
( , ) (0, )               (13)
mi
n reqn
m
t
u i req n req
n
P m t P t e


 

  
式子(13)主要在計算 SH 未被使用的機率，
其中λ為統計過去單位時間內 SH 被使用的
次數。並依照此機率的大小的來決定要挑選
哪個 SH 作為跳頻時所要跳到的頻帶。 
三、 實作研究成果 
A. 實驗環境 
 在子計畫所設計的 Spectrum mobility
架構之中。首先介紹我們在實作系統的建
構， 
 
圖二十二 ：系統架構圖 
 
圖二十三 ：IMS 網路端系統平台 
 38 
             AdvOnLink on; 
             AdvAutonomous on; 
     }; 
}; 
# EOF 
Mobile Node (需要安裝 MIPv6 與 RADVD) 
1. mip6d.conf (預設路徑為 
/etc/mip6d.conf) 
# This is an example of mip6d NEMO enabled Mobile 
Router configuration file 
NodeConfig MN; (指定為 MN) 
DebugLevel 10; 
DoRouteOptimizationCN disabled; 
DoRouteOptimizationMN disabled; 
UseCnBuAck disabled; 
# We use Explicit Mode 
MobRtrUseExplicitMode enabled; 
# Enable Optimistic Handovers  
OptimisticHandoff enabled; 
# The Binding Lifetime, for example 60 seconds  
MnMaxHaBindingLife 60; 
# Replace eth0 with your egress interface  
# (the one connected to the Home  Link or Foreign Link) 
(指定 MN 的連外介面) 
Interface "gr0" {  
     MnIfPreference 1; 
} 
# Replace eth0 with your egress interface (指定 MN 的
連外介面) 
MnHomeLink "gr0" { 
     IsMobRtr enabled; 
     HomeAgentAddress 2001:a:b:0::1000; 
     HomeAddress 2001:a:b:0::1/64 (2001:a:b:1::/64); 
} 
# IPsec configuration - NO IPSEC AT THE MOMENT 
UseMnHaIPsec disabled; 
KeyMngMobCapability disabled; 
# EOF 
2. radvd.conf (預設路徑為/etc/radvd.conf) 
# Mobile Router MR - radvd.conf 
# Replace eth1 with the interface connected to the 
NEMO-Link. 
interface eth1 (指定 MN 的對內介面) 
{ 
   AdvSendAdvert on; 
   MaxRtrAdvInterval 3; 
   MinRtrAdvInterval 1; 
   AdvIntervalOpt on; 
   prefix 2001:a:b:1::1/64 
   { 
        AdvRouterAddr on; 
        AdvOnLink on; 
        AdvAutonomous on; 
        AdvPreferredLifetime 60; 
        AdvValidLifetime 120; 
   }; 
}; 
# EOF 
Access Router (只需要安裝 RADVD) 
1. radvd.conf (預設路徑為/etc/radvd.conf) 
# Router R - /etc/radvd.conf 
# Replace eth0 with the interface connected to FL1 
interface eth0 (與 HA 的溝通介面) 
{ 
     AdvSendAdvert on; 
     MaxRtrAdvInterval 4; 
     MinRtrAdvInterval 3; 
     AdvIntervalOpt on; 
     prefix 2001:a:c:1::1/64 
     { 
             AdvRouterAddr on; 
             AdvOnLink on; 
             AdvAutonomous on; 
     }; 
}; 
# Replace eth1 with the interface connected to FL2 
interface gr0 (與 MN 的溝通介面) 
{ 
     AdvSendAdvert on; 
     MaxRtrAdvInterval 4; 
 40 
# Router R - Startup script 
# Interface definition 
IF1=eth0 
IF2=gr0 
# Do not accept Router Advertisements, and enable 
forwarding 
echo 0 > /proc/sys/net/ipv6/conf/all/accept_ra  
echo 1 > /proc/sys/net/ipv6/conf/all/forwarding  
# Configure the interfaces    
ifconfig $IF1 up 
ifconfig $IF1 inet6 add 2001:a:c:1::1/64 
ifconfig $IF2 up 
ifconfig $IF2 inet6 add 2001:a:d:1::1/64 
# Add a route via the Home Agent to the Home Link 
and the MNPs 
route add -A inet6 2001:a:b:0::/60 gw 2001:a:c:1::1000 
$IF1 
# Execute radvd 
radvd -C /etc/radvd.conf 
# EOF 
建立好各電腦的執行腳本檔後，依照順序分
別啟動執行，順序為  
1. 執行 HA 的 Script，如圖二十六： 
2. 執行 AR 的 Script，確認 HA 與 AR 的
MIPv6 啟動成功後， 
3. 執行 MN 的 Script。 如圖二十七所示。 
分別執行後，可看到 MN MIPv6 向 HA 要求
IP (圖二十八)，gr0 介面也取得了從 HA 註
冊 
 
圖二十六 ：執行 HA 套件的畫面 
 
圖二十七 ：執行 AR套件的畫面 
 
圖二十八 ：MN 向 HA 要求 IP 位址  
 
圖二十九 ：MN 獲得 IP 位址  
後所得到的 IP (圖二十九)。這表示 MN 已經
在 HA 的管理範圍內，接著執行換頻的動
作。 
 以下的程式碼是換頻程式修改部份，我
們利用 freq.dat 這個檔案去執行換頻動作，
如果 freq.dat 檔案內的值為 10，表示使用
2.462G (為我們所指定的 AR 頻率)，如果
 42 
 
圖三十三 ：換手成功後，保留原始 IP 
而 MN 的 gr0 介面一直發出
md_update_router 封包，這表示 MN 已經移
動到 AR 所在的管 
 
圖三十四 ：換手至 AR後，發送訊息給 HA 
理範圍內，並發出封包知曉 HA (圖三十四) 。
而HA就知道目前MN在AR的管理範圍內，
整個換手動作就此完成。 
期的結果有一段落差，如何降低換頻產生的
latency time 在效能的進步上也會是非常重
要且需要努力的一環。 
四、 結論 
 隨著無線網路設備商不斷地推出新興
產品，通訊技術不斷的演進，異質網路環境
已然逐漸成形。現今的人們可以隨心所欲地
透過行動裝置任意存取各種網路，以及使用
豐富多元的加值服務。4G通訊系統可以提
供異質（Heterogeneity）無線網路存取環境，
其中，最大的特色是讓使用者可以在任何地
方任何時間（Anytime anywhere）連上
Internet，不必考慮目前裝置處於何種網路環
境或者是使用何種通訊技術，並且能夠同時
提供語音、多媒體影音與資料傳輸等功能的
高傳輸速率網路，各種在Internet上的多媒體
服務都可以在4G網路上應用，提供更多元
化的服務。根據資料統計，目前導致頻譜空
閒的主因大部份來自於頻譜資源分配不均，
使得頻譜沒有被有效的分配，導致License 
Band無法充分被利用，在頻譜空間有限以及
大多數頻譜已被分配的情況下，如何善用這
些空閒的頻譜，將成為無線網路未來重要的
課題。 
本計畫中，我們針對Cognitive 網路架
構下，針對MAC Protocol與mobility man-
agement各項行動管理機制來達到跨層設計，
並實做於軟體無線電（SDR）平台中，實驗
結果顯示SDR可以做Spectrum sensing偵測
授權頻帶中空閒的頻譜（Spectrum hole）然
後建立通道，並且於程式中導入Shannon與
Poisson的公式，用以輔助選擇空閒頻帶，使
得頻帶隨時都能夠有效的被利用，提高網路
頻帶使用率。 
五、 計劃成果自評 
本子計畫提出 Cognitive and Coopera-
tive 網路架構下 MAC Protocol 與 mobility 
management 的各項行動管理機制，將所設
計之機制實現於軟體無線電（SDR）上，並
結合 MIPv6(Mobile IPv6)以及於程式中導入
Shannon 與 Poisson 的公式用以實現換手之
情境，並獲得實際測試數據及所需成果。根
據上述研究成果，我們自評本子計劃(子計
劃四)之設計與實作結果均符合計畫的預定
目標。六、 參考文獻 
[1]. 3GPP, at  http://www.3gpp.org/ 
[2]. Cordeiro and K. Challapali, ” C-MAC A 
 Cognitive MAC Protocol for Mul
 ti-Channel Wireless Networks” IEEE In
 ternational Symposium on Dynamic Spec
 trum Access Networks (DySPAN '07), 
 Page(s):147 – 157, 17-20 April 2007 
 44 
行政院國家科學委員會補助專題研究第三年計畫成果報告 
計畫編號：NSC-99-2219-E-305-001 
主 持 人：陳裕賢 教授    共 同 主 持 人：莊東穎 教授 
執行單位：台北大學資訊工程系 
計畫參與人員：吳承祐、廖士鋐、江依庭、宋協政、魏兆言 
中文摘要 
子計畫四第三年主要核心在於把前兩年
的成果做整合，並且加入中繼的概念，在
MIPv6 的架構下，處理 LTE、4G-IMS core 
network、WLAN 和 Ad Hoc 之間，利用跨層
設計行動管理及議程管理。我們理論的結果: 
(1) 在認知網路下設計出有效率的媒體存取
協定, (2) 在認知網路下設計出換手協定,  
(3) 在 LTE 網路下設計出以跨層伙伴協助並
考慮安全機制之換手協定, (4) 設計出網路
移動協定在車載隨意行動網路。子計畫四必
須利用感知無線電終端設備（Cognitive Radio 
Device）去獲得在授權頻帶中閒置的頻帶且
不影響授權用戶情況下利用此頻帶, 實作的
結果：(1) 頻譜感測（Spectrum sensing）: 利
用最有效的方式偵測授權頻帶中的空閒頻譜
（Spectrum hole）且不行干擾到授權使用者
通訊為原則。 (2) 頻譜移動性（Spectrum 
mobility）: 利用 Radio terminal 來達成動態
存取頻譜並且是極佳可用的頻道。(3) 配合
其他子計畫整合需求。確實達到預期目標。 
關鍵字： 感知無線電、協力、跨層、頻譜
移動、換手、LTE、中繼、綠色通訊 
 
 
 
 
 
 
 
 
Abstract (英文摘要) 
The third year, subproject IV focuses on 
integrating the results of the previous two years 
and adding the rely node to solve the issues in 
LTE, 4G-IMS, core network, WLAN and 
Ad-hoc network by using cross- layer design 
mobility and protocol management. Our theo-
retical results: (1) E-MAC: an efficient MAC 
protocol in cognitive radio network, (2) a 
handoff mechanism in cognitive radio network, 
(3) A relay-assisted handover protocol with 
security for proxy mobile IPv6 in 3GPP LTE 
systems, (4) network mobility protocol for ve-
hicular ad hoc networks. We have also imple-
mented our research methods into SDR (Cog-
nitive Radio Device) to obtain the real simula-
tion results. Therefore, we must be used in 
Cognitive Radio Device to obtain spectrum 
hole in license band. To achieve our goals, (1) 
spectrum sensing: using the most effective way 
detection spectrum hole, (2) spectrum mobility: 
using Radio terminal achieves the dynamic ac-
cess spectrum, (3) we adjust our model in order 
to integrate our project with other subproject. 
keywords：Cognitive radio、cross- layer、
spectrum mobility、handover、LTE、relay、
green communication. 
 
 
 
 
 - 46 - 
長期演進技術網路下具中繼輔助之感知
頻譜移動和換手通訊協定。在此協定中我們 
設計一個換手機機制藉由最小預期傳輸 
時間的計算來輔助中繼站完成換手工作。
模擬的結果說明了這項機制大大減少了傳輸
時間，中端間的延遲，並且提高了吞吐量。 
基於標準感知循環，我們所提出在
CR-LTE 網路下的頻譜移動及切換之中繼輔
助協定，可分為以下 4 個階段： 
 中繼探尋階段：SU 會從動態的 RNs 中
找到具有較豐富空閒頻譜空間(spectrum 
holes)作為中繼。 
 環境觀察階段：SU 會定期的監測頻譜的
利用率、接收使用中或新加入 eNBs 的
訊號強弱以及檢測 PUs 使用頻譜 4 的狀
況。 
 計算及分析階段：SU 將會計算及分析空
閒頻譜空間的特徵來評估傳輸速率和頻
譜閒置率。 
 評估及傳輸階段：SU 會根據所有可能的
預期傳輸時間來頻估是要在原eNB來進
行跳頻動作或是直接切換至另一新的
eNB。 
我們將考慮兩種考慮的狀況：(1)情境一
(頻譜移動)：SU 不位於重疊區域(overlapped 
area)。(2)情境二(切換)：SU 位於或進入重疊
機率。以下將以上述 4 階段來描述此兩種況
況： 
 
圖二：SU、RN 結構  
 
  
圖三：在情境一下之中繼探尋階段例圖 圖四：在情境二下之中繼探尋階段例圖 
  
 - 48 - 
會廣播一個請求訊息給 SUx 的鄰居，並
且等待中繼訊息去獲取空閒頻譜區間的
資訊並且從這些候選 RN 集合獲取鄰居
的 SNR 值。否則重新執行步驟(a)。 
4. SUx 在 RNs 的協助下執行計算及分機階
段去執行是否頻譜移動或切換以及是否
要藉由 RNs，取決於 TE(SHi)的數值，
TE(SHi)是被計算出的剩餘胡務資料量。 
對於情境一，圖五中表示， SU1從舊eNB
收到了 SNR 值 10dB。然後 SU1 廣播一個訊
息去給候選中繼節點 RN1 及 RN2，並且接受
他們的 SNR值及頻譜資訊。圖五亦表示 SH1、
SH2 及 SH3 分別為 2RB、3RB 及 4RB。圖六
則表示若一個 PU1移動到舊 eNB的範圍並且
回收被SU1占用的頻譜。該SU1進入新舊eNB
的範圍交疊區域，其各個的 SNR 值分別為 
10dB 及 15dB。接著 SU1 會廣播訊息給
候選中繼節點 RN1 及 RN2，並且接受他們的
SNR 值及頻譜資訊。圖六還表示 SU1的 SH1
和 SH3 分別為 2RB 及 4RB。此外 SH’1 和 SH’3
及 SU1 的 RN2 分別為 3RB、4RB 及 5RB。在
SH1 有兩個 RBs，其分別的佔用頻率為
λ1 = 30/1000及λ2 = 33/1000。可觀察到，
SH’2 和 SH’3 分別被 RN2 及 RN3 所使用。這些 
資訊將會被用來計算預期執行時間
TE(SHi)。 
(c) 計算及分析階段： 
在此階段的工作便是要計算預期執行時
間 TE(SHi)： 
1. 為了評估 SUx 剩餘服務資料預期傳輸時
間 TE(SHi)，𝑆𝑁𝑅 =
𝑃𝑠𝑖𝑔𝑛𝑎𝑙
𝑃𝑛𝑜𝑖𝑠𝑒
取自於當下存取之
eNB，其中情境一的 SNR 值為： 
𝑆𝑁𝑅𝑑𝐵 = 10 log10 (
𝑃𝑠𝑖𝑔𝑛𝑎𝑙
𝑃𝑛𝑜𝑖𝑠𝑒
) 
在情境二中，𝑆𝑁𝑅′ =
𝑃′𝑠𝑖𝑔𝑛𝑎𝑙
𝑃′𝑛𝑜𝑖𝑠𝑒
下一 eNB 的 SNR
值為： 
𝑆𝑁𝑅′𝑑𝐵 = 10 log10 (
𝑃′𝑠𝑖𝑔𝑛𝑎𝑙
𝑃′𝑛𝑜𝑖𝑠𝑒
)
′
 
2. 對於情境一，SUx 基於𝑆𝑁𝑅𝑑𝐵估計最大傳
輸率，對於所有的的頻譜區間 SHi 來計算傳
送剩餘傳輸資料大小 dt 所需傳輸時間 treq。讓
Ri 定義 SHi 的傳輸率，若 SHi 包含 mi 個資源
區塊 RBs，透過 Shannon 定理我們可知
𝑅𝑖 = 𝑚𝑖 × 𝑅𝐵 × log2(1 + 𝑆𝑁𝑅𝑑𝐵)。所需傳輸
時間： 
𝑡𝑟𝑒𝑞 =
𝑑𝑡
𝑚𝑖 × 𝐵 × log2(1 + 𝑆𝑁𝑅𝑑𝐵)
 
其中 dt 代表剩餘傳輸數據的大小。對於情境
2，SUx 基於𝑆𝑁𝑅𝑑𝐵及𝑆𝑁𝑅′𝑑𝐵估計最大傳輸率，
其中𝑆𝑁𝑅𝑑𝐵及𝑆𝑁𝑅′𝑑𝐵來自當下及新的 eNB
來估計傳送剩餘服務數據𝑑𝑡所需傳輸時間： 
𝑡𝑟𝑒𝑞 =
𝑑𝑡
𝑚𝑖 × 𝑅𝐵 × log2(1 + 𝑆𝑁𝑅𝑑𝐵)
 
(透過現存的 eNB)及 𝑡𝑟𝑒𝑞 (透過未來存取的
eNB)。讓 R’i 代表 SH’i 的傳輸速率，若 SH’i
包含𝑚𝑖個資源區塊(RBs)，所需傳送時間： 
𝑡𝑟𝑒𝑞
′ =
𝑑𝑡
𝑚𝑖
′ × 𝑅𝐵 × log2(1 + 𝑆𝑁𝑅𝑑𝐵
′ )
 
3. 為了預測頻譜區間 SHi 的可用性，SHi 
4. 空閒的機率必須額外計算。𝑃𝑢(𝑆𝐻𝑖 , 𝑡𝑟𝑒𝑞 )
表示 SHi 在時間𝑡𝑟𝑒𝑞及𝑡𝑟𝑒𝑞
′ 中不被 PUs 占用 
5. 的機率。為了在限制時間𝑡𝑟𝑒𝑞及𝑡𝑟𝑒𝑞
′ 內預
測閒置 SHi，透過 Poisson分布公式的使用，
我們可以將其程式化為P(𝑘, 𝑇) =
(𝜆𝑇)𝑘
𝑘!
𝑒−(𝜆𝑇)，
其中 k 是是件數量，T 是週期時間，並且𝜆代
表發生事件的比重。P(𝑘, 𝑇)定義了在時間 T
內 k 個事件發生的機率。為了分析在時間𝑡𝑟𝑒𝑞
及𝑡𝑟𝑒𝑞
′ 中 SHi 不會被使用的機率，我們將 k 設
為 0，T設為𝑡𝑟𝑒𝑞。因此若 SHi 包含mi 個RBs， 
6. SHi在時間𝑡𝑟𝑒𝑞中不被PUs占用的機率為： 
𝑃𝑢(𝑚𝑖 , 𝑡𝑟𝑒𝑞 ) = ∏ 𝑃𝑢(0, 𝑡𝑟𝑒𝑞 )
𝑆𝐻𝑖
𝑛=1
= 𝑒− ∑ 𝜆𝑛 𝑡𝑟𝑒𝑞
𝑚𝑖
𝑛=1  
此外，SHx 在交疊區域，SHx 評估𝑃𝑢
′(𝑆𝐻𝑖
′, 𝑡𝑟𝑒𝑞
′ )
對於所有的動態 RN’w，，若 SHi 包含 mi 個資
源區塊 RBs，SH’i 在時間𝑡𝑟𝑒𝑞
′ 中不被 PUs 占
用的機率為：  
 - 50 - 
 
1. 我們考慮兩種可能的𝑆𝑈𝑥情境。第一種
情境是如果沒找到任何的 RN，因此𝑆𝑈𝑥將會
在原有的 eNB 頻段中進行頻譜移動，在無
RN 的情況下繼續存取原 eNB。至於第二的
情境將藉由𝑅𝑁𝑧執行頻譜移動。𝑇𝐸(𝑆𝐻𝑖)代表
透過舊 eNB 使用𝑆𝐻𝑖的預期傳輸時間。如果
𝑆𝑈𝑥不在重疊區域，計算公式如下： 
𝑇𝐸(𝑆𝐻𝑖)
= 𝑡𝑅𝑁𝑧 +
𝑑𝑡
𝑃𝑢(𝑚𝑖 , 𝑡𝑟𝑒𝑞) × 𝑅𝑖
+ (1 − 𝑃𝑢(𝑚𝑖 , 𝑡𝑟𝑒𝑞)) × 𝑇𝐿2𝐻  
其中𝑇𝐿2𝐻 =
𝑑𝑡
𝑅𝑊𝐿𝐴𝑁
表示從𝑆𝑈𝑥到𝑅𝑁𝑧的傳
輸時間，若SUx藉由RNz協助，同時RNz占用
SHz。在第一個情境中tRNz =
dt
RWLAN
= 0。此
外 TL2H 是 第 二 層 切 換 時 間 並 且 (1 −
Pu(  , treq ))是在treq時間內SH (沒透過RNz)
或SHz(透過RNz)被占用的機率。如果沒有 PU
存在，傳輸時間為
dt
Ri
。然而連線很有可能被
其他的 PUs 打斷。為了讓預期傳輸時間更加
合理顧增加Pu(  , treq ) × R 。SUx使用SH 的
過程有可能再次被其他 PUs 中斷，𝑆𝑈𝑥將會
再次執行頻譜移動。此種情形的表示方式為 
(1 − 𝑃𝑢(𝑚𝑖 , 𝑡𝑟𝑒𝑞 )) × 𝑇𝐿2𝐻。 
2. 如果𝑆𝑈𝑥在新舊 eNB 覆蓋範圍的重疊區
域，𝑆𝑈𝑥的𝑇𝐸
′(𝑆𝐻𝑗
′)代表在 RNs 的協助下與新
的 eNB 進行連線的重新計算公式： 
𝑇𝐸
′(𝑆𝐻𝑗
′) = 𝑡𝑅𝑁𝑤′
′ +
𝑑𝑡
𝑃𝑢
′ (𝑚𝑖
′𝑡𝑟𝑒𝑞
′ )×𝑅𝑖
′ +
(1 − 𝑃𝑢
′(𝑚𝑖
′𝑡𝑟𝑒𝑞
′ )) × 𝑇𝐿2𝐻 + 𝑇𝐿3𝐻   
 其中𝑡𝑅𝑁𝑤′
′ =
𝑑𝑡
𝑅𝑊𝐿𝐴𝑁
代表從𝑆𝑈𝑥 經過𝑅𝑁𝑤
′
的傳輸時間，𝑇𝐿3𝐻代表第三層的換手延遲時
間，包括 DAD 時間和位置更新時間。如果
空閒頻段空間較少時，𝑆𝑈𝑥可能會執行第三
層的換手以及透過𝑅𝑁𝑤
′ 使用空閒頻段空間
𝑆𝐻𝑗
′，也就是說下一個連線的 eNB 是資源較
為貧瘠的網路連接環境。然而如果有足夠的
頻段空間，𝑆𝐻𝑗
′將會直接被使用不須經由存取
𝑅𝑁𝑤
′ 去新的 eNB ，因此
𝑑𝑡
𝑅𝑊𝐿𝐴𝑁
= 0。 
將 執 行 頻 譜 移 動 ， 如 果  (𝑡𝑅𝑁𝑧 +
𝑑𝑡
𝑃𝑢(𝑚𝑖 ,𝑡𝑟𝑒𝑞)×𝑅𝑖
+ (1 − 𝑃𝑢(𝑚𝑖 , 𝑡𝑟𝑒𝑞 )) × 𝑇𝐿2𝐻) −
  
(a) (b) 
圖八：在情境二下階段三階段四例圖 
 
 - 52 - 
ToldeNB =
Pspectrummobility × (1 − Pu(SH , treq)) ×
(TL2H +
dt
Ri+n
) + Prelay ×
(1 − Pu(SH , treq)) × (
dt
RWLAN×n
+
dt
Ri+n
) − (2)  
然而不需要變動的時間為不需換手的機
率乘上傳送一個封包的時間 
Tnon−recla med = Pu(SH , treq ) × (
dt
Ri×n
) − (3)  
最後代入第(1)的式子，我們可以得到 
TTTT =
1
j
∑ ((1 − Pu(SH , treq)) ×
j
 =1
(Pspectrum_mob l ty × n × TL2H + Prelay ×
tRN) + treq ) , 1 ≤ i ≤ j, treq =
dt
Ri
, tRN =
dt
RWLAN
⁡− (4)  
計算全部的傳送時間後，我們也可以得
知整體的 throughput 為資料量除以傳送時
間。 
TP1 =
dj×j
∑ ((1−Pu(SHi ,treq ))×TL2H+treq)
j
i=1
, 1 ≤ i ≤
j, treq =
dt
Rt
⁡⁡⁡⁡⁡⁡⁡⁡⁡⁡– (⁡5)  
接下來，在 overlapped 下，全部的傳送
時 間 為  TTTT =
1
j
∑ ∑ (Told_eNB +
N−1
k=0
j
 =1
Tnon−recla med ), 1 ≤ i ≤ j⁡⁡ ⁡⁡⁡⁡⁡⁡⁡⁡⁡⁡⁡− (6) 
Told_eNB為換手至舊基地台，由於一開始
存取便是舊的基地台，所以換手時不需考慮
到第三層的換手時間。 Told_eNB = Pold_eNB ×
Pspectrum_mob l ty × (1 − Pu(SH ,treq)) ×
(TL2H +
dt
Ri+n
) + Pold_eNB × Prelay × (1 −
Pu(SH ,treq)) ×(
dt
RWLAN×n
+
dt
Ri+n
)⁡⁡⁡− (7) 
Tnew_eNB 為換手至新的基地台，這時就
必須將第三層的換手時間加入。所以換手至
舊基地台的時間為換手至舊基地台的機率乘
於換手以及傳送的時間： 
Tnew_eNB = Pnew_eNB × Phandover ×
(1 − Pu(SH , treq)) × (TL2H + TL3H +
dt
Ri+n
) +
Pnew_eNB × Pnew_relay × (1 − Pu(SH , treq )) ×
 
圖十：scenario 2 的頻譜移動和換手關係 
 - 54 - 
大閒置時間方法來的好。  
圖十六是在scenario 2下的換手次數摸擬，
可以看得出來，我們的方法較其它兩種方法，
能有更少的換手次數。 
  
(a) (b) 
圖十三：(a) End-to-end delay vs. data size in scenario 1. (b) End-to-end delay vs. number of PUs of scenario 1. 
  
(a) (b) 
圖十四：(a) End-to-end delay vs. number of PUs of scenario 2. (b) End-to-end delay vs. number of spectrum hole of 
scenario 2. 
  
(a) (b) 
圖十五：(a) Number o f spectrum mobility vs. data size of scenario 1. (b) Number of spectrum mobility vs. number of 
PUs of scenario 1 
 - 56 - 
scanning延遲。圖十九說明藉由PS的幫忙，
PHMIPv6的換手延遲較HMIPv6來的低。 
 
圖十九：The performance of sequence number vs. time. 
 
C. Seamless session mobility scheme in 
het-erogeneous wireless networks (This 
result is published by International Journal 
of Com-munication Systems, Vol. 24, Is-
sue 6, pp. 789-809, June 2011 (2010 SCI 
IF=0.229)) 
 
圖二十：Network architecture of SmSCTP protocol. 
 
在這篇論文中，提及3GPP R99標準中，
UMTS網路服務由以下二部份組成，分別是
circuit-switched (CS)和packet-switched (PS)。
UE透過CS服務連線至Public Switched Tele-
phone Network (PSTN)，PS服務允許UE存取
網路服務。圖二十為PS藉由服務中的GPRS 
Support Node (SGSN)和一個Gateway GPRS 
Support Node (GGSN) 連線到額外的Packet 
Data Network (PDN)。 
 
圖二十一：Handover policy for SmSCTP. 
 
圖二十二：Impact of call mobility ratio on delay time 
and real implementation: CMR=0.5. 
 
如圖二十一所示，在切換到其它access 
points之前，UE需要執行換手演算法，而演
算法的目標是在有限的電量下最大化其傳輸
率。此演算法將電量分成兩種階段"full"和
"emergent"。在emergent階段，表示UE電池的
電量將秏盡，依據傳送速率存取不同的無線
網路，且在UE電量秏盡之前必需獲得最大正
常輸出。在full階段，對於異質性網路是很難
去使用SNR值，因為UMTS/HSDPA傳輸的範
圍比WLAN 大，但WLAN 的傳輸速率比
UMTS/HSDPA來得大。因此這篇論文使用可
 - 58 - 
 
圖二十五：MN 端以及 WLAN 
 
圖二十六：安裝有 MIPv6 的 HA 以及 AR設備  
 
在實作方面，是利用 GNU Radio 發佈的
軟體程式搭配 USRP(Universal Software Ra-
dio Peripheral)加上兩塊 RFX2400 子板。實作
換頻在GNU Radio上需要修改及新增一些程
式片段。實作的想法是 MN (Mobile Node)端
sensing 附近可以使用的頻率 (目前先以
802.11 下的 11 個 channel 為基準)來使用，在
環境中，有兩台MN 分別使用不同頻段與HA 
(Home Agent)及 AR(Access Router) 建立連
線。每隔一段時間會重新 sensing 頻段和重新
建立 tunnel，若計算出的最短預期傳輸時間
是與 RN (Relay Node)建立連線，則換手至
RN 的頻率，並由 RN 幫忙轉送資料。 
B. 實作內容 
在子計畫所設計的 Relay-Assisted 架構
之中。首先介紹我們在實作系統的架構。我
們利用 Linux上的MIPv6 與 RADVD這兩個
套件來架設我們所需的環境，此環境最少需
五台電腦，分別為 HA，MN，AR，CN 
(Corresponding Node)。在電腦上安裝好
MIPv6 與 RADVD 後，並建立好各電腦的執
行腳本檔(腳本檔於後面頁面補充)後，依照
順序分別啟動執行，順序為  
I.執行 HA 的 Script，如圖二十七： 
1. 執行 AR 的 Script，確認 HA 與 AR 的
MIPv6 啟動成功後， 
2. 執行 MN 和 RN 的 Script。 如圖二十八
所示。 
分別執行後，可看到RN 和MN的MIPv6
向 HA 和 AR 要求 IP (圖二十九)，gr0 介面也
取得了從 HA 註冊 
後所得到的 IP (圖三十)。這表示 MN 已
經在 HA 的管理範圍內且 RN 在 AR 的範圍
內，接著執行換頻的動作。 
 以下的程式碼是換頻程式修改部份，我
們利用 freq.dat 這個檔案去執行換頻動作，如
果 freq.dat檔案內的值為10，表示使用2.462G 
(為我們所指定的 AR 頻率)，如果 freq.dat 檔
案內的值為 20，表示使用 2.412G (為我們所
指定的 HA 頻率)。 
 
 
圖二十七：執行 HA 套件的畫面 
 
圖二十八：執行 AR套件的畫面 
 - 60 - 
 
圖三十三：MN 在執行換手時，發送 Update Router訊息 
 
圖三十四：RN 顯示幫忙轉送封包並顯示 
MN 換手成功後，可看到 MN gr0 介面的
IP 還是保留住(圖三十五) 
而 MN 的 gr0 介 面 一 直 發 出
md_update_router 封包，這表示 MN 已經移
動到 RN 所在的管 
理範圍內，並發出封包知曉 HA (圖三十
六) 。而 HA 就知道目前 MN 在 RN 的管理
範圍內，整個換手動作就此完成。 
預期的結果有一段落差，如何降低換頻
產生的 latency time 在效能的進步上也會是
非常重要且需要努力的一環。 
 
圖三十五：換手成功後，保留原始 IP 
 
圖三十六：換手至 AR後，發送訊息給 HA 
四、 結論 
現今的人們可以更方便地透過行動裝置
任意存取網路，以及使用豐富且多元的加值
服務。4G做為下一代的通訊系統，提供了更
優質的無線網路存取環境，其中，最大的特
色是讓使用者可以在任何地方任何時間
（Anytime anywhere）連上Internet，不必考
慮目前裝置處於何種網路環境或者是使用何
種通訊技術，並且能夠同時提供語音、多媒
體影音與資料傳輸等功能的高傳輸速率網路，
各種在Internet上的多媒體服務都可以在4G
網路上應用，提供更多元化的服務。 
根據資料統計，目前頻譜空閒的主因大
部份來自於頻譜資源分配不均，使得頻譜沒
有被有效的分配，導致License Band無法充分
被利用，在頻譜空間有限以及大多數頻譜已
被分配的情況下，如何善用這些空閒的頻譜，
將成為無線網路未來的重要課題。 
本計畫中，我們針對Cognitive 網路架構
下，針對MAC Protocol與mobility manage-
ment各項行動管理機制來達到跨層設計，並
實作於軟體無線電（SDR）平台中，實驗結
果顯示SDR可以做Spectrum sensing偵測授權
頻帶中空閒的頻譜（Spectrum hole）然後建
立通道，並且於程式中導入 Shannon與
Poisson的公式，用以輔助選擇空閒頻帶，使
得頻帶隨時都能夠有效的被利用，提高網路
頻帶使用率。在第三年中，我們更加入Relay
的概念，來達到更好的頻譜使用率。 
五、 計劃成果自評 
本子計畫提出 Cognitive and Cooperative
網路架構下 MAC Protocol 與 mobility man-
 - 62 - 
NodeConfig HA; 
# Set DebugLevel to 0 if you do not want debug mes-
sages 
DebugLevel 10; 
# Replace eth1 with the interface connected to the 
HOME LINK 
Interface "gr0"; 
HaAcceptMobRtr enabled; 
# MNP configuration 
HaServedPrefix 2001:a:b:0::/64; 
BindingAclPolicy 2001:a:b:0::1 (2001:a:b:1::/64) allow; 
DefaultBindingAclPolicy deny; 
# IPsec configuration - NO IPSEC AT THE MOMENT 
UseMnHaIPsec disabled; 
KeyMngMobCapability disabled; 
 
4. radvd.conf (預設路徑為/etc/radvd.con 
5. f) 
# Home Agent HA - radvd.conf 
# Replace eth1 with the interface connected to the Home 
Link 
interface gr0 (指定 Home Link 的介面) 
{ 
     AdvSendAdvert on; 
     MaxRtrAdvInterval 3; 
     MinRtrAdvInterval 1; 
     AdvIntervalOpt on; 
     AdvHomeAgentFlag on; 
     AdvHomeAgentInfo on; 
     HomeAgentLifetime 1800; 
     HomeAgentPreference 10; 
     AdvMobRtrSupportFlag on; 
     prefix 2001:a:b:0::1000/64 
     { 
             AdvRouterAddr on; 
             AdvOnLink on; 
             AdvAutonomous on; 
     }; 
}; 
interface gr1 
{ 
   AdvSendAdvert on; 
     MaxRtrAdvInterval 3; 
     MinRtrAdvInterval 1; 
     AdvIntervalOpt on; 
     AdvHomeAgentFlag on; 
     AdvHomeAgentInfo on; 
     HomeAgentLifetime 1800; 
     HomeAgentPreference 10; 
     AdvMobRtrSupportFlag on; 
     prefix 2001:a:b:0::1001/64 
     { 
             AdvRouterAddr on; 
             AdvOnLink on; 
             AdvAutonomous on; 
     }; 
}; 
# EOF 
Mobile Node (需要安裝 MIPv6 與 RADVD) 
3. mip6d.conf (預設路徑為 
/etc/mip6d.conf) 
# This is an example of mip6d NEMO enabled Mobile 
Router configuration file 
NodeConfig MN; (指定為 MN) 
DebugLevel 10; 
DoRouteOptimizationCN disabled; 
DoRouteOptimizationMN disabled; 
UseCnBuAck disabled; 
# We use Explicit Mode 
MobRtrUseExplicitMode enabled; 
# Enable Optimistic Handovers 
OptimisticHandoff enabled; 
# The Binding Lifetime, for example 60 seconds  
MnMaxHaBindingLife 60; 
# Replace eth0 with your egress interface  
# (the one connected to the Home Link or Foreign Link) 
(指定 MN 的連外介面) 
Interface "gr0" {  
     MnIfPreference 1; 
} 
# Replace eth0 with your egress interface (指定 MN 的
連外介面) 
 - 64 - 
RADVD=/usr/sbin/radvd 
# Put here the path to your mip6d binary 
NEMOD=/usr/local/sbin/mip6d 
# Deny RA and setup forwarding 
echo 0 > /proc/sys/net/ipv6/conf/all/accept_ra  
echo 1 > /proc/sys/net/ipv6/conf/all/forwarding  
# Enable Proxy NDP (to support returning home) 
echo 1 > /proc/sys/net/ipv6/conf/all/proxy_ndp 
# Configure the interface connected to the Home Link 
ifconfig $IF2 up 
ifconfig $IF2 inet6 add 2001:a:b::1000 
ifconfig $IF3 up 
ifconfig $IF3 inet6 add 2001:a:b::1001 
# Configure the interface connected to FL1  
ifconfig $IF1 up 
ifconfig $IF1 inet6 add 2001:a:c:1::1000/64 
# Route configuration 
# In order to route the packets to the Mobile Router 
when it is in the  
# Home Link. 
route -A inet6 add 2001:a:b::1 gw $MRLLADDR0 $IF2 
route -A inet6 add 2001:a:b::1 gw $MRLLADDR1 $IF3 
route -A inet6 add 2001:a:b::2 gw $MRLLADDR1 $IF3  
# Route the packets to the Foreign Link 2 via the Router 
R 
route -A inet6 add 2001:a:d:1::/64 gw 2001:a:c:1::1 $IF1 
route -A inet6 add 2001:a:e:1::1000 eth0 
# Execute the router advertisement daemon 
$RADVD -C /etc/radvd.conf 
#2001:a:b:0:2ff:36ff:fecf:2728 
# Execute the NEMO daemon 
$NEMOD -c /etc/mip6d.conf 
# EOF 
5. MN (Mobile Node) startup script 
#!/bin/bash 
# Mobile Router MR - Startup script 
# Interface definition 
IF1=gr0 
IF2=eth0 
# Put here the path to your radvd binary 
RADVD=/usr/sbin/radvd 
# Put here the path to your mip6d binary 
NEMOD=/usr/local/sbin/mip6d 
# Deny RA and setup forwarding 
echo 0 > /proc/sys/net/ipv6/conf/all/accept_ra 
echo 1 > /proc/sys/net/ipv6/conf/all/forwarding 
# IF1 is the egress interface. Do not configure any ad-
dress on it. 
ifconfig $IF1 up 
# IF2 is the ingress interface, connected to the 
NEMO-Link 
# Execute the router advertisement daemon  
$RADVD -C /etc/radvd.conf 
# Execute the NEMO daemon 
$NEMOD -c /etc/mip6d.conf 
# EOF 
6. Access Router (AR) startup script 
#!/bin/sh 
# Router R - Startup script 
# Interface definition 
IF1=eth0 
IF2=gr0 
# Do not accept Router Advertisements, and enable for-
warding 
echo 0 > /proc/sys/net/ipv6/conf/all/accept_ra  
echo 1 > /proc/sys/net/ipv6/conf/all/forwarding  
# Configure the interfaces    
ifconfig $IF1 up 
ifconfig $IF1 inet6 add 2001:a:c:1::1/64 
ifconfig $IF2 up 
ifconfig $IF2 inet6 add 2001:a:d:1::1/64 
# Add a route via the Home Agent to the Home Link and 
the MNPs 
route add -A inet6 2001:a:b:0::/60 gw 2001:a:c:1::1000 
$IF1 
# Execute radvd 
radvd -C /etc/radvd.conf 
# EOF 
  
 - 66 - 
可利用之產業  
及  
可開發之產品  
可利用之產業：電子通訊產業、無線通訊產業、綠色資通訊產業 
可開發之產品：無線網路優化系統、智慧型無線電資源管理系統、
綠色高效通訊系統 
技術特點  
1. 有效解決頻譜資源匱乏與頻譜使用率之問題 
2. 高效率且能適應性配置頻譜資源 
3. 能偵測空閒的頻譜，並有效避免對已授權用戶之干擾 
4. 使整體資源使用及傳送效率有效提升進而達到綠色科技的效果 
推廣及運用的價值 
本計劃在長期演進技術行動網路上提出具中繼輔助之感知頻譜移
動和換手通訊協定，使長期演進技術網路環境達到： 
1. 提供更加順暢及高效率的第四代通訊服務 
2. 減少使用者與基地台間切換的次數，大幅地增加訊號穩定度 
3. 高效率的傳輸，提升整體網路的產量 
4. 使用者可更快地完成存取服務並減少與基地台切換所帶來的延
遲時間，進而達到節省能源及資源的使用 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單位研
發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
 
 
Networks」，在這篇論文中我們提出了一個非常有效率的mobicast路由協定，在
3D的環境下，並用蘋果切片的概念，動態地準確評估的收集範圍，並準確地喚
醒下一時間點收集範圍內的感測器，以節省感測器能源並且我們同時考慮到於
海洋中的洋流及感測器分布不均的問題，大幅地減少發生傳輸中斷的現象。論
文發表時間安排於第二天的下午第一個時段，會議報告的房間內席位坐滿了各
國的學術與科技人士，最後Q&A時，提問相當踴躍，以生澀的英文戰戰兢兢的
回答，相當有意思。或許，正是需要這樣的挑戰與經驗，可以加強在研究上的
價值，這就是在辛苦研究後最好的回報。大會於4月1日下午圓滿閉幕，結束會
議議程。 
 
二、 與會心得:  
2011年無線通訊與網路技術國際會議在墨西哥的坎昆舉行，開會地點位於
坎昆Hotel-zone中樞的坎昆中心，科技感十足，會場動線規劃良好，讓與會專家
學者留下極為良好的深刻印象。在整個會議參與的過程中，不免發現各國專家
學者們的研究重點，正逐漸朝向綠能及次世代無線網路等議題。此外，在這次
會議中發表了一篇有關於水下網路之行動繞徑協定，論文題目為「A Mobicast 
Routing Protocol in Underwater Sensor Networks」。在這篇論文中我們提出了一
個非常有效率的mobicast路由協定，在3D的環境下，並用蘋果切片的概念，動
態地準確評估的收集範圍，並準確地喚醒下一時間點收集範圍內的感測器，以
節省感測器能源並且我們同時考慮到於海洋中的洋流及感測器分布不均的問
題，大幅地減少發生傳輸中斷的現象。在本次參加國際會議的過程中，見識到
何位大師級的風範，正確定的研究態度及一個好的研究該有哪些要素，並且也
了解到自我的不足，也給予了自己繼續精進研究的動力。 
A Mobicast Routing Protocol in Underwater
Sensor Networks
Yuh-Shyan Chen
Department of Computer Science and
Information Engneering
National Taipei University
Taipei, Taiwan, R. O. C.
Email: yschen@mail.ntpu.edu.tw
Yun-Wei Lin and Sing-Ling Lee
Department of Computer Science and
Information Engneering
National Chung Cheng University
Chia-Yi, Taiwan, R.O.C.
Email: jyneda@gmail.com, singling@cs.ccu.edu.tw
Abstract—A mobicast, or called as mobile geocast, problem
in three-dimensional (3D) underwater sensor networks (USNs)
is investigated in this paper, which aims to overcome the hole
problem and minimizes the energy consumption of the sensor
nodes while maximizing the data collection. In this work, all
underwater sensor nodes are randomly distributed in a 3D
underwater environment in the sea to form a 3D USN. Considered
a mobile sink or an AUV (autonomous underwater vehicle), all
possible sensor nodes near to the AUV form a 3D geographic
zone (called as 3D zone of reference or 3D ZOR). The AUV
travels a user-deﬁned route and continuously collects data form
sensor nodes within a series of 3D ZORs at different time. The
main problem is how to efﬁciently collect data from sensor nodes
within a 3D ZOR while those sensor nodes are usually in sleep
mode for a long period of time. The routing protocol relies on
two phases; the ﬁrst phase is to collect data form sensor nodes
within a 3D ZOR, and the second phase is to wake up those sensor
nodes in the next 3D ZOR to be queried while trying to avoid
topology holes. To save power, only sensor nodes in a 3D ZOR
are notiﬁed to enter the active mode in order to deliver sensed
results to the AUV. To consider the characteristics of USNs, a
new mobicast routing protocol is developed in 3D USNs. The key
design challenge is to develop a power-saving mobicast protocol
in 3D USNs to overcome the unpredictable 3D hole problem.
An ”apple slice” technique is used to build multiple segments to
surround a hole and to assure routing path continuity. Finally,
performance analysis is derived and simulation results illustrate
the performance improvement in successful delivery rate and
power consumption.
Keywords: underwater sensor network, mobicast, geocast,
multicast,routing.
I. INTRODUCTION
Underwater sensor networks (USNs) consist of number of
sensor nodes which are equipped with acoustic transceivers
that enable them to communicate with each other to perform
collaborative sensing tasks over a given area [1] from shallow
water and seabed. USNs have many potential applications
in ocean monitoring, such as current ﬂow and oil pollution
monitoring. The power consumption issue are mainly focused
on USNs [1]. Acoustic communication in the ocean encounters
a longer propagation delay. The location of sensor nodes in
the ocean is usually changed caused by the ocean current.
The USN is thus with the changeable topology over time.
In addition, the network fragmentation or hole problem is
occurred because that there is no uniform distribution of
underwater sensor nodes and the ocean current.
In this paper, a new multicast routing paradigm called a
”mobicast” is proposed in 3D USNs. A geographic zone,
called as 3D zone of relevance (3D ZOR), is prescribed by
an AUV (autonomous underwater vehicle) [2]. The AUV acts
as a mobile sink and nearly collects the sensed data from
sensor nodes. The spatiotemporal character of a mobicast is to
collect the sensed data from sensor nodes that will be present
at time 𝑡 in the 3D ZOR. Assumed that an AUV travels a
circle path around a given observed area. The AUV constructs
a series of 3D ZORs over different intervals (𝑡𝑠𝑡𝑎𝑟𝑡, 𝑡𝑒𝑛𝑑),
and only sensor nodes located in the 3D ZOR at the time
interval (𝑡𝑠𝑡𝑎𝑟𝑡, 𝑡𝑒𝑛𝑑) must wake up to send sensed data to the
AUV. After the AUV left the 3D ZOR, sensor nodes within
this 3D ZOR can switch to sleep mode for power saving.
It is observed that the 3D ZOR is evolved and continuously
moves with the AUV over time. Regarding existing routing
protocols in 3D USNs, Pompili et al. [3] proposed a unicast
routing algorithm in 3D underwater sensor networks to allow
each node to select its next hop with the highest successful
delivery rate under the minimum energy consumption. This
protocol focus on providing unicast routing in 3D networks.
The routing requirement which considers the temporal and
spatial issues at the same time to provide spatiotemporal
multicast routing in 3D underwater sensor networks needs to
be further investigated.
To successfully collect sensed data, sensor nodes in 3D ZOR
must be waken up to wait for the arrival of the AUV. Wang
[2] proposed an data collection solution in the underwater
environment. However, this protocol does not consider to
collect data from sensor nodes which may usually stay in sleep
mode for a long period of time. An AUV cannot successfully
receive the sensed data in time if sensor nodes in the 3D ZOR
are still in sleep mode. A sensor node may be not woke up by
a waking up message sent from the AUV when the AUV is
near to the sensor node because the waking up message may
fail to deliver due to the hole problem and the ocean current
effect. To consider the characteristics of USNs, a distributed
mobicast routing protocol in 3D USNs is proposed to deliver
mobicast messages for waking up all sensor nodes within a
3D ZOR at time 𝑡 for data collection. This is the ﬁrst result to
develop a mobicast routing protocol in USNs. The key design
challenge is to develop a power-saving mobicast protocol in
3D USNs to overcome the unpredictable 3D hole problem.
A apple-slice scheme of the mobicast protocol is proposed to
solve the unpredictable 3D hole problem. Finally, simulation
results illustrate the performance improvement in successful
IEEE  WCNC 2011 - Network978-1-61284-254-7/11/$26.00 ©2011 IEEE 510
Fig. 4. ZOF3𝑡+1 expands to cover the hole based on the network density and
the ocean current.
Fig. 3 shows an example of 3D ZOF𝑡+1. ZOF3𝑡+1 always
covers ZOR3𝑡+1 and the alternative routing paths can be
discovered in ZOF3𝑡+1 to deliver the the mobicast message.
The hole problem is solved. However, since the battery power
in USNs is a valuable resource, sensor nodes within ZOF3𝑡+1
should be carefully chosen for the mobicast message delivery.
In a 3D ZOF𝑡+1, there are multiple routing paths which can be
used to deliver the mobicast message. With the consideration
of the direction of current ﬂow, the successful delivery rate is
different on different routing paths. We discuss how to select
routing paths to achieve the highest successful delivery rate or
save power in the next section.
B. Basic Idea
To ensure that sensor nodes within ZOR3𝑡+1 can be waked
up for sensed data delivery, two steps are used. The ﬁrst step
is to determine the size of ZOF3𝑡+1. A large size of ZOF3𝑡+1
can overcome the hole problem and achieve higher successful
delivery rate but consumes much power. On the other hand,
a small size ZOF3𝑡+1 may not overcome the hole problem.
Therefore, the size of ZOF3𝑡+1 should be carefully considered.
To overcome the 3D hole in ZOR3𝑡+1, the drifted distance of
sensor nodes is the major concern. ZOF3𝑡+1 should be capable
of covering a sensor node even if the sensor node is drifted by
the ocean current. Therefore, the size of ZOF3𝑡+1 is determined
by the velocity of ocean currents and the network density. Fig.
4 (a) illustrates the size of ZOF3𝑡+1 is equal to the size of
ZOR3𝑡+1if there is no ocean current in ZOF3𝑡+1. If there exists
an ocean current in ZOF3𝑡+1, the size of ZOF3𝑡+1 is enlarged
to cover the drifted sensor nodes based on the velocity and
direction of the ocean current as shown in Fig. 4 (b). If the
network density is getting lower in ZOF3𝑡+1, ZOF3𝑡+1 expands
to a larger size to cover more sensor nodes for route discovery,
as shown in Fig. 4 (c).
The second step determines how many sensor nodes are
used to deliver the mobicast message. Two algorithms, A and
B, are proposed. Algorithm A uses all sensor nodes within
3D ZOF3𝑡+1 to deliver the mobicast message to achieve the
highest successful delivery. Algorithm B aims to keep a high
successful delivery rate and reduce the power consumption as
much as possible. With the consideration of the ocean current,
the successful delivery rate within different parts of ZOF3𝑡+1
are different. To keep a high successful delivery rate and save
power, the only sensor nodes which are necessary to wake up
are those nodes belonging to those parts of ZOF3𝑡+1 with a
high successful delivery rate. To divide a ZOF3𝑡+1 into several
parts, we use a simple concept – slice apple, as shown in Fig.
5. We slice a ZOF3𝑡+1 into 𝑚 several identical parts. We called
each part as a segment.
(a) (b)
Fig. 5. ZOF3𝑡+1 is split into (a) four segments and (b) six segments.
(a) (b)
Fig. 6. Messages delivery using (a) all segments (b) only segments 𝐿1, 𝐿2,
and 𝐿6.
Deﬁnition 𝐿𝑖 (segment): Given an 3D oblate spherical
ZOF3𝑡+1, the geographic location of sensor nodes in the oblate
sphere can be indicated as area ”𝐿”. The area 𝐿 can be divided
into 𝑚 identical parts. We called the each part of 𝐿 as a
segment 𝐿𝑖, where 𝑖 = 1, 2, ...,𝑚.
Fig. 5 (a) and (b) show that the ZOF3𝑡+1 is split into four
segments and six segments, respectively. The key idea of
this work is to use those sensor nodes in those segments to
deliver the mobicast for waking up sensor nodes in ZOR3𝑡+1.
Algorithm A is proposed to achieve the highest successful
delivery rate. All sensor nodes are used to deliver the mobicast
message as shown in Fig. 6 (a). Algorithm B aims to keep a
high successful delivery and save power. The only segments
with a higher successful delivery rate are used to deliver the
mobicast message as shown in Fig. 6 (b). A segment 𝐿𝑖 with
a higher successful delivery rate implies that the direction of
message delivery is similar with the direction of current ﬂow.
This is because sensor nodes are drifted in the same direction
with the same velocity; hence, the topology does not change
so quickly and links between sensor nodes have a longer life-
time. Finally, the size of a segment can adaptively expand
based on the real-time velocity and direction of the ocean
current in ZOF3𝑡+1. Fig. 7 (a) shows the size of segment 𝐿1 is
small if the velocity of the ocean current in ZOF3𝑡+1 is slow
and ﬁg. 7 (b) shows the size of segment 𝐿1 is large if the
velocity of the ocean current in ZOF3𝑡+1 is fast. The detailed
algorithm of the mobicast routing protocol is given in the next
section.
III. MOBICAST ROUTING PROTOCOL
In this section, we describe how an AUV collects sensed
data from sensor nodes with our mobicast protocol. Our
mobicast protocol is split into two phases, 3D ZOR𝑡 creation
phase and 3D ZOF𝑡+1 creation phase. In 3D ZOR𝑡 creation
phase, AUV creates the ZOR3𝑡 at time 𝑡 to collect sensed
data and delivers a mobicast message to wake up sensor
nodes which will be present at time 𝑡+ 1 in ZOR3𝑡+1. In 3D
ZOF𝑡+1 creation phase, the ZOF3𝑡+1 is created with a proper
size to cover the potential hole; meanwhile, ZOF3𝑡+1 is split
into several segments for the mobicast message delivery. The
detailed operation is developed as follows.512
Fig. 9. The ocean current and the segment quantity.
drift out of a large segment. A routing path could be easier
to establish; therefore, the delivery rate is usually high in
a segment with a large size. On the other hand, a segment
with a large size involves more nodes to deliver messages
and consumes much power. Hence, to ﬁnd a suitable size of
a segment is an important issue. A segment can tolerate a
stronger current ﬂow means that a sensor node does not drift
out of the segment during the time interval (𝑡, 𝑡+1). Since the
delivery direction is −→𝑠𝑖 , −→𝑠𝑜𝑖 is the direction which a node drifts
out of the segment. The distance which a node drifts during
the time (𝑡, 𝑡+1) is −→𝑠𝑜𝑖 ⋅
−→
𝐶 × (𝑡− 𝑡+1). This is, if the width
of a segment 𝐿𝑖 larger than
−→
𝑠𝑜𝑖 ⋅
−→
𝐶 , then this segment can
tolerate the current ﬂow. Since a segment 𝐿𝑖 has a arc length
with −→𝑠𝑜𝑖 ⋅
−→
𝐶 and the the arc length of a ZOF3𝑡+1 is 2𝜋𝑎, then
we can know the optimum segment quantity 𝑚 is
⌈
2𝜋𝑎−→
𝑠𝑜𝑖 ⋅
−→
𝐶
⌉
.
A segment with a suitable size can tolerant the current ﬂow.
Fig. 9 shows that the size of segments is determined according
to the velocity of ocean current.
Lemma 2: Assume that the successful communication rate
is 𝑝. Given a successful prediction probability (1−𝛼); then the
minimum node quantity for getting the largest node efﬁciency
is 𝑛𝑚 = (50𝑍𝛼2
√
𝑝(1− 𝑝)) 23 .
Proof: To ﬁnd the minimum node quantity for getting
the largest node efﬁciency, we should ﬁrst know the failed
delivery rate when how many sensor nodes are used to deliver
a message. Let 𝑛 denote as node quantity which means there
are 𝑛 sensor nodes to be involved for messages delivery.
An error rate function 𝐸(𝑛) =
𝑍𝛼
2
√
𝑝(1−𝑝)
√
𝑛
derived from
Z-distribution [5] can be used to predict the failed delivery
rate when there are 𝑛 sensor nodes to be involved to deliver,
where 𝑍𝛼
2
is a z-value which can ﬁnd from a Z-distribution
table [5]. To efﬁciently deliver the mobicast message, the node
efﬁciency should be large than or equal to 1%. The node
efﬁciency represents how much error rate is reduced while
one sensor node is added to deliver. The ﬁrst order differential
of 𝐸(𝑛) is 𝐸′(𝑛) which can describe the node efﬁciency,
where 𝐸′(𝑛) = −𝑍𝛼2
√
𝑝(1−𝑝)
2 𝑛
− 32
. To ﬁnd 𝑛𝑚, we let
𝐸′(𝑛) = −1%. Then we know 𝑛𝑚 = (50𝑍𝛼2
√
𝑝(1− 𝑝)) 23 .
Lemma 3: Given a 3D oblate spheroidal ZOF3𝑡+1 and the
minimum required node quantity 𝑛𝑚. Then the required seg-
ment quantity 𝐿𝑅 is
𝑛𝑚
𝑛𝑑𝑡
4
3
𝜋𝑎2𝑐
𝑚
.
Proof: The required segment quantity 𝐿𝑅 can be derived
from the total required volume. The total required volume
can be calculated by 𝑛𝑚𝑛𝑑𝑡 , and the volume of each segment
is
4
3𝜋𝑎
2𝑐
𝑚 , then we know the required segment quantity 𝐿𝑅 =
Fig. 10. The simulation environment and parameters.
𝑛𝑚
𝑛𝑑𝑡
4
3
𝜋𝑎2𝑐
𝑚
.
Algorithm B is presented as follows. Steps 1 and 2 of algo-
rithm B are the same as algorithm A. We describe algorithm
B from step 3 below.
S3’. Segments with higher delivery rate are identiﬁed in this
step. To achieve high successful delivery rate and power
saving , ZOF3𝑡+1 is divided into 𝑚 identical segments
according to Lemma 1. The only segments with a high
successful delivery rate should deliver the mobicast mes-
sage. A segment has a higher successful delivery rate if
the delivery direction of the segment −→𝑠𝑖 is similar to the
direction of current ﬂow −→𝐶 . So let a segment with a
shorter defer time to deliver if −→𝐶 ⋅ −→𝑠𝑖 is larger. A larger−→
𝐶 ⋅−→𝑠𝑖 implies that the delivery direction is more similar to
the direction of current ﬂow, then the successful delivery
rate is higher.
S4’. Sensor node 𝑁𝑖 should deliver the mobicast message if
𝐹𝑡+1(𝑁𝑖) ≤ 0. 𝐹𝑡+1(𝑁𝑖) ≤ 0 implies 𝑁𝑖 is located
within ZOF3𝑡+1. When sensor node 𝑁𝑖 in segment 𝐿𝑖
receives 𝑃𝑚 sent from a neighboring segment, 𝐿𝑖+1 or
𝐿𝑖−1, the sensor node immediately broadcast 𝑃𝑚 until
the required segment quantity 𝐿𝑅 is satisﬁed, where 𝐿𝑅
is
𝑛𝑚
𝑛𝑑𝑡
4
3
𝜋𝑎2𝑐
𝑚
according to Lemma 3.
S5’ The size of a segment can adaptively adjust since the
initial size of ZOF3𝑡+1 may not accurately predict. 𝑁𝑖
replaces the parameters in step 1 of algorithm A with
the real-time current ﬂow −→𝐶 in segment 𝐿𝑖 and network
density 𝑛𝑑𝑡+1 to acquire the new radius 𝑎′ and 𝑐′. With 𝑎′
and 𝑐′, ZOF3𝑡+1 has the proper size to tolerate the ocean
current.
IV. SIMULATION RESULTS
Our paper presents a mobicast routing protocol in under-
water sensor networks. The protocols are mainly implemented
using the ns2 simulator and Aqua-Sim emulator. Because our
mobicast protocol is the ﬁrst mobicast result in USNs, we
simulate our mobicast protocol to observe results when the
mobicast message is delivered using 100% segments, 𝐿𝑅𝑚 %
segments, and 30% segments. Algorithm A using 100% seg-
ments is denoted as 100% segments. The message delivery
using 30% segments is denoted as 30% segments. Algorithm
B uses the only sensor nodes in 𝐿𝑅𝑚 % segments to deliver
messages, which is denoted as LR/m% segments. The simu-
lation environment is shown as Fig. 10. The system parameters
are given below. To discuss the effect of the network density
(ND) of a USN, our simulator considers a 3D cubic region
with a size of 100 x 100 x 100 units with various numbers of514
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/11
國科會補助計畫
計畫名稱: 子計畫四: 跨層式感知與協力4G-IMS無線網路之行動管理與媒體存取協定研究
(3/3)
計畫主持人: 陳裕賢
計畫編號: 99-2219-E-305-001- 學門領域: 無線通訊(國家型) 
研發成果名稱
(中文) 在長期演進技術網路下具中繼輔助之感知頻譜移動和換手通訊協定
(英文) A Relay-Assisted Protocol of Spectrum Mobility and Handover in Cognitive LTE 
Network
成果歸屬機構
國立臺北大學 發明人
(創作人)
陳裕賢,洪家祥
技術說明
(中文) 感知無線電對於有效率的無線頻寬使用率是一個新穎的技術。由於一些頻帶(未
授權頻帶)被廣泛的利用，使得大部分的頻譜資源(授權頻帶)都沒被使用。這個
情況使得未授權的使用者(稱作次要的使用者)裝備感知無線電(SDR)來暫時存取
未被授權使用者(稱作主要使用者)使用的頻譜。轉送技術在長期演進技術網路
(LTE)中被提出。傳統的轉送技術主要是增加 LTE 網路的覆蓋範圍和傳輸量。在
本篇論文中，我們提出在跨層式感知 LTE 網路中，利用最小預期傳輸時間的轉
送節點來協助第二層的頻譜移動以及第三層的換手議題。允許未授權的使用者透
過轉送節點不僅可以存取原本的基地台(稱作舊基地台)也可以提早存取新的基地
台。
(英文) Cognitive radio is the novel technique toward efficient wireless bandwidth utilization. 
Most of the spectrum resources (licensed band) are underused due to some of the 
spectrum bands(unlicensed band) have been increasingly usage. This drives unlicensed 
users (called secondary users, SUs) equipped with cognitive radios (soft-ware-defined 
radio, SDR) to opportunistically access the spectrum not used by licensed users (called 
primary users, PUs). Relaying is one of the proposed technologies for future releases of 
Long Term Evolution (LTE) networks. The traditional relay technology is to increase the 
coverage and the capacity of LTE networks. In this thesis, we present a relay-assisted 
cross-layer protocol of spectrum mobility (layer-2) and handover (layer-3) with the 
minimum expected transmission time in cognitive LTE network, which allows unlicensed 
users not only access original base station (called old BS), but also new base station 
(called new BS) early through relay node (called RN).
產業別 電信工程業；電信業；資訊服務業；研究發展服務業
技術/產品應用範圍 無線網路優化系統、智慧型無線電資源管理系統、綠色高效通訊系統
技術移轉可行性及
預期效益
本計劃在長期演進技術行動網路上提出具中繼輔助之感知頻譜移動和換手通訊協定，使
長期演進技術網路環境達到： 
1.提供更加順暢及高效率的第四代通訊服務 
2.減少使用者與基地台間切換的次數，大幅地增加訊號穩定度 
3.高效率的傳輸，提升整體網路的產量 
4.使用者可更快地完成存取服務並減少與基地台切換所帶來的延遲時間，進而達到節省
能源及資源的使用 
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
result is published 
by Wireless 
Communications and 
Mobile Computing, 
Vol. 11, Issue 4, pp. 
522-541, April 2011 
(2010 SCI IF=0.810))
Kuan-Lin Chiu, 
Yuh-Shyan Chen, 
Ren-Hung 
Hwang, ’’Seamless 
session mobility 
scheme in 
het-erogeneous 
wireless 
networks’’ (This 
result is published 
by International 
Journal of 
Com-munication 
Systems, Vol. 24, 
Issue 6, pp. 
789-809, June 2011 
(2010 SCI IF=0.229))
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100%  
專書 1 1 100% 章/本 
Yuh-Shyan Chen, 
Yun-Wei 
Lin,  ’’Protocols 
and Applications of 
Cross-layer in 
Mobility 
Management’’(A 
book Chapter in 
‘Using Cross-layer 
Techniques for 
Communi-cation 
Systems’, IGI 
Global, 2012) 
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
國科會補助專題研究計畫成果報告自評表 
請就研究內容與原計畫相符程度、達成預期目標情況、研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）、是否適
合在學術期刊發表或申請專利、主要發現或其他有關價值等，作一綜合評估。
1. 請就研究內容與原計畫相符程度、達成預期目標情況作一綜合評估 
■達成目標 
□未達成目標（請說明，以 100 字為限） 
□實驗失敗 
□因故實驗中斷 
□其他原因 
說明： 
2. 研究成果在學術期刊發表或申請專利等情形： 
論文：■已發表 □未發表之文稿 □撰寫中 □無 
專利：□已獲得 □申請中 ■無 
技轉：□已技轉 □洽談中 ■無 
其他：（以 100 字為限） 
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價
值（簡要敘述成果所代表之意義、價值、影響或進一步發展之可能性）（以
500 字為限） 
本子計畫’Cross-Layer Design for Cognitive and Cooperative 4G-IMS Wireless 
Networks-Mobility Management and MAC Protoco’於整合型計畫中扮演一個重要的角
色，目的在於我們必須要依靠感知無線電終端設備（Cognitive Radio Device）去獲得在
授權頻帶中閒置的頻帶且不影響授權用戶情況下利用此頻帶。軟體無線電（SDR）具有感
知（Cognitive）的能力可以感測（Sensing）可用的無線電的訊號，在此我們稱為頻譜感
測。感知無線電媒體存取控制（Cognitive Radio Medium Access Control）簡稱 CR-MAC，
CR-MAC 可以去配置可利用的頻道（Channel）且進行存取達成資料傳送至目的地。為了讓
Cognitive 特性發揮至最佳化無線電終端設備不僅能借用自己所屬範圍的空閒頻帶，加入
相互合作（Cooperative）的概念還可以感測本身範圍以外的可用頻帶，增加可使用頻帶
使得整體產能（Throughput）大幅提升。 
在學術成就上，大多數現有的成果主要集中在設計於感知無線電網路中較低層的通訊協
定，而我們更進一步的探討在感知無線電網路第三層換手機制的問題，提出了一個在長期
演進技術網路下具中繼輔助之感知頻譜移動和換手通訊協定，藉由動態的 Relay Nodes 的
幫助使得跨層式換手協定有更好的效率，並提升整體網路環境。 
此外綠色通信便是使用感知無線電以減少全球二氧化碳排放的一種新興技術。大部分的授
權和免授權的頻段皆未被充分利用並且已有越來越多的未授權頻段被使用。這種使用未授
權頻段的裝置稱為次級使用者(secondary users, SUs），SU 配備感知無線電（軟體定義無
線電，SDR），以靈活且動態地訪問未被授權用戶(primary users, PUs)使用的頻譜。中繼
