 2
一、摘要 
 
1.1 中文摘要 
 
傳統以個體角度進行事故分析之方法，例如，判別分析（discrimination analysis）、羅吉
斯迴歸（logistic regression）、次序普羅比（ordered probit）、羅吉特（logit）及混合羅吉特（mixed 
probit）等模式，大多僅能探討單一危險因素之影響程度。事實上，事故嚴重與否大多係由多
項因素同時發生所導致。此一綜合多項因素之危險情況，在統計分析上，甚難加以窮舉分析。
基此，本計畫乃於第一年期提出基因規則探勘模式（Genetic rule mining, GRM），可由探勘所
得之規則的前半部，判斷何謂危險情況，進而加以避免。惟本研究所提出之 GRM 必須先固
定規則數量，再同時進行最佳規則組合之尋優。因此，具有染色體長度過長，尋優效果不佳，
以及探勘過多衝突或重覆規則的傾向，進而導致規則難以詮釋，無法提出具體之安全改善策
略。 
有鑑於此，本計畫第二年期乃提出改良式的基因規則探勘模式（Genetic rule mining, 
GRM），稱為逐步基因規則探勘模式（Stepwise GRM, SGRM）。SGRM 一次僅挑選使事故嚴
重度預測率精確率最高的一條規則，再以此規則為基礎，進行下一條規則之選取，直到精確
率無法再改善為止。如此，即可避免選擇規則過多，且相互重覆或矛盾的問題。此外，由於
不同類型事故之影響因素與危險情況不一定相同，因此，有必要加以區隔分析。本年度以先
以總計 5563 件單車事故（single vehicle accident）為分析基礎。結果顯示，本模式共選擇了
38 條規則，其訓練準確度達 75.1%，而驗證準確度則達 73.8%均遠高於決策樹之預測結果。
而影響事故嚴重度之危險情境也加以確認，並研提改善策略。 
本計畫第三年期進一步探討及比較本研究所提出之 SGRM、粗略集合（rough set, RS）及
次序普羅比（ordered probit model, OP）三種模式在分析不同事故嚴重度之選擇規則與重要解
釋變數。結果顯示，駕駛人職業別、事故地點及車輛型式是三個最主要的關鍵因素。最後，
本研究進一步將 SGRM 所挑選出的 38 條推理規則的前半部設定為危險情境（risk condition），
以虛擬變數表之，後半部則為事故嚴重度，結合次序普羅比進行危險情境之推估與檢定，以
了解各種危險情境對事故嚴重度之影響程度。結果顯示，本研究所提出之整合方法（SGMR
＋OP）其模式配適度，遠比將所有原始變數作為解釋變數所建構之 OP 模式為高，更可有效
辨識、檢定及推估各種危險情境，有效克服以往統計迴歸方法僅能探討單一變數對事故嚴重
度的缺點，更符合事故嚴重度係由多個肇因所導致之先驗知識。 
 
關鍵字：事故分析、逐步基因規則探勘、事故嚴重度、次序普羅比。 
 
1.2 Abstract 
 
Conventional individual approach to conduct accident analysis is to associate the crash severity 
with driver, vehicle and roadway factors by using discrimination analysis, logistic regression, 
ordered probit, logit and mixed logit models. Although statistic models are the commonly used 
methods in the context of crash data analysis, most of them have their own assumptions and 
complexity in the model estimation and interpretation. Once the assumptions were violated, the 
model could lead to erroneous estimation results, especially for the individual approach wherein 
most variables explaining the individual crashes are categorical. It is difficult to develop parametric 
statistical models based upon the categorical data. In addition, most of statistical methods only 
provide calibrated parameters with significance tests, which are then used to examine the effects of 
the corresponding variables on crash counts or crash severity. The interrelationship among 
explanatory factors cannot be examined in details. According to “error chain theory” a crash is often 
caused by a series of errors, not solely by a single factor. As such, mining the explanatory rules is 
deemed necessary for crash data analysis. To this end, the first research year of this project has 
 4
 
Although statistic models are the commonly used methods in the context of crash data analysis 
either collectively or individually, most of them have their own assumptions and complexity in the 
model estimation and interpretation. Once the assumptions were violated, the model could lead to 
erroneous estimation results, especially for the individual approach wherein most variables 
explaining the individual crashes are categorical (e.g., driver gender, road type, lighting condition, 
violation, weather condition, and severity degree, among others). It is difficult to develop 
parametric statistical models based upon the categorical data. Therefore, a number of 
distribution-free methods, such as decision tree (Chang and Chen, 2005; Chang and Wang, 2006) 
and artificial neural network (Chiou, 2006; Delen et al., 2006), were adopted to deal with the 
classification and prediction problems. However, two gaps still remain. First, the interpretations of 
classification results with such methods are weak. The knowledge lying in the crash data cannot be 
fully discovered, because artificial neural network is in essence a black box and the prediction error 
of decision tree is usually high. Second, most of statistical methods only provide calibrated 
parameters with significance tests, which are then used to examine the effects of the corresponding 
variables on crash counts or crash severity. The interrelationship among explanatory factors cannot 
be examined in details. According to “error chain theory,” a crash is often caused by a series of 
errors, not solely by a single factor. As such, mining the explanatory rules is deemed necessary for 
crash data analysis. It is shown in Figure 1 that limited information could be mined from the 
influence of single variable on crash severity. In contrast, combination of multiple variables would 
reveal explicit tendency in crash severity as shown in Figure 2 (The four rules in it is selected from 
the final rule set in this study). 
 
0
20
40
60
80
100
120
140
160
180
200
07:01-
09:00
09:01-
16:00
16:01-
19:00
19:01-
23:00
23:01-
07:00
Travel peroid (single variable)
fr
eq
ue
nc
y
fatality
injury
non-injury
   
0
5
10
15
20
25
30
R12 R20 R28 R33
Rule (combination of multiple varaibles)
fr
eq
ue
nc
y
fatality
injury
non-injury
 
Figure 1 analysis of single variable          Figure 2 applying rules to analyze 
 
Rule mining, also known as rule generation, rule recovery, or classification/association rule mining, 
is one of data mining techniques intended to mine for knowledge from available databases and 
toward decision support. Rule mining is naturally modeled as multi-objective problems with three 
criteria: (1) predictive accuracy, (2) comprehensibility, and (3) interestingness (Freitas, 1999; Ghosh 
and Nath, 2004). To automatically search for the optimal combination of rules from a considerable 
number of potential rules, genetic algorithms (GAs) are perhaps the most commonly used method. 
By employing GAs to learn of rules is named as genetic mining rule (GMR) (e.g. Freitas, 1999; 
Shin and Lee, 2002; Ghosh and Nath, 2004; Dehuri and Mall, 2006; Chen and Hsu, 2006). The 
performances of rule mining algorithms have been proven and applied in many fields. Thus, this 
paper aims to develop GMR model that can determine the optimal combination of decision rules to 
achieve the following goals: (1) to discover the key rules that determine the combination of 
contributing factors’ level to crash severity; (2) to provide the possibility of post-adjustment 
 6
 
In Taiwan, crash severity in police investigation report is classified into three degrees: A1 (fatal 
crash), A2 (injury crash), and A3 (non-injury crash). The cases for these three degrees of crash 
severity are 226, 1,593, and 3,744, respectively—an uneven distribution commonly seen in the 
context of crash analysis. Furthermore, 70% of these 5,563 crash cases are randomly chosen for 
training (i.e., 3,895 cases) and the remaining 1,668 cases are used for model validation. χ2-test is 
performed and the result shows that severity distributions between training and validation datasets 
do not significantly differ. 
 
2.3 Genetic rule mining model 
 
Genetic mining rule (GMR), which can automatically learn of comprehensive rules from available 
dataset and toward decision support, is useful in accident analysis (Clarke et al., 1998). The 
encoding method, fitness function, genetic operators, and rule selection of the proposed GMR 
model are narrated below. 
 
2.3.1 Encoding method 
 
To represent the relationship between explanatory variables and crash severity, each chromosome is 
used to represent a potential if-then rule. The conditions associated in the “if part” are termed as 
antecedence part and those in the “then part” are named as consequent part. Besides, the antecedent 
part consists of at least one variable, but at most 21 variables, selected from Table 1. And the 
consequent part is composed by, of course, only one variable: severity degree. In general, a rule is a 
knowledge representation of the form “If A Then C,” where A is a set of cases satisfying the 
conjunction of predicting attribute values and C is a set of cases with the same predicted degree. 
Thus, a typical rule i can be of the form: Rule i: If x1=ai1 and x2=ai2 …and xj=aij … and x21=ai21 
Then y=gi. Or, in a shorter form: Rule i: If Ai Then Ci, where aij is the categorical value of jth 
attribute variable in rule i. gi is the value of classification variable in rule i, which ranges from 1 to 3 
representing three degrees of crash severity. Ai and Ci are the sets of parties satisfying the 
antecedent part and consequent part of rule i, respectively. 
 
 
Figure 3 Encoding method of the proposed GMR model 
 
By encoding a rule as a chromosome, each gene is used to represent a corresponding variable. Since 
the number of potential variables of antecedent and consequent is respectively 21 and one, the 
length of a chromosome is 22. Each gene will then take one of the categorical values of the 
corresponding variable. Because the ranges of all variables are different, the ranges of gene values 
also vary. Moreover, if a gene in a rule antecedent takes a value of 0, it represents the corresponding 
variable not considered by the rule. If all genes representing the rule antecedent simultaneously take 
0 or if the gene representing the rule consequent is 0, then the rule is not included. 
 
Based on this, a rule of “If surface condition=dry and occupation=in job and actions=left 
lane-change and Then degree of severity=injury” can be encoded as 1000000000001000020002. 
This rule also contains a family of 4.838¯1010 offspring rules in total, which can be represented by 
“If x1=1 and x2={0, 1, 2} and x3={0, 1, 2} and x4={0, 1,…, 3} and x5={0, 1,…, 3} and x6={0, 1,…, 
 8
 G1t+1  = aGwt + (1-a)Gvt                                                
                                                        (2) 
G2t+1  = aGvt + (1-a)Gwt                                                
                                                        (3) 
G3t+1 with g3kt+1=min{gwkt, gvkt}                                           
                                                 (4) 
G4t+1 with g4kt+1=max{gwkt, gvkt}                                          
                                                 (5) 
where a is a parameter (0 < a < 1) and t is the number of generations.  
 
(2) Non-uniform mutation 
Let Gt = { g1t ,…, gkt ,…, gKt } be a chromosome and the gene gkt be selected for mutation (the 
domain of gkt is [gkl, gku]), the value of gkt+1 after mutation can be computed as follows: 
⎩⎨
⎧
=−Δ−
=−Δ+=+
1),(
0),(1
bifggtg
bifggtgg
l
k
t
k
t
k
t
k
u
k
t
kt
k 　　　
　　　
                                                
                          
   (6)
 
where b randomly takes the binary value of 0 or 1. The function ),( ztΔ  returns to a value in the 
range of [0, z] such that the probability of ),( ztΔ  approaches to 0 as t increases: 
)1(),( )/1(
hTtrzzt −−=Δ                                                               
                                           (7) 
where r is a random number in the interval [0,1], T is the maximum number of generations and h is 
a given constant. In eq. (7), the value returned by ),( ztΔ  will gradually decrease as the evolution 
progresses. 
 
2.3.4 Rule selection  
 
The method of extracting rules has profound effects on their accompanied performance. 
Conventionally, a group of different rules is obtained simultaneously from the final results as the 
stopping criterion is met. Generally speaking, it is an important issue to avoid selecting redundant 
or conflicting rules during the rule selection process. The redundancy or conflict between the 
selected rules would lead to reduce the performance of the prediction model, as well as increasing 
the difficulty in interpreting the causal relationship between explanatory variables and crash severity. 
However, it is probably difficult to avoid this condition and little information could be found in the 
literature on dealing with this issue (Shin and Lee, 2002; Kim and Han, 2003; Chen and Hsu, 2006). 
On the other hand, the mined rules are often too complicated to be understood instead of being 
interpretable, shorter, and simpler. In order to improve these problems, a learn-one-rule function 
combining with a neighborhood search was introduced over the rule mining process in this study. 
Instead of searching a good rule set at a time, a stepwise rue set building procedure with a greedy 
strategy is proposed. Applying the learn-one-rule function combining with a neighborhood search, 
the rule set is constructed according to the following steps (as shown in Figure 4):  
 
Step 1: Rank rules in the final population according to their fitness values in a descending order. 
Step 2: Select the rule with the highest fitness value and perform a neighborhood search with 
improvement and parsimony principle for rule modification. 
Step 3: Update the temporary rule set by the modified rule. 
Step 4: Terminate until the number of rules in the temporary rule set hit the preset number. 
Otherwise, implement the GAs for another run and go to Step 1. 
 
 10
 
The parameters of the proposed GMR model are set as follows: population size=50, crossover 
rate=0.85, mutation rate=0.08, and maximum number of generations=1,000 (the stopping criterion). 
The number of rules to mine is set as 55. The learning process of the GMR model is shown in 
Figure 6. 
 
0.1500
0.2000
0.2500
0.3000
0.3500
0.4000
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47 49 51 53 55
Number of rules
M
isc
las
sif
ica
tio
n r
ate Training
Validation
 
Figure 6 Learning process of the GMR model  
 
Theoretically, the misclassification rate can be lowered to zero monotonically by increasing the 
number of rules in the GMR model. However, a good classification model should not only fit the 
training data well, it must also accurately classify records it has never seen before. To avoid model 
overfitting, 38 rules are selected in the GMR model as the misclassification rate of validation data 
hit the lowest value. Table 2 shows the final selected rules along with its corresponding 
performance indices. Note that a total of 38 rules are selected with a descending order according to 
PAi. In terms of predictive accuracy (PAi), the top twenty five rules have remarkably higher values 
than the rest of thirteen rules. In terms of coverage ratio (CRi), R23 can explain 3,800 cases, 
followed by R30 (1,460 cases) and R31 (529 cases). In contrast, some rules cover only very few 
cases, such as R1 (6 cases), R6 (6 cases) or R7 (6 cases). 
 
The importance of variable can be identified by the number of its presence in all rules. The number 
of variables with values other than 0 (i.e. the variable is not considered by the rule) in all rules is 
then calculated. In this regard, x13 (driver occupation) is the most important variable which appears 
in 16 rules, followed by x16 (location), x15 (travel period), and x17 (vehicle type). Two variables are 
shown in less than three rules, which are x2 (signal control) and x8 (road status), indicating their 
least significance to crash severity. There are six rules associated with A1 crash, twenty-eight rules 
with A2 crash, and four rules with A3 crash.  
 
Most of the rules could be readily inspected and explained by the if-then relationship of the rules 
themselves. Taking R1 for instance, the rule indicates that when speed limit is 40~60 KPH and 
driver’s age is over 65 years old, it tends to lead A2 crash. R2 shows when drivers are male, in job 
and under 30 years old, speed limit is 100 KPH, travel period is midnight to morning, and major 
cause is alcoholic, it tends to lead A2 crash. As to R19, when safety belt is not fastened with driver’s 
speeding, it tends to cause A1 crash. In contrast to R19, R23 reveals when safety belt is fastened, it 
tends to be less severe (A3 crash). The rest may be deduced by analogy. More exploration of the 
potential implications of the rules is depicted as the following. In regard to driver characteristics, it 
 12
Table 3 Number of cases with degree of severity predicted by GMR 
Predicted severity 
Datasets Real severity 
A1 A2 A3 
Total 
 A1 85 (53.13%) 46 (28.75%) 29 (18.13%)  160 (100.00) 
Training A2 32 (2.87%) 723 (64.90%) 359 (32.23%)  1114 (100.00) 
 A3 22 (0.84%) 482 (18.39%) 2117 (80.77%)  2621 (100.00) 
 Total 139 1251 2505 3895 
 A1 37 (56.06%) 15 (22.73%) 14 (21.21%)  66 (100.00) 
Validation A2 3 (0.63%) 307 (64.09%) 169 (35.28%)  479 (100.00) 
 A3 11 (0.98%) 225 (20.04%) 887 (78.98%)  1123 (100.00) 
 Total 51 547 1070 1668
Note: The percentages are given in the parentheses. 
 
2.5 Comparisons 
 
2.5.1 Decision tree (DT) 
 
For comparison purpose, a decision tree (DT) model is also used to mine the rules explaining the 
same crash dataset. The DT model is performed by SAS Enterprise Miner Release 4.3. Several 
settings of the DT model are tried and the best performed settings are as follows. Splitting criterion 
is Gini reduction. Minimum number of observations in a leaf is 1. Observations required for a split 
search is 8. Maximum number of branches from a node is 2. Maximum depth of tree is 6. Splitting 
rules saved in each node is 5. The learning process of the DT model is depicted in Figure 7. Note 
that the misclassification rate decreases as the number of leaves gets larger.  
 
Table 4 presents the number of cases with various degrees of severity predicted by the DT model. 
Note that the DT model performs better in predicting the A3 crash (correct rates in training and 
validation are 97.71% and 97.15%, respectively) than the proposed GMR model. However, the DT 
model performs much worse than the proposed GMR model while predicting both A1 and A2 
crashes. Averagely, the overall correct rates of the DT model in training and validation are 70.24% 
and 69.54%, respectively, which are inferior to the proposed GMR model. 
 
0.27
0.29
0.31
0.33
0.35
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37
Number of leaves
M
isc
la
ss
ifi
ca
tio
n 
ra
te
TRAINING
VALIDATION
 
Figure 7 Learning process of the DT model 
 
 14
A-upper approximation of Y, denoted by AY , are respectively defined as 
 { }YXAXXAY ⊆∈= ∗ andU                                             (8) { }φ≠∈= ∗ YXAXXAY IU and                                          (9) 
 
The objects belonging to the set of lower approximation are those definitely definable by the 
elementary sets, since objects in AY  can be fully identified by the elementary sets in A*. On the 
other hand, those belonging to the set of upper approximation but not to the set of lower 
approximation cannot be fully identified by the elementary sets in A*. 
 
As illustrated in Table 5, five cases are characterized with three condition attributes: driver’s age, 
vehicle type and weather, and one decision attribute: crash severity. The three condition attributes 
form four elementary sets: {1, 3}, {2}, {4}, {5}. This means that cases 1 and 3 are indiscernible 
while the other cases are characterized uniquely with all available information. Therefore, the fatal 
accident type is described with the lower approximation set {2} and the upper approximation set {1, 
2, 3}. Similarly, the concept of the injury accident type is characterized by its lower approximation 
set {4, 5} and upper approximation set {1, 3, 4, 5}. The performance of the specified condition 
attributes can be measured with two indicators: accuracy of approximation and quality of 
approximation. Accuracy of approximation represents the percentages of the associated objects 
definable with the specified condition attributes. This can be defined as follows: 
 
Table 5 Example of crashes with three factors 
Case Driver occupation Vehicle type Weather Severity 
1 In job Passenger car Rainy A1 
2 Jobless Truck Rainy A1 
3 In job Passenger car Rainy A2 
4 Student Passenger car Rainy A3 
5 Student Truck Sunny A2 
 
( ) ( ) ( )AYAYYA cardcard=μ                                                   (10) 
 
where card refers to cardinality. The accuracy value ranges from 0 to 1. The closer to 1 is the 
accuracy, the more discernible is the accident type. Namely, more cases of this accident type are 
discernible by the elementary sets generated by the specified condition attributes. It implies that the 
associated crash severity do exist unambiguously. Following Table 4, the accuracy of 
approximation for the fatal class is 0.33(=1/3) and for the injury class is 0.50(=2/4). This implies the 
injury class can be defined more unambiguously than the fatal class with the provided three 
condition attributes. On the other hand, quality of approximation represents the definable 
percentage of the whole universe. Let X = {Y1,Y2, ... ,Yn} be a classification of U, i.e. Yi ∩Yj = φ, ∀i, 
j≤n i ≠ j and UYi
n
i ==1U . Yi are called classes of X. The A-lower approximation and A-upper 
approximation of X are represented by sets AY  = { 1AY , 2AY , ... , nAY } and AY  = 
{ 1AY , 2AY , . . . , nAY }, respectively. Quality of approximation of classification X by a set of 
attributes can be defined as follows: 
 
( ) ( ) ( )UAYY iA cardcardU=η                                                  (11) 
 
The value of quality ranges from 0 to 1. The closer to 1 is the quality, the more objects of the 
 16
Table 7 Estimation results of the OP model 
Variable β t-value 
Constant 0.656 3.89 
μ1 0.00 - Thresholds μ2 1.430 35.10 
Driver characteristics 
License (without license) 0.171 1.75 
Use of safety belt (safety belt fastened) -1.733 -13.92 
Driver occupation (student) 0.206 2.66 
Alcoholic use (> 0 mg/l) 0.182 2.94 
Journey purpose (visiting/shopping trip) 0.151 2.35 
Driver age (over 50 years old) 0.506 2.54 
Vehicle characteristics 
Vehicle type (truck; bus) 0.232 4.55 
Action (others) 0.166 1.74 
Crash characteristics 
Location (shoulder edge; median) 0.168 3.04 
Major cause (fail to keep a safe distance) -0.506 -3.54 
Travel period (midnight to morning) 0.109 2.25 
Environmental characteristics 
Speed limit  0.277 2.15 
Road status (grade and curved road) 0.247 1.93 
Marking (no lane-changing line) 0.381 2.48 
Surface condition (dry) 0.187 4.25 
Obstacle (work zone; others) -0.214 -2.40 
Light (nighttime without illumination) 0.117 2.21 
Goodness of fit measures 
Mean Loglikelihood (null model) -0.756 
Mean Loglikelihood (convergence) -0.707 
Adjusted rho-square  0.065 
BIC 5654.052 
AIC 5543.238 
Note: The significance (t-value) of independent variables is above 1.645. 
 
Table 8 Number of cases with degree of severity predicted by the OP model 
Predicted severity 
Datasets Real severity 
A1 A2 A3 
Total counts
A1 28 (17.50%) 22 (13.75%) 110 (68.75%) 160
A2 23 (2.06%) 40 (3.59%) 1051 (94.34%) 1114
A3 4 (0.15%) 23 (0.88%) 2594 (98.97%) 2621
Training 
(hit rate =  
68. 74%) Total 55 (1.41%) 85 (2.18%) 3755 (96.41%) 3895
A1 15 (22.73%) 14 (21.21%) 37 (56.06%) 66
A2 8 (1.67%) 17 (3.55%) 454 (94.78%) 479
A3 1 (0.09%) 12 (1.07%) 1110 (98.84%) 1123
Validation 
(hit rate =  
68.37%) Total 24 (1.44%) 43 (2.58%) 1601 (95.98%) 1668
Note: The percentages are given in the parentheses. 
 
2.6 The proposed two-stage model 
 
This paper proposes a two-stage analytical framework to identify the critical risk conditions 
contributing to crash severity. The first stage develops a genetic mining rule (GMR) model to 
identify possible risk conditions best elucidating the degree of severity. The second stage then uses 
 18
validation, respectively. Our proposed GMR model has demonstrated superior to the conventional 
decision tree (DT), rough set (RS) and ordered Probit (OP) models, which can only achieve an 
overall correct rate of 70.24% in training and 69.54% in validation, respectively, with the same 
database. According to the mined rules, x13 (driver occupation), x16 (location), x15 (travel period), 
and x17 (vehicle type) are the four key factors contributing to crash severity. In addition, this study 
also identified the joint effects of risk conditions on crash severity by developing a novel two-stage 
model (GMR+OP) model by introducing these 38 mined rules (i.e. risk conditions) into an OP 
model as dummy explanatory variables, it is found that the proposed two-stage OP model is 
superior to one-stage OP model in terms of likelihood ratio. Based on the results, six most critical 
risk conditions have been identified, which can serve as useful guides to ameliorate the traffic 
safety. 
 
Some directions for future studies can be identified. First, the neighboring traffic condition of the 
crash is also an important factor to crash severity; however, the police accident investigation report 
did not record such information. The crash data may be further matched with the traffic database so 
as to gain more information regarding the contributing factors to crash severity. Second, in order to 
lessen the model complexity, various performance indices may be integrated into an overall fitness 
function; namely, a multi-objective GMR model deserves further elaboration. Other information 
such as the neighboring traffic condition of the crash can also be an important factor to crash 
severity. Future study can combine such information so as to gain deeper insights into the risk 
conditions to crash severity. Last but not least, analysis of two-vehicle or multi-vehicle crash data is 
worthy of further study. Finally, risk conditions containing fewer (only two or three) original 
explanatory variables would be much easier to elucidate the relationship between explanatory 
variables and crash severity, thus deserves further attempt. 
 20
3. 請依學術成就、技術創新、社會影響等方面，評估研究成果之學術或應用價值（簡要敘述
成果所代表之意義、價值、影響或進一步發展之可能性）（以 500 字為限） 
 
本計畫為三年期計畫，具體完成之研究成果如下：  
 
1.建立基因規劃探勘模式 
 
本計畫乃於第一年期提出基因規則探勘模式（Genetic rule mining, GRM），可由探勘所得
之規則的前半部，判斷何謂危險情況，進而加以避免。惟本研究所提出之 GRM 必須先固定
規則數量，再同時進行最佳規則組合之尋優。因此，具有染色體長度過長，尋優效果不佳，
以及探勘過多衝突或重覆規則的傾向，進而導致規則難以詮釋，無法提出具體之安全改善策
略。 
 
2.提出改良式逐步基因規劃探勘模式 
 
本計畫第二年期乃提出改良式的基因規則探勘模式（Genetic rule mining, GRM），稱為逐
步基因規則探勘模式（Stepwise GRM, SGRM）。SGRM 一次僅挑選使事故嚴重度預測率精確
率最高的一條規則，再以此規則為基礎，進行下一條規則之選取，直到精確率無法再改善為
止。如此，即可避免選擇規則過多，且相互重覆或矛盾的問題。此外，由於不同類型事故之
影響因素與危險情況不一定相同，因此，有必要加以區隔分析。本年度以先以總計 5563 件單
車事故（single vehicle accident）為分析基礎。結果顯示，本模式共選擇了 38 條規則，其訓練
準確度達 75.1%，而驗證準確度則達 73.8%均遠高於決策樹之預測結果。而影響事故嚴重度之
危險情境也加以確認，並研提改善策略。 
 
3.進行模式比較與分析 
 
本計畫第三年期進一步探討及比較本研究所提出之 SGRM、決策樹（decision tree, DT）、
粗略集合（rough set, RS）及次序普羅比（ordered probit model, OP）等四種模式在分析不同事
故嚴重度之選擇規則與重要解釋變數。結果顯示，本研究所提出之 SGMR 模式不僅可達到最
佳之預測準確度外，也可篩選出少數關鍵推理規則及危險情境，俾利安全改善策略之研提。
 
4.提出兩階段整合模式 
 
本研究進一步將 SGRM 所挑選出的 38 條推理規則的前半部設定為危險情境（risk 
condition），以虛擬變數表之，後半部則為事故嚴重度，結合次序普羅比進行危險情境之推估
與檢定，以了解各種危險情境對事故嚴重度之影響程度。結果顯示，本研究所提出之整合方
法（SGMR＋OP）其模式配適度，遠比將所有原始變數作為解釋變數所建構之 OP 模式為高，
更可有效辨識、檢定及推估各種危險情境，有效克服以往統計迴歸方法僅能探討單一變數對
事故嚴重度的缺點，更符合事故嚴重度係由多個肇因所導致之先驗知識。 
 
 22
rural freeways, Accident Analysis and Prevention 28, 391-401.  
24. Shin, K.S. and Lee, Y.J., 2002. A genetic algorithm application in bankruptcy prediction 
modeling. Expert Systems with Applications 23, 321-328. 
25. Sze, N.N. and Wong, S.C., 2007. Diagnostic analysis of the logistic model for pedestrian injury 
severity in traffic crashes. Accident Analysis and Prevention 39, 1267-1278. 
26. Tay, R. and Rifaat, S.M., 2007. Factors contributing to the severity of intersection crashes. 
Journal of Advanced Transportation 41, 245-265. 
27. Wong, S.C., Sze, N.N. and Li, Y.C., 2007. Contributory factors to traffic crashes at signalized 
intersections in Hong Kong, Accident Analysis and Prevention 39, 1107-1113.  
28. Chiou, Y.C., Lan, W.L. and Chen, W.B. (2009) “Contributory factors to crash severity in 
Taiwan freeways: Genetic mining rule approach,” presented at the 8th International 
Conference of Eastern Asia Society for Transportation Studies, Surabaya, Indonesia, Nov. 
16-18. 
29. Chiou, Y.C., Lan, W.L. and Chen, W.B. (2010) “Contributory factors to crash severity in 
Taiwan freeways: Genetic mining rule approach,” Journal of Eastern Asia Society for 
Transportation Studies, Vol.8, pp.1837-1849. 
30. Chiou, Y.C., Lan, W.L. and Chen, W.B. (2010) “Identification of risky conditions contributing 
to crash severity with genetic mining rules,” presented at the 15th Conference of Hong Kong 
Society for Transportation Studies, Hong Kong, China, Dec. 11-14. 
31. Chiou, Y.C., Hwang, C.C. Chang, C.C. and Fu, C. (2011) “A bivariate generalized ordered 
probit approach for two-party crash severity modeling,” presented at the 3rd International 
Conference on Road Safety and Simulation, September 14-16, 2011, Indianapolis, USA. 
(Invited submission to Accident Analysis and Prevention) 
32. Chiou, Y.C., Lan, W.L. and Chen, W.B. (2011) “Exploring key discriminative and risk factors 
affecting one-vehicle crash severities in Taiwan freeways,” presented at the 9th International 
Conference of Eastern Asia Society for Transportation Studies, Jeju, Korea, June 20-23. 
33. Chiou, Y.C., Lan, W.L. and Chen, W.B. (2011) “Identification and estimation the risky 
conditions of crash severity: An integrated genetic rule mining and ordered probit model,” 
submitted to Accident Analysis and Prevention. 
34. Chiou, Y.C., Hwang, C.C. Chang, C.C. and Fu, C. (2011) “A bivariate generalized ordered 
probit approach for two-party crash severity modeling,” Invited submission to Accident 
Analysis and Prevention (Special Issue of RSS2011) 
35. 陳文斌，Identifying risk conditions to crash severity by a two-stage model combining genetic 
rule mining and ordered Probit，交通大學交通運輸研究所，博士論文（進行中），民國100
年。 
表 Y04                                         第 2 頁
 
Transportation System、Transportation and the Environment、Road Pricing, Financial and 
Economic Appraisal、Traffic Survey and Forecasting、Public Transportation、Logistics and 
Supply Chain Management、 Transit Planning and Operation、Traffic Flow Theory and Traffic 
Control。 
本次會議本人共發表四篇文章，並邀請四位共同作者（本人指導的四位博士生：黃
彥斐、曾群明、陳文斌及閰姿慧）共同與會，並進行簡報，以培養本所博士班進行國際
學術交流之能力與經驗。分別排在 13 日上午 C2 及 C3 場次，以及下午 E2 及 E4 場次。
四位博士生無論在簡報技巧及回答問題上，均表現相當良好，也透過此次機會學習更多
國際學術交流經驗。 
此外，本人亦獲邀主持 C2 場次（Demand modeling），本場次共有四篇論文發表。
會議中之討論非常熱烈外，並於會後與多位教授交換心得與意見。 
 
二、與會心得 
 
HKSTS 係香港運輸研究領域的一大盛會，而香港幾位運輸領域學者，如 William 
Lam, Hai Yang, Hong Lo, S.C. Wong, Janny M.Y. Leung 等教授在學術研究領域上都具有
相當的水準，每位發表之 SCI 文章均幾達數拾篇，甚至上百篇，也同時擔任幾種國際期
刊的主編或審查委員。而每次大會邀請之學者也皆在學術領域上具有相當份量。藉由本
次參與會議機會，除能掌握國際學者在運輸領域之研究方向與現況外，更重要的是能與
各國各領域的專家學者建立日後合作研究之機制。 
 
本次會議除本人參加外，國內學者尚有中華技術學院藍武王講座教授、交通大學任
維廉教授、逢甲大學溫傑華教授，以及東吳大學胡凱傑教授參加，未有其他教授學者出
席。香港距臺灣甚近，參加會議較具彈性，而香港在學術研究上頗具國際性，在兩岸學
術交流上也具有關鍵角色，實應鼓勵國內學者多參加此類會議。 
 
此外，HKSTS 也編輯出版一本名為「Transportmetrica: Advanced Methods for 
Transportation」的國際期刊，也獲 SSCI 及 SCI 資料庫收錄，其 Impact factor 在 2008 年
運輸領域排名第一，2009 年亦排名第二。本人於第 9 屆所發表論文，會後也獲該會主編
邀請投稿該期刊，經改寫投稿，並經審查後獲選刊登。而本次發表文章，也正改寫準備
投稿國際期刊。 
 
三、考察參觀活動 
 
本次研討會主辦單位特邀請專題演講教授、各場次主持人參與 12 日（星期日）之
考察行程，人數總計約 28 人。該行程除參觀香港幾項重大交通建設外，也參觀若干觀
光景點。由於國內對於香港相關交通建設資訊之蒐集並不困難，所以大部份交通政策或
建設均早已了解。但本次活動提供各學者更長時間、更近距離的交流與接觸，實為一重
要機會。 
 
四、建議 
 
1.HKSTS 國際會議每年舉辦一次，至今雖僅舉辦十五屆，但各屆會議之規模相較於國內
運輸學會雖小，但發表之學術論文均具國際水準，會議規模與參會人數亦逐年增加，
且多位國際知名運輸領域教授與會（例如，美國 Berkeley 大學土木系的車流理論大師：
A.D. May 及電機系交控大師：P. Varaiya）。因此，建議國內相關領域學者應積極出國
表 Y04                                         第 4 頁
GENETIC FUZZY LOGIC TRAFFIC SIGNAL CONTROL WITH A 
STEPWISE LEARNING ALGORITHM 
 
YU-CHIUN CHIOU a and YEN-FEI HUANG b 
 
a Institute of Traffic and Transportation, 
National Chiao Tung University, Taiwan 
Email: ycchiou@mail.nctu.edu.tw. 
b Institute of Traffic and Transportation, National Chiao Tung University, Taiwan 
 
ABSTRACT 
 
This paper develops an adaptive traffic signal control model based on a stepwise genetic fuzzy logic 
controller (SGFLC). The proposed model considers traffic flow and queue length as state variables and 
extension of green time as control variable, towards the minimization of total vehicle delays. For the learning 
efficiency of SGFLC and the capability in capturing traffic behaviors, cell transmission model (CTM) is used 
to replicate traffic behaviors. To investigate the performance of the proposed model at an isolated 
intersection, comparisons to three pre-timed and two adaptive signal timing models are also conducted. 
Results show that in both cases, our proposed SGFLC model almost achieved the optimal control. As traffic 
flows vary more noticeably, the SGFLC model performs even better. In the case of sequential intersections 
with four coordinated signal systems: simultaneous, progressive, alternate and independent, the results also 
show that the proposed SGFLC model can also perform best, suggesting that the proposed SGFLC signal 
control model is effective, robust and applicable. 
Keywords: Genetic fuzzy logic controller, Stepwise learning algorithm, Signal control. 
 
 
1. INTRODUCTION 
 
On-line traffic signal control typically feeds the real-time traffic data, collected by the sensors, into a build-in 
controller to produce the timing plans. Thus, it can provide signal-timing plans in response to real-time 
traffic conditions. Actuated signal control, dynamic signal control, and adaptive signal control are examples 
of on-line control. Because of its flexibility, applicability and optimality, adaptive signal control tends to be 
the mainstream of signal controls nowadays. The well-known adaptive signal controllers, such as SCOOT, 
SCATS, and OPAC, employ mathematical equations or models to determine “crisp” threshold values as the 
cores of control mechanism; thus, the control performance could be negatively affected by the uncertainty of 
traffic conditions. Since a fuzzy control system has excellent performance in data mapping as well as in 
treating ambiguous or vague judgment (Teodorovic, 1999), many recent works have employed fuzzy set 
theory to develop fuzzy logic controllers (FLC), also known as fuzzy control system, fuzzy inference system, 
approximate reasoning, or expert system. The applications of FLC to signal control are to determine the 
signal phasing and timing plans, including priority of phases, cycle length and split (e.g. Pappis and 
Mamdani, 1977; Favilla et al.,1993; Kim, 1997; Mohamed et al., 1999; Niittymäki et al., 2001; Chou and 
Teng, 2002; Hoyer and Jumar, 1994; Murant and Gedizlioglu, 2005), by utilizing the real-time traffic data, 
such as vehicle arrival or arrival rate, occupancy, queue length and speed, collected by detectors. 
 
In previous FLC signal control systems, both inference engine and defuzzification have been consistently 
used; however, methods for formulating the rule base (logic rules) and data base (membership functions) are 
subjectively preset, not optimally solved. Thus, the performance of the models can not be assured. Genetic 
algorithms (GAs) have been proven suitable for solving both combinatory optimization problem (e.g., 
selecting the logic rules) and parameter optimization problem (e.g., tuning the membership functions). 
Employing GAs to construct an FLC system with learning process from examples, hereafter termed as 
genetic fuzzy logic controller (GFLC), can not only avoid the bias caused by subjective settings of logic 
rules or membership functions but also greatly enhance the control performance. 
 
Use of GAs to simultaneously learn logic rules and membership functions requires a very long chromosome 
and seriously deteriorates the searching efficiency and effectiveness. Therefore, Chiou and Lan (2005) 
proposed an iterative evolution algorithm to sequentially learn of logic rules and membership functions. 
表 Y04                                         第 6 頁
TVD
f 1=                 (1) 
 
2.2 Cell transmission model (CTM) 
 
Previous works often employ traffic simulation software to evaluate the performance of signal control 
models. However, it would be too time-consuming to use simulation software for the evolution of genetic 
generations. To facilitate the learning process of the proposed model, an efficient traffic simulator is 
necessary to evaluate the performance of selected logic rules and tuned membership functions in a short 
period. Thus, a mesoscopic traffic simulator is considered. CTM, proposed by Daganzo (1994, 1995) for 
simulating traffic hydrodynamic behavior in a mesoscopic manner, uses several simple equations to govern 
traffic movements along the roadway which is represented by a series of equal-length cells. These equations 
are expressed as follows: 
)()()()1( 1 tytytntn iiii +−+=+             (2) 
)]}()([),(),(min{)( 1 tntNtqtnty iimiii −= − β           (3) 
⎪⎩
⎪⎨
⎧
≥
≤
=
−
−
)()( if ,
)()( if ,1
1
1
tqtn
v
w
tqtn
mii
miiβ              (4) 
where, ni(t) represents the number of vehicles in cell i at time t. yi(t) represents the number of vehicles 
flowing into cell i at time t. qmi (t) represents the maximum number of vehicles entering into cell i at time t. 
Ni(t) represents the maximum number of vehicles stored in cell i at time t. v and w are the free-flow and 
shockwave speeds, respectively. The q-k fundamental diagram can be depicted as Figure 2. 
 
Figure 2. q-k diagrams obtained from the CTM 
 
For the cases of isolated and sequential intersections, TF is the average traffic flows at all green-phase 
approaches. While QL is the summation of queen length at all red-phase approaches. Vehicle delay at each 
time click can be calculated by multiplying queue length (QL) at all red-phase approaches with the time tick. 
The total vehicle delay (TVD) is then calculated by summing up the vehicle delay within whole evaluation 
horizon. To simplify the analysis, turning traffic is not considered. 
 
 
3. ISOLATED INTERSECTION 
 
To investigate the applicability and performance of the proposed signal control model, comparisons to other 
signal control models, including three pre-timed plans and two adaptive timing plans, are conducted in an 
experimental case. 
 
3.1 Model training 
 
To validate the effectiveness and robustness of the proposed SGFLC signal control model, an experimental 
example for an isolated four-leg intersection (Figure 3) is demonstrated. The parameters of the CTM model 
are set as: free-flow speed=50km/h, time step=2 seconds, kj=120 veh/km/lane. Assume that the intersection 
表 Y04                                         第 8 頁
(a) Learning process 
 
0.0
0.2
0.4
0.6
0.8
1.0
0 100 200
TF (pcu / 5 min.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 10 20 30
QL (pcu)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 2 4 6 8 10 12 14
EGT (sec.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 100 200
TF (pcu / 5 min.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 10 20 30
QL (pcu)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 2 4 6 8 10 12 14
EGT (sec.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 100 200
TF (pcu / 5 min.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 10 20 30
QL (pcu)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 2 4 6 8 10 12 14
EGT (sec.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 100 200
TF (pcu / 5 min.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 10 20 30
QL (pcu)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 2 4 6 8 10 12 14
EGT (sec.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 100 200
TF (pcu / 5 min.)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 10 20 30
QL (pcu)
μ
0.0
0.2
0.4
0.6
0.8
1.0
0 2 4 6 8 10 12 14
EGT (sec.)
μ
 
(b) Selected logic rules and tuned membership functions 
 
Figure 5. Learning process and results of the SGFLC model at the experimental intersection 
 
Table 1 summarizes the comparison results. The OM model with seven optimal timing settings is an optimal 
control model under the given traffic pattern as shown in Fig 4. However, only 0.76 vehicle-hours or 4.03% 
additional delays are incurred by the SGFLC model. In other words, the SGFLC model can almost achieve 
the optimal control. In addition, the SGFLC model performs better than another other signal timing plans. 
The results demonstrate the effectiveness of our proposed SGFLC model. 
 
Table 1. Comparison of control performance at the experimental isolated intersection 
ΔTVD compared with GFLC Timing plan TVD (vehicle-hours) (vehicle-hours) (%) 
SGFLC 18.84 - -
OS 24.15 5.31 28.18
OM 18.08 -0.76 -4.03
SS 26.07 7.23 38.38
SM 22.33 3.49 18.52
VQ 25.30 6.46 34.29
MQ 24.57 5.73 30.41
 
To further examine the robustness of the SGFLC model, we randomly vary the traffic flows by 10% to 50% 
as shown in Figure 6. Assume that timing plans of four pre-timed models remain unchanged and the adaptive 
models control signal followed the same rules learned from the original traffic patterns given in Figure 4. 
The results are summarized in Table 2. Note that the SGFLC model performs best among the pre-timed and 
adaptive models. Moreover, the SGFLC model can do much better than any other timing plans as the traffic 
flows vary more conspicuously, indicating the robustness of the SGFLC model. 
 
表 Y04                                         第 10 頁
4.2 Model performance 
 
To validate the effectiveness, the control performance of the SGFLC model is compared with the OM model 
with seven sub-periods. The control performances of these eight signal control models are reported and 
compared in Table 5. Obviously, the performances under progressive coordinated system are significantly 
superior to other systems. The progressive SGFLC model performs best among these four models, follows 
by the progressive OM model. The signal control models under alternate coordinated system perform 
relatively poor. Also notice that all the SGFLC models under various coordinated systems perform better 
than the OM model. The results show the effectiveness of the proposed SGFLC model in controlling the 
sequential intersections. 
 
Table 3. Comparison of control performance at the experimental sequential intersections 
TVD (vehicle-hours) Signal coordinated system
SGFLC OM 
Rate of ΔTVD reduced 
by SGFLC 
Simultaneous 74.00 84.56 14.27%
Progressive 62.36 73.01 17.08%
Alternate 94.12 103.58 10.05%
Independent 81.54 91.08 11.70%
 
 
5. CONCLUDING REMARKS 
 
This paper develops a SGFLC model for signal control at both isolated and sequential intersections. We 
choose traffic flow and queue length as state variables, extension of green time as the control variable, and 
total vehicle delays as performance measurement. In order to evaluate control performance accurately, the 
CTM is used to replicate traffic behaviors. For the case of isolated intersection, the case study has shown that 
the control performance of the SGFLC model is almost the same as the optimal multiple timing plan and far 
superior to the other pre-timed and adaptive models. In the case of sequential intersections, the results have 
also shown that SGFLC performs better than the OM model, no matter which coordinated signal system is 
operated. These results demonstrate that the proposed SGFLC model is effective, robust and applicable to 
real-time signal control. 
 
A stepwise algorithm is adopted in this study to learn the rules. However, an early obtained rule may not be 
one of rules in the optimal rule combination. More effective and efficient encoding methods in selecting the 
logic rules or tuning the membership functions or both deserve to be explored. In addition, for sequential 
intersections, the control performance is measured by TVD in this paper. Other performance indices, such as 
maximum green band, minimum stopping rate, and maximum throughput, deserve to be adopted and 
examined. Moreover, in this study, only simple two phase signal control plan is considered. Multi-phase 
signal control plans with consideration of turning flows at intersections deserves to be developed. Last but 
not least, the mixed-traffic condition including motorcycles, cars, trucks and buses, should be considered in 
signal control model. 
 
ACKNOWLEDGEMENTS 
 
This study was partially sponsored by Taiwan’s National Science Council under contract number NSC 
96-2628-E-009-171-MY3. 
 
REFERENCES 
 
Chou, C.H. and Teng, J.C. (2002) A fuzzy logic controller for traffic junction signals. Information Sciences 
143, 73-79. 
Chiou, Y.C. and Lan, L.W. (2005) Genetic fuzzy logic controller: an iterative evolution algorithm with new 
encoding method. Fuzzy Sets and Systems 152, 617-635. 
Daganzo, C. (1994) The cell transmission model: A dynamic representation of highway traffic consistent 
with the hydrodynamic theory. Transportation Research Part B 28, 269-287. 
Daganzo, C. (1995) The cell transmission model, part II: network traffic. Transportation Research Part B 29, 
表 Y04                                         第 12 頁
ESTIMATION OF FREEWAY DYNAMIC ORIGIN-DESTINATION MATRICES: A NOVEL 
APPROACH 
YU-CHIUN CHIOU a, LAWRENCE W. LAN b and CHUN-MING TSENG c 
 
a Institute of Traffic and Transportation, 
National Chiao Tung University, Taiwan 
Email: ycchiou@mail.nctu.edu.tw 
b Department of Marketing and Logistics Management, Ta Hwa Institute of Technology; Institute of Traffic 
and Transportation, National Chiao Tung University, Taiwan 
 c Institute of Traffic and Transportation, National Chiao Tung University, Taiwan 
 
ABSTRACT 
 
This paper proposes a novel approach to estimate medium-to-long term freeway dynamic origin-destination 
(O-D) matrices. The proposed approach includes a two-stage prediction model with an integrated algorithm. 
The two-stage prediction model uses K-means algorithm to extract clusters of traffic patterns and then 
employs genetic programming to predict the traffic in each cluster. The integrated algorithm combines cell 
transmission model with extended Kalman filtering to estimate the arrival distributions and the O-D 
proportions. To demonstrate the applicability of the proposed approach, a field study of on-ramp traffic 
patterns on a freeway is examined. The results show that the proposed approach can accurately predict the 
traffic and satisfactorily estimate the O-D proportions along a freeway. 
Keywords: Dynamic origin-destination, Cell transmission model, Extended Kalman filtering, Genetic 
programming 
 
 
1. INTRODUCTION 
 
Accurate dynamic origin-destination (O-D) information is essential for implementing real-time traffic control 
applications, such as route guidance and ramp metering. Over the past two decades, some researchers have 
devoted to develop the estimation algorithms for the dynamic O-D matrices based on observable mainline 
and ramp flow rates (e.g. Chang and Wu, 1994; Chang and Tao, 1996, 1999; Lin and Chang, 2005, 2007); 
while some others have introduced additional assumptions or exogenous information, such as route choice 
behaviors, prior O-D matrix information, and sequence of observational periods of traffic counts data, while 
estimating the dynamic O-D matrices (e.g. Bell, 1983, 1991; Yang et al., 1992, 1995; Lo et al., 1996; 
Hazelton, 2001). Yet estimation of dynamic O-D matrices still remains challenging in that the number of 
estimated parameters is far greater than the available information. To tackle this challenge, Chang and Wu 
(1994) subjectively assumed that the vehicles entering a freeway in a specific time interval are distributed 
within a small range (i.e., two time intervals). This assumption certainly limits the applicability and accuracy 
of the algorithms. Some previous studies (e.g. Chang and Wu, 1994; Chang and Tao, 1996; Lin and Chang, 
2005, 2007) also made subjective assumptions on traffic arrival distributions, which are not valid for various 
traffic conditions from free-flow to gridlock. 
 
In view of the importance of arrival distribution prediction in estimating the O-D matrices and the essence of 
estimation efficiency for real-time applications, more recently, Chiou et al. (2010) have proposed an 
integrated algorithm which combined cell transmission model (CTM) with extended Kalman filtering (EKF) 
to respectively and iteratively estimate the arrival distributions and O-D proportions. Firstly introduced by 
Daganzo (1994), the CTM can efficiently simulate traffic hydrodynamics under various traffic conditions. 
However, the arrival distribution estimations using CTM are based on an unrealistic assumption that the 
on-ramp traffic along a freeway remains unchanged over time. To rectify this unrealistic assumption, a 
medium-to-long term (e.g. next two to four hours) prediction model of on-ramp traffic along a freeway is 
required. 
 
Most of the existing traffic prediction models use statistical methods or artificial intelligent methods to 
conduct a short-term prediction (e.g. next 5 minutes). Such short-term prediction models may experience low 
performance for medium-to-long term traffic prediction since traffic patterns can change dramatically (e.g., 
from peak hours to off-peak and vice versa). According to field observation, daily traffic patterns do repeat 
表 Y04                                         第 14 頁
Table 1. Definition of variables and parameters 
Variables/ 
Parameters 
Definition 
)(kqi  The number of vehicles entering freeway from on-ramp i during time interval k, i = 1, 
2,. . . , N–1. 
)(ky j  The number of vehicles leaving freeway from off-ramp j during time interval k, j = 1, 
2,. . . , N–1. 
)(kUl  The number of vehicles crossing the upstream boundary of segment i during time interval 
k, l = 1,2,. . . , N–1. 
)(kbij  
The proportion of qi(k) heading toward destination node j during time interval k. 
)(km
ij
ρ  The fraction of Tij(k-m) vehicles depart from entry node i during time interval k and take m 
time intervals to exit node j. 
 
 
3. THE PROPOSED APPROACH 
 
3.1 The Framework 
 
Figure 2 presents the detailed framework of the proposed approach. Throughout the prediction process, 
K-means algorithm is used to cluster traffic patterns and genetic programming (GP) is used to predict traffic 
information. Moreover, CTM is used to simulate the arrival patterns and EKF is used to estimate the O-D 
proportions. 
 
 
)1( +kmijρ
)(kqi )(ky j)(kUl
)(kbij)1( +kmijρ
 
Figure 2. Framework of the proposed approach 
 
3.2 Two-stage Traffic Prediction Model 
 
3.2.1 Traffic patterns clustering 
 
According to field observations, daily traffic patterns do repeat spatially and temporally over and over, if a 
sufficient length of period has been observed. Clustering is a process in which a group of unlabeled patterns 
are partitioned into a number of sets so that similar patterns are assigned to one cluster and dissimilar ones 
are assigned to different clusters. This study uses a two-stage clustering process to find the optimal number 
of clusters, and then uses K-means to assign these traffic periods into several clusters so that the traffic 
periods in each cluster will exhibit the similar pattern. The traffic patterns clustering algorithm is composed 
of the following steps: 
Step 1: Find the optimal number of clusters with two-step clustering. 
表 Y04                                         第 16 頁
 
Figure 3. Fundamental diagram of CTM 
 
The number of vehicles flowing into cell i within the time interval t, ci(t), can be defined as: 
ci(t) = min{ni-1(t) , Qi , v
w
[Ni(t) – ni(t)]}                          (8) 
If the remained storage capacity and flow capacity in the next cell is sufficient, all vehicles will move 
forward into the next cell; otherwise, only a portion of them can move into the next cell proportionally 
according to the following logics: 
 
  [ ]
)1()1()1(
)1(,min)1()1(
1 +++=+
+−≤+++
+ trtctcthen
tnNQtqtcif
iii
iiii
                          
(9) 
 [ ]
[ ]
⎥⎦
⎤⎢⎣
⎡ +++
+−−=+
+−>+++
+ )1()1(
)1(,min1)1(
)1(,min)1()1(
1 trtc
tnNQtcthen
tnNQtrtcif
ii
ii
i
iiii
         (10) 
 
3.4 Extended Kalman Filtering 
 
The proposed estimation algorithm, based on the extended Kalman filtering concept, is as follows: 
1. Initialization 
Parameter settings, include cell length Li, time interval t0, [ ])(var ke , X(0), and P(0). 
2. Recursive processing 
Step 1: Call )(kmijρ  which is predicted by CTM. 
Step 2: Compute the Hk and Z’(k) matrix based on the determined )(kmijρ . 
Step 3: Initialization of the sequential Kalman filtering method. 
Step 4: Sequential Kalman filtering iterations. 
Step 5: Stop condition test. 
Check the convergence of the estimated O-D proportions. If the preset stop conditions 
(convergence level or number of iterations) satisfy, go to Step 1. Otherwise, go to Step 6. 
Step 6: Prediction of the states. 
Set 12 −= Nk pp and [ ] [ ]12)( −= Nbkb , k = k + 1, go to Step 1. 
 
 
4. CASE STUDY 
 
In this empirical case study, an entire week (from May 25 to May 31, 2009) of 5-minute traffic counts are 
extracted from the loop detectors over the 120-km stretch of Taiwan Freeway No. 1 between Toufen 
Interchange and Beidou Interchange, within which 15 on-ramp interchanges exist. The mainline of this 
stretch has three lanes. 
 
4.1 Traffic Flow Prediction 
 
表 Y04                                         第 18 頁
significantly. Under heavily synchronized flow condition, the entering traffic has increased over the 
remained storage capacity, flow capacity of the next cell is not sufficient; thus, only a portion of them can 
move forward proportionally. Under congested flow, the arrival times of traffic dispersion can be as long as 
six to eight time intervals. 
 
4.3 O-D Estimation 
 
To investigate the effects of initial value settings of O-D proportions on the performance of the proposed 
approach, two initial value settings are attempted: one by randomly generated (RG) technique and the other 
by equal share (ES) technique. Taking origin interchange No. 12 as an example, the associated O-D 
proportions are denoted as b12,13(k), b12,14(k), and b12,15(k). With RG technique, three random numbers 0.2, 0.9, 
and 0.5 are generated and then normalized such that the sum of three proportions equals 1; namely, b12,13 
(k)=0.125, b12,14 (k)=0.563, and b12,15 (k)=0.312. In contrast, with ES technique, the three proportions are 
simply set as b12,13 (k)=0.333, b12,14 (k)=0.333, and b12,15 (k)=0.333. 
 
The distributions of real b12,15 proportions (from Zhanghua Interchange to Yuanlin Interchange) along with 
the estimated O-D proportions by both RG and ES techniques are demonstrated in Figure 5. Note that the 
proposed approach can predict real O-D proportions quite accurately for these two initial value setting 
techniques. However, RG technique is slightly superior to the ES technique in terms of the prediction 
accuracy. Thus, the RG technique is adopted for predicting the remained O-D proportions. 
0
0.1
0.2
0.3
0.4
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29
Time interval(30sec)
Pr
op
or
tio
ns
Real
Predicted by RG
Predicted by ES
 
Figure 5. Comparison of real b12,15 proportions with predicted values by RG and ES techniques 
 
Figure 6 displays the process of convergence for the time interval k=986, b1,15 , Toufen Interchange to Beidou 
Interchange. The results show that the overall RMSE is 0.1043, indicating a rather good fitness of the 
proposed approach. 
k=986, b1,15  Toufen  to Beidou
0.052
0.056
0.06
0.064
0.068
501 521 541 561 581 601 621 641 661
Iteration
Ratio
 
Figure 6. The process of convergence 
5. CONCLUDING REMARKS 
 
This paper proposes a novel approach to predict a medium-to-long term traffic, based on a self-structured 
pattern (K-mean clustering) and genetic programming (GP), in conjunction with an integrated estimation 
algorithm which combined cell transmission model (CTM) and extended Kalman filtering (EKF) to 
respectively and iteratively estimate the arrival distributions and the O-D proportions. The case study on 
Taiwan’s freeway has shown that the proposed approach can accurately predict the traffic and estimate the 
O-D proportions with rather low RMSE, indicating its practical applicability. 
表 Y04                                         第 20 頁
IDENTIFYING RISK CONDITIONS TO CRASH SEVERITY:  
GENETIC MINING RULE APPROACH 
 
Yu-Chiun CHIOU a, Lawrence W. LAN b and Wen-Pin CHEN c 
 
a Institute of Traffic and Transportation, National Chiao Tung University, Taiwan 
Email: ycchiou@mail.nctu.edu.tw 
b Department of Marketing and Logistics Management, Ta Hwa Institute of Technology; Institute of Traffic 
and Transportation, National Chiao Tung University, Taiwan 
 c Institute of Traffic and Transportation, National Chiao Tung University, Taiwan 
ABSTRACT 
This paper proposes a two-stage analytical framework to identify the critical risk conditions contributing to 
crash severity. The first stage develops a genetic mining rule (GMR) model to identify possible risk 
conditions best elucidating the degree of severity. The second stage then uses the mined risk conditions as 
dummy explanatory variables to formulate an ordered Probit model. The proposed two-stage analytical 
framework is applied to analyze the Taiwan’s empirical one-vehicle crash data. A total of 38 rules are mined, 
which can achieve overall prediction rates of 75.10% in training and 73.80% in validation. Based on the 
results, six most critical risk conditions are identified and the corresponding countermeasures are addressed. 
 
KEYWORDS: Crash severity, genetic mining rule, ordered Probit model. 
 
1.  INTRODUCTION 
 
Crash severity analysis is an important issue in traffic safety study. A considerable number of relevant works 
developed various statistical methods to approach the crash analysis problems. Some researchers associated 
the crash severity with driver, vehicle and roadway factors by using ordered probit/logit model or logistic 
regression (e.g., Shanker and Mannering, 1996; Al-Ghamdi, 2002; Tay and Rifaat, 2007; Sze and Wong, 
2007; Milton, et al., 2008; Pai and Saleh, 2008). Among them, O’Donnell and Connor (1996) and Pai and 
Saleh (2007a, 2007b) proposed ordered-discrete choice models to elucidate the injury severities. There 
exhibit some limitations to develop parametric statistical models to analyze the crash data because most of 
crash data are categorical. Therefore, a number of distribution-free methods, such as decision tree (Chang 
and Chen, 2005; Chang and Wang, 2006), artificial neural network (Chiou, 2006; Delen et al., 2006), and 
genetic mining rule (GMR) (e.g. Freitas, 1999; Shin and Lee, 2002; Ghosh and Nath, 2004; Dehuri and Mall, 
2006; Chen and Hsu, 2006) were also attempted to deal with the classification and prediction of crash 
problems. The statistical methods, in general, only provide calibrated parameters used to examine the effects 
of the corresponding variables on crash severity. The interrelationship among explanatory factors cannot be 
examined in detail. The artificial neural network methods are in essence a black box. The prediction error of 
decision tree is also usually high. 
 
According to “error chain theory,” a crash is often caused by a series of errors, not solely by a single factor. 
Based on this, the present study proposes a two-stage analytical framework to identify the critical risk 
conditions contributing to crash severity. The first stage develops a genetic mining rule (GMR) model to 
identify possible risk conditions which can best explain the degree of severity. The second stage then 
develops an ordered Probit model with minded risk conditions as dummy explanatory variables. The rest of 
this paper is organized as follows. Section 2 presents the crash data with definitions of potential contributing 
factors. The GMR model is narrated in Section 3. Section 4 contains an in-depth investigation on the mined 
rules. The ordered Probit model is developed in section 5. Section 6 presents the estimation results, followed 
by the concluding remarks and suggestions for future studies. 
 
表 Y04                                         第 22 頁
Weather x4 Categorical 1, sunny; 2, cloudy; 3, rain, storm, fog, etc. 
Obstacle x5 Categorical 1, none; 2, work zone; 3, others 
Lighting condition x6 Categorical 1, daytime; 2, dawn or dusk; 3, nighttime with illumination; 4, nighttime 
without illumination 
Speed limit x7 Categorical 
(discretized) 
1, 110 KPH; 2, 100KPH; 3, 90-70KPH; 4, 60-40KPH 
Road status x8 Categorical 1, straight road; 2, grade and curved road; 3, tunnel, bridge, culvert,  
overpass; 4, others 
Marking x9 Categorical 1, lane line with marker; 2, lane line without marker; 3, no lane-changing line; 
4, no lane line 
Use of safety belt x10 Categorical 1, safety belt fastened; 2, safety belt not fastened; 3, others or unknown 
Use of cell phone x11 Categorical 1, use; 2, not in use; 3, others or unknown 
License x12 Categorical 1, with license; 2, without license; 3, unknown 
Driver occupation x13 Categorical 1, in job; 2, student; 3, jobless; 4, unknown 
Driver age x14 Categorical 
(discretized) 
1, under 30 years old; 2, 30-40 years old; 3, 40-50 years old; 4, 50-65 years 
old; 5, above 65 years old 
Travel period x15 Categorical 
(discretized) 
1, 07:01-09:00 morning peak; 2, 09:01-16:00 day off-peak; 3, 16:01-19:00 
afternoon peak; 4, 19:01-23:00 night-peak; 5, 23:01-07:00 midnight to 
morning 
Location x16 Categorical 1, fast lane, general lane; 2, shoulder, edge; 3, median; 4, accelerating or 
decelerating lane, ramp; 5, toll plaza and others 
Vehicle type x17 Categorical 1, passenger car; 2, truck; 3, bus; 4, heavy truck, trailer truck, tractor; 5, others
Action x18 Categorical 1, forward; 2, left lane-change; 3, right lane-change; 4, urgent deceleration or 
stop; 5, others 
Alcoholic use x19 Categorical 1, no; 2, under 0.25 mg/l (or 0.05%); 3, over 0.25 mg/l (or 0.05%); 4, cannot 
be tested; 5, unknown 
Journey purpose x20 Categorical 1, work trip or school trip; 2, business trip; 3, transportation activity; 4, 
visiting, shopping; 5, others or unknown 
Major cause x21 Categorical 1, improper lane-change; 2, speeding; 3, fail to keep a safe distance; 4, 
alcoholic use; 5, fail to pay attention to the front; 6, other driver’s liability; 7, 
factors not attributed to drivers 
Severity y Categorical 1, fatality; 2, injury; 3, no-injury 
 
3.2  Fitness Function 
 
An individual chromosome (a rule) with higher fitness function value will have a higher probability being 
selected to reproduce the offspring. The role of fitness function is to evaluate the quality of the rule 
numerically. Shin and Lee (2002) adopted hit ratio (confidence) as the fitness function which is also defined 
as predictive accuracy plus coverage in another study (Kim and Han, 2003). However, what should be 
emphasized is the performance of the entire rule set rather than the performance of the individual rules. In 
other words, good performance of individual rules does not guarantee that the combination of these rules also 
performs well. It normally results from the redundancy and conflict between rules. Hence, this paper sets the 
fitness function as an increase of correctly classified cases by the rule set, which combines the previous 
mined rules and the new rule. It can be expressed as follows: 
 fi =·Nnrs – Nprs  (1) 
where Nnrs is the number of cases that are correctly classified by the rule set combining the previous mined 
rules with rule i, and Nprs is the number of cases that are correctly classified by the previous mined rules. 
 
The previous mined rules are also called temporary rule set in this study. By means of fitness function, the 
effect caused by redundancy or conflict between rules would be effectively reduced during the rule mining 
process. When a new rule is extracted from the final population, it would certainly increase the performance 
of entire rule set because the new rule set has combined the new rule with the temporary rule set. 
 
Since the genes in our GMR model are not binary encoded, simple genetic algorithms proposed by Goldberg 
(1989) cannot be used. In turn, this study employs the max-min-arithmetical crossover proposed by Herrera 
et al. (1998) and the non-uniform mutation proposed by Michalewicz (1992). 
 
3.3 Rule Selection 
表 Y04                                         第 24 頁
 
Figure 1. The encoding and selection of rules 
 
Table 2. Combination of rules mined by the GMR model 
Rules x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15 x16 x17 x18 x19 x20 x21 y CRi PAi 
R1          2           2 1 11 0.727 
R2           3           1 106 0.613 
R3                   4   1 47 0.426 
R4 1            1        2 1 97 0.196 
R5   1 1  3        2  1      1 75 0.080 
R6             1   2  1 1   1 267 0.064 
R7 1     1 4  1     5     1   2 6 1.000 
R8   1 1   2   1   1 1 5   1   4 2 12 0.917 
R9    2         3         2 12 0.917 
R10   2    1     1    1  2    2 10 0.900 
R11 1  1            3 1   3   2 12 0.833 
R12    1         1  5 2 2     2 6 0.833 
R13 1    1   1  3 3    2       2 6 0.833 
R14                 5  3   2 12 0.833 
R15   1   3   3    1   1  1    2 11 0.818 
R16    1   2  1     4    1  5 7 2 16 0.813 
R17    1   1     2     1     2 16 0.813 
R18 1           2   2  2     2 10 0.800 
R19     1  3    1        2   2 15 0.800 
R20 1    1 4       1 3   2     2 22 0.773 
R21            1    2   2 5  2 12 0.750 
R22   2          1  2  2   5  2 12 0.750 
R23      3       3 1 5       2 11 0.727 
R24             4  5 1 2     2 25 0.720 
R25 1      3  1     2   2     2 14 0.714 
R26     1        3         2 154 0.435 
R27    1             2   1  2 77 0.429 
R28 1            1 3 5   1    2 91 0.374 
R29 1    1   1 1   1    1      2 1460 0.325 
R30      4   1    1         2 529 0.319 
R31       3     1 1   1      2 305 0.302 
R32               2   2    2 64 0.297 
R33 2              4  1     2 149 0.262 
R34      1 1   1 1 1 1   2  1 1   2 121 0.215 
R35      1 3      1       5  3 64 0.813 
R36   1 1            1 4  1   3 239 0.799 
R37          1            3 3800 0.687 
R38      4        1  1   1   3 201 0.687 
Note: CRi is coverage ratio and PAi is predictive accuracy. 
 
Most of the rules could be readily inspected and explained by the If-Then relationship of the rules themselves. 
For R7, for instance, the rule indicates that when speed limit is 40~60 KPH and driver’s age is over 65, it 
tends to lead to A2 crash. As for R1, when safety belt is not fastened and the driver is speeding, it tends to 
cause A1 crash. In contrast to R1, R37 suggests that when safety belt is fastened, the crash tends to be less 
severe (A3 crash). The rest may be deduced by analogy. 
 
 
表 Y04                                         第 26 頁
 
 
6.  CONCLUSIONS 
 
This paper identified the joint effects of risk conditions on crash severity by developing a novel genetic 
mining rule (GMR) model. Three different degrees of severity (A1, A2, and A3) of one-vehicle crash cases 
are analyzed. The data are drawn from 2003-2007 Taiwan’s Freeway Accidents Dataset. A total of 38 rules 
are mined which can achieve overall correct rates of 75.10% in training and 73.80% in validation. By 
introducing these 38 mined rules (i.e. risk conditions) into an ordered Probit (OP) model as dummy 
explanatory variables, it is found that the proposed two-stage OP model is superior to one-stage OP model in 
terms of likelihood ratio. Based on the results, six most critical risk conditions have been identified, which 
can serve as useful guides to ameliorate the traffic safety. 
 
Some directions for future studies can be identified. First, other information such as the neighboring traffic 
condition of the crash can also be an important factor to crash severity. Future study can combine such 
information so as to gain deeper insights into the risk conditions to crash severity. Second, analysis of 
two-vehicle or multi-vehicle crash data is worthy of further study. Finally, risk conditions containing fewer 
(only two or three) original explanatory variables would be much easier to elucidate the relationship between 
explanatory variables and crash severity, thus deserves further attempt. 
 
 
ACKNOWLEDGEMENTS 
 
This study was partially sponsored by Taiwan’s National Science Council under contract number NSC 
97-2628-E-009-035-MY3. 
 
 
REFERENCES 
 
Al-Ghamdi, A.S. (2002) Pedestrian-vehicle crashes and analytical techniques for stratified contingency 
tables. Accident Analysis and Prevention 34, 205-214. 
Chang, L.Y. and Chen, W.C. (2005) Data mining of tree-based models to analyze freeway accident frequency. 
Journal of Safety Research 36, 365-375. 
Chang, L.Y. and Wang, H.W. (2006) Analysis of traffic injury severity: An application of non-parametric 
classification tree techniques. Accident Analysis and Prevention 38, 1019-1027. 
Chen, T.C. and Hsu, T.C. (2006) A GAs-based approach for mining breast cancer pattern. Expert Systems 
with Applications 30, 674-681. 
Chiou, Y.C. (2006) An artificial neural network-based expert system for the accident appraisal of two-car 
crash accidents. Accident Analysis and Prevention 38, 777-785. 
Clarke, D.D., Forsyth, R.S. and Wright, R.L. (1998) Behavioural factors in accidents at road junctions: The 
use of a genetic algorithm to extract descriptive rules from police case files. Accident Analysis and 
Prevention 30, 223-234. 
Dehuri, S. and Mall, R. (2006) Prediction and comprehensible rule discovery using a multi-objective genetic 
algorithm. Knowledge-Based System 19, 413-421. 
Delen, D., Sharda, R. and Bessonov, M. (2006) Identifying significant predictors of injury severity in traffic 
accidents using series of artificial neural networks. Accident Analysis and Prevention 38, 434-444. 
Freitas, A.A. (1999) On rule interestingness measures. Knowledge-Based Systems 12, 309-315. 
Ghosh, A. and Nath, B., 2004. Multi-objective rule mining using genetic algorithms. Information Sciences 
163, 123-133. 
Goldberg, D.E. (1989) Genetic Algorithms in Search, Optimization, and Machine Learning. Addison-Wesley, 
New York. 
Herrera, F., Lozano, M. and Verdegay, J.L. (1998) A learning process for fuzzy control rules using genetic 
algorithms. Fuzzy Sets and Systems 100, 143-158. 
表 Y04                                         第 28 頁
ROUTE-BASED DATA ENVELOPMENT ANALYSIS MODEL  
 
Yu-Chiun CHIOU a, Lawrence W. LAN b and Barbara T.H. YEN c 
 
a Institute of Traffic and Transportation, National Chiao Tung University, Taiwan  
Email: ycchiou@mail.nctu.edu.tw 
b Department of Marketing and Logistics Management, Ta Hwa Institute of Technology; Institute of Traffic 
and Transportation, National Chiao Tung University, Taiwan 
c Institute of Traffic and Transportation, National Chiao Tung University, Taiwan 
ABSTRACT 
This paper proposes two novel route-based data envelopment analysis (RDEA) models which jointly 
measure the efficiencies of different routes within a transport company and across different companies. The 
proposed RDEA models, containing three stages, decompose a company’s efficiency into individual route’s 
efficiency with simultaneous optimization of the allocation of common inputs. The first stage uses a 
company-based DEA model to acquire a set of optimal input/output multipliers. The second stage then uses 
these multipliers to determine the optimal allocation ratios of common inputs among routes, which further 
maximize the average efficiency of all routes. The third stage determines the efficiencies among all routes 
within a company and across different companies. The proposed RDEA models are applied to evaluate the 
route’s and company’s efficiencies for the 1,035 routes currently operated by 37 Taiwanese intercity bus 
companies. The results provide more insights to ameliorate the individual route’s performance as well as the 
overall company’s performance. 
 
KEYWORDS 
 
Data envelopment analysis, Route-based efficiency, Common inputs allocation. 
 
 
1.  INTRODUCTION 
 
A variety of data envelopment analysis (DEA) methods have been found in literature to measure the 
performance of transport services. However, most literature employed DEA methods to measure the 
transport efficiency at the company level; they viewed each transport company as a decision making unit 
(DMU) and evaluate the performance across the companies. This may not be appropriate for the scheduled 
carriers who provide transport services on a fixed routing and scheduling basis. A carrier’ performance 
should be reflected by the performance of all routes it covers. A well-performed company may also have 
some less efficient routes which require improvements, but the inefficient routes may not be scrutinized by a 
company-based DEA model. The improvement strategies based on company-based DEA model may provide 
little information for improving the inefficient route. For instance, the overstaffing problem is usually 
discovered by a company-based DEA model, but the managers still have difficulty to determine which 
routes’ staff to be curtailed. An inappropriate reduction in inputs of an individual route may sometimes result 
in even worse overall performance. In addition, the probation evaluation of scheduled carriers’ services in 
many countries are also route-based, which serves as important references for new routes franchised, old 
routes renewed, and deficit routes subsidized. In sum, route-based efficiency measures are useful for 
scheduled carriers. 
 
In view of this, Chiou and Chen (2006) proposed route-based DEA (RDEA) models; however, their models 
adopted subjective allocation of common inputs among routes. Once the allocation is not appropriate, the 
results may be misleading. To rectify this problem, the present study proposes a novel three-stage RDEA 
model which decomposes the company’s efficiency into individual route’s efficiency with simultaneous 
optimization of the allocation of common inputs. The first stage of the proposed model uses a 
company-based DEA model to acquire a set of optimal input/output multipliers. The second stage uses the 
corresponding multipliers to determine its optimal allocation ratios of common inputs among routes to 
further maximize the average efficiency of all routes. Once the optimal allocation ratios are determined, a 
表 Y04                                         第 30 頁
 s.t.   1
1
1 ≤
∑
∑
=
=
J
j
i
j
i
ljj
R
r
i
lrr
xsv
yu
, iLl ,,2,1 L=  (7) 
 1
1
=∑
=
iL
l
i
ljs , Jj ,,2,1 L=  (8) 
 0≥iljs , iLl ,,2,1 L=  ;  Jj ,,2,1 L=  (9) 
where ih  is the sum of efficiency scores for all routes of company i, who operates a total of Li routes; each 
route utilizes J kinds of inputs and produces R kinds of outputs. ru  and jv  are the multipliers determined 
by [CCR] model. Besides, each output is assumed route attributable, i.e. it can be clearly identified as a route 
output ( ilry ). However, all the route attributed inputs cannot be identified. The inputs (
i
jx ) to be allocated is 
according to the optimally solved ratio ( iljs )—an allocation ratio of route l for input j of company i. Eq. (8) 
ensures that each common input is completely allocated to all routes. 
 
[AR2] model can be expressed as follows: 
  [AR2] 
s
Max   ∑∑
∑
=
=
=
+
= i
L
l
J
j
i
cj
i
lj
i
ljj
R
r
i
lrr
i
xsxv
yu
h
1
1
1
)(
 (10) 
 s.t.   1
)(
1
1 ≤
+∑
∑
=
=
J
j
i
cj
i
lj
i
ljj
R
r
i
lrr
xsxv
yu
, iLl ,,2,1 L=   (11) 
 1
1
=∑
=
iL
l
i
ljs , Jj ,,2,1 L=   (12) 
 0>
i
ljs , iLl ,,2,1 L= ; Jj ,,2,1 L=    (13) 
where the input j of company i is divided into two parts: the attributable part ( iljx ) and the common part (
i
cjx ). 
In other words, icj
L
l
i
lj
i
j xxx
i +=∑
=1
. The common part ( icjx ) requires an optimally solved allocation ratio (
i
ljs ) 
to assign it to route l. It should be noted that to determine the optimal allocation ratio of common input, only 
the routes operated by the same company are considered; namely, the route allocation ratios for one company 
are irrelevant to the routes operated by other companies. With the optimal allocation ratios ( iljs ), the inputs of 
route l under evaluation can be computed by icj
i
lj
i
lj
i
l xsxx += . 
Based on the computed inputs, the third stage of the proposed [RCCR] model is to optimally determine the 
route efficiency by treating each route (could be operated by different companies) as a DMU, which is 
expressed as follows. 
 [RCCR] 
vu
Max
,
 ∑
=
=
R
r
i
kr
i
kr
i
k yuh
1
 (14) 
 s.t.   0
11
≤−∑∑
==
J
j
i
lj
i
lj
R
r
i
lr
i
lr xvyu , Ii ,,2,1 L= ; Ll ,,2,1 L=  (15) 
 1
1
=∑
=
J
j
i
kj
i
kj xv   (16) 
 0≥iljv , Jj ,,2,1 L= ; Ll ,,2,1 L=  (17) 
表 Y04                                         第 32 頁
In the third stage, the corresponding [RBCC] model can be written as follows. 
 [RBCC] 
vu
Max
,
 ik
R
r
i
kr
i
kr
i
k uyuh −=∑
=1
 (33) 
 s.t.   0
11
≤−− ∑∑
==
J
j
i
lj
i
lj
i
k
R
r
i
lr
i
lr xvuyu , Ii ,,2,1 L= ; Ll ,,2,1 L=  (34) 
 1
1
=∑
=
J
j
i
kj
i
kj xv    (35) 
 0≥iljv , Jj ,,2,1 L= ; Ll ,,2,1 L=   (36) 
 0≥ilru , Rr ,,2,1 L= ; Ll ,,2,1 L=   (37) 
where iku  is the scale of route k of company i. 
 
2.3  Slack analysis 
 
Inefficient DMUs can be improved via slack analysis, which magnitudes are based on the results of the third 
stage of proposed [RCCR] and [RBCC] models. Depending on whether or not the attributed inputs are 
known, two types of slack analysis procedures are categorized. 
(1) When the attributed inputs are unknown, the shared input value ij
i
lj xs  determined by [AR1] or [AR1’] 
model can be used as the inputs of [RCCR] or [RBCC] model to evaluate the route efficiency and to 
determine the corresponding benchmark routes. Therefore, the slack value of the route is the difference 
between the shared input of the route and that of its benchmark routes. 
(2) When the attributed inputs are known, with the allocation ratios determined by [AR2] or [AR2’] model, 
the shared input value icj
i
lcj
i
lj xsx +  can be used as the inputs of [RCCR] or [RBCC] model to evaluate 
the route efficiency and to determine the corresponding benchmark routes. Therefore, the slack value of 
the route is the difference between the shared input of the route and that of its benchmark routes. For 
instance, if route r is benchmarked to route i, the slack value for the attribute part of input j is 
i
lj
i
rj xx − and for the common part is icjiljicjirj xsxs − . 
 
 
3.  CASE STUDY 
 
To demonstrate the applicability of the proposed RDEA models, an empirical study on 37 Taiwanese 
intercity bus companies running for 1,035 routes is conducted. According to previous studies, three input 
variables (fuel cost, number of labors, and number of buses) and three output variables (operating revenue, 
passenger-km, and bus-km) are considered. In this case study, number of buses is the only known attribute 
input; the others are unknown attribute inputs. 
 
3.1  Efficiency scores 
 
In the first stage, a company-based DEA model is used to evaluate the performance of companies. The 
efficiency scores of 37 companies are displayed in Table 1. Note that only 6 companies are evaluated as 
efficient. Most of the inefficient companies, characterized as increasing returns to scale (irs), need to enlarge 
their scales. In the second stage, the optimal allocation ratios among routes are determined. Table 2 illustrates 
the allocation ratios of 17 routes operated by company 1.  
 
Table 1. Efficiency scores and scale efficiencies of 37 bus companies 
Company CRS VRS Scale Company CRS VRS Scale 
1 0.564 0.638 0.975 irs 20 0.586 0.594 0.987 irs 
2 0.938 1.000 0.938 drs 21 0.965 1.000 0.965 irs 
3 0.879 0.919 0.957 drs 22 0.875 0.943 0.928 irs 
4 1.000 1.000 1.000 crs 23 0.686 0.901 0.762 drs 
表 Y04                                         第 34 頁
1 0.598 0.600 0.998 drs 
2 0.558 0.571 0.978 irs 
3 0.232 0.696 0.334 irs 
4 0.606 0.613 0.989 irs 
5 0.309 0.696 0.445 irs 
6 0.357 0.625 0.572 irs 
7 0.235 0.696 0.338 irs 
8 0.799 0.801 0.997 irs 
9 0.426 0.457 0.930 irs 
10 0.614 1.000 0.614 irs 
11 0.898 0.953 0.942 drs 
12 0.385 0.555 0.692 drs 
13 0.662 0.731 0.905 irs 
14 0.962 1.000 0.962 drs 
15 0.543 0.563 0.965 irs 
16 1.000 1.000 1.000 crs 
17 0.406 0.454 0.895 irs 
Mean 0.564 0.707 0.797 - 
 
Based on the results measured at company level (Table 2), Company 1 is inefficient with irs, thus needs to 
expand its overall scale. However, by looking into the route details (Table 3), only twelve routes (irs) need to 
be expanded, one route (crs) needs no expansion, and four routes (drs) even need to be downsized. It 
suggests the importance of route-based performance evaluation. 
 
3.3  Slack values 
 
To propose improvement strategies for the inefficient companies or routes, slack values for each of the 
variables are computed. The results are reported in Table 4. For the inputs that can be identified as attribute 
and common parts, two slack values are generated, respectively. For those inputs that cannot be identified as 
attribute or common part, on the other hand, the proposed model will determine an overall improvement for 
the inputs. Taking route 9 Company 1 as an example, reducing 11.68% of fuel cost, 5.88% of labors, 7.08% 
of attribute buses and 10.87% of common buses would achieve the efficiency frontier. 
 
 
 
 
 
Table 4. An illustration of slack values for inputs of the 17 routes operated by Company 1 
Buses Route Fuel cost Labors Attribute part Common part 
1 14.60% 18.73% 13.41% 8.02% 
2 11.93% 11.35% 8.90% 8.59% 
3 0.05% 0.23% 0.49% 6.10% 
4 12.59% 14.49% 9.89% 7.75% 
5 0.05% 0.41% 0.49% 6.10% 
6 0.06% 0.75% 1.20% 7.52% 
7 0.05% 0.27% 0.49% 6.10% 
8 0.03% 1.70% 2.22% 3.99% 
9 11.68% 5.88% 7.80% 10.87% 
10 0.00% 0.00% 0.00% 0.00% 
11 0.01% 0.45% 0.53% 0.94% 
12 20.44% 31.50% 39.79% 8.92% 
13 5.92% 2.82% 1.72% 5.40% 
14 0.00% 0.00% 0.00% 0.00% 
15 11.29% 6.99% 6.98% 8.76% 
16 0.00% 0.00% 0.00% 0.00% 
17 11.30% 4.41% 6.10% 10.94% 
Total 100.00% 100.00% 100.00% 100.00% 
 
表 Y04                                         第 36 頁
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                             100 年 6 月 28 日 
報告人姓名  邱裕鈞 
 
服務機構
及職稱 
交通大學交通運輸研究所 
 
教授 
     時間 
會議 
     地點 
2011/6/19-2011/6/23 
 
南韓濟州市 
本會核定
補助文號
NSC 97-2628-E-009-035-MY3 
會議 
名稱 
(中文) 第九屆東亞運輸學會 
(英文) The 9th International Conference of Eastern Asia Society for 
Transportation Studies 
發表 
論文 
題目 
(中文) 提昇高速公路起迄矩陣推估之車牌辨識系統最佳區位規劃 
(英文) Optimal Locations of License Plate Recognition to Enhance the 
Origin-Destination Matrix Estimation 
(中文) 利用細胞自動機探索交通型態及交通狀態轉變之特性 
(英文) Exploring Traffic Patterns and Phase Transitions with Cellular 
Automaton 
(中文) 探索影響我國高速公路單車事故之關鍵風險因素 
(英文) Exploring Key Discriminative and Risk Factors Affecting One-Vehicle 
Crash Severities in Taiwan Freeways 
 
二、參加會議經過 
 
東亞運輸學會創建於 1984 年 11 月，會員國包括我國、日本、澳洲、南韓、越南、
中國大陸、香港、澳門…等十五個國家(地區)，旨在促進運輸領域理論研究及實務經驗
的提昇與交流。所有論文將依審查結果分為刊登於期刊、刊登全文於論文集及刊登摘要
於論文集等三等級，具有相當之學術地位。本屆開始大會又開辦 Asian Transport Studies 
(ATS)期刊，將研討會論文中擇取最佳的 32 篇予以刊登，此舉將有助於未來本刊物能收
錄於 SSCI/SCI 資料庫中。本次會議除安排論文研討外，也排定數場專題演講以及技術
考察行程。本次會議由韓國運輸學會（Korean Society of Transportation, KOST）及韓國
運輸研究所（The Korea Transport Institute, KOTI）主辦，韓國國土交通及海運部及濟州
特別行政區政府協辦。全部活動於 2011 年 6 月 20 日至 6 月 23 日共 4 天，在韓國濟州
國際會議中心飯店舉行。本次研討會共有 27 個國籍人士與會，共計 660 人。共計有 766
篇全文投稿，最後接受 492 篇文章報告（理論性文章 349 篇，實務性文章 143 篇）。 
論文發表與研討會議一連舉辦三天（6/20-6/22），包含開、閉幕典禮及歡迎與歡送
酒會。本次會議之主題為：Green Growth and Transport 與節能減碳的世界潮流一致。第
一天開幕典禮所邀請的兩位主講者：濟州特別行政區省長 Keun-min Woo 及韓國運輸研
究所所長：Kee Yeon Hwang 博士，以綠色運輸為題，進行專題演講。由此觀之，即便在
亞洲運輸領域所關心的議題也和國際相同，即災害管理與永續運輸。下午即開始進行分
組報告與討論。我國本屆參與人數與發表文章明顯較之前 EASTS 研討會為少，總發表
文章篇數更低於日本、韓國及印尼。 
 
附件三
 
表 Y04                                         第 38 頁
觀光旅館林立，而且提供相當頻繁的公車連結各觀光飯店及重要景點，提供旅客相當
方便的觀光運輸選擇。值得我國經營開發各離島觀光資源與運輸系統之參考。 
5.本次會議之主辦國：韓國，不論在會前註冊協調、住宿安排及會場後勤作業均讓與會
人士不甚滿意。因此，我國 2013 年主辦本會議時，應將此次主辦經驗不足之問題引以
為戒。 
 
三、建議 
 
1.東亞運輸學會每兩年舉辦一次，至今雖僅舉辦九屆，但各屆會議之規模均相當可觀，
且發表之學術論文均具國際水準，內容雖以運輸為主，但運輸相關課題，如管理、環
境、都市規劃建設等均可接受投稿發表。因此，建議本校相關相關科系教授與學生可
積極參加此一學會，以了解各國各領域之發展現況，俾拓展個人的學術視野與人際關
係，俾利學術研究水準之提昇。也建議校方多補助及鼓勵校內師生參加此類會議，以
增加本校學術研究之知名度。 
2.國內每年舉辦之運輸學會已歷二十五屆，為國內運輸領域之最重要會議，每次會議也
都能吸引數百篇論文投稿，研討場次數十場，十分盛大。惟可惜的是，其性質仍屬國
內研討會，未能進一步與國際接軌。在國際化發展潮流中，未來運輸學會主辦校系實
有必要考慮邀請國際學者或廣邀國際文章，短期也許可考慮分為國內及國際兩個場
次，未來再逐漸改以國際研討會方式進行。此舉也能鼓勵未來碩博士研究生培養以英
文撰寫論文及發表文章的能力。 
3.EASTS 相關期刊目前正積極申請加入 SCI 及 EI 資料庫。目前國內運輸領域的相關期
刊：運輸學刊及運輸計劃季刊，雖已獲 TSSCI 資料庫收錄，但建議考慮改以英文出刊，
以鼓勵國內學者以英文方式撰述論文，未來方有可能列為 SCI 或 SSCI 期刊。 
 
 
四、攜回資料名稱及內容 
1.EASTS 論文集光碟 
2.會議議程彙編 
3.會場展覽相關文宣 
 
五、其他 
本次出國機票、註冊費及生活費用承蒙國科會補助 ( 計畫編號： NSC
97-2628-E-009-035-MY3)，本人特此感謝。 
 
 
表 Y04                                         第 40 頁
patterns, network geometric layouts, and the rationales of assumptions. The estimation performance 
can hardly be guaranteed or enhanced without introducing further information. Today, license plate 
recognition (LPR) technique has become promising to provide additional information to enhance 
the O-D matrix estimation. Basically, the LPR system is an image-processing technology used to 
identify or track vehicles by their license plates for the purposes of security and traffic management 
including access control, traffic enforcement, and data collection. LPR can automatically record and 
check the license plate numbers of any passing vehicles and determine the partial trails of the 
vehicles. With the extra information, the accuracy of O-D matrix estimation might be remarkably 
enhanced. Obviously, if the LPR system is ubiquitous on all ramps of a freeway or at all 
intersections of a network, the O-D matrix is likely to be exactly estimated. However, an extensive 
installation of LPR may not be accepted by the road users due to the privacy invasion. More 
importantly, it is financially infeasible due to the government budget constraint. Therefore, it 
becomes an interesting and challenging topic to determine the appropriate number of LPR and their 
optimal locations so as to balance out the O-D estimation accuracy with acceptable privacy invasion 
and feasible installation cost. 
 
Based on this, the present paper proposes a multi-objective mathematical programming model to 
determine the optimal locations of LPR, which minimizes three objectives: error rates of O-D 
matrix estimation, LPR installation cost, and privacy invasion. Genetic algorithm (GA) is employed 
to solve this combinatorial problem. A pseudoinverse technique is further proposed to estimate the 
O-D matrix based on the traffic information provided by the loop detectors and the LPR at some 
selected locations. These extra traffic equations are derived from a pairwise comparison of the 
recognized license plate numbers between any two arbitrary LPR. To investigate the applicability 
and effectiveness of our proposed model and solving algorithms, one small-scale problem and one 
large-scale problem are exemplified, and one real-world case study are conducted. 
 
The remaining parts of this paper are organized as follows. Section 2 formulates the model and 
gives a seminal example to demonstrate how the traffic equations can be derived from a pairwise 
comparison of license plate numbers recognized by different LPR. Section 3 presents the cases of 
two different-scale computational examples to investigate the effectiveness of proposed model. 
Section 4 further demonstrates the applicability of the proposed model on the real-world freeway 
context. Finally, the concluding remarks and suggestions for future studies are addressed in Section 
5. 
 
 
2. MODEL 
 
2.1 Problem Formulation 
 
A linear freeway corridor denoted as G(N, A) with an O-D matrix T, where N is a set of 
interchanges and A is a set of segments (between two interchanges). Each segment is a candidate 
location to install exactly one set of LPR. Assume that each of the freeway segments has already 
been embedded with at least one set of loop detectors by which the basic information of link traffic 
counts is provided. The LPR problem formulation is to minimize the following three objectives: 
error rate, installation cost and privacy invasion: 
 
Min  E= ∑ ∑−
= +=
−1
1 1
ˆN
i
N
ij ij
ijij
t
tt
                                            (1) 
Min  C=∑
=
A
k
kcy
1
                                                  (2) 
表 Y04                                         第 42 頁
pseudoinverse technique is commonly used to solve a minimal-length solution (closest to the origin) 
of the underdetermined linear equations problem. Assume that a total of m traffic equations can be 
obtained from link traffic counts and license plate comparisons as follows: 
 
TFX ˆ=                                                              (10) 
 
where X represents a vector of link traffic counts and license plates comparisons; Tˆ  denotes a 
vector of p estimated O-D trips; F, a pm×  matrix, represents the coefficients of these traffic 
equations. Since the number of traffic equations is less than the number of estimated O-D trips, F is 
not a square matrix. The estimated O-D trips can be solved by the following equation: 
 
XFFFT 1)'('ˆ −=                                                        (11) 
 
where 'F  denote a transpose of matrix F, 1)'(' −FFF  is a pseudoinverse of matrix F. 
 
2.2 A Seminal Example 
 
To demonstrate how the traffic equations can be derived from a pairwise comparison of license 
plate numbers recognized by different LPR, this paper considers a stretch of eastbound freeway 
with six interchanges and five loop detectors (Figure 1). Each interchange can be the origin or the 
destination of the trips. In the case that two sets of LPR are installed at the 2nd and 4th segments, a 
total of 15 unknown ijtˆ  have to be determined. 
 
 
Figure 1 A seminal example with two LPR installed 
 
Five traffic equations can be derived from the link traffic counts of loop detectors by the equation of 
∑ ∑
= +=
=
k
i
N
kj
ijk tx
1 1
; namely, 
 
16151413121 tttttx ++++=                                                 (12) 
26252423161514132 ttttttttx +++++++=                                     (13) 
3635342625241615143 tttttttttx ++++++++=                                 (14) 
46453635262516154 ttttttttx +++++++=                                     (15) 
56463626165 tttttx ++++=                                                (16) 
 
Three additional traffic equations can be derived from these two LPR by comparing the license 
plate numbers recognized: 
 
2625161542 ttttll +++=I                                                 (17) 
24231413422 ttttlll +++=− I                                              (18) 
46453635424 ttttlll +++=− I                                              (19) 
表 Y04                                         第 44 頁
80434 =− lll I , then the O-D matrix can be estimated with an error rate of 12.32%. This example 
demonstrates that the error rate can be reduced by 11.61% if an additional LPR is installed at 
segment 3. 
 
2.3 Solution Algorithm 
 
Due to the combinatorial nature of the problem, GA is suitable to solve the problem with the 
following eight steps: 
Step 0: Initialization. Generate an initial population with M chromosomes. Each chromosome has 
A  genes and each gene randomly takes an integer of {1, 0}. The value of gene is used to 
indicate whether an LPR is installed at the corresponding segment or not. Set the values of 
related parameters including population size, crossover rate, mutation rate, matured rate (η), 
and weights of three objectives (α, β and γ). 
Step 1: Estimation of O-D trips. Estimate the O-D trips based on the traffic equations derived from 
link traffic counts by loop detectors and license plate comparisons by LPR according to the 
corresponding chromosome. 
Step 2: Evaluation. Calculate the fitness values of all chromosomes. 
Step 3: Selection. The roulette wheel method is adopted. 
Step 4: Crossover. The two-point crossover method is adopted. 
Step 5: Mutation. The gene mutation method is adopted. 
Step 6: Repeat Step 1 and Step 2. 
Step 7: Testing of stop condition. If mature rate≥η, then stop. The incumbent location is the optimal 
selection. Otherwise, go to Step 3. 
 
 
3. EXEMPLIFIED PROBLEMS 
 
To investigate the performance of the proposed model and the solving algorithm, two exemplified 
cases, one small-scale problem and one large-scale problem, are tested. In addition to use the 
proposed solving algorithm, the small-scale problem is also solved by total enumeration method to 
obtain the true optimal results, which are used to verify the effectiveness of the proposed solving 
algorithm. 
 
3.1 Small-scale Problem 
 
The small-scale problem considers a freeway of 8 interchanges (7 segments) with a randomly 
generated O-D matrix (Table 1). There are a total of 28 O-D trips, which are used to compute the 
link traffics of loop detectors and recognized traffics of LPR and also used to compute the error rate 
of the O-D matrix estimation. The parameter settings of GA are as follows: length of 
chromosomes=7, population size=50, crossover rate=0.8, mutation rate=0.01, and mature rate =0.8. 
 
Table 1 Randomly generated O-D trips (tij) of the exemplified small-scale problem 
i＼j 1 2 3 4 5 6 7 8 
1 - 32 61 44 52 46 37 21 
2 - - 15 39 55 47 62 31 
3 - - - 23 54 66 21 48 
4 - - - - 32 51 47 61 
5 - - - - - 33 46 49 
6 - - - - - - 52 49 
表 Y04                                         第 46 頁
Table 2 Minimal E under various numbers of LPR 
Number of LPR Method 0 2 3 4 5 6 
GA 47.96% 36.65% 27.49% 19.24% 11.07% 0.00% 
Total enumeration 
method 47.96% 36.65% 27.49% 19.24% 11.07% 0.00% 
Marginal contribution 
(reduction of E) for 
additional LPR 
- 11.31% 9.16% 8.25% 8.17% 11.07%
 
Figure 3 further depicts the error rates of every enumeration under various numbers of LPR. It can 
be found that even under the same number of LPR, different locations of LPR have exhibited 
remarkably different error rates. Taking n=3 for instance, the largest error rate has reached 40.25%, 
much larger than the minimal one (27.49%), suggesting the importance of proper location of the 
LPR. 
 
0.00%
10.00%
20.00%
30.00%
40.00%
50.00%
60.00%
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35
Enumerations
E
n=0
n=2
n=3
n=4
n=5
 
Figure 3 Error rates of every enumeration 
 
The optimal locations for various numbers of LPR are depicted in Figure 4. Note that the optimal 
locations of LPR are not installed at the segment with high link traffic; instead, they should be 
located at both ends of the corridor segments wherein link traffics are heavy (segments 3) so as to 
capture the longer-distance O-D trips. 
 
Figure 4 The optimal locations for various numbers of LPR 
 
表 Y04                                         第 48 頁
 
4. CASE STUDY 
 
To further demonstrate the applicability of the proposed model, a case study on Taiwan No.1 
Freeway is conducted. This freeway is 372.7 kilometers in length with a total of 42 interchanges 
from Keelung (the very north end) to Kaohsiung (the very south end). The most updated O-D 
matrix of this freeway was surveyed by Institute of Transportation, Ministry of Transportation and 
Communications in 1995. The corresponding link traffic data at all segments are displayed in Figure 
6. The corresponding weights of three objectives in Eq. (9) are set as α=0.5, β=0.25, and γ=0.25. 
The parameter settings of GAs remain the same as the aforementioned large-scale problem. The 
results show that it requires installing 10 LPR, which allows 49.09% error rate with 24.39% LPR 
coverage and 27.19% recorded trips. 
 
0
20000
40000
60000
80000
100000
120000
140000
160000
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41
Segment
Link
traffic
 
Figure 6 Distribution of link traffic on Taiwan No.1 Freeway 
Source: Institute of Transportation, MOTC (1995) 
 
The optimal locations for various numbers of LPR are detailed in Table 4. As shown in Figure 6, an 
obvious peak traffic can be identified between segments 7 and 15, thus the first best choice for 
locating the LPR are at the segments 7 and 15, and then the middle of the peak (segment 10). As the 
number of LPR increases, it is likely to install the LPR at the segments with light link traffic to 
account for the privacy invasion factor. 
 
Table 4 Optimal locations of LPR for Taiwan No.1 Freeway under various numbers of LPR 
Segment 
# of LPR 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41
6    *   *        *          *         *      *  
7      * *   *               *         *      *  
8      * *   *     *          *   *      *      *  
9    *  * *   *          *     *         *      * * 
10 *   *  * *   *     *          *   *       *      * 
11 *     * *   *     *     *     *   *       *     * * 
12 *   *  * *   *     *     *     *   *       *     * * 
13 *   *  * *   *     *     *    * *   *       *     * * 
14 * *   * * *   *     *     *     *   *       *   *  * * 
15 * *   * * *   *     *     *    * *   *       *   *  * * 
16 * * *  * * *   *     *     *    * *   *       *   *  * * 
17 * * *  * * *   *     *     *    * *   *  *     *   *  * * 
18 * * * * * * *   *     *     *    * *   *  *     *   *  * * 
19 * * * * * * *   *     *  *   *    * *   *  *     *   *  * * 
20 * * * * * * *   *     *  *   *    * *   *  *   *  *   *  * * 
21 * * * * * * *  *   *   *    * *    * *   *  *   *  *   *  * * 
22 * * * * * * *  *      *  *   *  *  * *   *  *   *  * *  *  * * 
23 * * * * * * *  *      *  *   *  *  * *  * *  *   *  * *  *  * * 
24 * * * * * * *  *   *   *    * *    * *  * *  * *  *  * *  *  * * 
25 * * * * * * * * *   *   *    *   *  * *  * *  *   *  * *  * * * * 
26 * * * * * * *  *   *   *    * *  *  * *  * *  * *  * * * *  *  * * 
27 * * * * * * *  *   *   *    * *  *  * *  * *  * * * * * * *  *  * * 
28 * * * * * * *  *   *   *    * *  *  * *  * * * * * * * * * *  *  * * 
29 * * * * * * *  *   *   *    * *  *  * *  * * * * * * * * * *  * * * * 
30 * * * * * * *  *   *   *    * * * *  * *  * * * * * * * * * *  * * * * 
31 * * * * * * *  *   *   *    * * * *  * *  * * * * * * * * * * * * * * * 
32 * * * * * * *  *   *   *  *  * * * *  * *  * * * * * * * * * * * * * * * 
33 * * * * * * *  *   *   *  *  * * * * * * *  * * * * * * * * * * * * * * * 
34 * * * * * * *  *   *   *  *  * * * * * * * * * * * * * * * * * * * * * * * 
35 * * * * * * *  *   *   *  * * * * * * * * * * * * * * * * * * * * * * * * * 
Note: * represents a set of LPR installed. 
 
To look into the sensitivity of the corresponding weights of three objectives in Eq. (9), this paper 
varies α from 0.50 to 0.95 and sets β = γ. The optimal numbers of LPR associated with different 
values of α are presented in Table 5. Notice that as α gets larger the error rate decreases but the 
percentages of LPR coverage and recorded trips increase. When α is smaller than 0.5, the error rate 
is relatively high and the percentages of LPR coverage and recorded trips are relatively low, and the 
表 Y04                                         第 50 頁
Bell, M.G.H. (1983) The estimation of an origin-destination matrix from traffic counts. 
Transportation Science,Vol.17, 198-217. 
Bell, M.G.H. (1991) The estimation of origin-destination matrices by constrained generalized least 
squares. Transportation Research, Vol.25B, 13-22. 
Chiou, Y.C. Fan, C.C. and Lan L.W. (2006) “A location selection model of license plate recognition 
system for enhancing the estimation of freeway O-D matrix,” Proceeding of the 11st 
International Conference of Hong Kong Society for Transportation Studies, Hong Kong, 
Dec.10~12. 
Fisk, C.S. (1988) On combining maximum entropy trip matrix estimation with user optimal 
assignment. Transportation Research, Vol.22B, 66-79. 
Hazelton, M. (2001) Inference for origin-destination matrices: estimation, prediction and 
reconstruction. Transportation Research, Vol.35B, 667-676. 
Institute of Transportation, MOTC (1995) The Integrated Planning for Transportation Systems 
of Taiwan Area. (in Chinese) 
Lo, H., Zhang, N. and Lam, W. (1996) Estimation of an origin-destination matrix with random link 
choice proportions: a statistical approach. Transportation Research, Vol.30B, 309-324. 
Robillard, P. (1975) Estimating the O-D matrix from observed link volumes. Transportation 
Research, Vol.9, 123-128. 
Vardi, Y. (1996) Network tomography: estimating source-destination traffic intensities from link 
data. Journal of the American Statistical Association, Vol.91, 365-377. 
Yang, H. (1995) Heuristic algorithms for the bilevel origin-destination matrix estimation problem. 
Transportation Research, Vol.29B, 231-242. 
Yang, H., Akiyama, T. and Sasaki, T. (1998) Estimation of time-varying origin-destination flows 
from traffic counts: a neural network approach. Mathematical and Computer Modelling, 
Vol.27, 323-334. 
Yang, H., Sasaki, T., Iida, Y. and Akiyama, T. (1992) Estimation of origin-destination matrices 
from link traffic counts on congested networks. Transportation Research, Vol.26B, 417-434. 
  
表 Y04                                         第 52 頁
Exploring Traffic Patterns and Phase Transitions with Cellular Automaton 
 
Zih-Shin LIN 
Aviation Safety Inspector 
Flight Standard Division 
Civil Aviation Administration, MOTC 
340 Dun Hua N. Rd., Taipei 10548 Taiwan 
FAX: +886-2-2349-6017 
E-mail: simon@mail.caa.gov.tw 
 
Chih-Cheng HSU 
Chief, Transportation Safety Division 
Transportation Bureau, New Taipei City 
10F, 161 Sec.1, Jhongshan Rd., Banciao, 
Taipei 22001 Taiwan 
FAX: +886-2-2349-4953 
E-mail: charles.tt92g@nctu.edu.tw 
 
Yu-Chiun CHIOU 
Professor 
Institute of Traffic and Transportation 
National Chiao Tung University 
4F, 114 Sec.1, Chung Hsiao W. Rd. Taipei 
10012 Taiwan 
FAX: +886-2-2349-4940 
Email: ycchiou@mail.nctu.edu.tw 
Lawrence W. LAN 
Chair Professor, Ta Hwa Institute of 
Technology; Emeritus Professor, National 
Chiao Tung University 
No. 1 Tahwa Rd., Chiunglin, Hsinchu 30740 
Taiwan 
Fax: +886-2- 2337-5755 
E-mail: lawrencelan@thit.edu.tw 
 
Abstract: Traffic patterns and the associated phase transitions for pure and mixed traffic are 
explored in this study. Local traffic parameters are defined in a spatiotemporal (3-D) domain so that 
the cellular automaton (CA) modeling can precisely capture the traffic features. Refined CA 
simulations are performed under pure and mixed traffic scenarios on a multilane stretch where 
virtual detectors are placed to measure the 3-D traffic parameters. It is found that the proposed 
measuring techniques with refined CA modeling can copiously explore the local traffic patterns 
with associated phase transitions in both upstream and downstream of a bottleneck. Finally, a 
comparison of the local traffic parameters with the global counterparts is also presented. 
 
Key Words: cellular automaton (CA), mixed traffic, traffic patterns, phase transitions. 
 
 
1. INTRODUCTION 
 
Cellular automaton (CA) has become an effective tool for reproducing the basic features and for 
exploring the phase transitions of real traffic since Nagel and Schreckenberg (1992) first proposed a 
simple CA model—the renowned NaSch model. To date, a considerable number of modified CA 
models have been proposed, for instance, Nagel (1996, 1998), Rickert et al (1996, 2002), 
Chowdhury et al (1997) and Barlović et al (1998), Knospe et al. (2000), Jiang and Wu (2003), 
Bham and Benekohal (2004), and Larraga et al. (2005). Most of these CA models were for pure 
traffic on rather coarse cell systems wherein all vehicles are treated as identical size (same length 
and width). Recently, some CA studies have devoted to mixed traffic scenarios in which vehicles 
come in various sizes (e.g., Nagel et al., 1998; Ez-Zahraouya et al., 2004; Kerner, 2004; Wang et al., 
2007; Meng et al., 2007). However, these studies merely considered different vehicle lengths 
without factoring different vehicle widths into the models, except for Meng et al. (2007). In reality, 
a multilane roadway space used by mixed traffic (e.g., bus, car, motorcycle) should take into 
account the lengths and widths of different vehicles so as to more precisely elucidate their 
表 Y04                                         第 54 頁
bicycle) can be represented by 2×1 CUs, taking up 2 CUs of the roadway space. Other vehicle types 
can also be defined in accordance with their lengths and widths. For demonstration, in Figure 1 a 
local detector which occupies 1×6 CUs is also depicted. 
 
Figure 1 Cell/site system utilized and allocations of vehicles of various sizes in the proposed CA 
model. For demonstration, the virtual local detector is also defined. 
 
2.2 Spatiotemporal Traffic Parameters 
 
In conventional traffic flow theory, there are three important traffic parameters—flow (q), density (k) 
and speed (v). For a single-lane roadway with length L, the 1-D local traffic parameters can be 
defined as: 
 
( ) nubmer of vehicles observed over a road of given lentgh L at time tk t
length of observed roadway L
=               (1) 
Tperiodtimeobservedoflength
xlocatTperiodtimegivenduringobservedmvehiclesofnubmerxq .)()( =              (2) 
 
The speed (v) can be calculated by the following equation: 
 
q=kv                                                    (3) 
 
It is understood that Eq. (3) was originally developed by scholars in the field of fluid mechanics 
upon the assumption that fluid flow is continuous. This formula later was introduced by Wardrop 
(1952) for analyzing traffic features and, since then, commonly utilized for estimating vehicular 
average speed. However, one may be confused about the validity of such applicability since traffic 
flow is not continuous but in essence discrete by nature. Besides, by definition, the 1-D local traffic 
flow-q(x) is a time-based parameter measured over a period of time at a specific fixed point, 
whereas the local traffic density-k(t) is a space-based parameter measured over a distance of space 
at a specific time instant. So although Eq. (3) seems reasonable from dimensional perspective, it has 
been constantly criticized in the past. For example, Highway Research Center (2005) argued that 
this formula is strictly correct only under some very restricted conditions, i.e., homogeneous state in 
which each vehicle equips with identical features (e.g., same headway, identical speed, etc), or in 
the limit as both the space and time measurement intervals approach zero. If neither of those 
situations holds, then use of Eq. (3) to calculate speed can give misleading results, which would not 
表 Y04                                         第 56 頁
)1()1()
2
)1(()1(
))1((
1
11
))1((
1
+++≤−++Δ++ ∑∑ +
=
++
+
=
tvtxiDtctx
tc
i
nn
tc
i
nn
nnnn ττ
 (9) 
Step 4: Randomization. 
if ( prand <() ) then )0,1)1(max()1( −+=+ tvtv nn  (10) 
Step 5: Determination of vehicle status identifier Sn(t) in the next time-step. 
)(1)(t  if
)(1)(t  if
)(1)(t  if
1
)(
0
)1(
tvv
tvv
tvv
tStS
nn
nn
nn
nn
<+
=+
>+
⎪⎩
⎪⎨
⎧
=+  (11) 
Step 6: Determination of time (tst) stuck inside the jam. 
⎩⎨
⎧
>+
=+
=
+==
0)1(  if
0)1(  if
0
1
tv
tv
t
tt
t
n
n
st
stst
st  (12) 
Step 7: Update position. 
)
2
)1()(()()1( +++=+ tvtvroundofftxtx nnnn  (13) 
 
2.4 Lateral Movements 
 
In real world, most road systems comprise at least two lanes, thus allowing vehicles to change lane 
or make lateral displacement to overtake a slow vehicle or fixed object in front. Over a two-lane (6 
sites in width) roadway, for instance, a heavy vehicle (3 CUs in width) will have only one kind of 
lateral movement—lane change (either from left lane to right lane or from right lane to left lane). A 
light vehicle (2 CUs in width) may have one additional lateral movement option: lateral drift, beside 
lane change. The lateral shift (drift?) of light vehicle will be triggered if the situation is allowed to 
overtake a smaller size vehicle (e.g., motorcycle or bicycle) in front of the same lane and with 
comparatively slower speed, which refers to moving forward within the same lane but drifting from 
rightmost two sub-lanes to leftmost two sub-lanes or from leftmost two sub-lanes to rightmost two 
sub-lanes provided that each sub-lane is 1-site in width. However, since in this study only pure 
traffic and mixed traffic that comprised by heavy vehicles and light vehicles (no motorcycles) are 
simulated, the lateral positions of light vehicles within each lane will not significantly affect the 
simulated traffic flow rate. Therefore in this study only lane change behavior is considered for both 
light and heavy vehicles. The lane change rule can be recapped as: 
 
rlLC → : If )()( ,, tvtv nlnl >  and )()( , tvtv nln >  
and ))1(,min()(, +> tvdtg neffnr nl ..........................................................................       (14) 
and ))1(,min()( ,,, +> tvdtg r nbeffnbr nb  
where, g is the gap and the suffix b denotes the vehicle in nearby upstream. 
 
 
3. LOCAL TRAFFIC PARAMETERS DETECTION 
 
3.1 Local Traffic Parameters 
表 Y04                                         第 58 頁
for a two-lane roadway with 6 sites in width, the maximum occupancy available for pure car traffic 
would be two-thirds (0.667) only if counted on the CU (cell/site) basis. Only in pure bus (3 CUs in 
width) traffic can a theoretical maximum occupancy (1.000) be reached, which implies that the 
lateral 6 sub-lanes (sites) are fully occupied. 
 
3.2 Traffic Detection and Measurement 
 
For a local virtual detector with length 1 site located at position ms on the roadway of width W, four 
possibilities can be identified for one vehicle with width VW and length VL to pass through it within 
each time-step. All the possibilities are shown in Figure 2. The first possibility is that at time t a 
vehicle did not arrive the detector but the vehicle “passed through” it at time t+1 (Figure 2(a)). The 
second possibility is that at time t a vehicle did not arrive the detector, but the vehicle “stand” on the 
detector at time t+1 (Figure 2(b)). In the third case, a vehicle remains standing on the detector for 
consecutive two time-steps (Figure 2(c)), this happens in congested traffic. The final case is that a 
vehicle touches the detector at time-step t and “passed it through” at time t+1 (Figure 2(d)). 
 
 
Figure 2 Four possibilities for a vehicle detected by a virtual detector 
 
Upon above, for a virtual detector arranged at the simulated road section, the local flow rate and 
occupancy can be extracted respectively by Eqs. (16) and (17). Note that both flow rate and 
occupancy are counted by number of cells instead of number of vehicles. 
 
Moving direction 
表 Y04                                         第 60 頁
 
The simplest UMA may be the mean of previous n data points, which can be calculated via the 
following equations: 
∑
=
+−=
n
i
itma Vn
tV
1
1
1)(                                 (18) 
n
V
n
VtVtV tntmama 11)()1( ++− +−=+                                  (19) 
where, Vt is the local parameters (O(t) and q(t)) detected by Eqs. (16) and (17) at time-step t, 
whereas Vma(t) is their UMA. 
 
 
4. SIMULATIONS 
 
4.1 Scenarios 
 
The simulations are performed on a closed track containing 1,800×6 sites (CUs), which represents a 
two-lane freeway mainline stretch with width 7.5 meters and length 1,800 meters. Pure light vehicle 
(car) traffic and light/heavy vehicle (car/bus or truck) mixed traffic are simulated. Based on the field 
observation on Taiwan’s Freeway, the prevailing mixed ratio of 80% light vehicle and 20% heavy 
vehicle is selected. At time-step 0, all vehicles are set in the front end of the circular track with 
velocity 0 as the initial condition and simulated for 600 time-steps. The maximum speeds are 
defined in accordance with the speed limits on Taiwan’s Freeway, that is, 31 cells/sec for light 
vehicle (around 110 kph) and 25 cells/sec for heavy vehicle (90 kph) respectively. 
 
4.2 Results of AA Traffic Data 
 
To explore the diversified traffic patterns, we arrange a bottleneck in the middle of the right lane of 
the simulated track. Two local virtual detectors are introduced—one 100 sites (meters) upstream 
and the other 100 sites downstream of this bottleneck, as shown in Figure 3. Both pure light vehicle 
and mixed light/heavy vehicle traffic are simulated. It can be clearly identified that the shapes of 
both x-t plots (Figure 3(a) and 3(b)) are similar, there are sequential traffic patterns transiting around 
the downstream of the virtual detector from F, F→J, J→S, S→F (denoted by Ⅰ through  Ⅳ
respectively); while in the upstream, traffic patterns transit from F, F→S, S→J, J→S (denoted by Ⅴ 
through  respectively).Ⅷ  F denotes free flow, J represents jammed flow, and S stands for 
synchronized flow. 
 
表 Y04                                         第 62 頁
0
100
200
300
400
500
600
0 5 10 15 20 25 30 35
q(
t)
O(t)  
downstream 
0
100
200
300
400
500
600
0 5 10 15 20 25 30 35
q(
t)
O(t)
upstream 
0
100
200
300
400
500
600
0 5 10 15 20 25 30 35
q(
t)
O(t)
combined 
(b) Mixed light/heavy vehicle traffic 
Figure 4 Simulated local q-O plots with one bottleneck. (30s AA data) 
 
4.3 Results of UMA Traffic Data 
 
For comparison, the unweighted moving average (UMA) traffic data, as derived by Eqs. (18) and 
(19), are also calculated to elucidate the same scenarios. For pure light vehicle traffic (Figure 3(a)), 
we first focus on the downstream of the bottleneck. According to Figure 3(a), traffic patterns around 
downstream detector will be free flow at the beginning (region I, F phase, also refer to Figure 5(a)) 
and then pass through the bottleneck to reach upstream of jam. Vehicles joining the jam will keep 
stationary (region II, J phase, also refer to Figure 5(b)) until all vehicles in front have left and then 
start to move (region III, J→S phase transition, also refer to Figure 5(c)). Later on, as the flow rate 
reduces due to the impact of bottleneck, the traffic transits into free flow (region IV, S→F phase 
transition, also refer to Figure 5(d)). A clearer picture of these flow patterns and the associated 
phase transitions can be obtained by aggregating all UMA traffic data into one plot, shown in Figure 
5(f). 
 
Similarly, we can describe the upstream flow patterns through the same algorithm, as shown in 
Figure 6. Also per x-t diagram (Figure 3(a)), traffic patterns around upstream detector will be free 
flow at the beginning (region V, F phase). When approaching the bottleneck, the flow patterns will 
transfer to synchronized flow (region VI, F→S phase, also refer to Figure 6(a)) until reaching the 
upstream front of jam (region VII, S→J phase, also refer to Figure 6(b)). Vehicles stand still to wait 
for the front condition for movement (region VIII, J→S phase transition, also refer to Figure 6(c)). 
For the rest of time, because the bottleneck shrinks the road capacity which in turn influences the 
upstream traffic significantly, the patterns will keep as synchronized flow (region VIII, S phase, also 
refer to Figure 6(d)). Aggregating all data into one plot, as shown in Figure 6(f), a whole picture of 
flow patterns and associated phase transitions can be seized exactly. For further comparison, in 
addition to the above 30s AA and UMA traffic data, the precise 1s local data are also gathered and 
shown in Figures 5(e) and 6(e), respectively. One can easily find that the 1s data widely scatters in 
both plots, wherein no significant traffic patterns or transitions can be found. It is clear that a time 
average traffic parameters is more powerful than the original 1s data created by each time-step (1s) 
to gain insights into the traffic phenomena.  
 
0
100
200
300
400
500
600
0 10 20 30
q(
t)
O(t)
I
F
0
100
200
300
400
500
600
0 10 20 30
q(
t)
O(t)
II
J
F
0
100
200
300
400
500
600
0 10 20 30
q(
t)
O(t)
III
J
S
0
100
200
300
400
500
600
0 10 20 30
q(
t)
O(t)
IV
F
S
(a) (b) (c) (d) 
表 Y04                                         第 64 頁
0
10
20
30
40
50
60
0 0.2 0.4 0.6 0.8 1
q(
t)
O(t)
(a) 1s local data 
0
100
200
300
400
500
600
0 10 20 30
q(
t)
O(t)
J
F
VIV VII
S
VIII
(b) 30s UMA data 
Figure 8 Simulated local q-O plot for mixed light/heavy vehicle traffic (upstream of 
bottleneck) 
 
 
5. LOCAL VERSUS GLOBAL TRAFFIC FEATURES 
 
As discussed above, it is costly and difficult to observe the global traffic features (ρ(S) and q(S)) 
over a long distance within a long period of time, thus temporal local traffic features (O(t) and q(t)) 
are usually measured via stationary detectors. One criticism arisen as to whether the local traffic 
data O(t) and q(t) could serve as the appropriate proxies for their global counterparts ρ(S) and q(S). 
Because the trajectories of all vehicles during the simulated period can be precisely gauged, CA 
simulations have excellent capability for monitoring the vehicular behaviors both in space and time 
frames. In addition, the global traffic features are in essence the aggregation of all local traffic 
features; thus, global traffic features can also be deemed as a paradigm for evaluating the 
effectiveness of locally derived traffic information. As such, this study selects q(S) rather q(t) as the 
reference index for evaluating the traffic performance. 
 
Upon this, it is interesting to discover the relationship or linkage between global and local traffic 
parameters, including: (1) Can locally derived traffic data can reflect the trends shown in global 
perspective? If yes, what precision might be achieved? (2) What is the difference between the 
outcomes of AA and UMA local traffic data? Which one would be better proxy for global traffic 
data? (3) What are the proper time intervals for taking AA or UMA while measuring the local traffic 
data? To answer these questions, this study further simulates pure light vehicle traffic scenarios and 
compares the local traffic features (q-O plots) with the global counterpart as follows. 
 
Four generalized occupancies (ρ(S)=0.06, 0.12, 0.25 and 0.50), corresponding to traffic densities 
(15, 30, 62.5 and 125 veh/km/ln) from free flow to jam are simulated respectively. When 
simulations initiate, all the vehicles are equally spaced on the circular track wherein a virtual 
detector is placed in the middle. The derived local traffic data (O(t) and q(t)) are taken by AA and 
UMA with different time intervals (1s, 30s and 60s). Finally, the outcomes for these four 
simulations are collected and compared with their global counterparts (ρ(S) and q(S)). The 
fundamental diagrams are displayed in Figures 9 to 11. 
 
As shown in Figure 9, as expected, the 1s local flow rate q(t) significantly deviates from its global 
counterpart q(S), especially around the region ρ(S)=0.1~0.4. The maximum flow rate is 
overestimated. This is deemed reasonable since the 1s data aims only at the local traffic information 
for a very short instant; thus, the effect of some extreme situations occurred locally have been 
exaggeratedly amplified. In conclusion, although the aggregated local 1s data transforms into some 
traffic patterns that can perfectly match the three-phase traffic theory, it is never sufficient to reflect 
the traffic conditions in the global perspective. 
 
表 Y04                                         第 66 頁
0.0 
0.5 
1.0 
1.5 
2.0 
2.5 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
q 
(c
el
l/t
im
es
te
p)
ρ (S) or O(t) 
global
local (ρ= 0.06)
local (ρ= 0.12)
local (ρ= 0.25)
local (ρ= 0.50)
0.0 
0.5 
1.0 
1.5 
2.0 
2.5 
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
q 
(c
el
l/t
im
es
te
p)
ρ (S) or O(t)
global
local (ρ= 0.06)
local (ρ= 0.12)
local (ρ= 0.25)
local (ρ= 0.50)
 
30s UMA data 60s UMA data 
Figure 11 Comparison of global fundamental diagram with local UMA data for four different 
scenarios (pure light vehicle traffic: ρ(S)= 0.06, 012, 0.25, 0.50) 
 
Nonetheless, one must agree that, as recalled in Section 4.3, the UMA traffic parameters are more 
effective than the AA traffic parameters in reflecting the complicated traffic phase transitions. 
Besides, for each individual simulation, implementation of the UMA technique provides notably 
more precious data points than that via the AA technique. 
 
In sum, the UMA measurement is effective in reflecting the local traffic phase transitions. However, 
this merit will reversely turn into a weakness if one is interested in the global traffic features either 
for pure or mixed traffic simulation. If one is interested in scrutinizing the local traffic data, the AA 
data would present better simulation quality than the UMA data since the AA data points scatter 
within a smaller region in the neighborhood of the global curve. It makes sense because the impact 
of some local noises of AA data with short lifetime will be few when independent time intervals are 
considered. In contrast, by the rolling nature of UMA data, the impact of some local noises will 
yield more expansive influence and henceforth force more UMA local traffic data to deviate from 
the global curve. 
 
 
6. CONCLUSIONS 
 
The proposed AA and UMA measurements for extracting local traffic parameters from the refined 
CA modeling has been successfully validated throughout the complex scenarios under pure and 
mixed traffic contexts. The UMA measurement is more effective in reflecting the complicated phase 
transitions; while the AA measurement can better reflect the global traffic features and is also 
consistent with the Kerner’s three-phase traffic theory. This evidence supports the speculation that 
three-phase traffic theory is developed through the AA field data. Finally, based on the findings, it is 
recommended that the time interval for measuring either AA or UMA traffic data would be 30s at 
least. 
 
For the mixed traffic simulation, this study only considered a mixed ratio of 80 % light vehicles 
with 20% heavy vehicles. The traffic patterns and associated phase transitions under other mixed 
ratios require further exploration. In many Asian cities, motorcycles are ubiquitously sharing the 
roadway space with cars and/or buses on the surface roads. Therefore, it is interesting to conduct 
more sophisticated CA simulations to capture the traffic features for mixed motorcycle/car or mixed 
motorcycle/car/bus traffic situations. 
 
 
ACKNOWLEDGEMENTS 
 
表 Y04                                         第 68 頁
4655-4672. 
Nagel, K. (1998) From particle-hopping models to traffic flow theory, Transportation Research 
Record, Vol. 1644, 1-9. 
Nagel, K. and Schreckenberg, M. (1992) A cellular automaton model for freeway traffic, Physics I, 
Vol. 2, 2221-2229. 
Wang, R., Jiang, R., Wu, Q.S. and Liu, M. (2007) Synchronized flow and phase separations in 
single-lane mixed traffic flow, Physica A, Vol. 378, 475-484. 
Wardrop, J.G. (1952) Some theoretical aspects of road traffic research, Proceedings of the 
Institution of Civil Engineers, Part II, 325-362. 
表 Y04                                         第 70 頁
 
Wong and Chung (2007) explored the accident chains and found that a crash is often caused by a 
series of errors, not solely by a single factor. Consequently, mining the explanatory rules is deemed 
necessary for crash data analysis. Rule mining is one of data mining techniques intended to mine for 
knowledge from available databases and toward decision support. Rule mining is naturally modeled 
as multi-objective problems with three criteria: (1) predictive accuracy, (2) comprehensibility, and 
(3) interestingness (Freitas, 1999; Ghosh and Nath, 2004). To automatically search for the optimal 
combination of rules from a large number of potential rules, genetic algorithms (GAs) are perhaps 
the most commonly used method. Employing GAs to learn of rules is named as genetic mining rule 
(GMR) (e.g. Freitas, 1999; Shin and Lee, 2002; Ghosh and Nath, 2004; Dehuri and Mall, 2006; 
Chen and Hsu, 2006). Meanwhile, rough set (RS) theory,  proposed by Pawlak (1982), is a 
relatively new classification method in data mining field and has been proven useful for exploring 
data patterns (Greco et al., 2001). RS theory can also be used to generate decision rules for further 
analysis. The performances of both GMR and RS rule mining models have been proven and applied 
in many fields. 
 
The objective of this paper is to propose two new rule-mining models—GMR and RS to generate 
decision rules for one-vehicle crash severities. The key factors identified by the two rule-mining 
models are further compared with a conventional statistical model—the ordered Probit (OP) model. 
Based on the findings, proper countermeasures are suggested. The rest of this paper is organized as 
follows. Section 2 presents the crash data with the definitions of potential contributing factors. The 
proposed GMR and RS models are narrated in Sections 3 and 4, respectively. Section 5 presents the 
estimated results of the OP model. Based on the three models, the key discriminative and risk 
factors affecting one-vehicle crash severity are identified in Section 6. Finally, the concluding 
remarks and suggestions for future studies follow. 
 
 
2. DATA 
 
The dataset contains 5,563 crashes with only a single vehicle involved on Taiwan freeways from 
2003 to 2007. The crash severity is defined by the most serious injured victims in a crash. Crash 
severities are classified into three degrees: A1 (fatality), A2 (injury), and A3 (property-damage 
only). Table 1 presents the detailed crash information, from which the potential explanatory 
variables are identified. The numbers of cases in three degrees of crash severity are 226, 1,593, and 
3,744, respectively. This distribution is quite uneven, which is commonly seen in different countries. 
In this study, 70% of the one-vehicle crash cases are randomly chosen for training (i.e., 3,895 cases) 
and the remaining 1,668 cases are used for validation. A χ2-test is performed and the result shows 
that severity distributions between training and validation datasets do not differ significantly. 
 
表 Y04                                         第 72 頁
Table 1 Crash data summarized from police accident investigation reports (Cont.) 
Number of crashes Variable Definition Type Description 
A1 A2 A3 
x18 Action Categorical 1, forward;  
2, left lane-change; 
3, right lane-change;  
4, urgent deceleration or stop;  
5, others 
180 
7 
10 
3 
26 
1272
93
107
40
81
3055
189
241
117
142
x19 Alcoholic use Categorical 1, no;  
2, under 0.25 mg/l (or 0.05%);  
3, over 0.25 mg/l (or 0.05%);  
4, cannot be tested;  
5, unknown 
117 
12 
47 
37 
13 
1262
62
234
15
20
3295
75
343
20
11
x20 Journey purpose Categorical 1, work trip or school trip;  
2, business trip;  
3, transportation activity;  
4, visiting/shopping; trip  
5, others or unknown 
23 
7 
42 
27 
127 
190
97
196
204
906
467
224
583
382
2088
x21 Major cause Categorical 1, improper lane-change; 
2, speeding; 
3, fail to keep a safe distance; 
4, alcoholic use; 
5, fail to pay attention to the front; 
6, other driver’s liability; 
7, factors not attributed to drivers 
2 
49 
4 
41 
17 
87 
26 
77
168
24
226
104
699
295
172
496
152
323
277
1736
588
y Severity Categorical 1, fatality; 2, injury; 3, no-injury 226 1593 3744
 
 
3. GENETIC MINING RULE MODEL 
 
Genetic mining rule (GMR), which can automatically learn of comprehensive rules from available 
dataset and toward decision support, is useful in accident analysis (Clarke et al., 1998). The 
encoding method, fitness function, genetic operators, and rule selection of the GMR model 
proposed by Chiou et al. (2010b) are employed in this study, briefly narrated as follows. 
 
3.1 Encoding Method 
 
To represent the relationship between explanatory variables and crash severity, each chromosome is 
used to represent a potential if-then rule. The associated conditions in the “if part” are termed as 
antecedence part and those in the “then part” are named as consequent part. The antecedent part 
consists of at least one variable, at most 21 variables, which are selected from Table 1. The 
consequent part is composed by only one variable, i.e., the severity degree. In general, a rule is a 
knowledge representation of the form “if A then C,” where A is a set of cases satisfying the 
conjunction of predicting attribute values and C is a set of cases with the same predicted degree. 
 
By encoding a rule as a chromosome, each gene is used to represent a corresponding variable. Since 
the number of potential variables of antecedent and consequent is respectively 21 and one, the 
length of a chromosome is 22. Each gene will then take one of the categorical values of the 
corresponding variable. Because the ranges of all variables are different, the ranges of gene values 
also vary. Moreover, if a gene in a rule antecedent takes a value of 0, it represents the corresponding 
variable not considered by the rule. 
 
 
 
3.2 Fitness Function 
 
An individual chromosome (a rule) with higher fitness function value will have a higher probability 
being selected to reproduce the offspring. The role of fitness function is to evaluate the quality of 
the rule numerically. Shin and Lee (2002) adopted hit ratio (confidence) as the fitness function 
表 Y04                                         第 74 頁
 
Figure 1 The encoding and selection of rules 
 
3.4 The Mined Rules 
 
The parameters of the proposed GMR model are set as follows: population size=50, crossover 
rate=0.85, mutation rate=0.08, and maximum number of generations=1,000 (the stopping criterion). 
The number of rules to mine is 55. 
 
Theoretically, the misclassification rate can be monotonically lowered to zero by increasing the 
number of rules in the GMR model. A good classification model should fit the training data well; it 
should also accurately classify the records it has never seen before. To avoid over-fitting, 38 rules 
are selected in the GMR model because the misclassification rate of validation data hit the lowest 
value. In the training dataset, the proposed GMR model can actually predict the A3 crash (correct 
rate 80.77%), followed by A2 crash (64.90%) and A1 (53.13%). The overall correct rate of the 
proposed GMR model in training has reached 75.10%. In the validation dataset, on the other hand, 
the overall correct rate has achieved 73.80%. Table 2 shows the final selected rules and the 
corresponding performance indices. Table 3 reveals the number of cases with each severity level 
predicted by GMR model. 
 
Most of the rules could be readily inspected and explained by the if-then relationship of the rules 
themselves. Taking R7 as an example, this rule indicates that when speed limit is 40~60 KPH and 
driver’s age is over 65, it tends to lead to A2 crash. As for R1, when safety belt is not fastened and 
the driver is speeding, it tends to cause A1 crash. In contrast, R37 suggests that when safety belt is 
fastened, the crash tends to be less severe (A3 crash). The rest may be deduced by analogy. 
Table 2 Rules mined by the GMR model 
Rules x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15 x16 x17 x18 x19 x20 x21 y CRi PAi 
R1          2           2 1 11 0.727 
R2           3           1 106 0.613 
R3                   4   1 47 0.426 
R4 1            1        2 1 97 0.196 
R5   1 1  3        2  1      1 75 0.080 
R6             1   2  1 1   1 267 0.064 
R7 1     1 4  1     5     1   2 6 1.000 
R8   1 1   2   1   1 1 5   1   4 2 12 0.917 
R9    2         3         2 12 0.917 
R10   2    1     1    1  2    2 10 0.900 
R11 1  1            3 1   3   2 12 0.833 
R12    1         1  5 2 2     2 6 0.833 
R13 1    1   1  3 3    2       2 6 0.833 
R14                 5  3   2 12 0.833 
R15   1   3   3    1   1  1    2 11 0.818 
R16    1   2  1     4    1  5 7 2 16 0.813 
R17    1   1     2     1     2 16 0.813 
表 Y04                                         第 76 頁
other hand, those belonging to the set of upper approximation but not to the set of lower 
approximation cannot be fully identified by the elementary sets in A*. 
 
As illustrated in Table 4, five cases are characterized with three condition attributes: driver’s age, 
vehicle type and weather, and one decision attribute: crash severity. The three condition attributes 
form four elementary sets: {1, 3}, {2}, {4}, {5}. This means that cases 1 and 3 are indiscernible 
while the other cases are characterized uniquely with all available information. Therefore, the fatal 
accident type is described with the lower approximation set {2} and the upper approximation set {1, 
2, 3}. Similarly, the concept of the injury accident type is characterized by its lower approximation 
set {4, 5} and upper approximation set {1, 3, 4, 5}. The performance of the specified condition 
attributes can be measured with two indicators: accuracy of approximation and quality of 
approximation. Accuracy of approximation represents the percentages of the associated objects 
definable with the specified condition attributes. This can be defined as follows: 
 
Table 4 Example of crashes with three factors 
Case Driver occupation Vehicle type Weather Severity 
1 In job Passenger car Rainy A1 
2 Jobless Truck Rainy A1 
3 In job Passenger car Rainy A2 
4 Student Passenger car Rainy A3 
5 Student Truck Sunny A2 
 
( ) ( ) ( )AYAYYA cardcard=μ                                            (4) 
 
where card refers to cardinality. The accuracy value ranges from 0 to 1. The closer to 1 is the 
accuracy, the more discernible is the accident type. Namely, more cases of this accident type are 
discernible by the elementary sets generated by the specified condition attributes. It implies that the 
associated crash severity do exist unambiguously. Following Table 4, the accuracy of 
approximation for the fatal class is 0.33(=1/3) and for the injury class is 0.50(=2/4). This implies the 
injury class can be defined more unambiguously than the fatal class with the provided three 
condition attributes. On the other hand, quality of approximation represents the definable 
percentage of the whole universe. Let X = {Y1,Y2, ... ,Yn} be a classification of U, i.e. Yi ∩Yj = φ, ∀i, 
j≤n i ≠ j and UYi
n
i ==1U . Yi are called classes of X. The A-lower approximation and A-upper 
approximation of X are represented by sets AY  = { 1AY , 2AY , ... , nAY } and AY  = 
{ 1AY , 2AY , . . . , nAY }, respectively. Quality of approximation of classification X by a set of 
attributes can be defined as follows: 
 
( ) ( ) ( )UAYY iA cardcardU=η                                           (5) 
 
The value of quality ranges from 0 to 1. The closer to 1 is the quality, the more objects of the 
universe clearly belong to a single class of X, suggesting that the crash severity for all accidents can 
be clearly identified. Accidents thus can be more accurately recognized and corresponding 
countermeasures devised. The quality of approximation for the example is 0.60(=3/5), suggesting 
that with the provided three condition attributes 60% of the cases can be unambiguously defined. 
To recognize further the details of crash severity, rules need to be extracted. A rule, representing the 
critical characteristics of the associated accidents, is a combination of values of condition and 
decision attributes. Theoretically, the maximum number of rules is the product of the categories of 
all condition attributes. However, some combinations may not appear since such accidents have 
表 Y04                                         第 78 頁
Vehicle characteristics 
Vehicle type (truck; bus) 0.232 4.55 
Action (others) 0.166 1.74 
Crash characteristics 
Location (shoulder edge; median) 0.168 3.04 
Major cause (fail to keep a safe distance) -0.506 -3.54 
Travel period (midnight to morning) 0.109 2.25 
Environmental characteristics 
Speed limit  0.277 2.15 
Road status (grade and curved road) 0.247 1.93 
Marking (no lane-changing line) 0.381 2.48 
Surface condition (dry) 0.187 4.25 
Obstacle (work zone; others) -0.214 -2.40 
Light (nighttime without illumination) 0.117 2.21 
Goodness of fit measures 
Mean Loglikelihood (null model) -0.756 
Mean Loglikelihood (convergence) -0.707 
Adjusted rho-square  0.065 
BIC 5654.052 
AIC 5543.238 
Note: The significance (t-value) of independent variables is above 1.645. 
 
表 Y04                                         第 80 頁
 
In fact, from the comparison of overall hit rates of the three models, the performance of the GMR 
model is better than that of the OP model while the performance of the RS model is the worst. Yet, 
this is not the main purpose of this study. It is attempted in this paper to synthesize the information 
provided by the three models and to discover the key factors affecting crash severity. Although this 
summed-up ranking method may not be very robust or logical, it provides a preliminary way to be 
applied and could still be further improved by proper adjustment. 
 
By looking into the values of these key risk factors, we can further explore the risk conditions 
causing the fatal crashes. For x21 (major cause), speeding is the most dangerous condition. Hence, 
strict and intensive enforcement on speeding should be an effective countermeasure. For x13 (driver 
occupation) and x14 (driver age), student and elderly drivers are vulnerable to fatal crashes due to 
their immature driving skills and experiences (for student drivers) and their descending physical 
conditions and reactions to crashes (for elderly drivers). Driver training courses and driving safety 
promotion programs therefore can be introduced to universities (student drivers) and communities 
(elderly drivers). 
 
Table 8 Rankings of factors by the GMR, RS and OP models 
Discriminative factors Risk factors Factors GMR RS OP Total Rank GMR RS OP Total Rank
x1 5 13 3 21 6 5 15 10 30 11
x2 21 21 18 60 21 13 20 18 51 21
x3 12 12 18 42 15 5 13 18 36 15
x4 10 9 18 37 12 5 12 18 35 14
x5 17 16 10 43 17 13 21 8 42 19
x6 8 7 13 28 10 5 8 16 29 9
x7 5 5 14 24 7 13 6 5 24 7
x8 20 15 15 50 19 13 17 6 36 15
x9 14 18 9 41 15 13 19 4 36 15
x10 16 20 1 37 13 5 15 1 21 5
x11 18 19 18 55 20 5 13 18 36 15
x12 12 17 16 45 18 13 18 12 43 20
x13 1 6 7 14 1 1 2 9 12 2
x14 8 3 8 19 5 5 5 2 12 2
x15 3 1 12 16 4 13 4 17 34 13
x16 2 8 5 15 2 1 6 13 20 4
x17 3 10 2 15 2 13 9 7 29 9
x18 10 11 17 38 14 5 9 14 28 8
x19 5 13 6 24 7 1 11 11 23 6
x20 15 4 11 30 11 13 2 15 30 11
x21 18 2 4 24 7 1 1 2 4 1
 
7. CONCLUSIONS 
 
In this paper, contributory factors to one-vehicle crash severity in Taiwan freeways are identified 
and compared by the proposed GMR and RS models, and a conventional statistical method—the OP 
model. The three models have identified rather different key factors. According to the synthesized 
rankings by the three models, the top three discriminative factors are x13 (driver occupation), x16 
(location), x17 (vehicle type), suggesting that these three variables should be considered in modeling 
crash severity and the related information should be more carefully collected for accident analysis. 
In the same vein, the top three risk factors are x21 (major cause), x13 (driver occupation), and x14 
(driver age). Accordingly, more intensive enforcement on speeding and more education programs 
表 Y04                                         第 82 頁
Greco, S., Matarazzo, B. and Slowinski, R. (2001) Rough sets theory for multicriteria decision 
analysis, European Journal of Operational Research 129, 1-47. 
Grzymala-Busse, J.W. (1992) LERS—A System for Learning from Examples Based on Rough Sets, 
Handbook of Applications and Advances of the Rough Sets Theory, Kluwer Academic 
Publisher, Dordrecht. 
Grzymala-Busse, J.W. and Werbrouck, P. (1998) On the best search method in the LEM1 and LEM2 
algorithms. In: Orlowska, E. (Ed.), Incomplete Information: Rough Set Analysis, 
Physica-Verlag, Heidelberg, New York, 75–91. 
Herrera, F., Lozano, M. and Verdegay, J.L. (1998) A learning process for fuzzy control rules using 
genetic algorithms, Fuzzy Sets and Systems 100, 143-158. 
Kim, M.J. and Han, I. (2003) The discovery of experts’ decision rules from qualitative bankruptcy 
data using genetic algorithms, Expert Systems with Applications 25, 637-646. 
Michalewicz, Z. (1992) Genetic Algorithms + Data Structures = Evolution Programs, Springer, 
Berlin. 
Milton, J., Shankar, V. and Mannering, F. (2008) Highway accident severities and the mixed logit 
model: An exploratory empirical analysis, Accident Analysis and Prevention 40, 260-266. 
O’Donnell, C.J. and Connor, D.H. (1996) Predicting the severity of motor vehicle accident injuries 
using models of ordered multiple choice, Accident Analysis and Prevention 28, 739-753. 
Pai, C.W. and Saleh, W. (2007a) Exploring motorcyclist injury severity resulting from various 
crash configurations at T-junctions in the UK－an application of the ordered probit models, 
Traffic Injury Prevention 8, 62-68. 
Pai, C.W. and Saleh, W. (2007b) An analysis of motorcyclist injury severity under various junction 
control measures at three-legged junctions in the UK, Safety Science 45, 832-847. 
Pai, C.W. and Saleh, W. (2008) Exploring motorcyclist injury severity in approach-turn collisions 
at T-junctions: Focusing on the effects of driver’s failure to yield and junction control measures, 
Accident Analysis and Prevention 40, 479-486. 
Pawlak, Z. (1982) Rough sets, International Journal of Computer and Information Science 11, 
341–356. 
Shanker, V. and Mannering, F. (1996) Statistical analysis of accident severity on rural freeways, 
Accident Analysis and Prevention 28, 728-741. 
Shin, K.S. and Lee, Y.J. (2002) A genetic algorithm application in bankruptcy prediction modeling, 
Expert Systems with Applications 23, 321-328. 
Sze, N.N. and Wong, S.C. (2007) Diagnostic analysis of the logistic model for pedestrian injury 
severity in traffic crashes, Accident Analysis and Prevention 39, 1267-1278. 
Tay, R. and Rifaat, S.M. (2007) Factors contributing to the severity of intersection crashes, Journal 
of Advanced Transportation 41, 245-265. 
Wong, J.T. and Chung, Y.S. (2007) Rough set approach for accident chains exploration, Accident 
Analysis and Prevention 39, 629-637. 
 
表 Y04                                         第 84 頁
1.本會議規模雖小，但與會來賓有許多是國際知名期刊之主編或編輯委員，研究能量也都
相當驚人，能藉由開會之便，結識他們，進而培養學術合作之機會，對未來學術研究發
展將有相當大之助益。 
 
2.對於國際研討會學術論文之發表，英文能力之培養相當重要，不論是學術論文之寫作或
發表，乃致於與國際友人之談論，均需要一定程度英文能力，因此，努力提昇英文能力
與積極參與國際學術活動，為國內學者與在學博士班學生刻不容緩之發展方向。 
 
3.斯里蘭卡為印度大陸旁之一島國，面積約為台灣之兩倍，人口約 1 千 9 百萬人，識字率
達 92%，與台灣相當類似。但其國民所得才 900 美元（雖已是南亞第一高），與我國相
距甚遠，此與該國人民民族性及長期內戰有關。因此，當地之與會人員，均相當羡慕台
灣的經濟發展，極想學習台灣經驗。過去斯里蘭卡長期為英國殖民地，人民普遍能以英
語交談，大學以上教育也多以英文授課，此為該國未來發展之優勢。惟其英文口音甚重，
在交談上頗為費力。因此，多參與國際研討會，並多與西方國家，乃至於印度、印尼、
中東等國之代表交談，方能培養國際觀及溝通能力。 
 
4.目前台灣並無直飛斯里蘭卡之航班，國籍航空公司甚至未提供此一航線服務。因此，本
人此次係搭乘國泰航空公司，經香港及曼谷兩次轉機後，方能到達。由於斯里蘭卡國際
機場到達或離開航班之時段均在當地時間凌晨或深夜。例如，本次到達斯里蘭卡為當地
時間晚上 12:20，離開則為凌晨 12:40。因此，到此地開會之學者，宜預留會議前後時間，
並保留體力，以資因應。 
 
三、建議 
 
ICAHETS & TRF 相關會議規模雖小，但與會人員在國際運輸領域之學術研究上，均具有一定地位，且本會發表之學術論文均具
相當水準，具學術潮流之指標作用。因此，建議國內相關科系教授與學生可積極參加此一會議，以建立學術人際網絡，拓展個
人的學術視野與人際關係，促進國際學術合作之機會，俾利國內學術研究水準之提昇。 
 
四、攜回資料名稱及內容 
 
1. INCOTALS & TRF 投稿摘要彙編 
2. INCOTALS & TRF 全文光碟片及會議照片 
3.會議相關資料 
 
五、其他 
 
此次發表論文之機票、註冊及生活費承國科會專題計畫 (計畫編號： NSC
97-2628-E-009- 035-MY3)部份補助，本人特此感謝。 
 
表 Y04                                         第 86 頁
 
Most previous GFLC studies, however, have employed GAs either to calibrate the membership 
functions with preset logic rules or to select the logic rules with given membership functions. Thus, 
the applicability of that GFLC is very likely reduced. However, to simultaneously or sequentially 
learn of logic rules and membership functions may require a rather lengthy chromosome and large 
search space, resulting into poor performance, a long convergence time and unreasonable learning 
results (i.e. conflicting or redundant logic rules, irrational shapes of membership functions). To 
avoid these shortcomings, this paper proposes a stepwise evolution algorithm to learn both logic 
rules and membership functions. At each learning process, the proposed algorithm selects one logic 
rule which can best contribute to the overall performance controlled by previously selected logic 
rules combined with this selected rule. Such a selection procedure will be repeated until no other 
rule can ever improve the control performance. Therefore, the incumbent combination of logic rules 
is the optimal learning results. 
 
However, to develop a SGFLC-based signal control requires an efficient traffic simulation 
model to replicate traffic behaviors and determine the performance of the control logic. Although 
many studies use microscopic traffic simulation software to evaluate the performances of signal 
control models, such as CORSIM (Tian and Urbanik, 2007; Mussa and Selekwa, 2003), SimTraffic 
(Lin et al., 2009), AIMSUN (Fang and Elefteriadou, 2006), VISSIM (Xu amd Zheng, 2009), 
MITSIMLab (Ben-Akiva et al., 2003), INTEGRATION (Dion et al.; 2004; Li and Prevedouros, 
2004), and PARAMICS (Liu et al., 2002; Choy et al., 2002). However, it would be too 
time-consuming to use as such simulation software for the evolution of genetic generations. Thus, 
this paper employs a cell transmission model (CTM), proposed by Daganzo (1994, 1995), to 
evaluate the performance of learned logic rules and tuned membership function. Besides, the 
conventional CTM was designed for pure traffic. Incorporation of more realistic CTM rules into the 
simulation of mixed traffic (various types of vehicles such as cars and motorcycles) on urban streets 
is comparatively less addressed. Based on this, this study conducted mixed traffic cell transmission 
models (MCTM), proposed by Chiou and Hsieh (2011), to replicate the behaviors of mixed traffic 
consisted of cars and motorcycles. The MCTM model uses the ratio of car to motorcycle in the last 
upstream cell to determine the amount of roadway resources (i.e. max flow capacity and storage 
capacity) allocated to cars, and vice versa for motorcycles. In order to describe the relationship 
between cars and motorcycles more realistic. The MCTM model further incorporates an entropy 
index to adjust the traffic speed, since the interferences between two types of vehicles will be 
rapidly increased as the mixture ratio of cars and motorcycles becomes higher. 
 
Based on this, this paper aims to develop an adaptive signal control model for both isolated and 
sequential intersections based on the proposed stepwise genetic fuzzy logic controller (SGFLC) 
with a mixed traffic cell transmission modeling (MCTM) approach. The paper is organized as 
follows. Section 2 briefs the rationales for signal control with a SGFLC model and MCTM model. 
Section 3 utilizes experimental cases to validate the effectiveness and robustness of the proposed 
SGFLC model in controlling the signal at an isolated intersection. Section 4 further validates the 
effectiveness of the SGFLC model in controlling the signal of arterial coordinated sequential 
intersections. Finally, the concluding remarks and suggestions for future research follow. 
 
2. The rationales 
 
2.1. The stepwise GFLC model 
 
The encoding methods, genetic operators and stepwise evolution algorithm for the stepwise GFLC 
model are briefly described as follows. 
 
(1) Encoding logic rules and membership functions 
表 Y04                                         第 88 頁
G4t+1 with g4kt+1=max{gwkt, gvkt}           (8) 
 
where a is a parameter (0 < a < 1) and t is the number of generations. In the non-uniform mutation, 
let Gt = { g1t ,…, gkt ,…, gKt } be a chromosome and the gene gkt be selected for mutation (the 
domain of gkt is [gkl, gku]), the value of gkt+1 after mutation can be computed as follows 
(Michalewicz, 1992): 
⎩⎨
⎧
=−Δ−
=−Δ+=+
1),(
0),(1
bifggtg
bifggtgg
l
k
t
k
t
k
t
k
u
k
t
kt
k 　　　
　　　
        (9)
 
where b randomly takes a binary value of 0 or 1. The function ),( ztΔ  returns a value in the range 
of [0, z] such that the probability of ),( ztΔ  approaches to 0 as t increases: 
)1(),( )/1(
hTtrzzt −−=Δ              (10) 
where r is a random number in the interval [0,1], T is the maximum number of generations and h is 
a given constant. In Eq. (10), the value returned by ),( ztΔ  will gradually decrease as the evolution 
progresses. 
 
(3) The stepwise learning algorithm 
 
The core logic of the proposed stepwise algorithm in selecting the logic rules with the membership 
functions is similar to the stepwise regression model in selecting explanatory variables. At each 
stage, a new logic rule which can best increase the control performance by combining with the rules 
selected in previous stages is selected. The selection process continues until the control performance 
cannot be significantly improved by introducing any other rule. The stepwise learning algorithm is 
structured as follows: 
Step 0: Initialization: s=1. The rule combination set, SRs, is an empty set. 
Step 1: Update rule combination set. SRs= SRs-1+ Rs. 
Step 2: Tuning membership functions. 
Step 2-1: Generating an initial population with p chromosomes. Each chromosome representing a 
logic rule has 12(n+1) genes and each gene randomly takes one integer from [0, 9]. 
Step 2-2: Calculating the fitness values of all chromosomes based on the logic rule representing by 
the chromosome and previously selected logic rules. 
Step 2-3: Selection. 
Step 2-4: Crossover. 
Step 2-5: Mutation. 
Step 2-6: Testing the stop condition. Let Rs be the chromosome with largest fitness of fs among the 
population for the sth evolution epoch. The stop condition is set based on whether the 
mature rate has reached a given constant η. If so, proceed to Step 3 and let s=s+1; 
otherwise go to Step 2-3. 
Step 3: Testing the stop condition. If (fs - fs-1) ≦ε, where ε is an arbitrary small number, then stops. 
Incumbent rule combination set, SRs, is the optimal learning results. Otherwise, go to Step 1. 
 
2.2. The signal control 
 
(1) Fitness value 
The performances of signal control for an isolated intersection or sequential intersections are 
commonly measured in terms of total number of stopped vehicles, proportion of stopped vehicles, 
average vehicle delays, total vehicle delays, maximal green band, etc. This paper sets the total 
vehicle delays (TVD) as the control performance index and thus defines the fitness function of GAs 
as: 
TVD
f 1=                (11) 
表 Y04                                         第 90 頁
Gmin EGT1 EGT2 AR
R AR Gmin
R
EGT1 EGT2 EGT3
AR
AR
Time
Time
East-west directions
North-south directions
TF1 TF2 TF3
TF1 TF2 TF3 TF4
QL1 QL2 QL3 QL4
QL1 QL2 QL3
Legend : Activation point : Red phase : Green phase : All red 
 
(a) Isolated intersection 
 
CYCLE LENGTH 
Gmin
Legend : Activation point : Red phase : Green phase : All red 
Gmin
Gmin
EGT1
EGT2 EGT3
AR
AR
AR
AR
AR
AR
R
R
R
Gmin
Gmin
Gmin
Gmin
G
GAR
AR
AR AR
AR
AREGTA
EGTA
EGTA
R
R
R Rmin
Rmin
Rmin
Time
Time
Arterial
Competing approach
Intersection I
Intersection II
Intersection III
Intersection II
Intersection III
Intersection I
QLB1
TFA1
QLB2
TFA2
QLB2
TFA2
QLB3
TFA3
QLB3
TFA3
TFB1+TFB2+TFB3
QLA1+QLA2+QLA3 QLA1+QLA2+QLA3
TFB1+TFB2+TFB3
 
(b) Sequential intersections 
Fig. 2. Activation points for an isolated intersection and sequential intersections. 
 
2.3. The mixed traffic cell-transmission model 
 
Previous works often employ microscopic traffic simulation models to evaluate the performance of 
signal control models. However, it would be too time-consuming for the evolution of genetic rule 
selections. To facilitate the learning process of the proposed SGFLC model, an efficient traffic 
simulator is imperial to evaluate the performance of selected logic rules and tuned membership 
functions in a short period. Based on this, a cell-based traffic simulator, CTM, is considered. CTM, 
proposed by Daganzo (1994; 1995) for simulating traffic hydrodynamic behavior, uses several 
simple equations to govern traffic movements along the roadway which is represented by a series of 
equal-length cells. These equations are expressed as follows: 
)()()()1( 1 tytytntn iiii +−+=+            (12) 
表 Y04                                         第 92 頁
)()(
)())((
11
1
1 tnltn
tnltnp c
i
m
i
c
i
i
c
−−
−
− ×+
×=
           (20) 
)()(
)())((
11
1
1 tnltn
tntnp c
i
m
i
m
i
i
m
−−
−
− ×+=            (21) 
where, l=area of a car /area of a motorcycle 
 
(3) Remaining storage capacity ( )()( tntN ii − ) competition between cars and motorcycles 
This competition behavior occurs when remaining storage capacity in the downstream cell can not 
accommodate all vehicles transmitting from the upstream cell (i.e. )()( 11 tSntnl i
m
i
c
i ≥+× −− ). In 
addition, the motorcycles can still “sneak” into the downstream cell when remaining storage 
capacity can not accommodate a car. In order to reflect this phenomenon, a congestion index (δ) is 
introduced to determine how the remaining storage space ( )(tSi ) is allocated: 
)]}()([)({)( tntnltNtS mi
c
iii +×−×= δ           (22) 
where
 
( ) ( )
( ) ( )
1 1
1 1
( )     
( ) 
c m
i i mi
c m
i i mi
n t n t q t
w n t n t q t
v
α
δ α
− −
− −
⎧ + × ≤⎪= ⎨ + × >⎪⎩
1   if 
   if  
 
Consider a space competition function, ))(),(( 11 tntnR
m
i
c
i
S
m −−  which allocates remaining storage space 
between cars and motorcycles moving from upstream to downstream. The remaining storage 
capacity is then allocated to cars ( )(tS ci ) and motorcycles ( )(tS
m
i ) is expressed as: 
)())(),(()( 11 tStntnRtS i
m
i
c
i
S
m
c
i ×= −−            (23) 
l
tStntnRtS i
m
i
c
i
S
mm
i
)())](),((1[)( 11 ×−= −−           (24) 
 
Logghe and Immers (2008) indicated that the higher density of vehicles of class i on road has 
advantage to move forward. Thus, the competition functions can be expressed as: 
)(
)())(),((
11
1
11 tnln
tntntnR c
i
m
i
m
im
i
c
i
S
m
−−
−
−− ×+=           (25) 
 
In sum, based on the pure traffic CTM proposed by Daganzo in Eqs. (12) and (13), the mixed traffic 
CTM with cars and motorcycles proposed by Chiou and Hsieh (2010) can replicate mixed traffic by 
Eqs. (26) and (27). 
)()()()1(
)()()()1(
1
1
tytytntn
tytytntn
m
i
m
i
m
i
m
i
c
i
c
i
c
i
c
i
+
+
−+=+
−+=+
           (26) 
)}())(),((,)]())(),(([),(min{)(
})())](),((1[),())](),((1[),(min{)(
11
11
1
11
111
tStntnRtqtntnRtnty
l
tStntnRtqtntnRtnty
i
m
i
c
i
S
m
mi
m
i
c
i
Q
mm
i
m
i
i
m
i
c
i
S
m
mi
m
i
c
i
Q
m
c
i
c
i
××=
×−×−=
−−
−−
−
−−
−−−
α
 (27) 
 
3. Isolated Intersection 
 
To investigate the effectiveness and robustness of the proposed signal control model, comparisons 
to two pre-timed models and two adaptive models are conducted. 
 
表 Y04                                         第 94 頁
Model 1  TFC,TFM,QLC and QLM 60 46.67 5 
Model 2 TFP and QLP 76 52.02 8 
Model 3 TFV and QLV 90 52.15 7 
 
The learning process of the Model 1 is depicted in Fig. 5 (a). Note that SGFLC converges after five 
stepwise evolutions with a total of 60 generations progressed. The value of TVD decreases from 
66.47 to 46.67 veh-hour. A total of five rules are selected after five stepwise evolutions. Fig. 5(b) 
presents the optimally selected five logic rules along with corresponding tuned membership 
functions. 
 
45
50
55
60
65
70
1 10 19 28 37 46 55
Generations
TVD
 
(a) Learning process 
 
Rule 1: If TFC= and QLC= then EGT=
Rule 2: If TFC= and QLC= then EGT=
Rule 3: If TFC= and QLC= then EGT=
Rule 4: If TFC= and QLC= then EGT=
Rule 5: If TFC= and QLC= then EGT=
and TFM=
and TFM=
and TFM=
and TFM=
and TFM=
and QLM=
and QLM=
and QLM=
and QLM=
and QLM=
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFC  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFC  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFC  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFC  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFC  (vehicles/hr)
μ
NL
PL
PS
ZE
NS
0
0.2
0.4
0.6
0.8
1
0 20 40 60 80
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 20 40 60 80
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 20 40 60 80
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 20 40 60 80
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 20 40 60 80
QLC  (vehicles)
μ
PL
ZE
NL
PS
NS
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
NL
PL
PS
ZE
NS
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20 25
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 600 1,200 1,800 2,400 3,000 3,600
TFM  (vehicles/hr)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20 25
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20 25
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20 25
QLC  (vehicles)
μ
PL
ZE
NL
PS
NS
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
EGT  (seconds)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20 25
QLC  (vehicles)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
EGT  (seconds)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
EGT  (seconds)
μ
0
0.2
0.4
0.6
0.8
1
0 5 10 15 20
EGT  (seconds)
μ
ZE
PL
NL
PS
NS
 
(b) Selected logic rules and tuned membership functions 
Fig.5. Learning process and results of the SGFLC model at the experimental intersection 
 
3.3 Model validation and comparisons 
 
To validate the effectiveness, the control performance of stepwise GFLC model is compared with 
two pre-timed models: optimal single (OS) and optimal multiple (OM) and two adaptive models: 
vanishing queue (VQ) and maximum queue (MQ). Where the OS timing plan is determined by total 
enumeration method to search for an optimal cycle length and green time during the study period. 
The OM timing plan comprises seven optimal single timing plans depends on traffic flow pattern as 
shown in Fig 4. Since the OM model designs the optimal signal timings for each of traffic flow 
rates, its control performance is optimal for the given traffic pattern. The VQ model proposed by 
Lin and Lo (2008) is an actuated control system by switching traffic signal to serve the other 
approach whenever the queue on the current approach vanishes; while the MQ model switches 
traffic signal to serve the other approach when the queue length on the that approach reaches a 
preset maximum queue. In this paper, the maximum queue length is optimized via a try-and-error 
manner. 
 
Rule-1 
Rule-2 
Rule-3 
Rule-4 Rule-5 
表 Y04                                         第 96 頁
intersections, three coordinated signal systems including simultaneous, alternate, and progressive 
systems are considered. The simultaneous system implements exactly the same signal timing plans 
simultaneously in sequential intersections without offset (time lag). The progressive system 
implements these plans with offset. The alternative system implements two timing plans with 
inverse green and red times. In addition, an independent operation which implements the timing 
plans at the sequential intersections without any coordination is also compared. The timing plans of 
these four signal systems are determined by the SGFLC model, the VQ model and the MQ model, 
respectively. 
 
4.1 Model training 
 
The coordinated sequential intersections control flowchart is shown in Fig. 7. The control objects 
can be class as arterial signal control and competing approach signal control. The core of arterial 
signal controller is trained as isolated intersections. In other words, the control variable (EGT) is 
determined individually, depends on state variables in each intersections. On the other hand, the 
core of competing approaches signal controller is trained as integrate intersections. The EGT of 
competing approach was determined by traffic flow of car and motorcycle with all competing 
approaches and queue length of car and motorcycle along the arterial.  
 
 
Fig. 7. Learning and controlling process for three coordinated intersections 
 
An experimental example with three consecutive four-leg intersections (Fig. 8) is demonstrated. 
Assume that the intersections have two lanes in each approach with saturation flow of 
1800pcu/hr/lane. The distance between intersections 1 and intersection 2 is 139 meters (5 cells). 
The distance between intersections 2 and intersection 3 is 222 meters (8 cells). The five-minute 
flow rates in different approaches are shown in Fig. 9. Noticeable peak and off-peak traffic patterns 
are assumed in east and west directions. The offset of progressive coordinated system are 10 
seconds and 16 seconds, since the average travel speed between intersections is set as 50 km/hr. 
 
表 Y04                                         第 98 頁
performance measurement. Under different levels of details of state variable measurement, the 
proposed SGFLC model can perform better if more detailed levels of state variables are considered. 
In the other words, under mixed traffic conditions, vehicle detectors should be able to accurately 
detect both traffic flows and queue length of cars and motorcycles. The comparison results show 
that the control performance of the SGFLC model is almost the same as the OM model, which is 
considered as the optimal control under given traffic patterns and is superior to the adaptive models 
for the case of an isolated intersection. Moreover, the SGFLC model can perform much better than 
any other models as the traffic flows vary more conspicuously, indicating the robustness of the 
SGFLC model. In the case of sequential intersections, the SGFLC performs better than the VQ 
model and MQ model, no matter which coordinated signal system is operated, indicating that the 
proposed SGFLC model is effective, robust and may applicable to real-time signal control. 
 
The proposed stepwise algorithm is to select rules sequentially. However, an early selected rule may 
not be necessary to be the one of rules in the optimal rule combination. More effective and efficient 
encoding methods in selecting the logic rules or tuning the membership functions or both deserve to 
be explored. In addition, for sequential intersections, the control performance is measured by TVD 
in this paper. Other performance indices, such as maximum green band, minimum stopping rate, 
and maximum throughput, deserve to be adopted and examined. Moreover, in this study, only 
simple two phase signal control plan is considered. Multi-phase signal control plans with 
consideration of turning flows at intersections deserves to be developed. Last but not least, the 
mixed-traffic condition including motorcycles, cars, trucks and buses, should be considered in 
signal control model. 
 
REFERENCES 
 
Chou, C.H. and Teng, J.C. (2002) A fuzzy logic controller for traffic junction signals. Information 
Sciences 143, 73-79. 
Chiou, Y.C. and Lan, L.W. (2005) Genetic fuzzy logic controller: an iterative evolution algorithm 
with new encoding method. Fuzzy Sets and Systems 152, 617-635. 
Chiou, Y. C. and Hsieh, C.W. (2011) “Mixed traffic cell transmission models: development and 
validation,” Journal of the Chinese Institute of Transportation. (In press) 
Chiou, Y.C., and Huang, Y.F. (2010) “Genetic fuzzy logic traffic signal control with a stepwise 
learning algorithm,” presented at the 15th Conference of Hong Kong Society for 
Transportation Studies, Hong Kong, China, Dec. 11-14. 
Daganzo, C. (1994) The cell transmission model: A dynamic representation of highway traffic 
consistent with the hydrodynamic theory. Transportation Research Part B 28, 269-287. 
Daganzo, C. (1995) The cell transmission model, part II: network traffic. Transportation Research 
Part B 29, 79-93. 
Favilla, J., Machion, A. and Gomide, F. (1993) Fuzzy traffic control: adaptive strategies. 
Proceedings of the Second IEEE International Conference on Fuzzy Systems, San Francisco, 
506-511. 
Herrera, F., Lozano, M., Verdegay, J.L. (1995) Tuning fuzzy logic controllers by genetic algorithms. 
International Journal of Approximate Reasoning 12, pp.299-315. 
Hoyer, R. and Jumar, U. (1994) An advanced fuzzy controller for traffic lights. Annual Review in 
Automatic Programming 19, 67-72. 
Kim, J. (1997) A fuzzy logic control simulator for adaptive traffic management. Proceedings of the 
Sixth IEEE International Conference on Fuzzy Systems, Barcelona, 1519-1524. 
Lan, L. W., Chiou, Y.C., Lin, Z.S. and Hsh, C.C. (2010) Cellular automaton simulations for mixed 
traffic with erratic motorcycles’ behaviours. Physica A, Vol. 389, No. 10, pp. 2077-2089. 
Lin, W.H. and Lo, H.K. (2008) A robust quasi-dynamic traffic signal control scheme for queue 
management. Proceedings of the thirteenth international conference of Hong Kong Society for 
transportation studies, Hong Kong, 563-572. 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/10/17
國科會補助計畫
計畫名稱: 基因及螞蟻規則探勘模式－以事故分析及事故鑑定為例 
計畫主持人: 邱裕鈞 
計畫編號: 97-2628-E-009-035-MY3 學門領域: 交通運輸
無研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
兩篇研討會論文正投稿國際期刊 Accident Analysis and Prevention。該期刊
為運輸領域之頂級期刊，2010 年 Impact Factor 在 Transportation 領域排名
第一。 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
