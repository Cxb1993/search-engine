 2
Largrange. The time series data are analyzed in a purely mathematical way. In that 
case, many factors that may influence systems after the models have been built will be 
ignored.  
The forecasting accuracy can be increased by combining several different 
forecasting methods into one model [7, 11, 14]. The grey system combined with 
Markov forecasting models have been developed [5, 10, 12]. They used grey 
forecasting output as a base to classify state spaces of the Markov Chains. When the 
output is unreasonable, the classification of state spaces will be incorrect. The state 
spaces will influence the construction of probability transition matrices. In this paper, 
percentage error (PE) of the forecasting methods will be used as a base in order to 
divide state spaces of the Markov Chains. The percentage error measures the ratio of 
the forecasting error to actual. By using the information of percentage error to 
construct the probability transition matrices of the Markov Chains, the trouble can be 
shown if the output goes wrong. The Markov Chains process time series data in a 
probabilistic manner. By building Grey-Markov models, the shortcomings of the grey 
forecasting model can be improved.  
The purpose of this research is to explore more parameters that may influence 
forecasting accuracy of Grey-Markov models. How can the pattern of time series 
influence the accuracy of a forecasting system are not described in the researches 
mentioned above. The influences of stationary and non-stationary time series on 
accuracy of forecasting systems are also investigated in this paper. How many data 
points should be used to form a primitive sequence for a grey model is explored. The 
number of states that are used to calculate transition probability matrices is also 
investigated. In this study, the Grey-Markov models have proved that the models have 
higher accuracy than that of grey models under some cases. 
This paper is structured as follows: Section 2 describes the procedure and detail 
 4
value is chosen so that the most recent k  observed data are used to construct grey 
forecasting model, called k-period grey forecasting model. In this paper, 4- and 
7-period grey forecasting models are used. 
Step 2: transforming the original data sequence into a new sequence. A new 
sequence )1(x  is generated by the accumulated generating operation (AGO), where 
}, ................ ,,,{ )1()1(3
)1(
2
)1(
1
)1(
kxxxxx =                      (2) 
The )1(ix  is derived as follows: 
kixx
i
n
ni  ..., 3, 2, 1,   , 
1
)0()1( == ∑
=
                          (3) 
Step 3: building first order differential equation of the GM(1,1) model.  By 
transforming the original data sequence into a first order differential equation, the 
time series can be approximated by an exponential function. The grey differential 
model is obtained as 
bax
dt
dx =+ )1(
)1(
                                     (4) 
Where a  is the developing coefficient and b  represents the grey input. According 
to Eqs. (2) to (4), the parameters a  and b  can be estimated by the least squares 
method. The parameters aˆ  is represented as follows: 
k
TTT YBBBbaa 1)(],[ˆ −==                              (5) 
Where 
,  
1)(
2
1
1)(
2
1
1)(
2
1
)1()1(
1
)1(
3
)1(
2
)1(
2
)1(
1
⎥⎥
⎥⎥
⎥⎥
⎥⎥
⎦
⎤
⎢⎢
⎢⎢
⎢⎢
⎢⎢
⎣
⎡
+−
+−
+−
=
− kk xx
xx
xx
B
LLL
           
and     [ ]Tkk xxxY )0()0(3)0(2 ,,, LL=          
 6
desired: 
nmjiallforPPP
S
s
mn
sj
m
is
n
ij <<== ∑
=
− 0 and  S, ....., ,1 ,0,      ,  
0
)()()(        (8) 
Where S  denotes the state space and Ss∈ . The )(nijp  is the conditional probability 
that the initial state of a process is in state i , after exactly m  steps the process will 
be in state s ; and then the process will go to state j  in ( mn − ) steps. 
 
4. Grey-Markov forecasting models 
The Grey-Markov forecasting model can be distinguished into 5 steps: (1) 
calculate the grey forecasting predictor, (2) classify the states of a Markov Chain, (3) 
compute transition matrices and then (4) combine the grey forecasting predictor with 
transition matrices to obtain the Grey-Markov predictor. (5) Finally, the accuracy of 
grey forecasting models and Grey-Markov forecasting models are examined and 
compared. The details of these steps are described: 
 8
convenient value. If the number of classes is large, the width of the classes will be 
small, and vice versa. 
 The upper and lower limits of each state can be calculated after the number and 
width of classes have been decided. Each of observed data can only belong to one and 
only one state interval. The differences between the lower limits ( the upper limits ) of 
adjacent are the class width.  
Step 3: compute the transition matrices.  Once the number of classes, width 
of classes and state limits have been obtained, the one-step transition probability of all 
states can be calculated as following: 
iijij NNp /=   mji  ........, ,3 ,2 ,1, =                            (11) 
Where the m  value is a specific number of states ( m =5 or 7 in this paper). iN  is 
the number of observed values that are classified into ith  state and that value can be 
used as a starting state. For example, 40 values are observed. Assuming the 40th value 
belongs to ith  state, the actual number of observed value in ith  state is 1−iN , 
because the 40th value can’t go any other state presently. ijN  is the number of data 
which can be transferred from a state i  to a state j . Because the transition 
probabilities are conditional probabilities, they must be nonnegative and sum to one; 
i.e.,  
∑
=
==
m
j
ij mip
1
 ........, 3, 2, ,1 allfor           1                         (12) 
  The n-step transition probabilities then can be obtained according to 
Chapman-Kolmogorov equations described in Eq. (8). The n-step transition 
probability matrix )(nijp  comprising m  states given below: 
 10
MAPE= n
Y
YYn
t t
tt /)100(
ˆ
1
∑
=
−
                                  (15) 
Where tY  is an observed value in period t , tYˆ  is a forecast of period t  obtained 
from a specific forecasting model. 
 
5. Numerical analysis and conclusions 
In this paper, we analyzed two time series sequences. The first case is a 
stationary process. The series has a stationary mean. Second case is a non-stationary 
process. This series drifts and therefore has a random walk pattern. These two cases 
were chosen from DeLurgio’s book data [2]. There have 50 data from each case. In 
order to achieve higher accuracy of transition matrices, the previous 40 data are used 
as model building, states classification and transition matrix computing; and the last 
10 data are used for checking forecasting error.  
In this study, 4- and 7-period grey forecasting models will be used. That means 
the most recent 4 or 7 observed data will be used to construct grey forecasting models. 
Once a new observed data is available, the next new data will be added into the model 
building and the oldest actual data will be dropped. 
For convenient description, only part of data will be shown in main text, the rest 
of data are displayed in Appendix. Section 5.1 describes the stationary case, and the 
second case is displayed in Section 5.2.  
 
5.1 The procedures of Grey-Markov forecasting – case 1 : stationary system 
 Case 1 data are: [200.319, 198.959, 200.046, 201.307, 200.605, 197.617, …]. In 
this case, the 4-period model, i.e., using 4 data points to build forecasting model, is 
using for illustration 
 12
Table1. The classification of states for case 1 (stationary time series) 
state 4-period GM(1,1) model 7-period GM(1,1) model 
 State number = 5 State number = 7 State number = 5 State number = 7 
1 %5.1% 5.2 −<≤− R  %7.1%4.2 −<≤− R %1%2 −<≤− R %2.1%9.1 −<≤− R
2 %5.0%5.1 −<≤− R  %1%7.1 −<≤− R %0%1 <≤− R %5.0%2.1 −<≤− R
3 %5.0%5.0 <≤− R  %3.0%1 −<≤− R %1%0 <≤ R  %2.0%5.0 <≤− R
4 %5.1%5.0 <≤ R  %4.0%3.0 <≤− R %2%1 <≤ R  %9.0%2.0 <≤ R
5 %5.2%5.1 <≤ R  %1.1%4.0 <≤ R  %3%2 <≤ R  %6.1%9.0 <≤ R
6 __ %8.1%1.1 <≤ R  __ %3.2%6.1 <≤ R
7 __ %5.2%8.1 <≤ R  __ %3%3.2 <≤ R  
 
The percentage errors in Table A in Appendix can be assigned into a unique state 
according to Table 1 described as above. For example, the percentage error using 
4-period GM(1,1) model of 2nd period for case 1 is 0.0144% (from Appendix, Table 1). 
If the number of states 5 is used, the error will be assigned into state 3 according to 
Table 1. If the number of states 7 is chosen, the error will belong to state 4. The 
results are also can be found in Table A in Appendix. 
Step3: compute the transition matrices. The number of state 5 and 7 are used 
in this paper. Following the procedures of step 3 in Section 4, the one step transition 
matrices are shown in Table C in Appendix. 
Step 4: combine grey forecasting predictor with transition matrices to obtain 
a Grey-Markov predictor.  In order to find the most likely state of 1+t period, it 
has to obtain starting states for period t , and then obtain the most likely state of 
1+t period from one-step transition matrices. Once the state of 1+t  period has 
found, the Eq. (14) is used to calculate Grey-Markov predictor. The detail procedures 
 14
model is 201.407. The upper and lower limits of state 3 for 7-period grey forecasting 
model are 1% and 0%. Using Eq. (14), the Grey-Markov predictor of 41th period can 
be computed: 
=−−=−−= )001.02
2(*407.201)
2
2(ˆˆ )0(4141
lowerupper ww
YYGM 202.419 
The 41th period may belong to state 1, and the upper and lower limits of state 1 are 
-2% and -1%. The Grey-Markov predictor of 41th period may also equal 198.431 
according to Eq. (14). The arithmetical average of both conditions is 200.425.    
The observed value of 41th period is 200.103, so the percentage error of the 
period will be -0.161%. The data of 41th to 45th periods can be predicted following the 
procedures described above. The results of grey model and Grey-Markov model for 
this case are shown in Table 6. 
Step 5: examine the accuracy of grey forecasting model and Grey-Markov 
forecasting model. The values of 41th to 45th periods are used for accuracy checking 
and comparing between models. After forecasting results are obtained, the MAPE is 
used to compare forecasting accuracy between models. Using Eq. (15) and the results 
described in Table 6, the absolute percentage errors can be computed for each period 
and each condition. The results of mean absolute percentage errors (MAPE) are 
displayed in Table 6. 
Table 6. The grey and Grey-Markov forecasting results for case 1 (stationary series) 
4-period 7-period period Observed 
value grey 
model 
Grey-Markov 
Model 
 5 states 
Grey-Markov 
model 
7 states 
grey 
model
Grey-Markov 
Model 
 5 states 
Grey-Markov 
model 
7 states 
41 200.103 199.8867 203.9660 195.8713 201.4069 200.4247 203.9564 
42 197.750 200.6164 200.6164 200.7168 202.1640 203.1799 199.0783 
 16
 
Table7. The classification of states for case 2 (non-stationary time series) 
state 4-period GM(1,1) model 7-period GM(1,1) model 
 State number = 5 State number = 7 State number = 5 State number = 7 
1 %5.12% 20 −<≤− R  %15%5.20 −<≤− R %5.7%13 −<≤− R  %2.9%2.13 −<≤− R
2 %5%5.12 −<≤− R  %5.9%15 −<≤− R %2%5.7 −<≤− R  %2.5%2.9 −<≤− R
3 %5.2%5 <≤− R  %4%5.9 −<≤− R %5.3%2 <≤− R  %2.1%2.5 −<≤− R
4 %10%5.2 <≤ R  %5.1%4 <≤− R  %9%5.3 <≤ R  %8.2%2.1 <≤− R
5 %5.17%10 <≤ R  %7%5.1 <≤ R  %5.14%9 <≤ R  %8.6%8.2 <≤ R  
6 __ %5.12%7 <≤ R  __ %8.10%8.6 <≤ R
7 __ %18%5.12 <≤ R  __ %8.14%8.10 <≤ R
 
The percentage errors in Table B in Appendix can be assigned into a unique state 
according to Table 7. For example, the percentage error using 7-period GM(1,1) 
model of 2nd period is -3.5992% (from Appendix, Table 2). If the number of states 5 is 
used, the error will be assigned into state 2 according to Table 7. If the number of 
states 7 is chosen, the error will belong to state 3. The results are also displayed in 
Table B in Appendix. 
Step3: compute the transition matrices. Following the procedures of step 3 in 
Section 4, the one step transition matrices for state 5 and 7 are also displayed in Table 
C. 
Step 4: combine grey forecasting predictor with transition matrices to obtain 
a Grey-Markov predictor. To find starting states for period t  first, and then obtain 
the most likely state of 1+t period from one-step transition matrices. Once the state 
of 1+t  period has found, the Eq. (14) is used to calculate Grey-Markov predictor. 
 18
18.0931. The upper and lower limits of state 5 for 7-period grey forecasting model are 
14.5% and 9%. Using Eq. (14), the Grey-Markov predictor of 41th period can be 
computed: 
=−−=−−= )09.0145.02
2(*0931.18)
2
2(ˆˆ )0(4141
lowerupper ww
YYGM 20.5021 
The observed value of 41th period is 17.081, so the percentage error of the period 
will be 20.0287%. The data of 41th to 50th periods can be predicted following the 
procedures described above. The results of grey model and Grey-Markov model for 
case 2 are shown in Table 10. 
Step 5: examine the accuracy of grey forecasting model and Grey-Markov 
forecasting model. The values of 41th to 50th periods are used for accuracy checking 
and comparing between models. After forecasting results are obtained, the MAPE is 
used to compare forecasting accuracy between models. Using Eq. (15) and the results 
described in Table 6 and 7, the absolute percentage errors can be computed for each 
period and each condition. The results of absolute percentage errors and mean 
absolute percentage errors (MAPE) are displayed in Table 10. 
Table 10. The grey and Grey-Markov forecasting results for case 2 (non-stationary 
series) 
4-period 7-period period Observed 
value grey 
model 
Grey-Markov 
Model 
 5 states 
Grey-Markov 
model 
7 states 
grey 
model
Grey-Markov 
Model 
 5 states 
Grey-Markov 
model 
7 states 
41 17.081 17.5579 18.7284 16.8944 18.0931 20.5021 18.2588 
42 16.862 17.3153 18.4697 16.6610 18.2241 17.8798 17.6590 
43 16.739 16.5838 17.6984 15.9571 17.6017 15.9653 17.0559 
44 16.316 16.5544 17.658 15.9288 16.8545 16.5360 17.7043 
 20
and are decreased 59.3% (5 states) and 59.6% (7 states) than that of the 7-period grey 
forecasting models. That means if the time series has a non-stationary pattern, 
4-period Grey-Markov models are suggested whenever the number of states is 5 or 7.  
 
6. Suggestions and recommendations 
 The Grey-Markov forecasting models have advantages of grey and Markov 
forecasting models; it is suitable for stationary and non-stationary time sequences. 
Because the probability transition matrix is important if Grey-Markov forecasting 
models are used, the initial regular transition matrix should be chosen to be an ergodic 
matrix in order to form a stable matrix. In order to reach a specific accuracy of 
forecasting, the matrix should be recomputed at regular intervals of time. The length 
of interval of time is dependent on accuracy required, costs, real world conditions or 
other objects decided by decision makers or manager. 
References 
[1] D.R. Anderson, D.J. Sweeney, T.A. Williams, Statistics for business and 
economics, eighth ed., Ohio: South-Western, (2001) 31-33. 
[2] S.A. DeLurgio, Forecasting principles and applications. 1st ed., New York: 
McGraw-Hill, (1998) 282-286. 
[3] J.L. Deng, Control problems of grey systems, System and Control Letters 1 (5) 
(1982) 288-294. 
[4] J.L. Deng, The theory and application for grey system, Chuan Wa Co., Ltd, 
Taipei, 2000. 
[5] Y. Her, B.I. Dan, Grey Markov forecasting model and it’s application, Systems  
Engineering - Theory & Practice 12 (4) (1992) 59-63. 
[6] F.S. Hillier, G..J. Lieberman, Introduction to operations research, sixth ed., New  
York: McGraw-Hill, (1995) 630-633. 
 22
Table A. The grey forecasting results, percentage errors and belong states of 
percentage errors (state number = 5 and 7) for case 1 (stationary series) 
4-period GM(1,1) 7-period GM(1,1) 
Period 
Observed 
value predictor percentage
errors (%)
State 
(m=5)
State 
(m=7)
predictor percentage 
errors (%) 
State 
(m=5)
State 
(m=7)
1 200.319 200.319 0 3 4 200.319 0 3 3 
2 198.959 198.930 0.0144 3 4 201.142 -1.0974 1 2 
3 200.046 200.101 -0.0275 3 4 200.161 -0.0576 2 3 
4 201.307 201.279 0.0141 3 4 199.185 1.0541 4 5 
5 200.605 202.463 -0.9263 2 3 198.214 1.1921 4 5 
6 197.617 201.211 -1.8189 1 1 197.247 0.1874 3 3 
7 193.701 196.187 -1.2834 2 2 196.285 -1.3338 1 1 
8 193.623 190.504 1.6107 5 6 195.327 -0.8802 2 2 
9 195.502 191.006 2.2999 5 7 192.109 1.7353 4 6 
10 196.169 196.086 0.0423 3 4 191.701 2.2779 5 6 
11 197.443 197.655 -0.1071 3 4 193.335 2.0805 5 6 
12 198.424 198.321 0.0520 3 4 196.523 0.9579 3 5 
13 197.269 199.610 -1.1867 2 2 199.411 -1.0858 1 2 
14 198.929 197.538 0.699 4 5 199.240 -0.1561 2 3 
15 201.343 198.714 1.3057 4 6 199.438 0.9463 3 5 
16 199.983 203.290 -1.6536 1 2 201.201 -0.6091 2 2 
17 198.308 201.138 -1.427 2 2 201.221 -1.4691 1 1 
18 200.594 196.862 1.8605 5 7 200.039 0.2765 3 4 
19 203.769 200.242 1.7308 5 6 200.745 1.4843 4 5 
20 204.409 206.414 -0.9810 2 3 202.530 0.9191 3 5 
 24
4-period GM(1,1) 7-period GM(1,1) 
Period 
Observed 
value Predictor percentage
errors (%)
State 
(m=5)
State 
(m=7)
Predictor percentage 
errors (%) 
State 
(m=5) 
State 
(m=7)
1 10.000 10.000 0 3 4 10 0 3 4 
2 10.119 10.010 1.0742 3 4 10.483 -3.5992 2 3 
3 10.144 10.351 -2.0446 3 4 10.571 -4.2074 2 3 
4 10.806 10.704 0.9430 3 4 10.659 1.3604 3 4 
5 12.162 11.069 8.9887 4 6 10.748 11.6256 5 7 
6 11.025 13.226 -19.9664 1 1 10.838 1.698 3 4 
7 9.971 11.544 -15.7737 1 1 10.928 -9.6008 1 1 
8 10.155 9.028 11.0940 5 6 11.020 -8.5140 1 2 
9 11.485 9.526 17.0596 5 7 10.371 9.6987 5 6 
10 10.745 12.168 -13.2434 1 2 10.564 1.6817 3 4 
11 12.026 11.379 5.3817 4 5 10.360 13.8525 5 7 
12 12.018 11.987 0.2613 3 4 11.818 1.6650 3 4 
13 12.408 12.900 -3.9668 3 4 12.648 -1.9334 3 3 
14 11.937 12.540 -5.0482 2 3 12.944 -8.4334 1 2 
15 12.339 12.041 2.4135 3 5 12.505 -1.3461 3 3 
16 13.302 12.158 8.598 4 6 12.726 4.3332 4 5 
17 13.122 13.961 -6.3954 2 3 13.051 0.5434 3 4 
18 12.13 13.711 -13.0338 1 2 13.411 -10.5631 1 1 
19 11.56 11.733 -1.4957 3 4 12.851 -11.1644 1 1 
20 11.244 10.778 4.1409 4 5 12.142 -7.9820 1 2 
21 11.523 10.782 6.4297 4 5 11.183 2.9550 3 5 
22 11.912 11.405 4.2554 4 5 10.685 10.2972 5 6 
