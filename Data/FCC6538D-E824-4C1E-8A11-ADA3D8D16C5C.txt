 2 
事實使得獲利回吐甚至轉而虧損。畢竟一
個有自制能力和紀律的交易員仍需時間來
焠鍊。因此，利用機械性程式交易，根據
程式所發出之不帶任何感情的訊號作為進
出場的依據將會是最正確的解決之道。 
本計劃將結合以自我組織映射圖網路 
(SOM) 、遺傳演算法 (GA) 及 K-means
所搭配而成的 GKASOM 、模糊理論以及整
合 型 的 預 測 模 型  (GM(1,1)+GVM 、
ARIMA、DDEPE、Markov….) 發展出一
套具有資料前處理、資料分類、學習能力、
預測能力與決策能力的智慧型金融資訊系
統，以提供以期能透過電腦的強大計算能
力及不帶情緒的邏輯運算，進而建立一套
完整之分析與決策架構來產生可以穩定獲
利的交易訊號，進而幫助投資大眾打敗這
個市場。 
三、研究方法 
經過第一階段的金融資訊資料搜集、
資料的正規化前處理、特徵擷取與量化分
析，最後以 SOM 神經網路以及 GKA 演
算法分群之後，本計畫接著利用灰預測理
論中的 GM(1,1)模型並搭配使用灰馬可夫
模型 GMM(1,1)來找出最佳之金融市場趨
勢預測結果。 
研究過程主要分析之方法如下： 
1. GM(1,1)模型預測 
首先我們必須收集過去大盤的高、低
點資料並依據其與第一個交易日之間的交
易天數來得到原始資料序列 x(0)。接著執
行 AGO 累加生成運算而得到生成序列
x(1)。然後用最小平方法求出白化響應式
及其參數。最後我們將得到 x(1) 的估測值
並且藉由 IAGO 逆向累加生成運算求出 
x(0) 的估測值。x(0) 的估測值代表目前大
盤的下個反轉點。如此就可利用此資訊算
出到期日並搭配一些經驗值來決定風險等
級。接下來我將以大盤多頭波段為例並詳
述其過程。 
假設 )0(x  代表目前第 n個大盤多頭波
段之前的四個高點資料 (n ≥ 4)，亦即 
 
))(),1(),2(),3(( )0()0()0()0()0( nxnxnxnxx −−−=
 
根據 AGO )0(x ，我們得到序列 )1(x  
 
.,....,2,3          , )()(
))(),1(),2(),3((
3
)0()1(
)1()1()1()1()1(
nnnkmxkx
nxnxnxnxx
k
nm
−−==
−−−=
∑
−=
 
 
接著定義 )1(z  如下： 
 
)1(5.0)(5.0)(
))(),1(),2(),3((
)1()1()1(
)1()1()1()1()1(
−+=
−−−=
kxkxkz
nznznznzz
 
然後 GM(1,1) 的灰微分方程及其白化響
應式分別求得如下： 
 
n2,...,-n3,-n k        , )()( )1()0( ==+ bkazkx
 
                                  )1(
)1(
bax
dt
dx
=+   (1) 
 
此處 a 與 b 分別為發展係數與灰輸入。
令 θ  為參數向量，以最小平方法可得以
下算式。 
 
 4 
(4) 列出預測表。 
(5) 計算預測結果。 
 
3. 灰預測模型檢定 
本計畫使用一個叫做『後驗差』的方式來
檢驗灰預測模型的精確度。檢驗模型精度
的流程如下：  
 
 
 
後驗差 
假設 X(0) 為原始資料序列， )0(Xˆ 為對應
的模型模擬序列， )0(ε 為殘差序列，X(0) 
的平均數為 
 X = ∑
=
n
k
kX
n 1
)0( )(
1
, 
X(0) 的變異數為 
 21S = [ ]∑
=
−
n
k
XkX
n 1
2)0( )(
1
 
其平均殘差為 
 ε = ∑
=
n
k
k
n 1
)(
1
ε  
殘差變異數為 
 22S = [ ]∑
=
−
n
k
k
n 1
2)(
1
εε  
(1) C = 
1
2
S
S
 稱為均方差比值；對一固定 
C0f 0，當 Cf C0 時則稱模型滿足均
方差比； 
(2) 下列式子 
 p = )6745.0)((Pr 1Skob pεε −  
叫做小殘差機率；對一固定 p0 f 0，當 
pf p0 時則稱模型滿足小殘差機率。 
均方差比值 C 愈小愈好，因為 C 小
意指 S2 比 S1 小。也就是說，模擬出來
的殘差變異小而原始資料變異大。它說明
了模擬出來的殘差相當小幅度地集中於一
點，而原始資料相對地較大幅度的分佈。
所以好的模擬結果必須 S2 和 S1 比起
來愈小愈好。小殘差機率 p 則是愈大愈
佳。 
 
四、研究成果 
本計劃在經過之前所提出之金融資訊
之正規化處理、金融資訊之群聚分析、分
模型精度檢驗 
計算
預測值 
佳
建立GM(1 ,1 ) 模型 
數據處理
不佳
殘差 GM( 1 ,1 ) 
修正模型 
佳 ？ 
Y 
N 
  
2
)(ˆˆ
or                 
 )(5.0ˆ
ji
GMGMM
ijijGMM
PP
XX
BAX
+
×=
+×=
i
m
ijm
ij
m
kk
m
k
m
k
m
k
mm
m
k
mm
m
M
M
P
PPP
PPP
PPP
R
)(
)(
)()(
2
)(
1
)(
2
)(
22
)(
21
)(
1
)(
12
)(
11
)(
  where
       
,.....,,
.....          
,.....,,
,.....,,
=














=
