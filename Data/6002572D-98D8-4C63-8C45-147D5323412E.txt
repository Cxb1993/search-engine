行政院國家科學委員會專題研究計畫成果報告 
應用類神經網路及小波係數自動化分類肺音 
Neural classification of lung sounds using wavelet coefficients 
計 畫 編 號：NSC 98－2221－E－262－001－ 
執 行 期 限：98 年 08 月 01 日 至 99 年 07 月 31 日 
主 持 人：張光瓊                        龍華科技大學電機工程系 
共同主持人：溫 成                          龍華科技大學電機工程系 
計畫參與人員：陳彥融、許有志、羅智詠、黃任彬 龍華科技大學電機工程系 
一、中文摘要 
本研究使用 SOCMAC類神經網路設計肺
音分類器。為了尋找最適合萃取肺音特徵的小
波基底，研究使用 12 種小波基底，包含了
Coiflet-2、Coiflet-3、Coiflet-4、Coiflet-5、
Daubechies-5、Daubechies-6、Daubechies-7、
Daubechies-8、Symlet-5、Symlet-6、Symlet-7、
Symlet-8。對於各種基底，我們調整分類器的
參數，使其能達到最佳效果。實驗結果顯示，
Symlet-8 基底具有最佳的分類正確率。在最佳
的結果參數下，分類器的學習正確率可達
88.91%，而測試正確率可達到 86.70%。 
關鍵詞：肺音、小波轉換、SOCMAC、分類 
Abstract 
In this study, we use wavelet transform and 
SOCMAC neural networks to design lung sound 
classifiers. To find the best representation for 
lung sounds, we use 12 different wavelet bases 
to decomposition the lung sounds, which 
include Coiflet-2, Coiflet-3, Coiflet-4, Coiflet-5, 
Daubechies-5, Daubechies-6, Daubechies-7, 
Daubechies-8, Symlet-5, Symlet-6, Symlet-7, 
and Symlet-8. For every basis, the parameters of 
the classifier are selected so that the classifier 
has the best classification accuracy. Experiment 
results show that Symlet-8 has the best 
classification accuracy, out of the 12 different 
wavelet bases. 
Keywords: lung sound, wavelet transform, 
SOCMAC, clustering. 
二、緣由與目的 
呼吸器官的疾病是幼兒或長者的主要致
命原因之一，台灣在 92 年間，每 10 萬人即有
6.2 人因支氣管炎、肺氣腫以及氣喘而死亡。
長期以來，由於「聽診」屬於非侵入性、設備
成本低廉的技術，醫師廣泛的運用肺音識別的
診斷技術來瞭解病人的呼吸器官功能。藉助於
聽診器所蒐集的肺音以及醫師所具備的專業
知識，聽診可以診斷出大部分的呼吸器官疾
病，如氣喘、肺炎等。然而，由於家長並不具
備醫療專業知識、長者因為獨居或行動不便或
由安養院照護、偏遠地區醫療資源缺乏等因
素，許多病人在接受醫療診斷之前，病情即已
擴大至無法挽回的地步。 
有鑑於此，目前醫學工程領域中，有部分
學者已著手研究自動化分析肺音的技術，期能
降低前述因素，然而因為肺音相當複雜而導致
辨識率不佳。肺音因為人於人之間的差異，像
是年齡、體重、性別等，會影響肺音的辨識；
甚至外在因素，例如吵雜的環境、溫度、量測
的時間等，也會導致肺音的變化。更糟的是，
不同的疾病其所表現出的肺音，可能極為相
似；例如氣喘病人會產生哮喘音，但是發出哮
1 
哮喘音。此方法的缺點亦為視窗的取樣片段太
短（51.2 ms），可能會造成誤判。 
近年來因為演算法的進步，逐漸有能力進
行多種肺音辨識。文獻 [2] 提出以自我回歸
模型 (autoregressive model, AR model) 萃取
特徵值。經實驗後，最佳的自我回歸模型階數
為 6。文獻使用兩種分群演算法，最近群聚法 
(k-nearest neighbour, k-NN) 與二次分類器 
(quadratic classifier) ，來辨識受測樣本是否為
肺異音。嚴格說起來，此方法並沒有辨識出任
何肺異音。文獻 [8] 提出以小波轉換將原始
聲音信號分解到不同頻帶中，每一頻帶在切割
成若干小段，並以小波係數作為特徵值。最後
以類神經網路當做分類器，用來辨識五種肺
音：吸氣音、吐氣音、爆裂音、乾羅音、哮喘
音。此方法的缺點過於理想化，因為在測量肺
音信號時，必須要有病人密切配合，否則切割
成若干小段就沒意義了。文獻 [9] 提出以小
波基底為基礎，將取樣頻率為 11025 Hz 的原
始信號拆解至 8 個次頻帶 (sub-band) 中，由
於 D1、D2 及 A7 這三個次頻帶中的小波係數
幾乎都為零，所以不予採用。接著使用下列四
個特徵值：(1)每一個次頻帶小波係數絕對值
平均；(2)每個頻帶小波係數的平均能量；(3)
每一個次頻帶小波係數的標準差；(4)兩相鄰
頻帶小波係數絕對平均值的比。最後以類神經
網路辨識六種不同的肺音：正常肺音、哮喘
音、爆裂音、嘎嘎音、哮鳴音及乾囉音。此研
究中，因為這六種肺音差異相當大，降低了辨
識的難度。再者，訓練及測試的樣本數太少，
因此訓練完成的分類器不具有廣義性。 
四、方法 
4.1 肺音資料庫與特徵     因此，經由小波轉換後，每一個肺音樣本就可
以用 19 個特徵值來代表，特徵值由D本研究的肺音資料取自於文獻 [19 ] 所
提供的資料庫。該資料庫有許多不同的肺音病
歷資料。每一種肺音紀錄都有 4 ~ 20 個呼吸週
期。由於本研究不處理心音移除的主題，因而
捨去混雜了心跳聲的部分肺音紀錄，而只採用
單純肺音的紀錄當作本研究的資料庫，其總計
有 12 種肺音，132 個呼吸週期。對於類神經
網路的訓練與測試而言，132 個樣本不敷使
用，而需加以擴充。擴充的方式是在原本的訊
號中，參雜白色高斯雜訊，共計參雜 -10 db、
-15 db、-20 db、以及-25 db 四種不同大小 SNR
的白色高斯雜訊。如此一來，每種肺音紀錄至
有 20 ~ 100 個樣本，共計 660 個樣本數。每種
肺音中隨機選三分之二做為訓練樣本，剩餘的
三分之一當作測試樣本。 
本研究使用小波轉換來萃取肺音的特徵
值。小波轉換最重要的是小波基底的選擇，重
點在於小波基底與原始信號相似程度、小波轉
換後頻帶分佈及小波轉換後的時間位移。本研
究的目標是找出最適當的小波基底來表示各
種不同肺音信號。本研究使用 Coiflet-2、
Coiflet-3、Coiflet-4、Coiflet-5、Daubechies-5、
Daubechies-6、Daubechies-7、Daubechies-8、
Symlet-5、Symlet-6、Symlet-7、Symlet-8 等
12 種小波基底來比較分析。 
為了使各小波係數在相同的基準下比
較，本研究對於各小波基底均使用 7 階分解。
如圖 4.3 所示，哮鳴音經過小波分解後到各頻
帶的小波係數結果，由上而下的次頻帶分別為
D1、D2、D3、D4、D5、D6、D7及A7。表 4.2
顯示每個頻帶分佈的頻率。大部分的信號中，
D1、D2和A7這三個次頻帶中的小波係數幾乎
為零，因此不採用，而留下D3、D4、D5、D6及
D7這五個子頻帶。特徵值選取方式為： 
(1) 每一子頻帶中，小波係數的絕對值平均。 
(2) 每一子頻帶中，小波係數的平均能量。 
(3) 每一子頻帶中，小波係數的標準差。 
(4) 相臨兩個子頻帶的小波係數絕對值平均
比。 
3、D4、
D5、D6、D7的絕對值平均，D3、D4、D5、D6、
D7的平均能量，D3、D4、D5、D6、D7的標準
差，D3和D4、D4和D5、D5和D6、D6和D7所組
成的 19 個特徵值。 
 
3 
方式決定聚類的標記（label），凡是肺音標記
與聚類標記不同者，均屬聚類錯誤，相同者為
正確。當聚類標記決定後，該神經元在測試階
段並不改變，測試時，以分類方式處理，凡是
肺音標記與身經原標記不同者，均屬錯誤分
類。 
60
65
70
75
80
85
0.8 0.81 0.82 0.83 0.84 0.85 0.86 0.87 0.88 0.89 0.9 0.91 0.92 0.93 0.94 0.95  
圖 5.1 判別係數為 0.7 時，正確率隨著初始學習速率變化 
78.5
79
79.5
80
80.5
81
81.5
82
82.5
83
0.7 0.75 0.8 0.85 0.9
 
圖 5.2 初始學習速率為 0.81 時，正確率隨著判別係數變化 
分類器學習結束後，藉由資料庫提供各樣
本的標記，可以標示出各神經元的標記。接
著，在已知各神經元的標記的條件下，可以使
用分類器分類各測試樣本。在測試階段中，測
試樣本與各神經元的內容相比較，進而決定測
試樣本的歸屬。樣本分類後，不再更新各神經
元的內容。分類器使用學習階段中，最佳學習
結果的參數，例如，表 5.1 中，最佳學習結果
的學習參數及其學習後所得權重，用來測試分
類。以小波基底 Coiflet-2 粹取的特徵，其整
體最佳測試正確率為 83.03%。 
以相同的方式測試其餘 11 個小波基底所
萃取的肺音特徵值。其結果顯示，不論何種基
底，其學習階段所產生的聚類數目，均高於真
正的標記數，介於 30～40 之間。換言之，平
均約用 3 個子類才能涵蓋一個真正的標記。這
說明了，肺音的變異性非常的強：相同的肺音
病徵，具有多樣的特徵。第二個觀察是除了
Daubechies-5、Daubechies-6 以及 Symlet-8 三
種基底擁有一致的最佳學習以及測試參數
外，其餘基底的最佳學習結果和最佳以及測試
結果，都發生在不同的分類器參數上。換句話
說，Daubechies-5、Daubechies-6 以及 Symlet-8
這三種基底所萃取的特徵值較為穩定，其最佳
參數值及學習的結果，可以保證測試的結果，
而不必擔心學習階段表現良好的參數值，在測
試階段反而表現較差。表現最不穩定的是
Symlet-7 以及 Coiflet-4 兩種基底，其最佳學習
結果和測試結果的差異性最大，達 30％以上。 
以兩階段合計的總正確率當作標準，各基
底的測試結果，以 Symlet-8 為最佳，其總正
確率在 12 種基底中最高，達到 87.73%，其次
為 Coiflet-3，達 86.67％。而最糟的結果由
Coiflet-5 獲得，僅有 81.36％的正確率。以學
習階段的聚類正確率當作標準，各基底的學習
結果，以 Symlet-8 為最佳，其聚類結果的正
確率在 12 種基底中最高，達到 88.91%；其次
為 Coiflet-4，達 88.46％。而最糟的結果由
Daubechies-6 獲得，僅有 82.35％的正確率。
最後，以測試階段的分類正確率當作標準，各
基底的測試結果以 Coiflet-3 及 Daubechies-6
同為最佳，其測試結果的正確率在 12 種基底
中最高，達到 86.70%，其次為 Daubechies-7，
達 86.24％。而最糟的結果由 Coiflet-5 獲得，
僅有 79.82％的正確率。 
表 5.2 最佳測試結果比較表 
文獻 分類類別數 測試正確率 
[3] 2 95% 
[4] 2 89% 
[5] 2 75% 
[6] 2 91.5% 
[7] 2 88.48% 
[8] 6 94.02% 
本文 12 86.70% 
 
與文獻中的結果比較如表 5.2 所示，本研
5 
無衍生研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
