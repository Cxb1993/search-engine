I 
 
中文摘要 
本研究以遺傳演算法(Genetic Algorithm)結合水動力潮位模式，針對模式中所需的邊界參數
數值進行校正，以減小潮位模式在研究範圍內模擬台灣沿海潮位變化與實際潮位變化的誤差。
過去在邊界參數數值的校正多仰賴人工試誤法，由於邊界參數的數量龐大，因此在人工校正的
過程中不易掌握而造成校正效率不佳。透過電腦化的自動搜尋校正，可取代過去人工所無法同
步處理的龐大參數量，並可減少人工參數校正時可能參雜的主觀因素影響。且在遺傳演算法的
收斂機制下，可在較短的時間內找出較適當的最佳解，有效縮短過去人工參數校正所需花費的
時間。經本研究之實驗設計結果顯示，以遺傳演算法結合水動力潮位模式的參數校正，確實對
於模式模擬的誤差有所改善。 
關鍵字：遺傳演算法、參數校正、潮位模式 
 
英文摘要 
The current study has applied the Genetic Algorithm (GA) for the boundary parameters 
calibration in the hydrodynamic-based tidal model. The objective is to minimize the deviation 
between the estimated results acquired from the simulation model and the real tidal data along Taiwan 
coast. The manual trial-error has been widely used in the past, but such approach is inefficient due to 
the complexity posed by the tremendous amounts of parameters. Fortunately, with the modern 
computer capability, some automatic searching processes, in particular GA, can be implemented to 
handle the large data set and reduce the human subjectivity when conducting the calibration. Besides, 
owing to the efficient evolution procedures, GA can find better solutions in a shorter time compared to 
the manual approach. Based on the preliminary experiments of the current study, the integration of 
GA with the hydrodynamic-based tidal model can improve the accuracy of simulation. 
Keywords：Genetic algorithm、Parameter calibration、Tidal model 
 
 
 2 
本研究以相關文獻做為參考，由於參數校正的議題充滿區域最佳解，因此選擇以遺傳演算
法應用於潮位模式之中，針對潮位模式中的參數做校正。並以 Fazal(2005)研究中所使用的校正
期與驗證期的精神作為本研究中對於所校正出來的參數做檢驗。期望在相關文獻提供的借鏡參
考之下，完成潮位模式參數校正的研究，進而提升潮汐變化預報的能力。 
研究方法 
本研究中模式範圍為東經 105°～150°，北緯 15°～42°，模式地形精度為五分格點，模式邊
界分別以 M2、N2、S2、K2、O1、P1、K1、Q1 等八個分潮作為驅動，潮位振幅與相位差值為
利用 TOPEX/POSEIDON 產生。模擬時先經過 1 個月的暖機期使模式達到穩定再進行 1 個月的
潮位模擬，並將模擬的結果與台灣沿岸 11 個水位監測站資料的調和分析結果進行比對，以瞭解
模式模擬與實際監測的差距。 
水動力潮位模式需要透過邊界數值的輸入才能進行運算模擬。而邊界的數值，則是我們希
望校正的參數。八個分潮之於潮汐，有其影響作用的大小順序，在本研究區域中，影響最大的
為 M2 分潮，K1 分潮次之。因此，研究中先以 M2 分潮作為主要參數校正的對象。M2 分潮共
包含了 2060 個參數，其中有 1030 個振幅參數以及 1030 個相位角參數。 
研究初期，考慮將每個參數值所欲調整平移的量當作設計變數。亦即我們要利用遺傳演算
法，找出所有參數值最適當的平移量，再將其還原產生新的 M2 分潮的參數數值輸入模式以進
行模擬運算。然而，2060 個參數的平移量對於遺傳演算法而言雖然並不算是非常龐大的參數量，
但由於邊界參數對於模式而言在交互作用下是相當敏感的，當我們把整個 M2 分潮中的參數做
如此劇烈的調整，會使得所調整出來的新邊界，絕大部分都是超過模式所能計算的不合理情況。 
    因此，我們希望將 2060 個參數量縮減至較少的參數量，再透過其他方式將新的參數依
據趨勢原則還原至原本的 2060 個參數量。由於海洋環境的複雜度較高，邊界數值無法只以一個
迴歸方程式所呈現，因此採取將數值分割區段的方式，如此可以較細微地瞭解每個區段數值變
化的情形。 
本研究所使用之遺傳演算法，為 Matlab 7.1 中所內建的 GA 函數。其中，在遺傳演算法中
的設定上，包括使用輪盤法作為選擇方法、以均一化交換作為交換方式，並有設定突變機制以
避免搜尋落入區域最佳解。而遺傳演算法中，最重要的元素便是適應度函數的設計。由於模式
的輸入，是為了利用邊界以模擬出研究區域的潮位變化，因此是否能與真實的潮位相符合則是
我們所關心的議題。研究中取自台灣周圍包括竹圍、新竹、泊仔寮、東石、將軍、墾丁、梗枋、
蘇澳、成功、富岡、澎湖等共 11 個潮位監測站的潮位變化資料作為比較的依據。 
來自 11 個監測站的潮汐資料，我們稱為實際觀測值。事實上，這並非完全是真實的實際觀
測所得到的潮位數值，而是將真正的實際觀測數值，經過調和分析法擷取自八個主要分潮，再
利用這八個分潮所還原的潮汐資料。由於模式是靠八個分潮的邊界資料輸入，而最原始的潮汐
觀測資料事實上是由 129 個大大小小的分潮所構成的。因此直接拿兩者來相互比較是不恰當的，
必須透過一些前置處理，使模擬的潮位資料與所謂的實際觀測資料在同一個立足點(八個分潮)
 4 
遺傳演算法模式的中期，由模式呼叫處於外部的水動力潮位模式，以新產生的邊界資料作
為輸入的邊界條件進行模擬運算，並輸出模擬結果回傳至遺傳演算法的模式之中，計算此設計
變數所對應之適應值，並判斷是否達到終止條件。若是，則輸出設計變數最佳化的結果。若無，
則依此方式逐步產生該世代的子代數並透過選擇複製、交換、突變等運算子的作用產生新的子
代取代原親代，重複同樣的步驟直到結果輸出。 
模式驗證 
參數校正法實驗(1)：人工參數校正法自動化 
本案例中，透過遺傳演算法將過去人工參數校正的方法改以電腦化運算的方式作全域搜
尋，並利用遺傳演算法的收斂效率以及篩選機制節省人工參數校正所需的時間。其中在遺傳演
算法中所設計的適應函數如公式 1 所示： 
適應函數： ∑= )RMSE()( 每個監測站的xf ....................................(公式 1) 
從表 1 與表 2 中比較，以 9 月的校正期來說，未經參數校正的邊界(簡稱 boundary0)各監測
站的 RMSE 總和為 2.3325，而經過參數校正的邊界(簡稱 boundary1)其監測站的 RMSE 總和降低
至 2.3143，雖降低的幅度並不明顯，但透過遺傳演算法的搜尋機制，確實在目標函數上有朝最
小化的方向前進。參數校正前後的結果請見表 1 與表 2。 
表 1  原始邊界在 9 月校正期與 10～11 月的驗證期 RMSE (單位：公尺) 
 2003 年 9 月 2003 年 10 月 2003 年 11 月 
監測站 RMSE 效率指標 RMSE 效率指標 RMSE 效率指標
竹圍 0.4003 0.3103 0.4355 0.1866 0.4700 0.0586 
新竹 0.6850 -0.6693 0.7044 -0.7607 0.7234 -0.8529 
泊仔寮 0.3080 0.8692 0.3086 0.8682 0.3056 0.8679 
東石 0.1402 0.9349 0.1448 0.9313 0.1552 0.9210 
將軍 0.1495 0.8729 0.1496 0.8769 0.1522 0.8770 
墾丁 0.0764 0.9284 0.0773 0.9349 0.0807 0.9357 
梗枋 0.1318 0.7531 0.1291 0.7732 0.1283 0.7797 
蘇澳 0.0432 0.9856 0.0441 0.9856 0.0489 0.9823 
成功 0.0742 0.9701 0.0784 0.9670 0.0809 0.9644 
富岡 0.0609 0.9759 0.0635 0.9743 0.0674 0.9709 
澎湖 0.2630 0.8693 0.2668 0.8665 0.2722 0.8595 
總和 2.3325  2.4022  2.4846  
效率指標：Nash and Sutcliffe model efficiency criterion 
表 2  經遺傳演算法參數校正於 9 月校正期與 10～11 月的驗證期 RMSE (單位：公尺) 
 2003 年 9 月 2003 年 10 月 2003 年 11 月 
 6 
梗枋 0.1226 0.7864 0.1174 0.8125 0.1141 0.8256 
蘇澳 0.0468 0.9831 0.0481 0.9828 0.0520 0.9799 
成功 0.1022 0.9432 0.1033 0.9428 0.1056 0.9393 
富岡 0.0740 0.9644 0.0757 0.9635 0.0792 0.9598 
澎湖 0.1858 0.9348 0.1896 0.9325 0.1919 0.9302 
總和 2.2003  2.2449  2.2958  
從表 1 與表 3 中比較，以 9 月的校正期來說，在 boundary0 條件下各監測站的 RMSE 總和
為 2.3325，而在 boundary1 條件下其監測站的 RMSE 總和降低至 2.2003，顯然透過遺傳演算法
的搜尋機制，確實使得整體的 RMSE 得以下降，亦即符合遺傳演算法將適應函數最小化的原則。 
II. 利用 Spline 函數，針對不同誤差的測站，給予不同的權重 
有別於前一實驗設計，本案例在適應函數中，加入了權重的概念。針對在 boundary0 條件
下，RMSE 較大的幾個監測站給予較大的權重，而其他監測站則給予較小的權重。本案例設計
的適應函數如公式 3 所示。 
    適應函數： 
)]RMSE(*0.2                
)RMSE(*0.1                
)RMSE(*[0.7)(
富岡的成功蘇澳墾丁
梗枋的將軍東石
澎湖的泊仔寮新竹竹圍
++++
+++
+++= ∑xf ……………. ……  (公式 3) 
表 4  經遺傳演算法參數校正於 9 月校正期與 10～11 月的驗證期 RMSE (單位：公尺) 
 2003 年 9 月 2003 年 10 月 2003 年 11 月 
監測站 RMSE 效率指標 RMSE 效率指標 RMSE 效率指標
竹圍 0.3291 0.5338 0.3577 0.4514 0.3892 0.3546 
新竹 0.6093 -0.3205 0.6225 -0.3751 0.6315 -0.4122 
泊仔寮 0.2587 0.9077 0.2592 0.9071 0.2512 0.9107 
東石 0.0957 0.9696 0.1038 0.9647 0.1080 0.9617 
將軍 0.1166 0.9226 0.1188 0.9224 0.1180 0.9261 
墾丁 0.0986 0.8809 0.1033 0.8840 0.1043 0.8926 
梗枋 0.2122 0.3595 0.2078 0.4124 0.2055 0.4348 
蘇澳 0.1402 0.8485 0.1402 0.8542 0.1425 0.8494 
成功 0.1805 0.8231 0.1800 0.8261 0.1824 0.8189 
富岡 0.1599 0.8339 0.1596 0.8375 0.1621 0.8313 
澎湖 0.1730 0.9434 0.1790 0.9399 0.1810 0.9379 
總和 2.3739  2.4319  2.4755  
從整體的 RMSE 來看，RMSE 的值達到 2.3739，比起 boundary0 條件下的 2.3325 還高出一
些。原因乃遺傳演算法在本案例中的適應函數是經過加權處理的，因此在其演算機制的搜尋下，
是朝加權結果的最小化前進，而非整體的誤差最小。所以是可能發生經過參數校正之後，整體
 8 
進行驗證，耗費相當多的時間。因此在透過電腦化的自動參數校正程序，可以排除人工參數校
正時可能發生的問題。且實驗證實，經過遺傳演算法的參數校正，確實可以對監測站的 RMSE
有較好的改善。因此將遺傳演算法應用於水動力潮位模式的參數校正上，是可以嘗試的方法。 
2. 模擬結果的探討 
模式的準確來自於可信賴的資料數據，在實驗的結果中我們發現竹圍、新竹監測站無論在
何種實驗設計中，所呈現的誤差都是非常大的。在假定由理論建立的模式是可靠的情況下，因
此我們懷疑可能是用來比對的實測資料有誤，導致計算的誤差很大。這也可能影響到遺傳演算
法在最佳化的過程中所搜尋的方向，進而影響到最後輸出的結果。 
3. 邊界參數修正的討論 
在比較參數校正前後的邊界數值中可以發現，實驗(2)中利用 Spline 函數所校正出來的邊界
數值與原始的邊界有相當大的差異，與專家討論後瞭解這非是合理的邊界數值應有的分佈情
形。導致如此的原因，來自於實驗設計的疏忽，因為實驗設計是以邊界及其對應的誤差值為主
要考量，因此忽略了邊界數值分佈的實際物理意義。而利用 Polyfit 函數所校正出來的邊界數值
雖然改進了邊界數值不合理分佈的情形，但從整體 RMSE 上來看其改善程度相較於利用 Spline
函數是較差的。 
建議 
本研究於海洋環境中的水動力潮位模式上利用遺傳演算法針對模式中的邊界參數作參數校
正。受限於時間與儀器上的不足，在實驗設計上也有所調整。從與專家討論結果的分析中更瞭
解到研究中仍有改進的空間。茲分述如下： 
1. 減少模式運算時間 
潮位模式在現有電腦配備下，模擬兩個月需要耗時 1 小時左右。當我們以模擬結果作為遺
傳演算法的搜尋依據時，每次產生新的邊界就必須要重新執行模式模擬。因此不能像在其他最
佳化的案例中，使用較多的起始親代(100 個)，也不能設定較多的演化世代(500 個世代)。 
在如此的先天條件限制下，使得我們必須使用較少的起始親代與較少的演化世代以爭取時
間。若能將模式運算的時間透過儀器設備的改善或使用平行運算縮短時間，在演算法的設定上
可以有更多的空間選擇，也可能使校正的邊界參數更為完善。 
2. 適宜的權重分配 
在權重分配的實驗設計中，透過權重的分配可以使我們希望加強改善 RMSE 的監測站得到
改善。但所能改善的幅度在各監測站中並不一樣，而且在加強某些監測站的改善中，也會犧牲
其他監測站的改善空間(如梗枋監測站)。每個監測站對於不同的權重所變化的 RMSE 敏感度不
一樣，可以透過多次的嘗試去找到每個監測站最適合的權重分配，相信對於整體的 RMSE 修正
可以獲得更好的改善。 
