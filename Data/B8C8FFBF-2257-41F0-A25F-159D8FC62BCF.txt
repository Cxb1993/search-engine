 1
摘要 
為了整合前兩年的研究成果，本年度計畫主要針對支援多種類型數位權利交易系統之整
合架構進行討論。為達到支援多種類型數位權利交易系統之目的，我們除了更深入了解數位
權利的應用與相關技術外，本計畫嘗試提出具彈性分割的數位權利，使其所能支援的應用更
具彈性。除此之外，我們也提出以數位權利為基礎的e-Coupon交易機制。 
為了讓所提出的數位權利可以更有效支援使用者進行線上購物，在本年度計畫中我們更
嘗試將行動代理人技術引入。嘗試提出利用行動代理人來進行數位權利兌現之架構。為了在
藉助行動代理人行進數位權利兌現時不會產生安全問題，我們也對行動代理人的安全機制進
行討論。甚至我們更實際建構系統，嘗試了解在我們建置數位權利交易價購時所採用的安全
技術，究竟是否可以達到有效提升使用者信賴與安全感等行為面議題。 
 
關鍵字: 數位權利、密碼技術、行動商務環境、代理人、安全與信賴、E-coupon、彈性分割
數位權利 
 
 3
目錄 
中文摘要......................................................................................................................................... 1 
英文摘要......................................................................................................................................... 2 
第一章 簡介................................................................................................................................... 3 
第二章一個兼具匿名性與面額彈性分割的數位權利付款方法................................................. 6 
第三章一個協助數位權利兌現的行動代理人架構................................................................... 20 
第四章 Digital Right Schemes for Limited Issue and Flexible Division .................................... 38 
第五章 計畫成果自評................................................................................................................. 65 
出席國際會議之參加心得與相關論文....................................................................................... 67 
 
 5
3. 為了加強未來本計畫所提數位權利交易協定或是機制的可用性，我們更進一步透過雛型系
統的建置，實際了解在本計畫所使用各密碼技術是否可以有效加強使用者線上購物所需的
安全與信賴感。 
1.3 章節導覽 
本文章節安排如下：第二章將介紹本計畫所提出具匿名與彈性分割的數位權利交易系機
制。第三章介紹以行動代理人為基礎的數位權利兌現架構。第四章說明以數位權利為基礎並
滿足限量發行與彈性分割兩需求，並適用於行動商務環境的數位權利交易機制。最後，第五
章從本計畫執行過程中累積的研究能量以及完成的人才培訓進行本計畫成果之自評。 
 
 7
券進行商品兌換後即失效，或是車票可以讓消費者多次乘車，此為計次兌換的特性。計量的
特性則出現在例如禮券、電話卡等每次消費額不定的情況下。但是數位權利如同現實生活中
的禮券一般，往往無法滿足計量特性下的可分割性，也就是付款時，有最小的付款單位。因
此在計量的特性中，數位權利的彈性分割是本文其中一個研究重點。 
在數位權利的消費行為當中，數位權利擁有者在行使數位權利的同時，視情況的不同，
或許要表明自己的身份，例如專為某特定團體發行的數位權利；相對的，如果只是一般通用
的數位權利，例如商品促銷券，使用者並沒有必要在消費的同時表明自己的身份。所以數位
權利行使時的匿名性，必須視應用場合的不同，而有不同的需求。本文將提出一個利用數位
權利進行消費的方式，兼顧匿名性、可彈性分割、可流通以及交易的不可否認特性。而在本
文當中，將內容分為數個章節，第一章介紹本文。在第二章當中將對數位權利進行探討。而
第三章將說明本文提出的新方法。討論與結論則分別為第四章和第五章。 
2.2 數位權利 
本小節將針對數位權利的定義及數位權利交易系統作說明。 
2.2.1 定義  
數位權利依據 Ko Fujimura 等人於 1999 年提出的 Digital-Right Trading Infrastructure, 簡
稱 DRTI [Ko Fujimura 1999]的定義，使用者藉由出示數位權利來進行財貨與勞務兌換。而數
位權利當中的資訊包括有四部分，分別是發行者(Issuer)、承諾(Promise)、擁有者(Owner)以及
有效條件(Validity condition)。也就是發行者允諾在有效條件成立時將提供給數位權利擁有者
相對應的財貨與勞務。 
 數位權利資料的表示方式，可以根據 Ko Fujimura 在 1998 提出的研究[Ko Fujimura 1998]
以及 The Internet Engineering Task Force (IETF) Internet Open Trading Protocol Working Group
於 2004 年所提出關於數位權利的研究來進行[Ko Fujimura 2004; Masayuki 2004]，這是利用
 9
1. 數位權利交易系統必須可以讓不同的發行者發行不同類型的數位權利。 
2. 數位權利交易系統必須要防禦不正當的行為，例如竄改、偽造以及重製，並且保障隱私。 
3. 數位權利交易系統必須兼顧可行的成本以及效率。 
2.3 具備彈性分割的新方法 
本小節將介紹本文所提出的新方法。依序分別是針對使用的符號加以定義，並將提出的
新方法分成四個階段來說明，最後針對數位權利的流通方式，加以講解。 
2.3.1 符號定義 
以下將針對本方法中使用的符號進行說明，以便針對本方法加以解釋。 
User：數位權利交易中的使用者 
Broker：數位權利交易中的經紀人 
I (Issuer)：數位權利的發行者 
SP (Service Provider)：數位權利的履行者 
M (Message)：註冊資訊 
Certificatex：表示 x 的數位憑證 
Signx：表示 x 使用私密金鑰對資料進行簽章 
PKx：表示 x 的公開金鑰 
DRT (Digital Right Template)：I 發行的數位權利樣版，委託 Broker 發售 
P (Promise)：數位權利中的承諾 
V (Validity conditions)：數位權利中的有效條件 
DR (Digital Right)：經由 B 售出的數位權利 
Sn (Serial Number)：售出 DR 的序號 
TI (Trade Information)：交易資訊 
 11
Issuer Broker
1. DRT : {SignIssuer(I, P, V) || I || P || V}
2. Broker展售DRT
3. 通知接受DRT展售
 
圖三 發行階段 
步驟一：發行者發行如圖的數位權利樣版(DRT)，其中包含了發行者資訊(I)、承諾(P)以及有
效條件(V)，並對發行內容進行簽章，傳送給經紀人進行託售。 
步驟二：經紀人收到 DRT 後，確認資料正確無誤，即進行展售 DRT 的工作。 
步驟三：經紀人通知發行者，接受其 DRT 的託售。 
2.3.4 認購階段 
經過註冊的使用者，在經紀人處選購所需要的數位權利，透過發行者的簽章，使用者可
以確保數位權利的正確無誤，認購數位權利的動作圖示如下： 
User Broker
1. User根據展售的DRT選定所需DR
2. DR: {Sn, DRT, PKUser, SignBroker(H(Sn, DRT, PKUser))}
3. 儲存Sn, PKUser,
H(Sn, DRT, PKUser)
 
圖四 認購階段 
步驟一：經過註冊的使用者到經紀人處選購數位權利。 
步驟二：選購完成後，經紀人傳送 DR 給使用者，其中包含了序號(Sn)、數位權利樣版以及使
用者的公開金鑰，並且利用雜湊函數產生訊息摘要，之後對此摘要進行簽章，達到
確保資料正確性的目的。 
步驟三：經紀人針對此筆數位權利儲存其序號、使用者公開金鑰、以及該訊息摘要，以利之
後驗證比對使用。 
2.3.5 消費階段 
使用者從經紀人處購得數位權利，即可持此數位權利向數位權利當中的履行者要求履行
 13
步驟七：商店儲存 TI 為交易之不可否認證據，提供承諾的勞務與財貨，並且傳送 SignSP(Sn, PI)
給予使用者收執為交易之不可否認證據。 
步驟八：使用者收到交易不可否認證據後，將自己持有之數位權利更新為 
 DR’:{DR || Balance || H(SignSP(Sn, PI))}以便通過下次交易的線上驗證。 
在交易過程中，履行者可以透過數位權利取得使用者的公開金鑰，並且對使用者簽章過
的訊息進行驗證，但是並無法透過此公開金鑰得知使用者的身份，如此可以保障使用者消費
時的匿名性。而透過經紀人儲存的資料更新，則使用者亦必須誠實地對持有的數位權利進行
更新，以求下次消費的線上驗證成功。當使用者將數位權利更新後，其中包含的 Balance 資
訊，可以供履行者於下次消費時檢視並進行線上確認。透過此機制，便可以滿足消費的彈性
分割。 
2.3.6 數位權利的流通 
數位權利在使用者之間的流通，也是一個重要的議題。如何讓雙方可以公平地進行數位
權利的轉移並且提供不可否認性，以免之後數位權利的所有權發生爭議。根據數位權利轉移
的需求不同，又可分為部分轉移以及全部轉移。本文提出兩個方式，分別為線上(On-line)轉
移以及離線(Off-line)轉移，也就是經紀人是否需要參與轉移的過程。 
以下的離線轉移方式可以滿足使用者 A 把數位權利全部轉移給使用者 B，並且讓使用者
B 得到足以證明數位權利所有權的資訊，前提是使用者 B 亦需向發售該數位權利的經紀人進
行註冊的動作。 
UserA UserB
1. DR
2. SignBroker(PKUserB)
3. SignUserA(H(DR), PKUserB)
 
 15
 
)(PKSign
BUserBroker
 .2
UserA UserB Broker
1. DRA
4. UserB確認資料
6. Broker驗證資料
並更新資料庫7. DRB
)PKAmountDRSign
BA UserAUser
,,( .3
)),,((    
,,DR .5 A
BAB
B
UserAUserUser
User
PKAmountDRSignSign
PK
)),,(( .8
BAB UserAUserUser
PKAmountDRSignSign
9. UserA更新持有的DRA  
圖七 線上數位權利轉移示意圖 
步驟一：使用者 A 出示 DRA給予使用者 B 確認數位權利內容。 
步驟二：使用者 B 確認數位權利內容為所需後，出示自己經過經紀人簽章的公開金鑰。 
步驟三：使用者 A 產生數位權利轉移資訊並傳送給使用者 B。 
步驟四：使用者 B 利用 DRA中使用者 A 的公開金鑰解開數位權利轉移資訊並檢視其內容。 
步驟五：使用者 B 確認內容無誤後，保留此訊息做為使用者 A 針對此次轉移所提供的不可否
認證據，並將此轉移資訊簽章後，連同 DRA 以及自己的公開金鑰一併交由經紀人處
理。 
步驟六：經紀人收到資料，先後利用雙方公開金鑰解出訊息內容確認無誤後，經紀人新建一
筆新的 DRB，其內容為 
 })||Balance,DRT,PKSn(H,Sign,DRT,PK{SnDR BUserBBrokerUserBB BB )(:  
其中 BalanceB等於 Amount。並且經紀人資料庫中更新 DRA存放資料，並針對 DRB
新建一筆存放資料，資料格式分列如下： 
 17
2. 數位權利交易系統必須要防禦不正當的行為，例如竄改、偽造以及重製，並且保障隱私。 
a. 防止偽造(Preventing forgery) 
數位權利的偽造，由於偽造者並無法製作出發行者與經紀人的數位簽章，所以偽造的
數位權利必定會被識破。 
b. 防止竄改(Preventing alternation) 
由於數位權利的資料均以發行者與經紀人的數位簽章進行保護，資料的竄改將導致驗
證的失敗。 
c. 防止重複使用(Preventing duplicate-redemption) 
當數位權利的狀態發生變更時，經紀人處的資料亦會更新，所以使用者也必須進行數
位權利的更新，以求下次消費時順利通過線上驗證，因此重複使用的情況將不會發生。 
d. 防止重製(Preventing reproduction) 
數位權利經過消費而狀態產生變更後，經紀人處的資料將會進行更新，所以數位權利
的重製，將會導致線上驗證的失敗。 
e. 不可否認(Non-repudiation) 
對於使用者而言，數位權利當中包含了經紀人以及發行者的數位簽章，也就是經紀人
和發行者不能對此數位簽章否認；在消費過程中，使用者和履行者分別可以獲得對方
的不可否認證據；而在數位權利轉移過程中，數位權利的承接者，可以得到來自前一
位持有者的不可否認證據。因此本方法在各種交易行為中，都可以滿足不可否認性。 
f. 確保隱私(Ensuring privacy) 
本方法中，使用者唯一需要出示真實身份的步驟，只有在向經紀人註冊的時候，在其
他的交易行為中，均以經紀人簽章過的使用者公開金鑰充當身份，所以可以滿足匿名
性。 
g. 信賴的可管理性(Trust manageability) 
 19
2.5 結論與展望 
   網路消費的盛行使得線上付款成為一個重要的議題，針對不同的需求也產生了許多不同的
線上付款機制。而數位權利的付款機制帶給使用者一個新的選擇，而其多樣化的應用絕對是
滿足網路消費的最佳付款方式之一。而數位權利的應用，並不只是商務上的應用，例如會員
卡可以轉化成數位權利的格式，那麼駕照甚至是身份證呢？因此，數位權利的應用，或許比
我們想像中的更廣泛。而在達到廣泛的應用之前，必須先有完善的架構，才能夠配合不同應
用的需求。因此，更完善的數位權利架構以及更廣泛的應用，將是之後研究將持續進行的方
向。 
參考文獻 
Ko Fujimura and Masayaki Terada, “XML Voucher: Generic Voucher Language,” 
http://www.ietf.org/internet-drafts/draft-ietf-trade-voucher-lang-06.txt, IETF Internet Draft, 
2004, 2004/10/26. 
Ko Fujimura and D.Eastlake, “Requirement and Design for Voucher Trading System (VTS),” 
http://www.ietf.org/internet-drafts/draft-ietf-trade-drt-requirements-04.txt, IETF Internet Draft, 
2003, 2004/10/26.  
Ko Fujimura, “Digital-Right Trading Infrastructure (DRTI),” 
http://www.ietf.cnri.reston.va.us/proceedings/99nov/slides/trade-drti/sld001.htm, NTT, 
November 1999, 2004/10/26. 
Ko Fujimura, Hiroshi Kuno, Masayuki Terada, Kazuo Matsuyama, Yasunao Mizuno, and Jun 
Sekine, “Digital-Ticket-Controlled Digital Ticket Circulation,” In Proceedings of the 8th 
USENIX Security Symposium, Washington, D.C., USA, August 23-26, 1999, pp. 229-238. 
Ko Fujimura and Yoshiaki Nakajima, “General-Purpose Digital Ticket Framework,” In 
Proceedings of the 3rd USENIX Workshop on Electronic Commerce, Boston, Massachusetts, 
USA, August 31-September 3, 1998, pp. 177-186. 
Masayuki Terada and Ko Fujimura, “Voucher Trading System Application Programming Interface 
(VTS-API),” (http://www.ietf.org/internet-drafts/draft-ietf-trade-voucher-vtsapi-06.txt, IETF 
Internet Draft, 2004, 2004/10/26) 
 21
漫遊在不同的執行環境之間。它主要為接受使用者指派的任務，被派遣至網際網路提供相關
服務的伺服器去搜尋相關的資訊，更進一步地完成任務回報給使用者。 
而因網路的普使得消費者的消費型態從傳統的消費行為模式(例如：實體商店購物、郵購
型錄商品購物)演變為網路消費模式。消費者只需透過網路就可以完成全部的購物程序，而不
需要親自到實體商店購物。然而，在網際網路上，由於使用搜尋引擎，使消費者往往必須在
不同商店消費。許多商店及其商品、服務等，皆可透過網路實行電子交易，消費者卻無法在
完成多店之商品選購後，僅靠單一操作就直接離開，除非這些商店皆位於同一群組。這使消
費者在彙整所有購買項目前，不得不在各家商店做出購買的決定，也讓消費者必須逐一在這
些商店不斷重複購買動作。因此，如何應用行動代理人機制來創造商機是相當直得討論的議
題。行動代理人的特性使得它很適合被應用在電子商務上。行動代理人具有自主性，它能自
主的執行與完成使用者所設計與賦予的工作與任務。行動代理人所具備的移動性更使得它能
在無遠弗界的網際網路上恣意的移動，代替使用者執行如選購商品、比價、議價和協商等任
務，因而可以節省使用者大量的人力與時間。 
有鑒於數位權利是另一個可以用來保障數位內容的有效機制。使用者在操作或是下載所
要購買的數位內容之前，使用者必須先取得相關合法的數位權利。使得使用者就有可能面臨
以下問題：如果事先所取得的數位權利是購自不同的數位服務供應商，當使用者希望將所購
得的數位權利進行兌現時，使用者可能需要先後跟不同的數位權利供應商連線，才能完成有
效的數位權利兌現動作。因此，為了解決此一問題，本計畫冀望在兼顧安全性下，嘗試利用
行動代理人技術，建構一個可以利用代理人來協助使用者完成多個不同數位權利得兌現活
動，以便可以協助使用者完成在不同數位權利供應商之間完成數位權利兌現甚至數位權利轉
移的處理。 
3.3 相關文獻回顧 
本小節將針對行動代理人及數位權利做詳盡的介紹，並且簡述由 Ko Fujimura, 
 23
Agent Owner
ResponseRequest
Agent Platform
Mobile Agent 
 
圖二、行動代理人架構圖 
從圖二，我們可以清楚看出行動代理人的資訊傳遞模式如何改善主從式架構的缺點。行
動代理人具備離線工作的能力，在接受使用者的指派後，行動代理人即可獨立在伺服器端完
成任務，等完成任務後回到客戶端，使用者再查看任務結果。因此，行動代理人架構可以節
省資訊在客戶端和伺服器端之間的網路傳遞的時間，進而減少使用網路頻寬，以提高網路的
負載能力。 
在 “Mobile Agents with Java: The Aglet API”[4]中，作者D. B. Lange, and M. Oshima 歸納
出行動代理人的技術具備七項的優點與特性，這七項優點不僅幫助網際網路的使用者能夠更
便利的在網路中進行工作，同時也讓網路本身可以更有效率的供人使用。行動代理人的七項
優點包含，(1)減少網路負載，(2)克服傳輸延遲，(3)封裝通訊協定，(4)非同步的自主執行能
力，(5)動態適應環境，(6)天生異質能力，(7)強韌容錯能力。 
3.3.2 數位權利 
數位權利交易目前沒有一個完整的定義。依據學者Ko Fujimura 在1999 年第四十六屆
IETF (The Internet Engineering Task Force) 的會議論文－「數位權利交易架構」(Digital-right 
Trading Infrastructure，簡稱DRTI)[5]中指出：數位權利 (Digital Rights)是以數位化的形式來代
表服務或商品，其數位化的形式以 (I, P, O, V)四個項目來表示，代表的意義分別為發行者 
(Issuer)、允諾 (Promise)、擁有者 (Owner) 及有效條件(Validity-condition)。當這四個組合之
 25
3.確保數位權利的實用性：數位權利交易系統必須兼顧可行的成本以及效率，並且滿足規模
性。 
在Fujimura 等人於1999 年提出有關數位權利流通控制的研究[6]，說明了數位權利的流
通可以建立在有先決條件的情況之下，例如電影學生票數位權利的流通必須建立在擁有學生
證數位權利的前提之下，也就是進行數位權利轉移的雙方，都必須擁有學生證數位權利，才
滿足了轉移的條件。 
3.3.4 Ko Fujimura,Masayuki Terada ,and Jun Sekinew 提出的權利交易系統機制[8] 
Ko Fujimura,Masayuki Terada ,and Jun Sekine 三人於 1999 年發表了一篇 “使 
用權利交易系統的全球性超商機制(A World Wide Supermarket Scheme Using Rights Trading 
System)”，提出一個新的數位權利交易的概念。 
A.概念簡述 
此計畫主要呈現一種新型式電子商務，提供消費者自多個獨立商店購買商品後，從單一
據點結帳的服務。在此設計中，是以數位權利憑證當作是商品或服務的交易票據，消費者必
須要持有數位權利憑證才能夠購買商品。而數位權利憑證的取得是免費的，消費者不需事先
支付任何費用，在消費者向商家兌現數位權利憑證時才進行付款的動作。消費者必須在每次
交易中，從不同商店收集交易票據（transaction ticket）、數位權利的表格，使得使消費者能夠
在決定購買選定的項目後，將交易票據交給結帳代理人（check-out agent）。 
此文提出一個能夠使用數位權利的全球性超商（WWSM）機制，也就是種數位代表（digital 
representation）。此代表有提出兌現商品與服務之權利，並且此權利可以在網路上流通。此設
計之概要如下：（1）消費者需要從商店取得代表數位權利的明確表格，稱為交易票據。此票
據代表購買特定商品與服務之權利。（2）消費者將交易票據轉移給結帳代理人。（3）結帳代
理人代表消費者向商家出示交易票據。（4）購得商品將會寄給消費者。為了避免交易票據遭
到複製，作者 K. Fujimura 等人建議將這些交易票據以數位權利（或數位票據）方式使用之，
使交易票據可在數位交易系統中安全流通。 
 27
Internet
Holder
Issue
Redemption in real world
Issuer
Issuer
Issuer
Collector
Collector
Holder
Digital-right
Transfer
Redemption in virtual world
 Smart card
 
圖三、數位權利之流通模型 
B.概述：全球性超商（WWSM）機制 
假定所有的消費者與商家都已安裝數位權利交易系統，且有同樣的數位交易協定作為相
互運作之協定。全球性超商（WWSM）機制中的購買程序如下： 
1. 消費者收集特定的數位權利，稱為數位票據。購買票據上標明了消費者想要購買的商品或
服務之資料的權利。消費者可向商家免費索取商品的數位票據，而且一次可以索取多個商
品的數位票據。數位票據的資料結構如圖四。收集到的票據將被儲存於消費者的數位權利
錢包。不同於一般的線上購物，索取數位票據是不須支付任何費用。換句話說，數位票據
一般而言是免費的。 
 29
的付費動作：付費方法、價格、及數量資訊。假如付費動作完成，商家會收回數位票據。 
4. 在結帳代理人與商家完成付款的動作後，商家便將商品或服務直接寄送給消費者或透過結
帳代理人來轉交給消費者，端視消費者決定。上述流程大綱如圖五。 
Shop
Shop
Shop
Internet
Consumer
4.Delivery
1.Issue
Checkout 
agent
2.Transfer
3.Redemption
圖五、全
球性超商(WWSM)機制 
在此交易機制中，提供給消費者比較大的權利，消費者可以免費取得多個商品或服務的
數位票據，但是並不一定要去兌現所有數位商品或服務的票據。消費者如果一次要兌現多個
商品或服務的數位票據，而此些數位票據又是分屬於不同的商家時，消費者不需個別的向這
些不同的商家來做多次兌現的動作，只要將數位商品或服務的數位票據轉移給結帳代理人，
由結帳代理人代替消費者來進行兌現的動作，可以替消費者節省許多的時間。 
 31
生 n 個雜湊值，即(hn(SKC),hn-1(SKC),hn-2(SKC),..., 
h1(SKC))。以及一把用來加密數位權利(DR)的對稱式金鑰(KA0)。 
步驟 2:C 將 sSKC(ePKM1(eKA0(DR1))),sSKC(ePKM2(eKA0(DR2))),sSKC(ePKM3( 
eKA0(DR3))),...,sSKC(ePKMn(eKA0(DRn))),eSKM1C(hn(SKc)),eSKM2C(hn-1(SKc)),eSKM3C(hn-2(
SKc)),...,eSKMnC(h1(SKc)), ePKM1(SKM1C), ePKM2(SKM2C), ePKM3(SKM3C),..., ePKMn(SKMnC)
傳送至 A0 上，內容包含了先用一把加密數位權利(DR)的對稱式金鑰(KA0)分別將數位
權利(DR)加密，接著使用各 Mi 的公開金鑰 PKMi來加密已加密過的數位權利
(eKA0(DR1)),最後用 C 的私密金鑰做簽章。以及分別使用通訊金鑰 SKMiC來加密 A0 的
簽章金鑰。使用 
各 Mi 的公開金鑰 PKMi來加密 C 挑選的通訊金鑰 SKMiC。 
階段二：C 派遣 A0 攜帶加密過的數位權利 sSKC(ePKM1(eKA0(DR1))),sSKC(ePKM2 
(eKA0(DR2))),sSKC(ePKM3(eKA0(DR3))),...,sSKC(ePKMn(eKA0(DRn)))、簽章金鑰
eSKM1C(hn(SKc)),eSKM2C(hn-1(SKc)),eSKM3C(hn-2(SKc)),...,eSKMnC(h1( 
SKc))及通訊金鑰 ePKM1(SKM1C),ePKM2(SKM2C),ePKM3(SKM3C),...,ePKMn( 
SKMnC)移動到各商家 Mi。 
 
 
 
 
 
圖六 C 派遣 A0 移動到各商家 Mi 
階段三： A0 移動到各商家 Mi上進行交易。此階段分為 12 個步驟，詳細步驟如下。 
 
 
    C 
 
A0 
A0 A0 .....................
 
 
     Mi 
 
A0 
1 
 33
的對稱式金鑰(KA0)之不可否認證據。 
步驟 7: A0 將 eSKMiC(hn(SKC))及 ePKMi(SKMiC)傳送給 Mi，內容分別為使用通訊金鑰 SKMiC來
加密 A0 的簽章金鑰；以及用 Mi的公開金鑰 PKMi加密通訊金鑰 SKMiC。 
步驟 8: Mi使用自己的私密金鑰 SKMi來解開 ePKMi(SKMiC)，即 
dSKMi(ePKMi(SKMiC)= SKMiC。 
步驟 9: Mi使用通訊金鑰 SKMiC來解開 eSKMiC(hn(SKC))，即 
dSKMiC(eSKMiC(hn(SKC)))=hn(SKC)。 
步驟 10: Mi使用簽章金鑰 hn(SKC)來解開 shn(SKc)(ePKMi(KA0))，即 
dhn(SKc)(shn(SKc)(ePKMi(KA0)))=ePKMi(KA0)。 
步驟 11: Mi再使用自己的私密金鑰 SKMi來解開 ePKMi(KA0)，即 
dSKMi(ePKMi(KA0))=KA0。 
步驟 12: Mi使用對稱式金鑰 KA0 來解開 eKA0(DR1)，即 
dKA0(eKA0(DR1))=DR1。 
3.4 安全討論 
在此節中我們將會討論到與本計畫相關的安全性議題：使用者的身分鑑別、資料傳遞的
機密性(Confidentiality)、交易承諾的不可否認性(Non-repudiation)以及行動代理人所攜帶數位
權利的安全性。 
3.4.1 使用者身分的鑑別性(Authenticity) 
鑑別性主要是證明雙方在網路上交易時的身分。本計畫使用數位簽章演算法(Digital 
signature algorithms)的安全機制來落實鑑別性。我們的方法中,資料發送者利用密碼學中的數
位簽章演算法對傳輸的資料作簽章，使得資料接收者可以辨識確認發送者之身分，因而達到
 35
加密過的對稱式金鑰ePKMi(KA0)的不可否認之證據(NRO)。商家Mi將行動代理人A0所傳送過來
的資料shn(SKc)(ePKMi(KA0 
))用自己的私密金鑰SKMi做簽章，做為商家Mi收到shn(SKc)(ePKMi(KA0))之不可否認證據(NRR)。 
 行動代理人所攜帶數位權利的安全性 
行動代理人 A0 所攜帶的數位權利(sSKC(ePKM1(eKA0(DR1))),sSKC(ePKM2( 
eKA0(DR2))),sSKC(ePKM3(eKA0(DR3))),...,sSKC(ePKMn(eKA0(DRn))))是否會被偷走?答案是有可
能的。舉例來說，行動代理人 A0 攜帶已加密過的數位權利資料(sSKC 
(ePKM1(eKA0(DR1))),sSKC(ePKM2(eKA0(DR2))),sSKC(ePKM3(eKA0(DR3))),...,sSKC(ePKMn(eKA0(DR
n))))移動到商家 M1 上進行交易，商家 M1 可能會偷取行動代理人 A0 攜帶的其他數位權利。但
是，商家 M1 無法將偷取來的數位權利偽裝成隸屬商家 M1 的數位權利來進行兌現，原因在於
隸屬各商家 Mi的數位權利分別使用各商家 Mi的公開金鑰 PKMi作加密，因此只有擁有公開金
鑰 PKMi對應之私密金鑰 SKMi的商家可以解密，進而完成兌現獲取數位權利。 
3.5 結論 
本計畫是以具有執行能力的行動代理人為基礎並有效透過數位權利的管理可以達到對數
位內容的有效保護。因此嘗試利用行動代理人技術，建構一個利用代理人來協助使用者完成
多個不同數位權利得兌現活動，以便協助使用者完成在不同數位權利供應商之間完成數位權
利兌現甚至數位權利轉移的處理，進而有效降低使用者進行數位權利兌現或是權利轉移的複
雜性。並且考慮攜帶資料的行動代理人之安全性問題，使得能有效的達到替消費者節省大量
的人力與時間。 
參考文獻 
[1] Stone, P. and M. Veloso, “Multi-agent System: A survey from a machine Learning  
Perspective,” Autonomous Robotics, pp. 8–11, 2000. 
[2] D.B. Lange and M. Oshima, “Programming and Deploying Java Mobile Agents  
with Aglets, ” Addison Wesley , 1998. 
 37
sharing scheme in Digital Rights Management,” School of Informatics Technology and 
Computer Science University of Wollongong Northfields Ave, Wollongong, NSW 2522, 
Australia. 
[12] Jianying Zhou, Dieter Gollmann, “An Efficient Non-repudiation Protocol,” Proceedings of The 
Tenth Computer Security Foundations Workshop, Massachusetts, pp. 126-132, 1997. 
[13] Seokwon Yang, Stanley Y. W. Su, and Herman Lam, “A Non-Repudiation Message Transfer 
Protocol for E-commerce,” Proceedings of the IEEE International Conference on 
E-Commerce. 
[14] Kwangjo Kim, Sangjoon Park, and Joonsang Baek, “Improving Fairness and Privacy of 
Zhou-Gollmann’s Fair Non-repudiation Protocol,” Proceedings of the IEEE Computer Society 
on Security, Sep. 21-22,1999, pp. 140-145. 
 
 39
Some digital tickets, e.g, E-gold [14] and E-Stamp [6], have already been developed.  In 1998, 
Fujimura and Nakajima defined a digital ticket as comprising issuer, promise and owner [8].  
Based on above definitions, they clarified the requirements of general-purpose digital ticket and its 
four unique properties, which are not required for digital cash.  They are (1) 
machine-understandability of ticket contents, (2) state-transitionality of ticket status, (3) 
composability of multiple tickets, and (4) parameterization of ticket features on untraceability, 
transferability and divisibility.   In addition, they used thirteen properties to compare digital cash 
with digital ticket.  The comparison results are listed in Table 1 as follows. 
Table 1. The comparisons between digital cash and digital ticket [8] 
Properties Digital 
cash 
Digital ticket 
(1) Secure Yes Yes 
(2) Anonymous Yes Traceable/Untraceable 
(3) Physical independence Yes Yes 
(4) Transferable Yes Transferable/ Not transferable 
(5) Divisible Yes Only once/ Specified times/ 
Infinite times 
(6) Off-line capable Yes Yes 
(7) Persistent Yes Persistent/ Specified period 
(8) 
Machine-understandable 
No Yes 
(9) State manageable No Yes 
(10) Composable No Yes 
(11) Wide acceptability Yes Yes 
(12) User friendly Yes Yes 
(13) Monetary freedom Yes No 
 
In 1999, Fujimura et al. developed a comprehensive digital ticket circulation model shown in 
Figure 1 [9].  In Fujimura et al.’s model, there are six entities: CA, issuer, service provider, user, 
broker and shop.  An issuer is in charge of creating, signing, issuing a digital ticket and authorizing 
brokers to sell digital ticket; a user redeems the ticket; and a service provider fulfills the service 
 41
(OOMS), issuer, user and service provider.     
In 2003, Fujimura and Eastlake extended their discussion to crediting loyalty points and 
collecting digital coupons or gift certificates [12].  They used the “voucher” concept to represent 
above activities.  They also designed a voucher trading system.  Certainly, after Fujimura 
clarified the definitions of digital ticket and digital right, it is obvious that the digital right can 
represent more complex services or rights than the digital ticket does.  In the following sections, 
we will discuss digital rights instead of digital ticket.  Based on our observation, most of the 
current digital ticket circulation models and trading systems focus on how to apply digital right 
concept to different applications and design diverse models, frameworks or systems to help the 
issuer to issue various types of digital rights, and to support consumers to transfer or redeem their 
digital rights.  Few of them further enhance digital right’s function to solve the potential problems 
caused by digitalization of the paper-based ticket or right, or to solve the paper-based ticket or 
right’s weakness.  Two examples are demonstrated as follows to declare our opinions.  The first 
one is an issuer usually issues limited coupons to promote his products.  Once an issuer authorizes 
his brokers to distribute or sell his coupons.  Issuers have to print out paper-based coupons and 
deliver coupons to brokers.  Therefore, it is easy to prevent brokers from over-selling coupons.  
However, it is difficult to prevent brokers from over-selling e-coupons because duplication is quite 
easy and costless.  The other one is current paper-based gift coupon is fixed value.  If a consumer 
uses a coupon to buy a good that is less than the value of the coupon, he may suffer a loss because 
shop will not return him the price difference.  The former one describes the potential problem of 
digital ticket/ right, and the latter one presents the weakness of traditional paper-based gift coupon.  
To conquer above problems and to enhance the function of existing digital right, we apply 
cryptographic techniques to propose two flexible digital right schemes in this paper, one for limited 
issue and the other for flexible division.   
The rest of this paper is organized as follows.  In Section 2, we shall briefly review 
 43
Step 1. User U0 sends T to user U1. 
Step 2. User U1 generates a new ticket-token K1, and creates a transfer request R1=(h(T), h(K1)).  
At last, user U0 sends R1 back to U0. 
Step 3. User U0 generates a new ownership information IO1=(h(T), K0, h(K1)) and sends IO1 to the 
ticket-token manager. 
Step 4. The ticket-token manager compares h(K0) in IO0 with the hashed value of K0 in IO1.  If 
they are equal, the ticket-token manager replaces the ticket-token K0 with K1. 
Redemption transaction 
 If user Un wants to fulfill his ticket, three steps will be conducted as follows. 
Step 1. User Un presents his ticket T and ticket-token Kn to the service provider.  
Step 2. The service provider presents the ownership information IOn+1=(h(T), Kn, nil) to the 
ticket-token manager. 
Step 3. The ticket-token manager checks whether h(Kn) in IOn is equal to the hash value of Kn in 
IOn+1 given by user Un.  If they are equal, the ticket-token manager deletes all information on 
ticket T and notifies the service provider that the ownership information is valid.  Otherwise, the 
ticket-token manager will notify the service provider to reject user’s redemption. 
Matsuyama and Fujimura applied ticket-token to implement transference transaction and 
verification of the digital ticket ownership [15]. Their idea is simple and their implementation is 
easy; however, their system does not satisfy the divisible requirement.  That means if an issuer 
adopts Matsuyama and Fujimura’s system to implement an e-coupon (e.g., gift coupon) circulation 
environment, consumers may suffer a loss when what they buy is of less value than the e-coupon’s 
value.  In addition, their system neither supports the complex digital ticket circulation model nor 
discusses the brokers’ overissue problem.   
 To support two additional requirements: limited issue and flexible division, we propose our 
proposed digital right scheme for limited issue in Subsection 3.3.  In Subsection 3.4, we will 
 45
fields: (1) the identity of the broker IDB, (2) digital right template DRT, (3) the initial serial number 
of DR that is issued by the issuer SN_Start, (4) the initial serial number of DR that is issued by the 
issuer SN_End, (5) the issue date Issue_Date, and (6) the last issued serial number SN.  Sale 
Database is maintained by the broker and records the sold DR’s information.  Basically, sale 
database is composed of three tables: Customer table, Sale table and DRT table, shown in Figure 3.   
DRT Table: 
Sale Table:    
Customer Table:  
Figure 3. Sale Database’s Data Items  
In Figure 3, Sale_Date is the sale date.  IDU is the identity of the user.  CertU is the 
certificate of customer.  kij is the shared key between user Ui and broker Bj after Ui registered at Bj. 
Moreover, each proposed digital right scheme consists of five phases: initialization, issuance, 
purchasing, redemption and transference phases.  In our schemes, we assume that Public Key 
Infrastructure (PKI) has existed in the network already; each entity has her/his owner public and 
private key pair and certificate.  Our first scheme is designed to conquer the broker’s overissue 
problem.  The second scheme is the variant of our first one to achieve flexible division property.  
Both of them are based on our proposed digital rights trading model.  Therefore, in the following 
subsections, we first explain our notations in Subsection 3.1.  Next, we describe the components of 
our digital rights in Subsection 3.2.  In Subsection 3.3, we shall introduce our first digital right 
scheme.  In the Subsection 3.4, the variant one based on our first scheme is presented.  
 
3.1 The Notations  
For convenience, we list the notations in the following.  
Ui: The user i.  
Bj: The broker j. 
ISk: The issuer k. 
IDIS: The identity of the issuer/service provider. 
IDB: The identity of the broker. 
SN   IDU     DR   Sale_Date 
IDSP   DRT  SN_Start  SN_End  Issue_Date 
IDU   CertU   kij 
 47
to customers later.  Basically, a DR contains five components: digital right’s serial number SN, 
digital right template DRT, customer’s purchase date Sale_Date, the digital right’s expiration date 
Expi_Date, and a hash value HValid_Period (α).  DR does not contain any information related to its 
owner.  Only DRO represents the ownership of a digital right.  Therefore, when a customer 
purchases a digital right, the broker has to use his secret key to generate a DRO 
SignBj(H(DR,H(IDUi))) for the customer.  Only legal owner of a digital right can present a valid 
DRO.  In our proposed schemes, the customer has to present his DRO and DR together to prove his 
ownership of his digital right when he wants to redeem or transfer his digital right. 
3.3  The Proposed Digital Right Scheme with Limited Issue Property 
In this subsection, we present the proposed scheme with limited issue property.  The 
proposed scheme is divided five phases: initialization, issuance, purchasing, transference and 
redemption.  In our proposed scheme, users purchase their digital rights first.  Then, they can 
decide to transfer their digital rights to others or redeem their digital rights for specific services or 
goods.  Each DR is only allowed to be redeemed once.  The details of five phases are described in 
the following. 
Initialization Phase 
In this phase, issuers define their digital right templates DRTs, and record them in their Issued 
databases.  Brokers record their authorized DRTs in their DRT tables.  User Ui takes the 
following steps to register at the broker Bj before he wants to buy digital rights.  
Step 1. User Ui generates a session key Key first.  Next, user Ui encrypts his identity, Key and 
certificate Certi using brker Bj’s public key.  At last, he sends them to broker Bj for registration. 
Step 2. After Bj receives above message, Bj decrypts it using his private key first.  Then, Bj verifies 
user’s Certi, and checks whether Ui exists in his Customer Table using user’s Certi.  If he is not 
being, Bj generates a unique IDUi and a shared key kij.  Then, he encrypts IDUi and kij using the 
session key Key.  Finally, Bj sends encrypted data to Ui; and stores IDUi, Certi, kij in his Customer 
 49
1. IDUi,Request
3. DR,H(α) 2. Generate DR, DRO and H(α)
4. Verify DR 
and send 
payment if 
DR is valid
4. payment
5. Verify payment and store DR, 
DRO if payment is valid
6. Compare 
DR and DRO
5. DR, DRO, IDBj
 
Figure 4. Protocol for purchasing DRs 
Step 1. User Ui determines which DRT he wants to buy.  Next, user Ui sends his IDUi and request 
to broker Bj.   
Step 2. Broker Bj generates a new SN and checks the DRT Table to see whether SN is less than or 
equal to SN_End.  If SN is larger than SN_End, Bj has to reject Ui’s request.  Broker Bj generates a 
random number α.  Then, Bj generates DR and DRO pair according to the user Ui’s choice: 
DR:{SN,DRTi, Sale_Date, Expi_Date, HValid_Period (α)}, 
DRO:{SignBj(H(DR,H(IDUi)))}. 
Step 3. Broker Bj sends DR and H(α) to user Ui. 
Step 4. User Ui checks DR to see whether it meets his request or not.  If it does, user Ui sends 
payment instrument to broker Bj. 
Step 5. After receiving user’s payment, broker Bj verifies its validity.  If it is valid, broker Bj sends 
DRO to user Ui.  Meanwhile, broker Bj records (SN, IDUi, DR, Sale_Date) in his Sale Table and 
sends (DR, DRO, IDBj) to Ui. 
Step 6. After receiving the above messages, user Ui computes H(DR,H(IDUi)) and compares it with 
decrypted DRO to verify the integrity of his DR.  If they are equal, he stores (H(α), DR, DRO, IDBj) 
into his smart card for later redemption.  
Redemption phase  
In this phase, the user Ui wants to redeem his DRs to the issuer IS for getting services or goods.  
 51
note that SN has been redeemed and updates the status of DR as (DR, DRO, HCurr_Date-Sale_Date(α)).  
Finally, Bj sends the last status of DR to issuer ISk.  Otherwise, Bj notifies IS that DR is invalid. 
Step 5. If broker’s acknowledgement is positive, issuer ISk provides user Ui goods or services and 
returns the recipient, SignIS(H(DR, HCurr_Date-Sale_Date(α)), to user Ui.  Otherwise, issuer ISk rejects 
user’s request. 
Transference transaction  
Assume Ui and Uk are registered users.  If user Ui wants to transfer his DR to user Uk, eight steps 
will be performed as follows.  The protocol for transference transaction is shown in Figure 6.  
 
2. 
ID B
j,
ID U
i, 
DR
, H
Cu
rr_
Da
te-
Sa
le_
Da
te (α)
6. Generate a new DR', DRO',H(α')
3. Check the expiration date 
of DR
8. Store DR', DRO',H(α')
Uk
5. ID
Ui , DR, H
Curr_Date-Sale_Date (α), 
H(DRO,H(ID
Ui ||k
ij )), ID
Uk ] 
7. DR', DRO',H(α')1. 
Tra
ns
fer
en
ce
 re
qu
es
t
BjUi
3. 
Pa
ym
en
t in
str
uc
tio
n
4. 
H(
DR
O,
H(
ID U
i||
k ij)
)
    
Figure 6. Protocol for transference transaction 
Step 1. User Uk sends a digital right transference request to user Ui.   
Step 2. User Ui sends [IDBj, IDUi, DR, H
Curr_Date-Sale_Date(α)] to user Uk. 
Step 3. User Uk computes HExpi_Date -Curr_Date(HCurr_Date-Sale_Date(α)), and checks whether the result is 
equal to HValid_Period(α) of DR or not. If it is valid, user Uk sends a payment instruction to user Ui. 
Step 4. If the payment instruction is correct, user Ui sends [H(DRO,H(IDUi||kij))] to user Uk. 
Otherwise, the transaction is terminated. 
Step 5. User Uk sends [IDBj,IDUi, DR, H
Curr_Date-Sale_Date (α), H(DRO,H(IDUi||kij)), IDUk] to broker Bj. 
 53
digital rights without limited quantity. 
3.4 The Proposed Digital Right Scheme with Flexible Division Property 
Although our proposed scheme presented in Subsection 3.3 can help the issuer to issue limited 
digital rights, it could be damage user’s interest when it is applied to issue e-gift coupons, because 
our proposed scheme does not have the flexible division property.   
 In the existing paper-based gift coupon systems, if the good’s price is less than the value of gift 
coupon, users have two choices.  One is that users try to buy more goods and make sure the total 
price is equal to the value of gift coupon.  The other one is that users pay for goods by using their 
gift coupons and their interests are damaged.  To conquer the weakness of paper-based gift coupon, 
we try to extend our proposed scheme to achieve the flexible division and limited issue properties 
simultaneously. 
 In the variant scheme, we assume each DR has a fixed value.  The structure of digital right 
DR is modified as DR:{SN, DRTi, Sale_Date, Expi_Date, H Valid_Period (α), HDR_Value(β)}.  DR_Value 
is the fixed value of each DR.  In addition, the Sale Table maintained by the broker is modified to 
provide flexible division function, shown in Figure 7.  The balance equals DR_Value minus 
Pay_Value, where Pay_Value is the value paid by the user for some services or goods.  
 
Sale Table 
Figure 7. The modified SaleTable  
 
Our variant scheme also consists of initialization, issuance, purchasing, and redemption phases.  It 
also can support users to transfer their digital rights.  Basically, the initialization phase and 
issuance phase are the same as our proposed scheme presented in Subsection 3.3.  In the following 
paragraphs, we shall introduce the rest phases: purchasing phase, redemption phase and transference 
transaction of our variant scheme.    
SN   IDU    DR   Balance  Sale_Date 
 55
DRO, IDBj) in his smart card for later redemption.  
Redemption Phase 
In this phase, Ui redeems a part of DR value to issuer ISk.  Issuer ISk notifies broker Bj to check the 
Balance of user’s DR.  If the Balance is enough, then issuer ISk will permit user Ui’s redemption.  
Since our variant scheme can allow user to redeem a part of his digital right DR, we assume user Ui 
wants to redeem Pay_Value and Pay_Value is less than Balance of his DR.  The Protocol of variant 
scheme’s redemption phase is shown in Figure 9. 
Step 1. User Ui sends {DR, DRO, H(IDUi), H
Curr_Date-Sale_Date(α), HBalance(β), HBalancee-Pay_Value(β), 
Pay_Value, IDBj} to issuer ISk for redemption Pay_Value of his DR. 
Step 2. After receiving the above message, issuer ISk performs the following substeps. 
Step 2.1 Issuer ISk first computes H(DR, H(IDUi)) and compares it with the decrypted DRO.  If 
they are equal, the ownership of digital right is confirmed. 
Step 2.2 Issuer ISk checks HExpi_Date-Curr_Date(HCurr_Date-Sale_Date(α)) to see whether it is equal to 
HValid_Period(α) or not.  If they are equal, the digital right is not expired.  
Step 2.3 Issuer ISk uses his stored Balance to check HDR_Value-Balance(HBalance(β)) to see whether it is 
equal to HDR_Value(β). If they are equal, the HBalance(β) is correct. 
Step 2.4 Issuer ISk checks HPay_Value(HBalance-Pay_Value(β)) to see whether it is equal to HBalance(β).  If 
they are equal, the Pay_Value is verified. 
Step 3. Issuer ISk sends {SN, HBalance(β), HBalance-Pay_Value(β), Pay_Value} to broker Bj to perform 
on-line validation for double spending. 
Step 4. After receiving the above messages, broker Bj performs the following substeps. 
Step 4.1 Broker Bj retrieves Balance and HDR_Value(β) from his Sale Table by indexing his received 
SN.  
Step 4.2 Broker Bj uses his received HBalance(β) to compute HDR_Value-Balance(HBalance(β)).  If it is 
equal to HDR_Value(β) that is retrieved from DR in Sale Table, the validity of HBalance(β) is confirmed. 
 57
Step 1. User Uk sends a digital right transference request to user Ui.   
Step 2. User Ui sends [IDBj, IDUi,DR, τ=HCurr_Date-Sale_Date (α), υ=HBalance(β), Balance] to user Uk. 
Step 3. User Uk checks HExpi_Date-Curr_Date(HCurr_Date-Sale_Date(α)) to see whether it is equal to 
HValid_Period(α) of DR or not.  If they are equal, DR is not expired and user Uk sends a payment 
instruction to user Ui. 
Step 4. If the payment instruction is correct, user Ui sends [H(DRO,H(IDUi||kij))] to user Uk.  
Otherwise, the transaction is terminated. 
Step 5. User Uk sends [IDBj, IDUi,DR, τ=HCurr_Date-Sale_Date (α), υ=HBalance(β), Balance, 
H(DRO,H(IDUi||kij)), IDUk] to broker Bj. 
Step 6. After receiving the above messages, broker Bj performs the following substeps.  
Step 6.1 Broker Bj retrieves data from his Sale Table according to SN and computes 
μ={SignBj(H(DR,H(IDUi)))}.  Next, he retrieves the (IDUi, kij) from his Customer Table by indexing 
IDUi, computes H(μ, H(IDUi||kij)) and compares it with his received H(DRO,H(IDUi||kij)).  If they 
are equal, DR and the identity of Ui is verified. 
Step 6.2 Broker Bj computes HExpi_Date-Curr_Date(τ) and HDR_Value-Balance(υ) and compares them with 
HValid_Period(α) and HDR_Value(β) of DR, respectively.  If they are all equal, broker Bj marks the 
record of Sale Table as transferred. 
Step 6.3 Broker Bj generates two random numbers α′, β′ and then generates new DR′ and DRO′ for 
user Uk as follows: 
Sale_Date′=Curr_Date, Valid_Period′=Expi_Date-Curr_Date. 
DR′:{SN,DRTi, Sale_Date′, Expi_Date, H Valid_Period′ (α′), HDR_Value(β′)}, 
DRO′:{SignBj(H(DR′,H(IDUk)))}. 
Step 7. Broker Bj stores (SN, IDUk, DR′, Balance, Sale_Date′) into his Sale Table and sends (DR′, 
DRO′, Balance, H(α′), H(β′)) to user Uk. 
Step 8. After receiving the above messages, user Uk computes H(DR′,H(IDUk)) and compares it with 
 59
When registration is completed, the broker will get user’s certificate.  In other words, the broker 
can use user’s public key to encrypt transmitted data later.  Therefore, in our proposed scheme, the 
confidentiality is guaranteed.  
2. Anonymity:  
 In purchasing phase, the broker will generate a unique identity for each user.  In redemption 
phase, the user presents [DR, DRO, H(IDUi), H
Curr_Date-Sale_Date(α), IDBj] to the issuer.  Issuer IS can 
compute H(DR, H(IDUi)) using his received data, and compares it with that of DRO.  If they are 
equal, the DR’s ownership is confirmed.  Since user only presents his identity in a hashed value, 
issuer can verify DR’s ownership and he does not know who the owner is.  User’s anonymity is 
achieved in our scheme. 
3. Verifiability:  
 In our proposed scheme, there are three items, which need to be verified: DR, the ownership of 
DR and DR’s expiration date.  Since the broker will sign each digital right DR, any party can use 
broker’s public key to verify DR’s validity. The verifiability of DR’s ownership can be achieved by 
using the corresponding DRO, because DRO consists of DR and hash value of user’s identity.  
Once a user presents his DR and the hash value of his identity, the issuer and broker can easily 
verify the ownership of user’s DR.  The expiration date of DR also can be verified easily, because 
the user has to present [DR, DRO, H(IDUi), H
Curr_Date-Sale_Date(α), IDBj] to the issuer in the 
redemption phase.  Issuer just simply checks whether HExpi_Date-Curr_Date(HCurr_Date-Sale_Date(α)) is 
equal to HValid_Period(α) or not.  If they are not equal, it means DR is expired.  In transference 
transaction, buyers also can use the same way to check whether their DRs are valid or not.  To sum 
up, the verifiability is achieved in our proposed scheme. 
4. Preventing forgery:  
 In our proposed scheme, the broker signs each DRO.  Since DR is one component of DRO, 
and only the broker has his private key, no one can forge DR or DRO without being discovered.   
 61
transfer his DR to user Uk, user Ui sends [IDBj, IDUi,DR, H
Curr_Date-Sale_Date(α), Balance, 
H(DRO,H(IDUi||kij))] to user Uk.  Since the shared key kij is a secret shared between user Ui and the 
broker for a DR.  If user Uk can prevent a valid H(DRO,H(IDUi||kij)), user Ui can not deny that he 
promises to transfer his DR to user Uk.   
9. Trust manageability:  
 In the transference phase, the broker is in charge of the transference transaction and checks 
transferred DR status for seller and buyer.  If a dispute occurs, seller and buyer can ask the broker 
to provide evidence.  Therefore, our proposed scheme can achieve trust manageability.  
4.2 The Security of our variant scheme 
 The extension version inherits all properties from the proposed scheme presented in Subsection 
3.3.  Therefore, it can satisfy all security requirements mentioned in Subsection 4.1.  The most 
dissimilar part between the first scheme and our variant scheme is that the latter one can achieve 
flexible division property.  In this section, we shall focus on the security issue related to the 
flexible division property of DR.  Basically, our variant scheme may suffer from some attacks as 
follows.   
1. User Ui wants to modify Balance value of his digital right: 
 In the redemption phase, user has to present [DR, DRO, H(IDUi), H
Curr_Date-Sale_Date(α), 
HBalance(β), HBalancee-Pay_Value(β), Pay_Value, IDBj] to issuer.  Issuer can retrieve HDR_Value(β) from his 
received DR, computes HDR_Value-Balance(HBalance(β)), and checks whether they are equal.  If they are 
not equal, issuer will treat DR as invalid, and reject user’s request.  If user wants to pass issuer’s 
verification, he has to modify HDR_Value(β) of DR.  Since DRO contains the original DR, and DRO 
is signed by the broker.  User has no chance to modify his DR’s balance value and forge broker’s 
signature without being discovered by the issuer.   
2. Issuer may want to forge HBalance(β) in order to get more benefits.   
 For example, a user still has ten units of his digital right, but the issuer claims that the user 
 63
4. D. Chaum and S. Brands, “Minting Electronic Cash,” Spectrum, IEEE, Vol. 34, Issue 2, pp. 
30-34, Feb. 1997. 
5. E-Stamp Corporation, “E-Stamp,” http://www.e-stamp.com/. 
6. C. I. Fan, W. K. Chen and Y. S. Yeh, “Date Attachable Electronic Cash,” Computer 
Communications, Vol. 23, Issue 4, pp. 425-428, Feb. 2000. 
7. A. O. Freier, P. Karlton, and P. C. Kocher, “The SSL Protocol Version 3.0,” IETF Internet Draft, 
1996, http://wp.netscape.com/eng/ssl3/draft302.txt. 
8. K. Fujimura and Y. Nakajima, “General-Purpose Digital Ticket Framework,” Proceedings of the 
3rd USENIX Workshop on Electronic Commerce, Boston, Massachusetts, USA, pp. 177-186, Aug. 
1998. 
9. K. Fujimura, H. Kuno, M. Terada, K. Matsuyama, Y. Mizuno, and J. Sekine, 
“Digital-Ticket-Controlled Digital Ticket Circulation,” Proceedings of the 8th USENIX Security 
Symposium, Washington D.C., USA, pp. 229-238, Aug. 1999. 
10. K. Fujimura, “Digital-Right Trading Infrastructure (DRTI),” Proceedings of the 46th Internet 
Engineer Task Force (IETF), Washington D.C., USA, Nov. 1999, 
http://www.ietf.org/proceedings/99nov/slides/trade-drti/index.htm. 
11. K. Fujimura, M. Terada and J. Sekine, “A World Wide Supermarket Scheme Using Rights 
Trading System,” Proceedings of 7th IEEE International Conference on Parallel and Distributed 
Systems Workshops, pp.289- 294, Jul. 2000. 
12. K. Fujimura and D. Eastlake, “Requirement and Design for Voucher Trading System (VTS),” 
IETF Internet Draft, 2003, http://www.faqs.org/rfcs/rfc3506.html. 
13. K. Fujimura and M. Terada, “XML Voucher: Generic Voucher Language,” IETF Draft, 2005, 
http://www.ietf.org/internet-drafts/draft-ietf-trade-voucher -lang-07.txt. 
14. Gold & Silver Reserve, Inc., “E-Gold,” http://www.e-gold.com/. 
15. K. Matsuyama and K. Fujimura, “Distributed Digital-Ticket Management for Rights Trading 
System,” Proceedings of the 1st ACM Conference on Electronic Commerce, pp.110-118, Nov. 1999. 
16. T. Okamoto and K. Ohta, “Universal Electronic Cash,” Proceedings of the Advances in 
Cryptology-Crypto’91, Springer-Verlag, pp.324-337, 1992. 
17. R. Song and L. Korba, “How to Make E-cash with Non-repudiation and Anonymity,” 
Proceedings of the International Conference on Information Technology: Coding and Computing 
 65
第五章 計畫成果自評 
本章將就研究成果的產出做一評述。延伸自本計畫所產生的能量，除了下述已經完成投
稿並被接受的論文外，尚有其他已完成撰寫正在進行審查的國際期刊。未來也將會嘗試將以
下研究成果具體描述，以進行專利之申請。 
研究成果的產出 
(1) 期刊論文共 3 篇： 
Lin, C. C., Wu, C. C. and Chang, C. C., (2008): “Digital Right Schemes for Limited Issue and 
Flexible Division,” International Journal of Computer Science & Network Security, Vol. 8, No.2, 
pp.33-42, Feb. 2008. 
Chin-Chen Chang, Chia-Chen Lin* and, Yih-Shin Hu, “An SVD Oriented Watermark 
Embedding Scheme with High Qualities for the Restored Images,” International Journal of 
Innovative Computing, Information and Control (IJICIC), Volume 3, Number 3, June 2007, 
pp.609-620. (SCI)：研究浮水印機制，希望未來可以應用在數位權利管理上 
Wu, M. N., Lin, C. C. *and Chang, C. C., “Novel Image Copy Detection with Rotating 
Tolerance,” Journal of Systems and Software, Vol. 80, Issue 7, July, 2007, pp. 1057-1069. (SCI 
Expanded, Impact Factor: 0.952, Category: Computer Science, Theory & Methods) ：研究
複製影像偵測，希望未來可以在利用數位權利管理進行控管前可以先對侵權的數位內容進
行偵測。 
(2) 會議論文共 6 篇： 
※與本計畫直接相關 (四篇，其中一篇獲得最佳論文獎) 
Chia-Chen Lin and Jui-Sung He, “A Path Selection Algorithm for Mobile Agents-based 
e-Marketplace,” e-CASE2007International Joint Conference on e-Commerce, e-Administration, 
e-Society, and e-Education, Hongkong, 2007. (http://www.knowledgetaiwan.org/eCASE2007 
/index.htm ) (Best paper award) 
Chia-Chen Lin and Wen-Kuang Chou, “A Limited Issue e-Coupon Scheme Based on Digital 
 67
出席國際會議之參加心得與相關論文 
 本次獲補助出席國際會議的論文篇數共有五篇，茲列示如下: 
值得特別強調的是，其中一篇在 e-CASE 2007 獲得最佳論文獎。而本次最主要的參加經驗在
於兩方面: 
1.蒐集到與本次計畫執行相關的其他研究現況，其中包括：數位權利研究議題或是可能相關
的安全技術之現況。 
2.建立與國外學者的聯繫管道，同時也擴展個人在國際學術活動上的面向。 
3.讓個人有機會在個人所出席的各個國際知名研討會中擔任 session chairs，累積自己主持國際
會議之經驗。進而讓個人有機會於 2008 年首度擔任兩個 IEEE 研討會的 Program Chairs，扮
演舉辦國際知名研討會的重責大任。 
Chia-Chen Lin and Jui-Sung He, “A Path Selection Algorithm for Mobile Agents-based 
e-Marketplace,” e-CASE2007International Joint Conference on e-Commerce, e-Administration, 
e-Society, and e-Education, Hongkong, 2007. (http://www.knowledgetaiwan.org/eCASE2007 
/index.htm ) (Best paper award) 
Chia-Chen Lin and Wen-Kuang Chou, “A Limited Issue e-Coupon Scheme Based on Digital 
Rights Concept,” e-CASE2007International Joint Conference on e-Commerce, e-Administration, 
e-Society, and e-Education, Hongkong, 2007. (http://www.knowledgetaiwan.org/eCASE2007/ 
index.htm)  
Yinh-Hueih Chen, I-Chieh Hsu, Chia-Chen Lin and Ching-Yi Tsao, “A Conjoint Study of the 
Relationship between Website Attributes and Consumer Purchase Intentions,” Pacific Asia 
Conference on Information Systems 2008, Suzhou, China, July3-7 2008. (to appear) 
Chang, C. C., Chen, Y. H. and Lin, C. C., “Hiding Secret Information in a Color Palette Image 
with Hybrid Strategies,” Proceedings of The First International Conference on Ubiquitous 
Information Management and Communication, pp. 129-138, Feb. 2007. Seoul, Korea. 
Chia-Chen Lin, Chu-Shiuan Lai, Wan-Ya Liao, “A novel data hiding scheme for color images 
based on GSBTC,” Proceedings of the 2nd International Conference on Ubiquitous 
 69
附件 A：出席國際會議之相關論文 
Program information 
※Chia-Chen Lin and Jui-Sung He, “A Path Selection Algorithm for Mobile Agents-based 
e-Marketplace,” e-CASE2007International Joint Conference on e-Commerce, e-Administration, 
e-Society, and e-Education, Hongkong, 2007. (http://www.knowledgetaiwan.org/eCASE2007 
/index.htm ) (Best paper award) 
 
 
 
 
 
 
 71
※Yinh-Hueih Chen, I-Chieh Hsu, Chia-Chen Lin and Ching-Yi Tsao, “A Conjoint Study of the 
Relationship between Website Attributes and Consumer Purchase Intentions,” Pacific Asia 
Conference on Information Systems 2008, Suzhou, China, July3-7 2008. (to appear) 
 
 
 
 
 
 
 
 
 
※Chang, C. C., Chen, Y. H. and Lin, C. C., “Hiding Secret Information in a Color Palette 
