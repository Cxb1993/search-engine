 I
中文摘要 
本期計畫之研究目標為在不使用反射板的條件之下估計組織中有興趣區域的衰減係數，以
達到辨別乳癌與良性組織的目的。在利用反射板的條件下，聲速與衰減係數的重建方法已
於先前提出，該方法只需要使用由一個性線性陣列探頭所獲得之原始的通道信號。根據先
前臨床結果，透過相對聲速之閾值，18.5 m/sec以及－28.3 m/s，可達到將惡性腫瘤從纖維
腺瘤及脂肪中分隔出來的結果。然而，相對衰減係數無法與相對聲速一樣找出有效的單一
閾值。由於文獻中提出惡性腫瘤的衰減係數高於一般組織，故仍以評估衰減係數為本期計
畫研究目標。先前臨床實驗中，病人乳房組織可以順利被固定壓縮於實驗架構的比例很低，
所以需要研究出一個不需要反射板就可以估計出組織衰減係數的方法。根據文獻，利用信
號分段的方法來估計衰減係數。使用前期研究中的模擬數據評估此方法的成效，在此使用
0.284，0.536以及1.136 dB/cm/MHz三種衰減係數，以通道自發自收的信號來估計衰減係數。
由於有興趣區域與背景組織擁有不同的聲速，故在此利用接收聚焦的方式將經過特定點的
各組發射接收信號聚集起來，如此一來，非自發自收通道之信號也可以加以利用。然而所
得結果並不理想，呈現不規則性跳動。未來將針對頻譜分析改進估計的方法，盼能對於良
惡性病灶的區分有所裨益。 
 
關鍵字: 聲速、衰減係數、有興趣區域、信號分段。 
 
 III
目錄 
 
中文摘要．．．．．．．．．．．．．．．．．．．．．．．．．．．． I 
Abstract．．．．．．．．．．．．．．．．．．．．．．．．．．．．II 
目錄．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．III 
一、前言及文獻探討．．．．．．．．．．．．．．．．．．．．．．． 1 
二、研究目的．．．．．．．．．．．．．．．．．．．．．．．．．． 2 
三、計畫成果．．．．．．．．．．．．．．．．．．．．．．．．． 2 
四、計畫執行進度與遭遇困難．．．．．．．．．．．．．．．．．．25 
五、研究成果之重要性與卓越性．．．．．．．．．．．．．．．．．25 
六、計畫執行內容是否有修正．．．．．．．．．．．．．．．．．．．26 
七、參考文獻．．．．．．．．．．．．．．．．．．．．．．．．．．26 
附件二、可供推廣之研發成果資料表．．．．．．．．．．．．．．．．28 
附錄一:  
S.-W. Huang and P.-C. Li, “Computed tomography sound velocity reconstruction using 
incomplete data”, IEEE Transactions on Ultrasonics, Ferroelectrics and Frequency Control, Vol. 
51, No. 3, pp. 329-342, March, 2004. 
附錄二: 
S.-W. Huang and P.-C. Li, “Experimental investigation of computed tomography sound velocity 
reconstruction using incomplete data”, IEEE Transactions on Ultrasonics, Ferroelectrics and 
Frequency Control, Vol. 51, No. 9, pp. 1072-1081, September, 2004. 
附錄三: 
S.-W. Huang and P.-C. Li, “Ultrasonic computed tomography reconstruction of the attenuation 
coefficient using a linear array”, IEEE Transactions on Ultrasonics, Ferroelectrics and Frequency 
 1
行政院國家科學委員會專題研究計畫執行報告 
新參數超音波乳房影像技術(3/3) 
 
計畫編號：NSC95-2221-E-002-169 
執行期限：95年 8月 1日至 96年 10 月 31日 
主持人：李百祺   執行機構及單位名稱：國立台灣大學電機工程學系
國立台灣大學生醫電子與資訊學研究所 
E-mail: paichi@cc.ee.ntu.edu.tw 
 
 
一、前言及文獻探討 
 
乳癌是女性癌症中主要死因之一，早期發現早
期治療則其治癒率較高。以往，乳房攝影被視
為最好之非侵入式篩檢方法，因其可檢測出觸
摸不到與極小的腫瘤。然而乳房攝影使用了游
離輻射，而且具有較緻密的乳房年輕女性之乳
房攝影片通常難以判讀[1]。相較於乳房攝
影，超音波成像成為一個有效的輔助檢測方式
[2]。然而，使用傳統超音波回波灰階成像來
偵測乳癌通常受限於由乳房組織中聲速不均
勻性所引起的影像失真[3]。使用超音波，仍
然可能藉由重建聲速與衰減係數分布來偵測
乳癌。舉例來說，曾有報告指出癌症組織中的
聲速較脂肪來得快[4]，癌症組織中的衰減係
數較囊腫來得高[5]。典型的重建需要斷層掃
描式的架構，目的是從大量的投影中獲得重建
所需資料，而這樣的架構鮮少用於臨床。另一
種用於斷層掃描式的聲速與衰減係數重建方
法是使用線性陣列之有限角度斷層掃描
[6]-[8]。運用有限角度斷層掃描原理的成像設
備就如同應用於傳統B-mode成像之設備，因
此兩種成像方法都被考慮到了。此外，一塊金
屬反射板被置於乳房下方，在資料擷取的同
時，乳房是被壓縮的狀態。此方法亦需要選取
一個有興趣區域(region of interest, ROI)，用以
降低基於有限角度之斷層掃描式資料擷取所
造成的困難。在上一期報告中，已測試臨床應
用之效能。我們所使用的方法將針對組織的不
均勻性來修正，而此不均勻性只存在於乳房組
織而不存在於組織仿體中。在利用反射板的條
件下，聲速與衰減係數的重建方法已於先前提
出，該方法只需要使用由一個性線性陣列探頭
所獲得之原始的通道信號。根據先前臨床結
果，透過相對聲速之閾值，18.5 m/sec以及－
28.3 m/s，可達到將惡性腫瘤從纖維腺瘤及脂
肪中分隔出來的結果。然而，相對衰減係數無
法與相對聲速一樣找出有效的單一閾值。 
 
在計畫的第一年度，我們已完成下列工作項
目： 
 
1. 建立波傳遞模擬器，用以產生研究有限角度
之超音波穿透式斷層掃描重建演算法所需
的通道資料。 
2. 成功發展出利用平面波入射流體圓柱的散
射級數解來產生飛行時間差資料的技術。 
3. 建立適用於傳統電腦斷層掃描和有限角度
之超音波穿透式斷層掃描的兩個重建演算
法，可解出物體的聲速分佈。 
4. 以模擬檢驗第一個演算法應用於有限角度
之超音波穿透式斷層掃描的效果。 
5. 以模擬檢驗第二個演算法應用於有限角度
之超音波穿透式斷層掃描的效果，並確認
其可行性。 
6. 使用模擬資料分析第二個演算法之效能。 
7. 建立可使用線性陣列探頭進行有限角度之
超音波穿透式斷層掃描的實驗系統。 
8. 以實驗檢驗第二個演算法應用於有限角度
之超音波穿透式斷層掃描的效果，並確認
其可行性。 
9. 使用實驗資料分析第二個演算法之效能。 
10. 建立可進行傳統電腦斷層掃描之實驗系
統。 
 
在計畫的第二年度，我們已完成下列工作項
目： 
 
1.使用手動圈選之使用者介面，建立臨床資料
擷取裝置，以利進行傳統電腦斷層掃描之
臨床實驗系統。 
2.臨床資料之取得。 
3.設計一個理想的濾波器(optimal filter)來克
服組織信號在傳遞中因其聲速的不均勻性
所造成嚴重的失真。 
4.使用理想濾波器後配合上年度之演算法二
所得之實驗結果。 
 3
其中 t∆ 是求解過程中每一次迭代的時間增
量， x∆ 和 y∆ 表取樣間距， 2/ttt ∆+=+ ，
2/ttt ∆−=− ， ),2/(1 yxx ∆+=r ，
)2/,(2 yyx ∆+=r ，而 [
[ ]]),()2/(sin             
)2/exp(
0
),(
)0(
tptkcc
xikik xxx
tp
tc
rF
F 1r
π∆
⋅∆≡ −
∂
∂
+∆ ，    (9) 
[
[ ]]),()2/(sin             
)2/exp(
0
),(
)0(
tptkcc
yikik yy
y
tp
tc
rF
F 1r
π∆
⋅∆≡ −
∂
∂
+∆ ，   (10) 
[
[ ]]),()2/(sin               
)2/exp(
10
),(
)0(
1
+
−
∂
∂
∆
⋅∆−≡−∆
+
tutkcc
xikik
x
xx
x
tu
tc
x
rF
F 1r
π
，  (11) 
[
[ ]]),()2/(sin               
)2/exp(
10
),(
)0(
1
+
−
∂
∂
∆
⋅∆−≡−∆
+
tutkcc
yikik
y
yy
y
tu
tc
y
rF
F 1r
π
，  (12) 
其中 F和 1F− 分別為二維空間傅立葉轉換
(Fourier Transform)及反傅立葉轉換 (inverse 
Fourier Transform)， ),( yx kkk = 為波數 (wave 
number)， 0c 為均勻介質下的聲速。隨著疊代
的次數增加，聲波信號便會傳遞出去。當加上
relaxation absorption和 PML時，演算法則修
正為： [( )]
x
tptpt
x
tt
x
tc
yx
xx tueetu
+∆∂
+∂∆
−∆−∆−+ −=
)0(1
11
)),(),((
)(
1
2/)(2/)(
1
                 
),(),(
rr
r
rr rr
ρ
αα
， (13) 
[
⎥⎦
⎤⎟⎠
⎞⎜⎝
⎛
−=
+∆∂
+∂∆
−∆−∆−+
y
tptpt
y
tt
y
tc
yx
yy tueetu
)0(2
22
)),(),((
)(
2
2/)(2/)(
2
                 
),(),(
rr
r
rr rr
ρ
αα
，(14) 
 [
⎥⎦
⎤⎟⎠
⎞⎜⎝
⎛ −
−=∆+
+
=∂
∂∆
∆−∆−
∑−∆ +∞ ),()(                      
),(),(
1
),(
)(
2/)(2/)(
)0(
1 tS
tpeettp
x
i
N
i
x
i
x
tut
x
tt
x
tc
x
xx
rr
rr
r
r
rr
νκ
µµ
，(15) 
[
⎥⎦
⎤⎟⎠
⎞⎜⎝
⎛ −
−=∆+
+
=∂
∂∆
∆−∆−
∑−∆ +∞ ),()(                      
),(),(
1
),(
)(
2/)(2/)(
)0(
2 tS
tpeettp
y
i
N
i
y
i
y
tut
y
tt
y
tc
y
yy
rr
rr
r
r
rr
νκ
µµ
，(16) 
( , )/ 2 ( ) / 2 ( )
( )( , ) ( , ) xi i i
p tt tx x
i iS t e e S t t
τ τ
τ
−∆ −∆+ −⎡ ⎤= + ∆⎣ ⎦rr r rr r ，(17) 
( , )/ 2 ( ) / 2 ( )
( )( , ) ( , )
yi i
i
p tt ty y
i iS t e e S t t
τ τ
τ
−∆ −∆+ −⎡ ⎤= + ∆⎣ ⎦
rr r
rr r ，(18) 
其 中 yx αα , 是 吸 收 參 數 (absorption 
parameter)，控制 PML 中的衰退量，N 是
relaxation absorption所用的階(order)數， yixi SS ,
是和 relaxation absorption 有關的狀況變數
(state variable)， iyixiyx τννµµ ,,,, 也和 relaxation 
absorption有關。 
由於組織的不均勻是直接來自於組織物
理參數在空間上的變化，只要能適當地設定物
體的物理參數，相位偏移和波前振幅失真的現
象都能由波傳遞模擬器準確地產生。目前文獻
中已有許多關於乳房、腹部、胸腔組織之物理
結構的具體研究[12]，[13]，因此在使用模擬
器時物體之物理參數如聲速、密度及衰減係數
的設定都能有所依據，接近真正人體組織內的
分佈情形。因此，由模擬器產生的資料將足以
反映真實世界的情況。使用波傳遞模擬器的好
處，是較實驗易於控制變因，利於找出造成影
像品質不佳及改進方法的關鍵因素。以模擬器
和實驗系統配合，能更有效地進行成像技術的
研究，包含關於相位偏移和波前振幅失真的研
究在內。 
 
2. 建立飛行時間資料的產生器： 
 
在發展重建聲速分佈的演算法時，必需
能產生理想的飛行時間差資料，才能有效評估
演算法效能。波傳遞模擬器可用以產生飛行時
間差資料，但是費時太久。本年度我們發展出
利用平面波入射流體圓柱(fluid cylinder)的散
射級數解 [14]來產生飛行時間差資料的技
術，以解決這個問題。 
參考圖一(a)，考慮一聲波 );,( tyxw 沿 y+
方向在背景物理參數為 ( ))(, 00 fcρ 的線性介質
中傳播，其中 ρ 為密度，c 為聲速，f 為時域
頻率，且此介質中內含半徑為 a，圓心在 ( )11, yx
而物理參數為 ( ))(, 11 fcρ 的圓柱。因為
);,( 2 tyxw 的時域傅立葉轉換 );,( 2 fyxW 可由
);0,( txw 的時域傅立葉轉換 );0,( fxW 求得，假
設衰退可忽略，則若 );0,( txw 已知，便可算出
);,( 2 tyxw 。 
 
  
   
00 ,cρ
Transducer i transmits g(t) 
Transducer j receives eij(t) 
2yy =
0=y
 a  
),( 11 yx
11,cρ
(b) 
 );,( tyxw  
2yy =
0=y
00 ,cρ  a  
),( 11 yx
11,cρ
x+
y+
(a) 
 5
在發展演算法時，將要求 velocityC∈∆s 。另一方
面，如果 tsL ∆=∆ 成立，其解 s∆ 必須屬於下面
所有集合的交集： { } MitC iiti ,,2,1 ,,: Λ=∆==∆ lxx ，    (23) 
其中 ⋅⋅  , 表內積。由於量測的誤差和折射的效
應，所有
it
C∆ 的交集通常會是空集合，即滿足
所有飛行時間差的解不存在。因此，一個合理
的做法是不要求 s∆ 滿足所有的飛行時間差資
料，而只要使總誤差最小，也就是使以下的成
本函數(cost function)最小： 
∑
=
∆=Φ
M
i
ti
Cd
1
2s ),(
2
1)( xx ，         (24) 
其中 ),(
it
Cd ∆x 表 x和 itC∆ 的距離。我們根據下
面的演算法來求得一個屬於 velocityC ，且又使成
本函數最小的 s∆  [18]：任取一 velocity0 C∈x 為初
始值，並令 
( ) [
( ) 0 ,           
)1(1
1
1 velocity
≥⎥⎦
⎤
+−+−=
∑
=
+
∆ nPw
P
M
i
nCi
nCnnnn
it
x
xxx
γ
γλλ
，   (25) 
其 中 ]1,0[∈nλ  for all 0≥n ，
( ) ∞=−∑
≥0
1
n
nn λλ ， ]2,0(∈γ ，而 P為投影運算
子(projector)，則令 nn xs ∞→=∆ lim 即為所求。我們
稱這個演算法為演算法一。 
進行有限角度之超音波穿透式斷層掃描
時，由於僅能在有限的角度觀察到物體，而不
能取得環繞物體至少 180度的投影，因此如果
只利用飛行時間差的資訊來進行影像重建，亦
即求解 tsL ∆=∆ ，不易得到準確的聲速分佈。
在演算法一中，我們已加入合理的聲速上下
限，以期能增進重建的準確性。為了利用到成
像系統能同時取得飛行時間差和B-mode影像
的特性，我們進一步發展出一個以 B-mode影
像提供的物體區塊資訊來幫助重建聲速分佈
的演算法。如圖二所示，我們可利用 B-mode
影像找出某一軟組織和背景之間的邊界，然後
令該軟組織內和背景的聲速各為一待解之未
知常數，而邊界上的聲速則必須介於這兩個常
數之間，這相當於要求慢度差 s∆ 必須屬於 
[ ]
[ ]⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
≤≤∈=
===∈
≤
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
≤≤∈=
===∈
=
otherwise 
1,, ,   
,:
 if 
1,, ,   
,:
br
br
image
11r
1b1
11
11r
1b1
Nixxxx
xxx
xx
Nixxxx
xxx
C
brbrr
rbb
MN
rb
rbbrr
rbb
MN
iN
N
iN
N
ΛΛ
ΛΛ
Rx
Rx
， 
(26) 
其中 { }
b
,,, 21b NbbbI Λ≡ 為背景的索引集合，{ }
r
,,, 21r NrrrI Λ≡ 為該軟組織的索引集合，而{ }
br
,,, 21br NbrbrbrI Λ≡ 為邊界點的索引集合。當
物體中所含軟組織區域不只一個時，我們可仿
照上面的方面來建立 imageC 。 
 我們將要求 imagevelocity CC ∩∈∆s 。另一方 
面，則不要求 s∆ 滿足所有的飛行時間差資
料，而只要成本函數 ∑
=
∆=Φ
M
i
ti
Cd
1
2s ),(
2
1)( xx 最
小。一個屬於 imagevelocity CC ∩ ，且又使成本函
數最小的 s∆ 可由以下的演算法[18]得到：任取
一 imagevelocity0 CC ∩∈x 為初始值，並令 
( ) [
( ) 0 ,           
)1(1
1
1 imagevelocity
≥⎥⎦
⎤
+−+−=
∑
=
∩+
∆ nPw
P
M
i
nCi
nCCnnnn
it
x
xxx
γ
γλλ
， (27) 
則 nn xs ∞→=∆ lim 即為所求。我們稱這個演算法為
演算法二。 
在本年度中，我們將演算法一及演算法
二應用於以線性陣列探頭進行有限角度之超
音波穿透式斷層掃描的聲速分佈影像重建。利
用模擬所產生的飛行時間差資料，我們發現相
較於演算法一，演算法二可大幅提高準確度。 
 
4. 以模擬檢驗演算法一應用於有限角度之
超音波穿透式斷層掃描的效果： 
 
利用線性陣列進行穿射式超音波斷層掃
描，可重建出物體中的聲速分佈[19]，[20]。
如圖三所示，在陣列中選定發射位置及接收位
置，以取得此一發射／接收組合下的金屬反射
面回音信號。根據回音信號和發射信號之間的
時間延遲，可取得聲波沿著由發射位置、反射
面及接收位置所組成的路徑傳播所需的飛行 
 
介於 1c 和 2c 之間
 
1
c
2
c
 
圖二 演算法二中物體區塊資訊的利用方式。 
表一 電腦模擬時使用的參數。其中 c∞為時間頻率 f極大時的聲速。當 f = 5 MHz時，在腺體組
織、脂肪和腫瘤中的聲速分別為 1515.0 m/s、1468.3 m/s和 1542.7 m/s。 
 7
 
  (a)                (b) 
 
    (c)                (d) 
 
        (e)                 (f) 
圖五 (a)(b)案例 ×4 、(c)(d) ×2 和(e)(f) ×1 的重
建結果。 
 
飛行時間資料配合聲速上下限的設定所能取
得的聲速估計並不夠準確。 
 
5. 以模擬檢驗演算法二應用於有限角度之
超音波穿透式斷層掃描的效果： 
 
本年度我們也用模擬驗證演算法二的效
果。我們利用 B-mode影像提供的物體區塊資
訊來幫助重建聲速分佈，而飛行時間資料的產
生方式則和驗證演算法一時所用的方式相同。 
此部分的工作所考慮的所有範例，皆使
用具有 234個陣元、陣元間距為 0.15 mm的陣
列，而陣列和金屬反射板的距離是 35 mm。當
產生飛行時間資料時，陣列中每三個通道只有
一個被使用。另外， lowerc = 1450 m/s 而
upperc = 1580 m/s。 
我們利用計畫成果第一項所建立的波傳
遞模擬器來產生所有的 B-mode影像。為了模
擬出合理的斑點(speckle)影像，我們在不同區
域加上不同程度的隨機密度擾動，以造成聲阻
抗不區配，進而造成散射。空間複合法(spatial 
compounding) [23]則被用來降低斑點強度的
變異程度。我們只使用八個通道(通道 27、53、
79、105、130、156、182 和 208)來發射信號
以減少計算時間，且當通道 i發射時，只有符
合 26≤− ij 條件的接收通道 j被使用。每次發
射都產生一張子影像，而八張子影像經空間複
合法產生一張複合 B-mode影像。為了進一步
降低斑點雜訊，我們將複合 B-mode影像通過 
一個 e/1 截止(cutoff)在 0.152 mm 的二維低通
Gaussian濾波器以產生最後的 B-mode影像，
並施加單一的門檻(threshold)於這個影像以取
得物體的區塊資訊。 
我們首先考慮圖六(a)所示的物體，其背
景為腺體組織，中心含有一個半徑為 4 mm的
脂肪圓柱。施加於圓柱和背景的密度隨機擾動
分別為 0.5%和 2.5%。模擬所得的 B-mode 影
像如圖六(b)所示，而施加門檻於此 B-mode影
像所取得的脂肪區域則如圖六(c)所示。藉由
形態擴張(morphological dilation) [24]，脂肪區
域和背景間的邊界可由脂肪區域直接導出，如
圖六(d)所示。 
重建的聲速分佈和聲速誤差的影像分別
顯示在圖七(a)和(b)中。這個例子在表二中被
稱為案例 i。重建的脂肪區域聲速( reconc,c )為
1465.7 m/s，和 5 MHz 時脂肪的真正聲速
( m/s 3.1468truec, =c )只差 2.6 m/s，而重建的背
景聲速 reconb,c 和 5 MHz 時腺體組織的真正聲
速( m/s 0.1515trueb, =c )相同，此處的下標 c和 b
分別代表圓柱和背景。為了驗證演算法二的效
果，我們進一步考慮具有不同幾何結構和物理 
參數的物體，並將這些參數和對應的重建結果
列於表二中。我們也將重建結果顯示於圖七至
圖九中，並以案例 i為基準。在圖七中，我們
顯示圓柱的大小所造成的影響；在圖八中，我
們顯示圓柱中的聲速不同時所造成的影響；而 
 
 
 
          (a)                (b) 
 
         (c)                 (d) 
圖六  (a)物體結構。 (b)30-dB 動態範圍的
B-mode影像。(c)脂肪區域。(d)脂肪區域和背
景間的邊界。
 9
速誤差。 cc∆ 值分別為–2.6 m/s、–0.1 m/s和–1.4  
m/s，而 bc∆ 值分別為 0.0 m/s、0.1 m/s 和 0.0 
m/s。圖八(a)、(b)，圖八(c)、(d)，圖八(e)、(f)
及圖八(g)、(h)分別顯示圓柱聲速值( truec,c )為
1468.3 m/s、1493.2 m/s、1505.8 m/s和 1568.0 
m/s時的估計結果。 cc∆ 值分別為–2.6 m/s、–2.8 
m/s、–2.5 m/s和 2.0 m/s，而 bc∆ 值分別為 0.0 
m/s、0.0 m/s、0.0 m/s和 0.1 m/s。圖九(a)、(b)，
圖九(c)、(d)及圖九(e)、(f)分別顯示圓柱在中
心、較高及較低位置時的估計結果。 cc∆ 值分
別為–2.6 m/s、–1.2 m/s和–2.2 m/s，而 bc∆ 值
皆為零。 
 我們也考慮一個較複雜的物體，其結構 
如圖十(a)所示，背景為腺體組織，並含
有三個半徑為 4 mm的圓柱。位於左上角的第
一個圓柱之物理參數除了 m/s 1496,1,c =∞c
外，皆設為脂肪的物理參數，而下標 c和 1代
表第一個圓柱，下標∞代表高頻。位於右上角
的第二個圓柱設定為腫瘤，位於下方的的第三
個圓柱則設定為脂肪區域。施加於三個圓柱和
背景的密度隨機擾動分別為 0.5%、0.5%、
0.89%和 2.5%。圖十(b)顯示 B-mode影像，而
圖十(c)為施加–14 dB 的門檻於 B-mode 影像
所得的結果。在此案例中，背景中內含數個隨
機分佈的小區域，它們可以藉由施加一面積門
檻來移除，以得到圖十(d)所示之邊界。重建 
 
 
        (a)                 (b) 
 
        (c)                 (d) 
 
        (e)                 (f) 
圖九 (a)(b)案例 i、(c)(d) vii和(e)(f) viii的重建
結果。 
的聲速分佈和聲速誤差的影像分別顯示在圖
十 (e) 和 (f) 中 ， 而 m/s 3.0b =∆c 、
m/s 2.31,c −=∆c 、 m/s 2.12,c =∆c 、
m/s 4.03,c =∆c 。 
綜合來說，在所有考慮的案例中，使用
演算法二所得的聲速誤差大致在 1–3 m/s。雖
然為了減少計算時間，我們考慮的都是圓柱結
構的物體，但演算法二並不受限於任何 region 
of interest (ROI)的形狀。因此，模擬結果顯
示，使用現行的 B-mode 成像設備，以線性陣
列來取得聲速分佈是可行的。 
 
6. 使用模擬資料分析演算法二之效能： 
 
 因為演算法二使用區塊資訊來輔助聲速 
分佈的重建，邊界取得的準確度會直接影響到
重建的準確度。我們將表二中所列的八個案例
以真正的邊界取代 B-mode 影像所導出的邊
界，然後重新估計聲速值，並將結果記為 *cc∆ 和
*
bc∆ 列在表二中。一般而言，當 ROI的面積較
小時，偵測面積有誤差時的影響就會較大，這
點可由比較案例 i至 iii的結果看出。 
在邊界上重建誤差較大，主要是由於折
射效應較嚴重。然而，由於在軟組織中並不會
有急速變化的邊界發生，在邊界上真正的聲速 
 
 
         (a)                 (b) 
 
         (c)                 (d) 
 
         (e)                 (f) 
圖十  (a)物體結構。 (b)30-dB 動態範圍的
B-mode影像。(c)區塊資訊。(d)邊界。(e)聲速
分佈。(f)聲速誤差。 
 11
 
Cyst Fat 
High-Attenuation Tumor Irregular Tumor 
Radius 2 4 6 4 4 N/A 4 4 44 4
Glandular Tissue 
30 30 30 35 30 30 30 6 336
40 
40 
30 30 
G 
F 
F F C T IT F FC TF 
 
(a) 
 
30 30 30 35 30 30 30 6 33 6
18 
18 
12
12
12
30 30 
9
Thin Plastic-coated Aluminum Foil
Metal
G
F 
F F C T 
IT 
F 
F F
C T
Case I II III IV V VI VII VIII IX
44 344 21                          
 
(b) 
圖十二 (a)仿體的上視圖與(b)側視圖。 
 
理。DiPhAS 原本只能支援 64 個通道，經修
改後可以支援 128個通道，但是發射通道和接
收通道的編號不能相差 64，因為這些 
通道共用同一個多工器(multiplexer)。 
 
8. 以實驗檢驗演算法二應用於有限角度之
超音波穿透式斷層掃描的效果： 
 
我們利用前項工作成果所建立的實驗系
統配合一個仿體來檢驗演算法二應用於有限
角度之超音波穿透式斷層掃描的效果。仿體委
託 Dr. Ernest Madsen (Departmentof Medical 
Physics，University of Wisconsin-Madison，WI)
製造，其上視圖和側視圖分別如圖十二(a)和
圖十二(b)所示。仿體中不同材料用來模仿乳
房中不同的組織，它們的參數由 Dr. Madsen
提供，列於表四中。藉由將陣列沿 x 方向移
動，我們一共評估了九個案例，如表五所列。 
DiPhAS的發射波形可以任意調整，在擷
取通道資料時，我們選用的波形是一週的方
表四 仿體中材料的參數。 
 Material Sound velocity 
c at 5 MHz and
22 ℃ (m/s)
Density 
ρ
(g/cm3)
Attenuation 
coefficient α at 
5 MHz (dB/cm)
B-mode contrast 
relative to glandular 
tissue (dB) 
Glandular tissue 1522 1.03 2.74 ─ 
Fat 1464 0.94 2.21 –14 
Cyst 1570 1.02 0.78 <–14 
High-attenuation 
tumor 
1547 1.10 7.36 –12 
Irregular tumor 1553 1.07 4.26 –10 
 
 
表五 九個實驗案例的配置和估計結果。 
Case  ROI Sphere 
radius 
(mm) 
ROI position ΔcROI 
(m/s) 
ΔcG 
(m/s) 
I Fat 2 Center 2.6 0.3 
II Fat 4 Center 4.5 0.3 
III Fat 6 Center 4.3 0.2 
IV Cyst 4 Center 3.9 0.3 
V High-attenuation tumor 4 Center 10.5 –0.2 
VI Irregular tumor N/A Center 11.5 0.9 
VII Fat 4 6 mm above the center 4.9 0.6 
VIII Fat 4 6 mm below the center 2.5 0.0 
IX-1 Cyst 4 Upper-left corner  0.6 
IX-2 High-attenuation tumor 4 Upper-right corner 9.5 
IX-3 Fat 4 6 mm below the center 0.9 
0.6 
 
 13
對重建準確度的影響。所有案例背景的誤差都
很小。圖十五(a)、(b)，圖十五(c)、(d)及圖十
五(e)、(f)分別顯示脂肪圓球半徑為 2 mm、4 
mm和 6 mm時的估計結果，左欄顯示 B-mode
影像，右欄顯示聲速分佈。 ROIc∆ 值分別為 2.6 
m/s、4.5 m/s和 4.3 m/s，而 Gc∆ 值分別為 0.3 
m/s、0.3 m/s和 0.2 m/s。圖十六(a)、(b)，圖十
六(c)、(d)及圖十六(e)、(f)顯示球狀區域內為
不同組織(依序為囊腫、脂肪和高衰退腫瘤)時
的結果。 ROIc∆ 值分別為 3.9 m/s、4.5 m/s和 10.5 
m/s，而 Gc∆ 值分別為 0.3 m/s、0.3 m/s和–0.2 
m/s。圖十七(a)、(b)，圖十七(c)、(d)及圖十七
(e)、(f)分別顯示脂肪圓球在較高、中心及較
低位置時的結果。 ROIc∆ 值分別為 4.9 m/s、4.5 
m/s和 2.5 m/s，而 Gc∆ 值分別為 0.6 m/s、0.3 m/s
和 0.0 m/s。最後，圖十八(a)和(b)分別顯示案
例 VI 的 B-mode 影 像 和 聲 速 分 佈 。
m/s 5.11IT =∆c ， m/s 9.0G =∆c ，而不規則腫
瘤和腺體組織背景間的原始聲速差是 31 
m/s。由圖十八(b)可看出取出的邊界有誤差，
這影響到聲速估計的準確度。 
雖然我們實驗所用的仿體內所含的物體 
具有三維結構，使用一維線性陣列配合演算法
二來估計聲速仍然得到相當好的準確度，在
11個 ROIs 中，有八個的誤差小於 5 m/s。即 
 
 
 
         (a)                (b) 
 
         (c)                (d) 
 
         (e)                (f) 
圖十五 (a)(b)案例 I、(c)(d) II和(e)(f) III的重
建結果。 
 
         (a)                (b) 
 
         (c)                (d) 
 
         (e)                (f) 
圖十六 (a)(b)案例 IV、(c)(d) II和(e)(f) V的重
建結果。 
 
使腫瘤物體的估計值誤差較大，對這些案例而
言，組織種類還是可能成功判別，因為我們知
道 ROI 內的聲速比背景高，因此不可能是脂
肪，而腫瘤的聲速一般而是比較高的。由仿體 
 
 
         (a)                (b) 
 
         (c)                (d) 
 
         (e)                (f) 
圖十七 (a)(b)案例 VII、(c)(d) II 和(e)(f) VIII
的重建結果。 
 15
解析度為 12位元，取樣率為 100 MB/s之取樣
器 (CompuScope 12100，Gage，Montreal，
Quebec，Canada)取樣後送至電腦貯存和處
理。由這個系統，可以建立仿體內部的聲速分
佈。 
 
在計畫的第二年度，我們已完成下列工作成
果：     
    使用傳統超音波回波灰階影像來找尋乳
房中的腫瘤常受限於乳房組織中聲速不均勻
性[3]導致對比解析度的降低與乳癌偵測正確
性的降低。然而，除了灰階影像外，聲速與衰
減於乳房中的分布在診斷上是很有用的資
訊，因為聲速在乳癌組織中較在脂肪中快速，
衰減係數在乳癌組織中較在囊腫中大。故本研
究致力於重建乳房中的聲速分佈與衰減係數
分佈，以達到區分組之種類的目標，來降低陰
性病理切片之比率。 
在進入成果呈現以前，先來簡介一下此研
究所需之演算法。 
圖二十二為信號發射與接收示意圖。根據
先前成果[6]-[8]以及[16]，使用水當作病人乳
房信號的對照組。假設水中聲速( 0c )為1522 
m/sec，其衰減係數( 0α )為0 dB/cm/MHz。若超
音 波 信 號 之 往 返 飛 行 時 間 (round-trip 
time-of-flight)分別為 0t 於水中與 1t 於乳房組織
中，則： 
0 0
0
1
L L
t dl s dl
c
= =∫ ∫              (32) 
1 1
1
1 ( , )
( , )L L
t dl s x y dl
c x y
= =∫ ∫       (33) 
L為信號所經路徑，定義為慢度(slowness)。
其中 1( , )s x y 為聲速 1( , )c x y 之倒數，則飛行時
間差( t∆ )為 
 
 
圖二十二  信號發射接收示意圖。 
∫∫ ∆=−=−=∆
LL
dlyxsdlsyxsttt ),(]),([ 0101 . (34) 
又假設衰減在傳遞過程中與頻率成線性關
係，則 
    fαβ =  (dB/cm)           (35) 
以 0A 與 1A分別代表信號在水中以及在乳房組
織中之振幅，則：  
       
oA
AA 110log20−=∆  (dB)        (36) 
       ∫=∆
L
dlyxA ),(' α (dB/MHz)       (37) 
在此 'A∆ 為在 A∆ 的頻譜中所得到的一階近似
曲線(1st order polynomial curve fitting)之斜
率。若將式(34)與式(37)中的積分形式寫成離
散形式(discrete form)，則： 
∑∑
= =
∆=∆
N
n
ij
M
m
ij nmlnmst
1 1
),(),(       (38)       
∑∑
= =
=∆
N
n
M
m
ij nmlnmA
1 1
),(),(' α        (39) 
接著在重建過程中，將灰階影像切割成N*M個
像素(pixel)，且ij代表第i個陣元發射及第j個陣
元接收。此外，若將式(38)與式(39)寫成矩陣
的形式，則 
          L s t∆ = ∆                (40) 
            'L Aα = ∆               (41) 
圖二十三為臨床實驗系統架構圖，圖中右
邊為臨床實驗擷取裝置，惟有金屬反射板才可
讓整個實驗架構原理類似X光乳房攝影。系統
中使用的線性陣列 (L6/128， STI， State 
College，PA)具有128個通道，陣元間距為0.3 
mm，中心頻率為5.57 MHz，–6 dB頻寬為4.10 
MHz。我們使用一個可由任何選定的通道去發
射使用者自訂信號的可程式化數位陣列系統
(digital phased array system ， DiPhAS ，
Fraunhofer IBMT，Ingbert，Germany)來擷取
通道資料。經過一張數位I/O(input output)卡
(PCI-7300A, ADLINK)後儲存於電腦，取樣頻
率20 MHz。 
 
 
 
圖二十三  臨床實驗系統架構圖。 
 
在計畫的第二年度，我們已完成下列工作成
 17
則 
             wfb =⊗              (46) 
其中w為b與 f 的旋積(convolution)，若將其簡
化成一個乘法，則 
             wfB =⋅               (47) 
其 中 B 為 b 的 旋 積 矩 陣 (convolution 
matrix)[31]。根據最小平方法 (Least Square 
Method)，可由下列式子得到 f ： 
          wBBBf ')'( 1−=           (48) 
最後我們所需要的輸出為 d ，故 
              dfB =⋅ '             (49) 
其中 'f 是由 f 經下列兩步驟轉換而來： 
步驟一： 
讓信號頻譜頻率為零時之總能量比為 1(DC 
gain=1)，如此一來，衰減係數之計算才不至
於失真。意即若 f 在頻譜頻率為 0時之總能量
為 k，則將其正規化(normalize)至 f /k，也就
是 'f 。 
步驟二： 
消除因信號傳遞時的延遲(delay)所造成的線 
性相位(linear phase)項。首先，先找到 f 的快 
速傅立葉轉換(fast Fourier transform, FFT)，交 
換(swap)FFT 左右兩邊，以及展開(unwrap)相 
位。接著，利用固定基頻(baseband)中固定 0  
MHz 的那一點，消除線性相位項，使得新的 
相位分佈當作最適化濾波器的相位，也就是 
'f 的相位。 
 圖二十六(c)與(d)分別為圖二十六(a)與(b)
加窗(windowing)輸出。由圖可見，圖二十六(e)
較圖二十六(b)與圖二十六(c)來得相似。圖二
十七為加上最適化濾波器前與加上最適化濾
波器後之相關係數的比較，加上最適化濾波器
後相關係數全部有效提高至 0.75 以上，屬高
度相關。 
 
4. 使用最適化濾波器與演算法二所得之實
驗結果： 
 
 使用最適化濾波器後，得到下列結果。
圖二十八為相對聲速結果，發現存在著相對聲
速上閾值(+50 m/sec)與下閾值(-50 m/sec)來區
隔惡性腫瘤、纖維腺瘤以及脂肪。 
[32]中，含有纖維腺瘤的平均背景聲速為
1529  m/sec，而含有惡性腫瘤的平均背景聲
速為 1463m/sec。另外，由[33]知，惡性腫瘤
的平均聲速為 1550±32 m/sec，纖維腺瘤的平
均聲速為 1584±27 m/sec。由上可知，我們可
以利用一個閾值(threshold)來分離惡性腫瘤與
纖維腺瘤。 
臨床上，脂肪與油滴(oil cyst)的灰階影像
相似，但其聲速表現大不相同，油滴有較高之
聲速，約 1540 m/sec，脂肪的聲速大約為 1460 
m/sec [34]。圖二十八中，油滴表現出較高的
相對聲速。 
 
 
圖二十六 (a)  水的信號振幅。 
 
 
圖二十六 (b)  原始乳房組織的信號振幅，未
加最適化濾波器。 
 
 
圖二十六 (c)  加窗後的水信號。 
 19
造成的影響，試比較使用最適化濾波器前後的
重建結果差異。圖三十一 (a)至(e)所列為低相
關係數之病人 1(CA)、3(CA)、7(FA)、9(FA) 及
16(fat)號的結果。聲速方面，圖三十一(a)與(c)
中，1、3 及 9 號病人之數據在使用最適化濾
波器前後的結果幾乎相同，但在此同時，7、
16 號病人的有興趣區域聲速與背景聲速在使
用最適化濾波器後的結果較使用最適化濾波
器前分開許多。衰減係數方面，圖三十一(b)
與(d)，使用最適化濾波器前之衰減係數分散
於-0.4~0.7 dB/cm/MHz，使用後則落於 0~0.6 
dB/cm/MHz。根據先前仿體結果，惡性腫瘤、
腺體組織、脂肪的衰減係數分別為 1.10、
0.55、0.44 dB/cm/MHz，故若以相對衰減係數
分佈來看，可說明最適化濾波器有助於降低部
分失真影響。 
 
sound velocity before and 
after using the optimal filter
patient number
0 2 4 6 8 10 12 14 16 18
m
/s
ec
1300
1350
1400
1450
1500
1550
1600
ROI, before
ROI, after
background, before
background, after
 
圖三十一 (a)  病人 1(CA)、3(CA)、7(FA)、
9(FA)及 16(fat)號為相關係數偏低者，使用最
適化濾波器前後的聲速分佈。 
attenuation coefficient before and 
after using the optimal filter
patient number
0 2 4 6 8 10 12 14 16 18
dB
/c
m
/M
H
z
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
ROI, before
ROI, after
background, before
background, after
 
圖三十一 (b)  病人 1(CA)、3(CA)、7(FA)、
9(FA)及 16(fat)號為相關係數偏低者，使用最
適化濾波器前後的衰減係數分佈。其中，No.3
病人最適化濾波器前的有興趣區域衰減係數
為 0.76 dB/cm/MHz。 
 
relative sound velocity before and 
after using the optimal filter
patient number
0 2 4 6 8 10 12 14 16 18
dB
/c
m
/M
H
z
-250
-200
-150
-100
-50
0
50
100
before
after
圖三十一 (c)  病人 1(CA)、3(CA)、7(FA)、
9(FA)及 16(fat)號為相關係數偏低者，使用最
適化濾波器前後的相對聲速分佈。 
 
relative attenuation coefficient before 
and after using the optimal filter
patient number
0 2 4 6 8 10 12 14 16 18
m
/s
ec
-0.6
-0.4
-0.2
0.0
0.2
0.4
0.6
0.8
before
after
 
圖三十一 (d)  病人 1(CA)、3(CA)、7(FA)、
9(FA)及 16(fat)號為相關係數偏低者，使用最
適化濾波器前後的相對衰減係數分佈。 
 
relative sound velocity vs. relative attenuation 
coefficient, before and after using the optimal filter
relative sound velocity (m/sec)
-250 -200 -150 -100 -50 0 50 100
re
la
tiv
e 
at
te
nu
at
io
n 
co
ef
fic
ie
nt
 
(d
B
/c
m
/M
H
z)
-0.6
-0.4
-0.2
0.0
0.2
0.4
0.6
0.8
No.1-CA, before
No.1-CA, after
No.3-CA, before
No.3-CA, after
No.16-fat, before
No.16-fat, after
No.7-FA, before 
No.7-FA, after
No.9-FA, before
No.9-FA, after
圖三十一 (e)  病人 1(CA)、3(CA)、7(FA)、
9(FA)及 16(fat)號為相關係數偏低者，使用最
適化濾波器前後的相對聲速與相對衰減係數
之分佈。 
 21
 
attenuation coefficient: right-down
area of ROI4 (mm*mm)
0 20 40 60 80 100 120 140at
te
nu
at
io
n 
co
ef
fic
ie
nt
(d
B
/c
m
/M
H
z)
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
2.2
ROI1(CA)
ROI2(cyst)
ROI3(fat)
ROI4(B')
Background
 
圖三十四 (b)  第四個有興趣區域位於灰階
影像上之右下方，所得衰減係數結果。灰階影
像之總面積為 1038 mm2。 
 
sound velocity_left-down
area of ROI4 (mm*mm)
0 20 40 60 80 100 120 140
so
un
d 
ve
lo
ci
ty
 (m
/s
ec
)
1460
1480
1500
1520
1540
1560
1580
1600
ROI1(CA)
ROI2(cyst)
ROI3(fat)
ROI4(B')
Background
 
圖三十四 (c)  第四個有興趣區域位於灰階
影像上之左下方，所得聲速結果。灰階影像之
總面積為 1038 mm2。 
 
attenuation coefficient: left-down
area of ROI4 (mm*mm)
0 20 40 60 80 100 120 140at
te
nu
at
io
n 
co
ef
fic
ie
nt
(d
B
/c
m
/M
H
z)
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
2.2
ROI1(CA)
ROI2(cyst)
ROI3(fat)
ROI4(B')
Background
 
圖三十四 (d)  第四個有興趣區域位於灰階
影像上之左下方，所得衰減係數結果。灰階影
像之總面積為 1038 mm2。 
 
sound velocity: middle-up
area of ROI4 (mm*mm)
0 20 40 60 80 100 120 140
so
un
d 
ve
lo
ci
ty
 (m
/s
ec
)
1440
1460
1480
1500
1520
1540
1560
1580
1600
ROI1(CA)
ROI2(cyst)
ROI3(fat)
ROI4(B')
Background
 
圖三十四(e)  第四個有興趣區域位於灰階影
像上之正上方，所得聲速結果。灰階影像之總
面積為 1038 mm2。 
 
attenuation coefficient: middle-up
area of ROI4 (mm*mm)
0 20 40 60 80 100 120 140at
te
nu
at
io
n 
co
ef
fic
ie
nt
 (d
B/
cm
/M
H
z)
-0.5
0.0
0.5
1.0
1.5
2.0
2.5
ROI1(CA)
ROI2(cyst)
ROI3(fat)
ROI4(B')
Background
 
圖三十四(f)  第四個有興趣區域位於灰階影
像上之正上方，所得衰減係數結果。灰階影像
之總面積為 1038 mm2。 
 
sound velocity of CA-1 (patient No.1)
area of ROI2 (mm*mm)
0 100 200 300 400
so
un
d 
ve
lo
ci
ty
 (m
/s
ec
)
1440
1460
1480
1500
1520
1540
1560
1580
ROI1 (CA)
ROI2 (B')
Background
 
圖三十五(a)  在 1 號病人(CA)的灰階影像
中，選取不同面積之第二個有興趣區域。所得
聲速結果。其灰階影像之總面積為 1622 mm2。 
 
 23
 
 
圖三十七 相對衰減係數結果。 
 
所示。三個 ROI 種類分別之聲速與衰減係數
及其標準差則列於表六，三個 ROI 種類之相
對聲速與相對衰減係數則列於表七。在聲速方
面，利用兩個相對聲速的閾值(threshold)：18.5 
m/s 與–28.3 m/s，可有效從 18 個病例中成功
區分出 14個病例，不包含油囊腫，其相對聲
速–9.4 m/s。儘管如此，在衰 
減係數方面，無法找出閾值將三種不同的有興 
趣區域作區分。 
 
3.在沒有金屬反射板的實驗架構下建立出衰
減係數估計方法： 
 
    上述研究結果中，透過相對聲速之閾值，
18.5 m/sec以及－28.3 m/s，可達到將惡性腫瘤
從纖維腺瘤及脂肪中分隔出來的結果。然而，
相對衰減係數無法與相對聲速一樣找出有效
的單一閾值。 
    由於文獻中提出惡性腫瘤的衰減係數高
於一般組織，故仍以評估衰減係數為本期計畫
研究目標。先前臨床實驗中，病人乳房組織可
以順利被固定壓縮於實驗架構(如圖二十三)
的比例很低，所以需要研究出一個不需要反射
板就可以估計出組織衰減係數的方法。根據文 
 
表六 惡性腫瘤(CA)、纖維腺瘤(FA)與脂肪。 
(fat)之平均聲速與平均衰減係數。 
 Sound Velocity 
(m/s) 
Attenuation 
Coefficient 
(dB/cm/MHz) 
CA 1530.9±36.2 0.66±0.52 
FA 1499.8±26.8 0.68±0.66 
Fat 1464.8±45.1 0.63±0.61 
 
表七 惡性腫瘤(CA)、纖維腺瘤(FA)與脂肪。 
(fat)之平均相對聲速與平均相對衰減係數。 
 Relative Sound 
Velocity 
(m/s) 
Relative 
Attenuation 
Coefficient 
(dB/cm/MHz) 
CA 49.8±35.2 0.21±0.58 
FA 2.6±27.3 0.27±0.62 
Fat –25.1±44.9 –0.02±0.59 
 
圖三十八 信號分段的示意圖。 
 
獻[35]-[37]，利用信號分段的方法來估計衰減
係數。如圖三十八，將一條 A line信號分割成
許多小段，但相鄰兩段信號之間有一半長度的
重複。在組織中的，信號的衰減係數線性正比
於信號的中心頻率，故可藉由中心頻率的偏移
來估計出衰減係數。 
 
以下是衰減細數估計的基本理論。 
 
  在組織中，衰減量與信號傳遞頻率呈現性
關係，如式(27)。 
    由於衰減與頻率與行近距離皆有關，當發
射波在組織中行進時，其頻率成分將受到影響
而有所改變。假設一寬頻的高斯脈衝波
(Gaussian pulse)其功率頻譜(power spectrum) 
為 
          
20( )2( )
f f
tS f e σ
−−= ,        (50) 
其中 0f 為發射波的中心頻率，σ 為發射波的頻 
寬。若忽略後散射(backscattering)，由深度R  
所得信號來回(round trip)信號為
20( ) 42 2 4( , ) ( )
f f RfRf
r tS R f S f e e
αα σ
−− −−= = ,  (51) 
將式(3.13)重新整理後，可得 
 
2 21
0( ) 4 ( )2( , )
f f R f R
rS R f e
α σ ασ
−− − −= ,     (52) 
其中， 1f 為接收信號的中心頻率， 
RF data, A-line 
 25
chosen frequency range: 3-6 MHz
50 50 z 100 100 z 200 200 z
dB
/c
m
/M
H
z
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
alpha= 0.284 dB/cm/MHz
alpha= 0.568 dB/cm/MHz
alpha= 1.136 dB/cm/MHz
圖四十一 利用特定通道的自發自收信號所
估計之衰減係數結果(平均值±標準差)。介質
衰減係數0.284(黑色圓形)、0.568(紅色圓型)
與1.136(藍色三角形) dB/cm/MHz，中心頻率
計算範圍為3-6 MHz。 
 
的部份。圖四十一為0.284、0.568與1.136 
dB/cm/MHz三組衰減係數所得結果，找尋的中
心頻率範圍為3-6 MHz。 幾乎所有情形下，
補零後的結果皆變小，此情形來自於以下之可
能：補零前後找到的中心頻率大小改變，造成
頻率偏移變小，所以所估計出來的衰減係數值
變小。 
 
四、計畫執行進度與遭遇困難 
 
第一年： 
本計畫已如計畫書所列，如預期完成，且部分
成果已有超前。 
 
第二年： 
本計畫已如計畫書所列，如預期完成。所遭遇
困難主要為固定乳房組織時，可能因呼吸造成
擷取信號期間有滑動的現象，所幸資料擷取時
間都在數秒鐘以內，並且提醒病人閉氣，故呼
吸移動的影響可忽略。另一方面，並非所有位
置的有興趣區域都可以被固定，以達到擷取資
料的目的。而且並非所有病人之病灶所在(即
有興趣區域)都可順利被固定於實驗所設計之
裝置內(具有金屬反射板)，使得現階段臨床數
據之收集受到極大限制。因此，希望於未來發
展出不使用金屬反射板時仍然可重建出聲速
的方法，以利灰階影像之修正，進而提高影像
之對比解析度。 
 
第三年： 
在現有文獻中，關於衰減係數評估的研究，幾
乎都是以有反射板的實驗架構為主，由此可
見，不用反射板來評估衰減係數存在許多困
難。若遇到衰減係數很小的情形，信號分段的
長度不足夠則造成頻率偏移量不夠，估計上所
產生的誤差較大，如圖四十二所示，在衰減係
數為0.284 dB/cm/MHz時，估計結果與理論值
之比值在補零前後皆小於0.35，反觀衰減係數
為0.568 dB/cm/MHz與1.136 dB/cm/MHz時，補
零前約在0.45上下，補零後在信號分段較長的
部份亦有較高的比值。以上的實驗數據結果不
如預期，未來將朝超音波電腦輔助診斷中關於
灰階影像值的參數分析來幫助臨床超音波診
斷。 
chosen frequency range: 3-6 MHz
50 50 z 100 100 z 200 200 z
ra
tio
=m
ea
n/
al
ph
a
0.15
0.20
0.25
0.30
0.35
0.40
0.45
0.50
0.55
alphs= 0.284 dB/cm/MHz
alphs= 0.568 dB/cm/MHz 
alpha= 1.136 d/cm/MHz
圖四十二 介質衰減係數0.284(黑色圓形)、
0.568(紅色圓型 )與 1.136(藍色三角形 ) 
dB/cm/MHz之估計結果(平均值)與理論值之
比值。 
 
五、研究成果之重要性與卓越性 
 
計畫第一年度完成事項的重要性如下: 
 
 本計畫成果之重要性在於針對近年來發
生率及死亡率皆急遽增加之乳癌，提供了一個
先進有效之診斷新技術。此技術並可和 X 光
乳房攝影及其他臨床檢查相輔相成。本研究計
畫之卓越性在於使用此創新之前端成像技
術，可提供新的影像參數，並實現於現有之陣
列成像系統架構中，且能大幅提高其臨床診斷
之價值。建立在這些前端影像技術之下，亦可
以進一步對相關之後端影像分析及電腦輔助
診斷方法有直接之助益。 
 
計畫第二年度完成事項的重要性如下: 
 
    本期研究中，證實此實驗系統裝置，
如圖二所示，在臨床實驗中之可行性。有
了此實驗裝置，如圖二右半部所示，在資
料擷取過程中，可確實固定線性陣列探
頭。透過最適化濾波器處理，已降低失真
 27
37, no. 3, pp. 1490–1499, 1990. 
[18] P. L. Combettes and P. Bondon, 
“Hard-constrained inconsistent signal 
feasibility problems,” IEEE Trans. Signal 
Processing, vol. 47, no. 9, pp. 2460–2468, 
1999. 
[19] M. Krueger, A. Pesavento, and H. Ermert, 
“A modified time-of-flight tomography 
concept for ultrasonic breast imaging,” in 
Proc. IEEE Ultrason. Symp., 1996, pp. 
1381–1385. 
[20] M. Krueger, V. Burow, K. M. Hiltawsky, 
and H. Ermert, “Limited angle ultrasonic 
transmission tomography of the compressed 
female breast,” in Proc. IEEE Ultrason. 
Symp., 1998, pp. 1345–1348. 
[21] E. L. Madsen, J. A. Zagzebski, G. R. Frank, 
J. F. Greenleaf, and P. L. Carson, 
“Anthropomorphic breast phantoms for 
assessing ultrasonic imaging system 
performance and for training 
ultrasonographers: Part I,” J. Clin. 
Ultrasound, vol. 10, no. 2, pp. 67–75, 1982. 
[22] A. I. Nachman, J. F. Smith, and R. C. Waag, 
“An equation for acoustic propagation in 
inhomogeneous media with relaxation 
losses,” J. Acoust. Soc. Amer., vol. 88, no. 3, 
pp. 1584–1595, 1990. 
[23] M. O’Donnell and S. D. Silverstein, 
“Optimal displacement for compound image 
generation in medical ultrasound,” IEEE 
Trans. Ultrason., Ferroelect., Freq. Contr., 
vol. 35, no. 4, pp. 470–476, 1988. 
[24] R. C. Gonzalez and R. E. Woods, Digital 
Image Processing. 2nd ed. Reading, MA: 
Addison-Wesley, 2002. 
[25] R. M. Lemor, P. K. Weber, P. K. Fonfara, C. 
Guenther, H. J. Welsch, and M. L. Hoss, “A 
new combined open research platform for 
ultrasound radio frequency signal 
processing,” in Proc. IEEE Ultrason. Symp., 
2003, pp. 33–37. 
[26] Q. Zhu and B. D. Steinberg, 
 “Large-transducer measurements of 
 wavefront distortion in the female breasts,” 
 Ultrason. Imaging, vol. 14, pp. 276-299, 
 1992. 
[27] Q. Zhu and B. D. Steinberg, “Modeling, 
 measurement and correction of wavefront 
 distortion produced by breast specimens,” 
 IEEE Ultrason. Symp., vol.3, pp. 
 1613-1617, 1994. 
[28] Q. Zhu and B. D. Steinberg, “A toward 
 inverse filtering approach for ultrasonic 
 wavefront compensation,” IEEE Ultrason. 
 Symp., vol.2, pp.1357-1361, 1996. 
[29] Q. Zhu and B. D. Steinberg, “Modeling 
 and correction of incoherent wavefront 
 distortion,” Int. J. Imag. Syst. Technol.,vol. 
 8, pp. 322-335, 1997.  
[30] T. Lwin and W. D. O’Brien Jr., 
 “ Tissue-induced ultrasonic wavefront 
 distortion,” IEEE Ultrason. Symp., vol. 2, 
 pp. 1415-1418, 1996. 
[31] P.-C. Li, E. Ebbini, and M. O’Donnell, 
 “ A new filter design technique for coded 
 excitation systems,” IEEE Trans. Ultrason. 
 Ferroelec. Freq. Control, vol. 39, no. 6, pp. 
 693-699, 1992. 
[32] G. Kossoff, E. Kelly-Fry, and J. Jellins, 
 “Average velocity of ultrasound in the 
 human female breast. J. Acoust. Soc. Am.,  vol. 
53, no. 6, pp. 1730-1736, 1973. 
[33] F. A. Duck, Physical Properties of Tissue. 
 London:Academic Press 1990. 
[34] K. R. Erikson, F. J. Fry, and J. P. Jones, 
 “Ultrasound in medicine- a review,” IEEE 
 Trans. Sonics. Ultrason., vol. 21, no. 3, pp. 
 144-170, 1974.    
[35] R. Kuc, “Clinical application of an 
ultrasound attenuation coefficient estimation 
technique for liver pathology 
characterization,” IEEE Trans. Biomed. Eng., 
vol. BME-27, no. 6, pp. 312－319, 1980. 
[36] R. Kuc, “Estimating acoustic attenuation 
from reflected ultrasound signals: 
comparison of spectral-shift and 
spectral-difference approaches,” IEEE Trans. 
Acoust. Speech Signal Process, vol. 32, pp. 
1–6, 1984. 
[37] R. Kuc, M. Schwartz, “Estimating the 
Acoustic Attenuation Coefficient Slope for 
Liver from Reflected Ultrasound Signals,” 
IEEE Trans. Sonics Ultrason., vol. SU-26, 
no. 5, pp. 353–362, 1979.
 29
可利用之產業 
及 
可開發之產品 
生物醫學超音波、乳房診斷、非破壞檢測。 
技術特點 
使用超音波換能器陣列進行超音波信號的發射和接收，不需旋轉陣
列或物體，即可同時取得組織影像、聲速影像及衰減係數影像。此
裝置亦可延伸至其他參數影像（如彈性係數），提供更多影像資訊。
推廣及運用的價
值 
利用本發明同時取得生物體的超音波組織影像、聲速及衰減係數，
可用以判別組織種類，如乳房腫瘤之偵測。 
※ 1.每項研發成果請填寫一式二份，一份隨成果報告送繳本會，一份送 貴單
位研發成果推廣單位（如技術移轉中心）。 
※ 2.本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
※ 3.本表若不敷使用，請自行影印使用。 
 
330 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 51, no. 3, march 2004
Fig. 1. Imaging setup analyzed in this paper. Each of the (NA) chan-
nels in the array can transmit independently. A metal plate at the
bottom of the compressed breast was used to reﬂect the signal trans-
mitted from channel i to channel j.
The paper is organized as follows. Section II describes
the methods used to generate all the required data, in-
cluding the B-mode image and the time-of-ﬂight data. Sec-
tion III introduces the proposed method for reconstruct-
ing sound velocity distributions. Section IV demonstrates
the eﬃcacy of the proposed method. Section V discusses
properties of the proposed method and its potential appli-
cations. The paper concludes in Section VI.
II. Data Simulations
A. Imaging Setup
The imaging setup is shown in Fig. 1. All the image ob-
jects used in this paper contain cylindrical targets along
the z-axis, and t denotes the time throughout this paper.
Note that the setup is similar to that of x-ray mammog-
raphy [23] and the one proposed by Krueger et al. [17],
[18] for ultrasound. Fig. 1 shows that the linear array has
several (NA) channels and that a metal plate is used for
reﬂecting the acoustic wave. The array axis and the beam
axis are deﬁned as the x-axis and the y-axis, respectively.
In addition to performing B-mode imaging, the imaging
setup shown in Fig. 1 also is capable of transmitting a
wideband pulse from a single channel in order to acquire a
complete channel data set {eij(t)}, 1 ≤ i, j ≤ NA, where
eij(t) is the echo signal received by channel j when only
channel i transmits. With eij(t), the time-of-ﬂight tij cor-
responding to the same transmit/receive combination for
the echo reﬂected from the bottom metal plate can be ob-
tained.
Let c(x, y) denote the sound velocity at the center fre-
quency of the transmitted pulse. When only soft tissues are
considered and only time of ﬂight is of interest, eﬀects of
refraction associated with sound velocity inhomogeneities
can be ignored [16]. In this case:
tij =
∫
Lij
s(x, y)dl, (1)
where Lij is the path of the line integral as shown in Fig. 1,
and s(x, y) = c−1(x, y) is deﬁned as the slowness. Assume
the average slowness in the image object is s0, and deﬁne:
tij,0 =
∫
Lij
s0dl, (2)
as the geometrical delay, then the time of ﬂight with geo-
metrical delay compensated becomes:
∆tij = tij − tij,0 =
∫
Lij
[s(x, y) − s0] dl =
∫
Lij
∆s(x, y)dl,
(3)
where ∆s(x, y) can be discretized with spatial sampling
intervals ∆xs and ∆ys in the x and y directions, respec-
tively. In this case, (3) becomes:
∆tij =
N∑
n=1
M∑
m=1
∆s(m,n)lij(m,n) = lTij∆s, (4)
where lij and ∆s are MN × 1 column vectors,
(lij)(m−1)N+n ≡ lij(m,n) is the contribution of grid point
(m,n), 1 ≤ m ≤ M , 1 ≤ n ≤ N [i.e., the length of the line
segment that is the intersection of the path Lij and the
rectangle centered at the grid point (m,n) with a size of
∆xs × ∆ys], and (∆s)(m−1)N+n ≡ ∆s(m,n).
There are a total of N2A equations in (4). Due to the
assumption of the straight-line propagation path, lij =
lji, and ∆tij can be set to (∆tij +∆tji)
/
2 for 1 ≤ i ≤
NA, 1 ≤ j ≤ i. Thus, the number of equations reduces
to NA (NA + 1)
/
2, and they can be put into the following
matrix form:
L∆s = ∆t, (5)
where ∆t is an
[
NA (NA + 1)
/
2
] × 1 column vector and
L is an
[
NA (NA + 1)
/
2
]× MN matrix. In (5), ∆t is ob-
tained from the channel data, and L is calculated based
on the geometry. The focus of this paper is to develop a
scheme for accurately solving slowness distribution ∆s.
B. B-mode Image Generation
All B-mode images in this paper were generated with a
k-space method proposed by Tabei et al. [19]. This method
solves the coupled ﬁrst-order linear acoustic propagation
equations for a ﬂuid medium and allows inclusion of re-
laxation absorption and perfectly matched layers. It en-
ables accurate calculation of scattering in soft tissues and,
therefore, simulated speckle images can be formed. Fur-
thermore, diﬀraction, refraction, and scattering in an in-
homogeneous medium are all accounted for.
332 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 51, no. 3, march 2004
Cimage =


{
x ∈ RMN : xb1 = xb2 = · · · = xbNb , xr1 = xr2 = · · · = xrNr ,
xbri ∈ [xb1 , xr1 ] , 1 ≤ i ≤ Nbr
}
if xb1 ≤ xr1{
x ∈ RMN : xb1 = xb2 = · · · = xbNb , xr1 = xr2 = · · · = xrNr ,
xbri ∈ [xr1 , xb1 ] , 1 ≤ i ≤ Nbr
}
otherwise
, (10)
imposed in the region of interest and the background.
In other words, the property set in (10) (see above) can
be generated and used as another hard-constraint set:
where Ib ≡ {b1, b2, · · · , bNb} is the background index set,
Ir ≡ {r1, r2, · · · , rNr} is the region-of-interest index set,
and Ibr ≡ {br1, br2, · · · , brNbr} is the boundary index set.
All the slowness values in the background must be the
same, and all the slowness values in the region of interest
also must be the same. In addition, each slowness value at
the boundary must be between that of the background and
that of the region of interest. Note that no speciﬁc slow-
ness value has been set in any region at this point. Also
note that Cimage, which contains all the slowness distribu-
tions that satisfy the constraint derived from the B-mode
image, also is closed and convex. The Cimage can be gen-
erated similarly when the object contains more regions of
interest. A slowness distribution x ∈ Cvelocity∩Cimage min-
imizing Φs(x) can be found by taking x as the limit of the
sequence {xn} (i.e., lim
n→∞xn). The x0 ∈ Cvelocity ∩ Cimage
is an initial slowness distribution and:
xn+1 = (1 − λn)xn + λnPCvelocity∩Cimage
[
(1 − γ)xn
+ γ
NA(NA+1)/2∑
i=1
wiPC∆ti (xn)
]
, n ≥ 1. (11)
This algorithm is called Algorithm II, which diﬀers from
Algorithm I only in the projector outside the brackets (i.e.,
the slowness distribution must be in the hard-constraint
set Cimage in addition to being in Cvelocity in Algorithm
II). The critical issue of the proposed method is the in-
corporation of Cimage, which is shown in Section IV to be
crucial to the quality of the reconstructed sound velocity
distribution.
A sound velocity distribution c = [c1 c2 · · · cMN ]T and
a slowness distribution ∆s = [∆s1 ∆s2 · · · ∆sMN ]T are
related as follows:
cl = (s0 +∆sl)
−1 , l = 1, 2, · · · ,MN. (12)
IV. Numerical Results
All the raw data generated in this paper were noise free.
A. Algorithm I: Reconstruction Without the B-mode Image
Conventional ultrasonic transmission tomography ac-
quires complete projection data over an angular range of
Fig. 2. (a) Collecting all the time-of-ﬂight data with the angle of
incidence of θ is equivalent to (b) inspecting the object at angle θ and
angle −θ simultaneously in conventional transmission tomography.
180◦ [16], so that the reconstruction quality will be de-
graded if the data set does not span the full 180◦. The more
data are missing, the poorer the resulting reconstruction
quality becomes [27]–[29].
Limited-angle transmission tomography using linear ar-
rays does not provide a complete data set. As shown in
Fig. 2(a), the incidence and reﬂection angles are both equal
to θ. Collecting all the time-of-ﬂight data with an angle of
incidence of θ in Fig. 2(a) is eﬀectively equal to inspecting
the object at angle θ and angle −θ simultaneously in con-
ventional transmission tomography, as shown in Fig. 2(b).
To have a complete data set, the maximal available θ, de-
noted by θmax, has to be 90◦. This is impossible with a
linear array. If the array has NA transducers, a pitch of p,
and a distance between the array and the metal plate of
D, then it easily can be shown that:
θmax = tan−1
[
(NA − 1) p
2D
]
. (13)
∞ ∞ × ∞ ×
∞ ≡ →∞
c f
ρ
κ
κ
π τ f
κ
κ
π τ f
πκ τ f
π τ f
1
2
1
2
,
x y
x y
c c
c
N
f
c m, n c ,
c m, n c
.
I m, n
N
I c
c
N p .
θ
N
p . N p .
D
c c x .
y .
k
k
j j i
i
∗ ∗
−
−
−
−
− −
− −
−
−
−
−
∗ ∗
c
c
c
c
c
c
c
c
x y
. x y
∞∞
∞
∞
−
−
−
−
−
−
−
−
−
−
−
−
×
x y
p .
340 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 51, no. 3, march 2004
W (x, 0; f) is known, where W (x, 0; f) and W (x, y2; f)
are the temporal Fourier transforms of w(x, 0; t) and
w(x, y2; t), respectively. It has been shown that, if
W (x, y; f) represents an incident plane wave, then there
exists an exact series solution for W (x, y2; f) [20].
Let the angular spectrum of W (x, 0; f) be A(kx; 0, f)
[35], i.e.:
W (x, 0; f) =
1
2π
∫
A(kx; 0, f) exp(jkxx)dkx.
(A1)
Except for those complex-exponential functions exp(jkxx)
with |kx| > 2πf/c0(f), which represent evanescent waves,
each exp(jkxx) represents a plane wave propagating with
the wave vector
(
kx,
√
(2πf/c0(f))2 − k2x
)
. Thus:
W (x, y2; f) ∼= 12π
∫ 2πf/c0(f)
−2πf/c0(f)
A′ (kx;x, y2, f) dkx,
(A2)
where A′(kx;x, y2, f) is the series solution corresponding
to the term A(kx; 0, f) exp(jkxx).
For the conﬁguration in Fig. 10(b), the method for cal-
culating the signal, eij(t), received by transducer j in the
lower array when transducer i in the upper array trans-
mits a short pulse g(t) can be obtained based on the above
discussion. To treat the case shown in Fig. 10(c), let the
metal plate have physical parameters (ρm, cm(f)) and as-
sume that ρm 
 ρ0 and cm(f) 
 c0(f) so that the method
of images can be adopted. If the plate is suﬃciently thick
such that the echoes from its upper and lower surfaces are
well separated, the plate then can be treated as inﬁnitely
thick and eij(t) in Fig. 10(c) is equal to eij(t) + eiimagej(t)
in Fig. 10(d). Furthermore, eij(t) in Fig. 10(d) is negligible
around t = tij in Fig. 10(c) [tij is the time of ﬂight and
is the time needed for g(t) to travel from transducer i to
the metal plate, then to transducer j in Fig. 10(c)]. That
is, when only tij is of interest, there is no need to calcu-
late eij(t) as eij(t) can at most contain scattered waves
relevant to transducer i around tij , thus neglecting trans-
ducer i does not alter the estimate of tij . Therefore, to
obtain tij one only needs to consider the conﬁguration in
Fig. 10(e). Note that eijimage(t) = eiimagej(t). Obtaining
eijimage(t) around tij is a two-step process: the wave ﬁrst
propagates from plane y = 0 to plane y = y2, then prop-
agates from plane y = y2 to plane y = 2y2. This method
still can be applied when the object contains more cylin-
ders with a circular cross section.
Appendix B
A Brief Introduction to the Convex
Programming Formulation [25], [26], [36]
A complete inner product space is called a Hilbert
space. On the ﬁnite-dimensional Euclidean space RMN ,
if for all x = (x1, x2, · · · , xMN )T in RMN and all y =
(y1, y2, · · · , yMN )T in RMN , their inner product is deﬁned
as the Euclidean inner product:
〈x,y〉 =
MN∑
l=1
xlyl = yTx, (B1)
and RMN is a Hilbert space [36]. Each slowness distribu-
tion ∆s is an element in RMN .
Let C be a closed convex set in a Hilbert space H. Then
for each u in H, there exists a unique u∗ in C that is closest
to u. That is:
‖u − u∗‖ = min
v∈C
‖u − v‖, (B2)
where ‖ · ‖ is the norm induced by the inner product. This
unique nearest neighbor u∗ in C of u is called the projec-
tion of u onto C, and the operator assigning u∗ = Pcu to
each u is called the projector onto C and is denoted by
PC . For example, if the closed convex set C represents a
set of distributions satisfying a given condition and u is
any initial guess, then a distribution in C that is closest
to distribution u can be found. Assume that, for a real
problem, one tries to ﬁnd a solution u in H satisfying a
given constraint, and the associated constraint set:
C = {u ∈ H | u satisﬁes the given constraint}
(B3)
is nonempty, closed, and convex, then a solution u ∈ C
is u∗ = PCu0, where u0 is any given initial condition. If
there are k constraints in a problem and each:
Ci = {u ∈ H | u satisﬁes the ith constraint} ,
i = 1, 2, · · · , k, (B4)
is closed and convex, then all the solutions form a set C0 =⋂k
i=1 Ci which is also closed and convex. Thus, PC0u0 is a
solution provided that C0 is nonempty.
In the presence of inconsistent constraints, which may
arise from inaccurate measurements such as estimation er-
rors in the pulse arrival time, C0 is empty and there is no
solution. One way to solve this problem is to divide all of
the constraints into two classes: one class contains the hard
constraints the solution must satisfy, and the other class
contains the soft constraints for which the total amount
of violation must be minimized. Let Ic = Ih
⋃
Is be the
ﬁnite constraint index set, where Ih denotes the possibly
empty hard-constraint index set, Is denotes the nonempty
soft-constraint index set, and Ih
⋂
Is is empty. Deﬁne:
Φs(u) =
1
2
∑
i∈Is
wid
2(u,Ci), (B5)
where wi ∈ (0, 1] for all i ∈ Is,
∑
i∈Is wi = 1, and
d(u,Ci) = inf {‖u − v‖ | v ∈ Ci} is the distance between
u and Ci, where inf stands for the greatest lower bound.
Suppose that H is ﬁnite dimensional, Ci is bounded for
some i ∈ I, Ch = H⋂(⋂i∈Ih Ci) is nonempty, and
342 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 51, no. 3, march 2004
Sheng-Wen Huang was born in 1971 in
Changhua, Taiwan, R.O.C. He received the
B.S. degree in electrical engineering from
National Taiwan University, Taipei, Taiwan,
R.O.C. in 1993. He is currently a research as-
sistant with the Division of Medical Engineer-
ing Research at National Health Research In-
stitutes and a Ph.D. student at the Depart-
ment of Electrical Engineering, National Tai-
wan University. His current research interests
include ultrasonic tomography and behaviors
of ultrasound contrast agents.
Pai-Chi Li (S’93–M’95–SM’01) received the
B.S. degree in electrical engineering from
National Taiwan University, Taipei, Taiwan,
R.O.C., in 1987, and the M.S. and Ph.D. de-
grees from the University of Michigan, Ann
Arbor, in 1990 and 1994, respectively, both in
electrical engineering: systems.
He was a research assistant with the De-
partment of Electrical Engineering and Com-
puter Science at the University of Michigan
from 1990 to 1994. He joined Acuson Corpo-
ration, Mountain View, CA, as a member of
the technical staﬀ in June 1994. His work in Acuson was primarily in
the areas of medical ultrasonic imaging system design for both car-
diology and general imaging applications. In August 1997, he went
back to the Department of Electrical Engineering at National Tai-
wan University where he is currently a full professor. His current
research interests include biomedical ultrasonic imaging and signal
processing.
Dr. Li is a senior member of IEEE and Associate Editor of IEEE
Transactions on Ultrasonics, Ferroelectrics, and Frequency Control.
He received the 2003 Distinguished Research Achievement Award
from National Taiwan University, the 2002 Dr. Wu Dayou Research
Award from the National Science Council, the 2002 Outstanding
Young Electrical Engineer Award from the Chinese Institute of Elec-
trical Engineering and the Distinguished Industrial Collaboration
Award of Ministry of Education. He also was the recipient of the Dis-
tinguished Achievement Award in Electrical Engineering: Systems in
1994 for his outstanding academic achievement at the University of
Michigan.
huang and li: method for sound velocity distribution in the breast 1073
single channel in order to acquire a complete channel data
set and a corresponding time-of-ﬂight data set, which con-
tains information on the sound velocity distribution of the
image object.
A complete time-of-ﬂight data set spanning an angu-
lar range of 180◦ is necessary for accurate sound veloc-
ity reconstruction in conventional ultrasonic transmission
tomography [13]–[15]. The setup in Fig. 1 yields an in-
complete time-of-ﬂight data set. Hence, as shown in [10],
the sound velocity distribution cannot be accurately recon-
structed using the time-of-ﬂight data alone. A reconstruc-
tion algorithm based on a convex programming formula-
tion was proposed in [10]. It also was demonstrated that
a signiﬁcant improvement in estimation accuracy can be
achieved if the ROIs in the B-mode image of the same ob-
ject can be identiﬁed and segmented such that proper con-
straints can be deﬁned and imposed during reconstruction.
Extensive simulations were performed in [10] to test the ef-
ﬁcacy of the proposed technique. The eﬀects of wave prop-
agation such as refraction and diﬀraction were included in
the simulated data. In the cases considered in that paper,
the reconstructed sound velocities are accurate except at
the boundaries. Simulation results based on a 5-MHz linear
array showed that the sound velocity error was generally
1–3 m/s, with a maximum of 5.8 m/s. The objects under
investigation had radii of 2–6 mm, and all of them were de-
tected successfully. Therefore, it was concluded in [10] that
obtaining the sound velocity distribution is feasible with
the current B-mode imaging setup using linear arrays.
In this paper, a custom-made phantom containing a va-
riety of image objects with diﬀering physical properties
was used to experimentally investigate the performance
of the approach proposed and evaluated by simulations
in [10].
This paper is organized as follows. Section II reviews
the method for reconstructing the sound velocity distri-
bution. Section III introduces the experimental setup and
presents the experimental results. A discussion is provided
in Section IV, and the paper concludes in Section V.
II. Reconstruction Algorithm
In this section, the method for reconstructing the sound
velocity distribution is brieﬂy reviewed. Details can be
found in [10].
A. Imaging Setup
Consider the imaging setup shown in Fig. 1. Assume
that the linear array has NA channels. The imaging
setup is capable of acquiring a complete channel data set
{eij(t)} , 1 ≤ i, j ≤ NA, where eij(t) is the echo signal re-
ceived by channel j when only channel i transmits. With
eij(t), the time-of-ﬂight tij corresponding to the same
transmit/receive combination for the echo reﬂected from
the bottom metal plate can be obtained.
The eﬀects of refraction associated with sound velocity
inhomogeneities on the time of ﬂight can be ignored if only
soft tissues are considered [9], which is an acceptable ap-
proximation for breast tissue. Let c(x, y) denote the sound
velocity at the center frequency of the transmitted pulse,
s(x, y) = c−1(x, y) be the slowness, and s0 = c−10 be the
average slowness in the image object. Then the time of
ﬂight after geometrical delay compensation is:
∆tij = tij − tij,0 =
∫
Lij
s(x, y)dl −
∫
Lij
s0dl
=
∫
Lij
[s(x, y) − s0]dl =
∫
Lij
∆s(x, y)dl, (1)
where Lij is the path of the line integral as shown in Fig. 1.
Discretizing ∆s(x, y) with spatial sampling intervals ∆xs
and ∆ys in the x and y directions, respectively, changes
(1) to:
∆tij =
N∑
n=1
M∑
m=1
∆s(m,n)lij(m,n) = lTij∆s, (2)
where lij and ∆s are MN × 1 column vectors,
(lij)(m−1)N+n ≡ lij(m,n) is the contribution of grid point
(m,n), 1 ≤ m ≤ M , 1 ≤ n ≤ N , and (∆s)(m−1)N+n ≡
∆s(m,n).
Due to the assumption of straight-line propagation,
lij = lji, and ∆tij can be set to (∆tij +∆tji) /2 for
1 ≤ i ≤ NA, 1 ≤ j ≤ i. Thus, the number of equations
in (2) is NA (NA + 1) /2, and they can be expressed in the
following matrix form:
L∆s = ∆t, (3)
where ∆t is an [NA (NA + 1) /2]× 1 column vector and L
is an [NA (NA + 1) /2]×MN matrix. In (3), ∆t is obtained
from the channel data, and L is calculated from geometry.
B. Algorithm for Reconstructing the Sound Velocity
Distribution
In [10], a convex programming formulation for inconsis-
tent problems [16] was used to solve (3) due to its ability to
incorporate the B-mode image information. In this paper,
C = {x ∈ X : property P (x)} means that C is a subset of
X containing all x in X which have the property P [17]. For
any x = (x1, x2, . . . , xMN )
T and y = (y1, y2, . . . , yMN )
T in
RMN , their inner product is deﬁned as the Euclidean inner
product:
〈x,y〉 =
MN∑
l=1
xlyl = yTx. (4)
Let L in (3) be expressed as L =
[
l1 l2 · · · lNA(NA+1)/2
]T
and ∆t as ∆t =
[
∆t1 ∆t2 · · · ∆tNA(NA+1)/2
]T, and de-
ﬁne:
C∆ti =
{
x ∈ RMN : 〈x, li〉 = ∆ti
}
,
i = 1, 2, · · · , NA (NA + 1) /2,
(5)
◦


huang and li: method for sound velocity distribution in the breast 1081
[16] P. L. Combettes and P. Bondon, “Hard-constrained inconsistent
signal feasibility problems,” IEEE Trans. Signal Processing, vol.
47, no. 9, pp. 2460–2468, 1999.
[17] H. L. Royden, Real Analysis. 3rd ed. Englewood Cliﬀs, NJ:
Prentice-Hall, 1988.
[18] R. M. Lemor, P. K. Weber, P. K. Fonfara, C. Guenther, H. J.
Welsch, and M. L. Hoss, “A new combined open research plat-
form for ultrasound radio frequency signal processing,” in Proc.
IEEE Ultrason. Symp., 2003, pp. 33–37.
[19] M. O’Donnell and S. D. Silverstein, “Optimal displacement
for compound image generation in medical ultrasound,” IEEE
Trans. Ultrason., Ferroelect., Freq. Contr., vol. 35, no. 4, pp.
470–476, 1988.
[20] R. C. Gonzalez and R. E. Woods, Digital Image Processing. 2nd
ed. Reading, MA: Addison-Wesley, 2002.
Sheng-Wen Huang was born in 1971 in
Changhua, Taiwan, R.O.C. He received the
B.S. and Ph.D. degrees from National Taiwan
University, Taipei, Taiwan, R.O.C. in 1993
and 2004, respectively, both in electrical en-
gineering. He is currently a research assistant
with the Division of Medical Engineering Re-
search at National Health Research Institutes.
His current research interests include ultra-
sonic tomography, coded excitation, and be-
haviors of ultrasound contrast agents.
Pai-Chi Li (S’93–M’95–SM’01) received the
B.S. degree in electrical engineering from
National Taiwan University, Taipei, Taiwan,
R.O.C., in 1987, and the M.S. and Ph.D. de-
grees from the University of Michigan, Ann
Arbor, in 1990 and 1994, respectively, both in
electrical engineering: systems.
He was a research assistant with the De-
partment of Electrical Engineering and Com-
puter Science at the University of Michigan
from 1990 to 1994. He joined Acuson Corpo-
ration, Mountain View, CA, as a member of
the technical staﬀ in June 1994. His work in Acuson was primarily in
the areas of medical ultrasonic imaging system design for both car-
diology and general imaging applications. In August 1997, he went
back to the Department of Electrical Engineering at National Tai-
wan University where he is currently a full professor. His current
research interests include biomedical ultrasonic imaging and signal
processing.
Dr. Li is a senior member of IEEE and Associate Editor of IEEE
Transactions on Ultrasonics, Ferroelectrics, and Frequency Control.
He received the 2003 Distinguished Research Achievement Award
from National Taiwan University, the 2002 Dr. Wu Dayou Research
Award from the National Science Council, the 2002 Outstanding
Young Electrical Engineer Award from the Chinese Institute of Elec-
trical Engineering and the Distinguished Industrial Collaboration
Award of Ministry of Education. He also was the recipient of the Dis-
tinguished Achievement Award in Electrical Engineering: Systems in
1994 for his outstanding academic achievement at the University of
Michigan.
ij
ij
,ij
,ij
,ij
,ij
◦ ,ij
◦ ,ij
◦ ,ij
◦ ,ij
ij ,ij ,ij
ij
Lij
ij
,ij
ij
f0 f/
f0− f/
ij
ij
Lij

Fig. 3. (a) Schematic of the data-acquisition setup. (b) Side view
of the phantom. All the dimensions are in millimeters and all the
centers of the ROIs (fats, cysts, and tumors) are in the same plane.
,ij ,ij ij
a′
a′ Ai
Fig. 4. (a) The raw attenuation data and (b) the attenuation data
corrected using the technique described in Section II-B for Case II.
Note that all the discarded and unavailable data values are replaced
by 0, and thus are displayed in black.
xn
2018 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 52, no. 11, november 2005
Fig. 6. Evaluation of Case IX. The image object comprises a background of glandular material (cG = 1522 m/s, ρG = 1.03 g/cm3, and
αdB,G = 2.74 dB/cm) with three spheres, all with a radius of 4 mm (cC = 1570 m/s, ρC = 1.02 g/cm3, and αdB,C = 0.78 dB/cm in the
upper-left cyst sphere; cT = 1547 m/s, ρT = 1.10 g/cm3, and αdB,T = 7.36 dB/cm in the upper-right, high-attenuation tumor sphere;
and cF = 1464 m/s, ρF = 0.94 g/cm3, and αdB,F = 2.21 dB/cm in the lower fat sphere). (a) Filtered compound B-mode image displayed
with a 30-dB dynamic range. (b) Boundaries between the three spheres and the background. (c) Reconstructed sound velocity distribution.
(d) Reconstructed attenuation coeﬃcient distribution without data correction. (e) Reconstructed attenuation coeﬃcient distribution with
data correction.
2020 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 52, no. 11, november 2005
Fig. 8. The relations between the attenuation coeﬃcient diﬀerences (between the new estimated attenuation coeﬃcient and the original one in
the ROI) and the ROI area diﬀerence in percentage. (a) Case I. (b) Case III. Ten diﬀerent ROIs were randomly generated given a prespeciﬁed
ROI area. The error bars denote ± one standard deviation. The horizontal dashed line shown in (a) corresponds to αdB,lower = 0 dB/cm.
the sound velocities at the boundary set to their mean val-
ues. In general, using prespeciﬁed sound velocities instead
of reconstructed ones to estimate the artifacts associated
with refraction did not improve the results. Together with
the results shown in Fig. 8, it is possible that the eﬀec-
tiveness of the proposed approach is closely related to the
accuracy of the ROI area. Nonetheless, further studies are
needed to examine this aspect.
According to Table II and Fig. 5, the reconstruction
accuracy in the ROI was improved by applying the correc-
tion technique, except in Cases VII and VIII. Additional
experiments on a new phantom with conﬁrmed acoustic
parameters may be required to investigate why the correc-
tion technique fails in some cases.
The results show that all ∆αF values are negative
and that all ∆αC, ∆αT, and ∆αIT values are positive.
Furthermore, αdB,F,recon (f0) = 0 dB/cm in Case I and
αdB,T,recon (f0) = 10 dB/cm in Case V reached the lower
bound and the upper bound for the attenuation coeﬃ-
cient, respectively. This is mainly attributable to refraction
causing energy redistribution. The fat sphere, in which the
sound velocity is lower than that in the background, tends
to distribute more energy to the transmit/receive combi-
nations with a path across the ROI; and the cyst sphere,
high-attenuation tumor sphere, and the irregular tumor
region produce the opposite eﬀect because in them the
sound velocity is higher than that in the background.
In the phantom study, according to the results in [11],
fat regions and tumors (including high-attenuation and ir-
regular tumors) can be successfully discriminated by ap-
plying a threshold (e.g., 1500 m/s) to the sound velocities
estimated in all relevant cases. Furthermore, the approach
proposed here enables discrimination of cysts and tumors
by applying another threshold (e.g., 3 dB/cm in this study)
to the estimated attenuation coeﬃcients. Therefore, to im-
prove the detection of breast cancer, B-mode image, sound
velocity distribution, and attenuation coeﬃcient distribu-
tion can be applied sequentially. When a region cannot
be identiﬁed using the B-mode image, this region can be
rejected as a tumor if its sound velocity is lower than a
threshold; if the sound velocity in this region is higher
than this threshold, the attenuation coeﬃcient then can be
used to distinguish a tumor from a cyst by setting another
threshold. Note that, although it is straightforward to se-
lect thresholds in the phantom study, training data may
be required for deriving the thresholds relative to those of
the background in clinical situations [26].
For image objects with inhomogeneous acoustic proper-
ties such as the breast, automatic image segmentation for
separating the ROIs from the background may be diﬃcult.
In this case, the reconstruction algorithm still can be ap-
plied, and the estimation result in each region is simply the
average for that region. Furthermore, the automatic seg-
mentation may be replaced with manual or semiautomatic
segmentation to reduce such potential errors.
Convex programming was used to solve (16). Although
several other approaches may be used—including the alge-
braic reconstruction techniques (ARTs) [9] and the pseu-
doinverse approach [13], [14]—only those capable of in-
corporating a priori knowledge of the image object are
preferred. This is because the time-of-ﬂight data set and
the attenuation data set are incomplete [15]–[17]. Further-
more, because the data are generally inconsistent due to
sound velocity inhomogeneities and measurement errors, a
solution that can minimize the total violation of the data
is desirable. Note that, according to the above discussion,
there are two classes of constraints for the problem encoun-
tered in this study: one class contains the hard constraints
associated with the a priori knowledge that should not be
violated, and the other class contains the soft constraints
2022 ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 52, no. 11, november 2005
Pai-Chi Li (S’93–M’95–SM’01) received the
B.S. degree in electrical engineering from
National Taiwan University, Taipei, Taiwan,
R.O.C., in 1987, and the M.S. and Ph.D. de-
grees from the University of Michigan, Ann
Arbor, MI, in 1990 and 1994, respectively,
both in electrical engineering: systems.
He was a research assistant with the De-
partment of Electrical Engineering and Com-
puter Science of the University of Michigan
from 1990 to 1994. He joined Acuson Corpo-
ration, Mountain View, CA, as a member of
the Technical Staﬀ in June 1994. His work with Acuson was pri-
marily in the areas of medical ultrasonic imaging system design for
both cardiology and general imaging applications. In August 1997,
he went back to the Department of Electrical Engineering at Na-
tional Taiwan University, where he is currently a full professor. His
current research interests include biomedical ultrasonic imaging and
signal processing.
Dr. Li is a senior member of IEEE and Associate Editor of IEEE
Transactions on Ultrasonics, Ferroelectrics, and Frequency Control.
He is also on the Editorial Board of Ultrasonic Imaging. He received
the 2004 Distinguished Research Award, National Science Council,
the 2004 Distinguished Research Achievement Award, National Tai-
wan University, the 2003 Outstanding Researcher Award, National
Taiwan University, the 2002 Dr. Wu Dayou Research Award from
National Science Council, the 2002 Outstanding Young Electrical
Engineer Award from Chinese Institute of Electrical Engineering and
the Distinguished Industrial Collaboration Award of Ministry of Ed-
ucation. He was also the recipient of the Distinguished Achievement
Award in Electrical Engineering: Systems in 1994 for his outstanding
academic achievement at the University of Michigan.
huang and li: method for exciting nonbinary codes 107
must be extended when the constraints cannot be satisﬁed.
Therefore, the code must be properly designed to meet the
system requirements.
Achieving optimal pulse compression performance re-
quires the ability to generate an arbitrary transmit wave-
form in order to realize the desired spectral characteristics.
However, an arbitrary waveform generator is expensive.
Here we propose a method that preserves the low-cost ad-
vantage of a bipolar pulser while achieving compression
performance similar to that of an arbitrary waveform gen-
erator. The key idea of the proposed method is the con-
version of a nonbinary code into a binary code by code
translation and code tuning. The code translation is im-
plemented by sending the nonbinary code into a virtual
one-bit sigma-delta modulator, and the code tuning in-
volves minimizing the root-mean-square error between the
resultant binary code and the original nonbinary code by
sequential and iterative tuning using the output of the
sigma-delta modulator as the initial condition while tak-
ing the transducer response into account. It is shown that
good compression performance can be achieved by using
the converted binary code instead of the original code.
Hence, the proposed method can be used to eﬀectively
realize arbitrary waveform coded excitation with bipolar
pulsers.
This paper is organized as follows. Section II describes
the method used to translate an arbitrary code into a bi-
nary code, and the method used to tune the binary code.
Section III introduces the formulas for designing the com-
pression ﬁlter. Section IV demonstrates the eﬃcacy of
the proposed method using simulations and experimen-
tal data. Section V discusses characteristics, applications,
and extensions of the proposed method, and the paper
concludes in Section VI.
II. Code Conversion
The overall goal of code conversion is to convert a non-
binary code into a binary code that exhibits similar com-
pression performance. A two-step method was developed
to achieve this goal. The ﬁrst step uses a sigma-delta mod-
ulator to translate the nonbinary code into a temporary
binary code. Section II-C shows that this temporary code
only exhibits acceptable compression performance when
the bit rate is excessively high; hence, a second step is
needed. The algorithm introduced in Section II-D is used
as the second step to tune the temporary code into a new
code that has improved compression performance.
A. Sigma-Delta Modulation
Let x(t) be a band-limited, continuous time signal and
x(n) be its corresponding discrete time signal uniformly
sampled at fs:
x(n) = x(t)
∣∣
t=n/fs
. (1)
Fig. 2. Normalized envelopes of xc(t), and yc (t; fs) for fs = 40, 100,
and 200 MHz.
In this paper, t denotes the time, and the letters n, k, p,
q, and l within parentheses denote discrete time indices.
Fig. 1 shows a block diagram of a ﬁrst-order, one-bit
sigma-delta modulator [16], where e(n) is the quantization
error. Note that the entire system is in the discrete do-
main because the modulator is used only for discrete code
translation (and not analog-to-digital conversion). With-
out loss of generality, assume that the input signal x(n) is
bounded by ±V and that the output signal y(n) is within
{+1,−1}. The quantizer will not be overloaded if V = 1
and
∣∣v(0)∣∣ ≤ 2, (i.e., ∣∣e(n)∣∣ ≤ 1 for all n ≥ 0). Based on
Fig. 1:
v(n) = y(n) − e(n), (2)
v(n) = u(n − 1) + v(n − 1)
= [x(n − 1) − y(n − 1)] + [y(n − 1) − e(n − 1)]
= x(n − 1) − e(n − 1). (3)
Thus:
y(n) = x(n − 1) + e(n) − e(n − 1). (4)
If fs is much higher than the bandwidth of x(n), x(n)
can be eﬃciently reconstructed by appropriately ﬁltering
y(n).
B. Code Translation
Let x(t) be the desired band-limited waveform for coded
excitation. The goal is to build a binary version of the
original code such that, after being ﬁltered by the trans-
ducer, the ﬁltered binary waveform is similar to the ﬁltered
version of the original code. In other words, the trans-
ducer’s frequency response is used as the reconstruction
ﬁlter in a sigma-delta modulator. We ﬁrst choose a sam-
pling frequency fs and discretize x(t) into x(n), then send
the sequence x(n) into the sigma-delta modulator shown
in Fig. 1. The output signal y(n) of the modulator is the
huang and li: method for exciting nonbinary codes 109
Fig. 4. (a) x(t)⊗ht(t). (b) y(t; 40 MHz)⊗ht(t). (c) y′(t; 40 MHz)⊗
ht(t). (d) Normalized envelopes of xc(t) (solid line), yc(t; 40 MHz)
(dotted line), and y′c(t; 40 MHz) (dashed line).
d[y(n)] = ‖[y (t; fs) − x(t)] ⊗ ht(t)‖ , (12)
where ‖ · ‖ denotes the L2 norm; then d[y(n)] is a mea-
sure of the similarity between y (t; fs) and x(t). If y(n)
is tuned into a code ytemp,1(n) such that d [ytemp,1(n)] <
d [y(n)], ytemp,1(n) is considered better than y(n) and will
be the current candidate for the ﬁnal code y′(n). If a
code ytemp,2(n) generated by tuning ytemp,1(n) satisﬁes
d [ytemp,2(n)] < d [ytemp,1(n)], ytemp,2(n) will become the
new candidate for y′(n). The process continues until the
candidate code cannot be further updated. In this algo-
rithm, any new candidate for y′(n) is diﬀerent from the
current candidate in at most N2 (N2 = 16 in this pa-
per) consecutive bits, and the start index of the 16 bits is
shifted sequentially and iteratively until the similarity to
x(n) cannot be further improved.
Figs. 4(a)–(c) show x(t) ⊗ ht(t), y(t; 40 MHz) ⊗ ht(t),
and y′(t; 40 MHz)⊗ht(t), respectively. The parameters are
the same as those used in Section II-C. Fig. 4(d) shows the
normalized envelopes of xc(t) (solid line), yc(t; 40 MHz)
(dotted line), and y′c(t; 40 MHz) (dashed line). Fig. 4
demonstrates that tuning a code can signiﬁcantly improve
the compression performance.
III. Design of the Compression Filter
This section presents the design principles of the com-
pression ﬁlter. In this paper, pulse compression is realized
at baseband. Assume that the digitized echo signal is:
y′rf(n) = [y
′ (t; fs) ⊗ ht(t) ⊗ ht(t)]t=n/fs,ADC ,
(13)
where fs,ADC is the sampling rate of the analog-to-digital
converter (ADC) at the receiver. The y′rf(n) is demodu-
lated into a baseband signal:
y′bb(n) = hK(n) ⊗ [y′rf(n) · exp (−j2πf0n/fs,ADC)] ,
(14)
where hK(n) is a Kaiser-windowed, ﬁnite impulse response
low-pass ﬁlter [17], i.e.:
hK(n) =
sin 2πfc(n − M/2)
π(n − M/2) ·
I0
[
β
(
1 − [(n − M/2)/(M/2)]2
)1/2]
I0(β)
, 0 ≤ n ≤ M, (15)
where I0(·) represents the zeroth-order modiﬁed Bessel
function of the ﬁrst kind, fc is the −6 dB cutoﬀ frequency,
(M + 1) is the ﬁlter length, and β is a shape parameter.
The y′bb[n] is then D times downsampled to obtain:
y′d(n) = y
′
bb(Dn). (16)
Given a compression ﬁlter hd,c(n), the compressed sig-
nal is:
y′d,c(n) = y
′
d(n) ⊗ hd,c(n). (17)
Let nd(n) and nd,c(n) denote the noise after downsam-
pling and compression, respectively, and deﬁne the auto-
correlation function of a random process s(n) as:
Rs(k) = E {s(n)s∗(n − k)} , (18)
where the asterisk denotes complex conjugation and E de-
notes the statistical expectation operator; then [18]:
Rnd,c(k) = Rnd(k) ⊗ hd,c(k) ⊗ h∗d,c(−k), (19)
and the ensemble-averaged noise power after pulse com-
pression is Rnd,c(0). If the peak of the compressed signal
is normalized to unity by scaling the ﬁlter coeﬃcients, the
inverse of Rnd,c(0) is the output SNR.
Let m denote the index of the peak position of y′d,c(n),
Isl denote the index set of the sidelobes, s speciﬁes the pre-
determined allowable PSL, and sdB = 20 log s. The goal
is to ﬁnd a compression ﬁlter h′o(n) such that Rnd,c(0)
is minimized under the constraints of y′d,c(m) = 1 and∣∣∣y′d,c(n)∣∣∣ ≤ s for n ∈ Isl [i.e., h′o(n) maximizes the out-
put SNR while maintaining the axial resolution and dy-
namic range speciﬁed by Isl and s, respectively]. Unfor-
tunately, this problem cannot be solved systematically, so
the above formulation is slightly modiﬁed to the following:
ﬁnd the optimal compression ﬁlter ho(n) resulting in the
minimal Rnd,c(0) under the constraints of y
′
d,c(m) = 1, and∣∣∣Re{y′d,c(n)}∣∣∣, ∣∣∣Im{y′d,c(n)}∣∣∣ ≤ s/√2 for n ∈ Isl, where
huang and li: method for exciting nonbinary codes 111
Rnd(k) = E
{∑
p
hK(p)nw(Dn − p) exp [−j2πf0(Dn − p)/fs,ADC] ·
∑
q
h∗K(q)n
∗
w(Dn − Dk − q) exp [j2πf0(Dn − Dk − q)/fs,ADC]
}
=
∑
p,q
hK(p)h∗K(q) exp [−j2πf0(Dk − p + q)/fs,ADC] ·
E {nw(Dn − p)n∗w(Dn − Dk − q)}
=
∑
p,q
hK(p)h∗K(q) exp [−j2πf0(Dk − p + q)/fs,ADC]Rnw(Dk − p + q)
= σ2w
∑
q
hK(Dk + q)h∗K(q) = σ
2
w · [hK(l) ⊗ h∗K(−l)]l=Dk .
(22)
Fig. 6. The curves of optimal SNR versus T ′ for binary Tukey-windowed chirps generated by simulations. (a) sdB = −40 dB. (b) sdB =
−46 dB. (c) sdB = −52 dB. (d) sdB = −58 dB. In each panel, the curves corresponding to three binary Tukey-windowed chirps are shown
from top to bottom as thick solid lines: y′bTc(n; 24 µs), y
′
bTc(n; 20 µs), and y
′
bTc(n; 16 µs). Also shown in each panel are the characteristic
curves of pseudochirps for comparison. The characteristic curve corresponding to the same PSL is shown as a thick dashed line; the others
are shown as thin solid lines.
huang and li: method for exciting nonbinary codes 113
Fig. 8. (a) The pulse-echo signal and (b) the corresponding spectrum of the signal obtained from the wire using a pulser/receiver to transmit
and receive.
constant peak acoustic power for all cases. The echo signal
(y′bTc,d or zpc,d) from the wire was estimated using 16,000
records to reduce noise and to design the compression ﬁl-
ter. The output SNR corresponding to each compression
ﬁlter was estimated using nd(n). The SNR improvement
using coded excitation is deﬁned as the output SNR using
coded excitation minus 14.8 dB (i.e., the SNR reference).
The thick solid lines in Figs. 10(a)–(d) show the optimal
improved SNR versus T ′ for binary Tukey-windowed chirps
corresponding to sdB = −40 dB to −58 dB with a step of
−6 dB, respectively.
In each panel of Fig. 10, the curves corresponding to
the three binary Tukey-windowed chirps, y′bTc(n; 24 µs),
y′bTc(n; 20 µs), and y
′
bTc(n; 16 µs), are shown from top to
bottom. Each ﬁgure panel also contains the characteristic
curves of pseudochirps corresponding to sdB = −40 dB to
−58 dB with a step of −6 dB for comparison. The char-
acteristic curve corresponding to the same PSL is shown
as a thick dashed line, and the others are shown as thin
solid lines. The experimental results again show that using
a binary Tukey-windowed chirp instead of a pseudochirp
reduces the code duration by at least 20.6% or the PSL by
6 dB.
V. Discussion
The code-tuning algorithm introduced in Section II-D
does not guarantee the smallest ‖[y′ (t; fs) − x(t)] ⊗ ht(t)‖
because the compression performance could be improved
by using other algorithms such as a genetic algorithm [19].
Furthermore, other metrics could be adopted for the error
between the original nonbinary code and its corresponding
binary code.
Let the bit duration be the inverse of the bit rate, the
shortest time between any two consecutive transitions in
the code is equal to the bit duration using the proposed
method. One inherent restriction in this paper is that a
transition always occurs at an instant equal to an integral
multiple of the bit duration. This restriction is not neces-
sary and can be removed. For example, assume that the
Fig. 9. The measured power spectral density of nd(n).
shortest switching time of the pulser is limited to 25 ns and
that the clock rate of the system is 200 MHz, then the bit
rate of the code can be set to 200 MHz instead of 40 MHz,
but the time between any two consecutive transitions is
limited to be larger than or equal to ﬁve clock cycles in
order not to violate the minimal switching time (25 ns).
With this scheme, similarity between the original nonbi-
nary code and its corresponding binary code will increase
without the necessity of reducing the shortest switching
time, or the compression performance can be maintained
when the shortest switching time is kept at a higher value.
This subject is currently under investigation.
If the quantizer is not overloaded, a second-order sigma-
delta modulator is more capable of shaping the quantiza-
tion noise than a ﬁrst-order, sigma-delta modulator. How-
ever, the code-tuning algorithm dominates the similarity
between the converted binary code and the original code
and, consequently, the required switching time. In other
words, the output of the sigma-delta modulator is used
only as its initial condition. Furthermore, to avoid the
quantizer overload and the relevant nonlinear distortion,
the modulator input level must be lower than the quantiza-
tion level if a second-order, sigma-delta modulator is used
as the code translator instead of the original ﬁrst-order,
huang and li: method for exciting nonbinary codes 115
Fig. 10. The curves of optimal SNR versus T ′ for binary Tukey-windowed chirps obtained from experiments. (a) sdB = −40 dB. (b) sdB =
−46 dB. (c) sdB = −52 dB. (d) sdB = −58 dB. In each panel, the curves corresponding to three binary Tukey-windowed chirps are shown
from top to bottom as thick solid lines: y′bTc(n; 24 µs), y
′
bTc(n; 20 µs), and y
′
bTc(n; 16 µs). Also shown in each panel are the characteristic
curves of pseudochirp corresponding to sdB = −40 dB to −58 dB with a step of −6 dB for comparison. The characteristic curve corresponding
to the same PSL is shown as a thick dashed line; the others are shown as thin solid lines.
Thus the constraint y′d,c(m) = 1 can be formulated as:
yTm,rg = 1 and y
T
m,ig = 0, (A12)
and
∣∣∣Re{y′d,c(n)}∣∣∣ ≤ s/√2 and ∣∣∣Im{y′d,c(n)}∣∣∣ ≤ s/√2
can be formulated as:
yTn,rg ≤
s√
2
, (−yn,r)T g ≤ s√
2
, yTn,ig ≤
s√
2
,
and (−yn,i)T g ≤ s√
2
. (A13)
Eq. (A1), (A6), (A12), and (A13) show that (20) is a
quadratic programming problem with a convex feasible set
[20]. Furthermore, G is positive deﬁnite (i.e., gTGg > 0
for all g nonzero) as gTGg = Rnd,c(0). Therefore, if the
constraints can be satisﬁed using a ﬁlter length of Nf, the
optimal compression ﬁlter ho(n) of this length exists, is
unique, and can be found [20].
References
[1] M. O’Donnell, “Coded excitation system for improving the
penetration of real-time phased-array imaging systems,” IEEE
Trans. Ultrason., Ferroelect., Freq. Contr., vol. 39, no. 3, pp.
341–351, 1992.
[2] B. Haider, P. A. Lewin, and K. E. Thomenius, “Pulse elon-
gation and deconvolution ﬁltering for medical ultrasonic imag-
ing,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol. 45,
no. 1, pp. 98–113, 1998.
[3] R. Y. Chiao and L. J. Thomas, “Synthetic transmit aperture
imaging using orthogonal Golay coded excitation,” in Proc.
IEEE Ultrason. Symp., 2000, pp. 1677–1680.
[4] Y. Wang, K. Metzger, D. N. Stephens, G. Williams, S. Brownlie,
and M. O’Donnell, “Coded excitation with spectrum inversion
(CEXSI) for ultrasound array imaging,” IEEE Trans. Ultrason.,
Ferroelect., Freq. Contr., vol. 50, no. 7, pp. 805–823, 2003.
[5] J. Shen and E. S. Ebbini, “A new coded-excitation ultrasound
imaging system—Part I: Basic principles,” IEEE Trans. Ultra-
son., Ferroelect., Freq. Contr., vol. 43, no. 1, pp. 131–140, 1996.
[6] C.-C. Shen and P.-C. Li, “Pulse-inversion-based fundamental
imaging for contrast detection,” IEEE Trans. Ultrason., Fer-
roelect., Freq. Contr., vol. 50, no. 9, pp. 1124–1133, 2003.
[7] S. Zhou and J. A. Hossack, “Dynamic-transmit focusing using
time-dependent focal zone and center frequency,” IEEE Trans.
Ultrason., Ferroelect., Freq. Contr., vol. 50, no. 2, pp. 142–152,
2003.
[8] P.-C. Li, “Pulse compression for ﬁnite amplitude distortion
based harmonic imaging using coded waveforms,” Ultrason.
Imag., vol. 21, no. 1, pp. 1–16, 1999.
[9] Y. Takeuchi, “Coded excitation for harmonics imaging,” in Proc.
IEEE Ultrason. Symp., 1996, pp. 1433–1436.
[10] J. Borsboom, C. T. Chin, and N. de Jong, “Experimental valida-
ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 54, no. 5, may 2007 947
Binary Code Design for High-Frequency
Ultrasound
Sheng-Wen Huang and Pai-Chi Li, Senior Member, IEEE
Abstract—This paper proposes an approach to design-
ing binary codes suitable for high-frequency applications
of coded excitation in medical ultrasound. For a high-
frequency ultrasound system, transmitting well-designed
binary codes with a low sampling ratio (i.e., the bit rate
divided by the transducer center frequency) is a practi-
cal way to improve the signal-to-noise ratio (SNR) because
the challenge of implementing arbitrary-waveform genera-
tors for transmitting nonbinary codes increases with the
frequency and the switching speed of square-wave pulsers
are limited. One conventional approach designs codes using
a base sequence that modulates wideband sequences up to
the transducer passband. Because a major portion of codes
is excluded as a candidate, codes designed using this ap-
proach typically need long compression ﬁlters for restoring
the axial resolution, and they do not improve the SNR ef-
ﬁciently. In contrast, the approach proposed here searches
all the codes that match the transducer passband; hence,
the resultant codes exhibit better performance. The tech-
nique was tested using a bit rate of 50 MHz and a sampling
ratio of 2. For a transducer with an ideal Gaussian fre-
quency response with a center frequency of 25 MHz and a
 6 dB bandwidth of 15 MHz, the SNR for the same side-
lobe extent was 1 to 6 dB higher for the codes designed us-
ing the proposed approach compared with those designed
using the conventional approach. When a real transducer
response with a center frequency of 26.4 MHz and a one-
way  6 dB bandwidth of 20.7 MHz was considered, the
codes designed using the proposed approach were superior
by 0.5 to 5 dB. Therefore, our approach is better than the
conventional approach for designing binary codes for high-
frequency ultrasound, with the results indicating that the
moderate bit rate of 50 MHz will suﬃce when the ultrasonic
center frequency is 25 MHz.
I. Introduction
Aprimary application of coded excitation in medi-cal ultrasound is improving the signal-to-noise ratio
(SNR) without increasing the peak acoustic power [1], and
the papers on coded waveforms (e.g., [2], [3]) published in
this journal describe some of the recent progress and oﬀer
extensive references to previous studies in diverse applica-
tions. Fig. 1 shows a block diagram of a coded excitation
system, in which each channel has a transmitter able to
transmit the desired code (which has a wide bandwidth
Manuscript received February 23, 2006; accepted December 28,
2006. Partial support from the National Science Council of R.O.C.
under Grant NSC 95-2218-E-002-036 and from the National Health
Research Institutes of R.O.C. is gratefully acknowledged.
The authors are with the Department of Electrical Engi-
neering, National Taiwan University, Taipei, Taiwan (e-mail:
paichi@cc.ee.ntu.edu.tw).
Digital Object Identiﬁer 10.1109/TUFFC.2007.340
Fig. 1. Block diagram of a coded excitation system.
and an increased pulse length), and a compression ﬁlter
whose coeﬃcients and length are strongly inﬂuenced by
the code is placed after the receive beamformer so as to
restore the axial resolution. The performance of pulse com-
pression is generally characterized by the mainlobe width
(related to the axial resolution) and the sidelobe level (re-
lated to the dynamic range and contrast resolution) of the
compressed pulse, and the SNR improvement (i.e., the dif-
ference between the SNRs after and before pulse compres-
sion).
Codes can be classiﬁed according to the required trans-
mitter type. A nonbinary code necessitates an arbitrary-
waveform transmitter, and a binary code can be trans-
mitted with a square-wave pulser. Although it is easy
to design nonbinary codes with good compression perfor-
mances, such codes have not been widely used in array
systems mainly due to the increased hardware complex-
ity and cost associated with the requirement for multiple
arbitrary-waveform transmitters. Furthermore, the chal-
lenge of implementing an arbitrary-waveform transmitter
increases with the center frequency of the transducer (or
the code), and it may still be impractical to use codes other
than binary ones for a high-frequency (e.g., 25 MHz) ultra-
sound system that images using an array of transducers.
The diﬃculty of designing binary codes also increases with
frequency due to the limited switching speed of square-
wave pulsers and, consequently, the allowable sampling
ratio decreases as the center frequency of the transducer
increases (where the sampling ratio is the bit rate divided
by the transducer center frequency).
0885–3010/$25.00 c© 2007 IEEE
huang and li: binary code design for high-frequency ultrasound 949
where σ2nd,c denotes the power of the thermal noise nd,c(n)
after compression, ed,c(n) = ed(n) ⊗ h(n), h(n) has a
length of Nf, and Re{·} and Im{·} denote the real and
imaginary parts, respectively. The details for solving (6)
are available elsewhere [6].
B. Deﬁnition of Code Eﬃciency
The near-ﬁeld dead zone of a coded excitation system
using a code-ﬁlter combination {cRF(n;N), ho(n;Nf)} is
(Tc +Tf)/2 larger than that of a pulsed excitation system,
where Tc = N/fb and Tf = NfD/fs (both in units of time)
are the code length and the ﬁlter length, respectively. In
addition, the sidelobe of a point target spans a duration of
(Tc + Tf) for this coded excitation system. Therefore, the
value of (Tc+Tf) should be as small as possible, and a given
code-ﬁlter combination is better than another if it provides
the same SNR improvement and has a lower (Tc + Tf).
Because the output SNR ideally should be proportional
to both Tc and (Tc + Tf), it is reasonable to treat a code-
ﬁlter combination as better if it has a higher code-ﬁlter
eﬃciency:
Ecf [cRF(n;N), ho(n;Nf)] ≡
SNRdB − 10 log10
[
(Tc + Tf)
/
(T0/2)
]
, (7)
where SNRdB is the output SNR in decibels, and T0 = f−10 .
We can use (7) to fairly compare two code-ﬁlter combina-
tions even if they provide diﬀerent SNR improvements.
Note that given a code cRF(n;N), there is a one-to-one
correspondence between Nf and ho(n;Nf). That is:
Ecf [cRF(n;N), ho(n;Nf)] = Ecf [cRF(n;N), Nf] ,
(8)
and there exists an Nf (or a Tf) that results in the maximal
Ecf value for the code. Deﬁning the eﬃciency Ec of a code
cRF(n;N) as:
Ec [cRF(n;N)] ≡ max
Nf
{Ecf [cRF(n;N), Nf]} , (9)
means that a code which is easier to compress and/or im-
proves the SNR to a greater extent will have a higher Ec
value. Therefore, in this study a code is treated as more ef-
ﬁcient at improving the SNR or having better compression
performance if its Ec value is higher.
III. The Indicator-Based Search Approach to
Binary Code Design
Genetic algorithms may be used to stochastically search
a domain that is too large to be searched exhaustively [5].
A genetic algorithm previously was used to design binary
codes suitable for being compressed with inverse ﬁltering
in the frequency domain [7]. In the present study, we de-
veloped a genetic algorithm to design binary codes with
high eﬃciencies. Because given a code, for obtaining its ef-
ﬁciency, typically tens of compression ﬁlters corresponding
Fig. 2. Flow diagram of the genetic algorithm used in the proposed
search approach.
to diﬀerent Nf’s need to be designed [see (9)] and design-
ing a compression ﬁlter means solving a quadratic pro-
gramming problem [see (6)] [6], it is evident that directly
calculating the eﬃciency of each code during the search
process is computationally expensive. Therefore, in our al-
gorithm the following indicator that is easier to calculate
while being closely correlated with the code eﬃciency was
used as the parameter to be optimized during the search
process:
IE [cRF(n;N)] ≡
∥∥∥∥
{
RcRF(t)
RcRF(0)
− Rb(t)
Rb(0)
}
⊗ ht(t)
∥∥∥∥
−1
,
(10)
where Ra(t) = a(t) ⊗ a∗(−t) denotes the autocorrelation
function of the signal a(t) [representing cRF(t) or b(t) here],
b(t) =
NB−1∑
n=0
b(n)Π
(
fbt − n + NB2
)
, (11)
RcRF(0) = (N/fb), and Rb(0) = (NB/fb). If the spectrum
of an RF code in the transducer band is similar to that of
the base sequence (in terms of the normalized amplitude),
it will have a large IE value. Because, in general, the base
sequence (such as {1, −1} or {1, −1, 1, −1}) has a smooth
spectrum, RF codes with large IE values tend to have a
smooth spectrum. Therefore, they are easy to compress
huang and li: binary code design for high-frequency ultrasound 951
TABLE II
Hexadecimal Representations of the RF Codes Designed Using the Search Approach (Second Column)
and the Modulation Approach (Fifth Column) for b(n) = (−1)n and NB = 2.1
Search approach Modulation approach
Wideband
N RF code NC sequence RF code
32 3AAB5A4C 16 2833 59955A5A
34 03AAB5A4C 17 04C2B 165A5599A
36 3C96A5577 18 0B477 59A656A6A
38 1A56AA9B0C 19 17421 166A655956
40 25AD72AA0C 20 05D39 5566A65A96
42 1D755AB4F6C 21 07C452 16AA5656659
44 02494A95457 22 0F88A4 5AA95959965
46 0906B5AAAF04 23 00E6D5 1555A969A666
48 0E952AEADA4F 24 111E2D 565656A959A6
50 0C17455AA525B 25 073F536 16A5AAA665A69
52 6214A5556C24F 26 063F56D 5695AAA6669A6
54 0DED2B562ABA6C 27 0F1112D 15AA56565659A6
56 65DD5252A8567B 28 38FEA4D 5A95AAA99965A6
58 07641556AB4A53C 29 031FD5B2 15A56AAA6669A59
60 6964AD6AAAF04C0 30 09BF8EB5 5969AAA95A99A66
62 032CAAA456A521CC 31 1CEADBF0 16A5A999A69AAA55
64 06B56AD352EAAE80 32 00F2D533 5555AA59A6665A5A
1The wideband sequences [9] necessary for the modulation approach are listed in the fourth column. The
transducer was assumed to have a Gaussian frequency response with a 60% fractional bandwidth, and the
additive noise sampled by the ADC was assumed to be white.
(a) (b)
Fig. 3. (a) 36-bit RF codes designed using the modulation and search approaches using a two-cycle square wave as the base sequence.
(b) The normalized spectra of the base sequence, the wideband sequence for the modulation approach, and the RF codes.
As an example, the results from designing a 36-bit RF
code using the modulation and search approaches with the
two-cycle base sequence (i.e., {1, −1, 1, −1}) are shown
in Fig. 3. Fig. 3(a) shows the RF codes designed using
the two approaches, and Fig. 3(b) shows the normalized
spectra of the base sequence, the wideband sequence for
the modulation approach, and the RF codes. The spec-
trum in the transducer passband of the RF code designed
using the search approach is smoother and thus easier
to equalize than that designed using the modulation ap-
proach, resulting in a better compression performance and
a higher eﬃciency. Note that Fig. 3(b) also illustrates that
the base sequence controls the sampling ratio. If the base
sequence {1, 1, −1, −1, 1, 1, −1, −1} is used instead of
{1, −1, 1, −1}, the sampling ratio will be 4 instead of 2.
Given a code length Tc, N will increase by a factor of
2. Because there are more adjustable bits, the code de-
signed using the search approach will have a higher ef-
ﬁciency traded with a higher bit rate. For example, the
72-bit code “1CE73988CCCCCDD936” operating at a bit
rate of 100MHz has an eﬃciency of 1.11 dB (resulting from
an SNR of 21.31 dB at a ﬁlter length of 1.375 µs), which is
0.81 dB higher than that of its corresponding 36-bit code
operating at 50 MHz.
Fig. 4(a) shows the eﬃciencies of codes as functions
of their lengths. Each code designed using the search ap-
proach has a higher eﬃciency than its corresponding code
designed using the modulation approach with the same
base sequence, with the diﬀerence ranging between 1 and
6 dB. In addition, the eﬃciencies of codes designed using
huang and li: binary code design for high-frequency ultrasound 953
(a)
(b)
(c)
Fig. 6. (a) The averaged echo signal reﬂected from a wire. (b) The
spectrum of the echo signal. (c) The one-way impulse response de-
rived from the echo signal.
normalized transducer response can be estimated using
the following relation: ht(t) ∝ F−1
⌊
(F [−epulse(t)])1/2
⌋
,
where F and F−1 denote forward and inverse Fourier
transforms, respectively.
Figs. 6(a) and (b) show the echo signal epulse from the
wire (which is the average of 2000 records) and its spec-
trum, respectively. The estimated center frequency and
one-way −6 dB bandwidth were 26.4 and 20.7 MHz, re-
spectively. The estimated transducer impulse response is
shown in Fig. 6(c).
Twenty-six RF codes corresponding to the measured
transducer response were designed using the search ap-
proach with the same parameters as used in Section IV-
A for the genetic algorithm, nine of which correspond to
(a)
(b)
(c)
Fig. 7. Results for the measured transducer response shown in Fig. 6.
(a) The eﬃciencies of codes as functions of their lengths. (b) The
ﬁlter lengths that resulted in the maximal Ecf values equal to the
code eﬃciencies. (c) The output SNRs corresponding to the ﬁlter
lengths shown in (b).
N = 32 to 64 with a step size of 4 using a two-cycle square
wave as the base sequence, with the others corresponding
to N = 32 to 64 with a step size of 2 using a one-cycle
square wave as the base sequence (Table III). Fig. 7(a)
shows the eﬃciencies of codes as functions of their lengths,
and Figs. 7(b) and (c) show the ﬁlter lengths that resulted
in the maximal Ecf values (that equal the code eﬃciencies)
and the corresponding output SNRs, respectively. These
results are consistent with those given in Section IV-A.
Each code designed using the search approach has a higher
eﬃciency than its corresponding code designed using the
modulation approach with the same base sequence, with
the diﬀerence ranging between 0.5 and 5 dB. The higher
huang and li: binary code design for high-frequency ultrasound 955
and imaginary parts of the compression ﬁlter ho(n) to 8
bits, repeated the pulse compression procedure, and com-
pared the resultant SNR, SNRdB,q, with the SNR cor-
responding to the ideal ﬁlter, SNRdB,i. Deﬁne ∆SNR as
SNRdB,q − SNRdB,i. Figs. 8(a) and (b) show the ∆SNRs
as functions of the code length for the Gaussian-shaped
and measured transducer responses, respectively. All the
∆SNR values are small. Note that ∆SNR is equal to
the diﬀerence between code eﬃciencies with and with-
out amplitude quantization. Figs. 8(c) and (d) shows the
peak sidelobe levels for the Gaussian-shaped and measured
transducer responses, respectively. The results show that
amplitude quantization only slightly degraded the pulse
compression performance.
V. Conclusions
This paper proposes an approach to designing binary
codes having a low sampling ratio and providing eﬃcient
SNR improvements. Unlike the conventional modulation
approach in which a base sequence is used to modulate
wideband sequences up to the transducer passband, which
thereby excludes a major portion of the codes as possi-
ble RF codes, the proposed search approach uses a genetic
algorithm to search all the codes that match the trans-
ducer passband; hence, the resultant codes can improve
the SNR more eﬃciently. In the study, the bit rate was
set to 50 MHz in order to keep the sampling ratios about
2, and two transducer responses were considered in order
to demonstrate the adaptability of the proposed approach.
Assuming that the transducer has an ideal Gaussian fre-
quency response with a center frequency of 25 MHz and
a −6 dB bandwidth of 15 MHz, the codes designed using
the proposed approach outperformed those designed using
the modulation approach by 1 to 6 dB in terms of code
eﬃciency (i.e., in terms of the capacity for improving the
SNR normalized by the total length of the code and the
ﬁlter). When a real transducer with a center frequency of
26.4 MHz and a one-way −6 dB bandwidth of 20.7 MHz
was considered, the codes designed using the proposed ap-
proach were superior by 0.5 to 5 dB. Our approach can
be applied to designing binary codes with SNR improve-
ments in high-frequency ultrasound systems, for which us-
ing arbitrary-waveform transmitters may be infeasible. A
reasonable bit rate of 50 MHz will suﬃce if the ultrasonic
center frequency is 25 MHz.
Acknowledgments
The authors would like to thank Dr. Matt O’Donnell for
providing the equipment, including the pulser/receiver and
the oscilloscope, necessary for measuring the transducer
impulse response, and the reviewers for numerous helpful
comments.
References
[1] M. O’Donnell, “Coded excitation system for improving the
penetration of real-time phased-array imaging systems,” IEEE
Trans. Ultrason., Ferroelect., Freq. Contr., vol. 39, no. 3, pp.
341–351, 1992.
[2] R. Y. Chiao and X. Hao, “Coded excitation for diagnostic ul-
trasound: A system developer’s perspective,” IEEE Trans. Ul-
trason., Ferroelect., Freq. Contr., vol. 52, no. 2, pp. 160–170,
2005.
[3] M. O’Donnell and Y. Wang, “Coded excitation for synthetic
aperture ultrasound imaging,” IEEE Trans. Ultrason., Ferro-
elect., Freq. Contr., vol. 52, no. 2, pp. 171–176, 2005.
[4] Y. Wang, K. Metzger, D. N. Stephens, G. Williams, S. Brownlie,
and M. O’Donnell, “Coded excitation with spectrum inversion
(CEXSI) for ultrasound array imaging,” IEEE Trans. Ultrason.,
Ferroelect., Freq. Contr., vol. 50, no. 7, pp. 805–823, 2003.
[5] R. L. Haupt and S. E. Haupt, Practical Genetic Algorithms.
New York: Wiley, 1998.
[6] S.-W. Huang and P.-C. Li, “Arbitrary waveform coded ex-
citation using bipolar square wave pulsers in medical ultra-
sound,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol.
53, no. 1, pp. 106–116, 2006.
[7] B. Haider, P. A. Lewin, and K. E. Thomenius, “Pulse elon-
gation and deconvolution ﬁltering for medical ultrasonic imag-
ing,” IEEE Trans. Ultrason., Ferroelect., Freq. Contr., vol. 45,
no. 1, pp. 98–113, 1998.
[8] A. V. Oppenheim and R. W. Schafer, Discrete-Time Signal Pro-
cessing. Englewood Cliﬀs, NJ: Prentice-Hall, 1989.
[9] J. Ruprecht and M. Rupf, “On the search for good aperiodic
binary invertible sequences,” IEEE Trans. Inform. Theory, vol.
42, no. 5, pp. 1604–1612, 1996.
Sheng-Wen Huang was born in 1971 in
Changhua, Taiwan, R.O.C. He received the
B.S. and Ph.D. degrees from National Tai-
wan University, Taipei, Taiwan, R.O.C., in
1993 and 2004, respectively, both in electrical
engineering. He worked as a postdoctoral re-
searcher at National Taiwan University from
2004 to 2005, and is currently a postdoctoral
researcher with the Department of Biomedi-
cal Engineering at the University of Michigan.
His current research interests include thermal
strain imaging, coded excitation, and optoa-
coustic imaging.
Pai-Chi Li (S’93–M’95–SM’01) received the
B.S. degree in electrical engineering from
National Taiwan University, Taipei, Taiwan,
R.O.C., in 1987, and the M.S. and Ph.D. de-
grees from the University of Michigan, Ann
Arbor, MI, in 1990 and 1994, respectively,
both in electrical engineering: systems.
He was a research assistant with the De-
partment of Electrical Engineering and Com-
puter Science of the University of Michigan
from 1990 to 1994. He joined Acuson Corpo-
ration, Mountain View, CA, as a member of
the Technical Staﬀ in June 1994. His work with Acuson was primar-
ily in the areas of medical ultrasonic imaging system design for both
cardiology and general imaging applications. In August 1997, he went
back to the Department of Electrical Engineering at National Taiwan
University, where he is currently Professor of Department of Electri-
cal Engineering and Director of Institute of Biomedical Electronics
and Bioinformatics. His current research interests include biomedical
ultrasonic imaging and signal processing.
Dr. Li is a senior member of IEEE and Associate Editor of IEEE
Transactions on Ultrasonics, Ferroelectrics, and Frequency Control.
He is also on the Editorial Board of Ultrasonic Imaging. He received
the 2005 Outstanding Electrical Engineering Professor Award, the
Chinese Institute of Electrical Engineering, the 2004 Distinguished
Research Award, National Science Council, the 2004 Distinguished
Research Achievement Award, National Taiwan University, the 2003
Outstanding Researcher Award, National Taiwan University, the
ieee transactions on ultrasonics, ferroelectrics, and frequency control, vol. 54, no. 8, august 2007 1669
Performance Evaluation of Coherence-Based
Adaptive Imaging Using Clinical Breast Data
Shun-Li Wang, Chen-Han Chang, Hsin-Chia Yang, Yi-Hong Chou, and Pai-Chi Li, Senior Member, IEEE
Abstract—Sound-velocity inhomogeneities degrade both
the spatial resolution and the contrast in diagnostic ultra-
sound. We previously proposed an adaptive imaging ap-
proach based on the coherence of the data received in the
channels of a transducer array, and we tested it on phan-
tom data. In this study, the approach was tested on clin-
ical breast data and compared with a correlation-based
method that has been widely reported in the literature.
The main limitations of the correlation-based method in
ultrasonic breast imaging are the use of a near-ﬁeld, phase-
screen model and the integration errors due to the lack
of a two-dimensional (2-D) array. In contrast, the pro-
posed coherence-based method adaptively weights each im-
age pixel based on the coherence of the receive-channel
data. It does not make any assumption about the source of
the focusing errors and has been shown to be eﬀective using
1-D arrays. This study tested its in vivo performance us-
ing clinical breast data acquired by a programmable system
with a 5 MHz, 128-channel linear array. Twenty-ﬁve cases
(6 ﬁbroadenomas, 10 carcinomas, 6 cysts, and 3 abscesses)
were investigated. Relative to nonweighted imaging, the av-
erage improvements in the contrast ratio and contrast-to-
noise ratio for the coherence-based method were 8.57 dB
and 23.2%, respectively. The corresponding improvements
when using the correlation-based method were only 0.42 dB
and 3.35%. In an investigated milk-of-calcium case, the
improvement in the contrast was 4.47 dB and the axial
and lateral dimensions of the object were reduced from
0.39 to 0.32 mm and from 0.51 to 0.43 mm, respectively.
These results demonstrate the eﬃcacy of the coherence-
based method for clinical ultrasonic breast imaging using
1-D arrays.
I. Introduction
Aprimary performance limitation of diagnostic ultra-sound is the distortion introduced by sound-velocity
inhomogeneities in human tissue. Because the sound ve-
locity varies over a wide range (e.g., 1450 m/s in fat and
1665 m/s in collagen [1]), the use of a constant sound veloc-
ity when calculating focusing delays inevitably results in
focusing errors. Such focusing errors also are termed phase
aberrations, and they degrade both the spatial resolution
and the contrast in the resultant images.
Manuscript received October 4, 2006; accepted March 2, 2007. Sup-
port from the National Science Council of Taiwan under grant no.
NSC 95-2221-E-002-170 is gratefully acknowledged.
S.-L. Wang, C.-H. Chang, H.-C. Yang, and P.-C. Li are with the
Department of Electrical Engineering, National Taiwan University,
Taipei, Taiwan.
Y.-H. Chou is with the Department of Radiology, Taipei Veterans
General Hospital, Taipei, Taiwan.
P.-C. Li also is with the Graduate Institute of Biomedical Electron-
ics and Bioinformatics, National Taiwan University, Taipei, Taiwan
(e-mail: paichi@cc.ee.ntu.edu.tw).
Digital Object Identiﬁer 10.1109/TUFFC.2007.438
Several phase-aberration correction techniques have
been proposed to adaptively reduce these errors and
thereby improve the image quality [2]–[15]. Flax and
O’Donnell [2] proposed a correlation-based method that
modeled sound-velocity inhomogeneities as a near-ﬁeld
phase screen, which assumes that time-delay errors pro-
duce phase aberrations only at the surface of the trans-
ducer. The near-ﬁeld phase screen can be estimated by
ﬁnding the peak of the cross-correlation function of the sig-
nals from adjacent channels [2], [3], or using those from the
individual channels to the beam sum [4] or partial beam
sum [5]. Phase aberrations theoretically can be corrected
by compensating for the time-delay errors, but several fac-
tors have limited the clinical applications of correlation-
based methods. First, the near-ﬁeld phase-screen model is
often inadequate because sound-velocity inhomogeneities
result in not only time-delay errors but also energy-level
ﬂuctuations and waveform distortion. This led to a dis-
placed phase-screen model that accounts for phase aberra-
tions as a phase screen positioned some distance from the
transducer surface [6]. However, its performance in ultra-
sonic breast imaging is still insuﬃcient because the sound-
velocity variations in breast are more distributed. The
other reason for the inadequate performance of correlation-
based methods is the three-dimensional (3-D) nature of
sound-velocity inhomogeneities. Preventing aberrator in-
tegration errors in time-delay estimation requires the use
of a 1.5-D or 2-D array [7], [16]. However, these are not
yet in widespread use in clinics due to the signiﬁcantly
increased system complexity and cost.
Adaptive sidelobe-reduction techniques also can be used
to reduce focusing imperfections [8]–[15], one example of
which is the parallel adaptive receive-compensation algo-
rithm (PARCA) [8]–[11]. At each image point, the PARCA
removes unwanted sidelobe contributions and maintains
the mainlobe signal intensity by estimating the on-axis and
oﬀ-axis signal components. However, a signiﬁcant draw-
back of PARCA is its computational complexity.
Another adaptive sidelobe-reduction method is based
on the use of the coherence factor (CF) of the receive-
channel data [12]–[14], which represents a focusing-quality
index:
CF =
∣∣∣∣N−1∑
i=0
S(i, t)
∣∣∣∣
2
N
N−1∑
i=0
|S(i, t)|2
. (1)
0885–3010/$25.00 c© 2007 IEEE
wang et al.: evaluation of coherence-based adaptive imaging using breast data 1671
Fig. 1. Signal processing procedures of the proposed GCF-weighting technique.
Fig. 2. Clinical data-acquisition apparatus.
data of the female breast were collected in the ultrasonic
consulting room of the Taipei Veterans General Hospital
by one of the authors (Y.-H. Chou) after patients had pro-
vided informed consent. A total of 25 patients aged from
23 to 89 years were included. Among them, there were 6
ﬁbroadenomas, 10 carcinomas, 6 cysts, and 3 abscesses.
A schematic of the experimental apparatus is shown in
Fig. 2, which included a mechanical compression stage sim-
ilar to that used in X-ray mammography to stabilize the
breast during data acquisition. A programmable imaging
system with 64 system channels (DiPhAS, IBMT, Fraun-
hofer Institutes, St. Ingbert, Germany) was used to ac-
quire the aperture-domain data (i.e., the receive-channel
data prior to beam summation). The linear transducer ar-
ray had a center frequency of 5 MHz, a −6 dB bandwidth
of 4.1 MHz and 128 channels (L6/128, Sound Technology,
State College, PA) at a pitch of 0.3 mm. A complete data
set was obtained from each patient (i.e., 128× 128 RF A-
mode scans recorded from the 128-element array, for which
each A-mode scan represents the echo signal of a partic-
ular transmit/receive combination) at a sampling rate of
20 MHz. Each complete data set took approximately 3 s to
acquire. The acquired data sets were used to reconstruct
the aperture-domain data with full dynamic focus on both
transmit and receive. In order to evaluate tissue motion,
B-mode images were acquired and stored before and after
full data set acquisition. The two images then were com-
pared to make sure that no noticeable tissue motion was
present. An f-number of 1 was applied for aperture control.
All images displayed here are in linear gray scale mapping
with a dynamic range of 60 dB and are shown in a linear
scan format. The step size for the linear scan was 0.15 mm
(i.e., half the pitch of the transducers). B-mode images are
formed by applying transmit and receive focusing delays
before beam summation, and multiple imaging methods
can be compared with one another using the same data
set.
III. Experimental Results
A. Cut-oﬀ Frequency M0
In the GCF technique, cut-oﬀ frequency M0 should
be speciﬁed so as to achieve optimal performance. Both
the contrast ratio (CR) and contrast-to-noise ratio (CNR)
were used in the experiments to evaluate the eﬀects of
varying M0. The CR is deﬁned as the ratio between the
mean value in a background region to that in a region of
interest (ROI) [3]. The CNR is deﬁned as the ratio be-
tween the CR and the standard deviation of the image
intensity in a background region [4]. Fig. 3(a) shows an
original image without application of the GCF-weighting
method, and Figs. 3(b)–(f) show the GCF-weighted im-
ages with M0 ranging from 0 to 4. Note that M0 = 0 rep-
resents the case of using the CF. The background region
and ROI used to calculate CRs and CNRs are indicated
in Fig. 3(a) by the black and white boxes, respectively.
The ROI in this case is a cyst. Note that in all cases the
contrast is clearly improved, and the background noise is
suppressed. Figs. 4(a) and (b) show the CR and CNR after
GCF weighting as functions of M0, respectively. Fig. 4(a)
shows that the CR was improved in all cases, decreasing as
M0 increased. When the background-intensity variations
are taken into account, Fig. 4(b) shows that the CNR was
not improved when M0 = 0. Nevertheless, with M0 ≥ 1,
CNR improvement is again demonstrated. Speciﬁcally, the
optimal CNR was achieved at M0 = 3 in this case. The
results indicate that using CF as a weighting index can
wang et al.: evaluation of coherence-based adaptive imaging using breast data 1673
Fig. 4. Values of CR (a) and CNR (b) for the specimen shown in Fig. 3 as functions of M0.
Fig. 5. Images of a cyst in a 66-year-old woman, displayed with a dynamic range of 60 dB: original B-mode image (a), and images obtained
using the correlation-based method (b) and the GCF-weighting method (c). The black box in (a) indicates the background image. The white
box indicates the ROI. (d) Intensities of the scan-line data along the gray dotted lines shown in (a) and (c) using solid and dashed lines,
respectively.
wang et al.: evaluation of coherence-based adaptive imaging using breast data 1675
Fig. 6. Images of a ﬁbroadenoma in a 42-year-old woman, displayed with a dynamic range of 60 dB: original B-mode image (a), and images
obtained using the correlation-based method (b) and the GCF-weighting method (c). The black box in (a) indicates the background region.
The white box indicates the ROI.
Fig. 7. Images of a carcinoma in a 63-year-old woman, displayed with a dynamic range of 60 dB: original B-mode image (a), and images
obtained using the correlation-based method (b) and the GCF-weighting method (c). The black box in (a) indicates the background region.
The white box indicates the ROI.
Fig. 8. Images of an abscess in a 31-year-old woman, displayed with a dynamic range of 60 dB: original B-mode image (a), and images
obtained using the correlation-based method (b) and the GCF-weighting method (c). The black box in (a) indicates the background region.
The white box indicates the ROI.
wang et al.: evaluation of coherence-based adaptive imaging using breast data 1677
comes. Therefore, these images also were evaluated by
an experienced clinician (Y.-H. Chou) using the following
scoring system: 2+, signiﬁcant improvement; 1+, moder-
ate improvement; 0, no noticeable eﬀects; 1−, slight degra-
dation; and 2−, signiﬁcant degradation. In general, appli-
cation of the GCF-weighting method improved the image
quality in all the cases assessed in this study. The improve-
ment in the contrast was more signiﬁcant for a liquid lesion
(e.g., a cyst) than for a solid lesion (e.g., a ﬁbroadenoma),
and the improvement in the boundary deﬁnition makes it
easier to detect a malignant tumor (e.g., a carcinoma).
The proposed method requires only the use of individual
channel data for each ﬁring. Nonetheless, complete data
sets were acquired in this study. With the complete data
set, dynamic, two-way focusing can be realized. Therefore,
the problem associated with reduced coherence at posi-
tions away from the ﬁxed transmit focus can be avoided.
However, acquisition of a complete data set suﬀers from
lower signal-to-noise ratios and potential motion artifacts.
In clinical situations, a reasonable compromise is to use
multizone focusing on transmit.
Although the correlation-based method is one of the
most popular adaptive imaging methods reported in the
literature, several problems were encountered when we ap-
plied this to breast imaging in this study. The estimated
time delays were aﬀected by several factors, including the
cumulative error along the array direction, the signal-to-
noise ratio, the correlation between adjacent channels, the
kernel size, and the aberrator integration errors of a 1-
D array [17]–[19]. In addition to the above problems, the
distributed sound-velocity inhomogeneities also represent
a uniquely diﬃcult problem in adaptive breast imaging,
as illustrated in Fig. 10. The image shown in Fig. 10(a)
is displayed without any aberration correction. Fig. 10(b)
plots the estimated time-delay errors as a function of the
channel index at the image points corresponding to the
boxes marked in Fig. 10(a), which are located along the
same beam and are spaced by 7.7 mm. The time delays
were estimated according to previously described princi-
ples [3]. Signiﬁcant variations in the estimated time delays
are clearly evident, and these limit the performance of the
correlation-based method. The depth dependency of the
estimated time delay may result from breast tissue com-
prising a heterogeneous mixture of fatty, ﬁbrotic, connec-
tive, and glandular tissues.
The arrival time and energy level reportedly vary with
breast sample thickness [20], and the correlation length of
the aberration proﬁle in breast tissue varies with age and
body type [20]–[22]. Therefore, it is to be expected that
the near-ﬁeld, phase-screen model is inaccurate, resulting
in poor breast imaging when using the correlation-based
method. It also has been reported that waveform distortion
is severe and sidelobes are high for breast tissue, primarily
because it is a highly refracting and heterogeneous medium
[20], [23]–[25]. Therefore, adaptive sidelobe-reduction tech-
niques, such as the GCF-weighting method investigated in
the study, are of particular interest because they do not
make any assumptions regarding the origin of the side-
Fig. 10. Estimated time-delay errors. (a) Clinical image displayed
with a dynamic range of 60 dB. (b) Corresponding estimated time-
delay errors as functions of channel index at the imaging points in-
dicated in (a).
lobes. As shown in this paper, application of the GCF-
weighting method signiﬁcantly improves the contrast and
boundary deﬁnition for cyst and solid masses. We also have
demonstrated that the GCF-weighting method is more ef-
fective than correlation-based methods in improving the
quality of images obtained from ultrasonic breast imaging
without the use of a 2-D (or 1.5-D) array.
This paper illustrates eﬃcacy in sidelobe reduction of
the proposed method using 1-D arrays. Nonetheless, the
proposed method also can be extended to imaging with
1.5-D/2-D arrays. In particular, because the aperture also
is sampled along the elevational direction, the proposed
method can be applied to improve elevational focusing
quality. Signal processing required for elevational GCF
weighting with 1.5-D/2-D arrays will be similar to that
for lateral GCF weighting with 1-D arrays.
V. Conclusions
In this paper, we have experimentally evaluated an
adaptive imaging approach for reducing focusing errors
wang et al.: evaluation of coherence-based adaptive imaging using breast data 1679
Chinese Institute of Electrical Engineering, the 2004 Distinguished
Research Award, National Science Council, the 2004 Distinguished
Research Achievement Award, National Taiwan University, the 2003
Outstanding Researcher Award, National Taiwan University, the
2002 Dr. Wu Dayou Research Award from National Science Council,
the 2002 Outstanding Young Electrical Engineer Award from Chi-
nese Institute of Electrical Engineering and the Distinguished Indus-
trial Collaboration Award of Ministry of Education. He was also the
recipient of the Distinguished Achievement Award in Electrical En-
gineering: Systems in 1994 for his outstanding academic achievement
at the University of Michigan.
imaging setup as that used for conventional B-mode
im
ad
the
Th
int
lim
yie
(H
ap
ifie
mo
no
cri
eff
ma
str
ati
set
ch
an
to
the
Re
co
20
as
res
tis
so
(B
cie
roo
pro
of
po
if
an
wh
the
Th
fre
(
wa
the
wh
to
eq
for
wh
an
Fig
1682 Ultrasound in Medicine and Biology Volume 33, Number 11, 2007aging and, thus, both imaging methods can be used. In
dition, a plate reflector is placed under the breast, and
breast is under compression during data acquisition.
is approach also requires the selection of a region-of-
erest (ROI) to alleviate the difficulties caused by the
ited angles of tomographic data acquisition, and it has
lded good results on tissue-mimicking phantoms
uang and Li 2004b, 2005). In the present study we
plied the approach to clinical data, and we also mod-
d the original method to accommodate tissue inho-
geneities that are present in breast tissue (which were
t present in the phantoms used previously). Because a
tical step in this approach is preselecting an ROI, the
ects of variations in the ROI selection on the perfor-
nce of the method were also determined.
METHODS
This section first introduces the method for recon-
ucting the distributions of sound velocity and attenu-
on coefficient, and then describes the experimental
up for acquiring clinical data from individual array
annels. We then list the procedures of ROI selection
d the implementation of a least-squares (LS) filter used
reduce distortion from tissue inhomogeneities and
n, finally, we describe the patients.
construction of sound velocity and attenuation
efficient
Based on our previous studies (Huang and Li 2004a,
04b, 2005) and Kossoff et al. (1973), water was used
a reference, whereby for each clinical dataset, a cor-
ponding dataset acquired with water replacing breast
sue was also acquired without changing the setup. The
und velocity of water (c0) was assumed to be 1496 m/s
ilaniuk and Wong 1993) and the attenuation coeffi-
nt of water (0) was specified as 0 dB/cm/MHz at
m temperature, 25°C. As described below, the known
perties of water were used to estimate the properties
the breast. Let c1(x,y) denote the sound velocity at the
sition (x,y) in the B-mode image. As shown in Fig. 1,
the ultrasonic signal has round-trip times-of-flight t0
d t1 in water and breast, respectively, then
t0
L
1
c0
dl
L
s0dl, (1)
t1
L
1
c1(x, y)dl
L
s1 (x, y)dl, (2)
ere L is the signal path length and s1(x,y) is defined as
slowness. The difference between t0 and t1 ist t1 t0
L
s1 (x, y) s0dl
L
s (x, y)dl. (3)
e attenuation coefficient is linearly proportional to
quency in the frequency ROI and represented by
x,y). Let A0( f ) and A1( f ) denote the echo spectra for
ter and breast as the propagating media, respectively,
n
A( f ) 20 log10(A0( f )) 20 log10(A1( f )) (dB),
(4)
A
L
 (x, y)dl (dB ⁄ MHz), (5)
ere A is also the slope of a first-order polynomial fit
A( f ).
The integral equations previously mentioned (i.e.,
ns (3) and (5)) can be written in the following discrete
ms:
tij
n1
N

m1
M
s (m, n)lij (m, n), (6)
Aij
n1
N

m1
M
 (m, n)lij (m, n), (7)
ere the B-mode image is divided into N  M pixels,
d the index ij represents the transmit–receive channel
. 1. Illustration of the time-of-flight and tissue attenuation of
the water signal (top) and the breast signal (bottom).
Region of interest selection
Fig
int
tou
ha
Th
fea
siz
co
ha
pro
so
un
Th
for
av
de
thi
da
sh
an
tio
t
A
wh
im
de
wh
ea
rec
pa
s
co
of-
ce
Le
the
am
sig
19
Fig
Fig
ech
bre
lin
the
1684 Ultrasound in Medicine and Biology Volume 33, Number 11, 2007For each dataset, an ROI such as the one shown in
. 3a was preselected manually using a graphical user
erface. According to Chiang et al. (2001), some con-
r features, such as spiculation and angular margin,
ve been recognized as characteristics of malignancy.
e clinician chose the ROIs according to the primary
tures associated malignancy such as echogenicity,
e, shape and the border of the tumors. Some additional
ntour features, such as spiculation and angular margin,
ve also been used. The purpose of ROI selection is to
vide reconstruction constraints by forcing both the
und velocity and attenuation coefficient values to be
iform inside and outside the ROI (Huang and Li 2005).
e assumption of uniformity can be seen as the average
that region. A technique for measuring the in-vivo
erage velocity of ultrasound in the female breasts was
veloped in Kossoff et al. (1973). In Fig. 3a and b, the
ck solid line represents the ROI path, whereas the
shed line is for the background path. In Fig. 3b, it
ows that the signal is transmitted from the ith channel
d received by the jth channel. Based on the aforemen-
ned constraints, eqns (6) and (7) can be reduced to
ijSROI
n1
N

m1
M
lij,ROI (m, n)sback
n1
N

m1
M
lij,back (m, n)
 lij,ROIsROI lij,backsback, (10)
ijROI
n1
N

m1
M
lij,ROI (m, n)back
n1
N

m1
M
lij,back (m, n)
 lij,ROIROI lij,backback. (11)
ere (m,n) corresponds to one pixel in the B-mode
age. When i is not equal to j,  is not equal to zero
gree. Also, eqns (8) and (9) are modified to
[lROI lback]sROIsbackt, (12)
[lROI lback]ROIbackA, (13)
ere lROI, lback, t and A are column vectors, with
ch element therein representing a valid transmission–
eption combination. lROI is the total length of the ROI
th and lback is the total length of the background path,
is the difference in slowness,  is the attenuation
efficient, t is the estimated difference in the times-
flight and A is the estimated attenuation at the
nter frequency of 5 MHz.ast-squares filter for distortion reduction
Due to the inhomogeneities present in breast tissue,
received signal is often severely distorted in both
plitude and phase compared with those of a water
nal (Lewin and O’Brien 1996; Zhu and Steinberg
92, 1994, 1996, 1997). A typical example is shown in
. 4a (envelope of water signal with no distortion) and
. 4. Envelopes of the received signals, which are the first
o reflected from metal reflector: (a) water, (b) breast and (c)
ast before (thick solid line) and after LS filtering (dashed
e). The distortion from the breast tissue is clearly shown as
peak position is shifted, waveform is changed and the
clutter signal is higher.
an
an
Th
cy
co
cy
rel
we
dB
str
the
en
res
we
als
as
itie
an
Th
3
tio
wa
1.5
res
ve
m/
18
thr
atu
of
ua
ve
7
ba
the
co
ind
cie
ua
fro
so
15
ua
0.0
ea
Ta
I.
II.
Table 1. Average sound velocity and attenuation coefficient
CA
FA
Fat
Table 3. Relative attenuation coefficient at two reference
Re
I.
II.
Fig
fi
1686 Ultrasound in Medicine and Biology Volume 33, Number 11, 2007The relative sound velocities are shown in Fig. 6
d were 49.8  35.2 m/s (mean  SD), 2.6  27.3 m/s
d 25.1  44.9 m/s for CA, FA and fat, respectively.
e relative sound velocity for the single case of an oil
st was 9.4 m/s. According to Fig. 6, it is possible to
rrectly distinguish 14 of 18 cases (excluding the oil
st) using thresholds of 18.5 m/s and 28.3 m/s. The
ative attenuation coefficients are shown in Fig. 7 and
re 0.21  0.58, 0.27  0.62 and 0.02  0.59
/cm/MHz for CA, FA and fat, respectively. It demon-
ates that, unlike sound velocity, it is not feasible to use
relative attenuation coefficient to distinguish differ-
t types of objects. On the other hand, the average
ults of sound velocity and attenuation coefficients
re put in Table 1.
Effects of different reference sound velocity were
o investigated. As shown in Table 2, using 1522 m/s
the sound velocity in water, the relative sound veloc-
s are 44.9  35.9 m/s (mean  SD), 13.0  40.5 m/s
d 55.9  30.9 m/s for CA, FA and fat, respectively.
e sound velocity thresholds can be set at 17.6 m/s and
9.3 m/s, respectively. Similarly, the relative attenua-
n coefficients using 1522 m/s as the sound velocity in
ter, as shown in Table 3, are 0.30  0.45, 0.24 
9 and 0.16  0.64 dB/cm/MHz for CA, FA and fat,
pectively.
From the tables, we found that the relative sound
locities changed by 4.9 m/s, 10.4 m/s and 30.8
s for CA, FA and fat, respectively. Nonetheless, 14 of
cases can be distinguished in both cases by choosing
eshold individually. Also, it showed that the temper-
re control during data acquisition is critical.
Because the ROI was selected manually, the impact
ROI selection on the estimation results was also eval-
ted. Figure 8a and b show, respectively, the sound-
ble 2. Relative sound velocity at different reference sound
velocities
Relative sound
velocity (m/s) CA FA Fat
c0  1496 m/s 49.8  35.2 2.6  27.3 25.1  44.9
c0  1522 m/s 44.9  35.9 13.0  40.5 55.9  30.9
with SD
Sound velocity
(m/s)
Attenuation coefficient
(dB/cm/MHz)
1530.9  36.2 0.66  0.52
1499.8  26.8 0.68  0.66
1464.8  45.1 0.63  0.61locity and attenuation-coefficient results for patients 1,
and 9 as examples. The estimation results for the
ckground generally do not change with ROI areas in
range 10 to 140 mm2. However, the attenuation
efficient of ROI for patient 7 is an exception. This may
icate that the assumption that the attenuation coeffi-
nt is uniform inside the ROI is invalid in this case.
As shown in Table 1, the sound-velocity and atten-
tion-coefficient results reported in this paper differ
m those reported in the literature. In Duck (1990), the
und velocities for CA and FA were 1550 32 m/s and
84  27 m/s, and in Landini et al. (1985), the atten-
tion coefficients for CA, FA and fat were in the range
8 to 0.16 dB/cm/MHz. In Huang and Li 2005, for
ch transmit-receive combination, data corresponding
sound velocities
lative attenuation
coefficient
(dB/cm/MHz) CA FA Fat
c0  1496 m/s 0.21  0.58 0.27  0.62 0.02  0.59
c0  1522 m/s 0.30  0.45 0.24  1.59 0.16  0.64
. 8. (a) Estimated sound velocity and (b) attenuation coef-
cient as functions of the ROI area for patients 1, 7 and 9.
出席國際學術會議心得報告 
                                                             
計畫編號 NSC95-2221-E-002-169 
計畫名稱 新參數超音波乳房影像技術(3/3) 
出國人員姓名 
服務機關及職稱 
李百祺/台灣大學電機系/台灣大學生醫電子與資訊學研究所 
會議時間地點 2007/10/28-2007/10/31 New York, USA 
會議名稱 IEEE Ultrasonics Symposium 
發表論文題目 六篇論文附錄於成果報告 
 
一、參加會議經過 
此 IEEE 國際超音波研討會(IEEE Ultrasonics Symposium)，今年在美國紐約(New York, 
USA)舉行。此會議每年舉辦一次，主要是提供世界各地從事超音波相關領域的專家學者一個
發表研究成果及討論交換心得的機會，自 2007/10/28 到 2007/10/31 共四天，於美國紐約之
Hilton New York舉行。本人參加之重點為生物醫學超音波之相關議程。如同往年，此次研討
會參與程度相當踴躍，發表論文亦有一定水準，相信與會者皆感到不虛此行。 
 
二、與會心得 
 此研討會分為工業超音波及生醫超音波兩大部分，由議程看來，今年度會議在生醫超音
波的重點在於新成像技術(beamformation) 、高頻探頭製作、光聲影像(Photoacoustic Imaging)
及分子影像（Molecular Imaging）等。本人之報告共計六篇，整體來說屬於全球相關領域產
出較多的實驗室之一，所發表的題目分別為” In vitro blood flow mean velocity estimation using 
a fast photoacoustic imaging system”、”Identification of hepatocellular carcinomas with contrast 
enhanced 40 MHz ultrasound in hepatitis B Virus X protein transgenic mice”、”Breast ultrasound 
computer-aided diagnosis using both acoustic and image features” 、 ”Error analysis of 
autocorrelation-based velocity vector estimation in the aperture domain”、“Coded excitation and 
nonlinear pulse compression in pulse inversion fundamental imaging ”、“Fabrication and Assembly 
of A Monolithic 3D CMUT Array for Imaging Applications ”。其中第一篇為新穎之光聲影像系
統，是關於血流速度之量測。第二篇為使用高頻超音波對比增強影像應用於肝腫瘤之辨識。
第三篇為利用聲學與影像特徵之乳房超音波電腦輔助診斷。第四篇為基於自相關的速度向量
