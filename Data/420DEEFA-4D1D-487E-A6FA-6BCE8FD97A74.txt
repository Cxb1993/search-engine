 2 
用優惠；農委會更為了使消費者能識別安全的農產品，實施農產品產銷履歷，在農產品包裝外印有
QR 碼以利辨認。也可利用裝有 QR 碼解碼器的手機直接連線或以一般電腦透過「台灣農產品安全
追溯資訊網」( http://taft.coa.gov.tw ) 網路查詢該農產品產銷履歷相關資訊。 
在 QR 碼漸漸普及的今日，各式商業應用也紛紛登場，然而如何確保商務行為過程中，QR 碼
資訊的正確性，就成為必須探討的課題。不肖商人與投機的顧客都有可能因非法目的而重製或複製
QR 碼。例如 A 商品即將過期，商人讀取其 QR 碼標示資訊，將其中保存期限部分修改再製作全新
的 QR 碼，貼回 A 商品上以誤導客人；又如 B 商品經過產品檢驗合格，C 商品未經檢驗，不肖商
人複製 B 商品的 QR 條碼，貼到 C 商品上企圖魚目混珠；再如投機顧客 D 拿到以 QR 碼當成購買
身分鑑別圖檔，也可能複製或修改重製此圖檔，以達到其以假亂真的不法目的。本計畫以新的資訊
隱藏的技術提出在 QR 碼中可額外隱藏機密資訊之編、解碼器，以解決上述的問題。使用本計畫所
提方法在 QR 碼中隱藏機密資訊，一般標準 QR 碼解碼器仍可正常讀取原標示資訊，但無法解讀所
隱藏機密資訊(圖一)。 
 
 
圖一：本計畫所提具隱藏資訊能力 QR 碼之編、解碼示意圖。 
2. 相關技術簡介 
2.1 QR 碼簡介 
QR 碼是一種正方形矩陣式二維條碼，由黑白兩色小方塊組成，黑色小方塊代表 1，白色小方
塊代表 0。這些黑白小方塊稱之為模組(module)。QR 碼有 40 種版本(version)，版本越大，所能儲
存的資料量也越多。版本編號 1 的面積最小，其尺寸長寬各為 21 個模組，版本編號 40 的面積最大，
其尺寸長寬各為 177 個模組。相鄰版本編號間之尺寸長寬差各為 4 個模組。在 QR 碼的右上、左上、
左下三個角落分別有長寬各為 7 個模組寬的正方形「回」字樣式，稱為搜尋樣式(finder pattern)，
這是 QR 碼與其他二維條碼明顯不同之處。為了增加抗污損能力， QR 碼共使用了
RS(Reed-Solomon)[10-11]、BCH[12-13]、Golay[14-15]三種錯誤更正編碼技術。QR 碼在資料編碼部
分使用 RS 錯誤更正編碼，並根據不同的需求制定 L、M、Q、H 四個錯誤更正等級，其容錯能力
分別從 7％到 30％，以供在不同環境之下選擇較高容錯能力或較大的資訊容量。 
 4 
3. 本計畫所提之兩種隱藏方法  
3.1 在 QR 碼中之強韌性資訊隱藏法 
本計畫所提第一個方法之概念係在經錯誤更正編碼之區塊中以隨機種子(random seed)產生隨
機次序(random order)挑選部分碼字符號，將其置換為欲嵌入的機密資訊。日後解碼時，只要使用
相同隨機種子便會產生相同的隨機次序，就可從碼字符號中擷取出所隱藏之機密資料。並可藉由錯
誤更正程序還原回原始資訊符號。QR 碼中的資料經過錯誤更正編碼後，形成由一至多個區塊(block)
組成的碼字符號序列(sequence of codeword symbol)，其中每個區塊皆以碼字符號(codeword symbol)
所組成。在 QR 碼中，碼字符號序列之各區塊之碼字符號個數也可能會有些許差異。如 QR 碼版本
10、錯誤更正等級 H 之碼字符號序列包含兩個區塊，區塊之碼字符號個數分別是 43、44。此外，
各區塊所允許錯誤的碼字符號數也可能不同。本方法首先根據 QR 碼的版本、錯誤更正等級判斷
其各區塊中所包含的碼字符號個數以及所允許錯誤的碼字符號個數。隨後利用隨機種子以及上述兩
個參數為各區塊產生一個隨機次序，按此次序逐一將區塊中選出的碼字符號置換為欲嵌入的機密資
訊。以圖三為例，在第一個區塊中，依照隨機次序挑選了第 1 個、第 3 個碼字符號做嵌入，第二個
區塊挑選了第 2 個碼字符號做嵌入，而在第三個區塊，則是先挑選了第 4 個碼字符號嵌入，隨後再
挑選第 2 個、第 7 個碼字符號嵌入。當要擷取資密資訊時，同樣根據 QR 碼的版本、錯誤更正等級
判斷各區塊中包含的碼字符號個數以及所允許錯誤的碼字符號個數，再配合和嵌入時相同的隨機種
子為每個區塊還原出嵌入時的隨機次序。利用此隨機次序即可一一將機密資訊取回。當機密資訊擷
取完成，再進行 RS 錯誤更正程序，還原回原始正確的資料碼字，如此 QR 碼所記錄的原始標示資
訊仍可被正確解讀。 
圖三：以隨機次序挑選部分碼字符號之示意圖。
在每個錯誤更正編碼區塊中都會以隨機次序挑選欲置換的碼字符號，隨機次序的產生有三個因
素：隨機種子、該區塊包含的碼字符號個數、該區塊允許的錯誤碼字符號數。第一項是指由使用者
自訂一初始的隨機種子，再藉由雜湊函數為每個區塊產生各自的隨機種子。只要記錄此初始的隨機
種子即可在擷取時還原出所有的隨機次序。後兩項則由 QR 碼的版本、錯誤更正等級來決定。區塊
包含的碼字符號數表示有多少碼字符號可供挑選。區塊允許的錯誤碼字符號數則是決定該區塊最多
可挑選幾個碼字符號來做嵌入置換。挑選出進行嵌入的碼字符號個數越接近區塊所允許的錯誤碼字
符號數，代表嵌入的容量越多。但對於 QR 碼來說，本方法嵌入機密資訊會使得碼字符號發生「人
為的錯誤」。嵌入量越多，相對能容忍其他日後自然污損而發生錯誤的空間也就越小，也造成解碼
失敗的機率提高。萬一超過區塊所能承受的錯誤碼字符號上限，則會導致 QR 碼錯誤更正失敗，無
 6 
order)排列成表。要嵌入機密資訊時，先取出機密資訊中之 ⎥⎦
⎥⎢⎣
⎢
−×= ))!(!
!(log2 knk
nb 個位
元之位元串，令其值為 m (m 值範圍為 12~0 −b )，並選擇此表中順序為 m 的碼字位
置組合，再在此組合之各碼字進行嵌入機密資訊的動作。換言之，在表中選擇碼字
符號位置組合就可先隱藏 b 個位元的機密資訊。以表一為例，假設要從「 1、2、3、
4、 5」中挑選 3 個數字，其所有可能的挑選組合有 10
)!35(!3
!5 =−× 種，此表中組合順
序定為 0 到 9，可提供隱藏 ⎣ ⎦10log2 =3 個位元的機密資訊。假設機密資訊為 2010 ，
便選擇順序為 2 的「 1、2、5」組合。換言之，日後發現先前所選擇的是「 1、2、5」
組合，就表示所隱藏機密資訊為 2010 。擷取機密資訊時，藉由錯誤更正解碼程序，
便可偵測出所有發生錯誤的碼字位置。這些發生錯誤的位置也就是先前嵌入資訊的
位置。檢視這些嵌入位置的組合在表中之排序順序，將此順序值以 b 個位元表示，
即可得知先前所隱藏的機密資訊位元串。接著按照此組合中所列之碼字符號位置，
逐一擷取出各碼字符號中的所隱藏的機密資訊位元串，即可得到完整的機密資訊。 
由於在解碼時要藉由 RS 碼錯誤更正步驟偵測發生錯誤的碼字符號位置，才可
找回代表字典順序之機密資訊位元串，所以在碼字符號所嵌入之機密資訊位元串一
定要與此碼字符號原始位元串內容不同，否則無法偵測到。因此本方法保留每個所
挑選出位置之碼字符號的最高位元不做嵌入資料使用，但將進行其反相 (Inverse)
處理，其餘 7 個低位元則可供做置換嵌入機密資訊使用。這樣就可確保嵌入機密資
訊後之碼字符號內容與原始內容不同。  
 
表一：「 1、 2、 3、 4、 5」選取 3
個數目之所有組合與字典
順序表  
字典順序 組合 
0 1 2 3 
1 1 2 4 
2 1 2 5 
3 1 3 4 
4 1 3 5 
5 1 4 5 
6 2 3 4 
7 2 3 5 
8 2 4 5 
9 3 4 5 
 
 
 8 
號作嵌入，相當於影響 144 個位元。圖五(c)為嵌入前後 QR 碼之差異圖。圖五(d)則是對圖五(b)進
行污染攻擊測試後之 QR 碼，共有 28 個碼字符號被污染攻擊測試所破壞。因為 QR 碼中有 18 個碼
字符號已因先前嵌入置換「Lab test」文字而破壞，但污染攻擊所破壞的碼字符號中有 3 個與先前
破壞的碼字符號重複。換言之，圖五(d)之 QR 碼合計有 43(28-18-3)個碼字符號被破壞，相當於最
多有 344 個黑白模組改變。若使用具 QR 碼讀取程式的手機，仍可讀取原始資訊「National Kaohsiung 
First University of Science and Technology」，使用本方法製作之解碼器則可同時解出原始資訊和機密
資訊「Lab test」。本實驗之結果證明被嵌入機密資訊的 QR 碼，除仍然可保有原標示資訊的錯誤更
正能力之外，所嵌入的機密資訊也擁有強韌性。 
 
0
2000
4000
6000
8000
10000
12000
1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39
QR Code symbol version
可
嵌
入
位
元
數
EC Level L EC Level M EC Level Q EC Level H
 
圖四：本計畫所提第一個隱藏方法之可嵌入容量預估。 
 
  
  
(a) (b) (c) (d) 
圖五：使用本計畫所提之第一個資訊隱藏方法，嵌入機密資訊「Lab test」文字前、後之
QR 碼變化。(a) 原始 QR 碼；(b) 嵌入「Lab test」後之 QR Code 碼；(c) 圖七(a)與圖七
(b)之差異圖；(d) 圖七(b)遭受污染攻擊後之結果。 
 
圖六為本計畫所提第二種方法在 QR 碼版本 1 到 40 可嵌入資料量預估圖。相較於
本計畫所提之第一個方法，本方法之嵌入量在各錯誤更正等級均有增加。所增加的
部分即為利用挑選出的碼字符號位置組合所嵌入的部分。圖七為本方法之實驗，實
驗之 QR 碼的原始標示資訊為「National Kaohsiung First University of Science and 
Technology」，其版本數、錯誤更正等級、模式與第一個方法實驗所用 QR 碼相同。
 10 
2. R. J.  Anderson and F. A. P. Peticolas,“On The Limits of Steganography,” IEEE 
Journal of Selected Areas in Communication,  vol16, no. 4, pp. 474-481, 1998. 
3. Kirchner, M. and Bohme, R., “Hiding Traces of Resampling in Digital Images,” IEEE 
Transactions on Information Forensics and Security, vol. 3, no.4, pp.582-592, 2008. 
4. Zhicheng Ni, Shi, Y.Q., Ansari, N., Wei Su, Qibin Sun, and Xiao Lin, “Robust Lossless Image 
Data Hiding Designed for Semi-Fragile Image Authentication,” IEEE Transactions on Circuits 
and Systems for Video Technology, vol. 18, no. 4, pp. 497-509, 2008. 
5. H. I. Hahn and J. K. Joung, “Implementation of Algorithm to Decode Two dimensional Barcode 
PDF-417,” IEEE 6th International Conference on Signal Processing, 2002. 
6. Data matrix(computer),   http://en.wikipedia.org/wiki/Data_matrix_(computer). 
7. ISO/IEC 18004:2006, Information technology - Automatic Identification and Data Capture 
Techniques - QR Code 2005 bar code symbology specification, 2006. 
8. Denso-Wave, http://www.denso-wave.com/en/index.html. 
9. T. J. Soon., QR Code: The 2D Code of 21st Century and Its Applications. Automatic Data Capture 
Technical Committee, 2002. 
10. Bernard Sklar, Reed-Solomon codes, 
http://www.informit.com/content/images/art_sklar7_reed-solomon/elementLinks/art_sklar7_reed-
solomon.pdf. 
11. David Solomon, Coding for Data and Computer Communications, Springer Press, 2005. 
12. Irving S. Reed and Xuemin Chen, “Error-Control Coding for Data Networks,”  Kluwer 
Academic, 1999. 
13. 王新梅、肖國鎖，「糾錯碼」，儒林圖書公司， 1993 年。  
14. Thompson and Thomas M., "From Error Correcting Codes through Sphere Packings to Simple 
Groups", Carus Mathematical Monographs, Mathematical Association of America, 1983. 
15. Melissa Kanemasu, Golay Codes, 
http://www-math.mit.edu/phase2/UJM/vol1/MKANEM~1.PDF. 
16. 吳大鈞、洪自生， “QR 條碼之強韌性資料隱藏法， ” 第一屆海峽兩岸資訊安全研討會論文
集， pp. 21-27，杭州，中國， 2011。  
99 年度專題研究計畫研究成果彙整表 
計畫主持人：吳大鈞 計畫編號：99-2221-E-327-032- 
計畫名稱：在 QR 碼中隱藏資料之研究 
量化 
成果項目 實際已達成
數（被接受
或已發表）
預期總達成
數(含實際已
達成數) 
本計畫實
際貢獻百
分比 
單位 
備 註 （ 質 化 說
明：如數個計畫
共同成果、成果
列 為 該 期 刊 之
封 面 故 事 ...
等） 
期刊論文 0 0 100%  
研究報告/技術報告 0 0 100%  
研討會論文 0 0 100% 
篇 
 
論文著作 
專書 0 0 100%   
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 1 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國內 
參與計畫人力 
（本國籍） 
專任助理 0 0 100% 
人次 
 
期刊論文 0 1 100%  
研究報告/技術報告 0 0 100%  
研討會論文 1 0 100% 
篇 
 
論文著作 
專書 0 0 100% 章/本  
申請中件數 0 0 100%  專利 已獲得件數 0 0 100% 件  
件數 0 0 100% 件  
技術移轉 
權利金 0 0 100% 千元  
碩士生 0 0 100%  
博士生 0 0 100%  
博士後研究員 0 0 100%  
國外 
參與計畫人力 
（外國籍） 
專任助理 0 0 100% 
人次 
 
