 2
行政院國家科學委員會專題研究計劃成果報告 
總計畫：以 OMS 自動圖資系統提升配電系統分析、規劃與運轉策略效
能之研究 (2/3) 
子計畫七：考慮負載特性及可靠度成本之變電所容量擴充及饋線開關
位置最佳規劃之研究 (2/3) 
Expansion Planning of Substation Capacity and Optimal Feeder-Switch 
Placement by Considering Load Patterns and Reliability Cost (2/3)  
計畫編號：NSC 95-2221-E-244-021 
執行期限：95 年 8 月 1 日至 96 年 7 月 31 日 
主持人：莊慧仁    高苑科技大學電機系 副教授 
計畫參與人員：林家仲、陳世雄 
 
一、  中文摘要  
本子計畫第二年主要探討應用免疫演算法求
解配電系統最佳化配電變電所容量擴充模式之問
題。根據第一年之小區域最終目標年之飽和負載預
測結果，以重心法及負載點的等效負載損失分別推
導出目標年所有變電所供電區域及最佳裝設位
置。完成目標年變電所的供電範圍、位置及數量
後，根據各供電區域之逐年負載預測值，在滿足最
低成本目標函數及限制條件下，應用免疫演算法，
推導出逐年變電所最佳擴充模式。本子計畫以台電
北市區處轄區配電系統為模擬系統，以本方法求解
最佳配電變電所容量擴充模式，並與動態規劃法規
劃結果比較，使變電所之容量擴充，能滿足各負載
中心之用電成長外，亦能同時達成配電系統損失最
小化之目的。 
關鍵字：停限電圖資管理系統、小區域負載預測、
免疫演算法、動態規劃法。 
Abstract: This project has been presented a 
methodology to solve the substation capacity 
expansion problem by using the Immune Algorithm 
(IA). According to the small area load forecasting for 
the final target year, the center of gravity method is 
applied to find the geographic blocks of all 
substations and the corresponding service areas at the 
target year. The power loading of each small area is 
used to calculate the power loading loss of which 
service area to solve the optimal location within the 
block for each substation. The objective function 
which consists of the power loading loss and 
investment cost of transformer has been formulated. 
With the immune algorithm, the objective function 
and constraints are expressed as antigens, and all 
feasible solutions are expressed as antibody in the IA 
simulation process. After the computer simulation for 
capacity expansion planning of main transformers in 
substations is solved to find the optimal numbers, 
locations, and time that put into running of the 
substation for each year so as to achieve the minimum 
power demand loss and investment cost of 
transformer. The proposed method has been applied to 
a test system and the results are compared with the 
Dynamic Programming (DP). 
Keywords: Outage Management System, Small Area 
Load Forecasting, Immune Algorithm, Dynamic 
Programming. 
 
二、緣由與目的 
近年來隨著國民經濟的不斷發展，用電量快
速增加，在各大都會區的負載較集中，且負載密度
持續升高，同時市郊的鄉鎮負載也快速成長，促使
現有的配電變電所都已瀕臨運轉安全限制。在變電
所及變壓器供電吃緊的情況下，積極開發電源固然
重要，但如何對未來供電系統設備容量與架構作妥
善規劃亦極為關鍵。其中未來供電系統設備容量與
架構最佳化規劃，包括負載預測、變電所規劃等問
題，而變電所裝置位置及容量擴充則直接影響配電
系統網路架構的規劃，對配電系統網路的可靠性、
經濟性及供電品質有著直接影響。 
本子計畫在第一年完成以停限電管理系統
(Outage Management System, OMS)執行台電北市
區處轄區配電系統最終目標年小區域負載預測，在
負載預測方面，利用子計畫(一)的自動圖資系統
(Automated Mapping and Facility Management  
system, AM/FM)取得系統中關連式資料庫儲存的
配電元件所有屬性資料建立系統架構，及用戶資訊
系統(Customer Information System, CIS)中用戶耗
電基本資料，配合自動圖資系統具有地理圖資觀
念，由停限電管理系統中擷取規劃地區圍籬的地理
資訊參數，根據子計畫(三)負載調查抽樣用戶耗電
量資料，推導出預測小區域單元內各類型用戶之日
負載模型，利用各類型用戶之日負載模型及都市發
展計畫資料(容積率、建蔽率)中樓地板面積與地區
商 1(C1)、商 2(C2)及 6348 綜合的負載預測，其綜
合飽和負載量為 6656.9(kVA)。在規劃單元內各分
類負載的時間常數 值及起始時間tτ 0，以鳳山市重
劃區內各類型用戶負載成長S曲線為模型。執行小
區域負載預測，求出規劃單元每一年之負載預測
值，其結果如圖所示。 
0
5000
10000
15000
20000
1 3 5 7 9 11 13 15 17 19
年(year)
負載量(kVA)
住3
住3-1
住3-2
教學區
商1
商2
合計
 
 3
圖 3 圍籬編號 6348 負載預測 
圖 4 為逐年預測負載量。圖中根據起始年歷史
數據和目標年最終飽和負載，選擇 S 曲線模型，回
推小區域規劃年的各類型用戶負載量，再將各個小
區域規劃年的負載量累加求得規劃地區規劃年總
負載量，圖中逐年預測負載量由起始年為 19MVA
逐漸增加至目標年為 1894MVA。 
 
圖 4 逐年預測負載量 
 
3.2 規劃區域變電所供電範圍及位置 
    在完成負載預測後，根據 OMS 自動圖資系統
所擷取之規劃地區各小區域圍籬範圍，建立其地理
參數資料庫，利用地理參數資料庫配合目標年之負
載量，規劃該地區之變電所的供電範圍、位置及數
量。本子計畫提出以重心法推導變電所的供電範
圍，在供電範圍確定下，將供電範圍內負載點當成
變電所預設位置，配合推導出的等效負載損失公
式，可求得供電範圍內變電所最佳裝設位置。在變
電所的供電範圍、位置及數量確定下，即可定義等
效負載損失成本及變電所容量投資成本，並完成目
標函數最小化之變電所規劃模式。 
3.2.1 重心法 
    本子計畫應用物理重心法模式，以負載點的大
小(kVA)代替了物體的重量，首先於地圖上建立座
標點，目的在於確定各點的相對距離，根據座標中
各點的負載量，求出供電範圍內，所有負載點之等
效負載中心。若供電範圍內有n個負載點，其圍籬
編組為L1、L2 …、Ln，其視在功率分別為S1、S2 …、
Sn，地理中心座標分別為(x1,y1)、(x2,y2) …、(xn,yn)，
則等效負載的重心點為Z，其對應的座標(uz,vz)如式
(1)及(2)所示。 
n
i i
i = 1
z n
i
i = 1
x S
u =
S
×∑
∑
 (1) 
n
i i
i = 1
z n
i
i = 1
y S
v =
S
×∑
∑
 (2) 
其中 為重心點 X 座標， 為重心點 Y 座標，
為第 i個負載點 X座標， iy 第 i個負載點 Y座標，
iS 為第 i 個負載點之負載量。 
zu zv ix
為
 
3.2.2 規劃區域變電所供電範圍 
    完成規劃區域各供電單元之目標年負載預測
後，利用重心法推導出規劃區域變電所供電範圍，
本子計畫以台電標準配電變電所(2×60MVA主變壓
器)為規劃變電所之容量基準。首先找出規劃區域
重心位置，以離重心最遠的位置當成起始點，將周
圍的負載點相加至變電所利用率 70%±10%範圍
內，若未達變電所利用率 70%-10%，則需與周圍的
負載點相加；反之，若超過變電所利用率
70%+10%，則停止與周圍的負載點相加，其所選取
的負載點，即可當成一個新建變電所的供電範圍，
再將選取的負載點，從規劃區域上移除，繼續重複
上述過程，直到規劃區域上所有負載點全部選取。 
 
3.2.3 規劃區域變電所位置之決定 
變電所供電範圍選定之後，利用等效負載損失
推導出變電所的裝置位置。首先決定供電範圍內的
負載點數量，並將供電範圍內所有的圍籬編號，當
成變電所預設位置 i，應用(3)式分別計算變電所預
設位置的等效負載損失，其最小之等效負載損失，
即可視為該供電範圍之裝置變電所最佳位置，其公
式如下所示。 
∑
=
−+−×××××=
n
1j
2
1
2
ji
2
ji
2
j
j
i,loss ])yv(5.0)xu(8.0[r)V3pf
S
(3C
 (3) 
其中 n 為變電所供電範圍內負載點的數量；i 為變
電所供電範圍內所有的圍籬編號；pf 為第 j 個負載
點的功率因數； 及 分別為第 j 個負載點的視在
功率及電壓；r 為輸電線電阻； 為第 i 個變電
所預設位置的座標， 為第 j 個負載點的座標。
另外，由於本子計畫之圍籬單元面積為 800×500 平
方公尺的負載區域，因此 x 軸上的單位距離為 0.8
jS jV
)v,u( ii
)y,x( jj
3.5 免疫演算法 
免疫演算法基本上是藉由人體免疫系統的特
性，利用抗體及抗原之間一連串的複製、交配
(Crossover)及突變 (Mutation)等來求解最佳化問
題，此法具備辨識及記憶的特質是不同於一般遺傳
演算法則。免疫系統的觀念可以運用在解決系統最
佳化的問題上，入侵抗原代表找尋最佳化問題的系
統，相當於目標函數，而抗體相當於在系統中尋求
最佳可能性的解，當抗體消滅抗原就如同解決最佳
化問題，但在搜尋最佳化解的過程中，將會發生許
多無法滿足限制條件的不可行解，這些不可行解將
造成系統錯誤執行或無法執行。利用免疫演算法的
觀念在搜尋最佳化問題上，可以降低搜尋不可行解
的機率，縮小求解空間。免疫系統中的記憶性功能
更可以降低搜尋最佳解的時間，一方面以此解為暫
定的最佳解，另一方面利用此暫定的最佳解在去求
解空間中找尋是否有更佳解。 
免疫演算法的抗體結構和遺傳演算法的編碼
方式相同，在決定最佳規劃模式之前，首先要定義
雜異度和相似度，如下圖 6 所示，N 個抗體內有 y
個基因數，每一個基因代表一規劃年，Sub(y)為在
第 y 年可能移除之變電所編號，N 為抗體的總數，
代表每個世代中，可行的變電所規劃模式
(Candidates of substation plan)。 
 
圖 6 抗體資料結構 
◎雜異度 
為了降低陷入局部最優解的可能性，及增加記
憶單元之抗體族群的雜異度，首先必須計算出在記
憶單元中之舊世代抗體與新世代抗體之間的雜異
程度。如圖 6 所示，在抗體中第 t 個(t=1,2,…,y)基
因的相似程度被定義如下: 
∑
=
−=
N
1i
ititt logPP(N)E
 (10) 
其中N為抗體數，Pit為所有抗體族群中第i抗體
出現其第t個基因相同的機率。假如所有抗體中的
第t個基因均相同，則Et(N)為零。所以有y個基因的
抗體相似度可定義如方程式(11)所示。 
∑
=
=
y
1t
t (N)Ey
1E(N)  (11) 
◎相似度 
相似度也是在免疫演算過程中一個重
要的定義，在複製比對的過程中，若有相
類似的抗體族群，將會影響整體規劃模式
的效率，首先要考慮的是抗體與抗體之間
的相似度，定義如下：  
 
b ij
1(A )
1 E(2)
= +
 (12) 
E(2)表示僅考慮 i、 j兩抗體，也就是新
世代抗體及記憶單元內的抗體，假如 i和 j
兩抗體族群內的基因皆相同，則 E(2)為
零，所以 (Ab) i j為兩抗體 i及 j的相似度，其
值介於 1 和 0 之間，另一個需要考慮的為
抗體 (可行之變電所規劃模式 )及抗原 (目標
函數 )之間的相似程度，定義如下：  
 
g j
j
1(A ) =
1+ OPT
 (13) 
此處OPTj為方程式(4)所定義的等效負載損失
成本，此方程式可求得抗體i與抗原之間的相似
度。當 =1 時(即OPT
jg )A( j=0)，表示抗體能完全消滅
抗原，在求解空間中取得最佳可行解。 
變電所規劃模式首先要決定目標函數，也就是
訂出最佳化的決策條件，利用免疫演算法抗體與抗
原之間的交互作用，決定可行的變電所規劃模式和
目標函數間的關係，經過計算及基因演化過程，將
適合度高的可行變電所規劃模式放入記憶單元，然
後產生新一代的可行變電所規劃模式繼續循環下
去，直到收斂為止。 
執行步驟大約可分成六個步驟，如下所述： 
步驟一：辨認抗原 
訂定目標函數，也就是訂定變電所等效負載損
失成本，並輸入系統執行上之限制條件，包含收斂
次數等等，避免系統求得不可行解，在基因編碼上
採取以變電所編號編碼，可加強這些基因和實際物
理系統之目標函數之間的關聯性。 
步驟二：產生初始抗體族群： 
而抗體庫(Antibody pool)是由這些抗體族群所
構成，而抗體是由基因所組成，當產生新世代抗體
族群後，一部份的抗體族群來自適合度(Fitness)較
高記憶單元。在搜尋過程中，抗體為變電所規劃模
式之可行解，而基因代表可能被移除之變電所編
號。 
步驟三：計算適合度 
根據方程式(12)和(13)分別計算出抗體 i 和 j 之
間的相似度 b ij(A )  及抗原和抗體 j 之間的相似度
，此結果將提供後續步驟決策分析之依據。 jg )A(
步驟四：控制抗體製造 
尋找最佳可行解在於利用免疫法則，保留後代
優良抗體族群，所以根據步驟三計算出的結果，淘
汰適合度低的抗體，將適合度較高的抗體放入記憶
單元，依此循環，找出最佳的基因排列。因此新世
代抗體族群之平均適合度會大於舊世代之平均適
合度。 
 5
了於第 11 年、第 17 年及第 19 年沒有變電所投入
外，在第 3 年及第 4 年有 2 座變電所投入，第 5 年
及第 6 年有 3 座變電所投入，其他的年度均有 1 座
變電所投入。但同一年度由於兩種方法所求解變電
所的投入位置不同，即是同一供電區域變電所的擴
充年度及順序不同，如圖 8 及圖 9 中變電所的裝置
位置 6746，其於免疫演算法求解的擴充年度為第 6
年及順序為第 10 台投入；另外動態規劃法求解的
擴充年度為第 15 年及順序為第 20 台投入，因此兩
種方法求解的等效總成本不同。本子計畫所提出之
免疫演算法比動態規劃法所得之結果較佳，主要原
因為動態規劃於第六年才逐步向外擴充，而免疫演
算法則於第三年便向外擴充，可避免偏遠地區供電
上所造成的損失，能有效降低等效負載損失成本。 
 
圖9應用動態規劃法於北市區處變電所之擴充規劃 
 
表 1 為等效總成本及執行時間。表中使用免疫
演算法和動態規劃法的等效總成本分別為 2724.9
百萬元及 2777.8 百萬元，在程式執行時間則分別為
51 秒及 131 秒。由上述結果得知，由於動態規劃法
求解過程不昜找到最佳解，而免疫演算法不僅具備
求解最佳可行解的能力，它也比動態規劃法執行更
為快速。 
 7
 
表 1 總等效負載損失成本及執行時間 
規劃方法 
目標年
變電所
數量 
目標年變
電所容量
(MVA) 
等效總
成本 
(百萬元) 
程式執
行時間
(秒) 
免疫演算
法 23 2760 2724.9 51 
動態規劃
法 23 2760 2777.8 131 
 
圖 10 為逐年變電所擴充容量。圖中逐年預測
負載量由起始年為 19MVA 逐漸增加至目標年為
1894MVA，所規劃變電所容量應隨著逐年負載量而
增加，最終年變電所設置之容量為 2760MVA，在
第 11 年、第 17 年及第 19 年沒有變電所投入，其
設計原則為加強供電可靠性及維持緊急時之轉供
能力，在變電所利用率 70%時，即應檢討擴充。圖
中逐年之負載率，其中前三年為負載成長之初始階
段，因此負載率皆小於 60(%)，其餘各年的負載率
皆可達到 70(%)，由起始年至目標年的變電所平均
負載率為 63.14(%)。 
 
圖 10 逐年變電所擴充容量 
由本子計畫最終飽和負載預測結果，可得預測
之最終總負載為 1894MVA，共需 23 座變電所，
60MVA 主變壓器 46 台。北市區處 89 年既設變電
所配置模式方面，首先根據負載特性調查研究所推
導之 89 年北市區處標準日負載模型[16]，可得尖峰
負載為 1901.8MVA，與本子計畫最終飽和負載預測
結果相近。在變電所總容量規劃方面，本子計畫變
電所總容量規劃為 2760 MVA ，台北市區處 89 年
既設變電所總容量為 3165MVA，其設置變電所數
量、主變壓器容量，如表 2 所示。 
 
表 2 本法規劃模式與既設變電所配置模式之比較 
項目 變電所最終規劃模式 
既設變電所
配置模式 
尖峰負載(MVA) 1894 1901.8 
變電所數量 23 27 
變電所容量 2760 3165 
20MVA 變壓器數量 ---- 1 
25MVA 變壓器數量 ---- 31 
30MVA 變壓器數量 ---- 3 
60MVA 變壓器數量 46 38 
變壓器總數量 46 73 
 
四、結論與討論 
本子計畫以停限電圖資管理系統為基礎，定義
目標函數為等效負載損失成本及變電所容量成
本，應用免疫演算法求解配電系統最佳之配電變電
所投入容量、位置及時間，達到最具投資成本效益
之配電系統規劃模式。主要研究內容可分成兩步
驟，第一為變電所的供電範圍、位置及數量之決
定。第二為最佳變電所之規劃模式。首先根據第一
年完成之小區域最終目標年之飽和負載量，以重心
法及負載點的等效負載損失分別推導出目標年所
有變電所供電區域及最佳裝設位置。由於裝置變電
所之投入容量、位置及時間規劃是非線性最佳化問
題，求解目標函數之合適解，因此本方法以抗原(目
標函數)與抗體(變電所規劃模式)之相似度，此相似
表 Y04 
行政院國家科學委員會補助國內專家學者出席國際學術會議報告 
                                                            95 年 11 月 05 日 
報告人姓名    莊慧仁 
 
服務機構
及職稱 
 
  高苑科技大學電機系副教授 
 
     時間 
會議 
     地點 
  95.10.23~95.10.26 
  中國 重慶 
本會核定
補助文號
 
 NSC 95-2213-E-244-021 
會議 
名稱 
 (中文) 國際電機電子-電力工程學會/2006 年電力系統技術國際研討會 
 (英文)  IEEE-PES/2006 International Conference on Power System 
Technology 
發表 
論文 
題目 
 (中文) 捷運系統最佳牽引動力變電站規劃 
 (英文)  Optimal Expansion Planning of Traction Substations for an 
Electrified Mass Rapid Transit System 
發表 
論文 
題目 
 (中文)台北捷運路網之電力系統操作提升 
 (英文)  Enhancement of Power System Operation for Taipei MRT Network 
2006 年國際電機電子/電力工程學會電力系統技術國際研討會在中國大陸重慶舉辦，本
人參加本研討會討論之要點如下：  
一、參加會議經過 
 
10 月 23 日至重慶金源大飯店 3 樓會場報到，並在下午 2:00 至 5:30 發表 1 篇論文，
Optimal Expansion Planning of Traction Substations for an Electrified Mass 
Rapid Transit System，如圖 1 所示。 
10 月 24 日在上午 9:00 至 12:30 發表 1 篇論文，Enhancement of Power System 
Operation for Taipei MRT Network，如圖 2 所示。 
10 月 25~26 日在重慶金源大飯店 3 樓會場參加電力系統相關論文的研討。 
10 月 28 日返國。 
 
圖 1. 
 
附件
 
Optimal Expansion Planning of Traction Substations 
for an Electrified Mass Rapid Transit System 
Hui-Jen Chuang, Chao-Shun Chen, Chia- Hung Lin, Jun-Yu Chen and Chin-Yin Ho 
 
Abstract-- This paper is to investigate the proper expansion 
planning of traction substations (TSS) for an electrified mass 
rapid transit (MRT) system. The motion equation of train sets is 
used to solve the mechanical power consumption at each time 
snapshot according to the operation timetable, the passenger 
ridership and various types of operation resistance. The 
mathematical models of power converters in traction substations 
for different operation modes have been derived. With all train 
sets operated along the main line, the AC/DC load flow analysis is 
performed to find power demand of all traction substations for 
annual system peak operation over the study period. The 
objective function is formulated by considering both the voltage 
drop of train sets and investment cost of traction substations as 
the equivalent cost of all feasible states of each year. By 
performing the dynamic programming (DP) to minimize the 
objection function, the expansion planning of traction substations 
to achieve the minimum overall cost has been obtained by 
identifying the optimal capacity and locations of new traction 
substations to be committed at each year. 
 
Index Terms-- AC/DC Load Flow, Mass Rapid Transit (MRT), 
Dynamic Programming (DP), Traction Substation (TSS), 12 
Pulse Uncontrolled Rectifier 
I.  INTRODUCTION 
o solve the problems of traffic jam, air pollution, etc., in 
Kaohsiung metropolitan area, a Mass Rapid Transit 
System (KMRT) has been designed and constructed to 
provide an efficient transportation system with short headway, 
high ridership and less electric propulsion energy 
consumption. To maintain the high service reliability, the 
traction power network of MRT systems is always designed 
with fully backup capability to prevent the electricity outage 
due to the failure of any network component. It is the 
conventional practice to plan and install the traction 
substations (TSS) at the beginning with the capacity to cover 
the peak power loading of whole MRT system for the target 
year, which is maybe 30 years later. With relatively low 
ridership during the initial operation years of an MRT system 
and then gradually increased to the full operation capacity in 
the target year, the traction substations are lightly loaded over 
the life cycle. 
                                                          
H.-J. Chuang and C.-Y. Ho are with the Department of Electrical 
Engineering, Kao Yuan University, Lu Chu, Taiwan 
C. S. Chen and J.-Y. Chen are with the Department of Electrical 
Engineering, National Sun Yat-Sen University, Kaohsiung, Taiwan  
C. H. Lin is with the Department of Electrical Engineering, National 
Kaohsiung University of Applied Sciences, Kaohsiung 807, Taiwan  
 
 
For a typical MRT system, the electricity charge by utilities 
may contribute more than 20% of the total operation cost [1]. 
The enhancement of power system operation efficiency has 
become an important issue for the design of an MRT project. 
To improve the cost effectiveness of traction substations, the 
capacity expansion of traction substations has to be 
incorporated with the growth of ridership while subjects to 
meet the service reliability and performance index. Because 
the power demand of MRT propulsion system is increased 
with the growth of annual ridership, the expansion planning of 
traction substations is simulated as a dynamic programming 
(DP) problem [2] in this paper. The train performance 
simulation is executed to find the power demand and the 
location of each train set on the main line according to the 
mechanical traction power required to meet the timetable of 
train operation with various loading factors between stations. 
Each train set is then represented as a load bus and the DC 
network is updated according to the train locations at each 
time snapshot. To ensure the power service reliability, the 
system voltage profile and power demand of all traction 
substations are derived by AC/DC load flow analysis [3-6] for 
the N-1 reliability criterion.  The unit commitment of traction 
substations is then determined to achieve the minimization of 
the investment cost of traction substations without violating 
the voltage drop of train sets and rated capacity of TSS for the 
study years. The flowchart of proper expansion planning of 
traction substations is illustrated in Fig. 1. 
II.  SYSTEM DESCRIPTION  
In this paper, the voltage profile of an MRT system and the 
power demand of all train sets are simulated to solve the 
proper expansion planning of traction substations. With the 
annual growth of passengers, the headways of train operation 
are reduced accordingly to comply with the service 
performance index. The optimal capacity and locations of new 
traction substations to be committed to meet the system 
operation for each year are determined to achieve the best cost 
effectiveness of traction substation expansion. To solve the 
voltage levels of train sets to check the voltage limit violation 
and to calculate the power demand of all traction substations 
accurately, the mathematical modeling of traction substations, 
train borne converters with variable voltage and variable 
frequency (VVVF) controllers and induction motors are 
included in the simulation of load flow analysis. 
T
 1
2006 International Conference on Power System Technology
1-4244-0111-9/06/$20.00©2006 IEEE.
⎪⎪⎭
⎪⎪⎬
⎫
⎪⎪⎩
⎪⎪⎨
⎧
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π+α−⎟⎠
⎞⎜⎝
⎛ π−μ+α++
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π−μ+α−⎟⎠
⎞⎜⎝
⎛ π+α+
π=
12
sin
12
sin
4
)33(
6
sin
6
sin
7
)323(2
V36
E
00
00
s
dr
 (1) 
( ) ⎪⎪
⎪⎪
⎪⎪
⎪
⎭
⎪⎪
⎪⎪
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪⎪
⎪⎪
⎪
⎩
⎪⎪
⎪⎪
⎪⎪
⎪
⎨
⎧
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π+α−μ+α+−
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π−α−⎟⎠
⎞⎜⎝
⎛ π−μ+α+
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π−μ+α−α+
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π−μ+α−⎟⎠
⎞⎜⎝
⎛ π+α−
⎥⎦
⎤⎢⎣
⎡ ⎟⎠
⎞⎜⎝
⎛ π+α−⎟⎠
⎞⎜⎝
⎛ π+μ+α−⎥⎦
⎤⎢⎣
⎡ α−⎟⎠
⎞⎜⎝
⎛ π−μ+α
=
6
sinsin
6
)35(
6
sin
3
sin
6
7
3
sinsin2
6
sin
6
sin3
3
sin
6
sinsin
6
sin
X
V6
I
00
00
00
00
0000
C
s
dr
 (2) 
The real power and reactive power at the ac side of the 
rectifier is derived as equation (3), (4). 
( ) ( )
( ) ( ) ( )
( ) ( ) ⎪⎪
⎪
⎭
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
+μΦ⎟⎠
⎞⎜⎝
⎛ π−μ+α+μΦ⎟⎠
⎞⎜⎝
⎛ π+μ+α+
μΦ⎟⎠
⎞⎜⎝
⎛ π−μ+α+μΦμ+α+
μΦ⎟⎠
⎞⎜⎝
⎛ π−μ+μΦ⎟⎠
⎞⎜⎝
⎛ π−μ
π=
9731.0
6
sin
6
sin
3
sinsin
3
sin
6
sin
X
V312
P
560550
540530
5251
C
2
s
r
 (3) 
( ) ( )
( ) ( ) ( )
( ) ( )
( ) ( ) ⎪⎪
⎪⎪
⎪
⎭
⎪⎪
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪⎪
⎪
⎩
⎪⎪
⎪⎪
⎪
⎨
⎧
⎟⎠
⎞⎜⎝
⎛ μ−π+⎟⎠
⎞⎜⎝
⎛ π−μ+
μΨ⎟⎠
⎞⎜⎝
⎛ π−μ+α−μΨ⎟⎠
⎞⎜⎝
⎛ π+μ+α−
μΨ⎟⎠
⎞⎜⎝
⎛ π−μ+α−μΨμ+α−
μΨ⎟⎠
⎞⎜⎝
⎛ π−μ−μΨ⎟⎠
⎞⎜⎝
⎛ π−μ−
π=
43745.0
3
92405.0
6
6
sin
6
sin
3
sinsin
3
sin
6
sin
X
V312
Q
560550
540530
5251
C
2
s
r
 (4) 
Here, μ  is the interphase commutation angle and 1α is the 
postignition angle. 
D.  Train control 
To achieve high transportation capability of MRT systems 
with rather short distance between stations, the train sets are 
operated with quick acceleration for start up propulsion and 
fast deceleration for braking stop. The automatic train 
operation (ATO) system is applied to control the magnitude 
and frequency of service voltage for induction machines so 
that proper propulsion traction effort can be provided and the 
time table of train operation can be maintained. For KMRT 
system, the operation modes of PWM, Quasi-Six steps and six 
steps are used to generate the trigger signal for the inverters 
for the speed range of 0-22 km/hr, 22-40 km/hr and 40-80 
km/hr respectively [8]. When the train set leaves the station 
for acceleration, the constant torque mode of the propulsion 
system is applied for the train speed from 0 to 40 km/hr in 
Fig.4. After the train set has been accelerated with speed over 
40 km/hr, the inverter supplies the induction motors with 
constant voltage for the operation modes of constant power 
and constant slip. To provide the same traction effort for the 
acceleration required, the boundary speed between different 
operation modes is adjusted with the third rail voltage 
according to the relationship of traction effort and speed at 
different voltage level [4]. When the train set approaches the 
next station for stop, the constant power regeneration mode is 
used for the speed above 56 km/hr. By this way, the induction 
motors can be prevented from over loading and sufficient 
braking effort can be obtained by adjusting the mechanical 
braking power. Once the speed has been reduced below 56 
km/hr, the constant torque mode of inductor motors is applied 
to achieve full electric braking. When the speed has been 
reduce to be less than 5 km/hr, the electric brake is cut off and 
the mechanical braking is applied for the final stage of train 
stop. 
 
Fig. 4 Traction effort, voltage, and speed control of induction motors. 
E.  Propulsion power consumption of MRT train sets  
To solve the power consumption of train sets along the 
main line by performing the train performance simulation, the 
time table and speed profile of train operation between two 
substations is used to define the acceleration, coasting, 
deceleration and dwelling for each time snapshot of train 
operation. According to the ridership and traction 
characteristics of propulsion system, the power consumption 
and braking regeneration at each time snapshot is then derived 
by considering the motion equation of the train set in equation 
(5) [9]. 
FA =Me*a + R (5) 
Where FA, Me, a and R represent the traction effort, train 
mass, desired acceleration and operation resistance 
respectively. Fig. 5 shows the power and speed profile of a 
train set operated between two stations. At first, the train set 
starts up and the power consumption is increased during the 
acceleration stage. After train speed has reached the specified 
value after start up acceleration, the coasting mode is used to 
achieve operation efficiency by turning off the motoring 
power. With the braking regeneration, the kinetic energy has 
been converted to electricity energy by induction generation 
when the train set approaches the next station to make the stop. 
 
Fig. 5 Power consumption and speed profiles of a train set with regeneration 
braking. 
 3
A. Objective function 
To determine the proper expansion planning of traction 
substations for an MRT system, the objective function is 
formulated by including the cost of traction substation 
investment and voltage drop of train sets. 
1. Energy consumption cost 
he annual total energy loss of each feasible state can be solved 
by AC/DC load flow analysis according to the total power 
demand of whole MRT network. For instance, the state with j 
units of traction transformers at year t is calculated as 
opopopppp
j
t )hw(WNH)hw(EL)hw(WNH)hw(ELCEL ××+××=  (12) 
, where hw, EL(hw)p, NH p and W(hw)p represent the headway, 
total energy loss, total peak hours and energy charge rate 
respectively for peak period. EL(hw) op, NHop and W(hw)op 
are the total energy loss, total off peak hours and energy 
charge rate respectively for off peak period. 
2. Capital investment cost 
To simplify the capacity planning of traction substations, 
the expected life cycles of transformers and auxiliary 
equipments such as breaker, protection relays, etc. are 
considered. The annual operation and maintenance cost of 
traction transformers has been converted as the present value 
and incorporated with the procurement cost I to form the 
equivalent investment cost of traction transformers and 
auxiliary facility. The procurement cost of the 3-MVA traction 
transformers is then linearly depreciated over the lifetime of 
30 years [11]. The capital investment cost of state with j units 
of traction transformers for year t is expressed as 
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
≠
=×−×
=×
=
kt,0
kt,j)k30(
30
I
1t,7I
CINVjt
 (13) 
The investment cost of traction substations with the energy 
loss cost are considered in the objective function by assuming 
flat inflation rate and interest rate over the study years. The 
equivalent present worth of the investment cost of traction 
substations is written 
t
t
j
t
30
0t
j
t )i1(
)e1()CINVCEL(CP +
+×+= ∑
=
 (14) 
, where i and e represent the inflation and interest rate 
respectively. 
3. Voltage drop cost 
With the outage of traction substations, the third rail 
voltage may drop to be less than 630V and the train set has to 
be operated with reduced performance to prevent the overload 
of traction substations. To ensure the power service reliability 
for the source outage of traction substations, the optimal 
capacity and locations of new traction substations to be 
committed at each year are determined to prevent the voltage 
drop violating of train sets. The AC/DC load flow analysis has 
been executed to solve the voltage drop of train sets according 
to the power demand of all train sets at each time snapshot. In 
this paper, the equivalent voltage drop of train sets cost CV is 
expressed as equation (15). 
⎪⎪
⎪
⎭
⎪⎪
⎪
⎬
⎫
⎪⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
<∞
≤<
−−×
≥
=
                        600Vfor                                         
630 V600for       )
01.0
8.0
750
V750K
(
630Vfor                                         0
C
3rd
3rd
6
3rd
3rd
V
 (15) 
where K and 750 represent are the constant coefficient and the 
rated of third rail voltage. V3rd represent the minimum third 
rail voltage for year t. 
IV.  OPTIMAL EXPANSION PLANNING OF TRACTION SUBSTATION 
CAPACITY  
With the ridership forecast and operation timetable of the 
MRT network, the annual peak power demand for train set 
propulsion and system voltage drop are derived by executing 
load flow analysis. The backward dynamic programming is 
then used to solve the optimal unit commitment strategy of 
traction substations. To maintain the service reliability, the 
proper capacity reserve of traction substations is included in 
the computer simulation so that the performance level of all 
train sets will not be derated with the outage of any one TSS. 
After executing the dynamic programming, the proper 
expansion planning of traction substations for KMRT has 
been solved as shown in Fig. 8. It is found that the system 
peak power demand is increased with the annual growth of 
passenger ridership. To cover the peak propulsion traction 
power demand of MRT operation for each study year, the 
traction substations have to be committed at O11, O4, O13, 
O6, O8 and O9 for year 2012, 2014, 2018, 2023, 2027 and 
2034 respectively. 
 
Fig. 8 Expansion planning of traction substations with system peak power 
demand. 
As described previously, the equivalent present worth of 
investment cost of traction substations can be derived by 
taking into account the inflation rate of 3% and interest rate of 
5% respectively. The annual equivalent cost of proper 
expansion planning of traction substations can be determined 
and converted to the corresponding present value in Fig. 9. It 
is found that significant cost reduction can be obtained by the 
proposed expansion planning of traction substations as 
compared to the original design of KMRT project. Over the 
total study period, the equivalent present worth of investment 
cost of traction substations has been reduced from $28M to 
$20.5M.  
 5
[4] C. S. Chen, H. J. Chuang, and L. J. Fan, “Unit Commitment of Main 
Transformers for Electrified Mass Rapid Transit Systems,” IEEE 
Transactions on Power Delivery, vol. 17, no. 3, pp. 747-753, July 2002. 
[5] H. C. J. Cornel and V. I. John, “QENS-An Enhanced Version of the 
Electric Network Simulator Program,” IEEE Transactions on Vehicular 
Technology, vol. 40, no. 1, pp. 273-279, February 1991. 
[6] C. S. Chang, J. S. Low, and D. Srinivasan, “Application of Tabu Search 
in Optimal System Design and Operation of MRT Power Supply 
Systems,” IEE Proceedings-Electric Power Applications, vol. 146, no. 1, 
pp. 75-80, January 1999. 
[7] C. S. Chen, H. J. Chuang, and H. M. Shiau, “Stochastic Harmonic 
Analysis of Mass Rapid Transit Power Systems With Uncontrolled 
Rectifiers,” IEE Proceedings-Generation Transmission Distribution, vol. 
150, no. 2, pp. 224-232, March 2003. 
[8] AEG Westinghouse Transportation Systems inc., “Power and Traction 
Subsystem Running Maintenance Manual,” Pittsburgh, July 1992. 
[9] Rail System Center of Carnegie-Mellon University, “User Manual for 
the Transportation System Energy Management Model (EMM),” 
Pittsburgh, July 1986. 
[10] James B. Flowers “Load Sharing With Thyristor Controlled Rectifier 
Substations,” Proceeding of the1995 IEEE/ASME Joint, pp. 69-73, April 
1995. 
[11] L. C. Leung and S. K. Khator, “Transformer procurement and relocation 
at a large electric utility: A mixed 0–1 linear programming model,” IEEE 
Trans. Power Syst., vol. 10, pp. 957–963, May 1995. 
VII.  BIOGRAPHIES 
H. J. Chuang received the B.S. and M.S. degree in Electrical Engineering 
from National Taiwan University of Science and Technology in 1990 and 
1992 respectively, and Ph. D. degree in Electrical Engineering from National 
Sun Yat-Sen University in 2002. He is presently an Associate Professor at 
Kao Yuan University, Lu Chu, Taiwan. His research interest is in the area of 
load flow and power system analysis of mass rapid system.  
 
C.S. Chen received the B.S. degree from National Taiwan University in 1976 
and the M.S, Ph.D. degree in Electrical Engineering from the University of 
Texas at Arlington in 1981 and 1984 respectively. From 1984 to 1994 he was 
a professor of Electrical Engineering department at National Sun Yat-Sen 
University. From 1989 to 1990, he was on sabbatical at Empros Systems 
International. Since Oct. 1994, he works as the deputy director general of 
Department of Kaohsiung Mass Rapid Transit. From Feb.1997 to July 1998, 
he was with the National Taiwan University of Science and Technology as a 
professor. From August 1998, he is with the National Sun Yat-Sen University 
as a full professor. His majors are computer control of power systems, 
electrical and mechanical system integration of mass rapid transit systems. 
 
C.H. Lin received the B.S. degree from National Taiwan Institute of 
Technology in 1991, M.S. degree from University of Pittsburgh in 1993, and 
Ph. D. degree in Electrical Engineering from University of Texas at Arlington 
in 1997. He is presently an Professor at National Kaohsiung University of 
Applied Sciences. His area of interest is distribution automation and computer 
applications to power systems. 
 
J.Y. Chen received the B.S. degree in National Kaohsiung University of 
Applied Sciences in 2002 and M.S. degree from National Sun Yat-Sen 
University in 2005. His research interest is in the area of mass rapid system. 
 
C.Y. Ho received the M.S. degree in mathematics from National Cheng Kung 
University in 1993. She has been a lecturer in Kao Yuan University. 
 7
 2
shown in Fig.1 to step down the voltage level of 161 kV from 
Taipower network to 22 kV for the traction and station power 
demand. In each BSS, the secondary sides of two traction 
transformers (TTR) with 25 MVA capacity each are tied 
together to serve the traction substations (TSS) along the main 
lines. The ring main units (RMU) are used so that the power 
supply to the TSS can be switched over to the neighboring 
BSS when the outage of the service BSS occurs. In the TSS, 
the 22 kV voltage is stepped down to 589V and 24 pulse 
rectifiers are used to convert the ac power supply to 750V dc 
power source for the train sets [7,8]. The dc output voltage of 
TSS is connected to the third rail by cable and will be 
collected by the train set when it moves along the main lines. 
 
Fig.1 Power system configuration of MRT networks. 
A. Train Control 
On the train set, the dc voltage is converted to three-phase 
ac power source by VVVF for the control of induction motors 
to generate the required traction effort at the specified speed. 
Fig.2 shows the control block diagram for the operation of 
VVVF inverter [9] is Taipei rolling stock. The speed code, 
which is picked up by the train borne antenna from the 
running rail, is used to calculate the corresponding 
acceleration and the required traction effort, Treq for the train 
set propulsion. By comparing the Treq to the actual torque 
output (Tout) generated based on the voltage, current and 
motor speed, the requested voltage and frequency are 
determined to perform the waveform synthesis to output the 
firing signal for the inverter. To achieve better operation 
performance of the train sets, the operation modes of pulse 
width modulation (PWM), quasi-six step and six step are 
applied for the VVVF inverters with the frequency ranges of 
0<f<35Hz, 35 f<67Hz and f 67Hz respectively. Fig.3 
shows the output traction effort of the induction motors at 
different speeds [9]. When a train set starts from the station in 
Region I, the constant torque is applied for the speed up to 
42km/h. In this region, the PWM is first used for the first 
portion and the quasi-six-step is used for the second portion of 
the speed range. The applied voltage level is increased linearly 
with the train speed to keep the air gap flux constant. The 
application of quasi-six-step is to achieve the smooth 
transition during the train acceleration stage. When the train 
speed reaches 42km/h, the six-step is applied for the operation 
of constant power in region II and constant slip frequency in 
region III. For these operation regions, the reduced flux is 
used to provide constant voltage to the induction motors. In 
region II, the traction effort is reduced linearly with the 
increase of the train speed. In region III, the traction torque is 
reduced with the square of the induction motor slip. 
≤ ≥
 
Fig.2 VVVF control block diagram. 
 
Fig.3 Traction effort, braking effort, and speed control of induction motors. 
 
Because the distance between two stations is always very 
short for MRT lines, the train set has to be operated with high 
acceleration when it leaves the train station and high 
deceleration is applied when it approaches the next station. A 
lot of energy will be wasted with the frequent by train braking 
and large air conditioner loading will be required for the 
cooling of train stations. To solve the problem, the electric 
braking is applied to restore the kinetic energy when the train 
sets decelerate for stop. The energy regeneration is obtained 
by controlling the frequency of the inverter output voltage to 
be less than the rotor speed so that the propulsion induction 
motors become induction generators. With the negative slip, 
the train kinetic energy is converted to the regeneration power, 
which will be fed back to the dc circuit to provide the power 
supply for another train set with acceleration operation mode. 
B. Power Consumption of MRT Train Sets 
When the train set starts from the station, the operation 
modes of constant torque and constant power are applied for 
the train acceleration until the specified speed has been 
reached. During this operation stage, the induction motors are 
driven by the VVVF inverter to generate the propulsion torque. 
The power demand of the train set is varied from time to time 
according to the operating speed and traction effort required. 
The coasting operation mode is then applied by disabling the 
 2
 4
 
Fig.6 Power consumption of Tamshui line during off peak operation by 
computer simulation. 
 
To solve the load transfer among the main transformers of 
Taipei MRT lines for the target year, the power consumption 
of each BSS has been derived. For the computer simulation, 
the train sets are operated with 100% loading factor and the 
headway is 2 minutes during peak period and the loading 
factor is 40% and the headway is 6 minutes for the off peak 
operation. The loading factor of a train set for Taipei MRT 
system is defined as 100% when it carries 2000 passengers. 
Fig.7 shows the voltage variation of 22 kV buses. The largest 
voltage drop is found to be 4.26%, which is within the 5% 
constraint.  
 
Fig.7 The largest voltage drop of all 22KV buses for the peak operation. 
 
 
Fig.8 Power demand simulation of Tamshui line druing peak and off peak 
operation for the target year. 
 
Fig.8 shows the power demand of Tamshui Line for the 
target year over 10 minutes interval both peak and off peak 
operation and Table 1 shows the power demand with the 
corresponding loading factors of all BSS. The total power 
demands of all BSS to serve the whole Taipei MRT network 
are solved to be 255.5 MVA and 100.5 MVA during the peak 
and off peak operation respectively. 
 
IV. LOAD TRANSFER OF MAIN TRANSFORMERS 
To improve the operation efficiency of MRT power 
systems, the unit commitment of main transformers has to be 
performed to provide sufficient capacity to meet the loading 
demand and maintain service reliability for system peak and 
off peak operation respectively. After that, the load transfer 
among the main transformers has to be executed to achieve 
the loading balance and minimization of transformer losses. 
Fig.9 illustrates the design of main transformer operation for 
an MRT network. To demonstrate the effectiveness of the 
proposed methodology, the power system of Taipei MRT 
network assumed in Fig.10 is selected for computer simulation. 
12 bulk substations (BSS) have been installed to import the 
power from utility company for the 56 traction substations and 
stations of all MRT lines. The ring main units (RMU) are 
applied to provide the open/close control of line switches for 
the load transfer between two BSS. In this paper, the power 
network to serve the MRT system is reconfigured by 
identifying the proper switch operations so that the total 
system power demand can be reallocated among the main 
transformers. Notation (X,Y) is often used to represent the 
operation of opening switch X and closing switching Y. For 
any switching operation to be performed the radial 
configuration of power system has to be maintained to prevent 
the circulation current of main transformers. 
 
 
Fig.9 Unit commitment and load transfer of MRT main transformer 
 4
 6
operation. 
 
Fig.11 Power loss of all main transformers for the peak operation of Taipei 
MRT network. 
 
Table 1 Average loading level and loading factors of Taipei MRT main 
transformers. (original configuration) 
 Peak operation Off peak operation 
BSS Loading 
(MVA) 
LF* BSS Loading 
(MVA) 
TJ 26.6 0.532 9.37 0.187 
HUJ 18.92 0.378 5.83 0.117 
HJ 22.45 0.449 8.74 0.175 
YJ 24.93 0.499 16.07 0.321 
SFJ 24.71 0.494 11.71 0.234 
TUJ 22.64 0.453 10.77 0.215 
SC 15.75 0.315 10.39 0.208 
MT 16.25 0.325 6.01 0.120 
SJ 14.61 0.292 5.44 0.109 
LC 11.48 0.230 6.26 0.125 
SS 16.25 0.325 5.83 0.120 
HY 10.94 0.219 4.12 0.082 
TOTAL 255.53  100.54  
LF*: loading factor (Loading/50) 
 
Table 2 Average loading level and loading factors of Taipei MRT main 
transformers. (after load transfer) 
 Peak operation Off peak operation 
BSS Loading 
(MVA) 
LF* BSS Loading 
(MVA) 
TJ 26.6 0.532 7.1 0.284 
HUJ 18.92 0.378 8.1 0.324 
HJ 22.45 0.449 8.74 0.349 
YJ 24.93 0.499 11.7 0.468 
SFJ 24.71 0.494 8.93 0.357 
TUJ 22.64 0.453 10.77 0.431 
SC 15.75 0.315 8.73 0.349 
MT 16.25 0.325 7.65 0.306 
SJ 14.61 0.292 5.44 0.217 
LC 11.48 0.230 6.26 0.250 
SS 16.25 0.325 10.38 0.415 
HY 10.94 0.219 6.9 0.276 
TOTAL 255.53  100.54  
 
C. Switching Strategy for System off Peak Operation 
The ridership of MRT lines for the off peak operation is 
much smaller than that for the peak operation. By executing 
the load flow analysis, it is found that all of the main 
transformers are very lightly loaded and the average loading 
factor is only 16% as shown in Table 1. To enhance the 
system operation efficiency and provide sufficient capacity 
reserve for system reliability, it is suggested that only one 
main transformer unit in each BSS is required to be committed 
for the off peak operation and the other unit is shutdown for 
backup. By performing the binary integer programming, the 
switching operation (3,137), (52,113), (59,111), (33,103) for 
the off peak operation are proposed. By executing (3,137), 
partial loading of BSS TJ will be transferred to BSS HUJ. By 
executing these four switching operations, the main 
transformers are more evenly loaded. With half of the main 
transformer units shutdown for backup during the off peak 
operation and execution of the above switching operations, the 
transformer loading factors have been improved significantly 
and the transformer loss has been reduced from 553 kW to 
342 kW as illustrated in Fig.12. 
 
Fig.12 Power loss of all main transformers for the off peak operation of Taipei 
MRT network. 
V. CONCLUSION 
In this paper, the dynamic load behavior of an electrified 
MRT train set has been investigated by considering different 
operation modes of train propulsion systems between the 
stations. The power consumption of the train set for each time 
snapshot has been derived based on the passenger ridership 
and the time period required to complete the journey from the 
first station to the last station. The power demand of the 
traction substations along the main lines is then solved by DC 
load flow analysis with the train sets committed on the main 
lines according to the schedule timetable for the peak and off 
peak operation. The AC load flow analysis is then performed 
to calculate the loading level of main transformers. To 
enhance the power system operation efficiency of MRT 
networks, the load transfer among main transformers by 
switching operation has been proposed. The load balance of 
main transformer is obtained by the operation of ring main 
unit so that the partial loading of heavily loaded transformer 
can be transferred to the lightly loaded one. The cost function 
of switching operation is defined by the transformer loading 
and the binary integer programming has been applied to 
derive the optimal switching operation. To demonstrate the 
effectiveness of the proposed methodology, the Taipei MRT 
network with 12 bulk power substations and 56 traction 
substations to serve 6 main lines has been selected for 
computer simulation. The peak and off peak power demand of 
all BSS has been solved for the target year. It is found that 
loading unbalance among the main transformers is very 
 6
