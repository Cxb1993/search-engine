II 
 
 
Abstract 
The emerging technology, P2P, provides solutions to traditional client-server 
architecture, because of its server overlay question. Each node acts not only as the 
client to download files, but also as the server to provide files. The P2P architecture 
can share the network bandwidth and improve transmission speed. In P2P network 
architecture, it is popular to search for the node, which quickly preserves the 
necessary files. Bit-Torrent is a well-known P2P application used to exchange digital 
content with high scalability. However, many users do not get authorization but 
transmit files through Bit-Torrent illegally. In this report, we will propose a DRM 
system that is suitable for the Bit-Torrent environment to protect copyrights, and 
provide high computational efficiency and security aspects. 
Duo to the remarkable advance in information and network technology, Internet 
has been the main manner of people’s data searching tool. Many users, corporations, 
and Government all rely on Internet to request a variety of resources, such as digital 
audios, videos, pictures, documents, and software. In addition, the wireless 
technology and the related applications are also the key point of communication 
development. For example, Taiwan Government proposed “u-Taiwan” and “U-City in 
Taoyuan” in 2008 and 2009 respectively, to integrate different kinds of wireless 
communication channels for giving people an ubiquitous online environment. To 
establishing the wireless e-commerce, security design is the essential concern. Users 
and service providers should do mutual authentication to make sure the transaction 
participants. This report also uses identity-based cryptographic and Kerberos system 
to simplify authentication process, and prevents complicated compute from being the 
load on small mobile devices. 
IV 
 
Table of Contents 
Abstract (in Chinese) ................................................................................................... I 
Abstract (in English)...................................................................................................II 
1. Introduction..............................................................................................................1 
2. Related works .........................................................................................................5 
2.1 P2P architecture...............................................................................................5 
2.2 Ubiquitous Computing ....................................................................................7 
2.3 Overview of DRM ............................................................................................9 
2.4 Identity-based Encryption.............................................................................16 
3. Authorized File-Sharing System on P2P Networks ............................................18 
3.1 Notations .........................................................................................................18 
3.2 Initial Phase ....................................................................................................19 
3.3 Encapsulation Phase ......................................................................................20 
3.4 Transfer Phase ...............................................................................................23 
3.5 Payment Phase ...............................................................................................23 
3.6 Decryption and update TS ............................................................................24 
3.7 Security analysis and advantage...................................................................25 
4. Convertible DRM System Based on Identity-based Encryption .......................27 
4.1 Notations .........................................................................................................28 
4.2 Registration Process at CA ...........................................................................29 
4.3 Registration Process at AAA.........................................................................29 
4.4 Ticket Request................................................................................................31 
4.5 Request Resource in Home Domain.............................................................33 
4.6 Authenticate in a Foreign Domain ...............................................................34 
4.7 Request Resource in Foreign Domain..........................................................36 
4.8 Intra-domain Format Conversion ................................................................38 
VI 
 
 
2 
 
point of such circumstance is that how to establish architecture to protect users’ 
personal information, as well as satisfying several security requirements in wireless 
ubiquitous computing to provide a reliable transaction environment. 
A high-reliable business model or proposed scheme should consider three roles: 
for consumers, for digital rights owners, and for system platform providers all have 
stable profits from the system. Moreover, the security requirements, including users 
authentication, and digital files access control, are also essential conditions to 
maintain system running. So, the proposed scheme does not completely apply the 
existing commercial DRM system; the DRM system in this paper, based on 
identity-based encryption [4], is designed specifically in the ubiquitous computing 
environments for resolving above problems. Other problems about existing 
commercial DRM system can also be resolved, and list as following: 
1) Currently, DRM system developers have different DRM technologies with many 
kinds of cryptology respectively. The protected digital files with different 
cryptology technology aren’t compatible with other kind’s decryption modules. 
When the user’s device is installed a DRM system, the files that the user bought 
are fixed on one DRM system. 
2) For preventing unauthorized redistribution, sellers would restrict their digital 
products can be played on only one machine. So, even though the buyer holds 
two devices with the same DRM system, he can’t arbitrarily access the files that 
he bought legally. 
For example, a user not only has a desktop computer, but also still has a notebook, a 
PDA, and a smart phone. If he paid for a multimedia file legally with his desktop 
computer, he may not execute the multimedia file with players on the other devices 
duo to the "over-protected" DRM systems. Therefore, this report presents a novel and 
4 
 
those security requirements. 
(3) Privacy of users: When users roam into an unfamiliar domain, they may be 
unwilling to reveal three “wh” to the untrustful service provider: Who enter the region? 
When they enter or leave? What services or files they request? So this paper provides 
an architecture that allow users choose what temporary name they want to identify to 
achieve the anonymous purpose, then foreign service providers are unable to establish 
the relationship with these impersonal data. 
(4) Compatible DRM systems: DRM is a popular tool used to protect digital 
contents with cryptographic technology. But there are many different DRM 
encryption formats that are adopted by different content providers, causing consumers 
can’t play their content on devices with different DRM format even though they paid 
for it legally. In the later sections of this paper will show the proposed system not only 
satisfying security requirements, but also establishing a conversion method. 
6 
 
of traffic. An example of such a system is Napster [34]. 
¾ Decentralized P2P system: In the decentralized P2P system, each node’s 
level is equal. This system can be divided into structure and unstructured. 
Decentralized structured P2P systems are generally based on the distributed 
hash table (DHT)[13, 26]. The participated node constructs a special 
network topology. The file placement is tightly controlled, by network 
topology. If the file exists, the search will have a result. Much of the 
research about the distributed resource search is based on the use of the 
DHT method. These methods achieve load balance effectively, as a result of 
the Hash function’s characteristics. The P2P system must maintain the strict 
network construction. Therefore, when the nodes join or leave frequently, 
they consume massive amounts of network bandwidths to maintain the 
network structure. An example of such a system is Chord [14], CAN [26], 
Pastry [2] and Tapestry [5]. In the decentralized unstructured P2P, all nodes 
don’t organize a special structure. Each node may join and leave freely. 
When one node searches a file, it sends a request message to all of its 
neighbors by broadcasting. When a neighboring node receives the message, 
it determines whether or not it contains the file. If it does have the file, it 
will respond. Otherwise, the message will be sent to its neighbor 
continuously, until the file is found. Nevertheless, this search method allows 
the message to grow exponentially. The authors [12, 35] set TTL in query 
message to resolve. Nevertheless, if the TTL is set too small, these schemes 
should get the bad query result in the network. 
¾ Hybrid P2P system: This system occurs whenever centralized P2P or 
decentralized P2P has some disadvantage. Therefore, the hybrid P2P system 
8 
 
protocol (IP), every device uses a statical IP address to participate Internet, and 
packets are routed by the IP. But in ubiquitous computing environment, when the 
mobile device changes the physical location and moves to other areas, researchers 
need to design additional solutions to let existing services find the device. Mobile IP 
[8, 18] is one of the methods to permit IP network to interoperate with roaming hosts.  
Privacy issues involve many kinds of information that users are unwilling to 
reveal. For example, the traveling pattern of a mobile device location can be traced by 
the roaming data transmitted with service providers. Also, the services requested by a 
device, the time of using services, and the transaction detail of clients may be exposed 
to the malicious thief by simply intercepting the wireless radio. One solution to the 
location privacy problem is utilizing a central database to store location information; 
another is storing each person’s information in his own PC or workstation [21]. In this 
paper, in addition to user’s location information, the DRM management protocol also 
holds other secret data that are used to keep the transaction fair. So the former way, 
provides the better choice to construct an ubiquitous computing environment. 
Nowadays, many wireless technologies can integrate and form an ubiquitous 
computing environment. One category is the telecommunication technology, e.g. 2G, 
2.5G, 3G, 3.5G, and LTE; another category belongs to the IP-networking, e.g. Ad hoc 
network, WLAN, and WiMAX. When service providers successfully interconnect 
these wireless channels, the entire area becomes a Wireless Mesh Networks (WMNs) 
[15], which allow users linking to Internet anytime and anywhere regardless of the 
platform on their mobile devices, as Figure 2. 
10 
 
digital assets owners’ copyrights. In paper [23], the authors define: “Digital Rights 
Management is a system to protect high-value digital assets and control the distribution and 
usage of those digital assets.” Another paper [27] said “The term digital rights management 
broadly refers to a set of policies, techniques and tools that guide the proper use of digital 
content.” DRM technology achieves above objectives by using a digital license that clearly 
states the usage of each corresponding digital file. Comparing to buying physical goods, e.g. 
CDs, consumers purchasing a digital content protected by DRM is paying for the “right”, and 
the “right” is recorded on a digital license file. Only when consumers collect the both 
protected content and license file, they can execute or play successfully. This way makes the 
system easier in distinguishing consumer’s limitation of every file, as well as more flexible 
for different business models designing. 
Figure 2 depicts the common architecture of DRM technology. The Content provider (or 
Creator) creates the raw content and owns copyrights. Before publishing the digital content on 
Internet virtual store, the content provider encrypts it into a protected format, then transfer 
protected content to the Distributor, and file’s usage rules to the Clearinghouse. The 
Clearinghouse is a management center that handles consumers’ financial transaction. For 
playing or executing the protected content, consumers need to pay for the right and then 
receive the corresponding digital license from the Clearinghouse. Finally, the Clearinghouse 
distributes profit from every transaction to the Content provider and Distributor. 
12 
 
fulfilled fundamentally, but the real deployments are distinct from different commercial 
systems. Table 1 lists four existing commercial DRM systems. 
Symmetric and asymmetric encryption: To prevent illegal usage in raw contents, 
creators or copyright-owners can encrypt their digital files with symmetric or asymmetric 
encryption. Symmetric encryption uses the same key in both encrypting and decrypting 
process, while asymmetric encryption uses a key pair. The clearinghouse encrypts the digital 
license that contains content decryption key and is protected by consumer’s public key. This 
way ensures only the legal buyer can use his private key and get content key. 
Digital signature and one-way functions: Digital signature is usually used to prove 
consumer’s payment evidence, or prove the validity of digital license from the clearinghouse. 
One-way hash functions have the characteristic of irreversible operation. So the applications 
of combining digital signature and one-way hashing functions can check the message 
integrity between two communication parties. For example, consumers can verify the 
integrity of digital license, and the clearinghouse can check the order of digital goods and 
payments from consumers. 
Digital certificates: Digital certificates help DRM system participants authenticate the 
identity of current transaction people or organization. Preventing any possible malicious 
forgers attack the normal transaction is essential. 
 
 
 
 
 
 
 
14 
 
permanently. The deployment of valid certificate would raise the cost of smart phones for 
consumers. Besides, if the certificate is over the valid period, users need to do updating 
process for each device. Secondly, the system uses RSA encryption / decryption operations. It 
is suspect with the ability of mobile device running the operation. Third, the system is 
designed for the raw contents that are owned originally by the content provider device, not 
bought from other sellers. Therefore, the file-transferring function is incompatible with other 
DRM systems.  
Aiming to building a mobile DRM system, Chen also presented a mechanism [6], called 
E-DRM, to protect digital files transmission through wireless communication. In order to 
solve the problem of the lower power computing client, the author apply the one-way hash 
function, symmetrical encryption, and exclusive OR operation in client side. The server is 
responsible for the complex works, such as digital signature and PKI verification. Consumers 
can be authenticated and authorized successfully by E-DRM. However, the system has some 
weak aspects. Firstly, some components of E-DRM are redundant, for example, the function 
of package server and content server can be combined, as well as license server and 
authorization authority. The unnecessary servers make the system complicated. Secondly, the 
author didn’t clearly suppose the authorization authority is a trust third party. An untrusted 
authorization authority may raise a collusion attack with a malicious user to cheat license 
server, or forge a legal user’s purchase request to license server. Third, the article simplifies 
some secret transmission processes by the “through secure channel” assumption. Those secret 
transmission processes could raise much system complexity when implementing the 
architecture. 
The use of DRM system is usually causing controversy issues. Dissenters and critics 
even satirically explain the abbreviation of DRM as “Digital Restrictions Management.”[30] 
They consider that the profit-seeking corporations utilize DRM technologies on digital goods 
16 
 
both data, then he can decrypt the CEK and get clear content. 
The privacy topic is one of the issues of consumers concern. A typical DRM system 
requests either users’ or their devices’ identity to make the license individualized [7]. On one 
hand the individualized license prevents the license be redistributed, on the other hand is the 
proof of purchase from consumers; meanwhile, sellers can get complete data of the digital 
goods and who are their buyers. However, consumers have the rights to refuse revealing the 
personal purchase order. An ideal DRM system should prevent above issues to enhance users’ 
acceptance. 
 
2.4 Identity-based Encryption  
The concept of identity-based cryptosystem was proposed by Shamir [3, 4] in 
1979 and 1984, but the first practical identity-based encryption (IBE) scheme was 
proposed by Boneh and Franklin [9] until 2001. There are two major characters of 
IBE. Firstly, IBE simplifies certificate management by using secret data receiver’s 
unique and well-known information as public key. Secondly, the security of IBE is 
based on elliptic curve discrete log problem, and makes use of the property of bilinear 
pairing. By these two characters, IBE not only makes the key management easier, but 
also lower the computational cost. Comparing to conventional public key 
cryptosystem, e.g. RSA cryptosystem, IBE is more suitable for mobile device. We 
briefly describe the IBE scheme as follows. 
Let 1G  be an additive cyclic group generated by P , whose order is a prime q , 
and 2G  be a cyclic multiplicative group of the same order q . We assume that the 
discrete logarithm problems in both 1G  and 2G  are hard, and a trusted certification 
authority (CA) is responsible for setting up IBE parameters and generating private key 
for each user. CA defines two hash function *1 1:{0,1}H G→  and *2 :{0,1} qH Z→ . 
18 
 
3. Authorized File-Sharing System on P2P Networks 
 
In order to defense man-in-the-middle attack, reduce the 
encryption/decryption/payment process, and add the incentive for senders, we propose 
an Authorized File-Sharing System on P2P networks. In our scheme, we change the 
copyright protection manner that encrypts a clear file before split into pieces, so the 
encryption/decryption/payment process will be reduced only one time per file. 
Furthermore, to avoid the man-in-the-middle attack, several crucial authentication 
process and hash value in the payment messages will be checked. In addition the 
above characteristics, we consider and design reward concept. Our scheme distributes 
some incentive for senders to encourage P2P users keep sharing. We explain our 
scheme by following Initial, Encapsulation, Transfer, Payment, and Decryption phase. 
Fig. 3 shows the whole architecture structure, and assumes that the sharing-file is only 
divided into two pieces. 
 
3.1 Notations 
¾ ON : Node of content owner 
¾ RN : Node of content requester. 
¾ 
iS
N : The ith node of sender. 
¾ CPG : C2C Payment Gateway. The payment is in escrow by CPG. 
¾ Tracker site: It has all of the nodes
iS
N list where pieces of file are available, and 
it can be update. 
¾ 21,, SS RRZ : Random number. 
20 
 
key RX and public key pgY xiR mod= . This key pair based on Diffie-Hellman key 
agreement protocol is used to generate session key. 
 
Figure 3. Initial phase 
 
3.3 Encapsulation Phase 
This phase describes how to encrypt an original clear file. In our scheme, we encrypt 
clear file in the beginning, so we don’t need to encrypt/decrypt/pay repeatedly. Please 
note that there are two parameters, 1SR and 2SR , that are used to be the contribution 
evidence. With this contribution evidence, senders can receive uploading rewards 
after system completing every transaction. Following lists the steps that content 
owner ON precedes encryption to protect the clear content. Figure 4 shows the 
encapsulation phase process. 
(1) Generate an original clear file ABC. 
(2) Generate a session key pYK ZO mod= . 
(3) Compute pKABCABCEK mod)( ⋅= . 
(4) Generate random numbers SiSS RRR ,..,, 21 . 
(5) Generate SiSS RRRRD ⊕⊕⊕= ..21 . 
(6) Generate )(ABCERDC K⊕= . 
22 
 
 
Figure 5. System architecture 
 
24 
 
(8) ON verifies RY . 
(9) ON computes pYY
Z
O
Z
RR mod))((=α and pg Z mod=β . 
(10) ON generates a license including Rα andβ . 
(11) ON sends the license to CPG. 
(12) CPG deducts money from sNR ' account, and pays for 1, SO NN , and 2SN . 
(13) CPG sends the license,
21
, SS RR to RN . 
 
3.6 Decryption and update TS 
This phase explains the decryption processing. After accomplishing the entire 
transaction procedures, the requester will become a new sender, and share the 
encrypted file to next requester. Follows describe the steps operate by RN , and show 
on Figure 7. 
 
(1) Generates
21
' SS RRRD ⊕= . 
(2) Computes ')( RDMABCEK ⋅= . 
(3) Computes pK RXR mod))(( βα=  
(4) Computes KABCEABC K ⋅= )( . 
(5) Play the content ABC. 
(6) Update TS’s list to let RN become a new sender. 
26 
 
When a user generates payment information through his DRM module, CPG can 
verify buyer’s identity by checking the value )( RkR Yh in NRPay . 
(3) Prevention of license stealing or redistributing:  
Because the license contains the parameters Rα andβ , every license is made for 
the only one legal buyer. So the license stealing or redistributing problem will not 
exist in our scheme. 
(4) Low computational cost:  
We protect digital files by encrypting an original file before splitting. This way 
can speed the DRM module processing in both ON and RN side. 
(5) Attractive transaction manner:  
There are two reasons to attract users exchanging files on our scheme. 1) For 
senders, our system provides reward to be the incentive for their contribution. If 
they keep uploading more files, they can get more payment. 2) For content 
requester, the trusty C2C payment gateway is responsible for gathering all needful 
license and parameters of decryption process. So after legally paying, buyer can 
play files successfully. 
 
 
 
 
 
 
 
 
28 
 
convenience in playing, here the DRM module is a compatible platform to allow 
AAAs embed any secret and needful parameters. Third, service providers authenticate 
users’ identity, and users buy preferred digital files. Fourth, users take their mobile 
devices and roam to a foreign domain. The foreign AAA (FAAA) asks each user’s 
HAAA to help verify user’s identity. If verification passes, HAAA will help FAAA 
and each legal user creating a session key to securely transmit a share-secret 
parameter. The parameter is used in the foreign domain DRM format, i.e. every AAA 
has the decision-making power to choice what values are involved in their DRM 
process. Fifth, similar to third phase, but users will get digital files in different DRM 
format, and users’ devices still can execute compatibly. Finally, sixth and seventh 
steps are the DRM format conversion. 
 
4.1 Notations 
¾ NID : User’s unique network identity. 
¾ xTID : User’s temporary identity in domain x. 
¾ iPK : Public key. 
¾ iSK : Private key. 
¾ iHW : Unique Hardware identity. 
¾ _A BK : Session key of two communication parties A and B. 
¾ iT : Timestamp. 
¾ PW : Password. 
¾ iSP : Service provider. 
¾ SN : Serial number. 
30 
 
1) Firstly, the user prepares the unique hardware serial number 1HW  of his mobile 
device and decides his account password PW  and a temporary identity HTID . 
The temporary identity instead of user’s real network identity is used within the 
home domain in the future, so that the user can choose the HTID  arbitrarily, as 
well as achieving anonymous purpose. 
2) The user computes the session key _ 1 1( ( ), ( ))User HAAAK e sH NID H HAAA=  based 
on identity-based encryption and bilinear pairing. Using this session key 
_User HAAAK , the user encrypts some secret data into 
_ 1 H 1
[ || || || || ]
User HAAAK
Reg E NID HW PW TID T= . Here the 1T  is a timestamp 
recording Reg ’s creating time and is used to prevent replay attack from 
malicious attackers. 
3) The user sends NID , 1HW , and Reg  to HAAA. 
4) Upon receiving user’s registration data, HAAA decrypts Reg  and checks 
whether the timestamp 1T  is still in valid period, then, verifies NID  and 1HW . 
5) If all the above data are correct, HAAA creates a random number 1N . The 1N  
will be a component of the DRM encryption key later, so HAAA embedded 1N  
and 1HW  secretly into a DRM module. Finally, HAAA returns the DRM 
module to the user. 
6) The user installs the DRM module on his mobile device. During the installing 
process, DRM module will retrieve hardware number of the device and compare 
to the value that inside the DRM module, so that the user can’t install the DRM 
module on the wrong machine. 
32 
 
where or what service providers iSP  he wants to access in applying 
message
_ 2
[ || || ]
User HAAAH K H i
App E TID SP T= . 
2) The user sends , , and H i HTID SP App  to HAAA. 
3) HAAA decrypts HApp  and checks the timestamp 2T . 
4) HAAA computes a value 1 1 1( )V h N PW= ⊕ , and generates a ticket. For 
example, the user lists service provider 1SP  in HApp , so HAAA generates a 
ticket 
1 _ 1 1 1 3
[ || || || || ]
HAAA SPSP K H
Ticket E V TID SP SN T=  for the user allowing him 
requesting or buying resource in 1SP . 
5) Before returning the ticket to the user, HAAA protects ticket by encrypting with 
_User HAAAK . HAAA computes _ 1[ ]User HAAAH K SPRApp E Ticket= . 
6) HAAA sends HRApp  to the user. The user can decrypt it and get 1SPTicket . 
, ,H i HTID SP App
_ 2
Compute
[ || || ]
User HAAAH K H i
App E TID SP T=
1 _ 1
_ 1
1 1 1
1 1 3
Compute ( )
[ || || || || ],
Encrypt [ ]
HAAA SP
User HAAA
SP K H
H K SP
V h N PW
Ticket E V TID SP SN T
RApp E Ticket
= ⊕
=
=
HRApp
1
Get SPTicket
Figure 11. Ticket request process 
34 
 
User SP1
1
,H SPTID Ticket
1K
R
1
1
1 1
1 1 3
3 1
1 1 1 1
Decrypt , get , , , ,
Verify , ,
Verify & Record 
Compute ( ( ), ( ))
Encrypt [ ]
SP H
H
V
H
K K
Ticket V TID SP SN T
T SP TID
SN
K e H TID H SP
R E R
=
=
1
1
(DRM module)
Compute  (User keys in )
Compute 
Decrypt, get 
V PW
K
R
 
Figure 12. Request resource in home domain 
 
4.6 Authenticate in a Foreign Domain 
In this phase, the user moves into another foreign domain. Because of the 
domains are independent, they may adopt different IBE parameters and hash function 
to implement DRM system. Therefore, if the user roams to a foreign domain first time, 
he needs to not only prove his identity but also register on FAAA to get a new 
parameter of foreign domain’s DRM format. Following steps show the process that 
FAAA authenticates the mobile device 1HW  through HAAA, and it is pictured on 
Figure 13. 
1) In the authentication process beginning, the user’s DRM module computes a 
subordinate key 11 1( ( ), ( )) Nsub HK e H TID H FAAA= , which is only used before 
FAAA authenticating the user’s identity. Then, using the subK , the user prepares 
two parts of authentication data: 1 1[ ' || || ]subF K FReg E PW TID HW=  and 
2 4[ || ]subF K HReg E TID T= . 
36 
 
FRReg  to DRM module. Thus, the system can embed the secret random number 
2N  into DRM module secretly, and needn’t deliver a whole new DRM module 
to users. 
1
1 1
1 1
2 4
Compute ( ( ), ( ))
Encrypt [ ' || || ]
             [ || ]
sub
sub
N
sub H
F K F
F K H
K e H TID H FAAA
Reg E PW TID HW
Reg E TID T
=
=
=
1 2, , ,H HAAA F FTID NID Reg Reg
2, ,FAAA FNID Qry Reg
Result, RQry
FRReg
(DRM module)
Decrypt FRReg
_ 6
Decrypt 
Verify &  Reply Result
Compute 
Encrypt 
[ || Result || ]
FAAA HAAA
H
sub
K sub
Qry
TID
K
RQry E K T=
_ 5
Encrypt [ || ]
FAAA HAAAK H
Qry E TID T=
1
2
2
Decrypt , get 
Decrypt 
Create random 
Encrypt [ ]
sub
sub
F
F K
RQry K
Reg
N
RReg E N=
Figure 13. Authenticate in a foreign domain 
 
4.7 Request Resource in Foreign Domain 
The process of applying tickets and requesting resource in foreign domain is 
alike in the user home domain. A special difference is that in the applying ticket phase 
in home domain, the user can authenticate himself to HAAA by creating the data 
38 
 
1
,F SPTID Ticket
2K
R
1
2
2 2
2 1 8
8 1
2 1 1 1
Decrypt , get , , , ',
Verify , ,
Verify & Record '
Compute ( ( ), ( ))
Encrypt [ ]
SP F
F
V
F
K K
Ticket V TID SP SN T
T SP TID
SN
K e H TID H SP
R E R
=
=
2
2
(DRM module)
Compute  (User keys in )
Compute 
Decrypt, get 
V PW
K
R
 
Figure 15. Request resource in foreign domain 
 
4.8 Intra-domain Format Conversion 
This section describes the DRM format conversion process of protected digital 
contents that were bought from different service providers but in the same AAA 
domain. Supposing a user takes a mobile device 1HW  to service provider 1SP  
within home domain and buys a protected digital content 
1 1
[ ]K KR E R= ; the key 
1
1 1 1 1( ( ), ( ))
V
HK e H TID H SP= . Afterward, the user takes another device 2HW  to 2SP  
in the same home domain and buys 
2 2
[ ]K KR E R= ; the key 
1
2 1 1 2( ( ), ( ))
V
HK e H TID H SP= . Although these two files are encrypted by various keys, 
both 1HW  and 2HW  can generate 1K  and 2K  from keeping the secret value 1N . 
Therefore, for a consumer, as long as digital files are bought from the same domain, 
where the consumer has taken devices to register successfully, files are compatible 
easily. 
40 
 
The sharing-request contains message that points out what file in 1HW  is 
requested by 3HW . 
2) Upon 1HW ’s DRM module receiving the request from 3HW , 1HW ’s DRM 
module checks the usage-restriction of the file 
1K
R . If the usage-restriction 
allows 
1K
R  to be converted, i.e. for calculating 3V , 1HW ’s DRM module would 
send a query-message to HAAA1 to ask HAAA1 for helping forward query to 
HAAA2. HAAA1 can authenticate device 1HW  by the way that similar to the 
process for requesting tickets, but the user needs to additionally annotate 
conversion-source device 1HW  and conversion-target device 3HW  in 
query-message. 
3) HAAA1 forwards query to HAAA2. Here supposing HAAAi are reliable centers, 
therefore, the message integrity and mutual authentication process between 
HAAA1 and HAAA2 is secure. 
4) HAAA2 returns 2 _1 2 3[ ]HAAA HAAAHAAA KRquery E N=  to HAAA1. 
5) HAAA1 decrypts 
2HAAA
Rquery  and encrypts 3N  with key 
1
1 _ 1 1 1
( ( ), ( ))VHAAA UserK e H NID H HAAA= , i.e. 1 _1 3[ ]HAAA UserHAAA KRquery E N= . 
HAAA1 returns 
1HAAA
Rquery  to the user ( 1HW ). 
6) 1HW ’s DRM module decrypts 1HAAARquery  and gets 3N . 
7) 1HW ’s DRM module computes 3 3 3( )V h N PW= ⊕ . 
8) 1HW ’s DRM module computes the key 31 3_ 1 1( ( ), ( '))
V
HW HW H HK e H TID H TID= . 
9) 1HW ’s DRM module encrypts R  by the key 1 3_HW HWK , i.e. 
1 _1 3
[ ]
HW HWHW K
Rquery E R= . 
42 
 
like: _
( '    , '    )
                   ( '    , '    )
Sender ReceiverK e Sender s IDB Private Key Receiver s IDB Public Key
e Sender s IDB Public Key Receiver s IDB Private Key
=
= . 
With the identity-based encryption symmetric key, attackers have no ability to 
forge the session key and encrypted data. This way not only avoids the replay 
and modification attack, but also accomplishes the mutual authentication 
processing. 
2) Anonymous: Both the authentication process in home domain and foreign 
domain, the user can decide the temporary ID ( HTID  or FTID ) that he chooses. 
The information of temporary ID is encrypted, so others can’t recognize what 
T ID  is chosen by a NID . The user only submits his real identity to register at 
home AAA one time, then the following procedures can be complete by the 
T ID , even in the authentication phase of foreign domain. 
3) Reducing authentication process: In this paper, the service providers iSP  can 
identify each legal user by the tickets that the user submits. So the tickets play 
the permit or license roles in the whole system. This manner can reduce the 
authentication process in iSP . iSP  doesn’t need to establish an online 
connection with AAA to retrieve user data. 
4) DRM format conversion process: Comparing to [32], this paper uses the 
identity-based encryption concept to prevent content encrypted key stolen. The 
DRM format process is based on a DRM module installed on the correct device, 
so the process is reliable and promotes legal buyers’ convenience. 
5) Low computational cost: The proposed architecture considers two inherent 
limitations of wireless network. Firstly, the low computational ability of mobile 
device, generally speaking, it is hard for mobile device to process the high 
complexity operation. Therefore, here rely on the character of identity-based 
44 
 
( ( ), ( )) iVi X YK e H TID H SP= , even though he shared the encrypted content to his 
friends, others’ DRM module can’t compute the right key to decrypt it. 
Prevention of misuse DRM module: Because the DRM module plays an important 
role in the scheme, the DRM module in this paper must check the device serial 
number during installing process with the parameter that the user submits in register 
phase. This way prevents DRM module being installed on multi-devices or wrong 
machines. 
 
4.11 Performance Analysis 
Because of the various wireless technologies, such as 2G, 3G, 3.5G, 4G, LTE, 
Bluetooth, ad hoc network, WLAN, and WiMAX, are all developing prosperously, 
more and more related applications are expanded. So, many researchers involve in 
improving the performance of wireless e-commerce. Following Table 2 compares the 
proposed scheme with literatures [6] and [25], which is shortly introduced in section 
2.1.2, about the performance of system security and functions. 
Item descriptions: 
¾ Preventing impersonate attack: Authentication process should be done properly 
for verifying transaction participants, to prevent impersonate attack. 
¾ Persistent protection: The protected content can only be decrypted by the legal 
user. 
¾ Preventing replay attack: All data used to establish session key or prove user 
identity should prevent replay attack from man-in-the-middle attack. 
¾ Integrity issues: Transaction data should be delivered completely, or transaction 
participants have ability to verify data integrity. 
¾ Track usage: When the transaction dispute or security issue happens, the system 
46 
 
 
5. Conclusions 
In this report, we present two DRM schemes. In chapter 3, we propose an 
approach to improve DRM system in P2P environment. Firstly, each user's DRM 
module embeds a HMAC. The HMAC enhances the security over transaction process, 
and prevents the man-in-the-middle attack. Secondly, in addition to protect copyrights, 
our scheme provides reward for uploaders. It can encourage users to buy and share 
digital content through this transaction platform, so that increases file-variety more 
and more. Furthermore, we present a novel approach to deploy the digital rights 
management system on ubiquitous mobile environments in Chapter 4. In this 
approach, allows users decide what temporary identities they want to use to keep their 
privacy. In wireless networks, because mobile devices have fewer resources, such as 
computational ability, storage space, and battery power, so programs run on mobile 
device are as simple as better. The proposal of this paper is based on identity-based 
encryption, and employs symmetric keys instead of public key cryptographic to lower 
the computational cost. Once the user registers at his home domain AAA, he would 
get a DRM module with integrated functions. The main purposes of this paper, mutual 
authentication between client-server and protecting copyrights of digital files that are 
provided from wireless networks providers, can be achieve through this enhanced 
DRM module. By installing the DRM module with embedded secret value iN , which 
is even not obtainable by users, users can apply ticket to pass service providers' 
authentication. A ticket is like a license to allow a user enters a specific server. 
Because the ticket is a crucial component on clients authentication, so the proposed 
scheme makes a special effort to design the usage of ticket; in other words, except the 
correct user claim the corresponding temporary identity to the specific server during 
48 
 
References 
[1] Arora, G., Hanneghan, M., and Merabti, M. 2005. "P2P commercial digital 
content exchange", Electronic Commerce Research and Application, vol. 4, no. 3, pp. 
250-263. 
[2] A. Rowstron and P. Druschel, “Pastry: Scalable, distributed object location and 
routing for large-scale peer-to-peer systems,” In Proc. IFIP/ACM Middleware 2001, 
Heidelberg, Germany, November 2001. 
[3] A. Shamir, "How to share a secret," Communications of the ACM, vol. 22, pp. 
612-613, 1979. 
[4] A. Shamir, "Identity-based cryptosystems and signature schemes," in Advances 
in Cryptology - Crypto 84, 1985, pp. 47-53. 
[5] Ben Y. Zhao, John D. Kubiatowicz, and Anthony D. Joseph, “Tapestry: An 
infrastructure for fault-resilient wide-area location and routing,” Technical Report 
UCB//CSD-01-1141, U. C. Berkeley, April 2001. 
[6] C. Chen, "A secure and traceable E-DRM system based on mobile device," 
Expert Systems with Applications, vol. 35, pp. 878-886, 2008. 
[7] C. Conrado, F. Kamperman, G. J. Schrijen, and W. Jonker, "Privacy in an 
Identity-based DRM System," in IEEE Proceedings of the 14th International 
Workshop on Database and Expert Systems Applications 2003, 2003, pp. 389-395. 
[8] C. Perkins, "Mobile ip," International Journal of Communication Systems, vol. 
11, pp. 3-20, 1998. 
[9] D. Boneh and M. Franklin, "Identity-based encryption from the Weil pairing," in 
Advances in Cryptology - CRYPTO 2001, 2001, pp. 213-229. 
[10] E. Niemela and J. Latvakoski, "Survey of requirements and solutions for 
ubiquitous software," in Proceedings of the 3rd International Conference on Mobile 
and Ubiquitous Multimedia, 2004, pp. 71-77. 
[11] IBM. (2010, Mar.). Electronic Media Management System (EMMS) (IBM Corp) 
- Site Management/Publishing - Datamation Product Watch. Available: 
http://products.datamation.com/site_management/publishing/980261449.html 
[12] I. Clarke, O. Sandberg, B. Wiley, T.W. Hong, “Freenet: a distributed anonymous 
information storage and retrieval system,” in: International Workshop on Design 
Issues in Anonymity and Unobservability, Lecture Notes in Computer Science, vol. 
2009/2001, 2001, pp. 46–66. 
[13] I. Gupta, K. Birman, P. Linga, A. Demers, and R. van Renesse. Kelips”Building 
an efficient and stable P2P DHT through increased memory and background 
overhead,” In Proceedings of the 2nd InternationalWorkshop on Peer-to-Peer Systems, 
2003. 
50 
 
exchanges," Designs, Codes and Cryptography, vol. 2, pp. 107-125, 1992. 
[30] Wikipedia. (2010, Feb.). Digital rights management - Wikipedia, the free 
encyclopedia. Available: http://en.wikipedia.org/wiki/Digital_rights_management 
[31] W. Yuan, D. Guan, and S. Lee, "Trust Management for Ubiquitous Healthcare," 
in International Symposium on Parallel and Distributed Processing with Applications, 
2008, pp. 63-70. 
[32] Y. Jeong, J. Kim, and K. Yoon, "Audio DRM Conversion between Different 
DRM Content Formats," in International Conference on Consumer Electronics, 2008, 
pp. 1-2. 
[33] Zhang, X., Liu, D., Chen, S., Zhang, Z., and Sandhu, R. 2008. "Towards digital 
rights protection in BitTorrent-like P2P system", The 15th Multimedia Computing 
and Networking, vol. 6818, pp. 68180F-6810F-12.  
[34] http://www.napster.com/ 
[35] http://www.gnutella.com/ 
[36] http://www.emule-project.net 
 
which the shortest route (least hops) can gain high priority for 
utilization when the a mobile node is in need of a route. Every 
RREQ that passes through a forwarding node will increase the 
hop count field by one, and the forwarding node will build a 
short time reverse link to the source in the routing table. When 
the destination node receives the RREQ packets, it generates a 
RREP packet and unicasts back to the source node. When the 
route between source node and destination node is established, 
they can communicate to each other.  
In 2002, Manel Guerrero Zapata and N. Asokan [11] 
proposed a secure routing scheme for ad hoc networks using 
AODV [3] routing protocol. Their proposed mechanism can 
protect the routing table from a forgery attack, but lacks 
suitable provisions to ensure the integrity and confidentiality of 
the user's data. Furthermore, forge destination node and 
collusion attacks are novel security problems specific to ad hoc 
networks in which the attacker either forges the destination 
node or colludes with nodes prior to the final destination node 
to enable the grabbing of data packets from the source node. 
Therefore, in this paper, we shall propose a robust and secure 
scheme to solve these problems. In our proposed scheme, 
considering the special characteristics of ad hoc networks, we 
employ the technique of hash chains and identity-based 
cryptosystem [1, 2] to ensure secure and integrity for packets 
forwarding. 
B. Identity-based encryption (IBE) 
In 1984, the concept of identity-based cryptosystem was 
first proposed by Shamir [1, 2] to simplify certificate 
management and conventional public key cryptosystem. In 
2001, the first practical identity-based encryption (IBE) scheme 
was proposed by Boneh-Franklin [5]. The security of IBE is 
based on the Elliptic curve discrete log problem and Bilinear 
Diffie-Hellman Problem. In the approach of IBE, each user can 
use their well-known and unique identity as their public key, 
such as IP address and e-mail address. Their scheme can make 
the key management easier and can minimize the cost of the 
conventional public key cryptosystem. In recent years, several 
schemes based on IBE have been proposed.[4, 5, 6, 7, 12] The 
scheme of IBE applies the property of bilinear pairing. In the 
paper, we will employ the framework of IBE and the concept 
of bilinear pairing in our scheme. We briefly describe them as 
follows. 
The identity-based encryption involves four algorithms: 
Setup, Extract, Encryption and Decryption. We briefly describe 
the encryption and decryption processes of IBE. 
Let 1G be an additive cyclic group generated by P , whose 
order is a prime q , and 2G be a cyclic multiplicative group of 
the same order q . We assume that the discrete logarithm 
problems in both 1G and 2G are hard.  Assume there is a trusted 
Private Key Generator (PKG) that will establish the identity-
based cryptosystem and generate private keys for users. Let P  
be a generator of G . PKG defines two hash 
function 11 }1,0{ GH →= ∗ and qZH →= ∗}1,0{2 . PKG choose 
a random number ∗∈ qZs as the master key, and compute the 
master public key is 1GsPPpub ∈= . Finally, PKG keeps  s  
secretly and publishes },,,,,,,{ 2121 HHPPeqGG pub .  
Assume user A has to send an encrypted message to user B. 
The public key of user B is )(1_ BBID IDHQ = , where BID is the 
identity of user B. User A will compute 
r
pubBID PQem ),( _= using random number r and public 
parameters BIDQ _  and pubP to encrypt the message. After that, 
user A sends the parameter rP and encrypts message to user B. 
User B will compute ),( _ rPsQe BID using its private key 
BIDsQ _  and the parameter rP to decrypt the message. Based 
on the bilinear pairing, the identity-based encryption and 
decryption work as follows: 
),(),(),( ___ rPsQesPQePQe BID
r
BID
r
pubBID == . 
C. Bilinear Pairings 
We briefly describe the basic definition and properties of the 
bilinear pairing as follows. Let 1G be an additive group of 
prime order q and 2G be a multiplicative group of the same 
order q . We assume that the discrete logarithm problem (DLP) 
in both 1G and 2G are hard. A bilinear pairing is a 
map 211: GGGe →× which satisfies the following properties: 
1)  Bilinear: for any 1,, GRQP ∈  , and ∗∈ qZba,  , such that 
abQPeabQPeQabPebQaPe
RQeRPeRQPe
RPeQPeRQPe
),(),(),(),(
),(),(),(
),(),(),(
===
×=+
×=+
 
2) Non-degenerate: there exists 1GP∈ and 1GQ∈ such 
that 1),( ≠QPe  
3) Computable: Given 1, GQP ∈ , there is an efficient algorithm 
to compute 1),( GQPe ∈ . 
D. Hash chains 
In 1981, Lamport proposed a one-time password/hash-
chaining technique. The example of the application of hash 
chaining technique is as follows: 
Let )(xh be a one-way function and compute 
)..))(..(()( xhhhxhi = . Next, generate a digital signature of 
)(xhi and send it to the authenticator. When the claimant 
logins to the system, and the claimant sends the j th password 
which equals )(xh ji− for some fixed message x . Then, the 
authenticator will authenticate it by computing ))(( xhh ji−  and 
subsequently it needs to remember the last password sent by 
the claimant. Only the claimant knows the seed x , so the 
claimant can prove itself to the authenticator for i  times and 
generate one time password in each authentication; moreover, 
 Figure 1.  The overview of our proposed scheme 
IV. SECURITY ANALYSIS 
In this section we provide security analysis of our proposed 
scheme, the security of which is based on elliptic curve 
cryptosystems, as well as the application of identity-based 
technology to generate users’ key pairs and the use of hash 
chains for data authentication. The robustness and efficiency 
of the method will be analyzed below. 
z Impersonate Attack: A malicious node tries to 
impersonate the destination node in order to grab data 
packets sent from the source node. 
When it comes to key generation, all of the nodes use their 
individual identity to generate their public/private key. Before 
a source node sends a data packet, the source node will 
encrypt the packet using the destination node’s public key. 
Only the destination node can use its private key to decrypt the 
encrypted packet. Therefore, if a malicious node tries to 
impersonate the destination node, it cannot decrypt the 
encrypted packet without the destination node’s private key. 
z Collusion Attack: If a malicious node colludes with the 
other node preceding the destination node and attempts 
to grab data packets sent from the source node. The 
overview of this attack is illustrated in the Figure 2. 
 
 
Figure 2.  Collusion attack 
In our proposed scheme, we employ identity-based concepts 
to generate each user’s key pair and encrypt data using the 
destination node’s public key. We can avoid the node prior to 
the destination node which is colluding with the malicious 
node and so prevent the malicious node from colluding with 
any node along the route. 
z Modified Attack: A malicious node wants to transmit a 
modified packet to the next node. 
In our proposed scheme, if one malicious node wants to 
transmit a modified packet to the next node, we can easily be 
detected by checking the hash values; the sending of modified 
packets from malicious nodes to subsequent nodes will thus 
not succeed. 
z Fabricated Attack: A malicious node wants to send the 
fabricated packets to next nodes. 
Malicious nodes are prevented from sending fabricated 
packets in our proposed scheme thanks to the employment of 
the hash chains protection mechanism, which causes each 
node to check the hash chains and so ensure the validity of 
received packets. 
z Man-in-the-middle Attack: A malicious node tries to 
launch a man-in-the-middle attack. 
In our proposed scheme, we use the “eavesdropping 
mechanism” [8] to thwart malicious nodes trying to alter 
message packets. Thus, each node can ensure the integrity of 
the transmitted data. The encrypted packets will thus be 
properly conveyed to their destination as each node can 
guarantee the integrity of the transmitted data. 
z Secure data transmission: 
We adopt identity-based and elliptic curve cryptography to 
generate users’ public key/private keys; based on this elliptic 
curve cryptography we can make sure that data packets will be 
secure and that only the appropriate communication nodes will 
be able to access the data packets.  
z Integrity: 
During the process of data transmission we also employ the 
hash chains and eavesdropping protection mechanism, which 
can provide for the integrity of the data packets as we check 
whether each node properly sends packets to the next node. 
V. PERFORMANCE ANALYSIS & COMPARSION 
Due to elliptic curve discrete logarithm problem with order 
160 bits prime offers approximately the same level of security 
as the discrete logarithm problem with modules of 1024 bits, 
we decided to use an identity-based concept and a framework 
of IBE to generate users’ key pairs and encryption data. 
Compared to traditional PKI cryptosystem, identity-based 
cryptosystem does not need to store the users’ public key. The 
user directly utilizes his/her public and unique identification 
information as its public key. Thus, it can make the key 
management easier and minimize the cost of the conventional 
public key cryptosystem. On the other hand, considering the 
low-computations, we also employ hash chains to ensure the 
secure transmission of data. Table I show these comparisons.   
It is noteworthy that both, in Tsai [15] and Yih-Chun Hu 
[14] employ the modular operation and modular 
exponentiation in their schemes. Owing to the fact that the 
mobile devices used in ad hoc networks are lacking in power 
and computing ability, the application of modular operation 
無衍生研發成果推廣資料
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
無 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
