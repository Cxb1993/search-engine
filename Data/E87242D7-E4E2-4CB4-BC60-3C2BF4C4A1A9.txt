英 文 摘 要 ： Existing distribution network was designed to deliver 
unidirectional power flows 
to consumers. It was designed to require minimal 
control intervention, resulting in a 
largely passive infrastructure. The technical 
challenges to the connection of 
distributed generation (DG) lie in four main areas: 
voltage control, power flow 
management, fault current management and network 
security. In addition to these 
challenges are those associated the interactions 
between DG and the distribution 
system that require careful investigation. As more DG 
connects to distribution 
networks, the more ‘active’ controls of DG and/or 
network components are required. 
In this project, the impacts of DG on the 
distribution system voltage profile and fault 
detection are examined, and the remedial actions are 
investigated with an aim to 
increase the penetration of DG. The area based 
coordinated voltage control of On 
Load Tap Changing Transformers (OLTCs) and 
applications of voltage regulators are 
studied. The low voltage ride through capability of 
wind turbine with various 
reinforcement techniques during fault situations is 
also investigated. 
Microgrid architecture can be used to enhance 
distribution network reliability 
and manage various types of DG. With more 
measurements obtainable from 
distribution automations (DA), advanced metering 
infrastructure (AMI) and demand 
side management (DMS) systems, system states can be 
properly estimated and used in 
grid operations. Control strategies for distributed 
energy resource (DER) units within 
a microgrid are selected based on the required 
functions and possible operational 
scenarios. Controls of a DER unit are also determined 
by the nature of its interactions 
  I
行政院國家科學委員會補助專題研究計畫■成果報告   □期中進度報告 
 
含分散式電源之配電系統運轉研究 
A Study on Operations of Distribution Systems with Distributed Generation 
 
計畫類別：■個別型計畫   □整合型計畫 
計畫編號：NSC 98－2221－E－110－076－MY3 
執行期間：98 年 8 月 1 日至 101  年 7 月 31  日 
 
執行機構及系所：國立中山大學電機系 
 
計畫主持人：盧展南   
共同主持人： 
計畫參與人員：蘇勝一、王志賢、黃靖智、林筱秋、林建宏、陳敏睿、陳開瑞、
陳育杰、黃士哲  
 
成果報告類型(依經費核定清單規定繳交)：□精簡報告  ■完整報告 
 
本計畫除繳交成果報告外，另須繳交以下出國心得報告： 
□赴國外出差或研習心得報告 
□赴大陸地區出差或研習心得報告 
■出席國際學術會議心得報告 
□國際合作研究計畫國外研究報告 
 
 
 
 
處理方式：除列管計畫及下列情形者外，得立即公開查詢 
            ■涉及專利或其他智慧財產權，□一年■二年後可公開查詢 
 
中   華   民   國   100 年 5 月 31 日 
  II
4.3 維持穩定孤島運轉之分散式電源控制策略研究............................... 76 
4.3.1 直流微電網平台運轉分析........................................................ 80 
 第五章 結論.............................................................................................................. 89 
 參考文獻.................................................................................................................... 91 
 國科會補助專題研究計畫成果報告自評表............................................................ 94 
 國科會補助計畫衍生研發成果推廣資料表............................................................ 95 
 國科會補助專題研究計畫項下出席國際學術會議心得報告................................ 97 
 
  IV
圖 3-14  配電架構及相對應之代理人[8] ................................................................. 37 
圖 3-15  系統狀態變化回報方式 ............................................................................. 41 
圖 3-16  領導代理人的定義 ..................................................................................... 42 
圖 3-17  復電詢問流程[8] ......................................................................................... 42 
圖 3-18  應用於饋線事故處理之分散式多代理人系統[8] ..................................... 43 
圖 3-19  多代理人系統處理饋線故障時序圖[8] ..................................................... 44 
圖 3-20  完整狀態估計之架構[28] ........................................................................... 46 
圖 3-21  三相狀態估計(SE)程式 .............................................................................. 47 
圖 3-22  狀態估計(含錯誤資料偵測與辨識)程式流程圖 ....................................... 48 
圖 3-23  用戶資料驗證及修補之流程圖 ................................................................. 51 
圖 3-24  判斷異常用戶之流程圖 ............................................................................. 51 
圖 3-25   6 個 BUS 匯流排之簡易饋線 ..................................................................... 52 
圖 3-26  系統架構圖 ................................................................................................. 55 
圖 3-27  變電站所提供之功率與用戶總負載之比較 ............................................. 56 
圖 3-28  各組資料母體平均之信賴區間 ................................................................. 58 
圖 3-29  匯流排 3 之商業用戶模擬結果(案例 1) .................................................... 58 
圖 3-30  匯流排 11 之家庭用戶模擬結果(案例 1) .................................................. 58 
圖 3-31  匯流排 3 之商業用戶模擬結果(案例 2) .................................................... 59 
圖 3-32  匯流排 11 之家庭用戶模擬結果(案例 2) .................................................. 59 
圖 4-1   電池種類 ...................................................................................................... 61 
圖 4-2   電池在電力系統上的應用 .......................................................................... 61 
圖 4-3   理想電池模型 .............................................................................................. 62 
圖 4-4   電池線性模型 .............................................................................................. 62 
圖 4-5   電池戴維寧等效模型 .................................................................................. 63 
圖 4-6   MATLAB SIMPOWER SYSTEM 內建電池模組[35] ........................................ 63 
圖 4-7   電池放電曲線[35] ....................................................................................... 64 
圖 4-8   太陽能電池光電轉換原理 .......................................................................... 65 
圖 4-9   等效電路 ...................................................................................................... 66 
圖 4-10  太陽能模組輸出 I-V 及 P-V 曲線 ............................................................. 67 
圖 4-11  太陽能光伏陣列之等效模型 ...................................................................... 68 
圖 4-12  PEMFC 發電示意圖 ................................................................................... 68 
圖 4-13  質子交換燃料電池等效電路 ..................................................................... 71 
圖 4-14  質子交換膜及化曲線 ................................................................................. 71 
圖 4-15  MATLAB 模擬及實際量測曲線 ................................................................... 71 
圖 4-16  系統架構圖 ................................................................................................. 72 
圖 4-17  微電網模擬架構 ......................................................................................... 73 
圖 4-18  當 1.5SEC 時加載之功率流動現象 ............................................................. 73 
圖 4-19  直流匯流排電壓 ......................................................................................... 74 
  VI
表目錄 
表 2-1  電壓控制設備之模擬相關資訊 ..................................................................... 8 
表 2-2  併網不同分散式電源容量的整體饋線電壓品質(VQI) ................................ 8 
表 2-3  電壓控制策略 ............................................................................................... 10 
表 2-4  電壓調整設備日平均動作次數 ................................................................... 12 
表 2-5  避免因故障電流逆流致使過電流旗標動作之最大併聯容量[9] ............... 15 
表 2-6  饋線重組下避免旗標因故障電流逆流而動作之最大併聯容量[9] ........... 16 
表 3-1  風機、輸電線及併聯市電系統之參數[13] ................................................. 24 
表 3-2  保護電驛設定[14] ......................................................................................... 26 
表 3-3  各架構於輕重載搭配控制方式之分散式電源最大容量值(MW) ............. 33 
表 3-7  變異數分析結果表 ....................................................................................... 50 
表 3-8  無錯誤資料之測量值假設 ........................................................................... 52 
表 3-9  單一錯誤資料之偵測 ................................................................................... 53 
表 3-10 未刪除異常資料前電壓大小與 BASE CASE 比較 ........................................ 54 
表 3-11 刪除異常資料後電壓大小與 BASE CASE 比較 ............................................ 54 
表 3-12 未刪除異常資料前電壓角度與 BASE CASE 比較 ........................................ 54 
表 3-13 刪除異常資料後電壓角度與 BASE CASE 比較 ............................................ 55 
表 3-14 變電站所提供之功率與用戶總負載之差異 ................................................ 56 
表 3-15 用戶用電需量及其基準線資料 .................................................................... 56 
表 3-16 變異數分析之結果 ........................................................................................ 57 
表 3-17 多重比較之結果 ............................................................................................ 57 
表 3-18 各曲線之總負載需量差異(案例 1) .............................................................. 59 
表 3-19 各曲線之總負載需量差異(CASE 2) ............................................................. 59 
表 4-1  太陽能模板參數 ........................................................................................... 67 
表 4-2  微電網架構中規格與參數 ........................................................................... 73 
表 4-3  孤島運轉控制策略 ....................................................................................... 77 
 
  VIII
戶資訊系統(CIS)資料進行系統狀態估計 
3.4 併網之微電網動態模擬及運轉特性分析 
3.5 因故障事故與市電切離之微電網運轉模擬 
3.6 維持穩定孤島運轉之分散式電源控制策略研究 
3.7 建立含電能儲存單元、太陽光電、燃料電池發電系統及負載之微電
網 
本計畫以三年時間進行上述含 DG 之配電系統主動網路管理研究，整合上述
的研究項目，並建立含電能儲存單元、5kW 太陽光電、3kW 燃料電池發電系統
及負載之微電網。 
 
 
關鍵詞: 分散式電源， 配電系統運轉，微型電網 
  1
第一章 簡介 
節能減碳已為現今世界的風潮，位於用戶端的分散式電源 (Distributed 
Generation, DG)的開發已成趨勢。既設配電系統線路之容量、操作、保護及故障
排除等設計，多奠基於已知之單向電源電力控制系統。由於造成多電源、雙向電
流、額外的接地路徑以及新的保護設計等，分散型電源將使配電系統的設計、運
轉複雜化。在未採用強化措施的情況下，為滿足既設保護設備的啟斷容量、過電
壓問題、系統短路容量、故障電流量等的限制，分散型電源併入既有電網的容量
將受到限制。因此為鼓勵及提升分散式電源，特別是再生能源的開發，如何加強
分析其對既有系統的影響、調整既有系統的設計及運轉方式以因應未來的發展就
變得愈來愈重要。 
分散型發電系統加入配電網路後的長期管理要項包括： 
‧故障電流 
‧電壓控制 
‧負載潮流 
‧線路損失 
‧獨立運轉 
‧輔助服務 
‧電力品質 
‧安全設施 
‧網路設計 
‧主動式管理 
在這些議題中，網路設計與主動管理被視為是未來配電系統技術的核心
[1-5]。主動網路管理系統為自動控制與管理配電網路中的分散型能源資源
(Distributed Energy Resource, DER)的工具。雖然網路可靠度的改進一直是電力網
路自動化的最主要的原因，然而分散型電源的加入卻是許多國家推動自動化的主
要動力。最近幾年，包括電力公司、學術界與工業界等，均開始研究先進配電自
動化 [3-6]及智慧型電網。就短中期而言，主動網路管理系統是為了解決分散型
能源加入配電系統後所產生的種種問題，就長期來看，主動式網路管理則可能讓
配電網路運轉人員，將傳統的配電自動化功能與主動式網路管理中分散型能源自
動化的部分加以結合，藉由功能的結合將可使主動式網路管理與配電自動化互相
協調的效益變得更顯著。 
分散型發電(Distributed Generator, DG)連接到配電網路後的主要技術議題包
括 
‧電壓控制 
‧負載潮流 
‧故障電流 
配電系統在分散型發電加入後所需解決的電壓控制問題，包括即時電壓、電
  3
於所採用的 DER 技術、負載需求和期望的運轉方案。 
風力發電是除太陽能光電發電外分散式能源發電的主流，規定分散式電源的
低電壓忍受度能力是在面臨電網上風力發電容量成長，所提出的一個市網併聯需
求。 
其是指當系統故障時，風力機有能力承受短暫的電壓驟降，使發電機保持平
穩並連接在網路上，以支撐系統，防止系統事故擴大，這種能力就被稱做 Fault 
Ride-Through (FRT)或 Low Voltage Ride Through (LVRT)，即低電壓忍受的能力。
風機必須於 90%到 110%的併接點公稱值電壓下連續運轉，且必須在當系統電壓
驟降或暫態電壓升時，維持併聯於系統，這在微電網的運作下更是重要。 
雖然應用分散能量資源可降低傳統系統擴建的需求性，降低系統損失提高供
電可靠度及品質，然而控制數量多的 DER，卻衍生另外一個新挑戰，即如何安
全地、有效率地運轉及監控整個網路。此挑戰一部分可藉由微散型電網
(Microgrids)或微網(μ-Grid)加以克服，μ-Grid 本質上藉由更分散化的方式協調各
DER，因此可降低網路的控制負擔，並允許 DER 提供其最大效益。μ-Grid 可以
安全地、有效率地運轉於其區域配電網路中，亦有能力獨立孤島運轉。μ-Grid 之
設計及運轉需要新的科技與技術，另一方面擁有多數 DER 的配電系統則需要相
當可觀的運轉控制能力。 
一個微電網可以包括部分中/低壓配電系統及由單一或多個 DER 供應的群
聚負載。從運轉的角度來看，一個微電網可以經由責任分界點(PCC)連接到其餘
區域的電力能源系統運轉，而且在與電網連結和獨立電網(Isolated Grid, IG)兩種
模式狀態完善地轉變。連結至主電網的微電網運作與控制可以在電網依賴(Grid 
Dependent,GD)模式或電網獨立(Grid Independent, GI)模式之間轉換，端視微電網
與主電網系統間的電力交換和相互作用而定。 
微電網正常時，以經由變電站變壓器與電力公司系統連接之併聯模式運轉。
不過，當微電網在 PCC 點與電力公司解聯而形成孤島系統後，它也被期待能繼
續運轉提供足夠的發電量、控制和操作策略，至少可供電給部分的負載。現今的
電力系統在實務上並不允許微電網在偶發事故後維持孤島運轉和自動地再同步
併聯，這主要是基於人員和設備安全的考量。但是，許多 DER 單元基本上有必
要在孤島運轉與電網併聯二種模式間做運作變化，並且使此二種模式能順暢地轉
換，以利微電網的資源獲得最佳的利用。 
本研究計畫對上述含 DG 之配電系統的運轉議題加以研討，主要的研究內容
含: 
1. 分散式電源對配電饋線運轉影響分析 
1.1 以蒙地卡羅方法模擬含分散式電源之饋線電壓分布 
1.2 因應分散式電源併聯之電壓調整設備控制策略 
1.3 含同步機及感應機之配電饋線故障分析 
1.4 分散式電源對配電系統故障偵測之影響分析 
1.5 感應發電機之低電壓忍受能力分析 
  5
第二章 分散式電源對配電饋線運轉影響分析 
2.1 以蒙地卡羅方法模擬含分散式電源之饋線電壓分布 
本計畫第一年先建構分散式電源併網之配電系統，模擬饋線可能的電壓分佈
需考慮負載及分散式電源發電量的不確定性。我們依常態分佈取得 100 筆不同的
匯流排負載量及分散式電源的發電量來進行饋線負載潮流計算，分析分散式電源
的併入對系統之影響。以下先針對模擬所使用的電壓控制方法、評估指標值相關
限制做些簡介，再針對不同研究項目之模擬結果做比較說明。 
電力公司依照變電所饋線的實際負載情況，決定是否必要裝設控制設備調整
饋線電壓，以維持較好的電壓品質。本研究之電壓調整設備所搭配的控制方法分
別為在地電壓準位法和線路壓降補償法，以下為兩種控制方法的說明： 
A. 在地電壓準位法(Local Voltage Level) 
在地電壓準位法是利用裝置在控制設備地點之比壓器(Potential Transformer, 
PT)所量測之電壓值，輸入自動電壓調整電驛(90)，與預先設定的時段目標值比
較後送出訊號給控制設備進行調整。圖 2-1 為電壓準位法運用於有載分接頭切換
器之示意圖。 
 
圖 2-1 電壓準位法運用於 OLTC 變壓器之示意圖[7] 
B. 線路壓降補償法(Line Drop Compensation) 
線路壓降補償法利用比壓器及比流器(Current Transformer, CT)量測饋線上
的電壓與電流值，於饋線中設定一電壓調整點，考慮控制設備至調整點的線路阻
抗，推算該點電壓值，透過電壓調整電驛(Voltage Regulating Relay, VRR) 執行電
壓控制。圖 2-2 為線路壓降補償法運用於 OLTC 變壓器之示意圖，其中 R 與 X
為控制設備至電壓調整點的阻抗值。 
  7
 匯流排間之配電用線為 3C500XP2 地下纜線，其線路阻抗值為 0.09+j0.122 
Ω/km。 
 系統共有三條饋線分別為住宅(F1 綠)、工業(F2 紅) 、商業(F3 澄)型負載，
不同型態負載擁有不同日負載曲線(圖 2-4)，並以常態分布取得各匯流排負
載資料，再搭配日負載曲線取得各時段的負載資料。 
模擬樣本以常態分布取得分散式電源功率輸出資料，功因為 1 p.u.，並搭配
圖 2-5 之模式一發電曲線取得各時段的發電量。併含負載之匯流排共有 17 處，
掛載的負載量平均值為 0.8 MW 及 0.496 Mvar，其匯流排間距為 1.6 km。饋線切
換開關數 17 個(S1~S17)，分散式電源併入點為 13 號匯流排。 
 
圖 2-3 含住宅、工業與商用負載饋線之配電架構 
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
小時
負
載
量
 (
標
么
)
工業 商業 住宅
 
圖 2-4 住宅、工業與商用之日負載曲線 
  9
 
圖 2-6 併聯不同容量之工業饋線電壓分佈 
利用同樣的饋線架構進行，並讓系統在饋線上無安置電壓調整設備的條件下
併網不同分散式電源容量運轉，如圖 2-7 之結果可知，隨著分散式電源併聯容量
增加，其電壓品質指標值之走勢會如拋物線般，代表分散式電源之容量對改善饋
線電壓品質而言並非越大越好。而安置電壓調整設備之系統所描繪的線路會貌似
拋物線，原因在於電壓調整設備對於不同分散式電源容量的併入所對應的調整效
果不同。 
 
圖 2-7 因應分散式電源併聯之電壓調整設備控制策略 
2.1.1電壓控制策略 
不同的控制設備可搭配不同的控制方法而組合出不一樣的電壓控制策略。在
文獻[5]中有提到三種電壓控制策略的介紹，表 2-3 為各策略控制設備的動作順
  11
平均值。 
由表 2-4 可知，可投切式電容器與有載分接頭切換器之調整次數隨著分散式
電源容量的增加而降低，表示分散式電源的併入有助於改善控制設備的調整次
數。當分散式併聯量從 6 MW 提升至 9 MW 以上時，有載分接頭切換器的調整
次數有上升的趨勢，顯示併聯過量的分散式電源容量也會增加電壓控制設備的工
作負擔。當分散式電源併聯容量達到 12 MW 時，有載分接頭切換器為避免併聯
分散式電源之饋線產生過電壓問題必須降低二次側電壓，反而造成鄰近饋線會有
欠電壓問題。因此系統裝設線路電壓調整器來針對併聯分散式電源之饋線調節電
壓，以讓分散式電源之併聯容量能提升。 
 
圖 2-9 未併聯分散式電源之 VR 分接頭位置 
 
圖 2-10 併聯分散式電源之 VR 分接頭位置 
  13
 
圖 2-12 過流旗標的產生邏輯[8] 
2.3 分散式電源對配電系統故障偵測之影響分析 
以下用圖 2-13 來說明分散式電源對故障電流的影響。圖中主變一次側之系
統短路容量假設為 100MVA。主變壓器額定容量為 15MVA，額定電壓為
69/11.4kV，主變百分阻抗為 9%。饋線正序阻抗為 0.131+j0.238Ω/km，零序阻抗
0.393+j0.714Ω/km，饋線電容 12nF/km。四區段總負載量 2.8MVA，功率因數為
0.95。DG 為同步機其中性點直接接地。 
 
圖 2-13 含分散式電源之配電饋線 
圖 2-14 為圖 2-13 中單一分散式電源 DG2 位於 4 公里處，F2 發生故障時，
電流變化及電驛動作情形，類似的模擬可以用來分析各種不同的情況。圖 2-15
的流程圖是用來模擬旋轉式發電機於故障發生後對過流旗標的影響。 
  15
假設下，欲避免因故障電流逆流而致使旗標動作的最大併聯容量如表 2-6 所示。 
表 2-5 避免因故障電流逆流致使過電流旗標動作之最大併聯容量[9] 
F1單相故障 F2單相故障 F3單相故障 F4單相故障
距離
(km)
距離
(km)
距離
(km)
距離
(km)
容量
(MVA)
容量
(MVA)
容量
(MVA)
容量
(MVA)
F1三相故障 F2三相故障 F3三相故障 F4三相故障
距離
(km)
距離
(km)
距離
(km)
距離
(km)
容量
(MVA)
容量
(MVA)
容量
(MVA)
容量
(MVA)
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
1.4
1.5
1.6
1.8
1.9
2
2.2
2.3
0.7
0.8
0.8
0.8
0.9
0.9 0.7
0.7
0.7
0.6
0.6
0.6
3.7
3.8
3.8
3.8
3.9
3.9
3.9
3.9
3.7
3.8
3.8
3.8
3.8
3.9 3.8
3.8
3.7
3.7
3.7
3.7  
 
圖 2-16 具負載轉供能力之配電饋線系統圖 
  17
 
圖 2-18 故障情況 2 
由上述案例顯示，DG 的裝設將會影響到饋線自動化系統中故障偵測的功
能，欲避免因 DG 之裝設而影響其功能，可考慮採取以下措施[9]: 
1. 消極的做法是限制 DG 的裝設容量，使 DG 在故障時無法提供足夠大的故障
電流而使過電流旗標動作。 
2. 於適當地點裝設 FCL(故障電流限制器)以降低 DG 提供的故障電流。 
3. DG 的中性點加裝高阻抗接地，以降低單相故障產生的故障電流。 
4. 調整 DG 斷路器過流跳脫時間，使故障發生時斷路器的啟斷時間小於過電流
旗標動作時間，即 DG PCC 點的斷路器之電驛啟動電流等級或延遲時間比
FTU 過電流旗標小。 
5. 當復閉器打開後，且在再次投入之前將所有的 DG 全部切除。 
6. 每一區段裝設方向性電驛，以判斷故障電流流向找出正確的故障點。 
7. 利用故障位置演算法找出故障點，首先利用線路上各節點所量測的故障電流
找出可疑的故障區域，在經過計算找出正確的故障區域。 
8. 僅於與 DG 裝設位置相鄰之上下游 FTU 處加裝方向性電驛，若於傳送故障旗
標的同時亦傳送故障電流資訊則可據以判斷正確的故障點位置。 
上述措施 1~3 項是以降低故障電流等級考量，利用額外的投資或進一步的計
算 4~8 項可降低故障位置誤判的情形，正確地找出故障點位置。本研究利用電流
差法與電壓電流比值法判斷正確的故障位置。 
2.4 感應發電機之低電壓忍受能力分析 
電網發生短路故障時，故障造成的電壓驟降會使得風力發電機的電磁轉矩減
少，電磁轉矩減少代表減速的力量減少了，會使感應發電機轉子轉速增加，若故
障無法在轉子達到臨界轉速前清除，則轉子轉速在故障情除後無法回復到穩定運
轉。本節提出感應發電機轉子臨界轉速的分析方法[10]，是基於感應發電機在穩
態時的等效電路，利用等效電路中的參數可求出電磁轉矩與轉子轉速關係曲線，
此曲線與機械轉矩會有兩個相交點，就是代表轉子轉速的穩定與不穩定工作點。
若此兩點之間距離越大，則代表感應機需越長的時間轉速才會達到臨界轉速，也
  19
22 )())1(( RTHRRTH
TH
R
XX
S
-SRRR
V
I

                             (2. 5) 
圖 2-19 說明感應發電機轉軸所產生的電功率為轉子電流流過轉子電阻
( )1(
S
-SRR )上所產生的功率，如(2.6)式： 
2)1( RRE IS
-SRP                                                    (2. 6) 
ωTP EE                                                        (2. 7) 
當 1 時， EE TP  ，所以： 
22
2
R
2
R
)()(
)
S
S-1(R)
S
S-1(R
RTH
R
TH
TH
RE
XX
S
RR
V
IT

                  (2. 8) 
(2.8)式中 S 為轉差率 
感應機的機械方程式： 
)(
2
1
EM
R -TT
Hdt
dω                                                  (2. 9) 
由(2.8)式所得的轉矩-轉差曲線，當 EM TT  時，可將(2.8)式移項整理成(2.10)
式： 
0)2())(( 2
2
2
2
22  R
M
THR
THR
M
THR
RTHTH RST
VR
-RRS
T
VR
XXR         (2. 10) 
令
M
THR
RTHTH T
VR
XXRa
2
22 )(  、
M
THR
THR T
VR
-RRb
2
2 、 2RRc  、 ac-bΔ 42  
其中 ωS 1  
從(2.10)式，可得到兩個解： 
a
Δb-ω
2
10
                                                   (2. 11) 
a
Δb-ωcrit 2
-1                                                   (2. 12) 
為求得感應發電機的臨界清除時間，將(2.9)式移項做積分，轉速從 0 積分
到 critω ，時間從 0t 積分到 critt ： 
  critcrit tt EMωω R dt-TTHdω 00 )(21                                       (2. 13) 
  21
A
MT
)( critω臨界轉速
B
C
)( ct故障清除
)( 0t故障發生
 
圖 2-21 感應發電機轉子轉速能恢復穩定的情況[11] 
)( ct故障清除
)( 0t故障發生
)( critω臨界轉速
 
圖 2-22 感應發電機轉子轉速無法恢復穩定的情況[11] 
  23
來度過故障時期，並比較各方法的優缺點。Digsilent 軟體提供了許多內建模組
(build-in model)，例如 DQ 轉換控制方塊、感應發電機模組，而雙饋式感應發電
機的內部控制則需要使用者自訂模組(DSL model)來建構，再經由內外層的相互
關係達成控制內建模組的控制信號。 
 
圖 3-1 轉差功率轉換發電機組架構[12] 
RSC GSC
Grid
RS
C
GS
C
RSC GSC+
-
+
-
RSC GSC
DFIG連接chopper保護裝置
DFIG連接轉子電阻保護裝置
雙饋式感應發電機
Crowbar保護裝置  
圖 3-2 雙饋式感應發電機及各種提高低電壓忍受能力方法示意圖[13] 
模擬架構 
風場為 200台 1.5MW的雙饋式感應發電機(DFIG)經由 690V/33KV連接到集
電場，由 3 公里的海底電纜(33KV)連接到台灣本島，再經由 5120MVA 的
33KV/161KV 變壓器及並行的 5km 架空電纜連結到匯流排，再經由
161KV/345KV 連接到匯流排彰濱 E(Bus2300)。匯流排端以 18340MVA、X/R=37
  25
 
圖 3-4 雙饋式感應發電機故障動態響應[13] 
 (1.發電機端電壓,接地點端電壓 2.發電機輸出實虛功) 
 
圖 3-5 雙饋式感應發電機故障動態響應[13] 
(1.DC_bus 電壓 2.轉子電流) 
  27
本模擬依表 3-2 設定的保護電驛，分別畫出各低電壓忍受能力改善方法的忍
受曲線，如圖 3-7 所示。 
 
圖 3-7 各低電壓忍受能力改善方法的忍受能力曲線[13] 
 (NO：無使用任何方法；Rr：增加轉子阻抗；Grid code：台電公司對風力發電
機忍受能力要求[15]) 
由圖 3-7 可以發現，當未加入任何低電壓忍受能力改善方法時，在低電壓時
故障會使風機因保護電驛而跳脫。各種改善方法都能夠讓雙饋式感應發電機的低
電壓忍受能力增強，尤其當同時使用三種控制方法的時候能夠在風機端點直接接
地故障持續 0.7 秒不跳脫。故障的壓降程度決定 DC_bus 電驛與轉子電流的嚴重
程度，而轉速與故障時間較有關係。在低電壓短持續時間時，造成風機跳脫的原
因為 DC_bus 過電壓及轉子電流過高，持續的時間越長才會有轉子轉速超過上限
的問題。故障發生時有額外轉子電阻設備，能夠些微的降低 DC_bus 電壓以及轉
子電流，使得在壓降低到 0.1p.u.並持續 0.5 秒時，還能夠不至於跳脫。截波器則
能夠完全保持 DC_bus 電壓不會有波動超過上下限，確保 DC_bus 電壓保護電驛
不會觸發而導致風機跳脫，與完全無保護裝置的情況比較，在壓降為 0.3p.u.持續
0.5 秒的故障情況有更好的忍受能力。消弧電路是隔絕掉轉子側轉換器，因此也
能保證 DC_bus 電驛不至於被觸發，另外也有轉子阻抗來減低轉子電流。因此能
讓因為 DC_bus 電壓電驛及轉子電流保護電驛跳脫的故障情況安全度過。這些獨
自使用的方法都有其缺點存在。利用增加轉子阻抗無法在電壓降至 0p.u.時保持
DC_bus 電壓與轉子電流在安全的範圍內；利用截波器無法降低轉子電流及消耗
實功率來保持轉子電流與轉子轉速在額定範圍內；而利用消弧電路雖能隔絕轉子
側轉換器以確保 DC_bus 電壓在額定值，但卻未必能將轉子電流壓低到安全值，
並且失去控制實虛功的能力，將會吸收虛功而使風機端點電壓更為下降。使用
combine(三種方法同時使用)改善方法，除了能夠確保 DC_bus 電壓電驛不被觸
發，也較能夠降低轉子電流，在極低電壓(0p.u.)也能夠不使風機跳脫。 
討論 
本研究模擬風場連接電力系統發生不同的低電壓情況使用各種低電壓忍受
能力改善方法來模擬，以評估不同改善方法對雙饋式感應發電機忍受能力的提升
  29
在 2.2.2 小節內容中，可投切式電容器與有載分接頭切換器之調整次數隨著
分散式電源容量的增加而降低，表示分散式電源的併入有助於改善控制設備的調
整次數。並且當增加分散式電源併聯容量時，有載分接頭切換器為避免併聯分散
式電源之饋線產生過電壓問題必須降低二次側電壓，反而造成鄰近饋線會有欠電
壓問題。因此系統裝設線路電壓調整器來針對併聯分散式電源之饋線調節電壓，
以讓分散式電源之併聯容量能提升，由此可知適當的調整配電系統電壓控制設
備，可有效增加分散式電源併入容量。3.3.3 小節內亦有一數值分析模擬案例，
顯示整合電壓調整設備控制策略使得可併入配電系統的分散式電源容量較沒有
搭配整合電壓調整設備控制策略為高，在配電系統負載為輕載狀況時，分散式電
源併聯容量由 11.9MW 提升為 14.3MW；在配電系統負載為重載狀況時，分散式
電源併聯容量由 14.4MW 提升為 23.6MW。 
3.3 以配電饋線重組提高分散式電源併聯容量 
3.3.1 饋線重組之限制條件 
為避免電力系統在電力不穩定或不安全的狀態下運轉，饋線重組的運用必須
遵守設備承受的容量及電力相關安全協定。配電系統之設備標明的安全運轉容量
與對應規格皆屬於饋線重組之限制條件，我們將限制條件整理項目如下： 
 保持功率供需平衡 
 輸送功率不得超過線路額定容量 
 傳輸電流不得大於線路額定電流 
 匯流排電壓必須保持在電壓容忍範圍內 
 饋線型態必須為常開環路式饋線 
 所有負載必須有電可用 
 利用 LDC 法之控制設備至電壓參考點間的切換開關必須保持關閉狀態 
饋線若含運用 LDC 法之控制設備，設備至設備間的切換開關必須保持關
上。以線路電壓調整器而言，若該調整設備是利用 LDC 法為操作準則，其線路
壓降調整器依據推估的電壓參考點電壓值做二次側分接頭的調整，以改善設備下
游的饋線電壓。LDC 法推估的調整點電壓公式中，流經設備的實虛功及裝設點
電壓值為重要的影響因素，若任意打開在電壓調整設備到推估點間的開關，很有
可能會造成分接頭誤動作，降低整體饋線電壓品質。 
3.3.2 以粒子群演算法求解饋線重組問題[7] 
饋線開關非開則關，是屬於 0 與 1 的離散組合，饋線重組的過程中，若將所
有開關皆列為變數，則所選取的粒子元素為整數。利用 PSO 演算法求解整數規
劃問題時，由於演算式的權重因子 ω 及學習因子 c1與 c2並不一定為整數，使得
演化過程常會出現包含小數點等細密的結果，使得計算結果無法運用於離散分配
的例子。為使 PSO 之結果呈現整數值，只需保證在演化過程中，疊代的適應速
度為整數，就能保證演化過程為整數運算。 
為使 PSO 演算法適用於整數規劃，必須稍做一些限制條件。將
  31
3. 每粒子符合饋線限制條件(3-3-2 章節內)之架構則進行步驟 4，否則將不符合條
件之粒子重新篩選至符合限制條件。 
4. 計算每個粒子之適應函數值。 
a. 執行負載潮流及運用控制設備調整電壓。 
b. 若各匯流排電壓及電纜電流於容忍範圍內，則進行步驟 c，否則進入步驟
d。 
c. 增加分散式電源單位併聯容量(0.1 MW)並返回 a。 
d. 紀錄分散式電源最大併聯容量。 
- 若未併聯分散式電源即讓系統電壓與電流於容忍範圍外，則併聯容量紀
錄為 0，否則降低單位容量並紀錄該值。 
5. 選取每個粒子之 pbest。 
- 若未經疊代，則每個初始粒子之位置為 pbest。 
- 將疊代前與後之粒子做適應函數值之比較，選擇結果較佳的位置更新
pbest。 
6. 針對各粒子之 pbest 計算適應值並做比較，選擇結果最佳的位置更新 gbest。 
7. 根據整數規劃之 PSO 演化方程式(式 3-5 及式 3-6)對每個粒子的速度與位置進
行更新。 
8. 若未達到結束條件(通常為足夠好的適應值或者預設定的最大疊代次數)，則濾
除不合饋線限制條件之粒子並返回步驟 4。 
PSO 演算法以隨機的方式選取的饋線架構有可能不符合饋線重組所要求的
限制條件而得到錯誤的適應值，使得演算法求得的解有問題，因此選取過程中必
須先濾除不適當的解以提升運算效能及避免誤判的情形。圖 3-9 為本研究在求解
最佳饋線架構以達成最大併聯容量之流程。 
  33
得併聯容量比較不容易因過電壓而受到限制，因此能提升併聯容量上限。圖 3-10
為系統整合電壓控制搭配饋線重組之最佳饋線架構，其分散式電源的最大併聯容
量能達 18.7 MW，主要的差別在於將鄰近饋線負載轉供至併聯分散式電源的饋線
外，還能藉由線路電壓調整器調節電壓問題，因此能提升分散式電源的最大容量。  
在表 3-3 顯示系統於重載時段之分散式電源最大併聯容量受限於電纜所能
承載之最大容量，因此模擬結果無法突顯出饋線重組整合電壓控制之效益。假若
能提升電纜之最大承載電流，則能併聯更多分散式電源容量於系統中。 
 
圖 3-10 最佳解之饋線架構[7] 
表 3-3 各架構於輕重載搭配控制方式之分散式電源最大容量值(MW) 
 輕載時段 重載時段 
原始架構 11.9 14.4 
饋線重組 15.3 17.7 
電壓整合 
(加入 VR) 14.3 23.6 
饋線重組 
整合電壓控制 18.7 23.6 
3.4 多代理人系統在含分散式電源之配電饋線運轉應用 
3.4.1 多代理人系統簡介[16, 17] 
智慧型代理人(Intelligent Agent, IA)是一種具自動化機制的軟體程式，若在接
受命令與可執行環境相符合時便能自動完成一些我們想要做的工作，而且能做出
合適的動作以及回應，重要的是整個執行的過程不需要使用者介入。此系統已具
有相當的自主能力，能夠以人類行為做溝通、處理、協調、辯論，再做出判斷，
  35
代理人間的通訊機制 
JADE 代理人平台提供的一個重要特點就是通訊能力。它採用非同步訊息傳
輸，每一個代理人有一個訊息佇列，JADE 運行時用它儲存由其它代理人發送的
訊息。無論什麼時候只要有訊息被傳遞到佇列，接收的本體就將被告知。如圖 
3-12 所示，代理人 A1 透過 JADE 平台傳送訊息給代理人 A2，A2 的訊息佇列在
接受到 A1 送來的訊息時 A2 被告知有訊息傳入並處理訊息。 
A1
Prepare the 
message for A2
Send the message
Distributed JADE run-time
A2
Get the message
 from the message 
queue and process it 
Post the message in
A2’s message queue 
 
圖 3-12 代理人之間的訊息傳遞[20] 
圖 3-13 描述一個通用代理人訊息處理模組，說明其實作過程。 
代理人的訊息處理過程可描述為以下幾個步驟: 
1. 接收自外部代理人傳送來的訊息。 
2. 分析訊息的內容，確定執行模組和所需資訊。 
3. 從公用資訊區提取所需資訊。 
4. 在知識庫的推論引導下，執行當前任務。 
5. 如果執行過程中，需要與其它代理人進行協助，則向其它代理人發 
  送請求協助訊息。 
6. 如果執行任務完成，則將資料寫入到公用資訊區中，向外部代理人 
  發送任務完成訊息。 
7. 如果任務執行失敗，則向外部代理人發送任務失敗訊息。 
 
 
圖 3-13 代理人訊息處理的工作過程[21] 
  37
 
圖 3-14 配電架構及相對應之代理人[8] 
在以多代理人系統進行故障偵測及隔離的過程中，首先將因流經故障電流而
跳脫之 CB 的訊息傳遞給 MTR 代理人，由 MTR 代理人判斷故障是發生在哪一
條饋線上，再由該條饋線往下游尋找故障區間。在判斷故障區間的過程中第 n
個 FTU 代理人將訊息傳給第 n+1 個 FTU 代理人，再由本研究建議的電流差法判
斷故障是否發生在第 n 個與第 n+1 個代理人之間，如果是則將第 n 與 n+1 個代
理人所屬的自動化開關打開，如果不是則將訊息傳給下游第 n+2 個代理人繼續判
斷；若第 n 個 FTU 是位於最靠近分歧點上游的 FTU，則需將最靠近分歧點下游
的各分支 FTU 訊息傳給第 n 個 FTU 去判斷故障是發生在分歧區或者是哪一條分
支下游。 
3.4.2 含分散式能源之故障偵測及復電程序判斷規則[8] 
以下為本研究在整合電流差法與分散式能源於故障偵測、隔離與復電所整理
出之判斷與運轉規則: 
故障偵測[8] 
規則 1. 檢測故障饋線 
   如果  流過最大電流的 CB 跳脫   
   則    檢測其下游 FTU 間有無分支(規則 2) 
   否則  繼續檢測故障饋線(規則 1) 
規則 2. 檢測下游有無分支 
  39
           (若有多條支援饋線則選取其中裕度最大的) 
    則    投入常開開關復電 
    則  求出支援饋線所能承接之部分負載並執行切除無法 
            轉供之負載(規則 11) 
規則 11. 求出支援饋線所能承接之部分負載並執行切除無法轉供負 
        載        
    如果  可切離負載並由支援饋線進行轉供 
    則    投入常開開關復電並檢測有無它條支援饋線(12) 
    否則  放棄復電 
規則 12. 檢測有無它條支援饋線 
    如果   有另一條支援饋線可復電 
    則     檢測支援饋線與該饋線主變之裕度(規則 10) 
    否則   放棄復電 
以分散式電源協助復電[8] 
規則 13. 是否有未復電區 
    如果  有未復電區 
    則    檢測故障區下游是否有 DG(規則 14) 
    否則  結束復電   
規則 14. 檢測故障區下游是否有 DG 
    如果  有 DG 
    則    檢視 DG 位置(規則 15) 
    否則  結束復電 
規則 15. 檢視 DG 位置 
    如果  DG 在已復電區 
    則    DG 配合支援饋線復電(規則 16) 
    否則  DG 孤島運轉(規則 17)  
規則 16.  DG 配合支援饋線復電 
    如果  DG 裕度與支援饋線剩餘裕度總合大於全部或者部份 
          未復電區負載 
    則    進行 DG 復電 
    否則  不投入 DG 復電 
規則 17. 計畫性 DG 孤島運轉 
    如果  DG 裕度能提供全部或者部份未復電區負載 
    則    DG 進行孤島運轉 
    否則  不投入 DG 復電 
其中  FTU(n):指饋線上第 n 個 FTU 
      FTU(up):指最靠近分歧上游的 FTU 
  41
 
(a)主動回報通訊方式 
 
(b)待輪詢回報通訊方式 
圖 3-15 系統狀態變化回報方式                  
2. 多代理人系統功能及資料傳輸流程 
本節說明如何將多代理人系統應用在故障發生後的 FDIR 流程，首先利用本
論文提出的電流差法找出故障發生地點並將之隔離，接著執行非故障區的復電。
在判斷故障地點時，因流經故障電流而跳脫的 CB 會經由所屬的 FCB Agent 自動
將訊息回報給 MTR Agent，再由 MTR Agent 判斷故障是發生在那一條饋線下游，
再由此條饋線往下游尋找故障是發生在哪個區段。尋找故障區間的過程中第 n
個 FTU會將訊息傳給第 n+1個 FTU去判斷故障是否在第 n個 FTU與 n+1個 FTU
之間；若第 n 個 FTU 是位於最靠近分歧點上游的 FTU，則需將最靠近分歧點下
游的各分支 FTU 訊息傳給第 n 個 FTU 去判斷故障是發生在分歧區或者是哪一條
分支下游。當找到故障區間後便將此區間的上下游開關打開隔離故障。 
3. 領導代理人[16] 
在以多代理人方式復電之前，首先需找出復電的領導代理人，而復電領導代
理人的找法可分為兩種: 
1.故障發生在非分歧區， 
2.故障發生在分歧區。 
如果故障發生在非分歧區時，則以隔離故障區的上下游 FTU 代理人中選擇
靠近常開開關(轉供開關)的 FTU 代理人作為領導代理人，如圖 3-16(a)所示；若
故障發生在分歧區時則以各分支的上游也就是分歧點上游靠近分歧點的 FTU 代
理人作為領導代理人，如圖 3-16(b)所示。定義領導代理人主要是為了在復電流
程時可以清楚的知道是以哪一個代理人來領導整個復電流程，而領導代理人也盡
量定義在靠近故障區下游以節省資料傳輸的時間以及方便執行復電動作。 
  43
5. 以多代理人處理饋線事故之完整流程範例[8] 
以下將以圖 3-18 為例說明如何以多代理人執行 FDIR，其中所規劃的 agent
之間是如何溝通找出故障點並將之隔離以執行復電程序，假設故障發生在 SW9
與 SW10 之間且各個支援饋線均能提供足夠的裕度復電，各代理人的動作時序圖
如圖 3-19 所示及程序和規則分述如下: 
S1 S2 S3
S4 S5 S6 S7 S8
S9 S10 S11 S12
MTR1
MTR2
MTR3
MTR4
:常閉開關
:常開開關
MTR1 agent FCB11 agent FTU1 agent
光纖通訊線(DNP3.0)
FTU2 agent FTU3 agent FCB21 agent MTR2 agent
FCB12 agent FTU4 agent FTU5 agent FTU6 agent FTU7 agent FTU8 agent FCB31 agent MTR3 agent
FTU9 agent FTU10 agent FTU11 agent FTU12 agent FCB41 agent MTR4 agent
MTR:主變壓器
FCB:饋線電流斷路器
FTU:饋線末端單元
Fault
變電所1
變電所2
變電所3
變電所4
FCB11 FCB21
FCB12 FCB31
FCB41
 
圖 3-18 應用於饋線事故處理之分散式多代理人系統[8] 
 
(a) 
  45
經由規則 2(檢測下游有無分支)判斷得知 FTU9 下游無分歧點， 
故將 FTU9 的故障電流大小與旗標狀態傳送給 FTU10 agent。 
經由規則 5(檢測故障區間(1))判斷得知故障發生在 FTU9 與   
FTU10 之間。 
程序 8 
FTU10 通知 FTU9 將 SW9 打開以隔離故障。 
程序 9  
FTU9 通知 FTU10 以將 SW9 打開。 
程序 10 
經由領導代理人邏輯判斷原則命令 FTU10 為領導代理人，FTU10 
命令 FCB12 投入以恢復上游負載復電。經由規則 8(檢測是否有 
支援饋線復電)得知有相連接之支援饋線，開始往下游尋找常開 
開關(FTU11)並命令 FTU11 為次領導代理人，接著詢問與常開開 
關相連之支援饋線裕度以及停電負載。 
程序 11 
當 FTU11 收集到 MTR4 與 FCB41 回傳訊息告知可提供之裕度， 
以及故障點下游停電的負載量後，經由規則 10(檢測支援饋線與該 
饋線主變之裕度)判斷有足夠的裕度支援停電負載後命令 FTU11 
打開開關 SW11 完成下游復電。 
3.5 配電系統狀態估計應用 
為強化配電系統的效率及可靠度，配電管理系統已逐漸被用來監測及控制配
電系統。配電狀態估計有助於配電管理系統執行有效的系統運轉策略及負載管理
以協助改善電壓品質及復電調度，降低系統損失及網路壅塞情形。為了使系統即
時狀態更準確，必須依賴於先進讀錶基礎建設系統 (Advanced Metering 
Infrastructure, AMI)、饋線終點單元(Feeder terminal unit, FTU)及變電所之資料擷
取與監控系統(Supervisory Control and Data Acquisition, SCADA)，來獲得系統之
即時電壓、電流、實功、虛功及開關狀態等量測資料。在取得資料後，處理這些
量測資料，同時對資料進行有效管理，除可提供用戶了解用電情況外亦可提供其
他電力管理資訊系統使用。由於資料往往存在著不確定性，因此在狀態估計的結
果之後，必須進行錯誤資料偵測(Bad data detection, BDD)，將錯誤的資料抓到並
且刪除該資料，以達到系統更正確的即時狀態。AMI 主要的功能是對用戶用電
狀態進行量測及監視，包括用戶用電資料及電力品質資料，電力公司亦可依照發
展願景的實際需要，利用 AMI 系統提供的資料管理及通訊能力，協助系統電壓
及電力負載潮流運轉調度，並支援時間及動態電價機制，以達需量反應的功能。 
在配電管理系統(DMS)中，狀態估計(SE)係指根據系統中測量儀表所測量出
之匯流排之電壓值，或注入之電流，或預測之負載以及傳輸線上之電力潮流等諸
多測量值，來估計系統目前最可能之狀態[23-27]；此一狀態估計問題，可以被公
式化成一個加權最小平方(Weighted Least Square, WLS)的最佳化問題，並以疊代
  47
其中 
ZR ˆ :測量值估計之共變異矩陣 
H:賈可比矩陣 
G:增益矩陣 
因此測量剩餘值之共變異矩陣則為 
zzr RRR ˆˆ                                                        (3. 5) 
其中， rR ˆ :測量剩餘值之共變異矩陣，所以 rn 之定義如式(3.6)： 
 rn RdiagZr ˆ/ˆ                                                  (3. 6) 
其中， Z :測量值減去估計值 
   nrˆ :歸一化測量剩餘值 
 
圖 3-21 三相狀態估計(SE)程式 
 
 
  49
戶，若只有一個異常用戶，則由注入匯流排的負載值減去其它正常用戶同時段的
負載，即可推算出該異常用戶應有的負載量；若有多個異常用戶時，則以歷史基
準線資料(baseline)經由比例分配方式估算出用戶的負載，藉此達到資料驗證和估
計的工作。圖 3-23 描述用戶用電資料之檢測，讀取該異常匯流排下某一用戶於
異常時段的 AMI 量測資料與該用戶同時段的歷史資料來進行隨機區組設計
(Randomized block designs)[43]。該方法主要是在分析兩組以上的資料，而其分析
的程序稱為變異數分析(Analysis of variance, ANOVA)，其分析的目的是檢測不同
組資料之間是否存在差異性。在隨機區組設計中，總變異(Sum of squares total, 
SST)包含三種成分，分別為區組之間的變異數(Among-Group Variation, SSA)、區
集之間的變異(Among-Block Variation, SSBL)、隨機誤差變異(Random Variation, 
SSE)，因此，SST=SSA+SSBL+SSE。 
其中，    )( 1 1
2
1 1 rc
X
XXXSST
c
j
r
i
ijc
j
r
i
ij
  
 
 ，
                                
(3. 7) 
    
   )( 1.
2
1
. r
X
XXXrSSA
r
i
ij
j
c
j
j
 

 ，
                                    
(3. 8) 
    
   )( 1.
2
1
. c
X
XXXcSSBL
c
j
ij
i
r
i
i
 

 ，
                                    
(3. 9)
 
      
2
1 1
.. )(
 

c
j
r
i
ijij XXXXSSE
                                     
(3. 10)
 
其中，r 指資料的列數，c 指資料的行數，Xij 代表在第 i 小時第 j 電表或基準
線之匯流排需量。經變異數分析完後的結果以 ANOVA 總結的表呈現，如表 3-4，
該表中的 F 統計量(FSTAT)是伴隨著 F 分佈，且根據 r-1 或 c-1 的分子自由度(v1)以
及(r-1)(c-1)的分母自由度(v2)計算得來的，式(3.11)顯示該分佈的機率密度函數。 
2
2
121
1
2
2
2
121
21
1
1
1
22
2
)( 










 









 

x
x
xf                                          (3.11) 
其中為 gamma 函數，表示為   0 1)( dtetx tx ，v1 和 v2 分別為分子和分母的自由
度。P 值代表大於 F 統計量之機率，且表示為 
 STATF0STAT  )(-1)FP(F dxxfvalueP                            (3.12) 
  51
2
STAT
 
圖 3-23 用戶資料驗證及修補之流程圖 
 
圖 3-24 判斷異常用戶之流程圖 
3.5.2三相狀態估計錯誤資料偵測範例模擬 
考慮圖 3-25 所示有 6 個匯流排(bus)之簡易饋線(feeder)，除了參考匯流排之
外，其餘 5 個負載匯流排均經由配電變壓器供電予其供電區域內各個用戶，並假
設該饋線出口端，加入一個實/虛功潮流的量測值，其 abc 三相實功率測量值為
(4.9007, 5.4716, 5.7831) pu，其 abc 三相虛功率測量值為(1.0572, 1.0630, 1.2252) 
  53
bus3-bus4_Qflow 0.2977 0.3716 0.319 0.008049 0.007584 0.002261
bus3-bus6_Qflow 0.1016 0.1229 0.0911 0.020184 0.02431 0.013338
bus3_voltage 0.8584 0.8414 0.8356 0 0.007824 0.007061
本例之自由度為 24（=60-36）、若以 95%為信賴水準（亦即有 5%之錯誤警
報之機率），則經查 2 表可得偵測臨限值 415362STATχ . ，以圖 3-22 執行狀態估
計程式，由結果可求得性能指標 2STATχˆ 01810  .)xJ( ，表示測量值中沒有錯誤資料之
存在，所以程式輸出的結果符合信賴水準 95%之三相狀態估計值[27]。 
範例模擬(二)： 
表 3-6 同樣列出 bus 1 的電壓大小角度測量值、各節點的負載測量值以及
P&Q branch flow 的測量值。此範例探討的除了 bus1 (Slack bus)之外的五個節點
上的負載量，其中有某一個節點為異常的資料(異常資料為 bus4 之 b 相負載，由
-1.0 改成-1.5)，觀察錯誤資料偵測是否有辦法偵測並辨識異常資料，將異常資料
予以刪除後，再執行三相狀態估計程式，得出饋線上各節點的狀態。 
表 3-6 單一錯誤資料之偵測 
Meas. type 
Measurements (pu) Normalized residuals ( nrˆ ) 
phase a phase b phase c phase a phase b phase c 
bus1_phase 0 4.18879 2.094395 0 0 0 
bus2_Pinj -1 -1.3 -1.2 0.820259 54.38657 3.860502
bus3_Pinj -1.5 -1.4 -1.75 0.919875 53.56109 0.504134
bus4_Pinj -0.7 -1.5 -1.1 0.458336 184.5981 1.209689
bus5_Pinj -0.68 -0.54 -0.55 0.031959 184.5867 1.617615
bus6_Pinj -0.36 -0.42 -0.3 0.118555 19.74111 0.04 
bus1-bus2_Pflow 4.9007 5.4716 5.7831 0.480127 15.15018 3.367428
bus3-bus4_Pflow 1.4377 1.6117 1.724 0.094312 110.3588 2.97056 
bus3-bus6_Pflow 0.3659 0.4276 0.3036 0.210671 20.71112 0.007176
bus1-bus2_current 5.0135 5.5739 5.9115 1.236433 14.16263 2.08285 
bus1_voltage 1 1 1 0 0 0 
bus2_Qinj -0.21 -0.13 -0.19 3.988944 0.311089 1.200749
bus3_Qinj -0.26 -0.22 -0.32 2.558977 4.56085 4.246072
bus4_Qinj -0.08 -0.17 -0.16 2.603707 3.151557 2.956885
bus5_Qinj -0.2 -0.18 -0.13 2.87768 5.492317 3.167074
bus6_Qinj -0.1 -0.12 -0.09 0.370436 1.458496 1.086974
bus1-bus2_Qflow 1.0572 1.063 1.2252 5.231782 7.417158 8.68089 
bus3-bus4_Qflow 0.2977 0.3716 0.319 4.939332 5.667375 5.09625 
bus3-bus6_Qflow 0.1016 0.1229 0.0911 0.462045 1.757719 1.131681
bus3_voltage 0.8584 0.8414 0.8356 0 0.802687 0.277881
 
  55
5 -1.0959 238.9730 117.7931 -1.0831 238.9343 117.8498 
6 -0.8848 239.0239 118.3171 -0.8695 238.9754 118.3579 
表 3-10 刪除異常資料後電壓角度與 Base case 比較 
Bus No. 
電壓角度(degree) (Base case) 電壓角度(degree) (無異常資料) 
phase a phase b phase c phase a phase b phase c 
1 0.0000 240.0000 120.0000 0.0000 240.0000 120.0000 
2 -0.3283 239.5440 119.3265 -0.3283 239.5440 119.3265 
3 -0.8822 239.1191 118.3255 -0.8822 239.1191 118.3256 
4 -1.0377 238.9676 117.8501 -1.0377 238.9675 117.8502 
5 -1.0959 238.9730 117.7931 -1.0959 238.9729 117.7932 
6 -0.8848 239.0239 118.3171 -0.8848 239.0239 118.3172 
3.5.3 智慧電表量測資料在用電異常偵測之模擬 
本節使用修正型 IEEE 11 匯流排系統模擬負載端有非技術性損失之情況。圖 
3-26 中假設匯流排 2 和匯流排 6 為四路開關，具有 SCADA 電壓及線流(實功和
虛功)測量值，每個匯流排上之電壓可由 AMI 系統獲得，這些量測值可提供給狀
態估計程式，藉由最大歸一化剩餘值(NR)判定異常用電位置(變壓器)，再利用多
變量分析並結合各個用戶的基準線，來判斷該變壓器底下之所有用戶，最後將異
常用戶之負載進行修正。 
 
圖 3-26 系統架構圖 
假設匯流排 3(c 相)之某商業用戶以及匯流排 11(a 相)之某家庭用戶的 AMI
用電量測資料異常，並假設其實際用電型態與以往相近(案例 1)。由變電所之饋
線終點單元量測到該饋線的實際負載顯示於圖 3-27 (藍色線)，而圖中紅色線代
表負載端由 AMI 量測到所有用戶負載之總和。在正常情況下，該兩條曲線之差
異只有饋線上損失的量，但 a 相於 17 點至 24 點以及 c 相於 12 點至 19 點的值若
減去饋線上損失仍會有不匹配量之存在，此為非技術性損失所造成。 
  57
在資料檢測之前要先給定顯著水準 α(例如: α=0.05)，表 3-13 上部份和下部
份分別顯示當用電資料正常以及異常時與其基準線資料檢定後的結果。由該表上
部份可看出當用戶用電需量是正常時，其統計量 FSTAT (1.243)會小於臨界值 Fα 
(3.0725)且 p-value 會大於事先給定的顯著水準 α (0.05)，因此我們將接受虛無假
設，並且有 95%信賴水準推論出該用戶之 AMI 量測資料與其基準線資料是沒有
顯著差異存在；若用戶用電需量是異常時，則由下半部份之結果可知統計量 FSTAT 
(67.23)將會大於臨界值 Fα (3.0725)且 p-value 小於 0.05，此時就會拒絕虛無假設，
並推論出檢定的資料之間是存在差異的。 
表 3-13 變異數分析之結果 
 
接下來必須進一步確認到底是哪一對資料才有差異的存在，因此將檢測的資
料來執行多重比較，其結果顯示於表 3-14，該表中之平均差異(“variation in mean”)
是指將表 3-12 中最後一列所計算的每行/組資料之樣本平均，計算每組的樣本平
均差值，而臨界值可由
r
MSEQ 計算得到，由表中可知 Data set 1_B-2、Data set 
1_B-3 和 Data set 1_B-4 之平均差異皆大於臨界值 (5.1409)，暗示著 Data set 
1_B(AMI 異常用電需量)與其它行/組資料(基準線資料)有顯著的差異。 
表 3-14 多重比較之結果 
 
多重比較之結果亦可由圖 3-28 得知，該圖的列代表各行/組資料之樣本平
均，行代表檢測的四行/組資料，因此圖中藍色圓圈即為第一行/組資料(AMI 異常
用電需量 )樣本平均 (11.6043)，而該線段是指該行 /組資料之信賴區間，由
 nStX 2/ 計算得知，其中 X 是樣本平均，S 是樣本標準差，n 指樣本數量，
 為顯著水準，而 2/t 是根據 t 分佈伴隨著 n-1 自由度且右尾機率值為 2/ 時所
查到的臨界值。如果 假設為 0.05，則我們可以下一個結論，在 95%信賴水準下，
該行/組資料之母體平均會落在該區間之內。從圖中可明確看出基準線資料的信
賴區間彼此之間都有交集，代表著它們是沒有顯著的差異，相反地，AMI 量測
資料之樣本平均明顯的小於其它基準線資料之樣本平均且其信賴區間彼此都沒
  59
電費，但使用狀態估計的方法，則才少收了 1.9416 度的電費。 
表 3-15 各曲線之總負載需量差異(案例 1) 
 
採用狀態估計之程序的優點，主要是在於它是藉由當時饋線上之潮流值，來
判斷上下游之間是否存在不匹配量，而不是直接利用過去的資料來填補，因此其
表現程度會比較佳，由以下的案例，更能確立使用狀態估計之程序的好處。案例
2 假設在匯流排 3 與匯流排 11 有異常資料發生，但用戶當日負載曲線之型態比
以往增加 10% (案例 2)，如圖 3-31、圖 3-32 黃色曲線所示；紫色曲線同樣是該
用戶的基準線；而黑色曲線則是分別以其基準線之 10%和 5%產生之後，再考慮
用戶當天的負載增加了 10%，以此做為該用戶實際負載曲線；藍色曲線同樣是以
狀態估計之程序估計出來該用戶應呈現的負載曲線。 
0 5 10 15 20 25
0
10
20
30
40
50
60
70
80
90
100
Time (hr)
D
em
an
d 
(k
W
)
 
 
measured load curve
Anomalous load curve
baseline(±10% difference)
SE based load curve
 
圖 3-31 匯流排 3 之商業用戶模擬結果(案例 2) 
0 5 10 15 20 25
0
1
2
3
4
5
6
7
8
9
10
Time (hr)
D
em
an
d 
(k
W
)
 
 
measured load curve
Anomalous load curve
baseline(±5% difference)
SE based load curve
 
圖 3-32 匯流排 11 之家庭用戶模擬結果(案例 2) 
由表 3-16 可明確得知，若該用戶當天實際用電量與以往不同，此時若仍以
基準線資料來填補異常時段之資料則將會造成更大非技術損失，以匯流排 3 之商
業用戶來說明，將會造成電力公司少收 120.9348 度的電費，但若採用狀態估計
之程序，則只會少收取 1.1704 度的電費，如此將更凸顯出使用狀態估計的好處。 
表 3-16 各曲線之總負載需量差異(Case 2) 
 
  61
 
圖 4-1 電池種類 
 
圖 4-2 電池在電力系統上的應用 
電池等效電路[32] 
電池模型的建立，主要是有利於電路模擬的計算與分析，一個好的模型，應
具備能模擬實際狀況的能力。 
一般在分析電池電特性時，通常將電池視為一理想的電壓源，也就是輸出電
壓保持不變。然而電池內部化學材料特性易受多種因素的影響，使得電池並不是
單純的電壓源。因此，不管是欲設計準確的電池電容量檢測方法，或是欲建構正
確的電池模型，必須將電池的自放電現象、電池內電阻、因變換電流輸出狀態而
變動的閉迴路電壓值、溫度的影響等因素考慮進去。 
電池進行放電動作時，電池的端電壓並不會保持定值，以定電流放電為例，
電池的端電壓會持續下降。當系統對於電池端電壓漂移的容忍度低時，用簡單的
電池模型做電路模擬時，就無法看出真正的問題。但若使用一能完整、真實呈現
電池特性的模型，就可以針對真實的問題作預先的防範。例如，可以預先在電池
端電壓的兩端加上穩態電路。 
目前等效模型上，有幾種電池模型較常被人們所採用，分別為理想模型、線
性模型、戴維寧等效模型等模型[32, 33]。 
  63
型，但仍未考慮電池自放電的現象，以及溫度對電池特性的影響。 
 
圖 4-5 電池戴維寧等效模型 
電池模擬 
Matlab Simpower System 內建電池的儲能模組[34, 35]，只要經由實際的參數
資料設定，就可以模擬出電池的放電特性曲線。Matlab 電池塊實現了一個通用的
動態模型的參數來表示各種型的電池。Matlab 提供了以下幾種電池設定: 
 Lead-Acid 
 Lithium-Ion 
 Nickel-Cadmium 
 Nickel-Metal-Hydride 
Matlab 等效模型如圖 4-6 : 
 
圖 4-6 Matlab Simpower System 內建電池模組[35] 
以 Lithium-Ion 電池為例 
Discharge Model (i* > 0) 
   * *1 0( , , ) . . . . .exp( . )
Q Qf it i t E K t K it A B it
Q it Q it
                      (4. 1) 
 
 
 
 
  65
4.1.2 太陽能光電板 
太陽能電池是一種利用太陽光直接發電的光電半導體，它只要照到光就可由
N 型和 P 型矽上下堆疊而成的半導體材料，並藉由 PN 接面的光伏效應
(Photovoltaic effect)來產生能量，並且根據光電半導體基本定理，入射光子的能
量大於半導體能隙的能量時，此時光子就會被半導體所吸收，價帶（Valence band）
中之電子吸收光子能量之後，被激發至傳導帶（Conduction band），此時電子就
可以在能帶（Band）間任意移動而導電就可以輸出電壓及電流。所謂光伏效應
是指將光源照射半導體介面後，使半導體產生之電子與電洞因接面電場作用，而
互往相反方向移動，造成電荷分離之現象，如圖 4-8 所示。 
 
圖 4-8 太陽能電池光電轉換原理 
太陽能光電板等效電路[36-39] 
當太陽能電池受光子照射而產生光伏效應時，其產生之電流以一個固定電流
產生器 IPV來表示，此電流正比於光照強度，而越過 PN 接面之電子流動則形成
一個跨在接面上的光伏電壓差，其太陽能光電板的等效電路如圖 4-9 所示。若探
究太陽能光電板的發電原理，可將太陽能光電板的輸出視為一個電流源，且太陽
能光電板主要是由很多的光電二極體組成，所以理想的太陽能光電板可以將電流
源並接二極體來表示。如果進一步考慮實際狀況，可以將等效電路輸出端串聯一
個小電阻 Rs 來等效太陽能光電板的內阻。此外，二極體本身必定存在漏電流，
如果再進一步考慮此漏電流，可並聯一個大電阻 Rp 來描述太陽能光電板持續產
生一個微小的漏電流。 
  67
表 4-1 太陽能模板參數 
（參考溫度為 25℃、參考照度為 1000 W/m2） 
符號 單位 符號 單位 
VOC 36.74 V VMAX 30.36 V 
ISC 8.299 A IMAX 7.58 A 
IPV 8.299 A PMAX 230 W 
A 1.3 ns 60 
KV -0.34V/K Ki 0.08 A/K 
利用 MATLAB/Simulink 模擬軟體建構之太陽能模板電路模型，為了驗證此
一模型確實與實際太陽能板之特性相穩合，在固定溫度（25℃）下，改變工作照
度（200、400、600、800、1000W/m2）時之太陽能模組輸出 I-V 及 P-V 曲線如
圖 4-10 所示。 
0
2
4
6
8
10
12
14
16
18
0 50 100 150 200 250 300 350 400 450
1000w/m^2
8000w/m^2
600w/m^2
400w/m^2
 
a. I-V 
V-P
0
1000
2000
3000
4000
5000
6000
0 50 100 150 200 250 300 350 400 450
V
P
1000w/m^2
800w/m^2
600w/m^2
400w/m^2
 
b. P-V 
圖 4-10  太陽能模組輸出 I-V 及 P-V 曲線 
由於單片太陽能模組輸出電壓、電流與功率均不高，因此將 Ns 個太陽能模
組串聯，再將相同的 Np 個串聯模組並聯，則可組成一大型的太陽能光伏陣列
（Photovoltaic array）作為光伏發電之電源系統，其等效電路可由圖 4-9 擴展成
圖 4-11 之模型，而其 V-I 關係式則如： 
  69
燃料電池外，還具備接近常溫操作以及迅速啟動的特性，而且沒有電解液溢散和
腐蝕問題，所以 PEFC 非常適用於運輸動力、可攜式電力，以及家用型發電機。 
PEMFC 發電原理: 
PEMFC 以質導度佳的固態高分子膜為電解質，氫氣為燃料，氧氣為氧化劑，
經電化學作用結合氫氣與氧氣產生電流、水與熱。PEM 的陽極端供給氧氣，並
於 PEM 及觸媒層處進行反應，氫氣分離為，氫離子與電子，氫離子經 PEM 遷
移到陰極，而電子則經由外電路移到陰極；陰極端供給養氣並在陰極處將氫離
子、氧氣及電子結合而形成水，電子循外電路移動即為電流，如圖 4-12 所示。
PEMFC 運轉時，其性能高低是由其工作電壓與電流密度來決定。陰、陽兩極端
之半反應式及總反應式如(4.9)~(4.11)式所示。 
在 PEMFC 的陽極端，氫氣受觸媒的催化而降低活化能，使其解離成氫離子
與電子: 
陽極端半反應式: 2 2 2H H e            (4. 9) 
氫離子通過 PEM 往陰極移動，而電子則經由外電路對外負載做功後移往陰
極。陰極半反應則是氧分子、電子以及氫離子在觸媒的催化下發生還原反應而產
生水: 
陰極端半反應式: 2 2
12 2
2
H e o H o      (4. 10) 
總反應式: 2 2 2
1
2
H o H o                                          (4. 11) 
PEMFC 數學方程式: 
PEMFC 經由熱力學的關係式得其理論的可逆電壓最佳值為 1.23 V，其雖具
有高效率的轉換功能，但仍會因為某些因素造成電池效率的降低，其中包括活化
過電位、濃度過電位及歐姆過電位等因素。PEMFC 單電池其輸出電壓定義如(4.12)
式: 
conohmicactnFC VVVEV                                         (4. 12) 
其中， FCV 為 PEMFC 單電池輸出電壓， nE 為 PEMFC 可逆電壓， actV 活化過
電位，Vohmic 為歐姆過電位，而 Vcon 為濃度過電位。 
可逆電壓 nE  
當燃料電池之能量轉化過程以熱力學上的可逆方式完成稱為可逆燃料電池
(Reversible Fuel Cell)，此時在電極/電解質介面上的電極反應同樣是可逆的，又
稱可逆電壓(Reversible Electrode)，而可逆電極上的電位稱為可逆電壓，基本上可
逆電極反應是一種理想狀態的電極反應，即處在平衡狀態下的電化學反應，本質
  71
 
圖 4-13  質子交換燃料電池等效電路 
 
圖 4-14  質子交換膜及化曲線 
 
圖 4-15  Matlab 模擬及實際量測曲線 
4.2併網之直流微電網動態模擬及運轉特性分析 
4.2.1 直流微電網動態模擬 
一個微電網可以包括部分中/低壓配電系統及由單一或多個 DG 供應的群聚
負載。從運轉的角度來看，一個微電網可以經由責任分界點(PCC)連接到其餘區
域的電力能源系統運轉，而且在與電網連結和獨立電網(Isolated Grid, IG)兩種模
  73
表 4-2  微電網架構中規格與參數 
作系統規格 電壓 功率 功率轉換器電壓 轉換器通訊規格 附註 
太陽能光伏板 0~403V 5kW Modbus(電表) 11 串 2 並 
燃料電池系統 43~67V 3kW 0~400V RS232 
變流器 175kW 0~400V CAN Bus 
電池系統 200V 7Ah 0~400V CAN Bus 12V 7AH 16 串
 
 
圖 4-17  微電網模擬架構 
 
圖 4-18  當 1.5sec 時加載之功率流動現象 
  75
1
2
3
4
 
圖 4-20  微電網模擬架構 
 
圖 4-21  孤島運轉模擬一 
在此模擬二當中 1 sec 時將變流器停止工作，而微電網由市電併聯運轉模式
進入孤島運轉，我們可以發現一開始 PV 注入太陽能板之功率於直流匯流排及
0.8sec 時 fuel cell 也利用電壓下降控制法[42]注入功率至直流匯流排，此時變流
器為了控制直流匯流排的電壓穩定將多餘的功率轉入市電當中，但是當 1 sec 時
P
  77
表 4-3  孤島運轉控制策略 
狀況  
Battery 
system 
PV 
Fuel cell 
system 
變流
器 
負載 
市電中斷時  
電壓控制/
放電 
電流源
併聯 
電壓下降
控制 
停止
工作
滿載 
PV、電池系統故障及市
電中斷 
停止工作 
停止工
作 
電壓控制
停止
工作
等於燃料電池滿載功率 
Fuel cell system 故障及
市電中斷 
電壓控制/
放電 
電流源
併聯 
停止工作
停止
工作
負載功率須≦PV+Battery 功率 
電池系統故障及市電
中斷 
停止工作 
電流源
併聯 
電壓控制
停止
工作
負載功率≦PV+Fuel cell 功率，且
負載需要規劃 
所有功率轉換器均發
生故障  
停止工作 
停止工
作 
停止工作
停止
工作
停止供電 
 
圖 4-23  電壓下降法[42] 
gainseto droopIVV                                               (4. 16) 
在上述的孤島運轉組合中，以電池系統故障及市電中斷為最難以控制的策
略，因為當孤島運轉時，一個電流源並聯一個電壓源將會造成逆向電流的問題，
如圖 4-24 基本電路分析所示 。在此種控制狀態下有兩種方法可以防止逆電流發
生: 
  79
 
圖 4-27  直流電壓波形 
 
圖 4-28  fuel cell 併聯 PV(500w/m2)及負載之功率輸出狀況 
系統中加入高功率二極體防止電流的回灌，此方法可以有效地將較高功率的
PV 電源併入直流匯流排時，防止其所提供的功率逆流入轉換器當中，但是此方
法還是無法控制整個直流匯流排端點電壓的穩定，由圖 4-29 可以發現電壓在 1 
sec 時上升至 365V，但是我們可以由圖 4-30 的功率流動中發現 PV 在照度
1000w/m2 的狀態，因 PV 輸出過多功率造成系統端點電壓提升，且影響到燃料電
池輸出端電壓比系統端電壓低之狀況，此時如果沒有二極體來防止電流流入燃料
電池轉換器，將會使得轉換器損毀。因此在直流微電網中規劃此種併聯運轉時，
利用二極體作為防護，可以保護電源端的機器運轉，但是他還是有缺點，就是當
一個電流源或電流控制源，單獨存在系統當中將會使直流電壓無法控制，因此未
來我們將會將配合開關(breaker)及電驛(relay)，進行直流匯流排的保護，在系統
故障時優先退出某些電源或是斷開負載，建立更加良好的機制。 
360V 
V
Inverter 
PV 
Battery 
Fuel cell 
  81
 
  (a)系統架構圖                 (b)直流微電網實際平台 
圖 4-31  直流微電網架構 
 圖 4-32 為本系統的測試步驟，分散式能源併入微電網時，其功率流動將以
直流匯流排電壓為基準以電壓差方式達到輸出功率大小控制，因此需先確認直流
匯流排端電壓是否為 360V，當分散式能源輸出電壓大於 360V 時，其輸出能源
會先供應負載使用，如有多餘能量將會由轉換器轉為三相交流電壓流回市電端。
相反地，分散式能源能量不足以供應負載使用時，則會向市電端吸取能源供應給
直流電網上的負載使用。 
 首先經由轉換器參數設定可控制直流端電壓為 360V，再將流程圖搭配圖 
4-33 至圖 4-35 之功率紀錄進行說明，如圖 4-34(a)可以觀察出機器啟動到直流
電壓達到 360V 之狀況。接著將儲能式系統啟動併入系統中，圖 4-34(b)所示為
直流端電壓與三相交流端電流變化之狀況。其中 a 相線電流與相電壓波形同相，
表示目前是由市電提供功率，圖 4-33 第 2 區塊亦顯示功率確實是由市電提供且
直流端電壓確實穩定在 360V。 
接著將分散式能源併入系統，在無最大功率追蹤控制最大輸出功率的情況下
將併入太陽光電能系統，但併入系統時需先觀察太陽光電能開路電壓是否大於直
流端電壓，並利用電壓差之觀念來達到功率流動的控制。由圖 4-33 第 3 區塊與
圖 4-34(c)中可以觀察到加入太陽光電能併入系統後的功率與 a 相線電流的變
化，由圖 4-34(c)中觀察出電流與電壓相差 180o 故此時太陽能功率足以提供負載
甚至回送功率至市電端，圖 4-33 第 3 區塊可觀察出，市電端所量測到的功率為
負值。接著將直流負載(1.2kW ~ 2kW)併入系統中，圖 4-34(d)顯示此時直流端電
壓與三相交流端電流變化之狀況，以及搭配圖 4-33 第 4 區塊觀察出流入市電端
之功率減少。直流匯流排電壓受負載變動的影響小，可確定直流端電壓之強壯程
度。將燃料電池啟動後，確認開路電壓是否為 360V 後併入系統，而後慢慢提升
  83
測試步驟 
1
啟動轉換器(PEBB)太陽能(PV)
360V
燃料電池
(fuel cell)
360V?
併入太陽能
進入孤島模式
否
是
否
是 是
否
2
3
併入燃料電池
4
5
儲能式系統併入
(充電模式)
卸載
儲能式系統經由直流匯流
排判斷充電或放電模式
加負載
(1.2kW ~ 2kW)
6
7
8
9
燃料電池關閉
10併入燃料電池
11回復市電併聯模式
當電壓上升至362V
啟動加載機制調壓
 
圖 4-32  直流電網應用測試流程 
  85
 
圖 4-34  相電壓、線電流及直流匯流排電壓波形 
經由上述的交流端量測結果，可以與儲能式系統相互搭配觀察，在系統孤島
前，其儲能系統大多會以充電模式進行浮充，保持電池的電量是充飽的狀態，因
此 可 以 經 由 圖  4-35 區 域 1~6 都 在 進 行 充 電 ， 並 配 合
  87
圖 4-36(d)可以發現電能轉變為正值，開始進行充電。 
本研究所使用的電池組為 12V-7Ah 16 串電池組，充電方式以定電壓充電進
行充電，設定的定電壓充電值為 210V，量測上會有 1~2V 的誤差。 
 
圖 4-35  電池端 DAQ 卡量測記錄(電流正為充電；負為放電) 
  89
第五章 結論 
本研究對含 DG 之配電系統的運轉議題加以研討，主要完成的研究內容含: 
1. 分散式電源對配電饋線運轉影響分析 
1.1 以蒙地卡羅方法模擬含分散式電源之饋線電壓分布 
1.2 因應分散式電源併聯之電壓調整設備控制策略 
1.3 含同步機及感應機之配電饋線故障分析 
1.4 分散式電源對配電系統故障偵測之影響分析 
1.5 感應發電機 ( 含 Full-load Converter Wind Turbine, FCWT 及
Doubly-Fed Induction Generator, DFIG)之低電壓忍受能力分析 
2. 提高分散式電源併聯容量之電網強化策略研究 
2.1 提昇分散式電源低電壓忍受能力研究 
2.2 強化電壓調整設備控制策略提高分散式電源併聯容量 
2.3 以配電饋線重組提高分散式電源併聯容量 
2.4 以配電系統主動管理提高分散式電源併聯容量 
3. 以配電饋線構成之微電網的運轉策略研究 
3.1 與市電連接之微電網運轉模型建立 
3.2 多代理人系統在含分散式電源之配電饋線運轉應用 
3.3 利用配電自動化、自動讀表(AMI)和需求端管理(DMS)量測值及用
戶資訊系統(CIS)資料進行系統狀態估計 
3.4 併網之微電網動態模擬及運轉特性分析 
3.5 因故障事故與市電切離之微電網運轉模擬 
3.6 維持穩定孤島運轉之分散式電源控制策略研究 
3.7 建立含電能儲存單元、太陽光電、燃料電池發電系統及負載之微電
網 
傳統配電系統以被動式方式設計，電力循單一方向流動，因此若有分散型電
源連接至配電系統，將造成技術上的問題。分散型電源的併接、運轉及解聯，將
會造成運轉及網路架構的改變，這會影響電壓控制、保護協調及安全的問題，未
來的電網必須因應在技術上及電力市場上的改變。本研究之目地在於針對各類分
散型電源以獨立或微電網方式併聯於電力系統後，可能對配電系統之影響。我們
探討了分散式電源接到配電系統時，其對饋線上負載的電壓及故障電流偵測的衝
擊，並探討改善措施以增加分散式電源可併網的容量。我們研究了區域性電壓控
制，如有載分接頭變壓器及電壓調整器間的控制協調，同時對分散式電源特別是
風機，於故障情況時之低電壓忍受能力的改善措施進行研究。 
微型電網的系統架構可以用來管理不同類型的分散式電源並提升配電系統
的可靠度。未來配電自動化系統、先進電表系統及負載管理系統的整合中，將可
獲得更多的配電系統量測資訊，對整體配電系統的狀態估計會有幫助並可用於電
  91
參考文獻 
[1] EU SmartGrids Framework “Electricity networks of future 2020 and beyond” 
[2] Europian SmartGrid Technology Platform, Vision and Strategy for Europe’s 
Electricity Networks of the Future, European Commission 2006. 
[3] “Advanced Distribution Automation,” EPRI 2006 Portfolio. 
[4] N. S. Markushevich, A. P. Berman, C. J. Jensen, J. C. Clemmer, 
“Implementation of advanced distribution automation in U.S.A. utilities,” 
CIRED 16th International Conference and Exhibition on Electricity Distribution, 
2001. Part 1: Contributions. (IEE Conf. Publ No. 482) pp. 224 – 224. 
[5] G. W. Ault, C.E.T. Foote, J. R. McDonald, “UK research activities on advanced 
distribution automation,” Proceedings of IEEE PES General Meeting, Vol. 1, 
June 2005, pp. 2616 – 2619. 
[6] D. M. Staszesky, D. Craig, C. Befus, “Advanced feeder automation is here,” 
IEEE Power and Energy Magazine, Vol. 3 (5), Sept.-Oct. 2005, pp. 56 – 63. 
[7] 蘇勝一，提高分散式電源併聯容量之饋線開關及電壓整合控制，碩士論文，
國立中山大學，2009 年 7 月。 
[8] 王志賢，以多代理人系統偵測含分散式電源之配電網路故障位置，碩士論
文，國立中山大學，2009 年 7 月。 
[9] 盧展南、許振廷、蘇俊連、陳朝順、鄧人豪、王耀村、許炎豐、王志賢、蘇
勝一，整合分散型電源建構優質配電網之研究-完成報告，台灣電力公司與
國立中山大學電機工程學系，中華民國 96 年。 
[10] M. Molinas, J. A. Suul, and T. Undeland, “Low Voltage Ride Through of Wind 
Farms with Cage Generators: STATCOM Versus SVC,” IEEE Transactions on 
Power Systems, Vol. 23, No. 3, May 2008, pp. 1104-1117. 
[11] 林志鵬，以靜態同步補償器與動態電壓恢復器改善風力發電機低電壓忍受能
力之研究，碩士論文，國立中山大學，2010 年 2 月。 
[12] M. Behnke, A. Ellis, Y. Kazachkov, T. McCoy, E. Muljadi, W. Price and J. 
Sanchez-Gasca, “Development and Validation of WECC Variable Speed Wind 
Turbine Dynamic Models for Grid Integration Studies,” Presented at AWEA’s 
2007 WindPower Conference Los Angeles, California June 2007, pp. 1-8. 
[13] 林筱秋，雙饋式感應發電機之低電壓忍受能力改善方法研究，碩士論文，國
立中山大學，2010 年 9 月。 
[14] Dynamic wind turbine models in power system simulation tool DIgSILENT, 
Risø-R-1400(ed.2). 
[15] 台灣電力公司再生能源發電系統倂聯技術要點，台灣電力公司，2008 年。 
[16] M. - S. Tsai, C. - K. Chan, P. Picélova and W. - C. Wu, “Development of a 
  93
and electric vehicles power systems”, IEEE Power Engineering Society, Vol. 1, 
pp. 470-475, 2000.  
[33] Olivier Tremblay, Louis-A. Dessaint, “Experimental Validation of a Battery 
Dynamic Model for EV Applications,” World Electric Vehicle Journal 2009  
[34] 洪裕桓，智慧型鋰電池管理系統之研製，碩士論文，國立中山大學，2005
年。 
[35] Francisco M. González-Longatt “Model of Photovoltaic Module in Matlab™,” 
[36] 朱麗,“基於 Matlab/Simulink 的太陽能電池特性模擬,”合肥工業大學電氣自動
化系，安徽合肥（230009） 
[37] Huan-Liang Tsai, Ci-Siang Tu, and Yi-Jie Su, Member, IAENG, “Development 
of Generalized Photovoltaic Model Using MATLAB/SIMULINK,” Proceedings 
of the World Congress on Engineering and Computer Science 2008 WCECS 
2008, October 22 - 24, 2008, San Francisco, USA. 
[38] 黃偕洲、葉增雄、劉承宗，“利用光伏發電系統舒緩區域用戶之電力壅塞可
行性研究”， 第九屆台灣電力電子研討會，pp.1355-1359，2010 年 9 月。 
[39] Hiren Patel and Vivek Agarwal “MATLAB-Based Modeling to Study the Effects 
of Partial Shading on PV Array Characteristics,” IEEE Trans. on Energy 
Conversion, Vol. 23, No. 1, March 2008. 
[40] 趙中興，“燃料電池基礎，”全華圖書。 
[41] J. Jia, Q. Li, Y. Wang, Y. T. Cham, and M. Han, “Modeling and Dynamic 
Characteristic Simulationof a Proton Exchange Membrane Fuel Cell,” IEEE 
Transactions On Energy Conversion, Vol. 24, No. 1, March 2009. 
[42] 侯文傑，並聯直流電源供應器自動主僕均流技術之研究，碩士論文，國立成
功大學，2004 年。 
[43] Mark L. Berenson, David M. Levine, and Timothy C. Krehbiel (2009). Basic 
Business Statistics (11th ed.). USA: Pearson Prentice Hall. 
 
 
 
 
 
 
 
 
 
 
 
 
  95
國科會補助計畫衍生研發成果推廣資料表 
日期： 2012  年 7 月 6 日 
國科會補助計畫 
計畫名稱：含分散式電源之配電系統運轉研究 
計畫主持人：盧展南 
計畫編號：NSC 98－2221－E－110－076－MY3 
研發成果名稱 
（中文）電表資料校正方法 
（英文）Method for Meter Data Correction 
成果歸屬機構 國立中山大學 發明人 (創作人) 盧展南;黃士哲 
技術說明 
本發明之主要目的係提供一種電表資料校正方法，該
方法可將電表記錄異常之用電負載校正為較接近用
戶端實際之用電負載。為達到此目的，必須擁有用戶
端即時量測資料，經由加總變壓器連結之所有用戶負
載後，以及線路上量測資料，一併提供給狀態估計使
用，再根據狀態估計之性能指標判定量測資料是否有
異常，最後決定是否執行資料偵測錯誤程序，該程序
會根據我們提供給狀態估計的資料，經由上下游關係
找出真正錯誤資料位置(變壓器)，再進一部針對該變
壓器連結之所有用戶一一檢測，在此檢測的方式是根
據統計的變異數分析，該方法將用戶當天的負載需量
與過去基準線做比較，所有用戶都比較完後再依據異
常用戶數量的不同，分為兩種方式去做異常資料的修
正，若只有一個異常用戶，則直接將狀態估計所估計
該變壓器的負載量減去底下所有正常用戶之負載需
量，若有兩個以上異常用戶，同樣減去所有正常用戶
的負載需量後，再藉由異常用戶之基準線來分配剩餘
的負載。  
產業別 電子;資訊 
技術/產品應用範圍 電表資料管理;能源管理 
技術移轉可行性 
及預期效益 提高電表資料管理系統的效能，降低非技術性損失 
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。 
 
 
 
 
 
  97
國科會補助專題研究計畫項下出席國際學術會議心得報告 
日期： 2012  年 7 月 6 日 
一、與會心得:  
在本計畫中，我們探討了分散式電源接到配電系統時，其對饋線上負載的電
壓及故障電流偵測的衝擊，並研究改善措施以增加分散式電源可併網的容量。我
們也研究了區域性電壓控制，如有載分接頭變壓器及電壓調整器間的控制協調，
同時對分散式電源特別是風機，於故障情況時之低電壓忍受能力的改善措施進行
研究。本計畫所發展的整體配電系統狀態估計會有幫助並可用於配電網的調度運
轉。在微型電網中，分散式能源的控制方法將依據其需求的性質及所在的運轉環
境而有所不同，會由分散式能源單元與系統或是與其他分散式能源設備間的互相
影響所決定。在本計畫中，我們進行了直流微型電網模擬，對使用電網追隨及電
網形成等兩種控制模式的動態特性加以分析，並發展維持直流微型電網電壓穩定
的控制方法。本計畫已建立含電能儲存單元、太陽光電、燃料電池發電系統及負
載之微電網，所建立的系統未來可供再生能源教學研究之用。 
二、攜回資料名稱及內容:  
所有參與該會議的論文。 
 
 
 
 
 
 
 
 
 
計畫 
編號 NSC 98 － 2221 － E － 110 － 076 － MY3 
計畫 
名稱 含分散式電源之配電系統運轉研究 
出國人員
姓名 盧展南 
服務機構及
職稱 中山大學電機系教授 
會議 
時間 
2010年 9月 20日 
至 
2010年 9月 23日 
會議地點 中國北京市 
會議 
名稱 
(中文) 關鍵基礎建設國際研討會 
(英文) International CRIS Conference on Critical Infrastructures 
(CRIS2010) 
發表論文
題目 
(中文) 先進讀表基礎建設在電網運轉與規劃上的相關效益 
(英文) Electricity grid operation and planning related benefits of 
advanced metering infrastructure 
  99
更有效。SmartGrid、Demand Side Management、Wide Area Measurement 及再生
能源併網的議題在本次會議中被廣泛的討論，主要對未來電力系統結構可能有的
變化及其在技術上所需的配套進行研討。電動車電能補充及再生能源特別是風力
發電倂聯技術及因系統擾動造成之相關問題在本次會議中亦被討論，未來風力發
電的建設將持續增加，相關之系統頻率及電壓忍受能力的探討將會成為熱門的話
題。本次與學生發表的論文是  “Feeder Reconfiguration for Accommodating 
Distributed Generations Interconnection。 
Crete 島擁有高佔比的再生能源發電，其電力系統目前正考慮與希臘本島系
統進行聯結。本人參觀了一個位於 Crete 島三個發電廠之一的輸配電系統絕緣礙
子的測試中心及一個有 12 MW 的風場。Crete 島的電力系統目前正考慮與希臘
本島系統進行聯結。 
本人為 ISAP Council 委員，亦參與下一屆 ISAP 會議地點及事宜的討論。 
感謝國科會及中山大學補助本人的旅費及同意本人能參與 ISAP2011 會
議，所獲得的相關資訊相信對未來的研發工作會有助益。 
三、攜回資料名稱及內容:  
所有參與該會議的論文。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
日期： 2012  年 7 月 6 日 
  101
日期： 2012  年 7 月 6 日 
一、參加會議經過:  
筆者於 2012/6/16 下午由高雄小港機場出發飛往香港，同行者有同一實
驗室的詹傑民學長，在會議期間參與的 Session 有 Keynote Speech、Plenary 
Session、Parallel Session(Customer side disturbance mitigation initiatives、
Methods to study the impacts of EVs, CFLs, and other new loads)，在 6/19 下午
就本次投稿論文內容進行了 15 分鐘的口頭報告，並在報告之後與台下聽眾
進行討論，隨後於當天晚上搭機返回台灣 
二、與會心得:  
隨著智慧電網相關技術的發展，各種新型態的負載與設備將被大量的使用在
現有的電力系統中，各種可能伴隨而來的問題，例如諧波干擾、電壓擾動與驟降
都會影響到用戶使用電力的品質，本次研討會有來自世界各地共 197 篇的投稿論
文，內容包括將雲端運算的概念運用於電力系統的狀態量測、探討新型照明器具
可能造成的諧波干擾與實驗量測結果、各種新型的轉換器架構設計、含再生能源
的直流微電網實驗平台介紹與量測結果、電動車充電負載對電網衝擊的分析方法
等等，與會的專家學者們都相當熱烈的參與討論並提出各自的問題。 
本次於會議發表的論文是 Operation Of Distribution Feeders With Electric 
Vehicle Charging Loads(如附件)，對未來電動車普及之後可能對電網造成的影響
提出一種探討的流程，利用機率分配函數來描述電動車負載在時間與位置上的不
確定性，利用配電系統負載潮流軟體(Open Dss)搭配 Matlab 軟體進行負載潮流的
運算以瞭解對電網造成的影響，最後提出以饋線重組的方式來減少因為電動車負
載造成的功率損失，在口頭報告中筆者簡介了模擬的整體流程與概念，並就模擬
結果以及電動車目前在台灣的實際發展狀況與聽眾進行討論。 
本次會議是筆者第一次參與國際性的學術會議，除了瞭解了其他國家的學者
計畫 
編號 NSC 98 － 2221 － E － 110 － 076 － MY3 
計畫 
名稱 含分散式電源之配電系統運轉研究 
出國人員
姓名 劉鴻儒 
服務機構及
職稱 中山大學電機系/學生 
會議 
時間 
2012年 6月 17日 
至 
2012年 6月 20日 
會議地點 香港 
會議 
名稱 
(中文)IEEE 第五屆電力諧波及電力品質國際會議 
(英文)15th IEEE International Conference on Harmonics and   
Quality of Power ICHQP 2012 
發表論文
題目 
(中文)含電動車充電負載之配電饋線運轉 
(英文)Operation of Distribution Feeders with Electric Vehicle 
Charging Loads 
  103
 
圖 3. 筆者進行口頭報告照片 
 
圖 4. 筆者與聽眾進行討論照片 
 
Crete島擁有高佔比的再生能源發電，其電力系統目前正考慮與希臘本島系統進
行聯結。本人參觀了一個位於Crete島三個發電廠之一的輸配電系統絕緣礙子的
測試中心及一個有 12 MW的風場。Crete島的電力系統目前正考慮與希臘本島
系統進行聯結。 
 
本人為 ISAP Council 委員，亦參與下一屆ISAP會議地點及事宜的討論。  
 
感謝國科會及中山大學補助本人的旅費及同意本人能參與 ISAP2011 會議，所獲
得的相關資訊相信對未來的研發工作會有助益。 
 
 
 
 
 2 
discrete nonlinear optimization problem that takes distribution 
security concerns into account. To investigate the effects of the 
DG installation, three different objective functions are studied: 
 
1) Minimization of system loss 
)(. uPMin loss  (1) 
 
2) Maximization of DG installation capacity 
∑
=
dN
i
iDGSMin
1
,
/1.  (2) 
 
3) Coordination of DG capacity and system loss 
)/)((*)(*.
,2
1
,1 baselossloss
N
i
iDGD PuPwSPwMin
d
+∑
=
 (3) 
 
The following network security constraints are included in 
this study [10]:  
 
The supply limits of the transformers 
T
Koutk
pk NpSuS p ∈∀≤∑
∈
max)(  (4) 
 
The loading limits for all feeders 
loutkjkj NjKkSuS ∈∈∀≤ ,)( max  (5) 
 
The node voltage limits 
diii NiVuVV ∈∀≤≤ maxmin )(  (6) 
 
Where, 
iDGS , : The capacity for the DG at node i 
baselossP , : System loss in base case 
∑
=
+
=
lN
i i
ii
iloss
uV
uQuP
ruP
1
2
22
)(
)()()( : System loss 
DP : System demand 
outK : The set of feeder nodes receiving power from certain 
transformer 
TN : The set of all substation transformers 
dN : The set of nodes 
lN : The set of branches 
21, ww : Weighting factors of different objective functions 
u: The control variables consist of DG capacities and their 
locations, and switch status 
 
In this study, it is assume that the distribution feeders should 
be remained radial operation with islanding effect excluded. 
III.  SOLUTION METHOD  
The control variables of the optimization problem 
described in Section II should include the number of the DG 
units and their locations, and the status of feeder tie switch 
sections. These are all discrete numbers. The total capacity of 
DG installation is determined by multiplying the number of 
installed DG with the capacity of the DG unit adopted. This 
problem is solved by a PSO method. In the swarm, particle i is 
denoted as xi = (xi1, xi2,…, xiD) where the variables ijx  for all 
],...,3,2,1[ Dj ∈  represent the control variables. For this 
problem, in the basic PSO method, the DG capacity and their 
locations, and feeder tie switch section are randomly selected 
in each iteration. After the distribution system load flow study, 
the particle with the best fitness (objective) value is recorded 
as the best position p= ),...,,( 21 iDiii pppp =  so far, and the 
position with the best fitness among all particles is recoded as 
g= ),...,,( 21 gDggg pppp = .  
In this study if the rate of position change (velocity) for 
particle i is denoted as ),...,,( 21 iDiii vvvv = , the velocities of the 
discrete variables in the particle are updated by:  
 
)])(*2*)(*1*[( 21 oldgdoldidoldnew idididid xprandNOcxprandNOcvKRoundv −+−+=  
(7) 
where function Round() rounds up the embraced real number 
to integer and K is a constriction factor calculated by: 
4       ,
42
2
21
2
>+=
−−−
= ϕϕ
ϕϕϕ
andccK  (8) 
Previous study on stability and convergence of PSO has 
indicated that use of a constriction factor may be necessary to 
insure convergence of the particle swarm algorithm [11]. It 
shows that the properly defined constriction coefficients 
increase the rate of convergence; further, these coefficients can 
prevent explosion and induce particles to converge on local 
optima. The convergence characteristic of the system can be 
controlled by ϕ  in (8). The value of ϕ  must be greater than 
4.0 to guarantee stability. However, as ϕ  increases, the 
constriction factor K decreases and diversification is reduced, 
yielding slower response. Typically, when the constriction 
factor is used, ϕ  is set to 4.1 (i.e. c1, c2 = 2.05) and the 
constant multiplier K is thus 0.729.  
With the rate of position change (velocity) for particle i, vi, 
particle i is updated by the following equation: 
)1()()1( ++=+ kvkxkx ididid  d∀  (9) 
Where d is the index of the control variables, k is the number 
of iteration. 
In the basic PSO-based solution procedure, a load flow 
analysis is executed in each iteration in order to verify the 
compliance of the security constraints and to compute the 
system loss. To enhance the solution efficiency, instead of 
using a detail load flow solution, the following crude model is 
used to calculate the feeder section loadings, voltage 
magnitudes and losses. Using the notations shown in Fig. 1,  
 
∑
∈
++++ +−−=
outKk
kjjcjDGjDj SQSSS )1()1()1()1(  (10) 
 4 
IV.  NUMERICAL RESULTS 
A simple 3 feeder distribution system shown in Fig. 4 is 
used to test the performance of the proposed method. The 
original network structure has three loops consisting of feeder 
section sets {s2, s5, s9, s8}, {s7, s11, s14} and {s3, s4, s16, 
s15, s13} respectively. In order to maintain radial operation, 
each loop should have a normally opened section. The nominal 
voltage of the distribution system is 22.8 kV, the current rating 
of the feeder is 400 A, and the total real power demand of the 
system is 28.7MW. In the base case without DG installation, 
the system loss is 511.43 kW. Except substation buses 1, 2 and 
3, all the other nodes are candidate locations for DG 
installation. A DG unit is rated at 630 kW with unity power 
factor. DG installation is determined by multiplying the 
number of installed DG with the capacity of the DG unit. In 
the followings, test results of one DG installation location are 
presented. The particle number used in the PSO procedure is 
set to 10. Different numbers of iterations (50, 100 and 200) are 
tested and the parameters described in (8) are given as 
1c =2.05, 2c =2.05, ϕ =4.1 and K=0.729. 
 
Fig. 4 Three feeder test system [1] 
 
First, use system loss as the objective function, Fig. 5 
shows the convergence trends and system losses of a test case 
with one DG installation that are provided by the basic PSO 
method and proposed PSO algorithm. It can be seen that after 
25 iterations the proposed method has approached to the 
minimum system loss (137.46 kW), while for the basic PSO 
method, it seems that higher iterations are required in order to 
achieve better solutions. 
Since PSO is one of the stochastic optimization methods, 
the performance of the solution would hinge on the choice of 
seeds of random numbers and the search strategy adopted in 
each implementation. In our study, the performance of the 
proposed PSO method is evaluated statistically. Table I shown 
the statistical results of 10 trials. It can be seen from Table I 
that, with iteration number set to 50 for the proposed method, 
the mean of the execution time is 1.33 sec. While the load flow 
analysis based basic PSO method with iteration numbers set to 
50, 100 and 200 requires 0.95 sec, 1.83 sec and 3.63 sec, 
respectively. If higher number of iterations is required by the 
basic PSO method to obtain comparable good results, the 
proposed method seems to outperform the basic PSO method 
in finding a better feeder configuration to minimize system 
loss by DG installation. This can be justified by the test results 
shown in Table II. 
0 10 20 30 40 50 60 70 80 90 100
130
140
150
160
170
180
190
200
210
iterations
Lo
ss
(kW
)
 
 
Proposed method
General PSO
 
Fig. 5 Solution convergence characteristics 
 
TABLE I 
EXECUTION TIME OF DIFFERENT STOP CRITERION (10 RUNS) 
Proposed 
method 
Basic PSO method  
50  
iterations 
50  
iterations 
100  
iterations 
200  
iterations 
mean 1.33 0.95 1.83 3.63 
Standard 
deviation 0.05 0.07 0.03 0.04 
 
Table II shows the test results of using DG and feeder 
reconfiguration to minimize system loss in 10 trials. As can be 
seen that the proposed method can provide the same solution 
in 10 trials, and the solution suggests that node 9 is a good 
candidate for DG installation if system loss reduction is to be 
maximized. A DG installation of 16.38 MW with tie switches 
at sections s2, s14, s16 can reduce the system loss from 511.43 
kW to 137.46 kW. The solutions obtained from the basic PSO 
method in 10 trials are inconsistent due to the stochastic 
characteristic of the PSO method. The average system loss 
obtained from the basic PSO method in the 10 trials is 171.90 
kW. 
A test on attempting to accommodate more DG units in the 
existing distribution system by feeder reconfiguration is also 
conducted. Table III shows that if only one location is planned 
for DG installation, then node 9 is a good location. A 
maximum capacity of 37.17 MW can be installed in a feeder 
configuration with tie switches at s8, s7 and s13. However, for 
this objective, the system loss would rise to 584.17 kW. This 
result indicates possible power flow and loss increase issues 
for large DG penetration. It can be seen again that the basic 
PSO method could not achieve consistent results in all 10 trials 
before the number of iterations is raised to a much higher 
value.  
 6 
VII.  REFERENCES 
[1] S. Civanlar, J. J. Grainger, H. Yin and S. S. H. Lee, “Distribution 
feeder reconfiguration for loss reduction,” IEEE Trans. Power 
Delivery, Vol. 3 (3), pp. 1217-1223, July 1988. 
[2] M. E. Baran and F. F. Wu, “Network reconfiguration in distribution 
systems for loss reduction and load balancing,” IEEE Trans. Power 
Delivery, Vol. 4 (2), pp. 1401 –1407, April 1989. 
[3] G. R. Darling, H.-D. Chiang and J.-C. Wang, “An efficient algorithm 
for real-time network reconfiguration in large scale unbalanced 
distribution systems,” IEEE Trans. Power Systems, Vol. 11 (1), pp. 
511 -517, Feb. 1996. 
[4] C. C. Liu, S. J. Lee, and S. S. Venkata, “Loss minimization for 
distribution feeders: optimality and algorithms,” IEEE Trans. Power 
Delivery, Vol. PWRD-3, pp. 1281-1289, 1989. 
[5] R. E. Brown, “Distribution reliability assessment and reconfiguration 
optimization,” Proceedings of Transmission and Distribution 
Conference and Exposition, vol. 2, 2001 pp.994 - 999. 
[6] S. A. Yin and C. N. Lu, "Distribution feeder scheduling considering 
variable load profile and outage costs," IEEE Trans. Power Systems, 
Vol. 24, No. 2, pp. 652-660, May 2009. 
[7] J. Olamaei, T. Niknam and G. Gharehpetian, “Impact of distributed 
generators on distribution feeder reconfiguration,” Proceedings of 
IEEE Lausanne Power Tech, 2007. 
[8] F. Li, “Application of ordinal optimization for distribution system 
reconfiguration,” Proceedings of Power Systems Conference and 
Exposition, IEEE/PES, 2009. 
[9] S. Y. Su, C. N. Lu, R. F. Chang, and G. Gutiérrez-Alcaraz, 
“Distributed Generation Interconnection Planning: A Wind Power 
Case Study,” accepted, to appear in IEEE Trans. on Smart Grid, 2011. 
[10] R. F. Chang, S. J. Chen, Y. C. Chang and C. N. Lu, “Modified Particle 
Swarm Optimization for Solving Distribution Feeder Reconfiguration 
Problem with Distributed Generation,” Proceedings of IEEE TENCON, 
November 21-24 2010.  
[11] M. Clerc, “The swarm and the queen: towards a deterministic and 
adaptive particle swarm optimization,” Proceedings of the 1999 
Congress on Evolutionary Computation, Vol. 3, pp. 1951-1957, 1999. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 1
  
Abstract—In the next decade, electric vehicles (EV) will be 
heading to the road in a fast speed. Utility company would have 
no control over the future EV charging points or stations, and no 
direct control over periods and frequency of EV charging that 
could cause great effects to the existing distribution network 
operations. Distribution system operation and expansion 
planning would become more complicated due to the high degree 
of uncertainty of the EV charging demand. To mitigate the 
problem by better utilizing the existing distribution network, 
feeder reconfiguration under the distribution automation 
framework is proposed to deal with the problem and simulation 
results are presented in this paper. The test results indicate that 
feeder reconfiguration can be exercised to match loading patterns 
of different types of feeders (residential, commercial and 
industrial) with various charging scenarios, and consequently, 
reduce the impacts of EV charging and optimize the use of the 
existing network. 
Index Terms—Distribution network, Electric vehicle, feeder 
reconfiguration, smart grid 
I.  INTRODUCTION 
ue to technological trends there is a high likelihood that 
large number of plug-in EV, will be on the roads within 
the next decade. Impact analyses show that great effects to the 
utility system can be expected even at low EV penetration 
levels if the load is uncontrolled [1][2]. EV in substantial 
numbers would create peak demand levels that typical 
distribution network could not handle effectively without 
capacity augmentation and/or peak load mitigation controls. 
The impacts are overloaded distribution transformers, 
conductor and cable, low voltage to customers and some 
violation of planning limits [3]-[5].  
Distribution system operators (DSO) are responsible for 
providing the required network upgrades to supply the EV 
charging points. Similar to distributed generation (DG), DSO 
would have no control over the periods and frequency of EV 
charging and locations. As a result, the network operation and 
expansion planning problems will become more complicated 
due to the higher degree of uncertainty. Study results show 
that depending on the charging strategies, investment costs can 
increase up to 15% of total actual distribution network 
investment costs, and energy losses can increase up to 40% in 
off-peak hours for a scenario with 60% of total vehicles being 
plug-in EV [6]. 
 
                                                           
The authors are with the Department of Electrical Engineering, National 
Sun Yat-sen University, Kaohsiung, Taiwan (e-mail: okmqaz476@hot-
mail.com). 
 
In the EV impact assessment, the feeder loading and 
voltage deviations due to EV demands can be estimated by a 
distribution load flow (DLF) program. To maintain good 
service voltage, conventionally, distribution network volt/var 
controls involve regulation of voltage and reactive power by 
on load tap changer (OLTC), line voltage regulators (VR) and 
shunt capacitors (SC). Besides volt/var controls, automated 
feeder switches are often dispatched by system operators 
under normal and emergency situations in order to enhance 
system efficiency and reliability [7]. 
With the introduction of EV, more innovative 
monitoring, control and communication technologies should 
be deployed to enhance grid operation under smart grid 
architecture. A distribution feeder reconfiguration study under 
distribution automation framework is conducted in order to 
reduce the negative impacts of uncontrolled EV charging 
without network reinforcement. Simulation results are 
presented in this paper. Study results indicate that feeder 
reconfiguration can be exercised to match loading patterns of 
different types of feeders (residential, commercial and 
industrial) with various charging scenarios, and consequently, 
help to deal with the operation problems due to EV charging. 
II.  PROBLEM FORMULATION 
The foundation of the EV charging impact analyses is a 
detailed electrical model of each distribution feeder with all 
components represented from the substation transformer to 
each distribution transformers represented by feeder nodes. 
The overall feeder or substation loading in response to EV 
charging is intrinsically dictated by the aggregate make-up of 
the interconnected EV and driver charging habits. The 24 hour 
load profiles specific to each feeder, based on metered data are 
modeled as the starting point and the EV charging scenario 
loads are randomly superimposed on these at the various EV 
penetration levels. EV charging will likely exhibit a large 
degree of temporal and spatial diversity. These diversities can 
be accounted for through probability density functions.  
A feeder reconfiguration problem for reducing EV impact 
consists of the following tasks: 
1. Feeder modeling: the objective of this task is to build 
computational models of representative feeders and verify 
that they match the actual loads, voltages, etc. 
2. Determination of charging scenarios: this task determines 
when, where and how much EV load is expected. 
3. Feeder load flow simulation methodology and 
reconfiguration analysis: this task calculates power flows 
incorporating 24-hr load data and EV penetration levels 
and using a non-traditional programming technique to 
determine the optimal feeder switch status throughout the 
Operation of Distribution Feeders with Electric 
Vehicle Charging Loads 
Chieh-Min Chan, Hung-Ru Liou and Chan-Nan Lu 
D
 3
  
Fig. 4 EV impact study procedure. 
C. Simplified load flow method 
Many load flow runs will be required in the optimization 
procedure. In order to enhance the solution efficiency, instead 
of using a detail load flow solution, the following crude model 
is used to calculate the feeder section loadings, voltage 
magnitudes and losses. Using the notations shown in Fig. 5,  
( 1) ( 1) ( 1)
out
j D j EV j j k
k K
S S S S+ + +
∈
= + + ∑  (1) 
∑
=
+ ×+×−≈
j
m
mmmmj QxPrVV
1
11 )(  (2) 
where     
1
( )
bN
m Dn EVn
n m
P P P
= +
= +∑  
 1
( )
bN
m Dn
n m
Q Q
= +
= ∑  
 jjj jQPS +=  
 )1()1()1( +++ += jDjDjD jQPS  
 ( 1) ( 1)EV j EV j
S P+ +=  
Where bN  is the number of nodes in the feeder. jS  is the 
power flow at feeder section j, )1( +jDS  is the load at feeder 
section (j+1), ( 1)EV jS +  is the EVs load at node (j+1). 
∑
∈
+
outKk
kjS )1( is the sum of demands at the downstream of feeder 
node (j+1). 
Fig. 5 Feeder section power flows and bus demands 
 
The system loss can be estimated by: 
∑
∈
×=
lNl
llloss SruP )()(
2  (3) 
where lr  is the resistance on feeder section l. 
According to the Law of Large Numbers, the average 
response for large scale aggregation of EV charging behaviors, 
such as substation or feeder loading, will tend toward the 
mean of the EV charging demand characteristics. Monte Carlo 
simulations can be performed to determine the mean hourly 
demands as seen at the substation based on an assumed set of 
EV penetration charging specific behaviors.  Different 
assumptions concerning type distributions or implemented 
charging controls can be simulated to determine any positive 
or negative impact at the substation levels. 
D. Feeder Reconfiguration Problem 
The mathematical formulation of the feeder 
reconfiguration problem used to minimize system load 
considering the EV loads and maintaining the system security 
is as follow. 
 Min. 
24
2
1 1
( ) ( )
h bh
loss i i
h i
P u I R
=
= =
= ×∑∑    (4) 
Subject to  
 min max| |iV V V≤ ≤    (5) 
 ,max| |i iI I≤    (6) 
Where bh is the total number of branches, u is the control 
variables which consist of tie switch locations. | |iV  is the 
voltage magnitude of bus i. min max,V V are the bus minimum 
and maximum voltage limits. i| I |  is the feeder section current 
magnitude, and i ,maxI is the current rating of branch i 
 In this study, it is assumed that the distribution feeders 
should remain radial operation after feeder reconfiguration. 
Fig. 5 is the proposed procedure used to reduce the impact of 
EV charging in the distribution network.  
E. Solution method 
Figure 6 shows the proposed solution method. In the first 
step of the procedure, the load flow crude model is used and 
the PSO technique is adopted to determine the optimal tie 
switch locations at each hour. In order to verify the 
compliance of the network security and obtain the final 
optimal solution, in the second part of the solution procedure, 
a complete load flow model is used by moving the tie switch 
forward and backward and to adjust the final results. 
A binary particle swarm optimization (BPSO) technique is 
employed to solve the discrete nonlinear optimization problem 
and possible uncertainties associated with volatile loads are 
incorporated through a stochastic simulation approach. The 
control variables of the optimization problem are the normally 
opened feeder tie switch sections. These are discrete numbers. 
In the swarm, particle i is denoted as xi = (xi1, xi2,…, xiD) 
where the variables ijx  for all ],...,3,2,1[ Dj ∈  represent the 
control variables. The locations of feeder tie switch sections 
are randomly selected in each iteration. After the distribution 
system load flow study, the particle with the best fitness 
(objective) value is recorded as the best position p= 
),...,,( 21 iDiii pppp =  so far, and the position with the best 
fitness among all particles is recoded as 
g= ),...,,( 21 gDggg pppp = . The rate of position change 
(velocity) for particle i is denoted as ),...,,( 21 iDiii vvvv = , the 
velocities of the discrete variables in the particle are updated 
by:  
* 1* ( ) * 2 * ( )1 2
id id id id
new old old oldv Round K v c randNO p x c randNO p xid gd
⎛ ⎞⎡ ⎤
= + − + −⎜ ⎟⎢ ⎥⎣ ⎦⎝ ⎠
(7) 
where function Round() rounds up the embraced real number 
to integer and K is a constriction factor calculated by: 
 5
II, 100 Monte Carlo simulations are performed to determine 
the hourly demand as seen at the feeder buses based on the 
assumed set of EV penetration, charging specification and 
behaviors. A feeder reconfiguration process is conducted for 
each load condition. The average response for large scale 
aggregation of EV charging behaviors, such as substation or 
feeder loading, would tend toward the mean of the EV 
charging demand characteristics. Fig. 7 shows the load curves 
changes at buses 4c, 8i, 13r with 20% and 80% EV 
penetrations in one simulation. It can be seen that in the 
industrial feeder, the load due to EV charging starts to increase 
after workers arriving their working place and reaches its 
maximum at 10 and 11 o’clock. The additional EV loads at the 
business area would distributed randomly due to most of the 
EV arrive at different time with different SOC. In the 
residential feeder the increased load is mainly occurring at 8 
pm after work. 
0 4 8 12 16 20 24
0
0.5
1
1.5
2
(hour)
Bus 4c
(p
.u
.)
 
 
0 4 8 12 16 20 24
0
0.5
1
1.5
2
(hour)
Bus 8i
(p
.u
.)
0 4 8 12 16 20 24
0
0.5
1
1.5
2
(hour)
Bus 13r
(p
.u
.)
add 80% EV in phase a
add 80% EV in phase b
add 80% EV in phase c
add 20% EV in phase a
add 20% EV in phase b
add 20% EV in phase c
base case in phase a,b,c
 
Figure 7 Sample load curves with EV charging load at buses 4c, 8i, 13r 
 
Table IV shows the majority of tie switch set after 100 
runs and Table V shows the average system losses at different 
hours. Fig. 8 show the profiles and voltage ranges of feeder 
bus phase voltages at 11:00 obtained from 100 runs of Monte 
Carlo simulations. Compare the result of Case 2 with that of 
Case 1 shown in Table IV, it can be seen that feeder 
reconfiguration can be used to reduce system loss in daily 
operations, especially during peak load hours. Due to the EV 
load, in the industrial feeder, the loss increases 51.3 kW at 
peak EV charging hour (10 am). At low (20%) EV penetration, 
the optimal tie switch configuration in Case 4 is the same as 
that in Case 2. However, when the EV penetration increases to 
80%, the system loss of case without (Case 5) and with (Case 
6) feeder reconfiguration would have a difference. This 
indicates the effectiveness of feeder reconfiguration in dealing 
with high EV charging problems. In Case 6 one of the tie 
switches, S7 is changed to S11 at 3:00 am due to the EV 
charging at the residential area. Tie switch adjustment also 
occurs at 18:00 due to residential area charging. At 11:00 to 
13:00 period, due to the demand at the industrial area, the tie 
switches are changed from (S9、S7、S16) to (S9、S7、S4). 
Table V shows that when the EV penetration reaches 80%, 
feeder reconfiguration can help in reducing the system loss 
while maintaining the voltage quality without network 
reinforcement. The voltage would be lower due to the high 
penetration of EV. After the feeder reconfiguration the voltage 
can be maintained within acceptable level.  
TABLE IV TIE SWICHES IN DIFFERENT CASES 
Hour
Case1 Case2&Case3 &Case4&Case5 Case6 
TS1 TS2 TS3 TS1 TS2 TS3 TS1 TS2 TS3
1 S5 S11 S16 S9 S11 S16 S9 S11 S16
2 S5 S11 S16 S9 S11 S16 S9 S11 S16
3 S5 S11 S16 S9 S7 S16 S9 S11 S16
4 S5 S11 S16 S9 S7 S16 S9 S7 S16
5 S5 S11 S16 S9 S7 S16 S9 S7 S16
6 S5 S11 S16 S9 S7 S16 S9 S7 S16
7 S5 S11 S16 S9 S7 S16 S9 S7 S16
8 S5 S11 S16 S9 S7 S16 S9 S7 S16
9 S5 S11 S16 S9 S7 S16 S9 S7 S16
10 S5 S11 S16 S9 S7 S16 S9 S7 S16
11 S5 S11 S16 S9 S7 S16 S9 S7 S4 
12 S5 S11 S16 S9 S7 S16 S9 S7 S4 
13 S5 S11 S16 S9 S7 S16 S9 S7 S4 
14 S5 S11 S16 S9 S7 S16 S9 S7 S16
15 S5 S11 S16 S9 S7 S16 S9 S7 S16
16 S5 S11 S16 S9 S7 S16 S9 S7 S16
17 S5 S11 S16 S9 S7 S16 S9 S7 S16
18 S5 S11 S16 S9 S7 S16 S9 S11 S16
19 S5 S11 S16 S9 S11 S16 S9 S11 S16
20 S5 S11 S16 S9 S11 S16 S9 S11 S16
21 S5 S11 S16 S9 S11 S16 S9 S11 S16
22 S5 S11 S16 S9 S11 S16 S9 S11 S16
23 S5 S11 S16 S9 S11 S16 S9 S11 S16
24 S5 S11 S16 S9 S11 S16 S9 S11 S16
 
TABLE V AVERAGE SYSTEM LOSSES (UNIT：KWH) 
Hour Case1 Case2 Case3& Case4  Case5 Case6 
1 82.9 78.5 80.5  86.9  86.9  
2 72.8 65.7 66.7  69.7  69.7  
3 74 64.5 64.9  66.3  66.0  
4 70.4 59.6 59.7  60.0  60.0  
5 69.6 58.4 58.4  58.5  58.5  
6 75.8 65.5 65.7  66.3  66.3  
7 113.1 86.5 89.0  96.8  96.8  
8 131.8 106.7 119.4  163.1  163.1  
9 202.8 158.3 194.8  333.4  333.4  
10 218.3 170.9 220.7  417.9  417.8  
11 227.3 177.3 225.1  412.2  412.1  
12 245.2 189.2 232.0  393.0  392.1  
13 233.9 183.1 218.2  346.0  345.9  
14 281.8 221 251.6  358.3  358.3  
15 299.5 241.2 265.1  346.0  346.0  
16 284 229.8 246.2  300.6  300.6  
17 266.3 218.1 229.2  265.2  265.2  
18 284.3 247.1 258.1  293.4  292.0  
19 270.1 244.7 257.4  300.5  300.5  
20 252.4 235.1 250.4  302.1  302.1  
21 244.8 228.4 243.2  293.8  293.8  
22 220.4 207.3 220.6  266.3  266.3  
23 188.4 175.8 186.9  225.0  225.0  
24 137.2 130.7 137.5  159.4  159.4  
sum 4547.1 3843.4 4241.5  5680.5  5677.7  
IV CONCLUSION 
In this paper, EV charging scenarios are simulated to 
investigate the impacts of EV charging loads to the 
distribution network. Feeder reconfiguration operation is 
國科會補助計畫衍生研發成果推廣資料表
日期:2011/12/01
國科會補助計畫
計畫名稱: 含分散式電源之配電系統運轉研究
計畫主持人: 盧展南
計畫編號: 98-2221-E-110-076-MY3 學門領域: 電力系統 
研發成果名稱
(中文) 直流微電網
(英文) DC Microgrid
成果歸屬機構
國立中山大學 發明人
(創作人)
盧展南,林建宏,陳開瑞,陳敏睿
技術說明
(中文) 一種直流微電網之控制方法，包含：一併聯運轉程序，由一控制單元使一直流匯
流排與一市電系統併聯，待一負載單元、一第一換能單元及一第二換能單元併聯
該直流匯流排後，該控制單元設定一儲能單元為充電模式；一判斷程序，係由該
控制單元判斷該儲能單元之電壓是否小於一第一閥值，若判斷為是，則設定該控
制模式為孤島運轉模式，若判斷為否，則再進行該併聯運轉程序；及一孤島運轉
程序，由該控制單元使該直流匯流排與該市電系統解聯，並控制該負載單元、該
儲能單元、該第一換能單元及該第二換能單元，及設定該儲能單元為放電模式。
(英文) A power flow control device is adapted to be controlled to output a three-phase grid 
power to a grid terminal, and includes: a control circuit coupled to the grid terminal, and 
configured to detect voltage and current of the grid power outputted to the grid terminal 
and to calculate based on the voltage and current of the grid power and a set of 
predetermined power commands to output a set of pulse width modulated signals 
representing an expected output power; an inverter controlled by the set of pulse width 
modulated signals such that the inverter switches to converter a DC voltage into a three-
phase inverter power; and a capacitor configured to endure a difference between a voltage 
of the inverter power and the voltage of the grid terminal to convert the inverter power 
into the grid power outputted to the grid terminal.
產業別 電機及電子機械器材業；其他工業製品製造業；電力供應業
技術/產品應用範圍
此技術預期可應用於低壓直流微電網中，將分散式能源所產生直流電直接給予用戶使用，
可改善轉換器轉換損失以及降低交流端傳統配電損失，提升整體系統傳輸效率，當交流
端發生事故與直流電網解聯，則直流電網可單獨運轉，提升用戶端用電之可靠度。
技術移轉可行性及
預期效益
預期可用於直流微電網控制，尤其是直流微電網應用於市電併聯運轉模式及孤島運轉模
式之控制方法。
註：本項研發成果若尚未申請專利，請勿揭露可申請專利之主要內容。
其他成果 
(無法以量化表達之成
果如辦理學術活動、獲
得獎項、重要國際合
作、研究成果國際影響
力及其他協助產業技
術發展之具體效益事
項等，請以文字敘述填
列。) 
協助資策會 AMI 先進功能研發 
 成果項目 量化 名稱或內容性質簡述 
測驗工具(含質性與量性) 0  
課程/模組 0  
電腦及網路系統或工具 0  
教材 0  
舉辦之活動/競賽 0  
研討會/工作坊 0  
電子報、網站 0  
科 
教 
處 
計 
畫 
加 
填 
項 
目 計畫成果推廣之參與（閱聽）人數 0  
 
